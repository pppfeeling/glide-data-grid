{"version":3,"file":"copy-paste.js","names":["assertNever","BooleanEmpty","BooleanIndeterminate","GridCellKind","convertCellToBuffer","cell","_cell$displayData","_cell$displayData2","copyData","undefined","formatted","rawValue","format","doNotEscape","kind","Boolean","data","Custom","Image","Bubble","Drilldown","map","x","text","Text","displayData","Uri","Markdown","RowID","Number","Loading","Protected","createBufferFromGridCells","cells","columnIndexes","copyBuffer","row","index","mappedIndex","span","escapeIfNeeded","str","withComma","test","replace","createTextBuffer","lines","line","_cell$rawValue$toStri","_cell$rawValue","push","toString","join","formatHtmlTextContent","match","repeat","length","formatHtmlAttributeContent","attrText","restoreHtmlEntities","createHtmlBuffer","formatStr","ind","_cell$rawValue$toStri2","_cell$rawValue2","getCopyBufferContents","textPlain","textHtml","decodeHTML","html","fragment","document","createElement","innerHTML","tableEl","querySelector","walkEl","result","current","el","pop","HTMLTableElement","nodeName","children","reverse","HTMLTableRowElement","HTMLTableCellElement","_clone$getAttribute","clone","cloneNode","firstTagIsPara","para","isAppleNumbers","brs","querySelectorAll","br","replaceWith","attributeValue","getAttribute","formatValue","_current","_clone$querySelector$","_clone$querySelector","_clone$textContent","textContent","_current2","rawValues","_x$getAttribute","_x$textContent","_current3","_clone$textContent2","_clone$textContent3","_current4"],"sources":["../../../src/data-editor/copy-paste.ts"],"sourcesContent":[null],"mappings":"AACA,SAASA,WAAW,QAAQ,sBAAsB;AAClD,SACIC,YAAY,EACZC,oBAAoB,EACpBC,YAAY,QAET,0CAA0C;AAkBjD,SAASC,mBAAmBA,CAACC,IAAc;EAAA,IAAAC,iBAAA,EAAAC,kBAAA;EACvC,IAAIF,IAAI,CAACG,QAAQ,KAAKC,SAAS,EAAE;IAC7B,OAAO;MACHC,SAAS,EAAEL,IAAI,CAACG,QAAQ;MACxBG,QAAQ,EAAEN,IAAI,CAACG,QAAQ;MACvBI,MAAM,EAAE,QAAQ;MAEhBC,WAAW,EAAE;KAChB;EACL;EACA,QAAQR,IAAI,CAACS,IAAI;IACb,KAAKX,YAAY,CAACY,OAAO;MACrB,OAAO;QACHL,SAAS,EACLL,IAAI,CAACW,IAAI,KAAK,IAAI,GACZ,MAAM,GACNX,IAAI,CAACW,IAAI,KAAK,KAAK,GACnB,OAAO,GACPX,IAAI,CAACW,IAAI,KAAKd,oBAAoB,GAClC,eAAe,GACf,EAAE;QACZS,QAAQ,EAAEN,IAAI,CAACW,IAAI;QACnBJ,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAACc,MAAM;MACpB,OAAO;QACHP,SAAS,EAAEL,IAAI,CAACG,QAAQ;QACxBG,QAAQ,EAAEN,IAAI,CAACG,QAAQ;QACvBI,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAACe,KAAK;IACvB,KAAKf,YAAY,CAACgB,MAAM;MACpB,OAAO;QACHT,SAAS,EAAEL,IAAI,CAACW,IAAI;QACpBL,QAAQ,EAAEN,IAAI,CAACW,IAAI;QACnBJ,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAACiB,SAAS;MACvB,OAAO;QACHV,SAAS,EAAEL,IAAI,CAACW,IAAI,CAACK,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC;QACrCZ,QAAQ,EAAEN,IAAI,CAACW,IAAI,CAACK,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC;QACpCX,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAACqB,IAAI;MAClB,OAAO;QACHd,SAAS,GAAAJ,iBAAA,GAAED,IAAI,CAACoB,WAAW,cAAAnB,iBAAA,cAAAA,iBAAA,GAAID,IAAI,CAACW,IAAI;QACxCL,QAAQ,EAAEN,IAAI,CAACW,IAAI;QACnBJ,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAACuB,GAAG;MACjB,OAAO;QACHhB,SAAS,GAAAH,kBAAA,GAAEF,IAAI,CAACoB,WAAW,cAAAlB,kBAAA,cAAAA,kBAAA,GAAIF,IAAI,CAACW,IAAI;QACxCL,QAAQ,EAAEN,IAAI,CAACW,IAAI;QACnBJ,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAACwB,QAAQ;IAC1B,KAAKxB,YAAY,CAACyB,KAAK;MACnB,OAAO;QACHlB,SAAS,EAAEL,IAAI,CAACW,IAAI;QACpBL,QAAQ,EAAEN,IAAI,CAACW,IAAI;QACnBJ,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAAC0B,MAAM;MACpB,OAAO;QACHnB,SAAS,EAAEL,IAAI,CAACoB,WAAW;QAC3Bd,QAAQ,EAAEN,IAAI,CAACW,IAAI;QACnBJ,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAAC2B,OAAO;MACrB,OAAO;QACHpB,SAAS,EAAE,UAAU;QACrBC,QAAQ,EAAE,EAAE;QACZC,MAAM,EAAE;OACX;IACL,KAAKT,YAAY,CAAC4B,SAAS;MACvB,OAAO;QACHrB,SAAS,EAAE,cAAc;QACzBC,QAAQ,EAAE,EAAE;QACZC,MAAM,EAAE;OACX;IACL;MACIZ,WAAW,CAACK,IAAI,CAAC;EACzB;AACJ;AAEA,SAAS2B,yBAAyBA,CAC9BC,KAAuC,EACvCC,aAAgC;EAEhC,MAAMC,UAAU,GAAeF,KAAK,CAACZ,GAAG,CAAC,CAACe,GAAG,EAAEC,KAAK,KAAI;IACpD,MAAMC,WAAW,GAAGJ,aAAa,CAACG,KAAK,CAAC;IACxC,OAAOD,GAAG,CAACf,GAAG,CAAChB,IAAI,IAAG;MAClB,IAAIA,IAAI,CAACkC,IAAI,KAAK9B,SAAS,IAAIJ,IAAI,CAACkC,IAAI,CAAC,CAAC,CAAC,KAAKD,WAAW,EACvD,OAAO;QACH5B,SAAS,EAAE,EAAE;QACbC,QAAQ,EAAE,EAAE;QACZC,MAAM,EAAE;OACX;MACL,OAAOR,mBAAmB,CAACC,IAAI,CAAC;IACpC,CAAC,CAAC;EACN,CAAC,CAAC;EACF,OAAO8B,UAAU;AACrB;AAEA,SAASK,cAAcA,CAACC,GAAW,EAAEC,SAAkB;EACnD,IAAI,CAACA,SAAS,GAAG,UAAU,GAAG,SAAS,EAAEC,IAAI,CAACF,GAAG,CAAC,EAAE;IAChDA,GAAG,GAAG,IAAIA,GAAG,CAACG,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG;EACxC;EACA,OAAOH,GAAG;AACd;AAEA,SAASI,gBAAgBA,CAACV,UAAsB;EAC5C,MAAMW,KAAK,GAAa,EAAE;EAC1B,KAAK,MAAMV,GAAG,IAAID,UAAU,EAAE;IAC1B,MAAMY,IAAI,GAAa,EAAE;IACzB,KAAK,MAAM1C,IAAI,IAAI+B,GAAG,EAAE;MACpB,IAAI/B,IAAI,CAACO,MAAM,KAAK,KAAK,EAAE;QAAA,IAAAoC,qBAAA,EAAAC,cAAA;QACvBF,IAAI,CAACG,IAAI,EAAAF,qBAAA,IAAAC,cAAA,GAAC5C,IAAI,CAACM,QAAQ,cAAAsC,cAAA,uBAAbA,cAAA,CAAeE,QAAQ,EAAE,cAAAH,qBAAA,cAAAA,qBAAA,GAAI,EAAE,CAAC;MAC9C,CAAC,MAAM,IAAI3C,IAAI,CAACO,MAAM,KAAK,cAAc,EAAE;QACvCmC,IAAI,CAACG,IAAI,CAAC7C,IAAI,CAACK,SAAS,CAACW,GAAG,CAACC,CAAC,IAAIkB,cAAc,CAAClB,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC8B,IAAI,CAAC,GAAG,CAAC,CAAC;MACzE,CAAC,MAAM;QACHL,IAAI,CAACG,IAAI,CAAC7C,IAAI,CAACQ,WAAW,KAAK,IAAI,GAAGR,IAAI,CAACK,SAAS,GAAG8B,cAAc,CAACnC,IAAI,CAACK,SAAS,EAAE,KAAK,CAAC,CAAC;MACjG;IACJ;IACAoC,KAAK,CAACI,IAAI,CAACH,IAAI,CAACK,IAAI,CAAC,IAAI,CAAC,CAAC;EAC/B;EACA,OAAON,KAAK,CAACM,IAAI,CAAC,IAAI,CAAC;AAC3B;AAEA,SAASC,qBAAqBA,CAAC9B,IAAY;EAMvC,OAAOA,IAAI,CAACqB,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAACA,OAAO,CAAC,QAAQ,EAAEU,KAAK,IAAI,gBAAgB,CAACC,MAAM,CAACD,KAAK,CAACE,MAAM,CAAC,CAAC;AACxG;AAEA,SAASC,0BAA0BA,CAACC,QAAgB;EAEhD,OACI,GAAG,GAAGA,QAAQ,CAACd,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,GAAG,GAAG;AAEvH;AAEA,SAASe,mBAAmBA,CAAClB,GAAW;EAEpC,OAAOA,GAAG,CACLG,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,CACvBA,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CACrBA,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CACrBA,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC;AAC/B;AAEA,SAASgB,gBAAgBA,CAACzB,UAAsB;EAC5C,MAAMW,KAAK,GAAa,EAAE;EAC1BA,KAAK,CAACI,IAAI,CAAC,0EAA0E,EAAE,gBAAgB,CAAC;EACxG,KAAK,MAAMd,GAAG,IAAID,UAAU,EAAE;IAC1BW,KAAK,CAACI,IAAI,CAAC,MAAM,CAAC;IAClB,KAAK,MAAM7C,IAAI,IAAI+B,GAAG,EAAE;MACpB,MAAMyB,SAAS,GAAG,eAAexD,IAAI,CAACO,MAAM,GAAG;MAC/C,IAAIP,IAAI,CAACO,MAAM,KAAK,KAAK,EAAE;QACvBkC,KAAK,CAACI,IAAI,CACN,OAAOW,SAAS,aAAaxD,IAAI,CAACM,QAAQ,KAAK0C,qBAAqB,CAAChD,IAAI,CAACK,SAAS,CAAC,WAAW,CAClG;MACL,CAAC,MAAM;QACH,IAAIL,IAAI,CAACO,MAAM,KAAK,cAAc,EAAE;UAChCkC,KAAK,CAACI,IAAI,CACN,OAAOW,SAAS,QAAQxD,IAAI,CAACK,SAAS,CACjCW,GAAG,CACA,CAACC,CAAC,EAAEwC,GAAG,KACH,qBAAqBL,0BAA0B,CAACpD,IAAI,CAACM,QAAQ,CAACmD,GAAG,CAAC,CAAC,GAAG,GACtET,qBAAqB,CAAC/B,CAAC,CAAC,GACxB,OAAO,CACd,CACA8B,IAAI,CAAC,EAAE,CAAC,YAAY,CAC5B;QACL,CAAC,MAAM;UAAA,IAAAW,sBAAA,EAAAC,eAAA;UACHlB,KAAK,CAACI,IAAI,CACN,qBAAqBO,0BAA0B,EAAAM,sBAAA,IAAAC,eAAA,GAC3C3D,IAAI,CAACM,QAAQ,cAAAqD,eAAA,uBAAbA,eAAA,CAAeb,QAAQ,EAAE,cAAAY,sBAAA,cAAAA,sBAAA,GAAI,EAAE,CAClC,IAAIF,SAAS,IAAIR,qBAAqB,CAAChD,IAAI,CAACK,SAAS,CAAC,OAAO,CACjE;QACL;MACJ;IACJ;IACAoC,KAAK,CAACI,IAAI,CAAC,OAAO,CAAC;EACvB;EACAJ,KAAK,CAACI,IAAI,CAAC,kBAAkB,CAAC;EAC9B,OAAOJ,KAAK,CAACM,IAAI,CAAC,EAAE,CAAC;AACzB;AAOA,OAAM,SAAUa,qBAAqBA,CACjChC,KAAuC,EACvCC,aAAgC;EAKhC,MAAMC,UAAU,GAAGH,yBAAyB,CAACC,KAAK,EAAEC,aAAa,CAAC;EAClE,MAAMgC,SAAS,GAAGrB,gBAAgB,CAACV,UAAU,CAAC;EAC9C,MAAMgC,QAAQ,GAAGP,gBAAgB,CAACzB,UAAU,CAAC;EAC7C,OAAO;IACH+B,SAAS;IACTC;GACH;AACL;AAEA,OAAM,SAAUC,UAAUA,CAACC,IAAY;EACnC,MAAMC,QAAQ,GAAGC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;EAE/CF,QAAQ,CAACG,SAAS,GAAGJ,IAAI,CAACzB,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC;EACjD,MAAM8B,OAAO,GAAGJ,QAAQ,CAACK,aAAa,CAAC,OAAO,CAAC;EAC/C,IAAID,OAAO,KAAK,IAAI,EAAE,OAAOjE,SAAS;EACtC,MAAMmE,MAAM,GAAc,CAACF,OAAO,CAAC;EACnC,MAAMG,MAAM,GAAmB,EAAE;EACjC,IAAIC,OAAiC;EAErC,OAAOF,MAAM,CAACpB,MAAM,GAAG,CAAC,EAAE;IACtB,MAAMuB,EAAE,GAAGH,MAAM,CAACI,GAAG,EAAE;IAEvB,IAAID,EAAE,KAAKtE,SAAS,EAAE;IAEtB,IAAIsE,EAAE,YAAYE,gBAAgB,IAAIF,EAAE,CAACG,QAAQ,KAAK,OAAO,EAAE;MAC3DN,MAAM,CAAC1B,IAAI,CAAC,GAAG,CAAC,GAAG6B,EAAE,CAACI,QAAQ,CAAC,CAACC,OAAO,EAAE,CAAC;IAC9C,CAAC,MAAM,IAAIL,EAAE,YAAYM,mBAAmB,EAAE;MAC1C,IAAIP,OAAO,KAAKrE,SAAS,EAAE;QACvBoE,MAAM,CAAC3B,IAAI,CAAC4B,OAAO,CAAC;MACxB;MACAA,OAAO,GAAG,EAAE;MACZF,MAAM,CAAC1B,IAAI,CAAC,GAAG,CAAC,GAAG6B,EAAE,CAACI,QAAQ,CAAC,CAACC,OAAO,EAAE,CAAC;IAC9C,CAAC,MAAM,IAAIL,EAAE,YAAYO,oBAAoB,EAAE;MAAA,IAAAC,mBAAA;MAE3C,MAAMC,KAAK,GAAyBT,EAAE,CAACU,SAAS,CAAC,IAAI,CAAyB;MAI9E,MAAMC,cAAc,GAAGF,KAAK,CAACL,QAAQ,CAAC3B,MAAM,KAAK,CAAC,IAAIgC,KAAK,CAACL,QAAQ,CAAC,CAAC,CAAC,CAACD,QAAQ,KAAK,GAAG;MACxF,MAAMS,IAAI,GAAGD,cAAc,GAAGF,KAAK,CAACL,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI;MACtD,MAAMS,cAAc,GAAG,CAAAD,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAER,QAAQ,CAAC3B,MAAM,MAAK,CAAC,IAAImC,IAAI,CAACR,QAAQ,CAAC,CAAC,CAAC,CAACD,QAAQ,KAAK,MAAM;MAE1F,MAAMW,GAAG,GAAGL,KAAK,CAACM,gBAAgB,CAAC,IAAI,CAAC;MACxC,KAAK,MAAMC,EAAE,IAAIF,GAAG,EAAE;QAClBE,EAAE,CAACC,WAAW,CAAC,IAAI,CAAC;MACxB;MAEA,MAAMC,cAAc,GAAGT,KAAK,CAACU,YAAY,CAAC,eAAe,CAAC;MAC1D,MAAMC,WAAW,IAAAZ,mBAAA,GAAIC,KAAK,CAACU,YAAY,CAAC,YAAY,CAAC,cAAAX,mBAAA,cAAAA,mBAAA,GAAI,QAAgB;MACzE,IAAIC,KAAK,CAACb,aAAa,CAAC,GAAG,CAAC,KAAK,IAAI,EAAE;QAAA,IAAAyB,QAAA,EAAAC,qBAAA,EAAAC,oBAAA,EAAAC,kBAAA;QACnC,CAAAH,QAAA,GAAAtB,OAAO,cAAAsB,QAAA,eAAPA,QAAA,CAASlD,IAAI,CAAC;UAEVvC,QAAQ,GAAA0F,qBAAA,IAAAC,oBAAA,GAAEd,KAAK,CAACb,aAAa,CAAC,GAAG,CAAC,cAAA2B,oBAAA,uBAAxBA,oBAAA,CAA0BJ,YAAY,CAAC,MAAM,CAAC,cAAAG,qBAAA,cAAAA,qBAAA,GAAI,EAAE;UAC9D3F,SAAS,GAAA6F,kBAAA,GAAEf,KAAK,CAACgB,WAAW,cAAAD,kBAAA,cAAAA,kBAAA,GAAI,EAAE;UAClC3F,MAAM,EAAEuF;SACX,CAAC;MACN,CAAC,MAAM,IAAIX,KAAK,CAACb,aAAa,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE;QAAA,IAAA8B,SAAA;QAC3C,MAAMC,SAAS,GAAGlB,KAAK,CAACM,gBAAgB,CAAC,IAAI,CAAC;QAC9C,CAAAW,SAAA,GAAA3B,OAAO,cAAA2B,SAAA,eAAPA,SAAA,CAASvD,IAAI,CAAC;UACVvC,QAAQ,EAAE,CAAC,GAAG+F,SAAS,CAAC,CAACrF,GAAG,CAACC,CAAC;YAAA,IAAAqF,eAAA;YAAA,QAAAA,eAAA,GAAIrF,CAAC,CAAC4E,YAAY,CAAC,eAAe,CAAC,cAAAS,eAAA,cAAAA,eAAA,GAAI,EAAE;UAAA,EAAC;UACxEjG,SAAS,EAAE,CAAC,GAAGgG,SAAS,CAAC,CAACrF,GAAG,CAACC,CAAC;YAAA,IAAAsF,cAAA;YAAA,QAAAA,cAAA,GAAItF,CAAC,CAACkF,WAAW,cAAAI,cAAA,cAAAA,cAAA,GAAI,EAAE;UAAA,EAAC;UACvDhG,MAAM,EAAE;SACX,CAAC;MACN,CAAC,MAAM,IAAIqF,cAAc,KAAK,IAAI,EAAE;QAAA,IAAAY,SAAA,EAAAC,mBAAA;QAChC,CAAAD,SAAA,GAAA/B,OAAO,cAAA+B,SAAA,eAAPA,SAAA,CAAS3D,IAAI,CAAC;UACVvC,QAAQ,EAAEgD,mBAAmB,CAACsC,cAAc,CAAC;UAC7CvF,SAAS,GAAAoG,mBAAA,GAAEtB,KAAK,CAACgB,WAAW,cAAAM,mBAAA,cAAAA,mBAAA,GAAI,EAAE;UAClClG,MAAM,EAAEuF;SACX,CAAC;MACN,CAAC,MAAM;QAAA,IAAAY,mBAAA,EAAAC,SAAA;QACH,IAAIR,WAAW,IAAAO,mBAAA,GAAGvB,KAAK,CAACgB,WAAW,cAAAO,mBAAA,cAAAA,mBAAA,GAAI,EAAE;QACzC,IAAInB,cAAc,EAAE;UAEhBY,WAAW,GAAGA,WAAW,CAAC5D,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC;QACtD;QAEA,CAAAoE,SAAA,GAAAlC,OAAO,cAAAkC,SAAA,eAAPA,SAAA,CAAS9D,IAAI,CAAC;UACVvC,QAAQ,EAAE6F,WAAW,aAAXA,WAAW,cAAXA,WAAW,GAAI,EAAE;UAC3B9F,SAAS,EAAE8F,WAAW,aAAXA,WAAW,cAAXA,WAAW,GAAI,EAAE;UAC5B5F,MAAM,EAAEuF;SACX,CAAC;MACN;IACJ;EACJ;EAEA,IAAIrB,OAAO,KAAKrE,SAAS,EAAE;IACvBoE,MAAM,CAAC3B,IAAI,CAAC4B,OAAO,CAAC;EACxB;EAEA,OAAOD,MAAM;AACjB","ignoreList":[]}