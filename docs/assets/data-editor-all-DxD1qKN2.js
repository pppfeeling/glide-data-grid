const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./image-window-loader-Ce11dqI5.js","./iframe-DB4XqYnF.js","./preload-helper-C1FmrZbK.js","./throttle-BB6hEv_h.js","./marked.esm-B2lddrDO.js","./index-DlpFMiw3.js","./image-window-loader-Bm61kU6i.css"])))=>i.map(i=>d[i]);
import{r as i,R as me}from"./iframe-DB4XqYnF.js";import{_ as pi}from"./preload-helper-C1FmrZbK.js";import{r as wi}from"./index-DlpFMiw3.js";import{G as U,d as jo,e as Ci,f as Zo,r as yr,h as en,C as ne,g as Lr,j as yi,w as wt,k as bi,l as xi,m as In,n as br,I as It,p as ki,o as Ri,t as xr,q as Mi,s as _t,v as kr,x as Si,y as Jo,z as Dt,A as Ti,B as Ei,D as zi,E as Li,F as Ii,H as Rr,i as ho,J as Di,K as Hi,L as Mr,M as $i,b as Dn,N as Fi,O as Ai,T as Gi,P as Ki,Q as Pi,R as Sr,S as Ni,U as Wi}from"./image-window-loader-Ce11dqI5.js";import{m as Ht,r as Xt,g as Vi}from"./throttle-BB6hEv_h.js";import{u as Bi,f as Tr}from"./flatten-Hif-LLO8.js";import{G as Ui}from"./scrolling-data-grid-BuDRV0BM.js";import{s as tn}from"./marked.esm-B2lddrDO.js";const re='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Oi=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}<rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${l}"/></svg>`},_i=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}<rect x="2" y="2" width="16" height="16" rx="4" fill="${u}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${l}"/></svg>`},Xi=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${u}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${l}"/>
  </svg>`},Yi=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${u}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${l}"/>
</svg>`},qi=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${u}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${l}"
    />
</svg>`},Ir=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${u}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${l}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${l}"/>
</svg>
  `},Zi=t=>{const l=t.bgColor;return`${re}
    <path stroke="${l}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${l}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${l}"/>
  </svg>
`},Ji=Ir,Qi=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${u}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${l}"/>
</svg>`},ji=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${l}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${l}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${l}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${u}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${l}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${l}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${l}"/>
  </svg>`},es=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${u}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${l}"/>
</svg>`},ts=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <path fill="${l}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${u}"/>
  </svg>`},os=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${u}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${l}"/>
  </svg>`},ns=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${u}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${l}"/>
</svg>`},rs=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${u}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${l}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${l}"/>
  </svg>`},ls=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${l}"/>
</svg>`},is=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${u}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${u}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${l}"/>
  </svg>`},ss=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <path fill="${l}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${u}"/>
</svg>`},cs=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${l}"/>
  </svg>`},as=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${l}"/>
  </svg>`},us=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${l}"/>
</svg>`},ds=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${l}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${l}"/>
</svg>`},fs=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${u}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${l}"/>
  </svg>`},hs=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${l}"/>
</svg>`},gs=t=>{const l=t.fgColor,u=t.bgColor;return`
    ${re}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${l}"/>
  </svg>`},ms=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${u}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${l}"/>
</svg>`},vs=t=>{const l=t.fgColor,u=t.bgColor;return`${re}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${u}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${l}"/>
</svg>`},ps=t=>{const l=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${l}" stroke-width="2"/>
  </svg>`},ws=t=>{const l=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${l}" stroke-width="2"/>
  </svg>
`},Cs=t=>(t.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${t.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),ys=t=>(t.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${t.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),bs={headerRowID:Oi,headerNumber:Xi,headerCode:_i,headerString:Yi,headerBoolean:qi,headerAudioUri:Ji,headerVideoUri:Qi,headerEmoji:ji,headerImage:es,headerUri:Ir,headerPhone:ts,headerMarkdown:os,headerDate:ns,headerTime:rs,headerEmail:ls,headerReference:is,headerIfThenElse:ss,headerSingleValue:cs,headerLookup:as,headerTextTemplate:us,headerMath:ds,headerRollup:fs,headerJoinStrings:hs,headerSplitString:gs,headerGeoDistance:ms,headerArray:vs,rowOwnerOverlay:ps,protectedColumnOverlay:ws,renameIcon:Zi,headerArrowDown:Cs,headerArrowUp:ys},xs=tn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),ks=i.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},i.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Rs=i.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},i.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Ms=i.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},i.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Ss=10,Ts=t=>{const{canvasRef:l,cellYOffset:u,rows:m,columns:w,searchInputRef:R,searchValue:D,searchResults:b,onSearchValueChange:S,getCellsForSelection:H,onSearchResultsChanged:p,showSearch:y=!1,onSearchClose:T}=t,[V]=i.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[Y,X]=i.useState(""),de=D??Y,ve=i.useCallback(F=>{X(F),S==null||S(F)},[S]),[K,z]=i.useState(),Q=i.useRef(K);Q.current=K,i.useEffect(()=>{b!==void 0&&(b.length>0?z(F=>({rowsSearched:m,results:b.length,selectedIndex:(F==null?void 0:F.selectedIndex)??-1})):z(void 0))},[m,b]);const fe=i.useRef();fe.current===void 0&&(fe.current=new AbortController);const q=i.useRef(),[Z,te]=i.useState([]),se=b??Z,A=i.useCallback(()=>{q.current!==void 0&&(window.cancelAnimationFrame(q.current),q.current=void 0),fe.current!==void 0&&fe.current.abort(),fe.current=new AbortController},[]),Be=i.useRef(u);Be.current=u;const Fe=i.useCallback(F=>{const le=new RegExp(F.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let Ce=Be.current,ye=Math.min(10,m),Je=0;z(void 0),te([]);const Se=[],Qe=async()=>{var qt;if(H===void 0)return;const Ft=performance.now(),At=m-Je;let je=H({x:0,y:Ce,width:w.length,height:Math.min(ye,At,m-Ce)},fe.current.signal);typeof je=="function"&&(je=await je());let vo=!1;for(const[it,st]of je.entries())for(const[yt,De]of st.entries()){let He;switch(De.kind){case U.Text:case U.Number:He=De.displayData;break;case U.Uri:case U.Markdown:He=De.data;break;case U.Boolean:He=typeof De.data=="boolean"?De.data.toString():void 0;break;case U.Image:case U.Bubble:He=De.data.join("üê≥");break;case U.Custom:He=De.copyData;break}He!==void 0&&le.test(He)&&(Se.push([yt,it+Ce]),vo=!0)}const on=performance.now();vo&&te([...Se]),Je+=je.length,jo(Je<=m);const po=((qt=Q.current)==null?void 0:qt.selectedIndex)??-1;z({results:Se.length,rowsSearched:Je,selectedIndex:po}),p==null||p(Se,po),Ce+ye>=m?Ce=0:Ce+=ye;const Yt=on-Ft,Ct=Math.max(Yt,1),nn=Ss/Ct;ye=Math.ceil(ye*nn),Je<m&&Se.length<1e3&&(q.current=window.requestAnimationFrame(Qe))};A(),q.current=window.requestAnimationFrame(Qe)},[A,w.length,H,p,m]),Ie=i.useCallback(()=>{var F;T==null||T(),z(void 0),te([]),p==null||p([],-1),A(),(F=l==null?void 0:l.current)==null||F.focus()},[A,l,T,p]),rt=i.useCallback(F=>{ve(F.target.value),b===void 0&&(F.target.value===""?(z(void 0),te([]),A()):Fe(F.target.value))},[Fe,A,ve,b]);i.useEffect(()=>{R.current!==null&&(ve(""),z(void 0),Z.length>0&&(te([]),p==null||p([],-1)),y?R.current.focus({preventScroll:!0}):A())},[y,R]);const Xe=i.useCallback(F=>{var Ce;if((Ce=F==null?void 0:F.stopPropagation)==null||Ce.call(F),K===void 0||K.results===0)return;const le=(K.selectedIndex+1)%K.results;z({...K,selectedIndex:le}),p==null||p(se,le)},[K,p,se]),$t=i.useCallback(F=>{var Ce;if((Ce=F==null?void 0:F.stopPropagation)==null||Ce.call(F),K===void 0||K.results===0)return;let le=(K.selectedIndex-1)%K.results;le<0&&(le+=K.results),z({...K,selectedIndex:le}),p==null||p(se,le)},[p,se,K]),Ye=i.useCallback(F=>{(F.ctrlKey||F.metaKey)&&F.nativeEvent.code==="KeyF"||F.key==="Escape"?(Ie(),F.stopPropagation(),F.preventDefault()):F.key==="Enter"&&(F.shiftKey?$t():Xe())},[Ie,Xe,$t]);i.useEffect(()=>()=>{A()},[A]);const[lt,go]=i.useState(!1);i.useEffect(()=>{if(y)go(!0);else{const F=setTimeout(()=>go(!1),150);return()=>clearTimeout(F)}},[y]);const mo=i.useMemo(()=>{if(!y&&!lt)return null;let F;K!==void 0&&(F=K.results>=1e3?"over 1000":`${K.results} result${K.results!==1?"s":""}`,K.selectedIndex>=0&&(F=`${K.selectedIndex+1} of ${F}`));const le=Je=>{Je.stopPropagation()},ye={width:`${m>0?Math.floor(((K==null?void 0:K.rowsSearched)??0)/m*100):0}%`};return i.createElement(xs,{className:"gdg-search-bar"+(y?"":" out"),onMouseDown:le,onMouseMove:le,onMouseUp:le,onClick:le},i.createElement("div",{className:"gdg-search-bar-inner"},i.createElement("input",{id:V,"aria-hidden":!y,"data-testid":"search-input",ref:R,onChange:rt,value:de,tabIndex:y?void 0:-1,onKeyDownCapture:Ye}),i.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!y,tabIndex:y?void 0:-1,onClick:$t,disabled:((K==null?void 0:K.results)??0)===0},ks),i.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!y,tabIndex:y?void 0:-1,onClick:Xe,disabled:((K==null?void 0:K.results)??0)===0},Rs),T!==void 0&&i.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!y,"data-testid":"search-close-button",tabIndex:y?void 0:-1,onClick:Ie},Ms)),K!==void 0?i.createElement(i.Fragment,null,i.createElement("div",{className:"gdg-search-status"},i.createElement("div",{"data-testid":"search-result-area"},F)),i.createElement("div",{className:"gdg-search-progress",style:ye})):i.createElement("div",{className:"gdg-search-status"},i.createElement("label",{htmlFor:V},"Type to search")))},[y,lt,K,m,V,R,rt,de,Ye,$t,Xe,T,Ie]);return i.createElement(i.Fragment,null,i.createElement(Ui,{prelightCells:se,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,groupLevels:t.groupLevels,groupHeaderHeights:t.groupHeaderHeights,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY,resizeIndicator:t.resizeIndicator}),mo)},Es=()=>t=>Math.max(16,t.targetHeight-10),zs=tn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Es(),"px"]}}),Ls=t=>{const{bounds:l,group:u,onClose:m,canvasBounds:w,onFinish:R}=t,[D,b]=me.useState(u);return me.createElement(Ci,{style:{position:"absolute",left:l.x-w.left+1,top:l.y-w.top,width:l.width-2,height:l.height},className:"c181oggi",onClickOutside:m},me.createElement(zs,{targetHeight:l.height,"data-testid":"group-rename-input",value:D,onBlur:m,onFocus:S=>S.target.setSelectionRange(0,D.length),onChange:S=>b(S.target.value),onKeyDown:S=>{S.key==="Enter"?R(D):S.key==="Escape"&&m()},autoFocus:!0}))},$n=150;function Is(t,l,u,m){var R;const w=m(l);return((R=w==null?void 0:w.measure)==null?void 0:R.call(w,t,l,u))??$n}function Dr(t,l,u,m,w,R,D,b,S){let H=0;const p=w===void 0?[]:w.map(V=>{const Y=Is(t,V[m],l,S);return H=Math.max(H,Y),Y});if(p.length>5&&b){H=0;let V=0;for(const X of p)V+=X;const Y=V/p.length;for(let X=0;X<p.length;X++)p[X]>=Y*2?p[X]=0:H=Math.max(H,p[X])}const y=t.font;t.font=l.headerFontFull,H=Math.max(H,t.measureText(u.title).width+l.cellHorizontalPadding*2+(u.icon===void 0?0:28)),t.font=y;const T=Math.max(Math.ceil(R),Math.min(Math.floor(D),Math.ceil(H)));return{...u,width:T}}function Ds(t,l,u,m,w,R,D,b,S){const H=i.useRef(l),p=i.useRef(u),y=i.useRef(D);H.current=l,p.current=u,y.current=D;const[T,V]=i.useMemo(()=>{if(typeof window>"u")return[null,null];const K=document.createElement("canvas");return K.style.display="none",K.style.opacity="0",K.style.position="fixed",[K,K.getContext("2d",{alpha:!1})]},[]);i.useLayoutEffect(()=>(T&&document.documentElement.append(T),()=>{T==null||T.remove()}),[T]);const Y=i.useRef({}),X=i.useRef(),[de,ve]=i.useState();return i.useLayoutEffect(()=>{const K=p.current;if(K===void 0||t.every(Zo))return;let z=Math.max(1,10-Math.floor(t.length/1e4)),Q=0;z<H.current&&z>1&&(z--,Q=1);const fe={x:0,y:0,width:t.length,height:Math.min(H.current,z)},q={x:0,y:H.current-1,width:t.length,height:1};(async()=>{const te=K(fe,S.signal),se=Q>0?K(q,S.signal):void 0;let A;typeof te=="object"?A=te:A=await yr(te),se!==void 0&&(typeof se=="object"?A=[...A,...se]:A=[...A,...await yr(se)]),X.current=t,ve(A)})()},[S.signal,t]),i.useMemo(()=>{let z=t.every(Zo)?t:V===null?t.map(Z=>Zo(Z)?Z:{...Z,width:$n}):(V.font=y.current.baseFontFull,t.map((Z,te)=>{if(Zo(Z))return Z;if(Y.current[Z.id]!==void 0)return{...Z,width:Y.current[Z.id]};if(de===void 0||X.current!==t||Z.id===void 0)return{...Z,width:$n};const se=Dr(V,D,Z,te,de,w,R,!0,b);return Y.current[Z.id]=se.width,se})),Q=0,fe=0;const q=[];for(const[Z,te]of z.entries())Q+=te.width,te.grow!==void 0&&te.grow>0&&(fe+=te.grow,q.push(Z));if(Q<m&&q.length>0){const Z=[...z],te=m-Q;let se=te;for(let A=0;A<q.length;A++){const Be=q[A],Fe=(z[Be].grow??0)/fe,Ie=A===q.length-1?se:Math.min(se,Math.floor(te*Fe));Z[Be]={...z[Be],growOffset:Ie,width:z[Be].width+Ie},se-=Ie}z=Z}return{sizedColumns:z,nonGrowWidth:Q}},[m,t,V,de,D,w,R,b])}function Hs(t,l){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===l.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===l.keyCode:t===l.key}function O(t,l,u){const m=Hr(t,l);return m&&(u.didMatch=!0),m}function Hr(t,l){if(t.length===0)return!1;if(t.includes("|")){const S=t.split("|");for(const H of S)if(Hr(H,l))return!0;return!1}let u=!1,m=!1,w=!1,R=!1;const D=t.split("+"),b=D.pop();if(!Hs(b,l))return!1;if(D[0]==="any")return!0;for(const S of D)switch(S){case"ctrl":u=!0;break;case"shift":m=!0;break;case"alt":w=!0;break;case"meta":R=!0;break;case"primary":en.value?R=!0:u=!0;break}return l.altKey===w&&l.ctrlKey===u&&l.shiftKey===m&&l.metaKey===R}function $s(t,l,u,m,w,R,D){const b=me.useCallback((p,y,T,V)=>{var z;(R==="cell"||R==="multi-cell")&&p!==void 0&&(p={...p,range:{x:p.cell[0],y:p.cell[1],width:1,height:1}}),!D&&p!==void 0&&p.range.width>1&&(p={...p,range:{...p.range,width:1,x:p.cell[0]}});const Y=u==="mixed"&&(T||V==="drag")||u==="additive",X=(m==="mixed"||m==="additive")&&Y,de=T||(w==="mixed"||w==="additive")&&Y;let ve={current:p===void 0?void 0:{...p,rangeStack:V==="drag"?((z=t.current)==null?void 0:z.rangeStack)??[]:[]},columns:X?t.columns:ne.empty(),rows:de?t.rows:ne.empty()};T&&(R==="multi-rect"||R==="multi-cell")&&ve.current!==void 0&&t.current!==void 0&&(ve={...ve,current:{...ve.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),l(ve,y)},[m,t,u,R,D,w,l]),S=me.useCallback((p,y,T)=>{p=p??t.rows,y!==void 0&&(p=p.add(y));let V;if(w==="exclusive"&&p.length>0)V={current:void 0,columns:ne.empty(),rows:p};else{const Y=T&&u==="mixed"||u==="additive",X=T&&m==="mixed"||m==="additive";V={current:Y?t.current:void 0,columns:X?t.columns:ne.empty(),rows:p}}l(V,!1)},[m,t,u,w,l]),H=me.useCallback((p,y,T)=>{p=p??t.columns,y!==void 0&&(p=p.add(y));let V;if(m==="exclusive"&&p.length>0)V={current:void 0,rows:ne.empty(),columns:p};else{const Y=T&&u==="mixed"||u==="additive",X=T&&w==="mixed"||w==="additive";V={current:Y?t.current:void 0,rows:X?t.rows:ne.empty(),columns:p}}l(V,!1)},[m,t,u,w,l]);return[b,S,H]}function Fs(t,l,u,m,w){const R=i.useCallback(H=>{if(t===!0){const p=[];for(let y=H.y;y<H.y+H.height;y++){const T=[];for(let V=H.x;V<H.x+H.width;V++)V<0||y>=w?T.push({kind:U.Loading,allowOverlay:!1}):T.push(l([V,y]));p.push(T)}return p}return(t==null?void 0:t(H,m.signal))??[]},[m.signal,l,t,w]),D=t!==void 0?R:void 0,b=i.useCallback(H=>{if(D===void 0)return[];const p={...H,x:H.x-u};if(p.x<0){p.x=0,p.width--;const y=D(p,m.signal);return typeof y=="function"?async()=>(await y()).map(T=>[{kind:U.Loading,allowOverlay:!1},...T]):y.map(T=>[{kind:U.Loading,allowOverlay:!1},...T])}return D(p,m.signal)},[m.signal,D,u]);return[t!==void 0?b:void 0,D]}function Er(t){return typeof t=="string"?t:`${t}px`}const As=()=>t=>t.innerWidth,Gs=()=>t=>t.innerHeight,Ks=tn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[As()],"w2q57ts-1":[Gs()]}}),Ps=t=>{const{inWidth:l,inHeight:u,children:m,...w}=t;return i.createElement(Ks,{innerHeight:Er(u),innerWidth:Er(l),...w},m)},Ns=2,Ws=1300;function Vs(t,l,u){const m=me.useRef(0),[w,R]=t??[0,0];me.useEffect(()=>{if(w===0&&R===0){m.current=0;return}let D=!1,b=0;const S=H=>{var p;if(!D){if(b===0)b=H;else{const y=H-b;m.current=Math.min(1,m.current+y/Ws);const T=m.current**1.618*y*Ns;(p=l.current)==null||p.scrollBy(w*T,R*T),b=H,u==null||u()}window.requestAnimationFrame(S)}};return window.requestAnimationFrame(S),()=>{D=!0}},[l,w,R,u])}function Bs({rowHeight:t,headerHeight:l,groupHeaderHeight:u,theme:m,overscrollX:w,overscrollY:R,scaleToRem:D,remSize:b}){const[S,H,p,y,T,V]=me.useMemo(()=>{if(!D||b===16)return[t,l,u,m,w,R];const Y=b/16,X=t,de=Lr();return[typeof X=="number"?X*Y:ve=>Math.ceil(X(ve)*Y),Math.ceil(l*Y),Math.ceil(u*Y),{...m,headerIconSize:((m==null?void 0:m.headerIconSize)??de.headerIconSize)*Y,cellHorizontalPadding:((m==null?void 0:m.cellHorizontalPadding)??de.cellHorizontalPadding)*Y,cellVerticalPadding:((m==null?void 0:m.cellVerticalPadding)??de.cellVerticalPadding)*Y},Math.ceil((w??0)*Y),Math.ceil((R??0)*Y)]},[u,l,w,R,b,t,D,m]);return{rowHeight:S,headerHeight:H,groupHeaderHeight:p,theme:y,overscrollX:T,overscrollY:V}}const vt={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function _(t,l){return t===!0?l:t===!1?"":t}function zr(t){const l=en.value;return{activateCell:_(t.activateCell," |Enter|shift+Enter"),clear:_(t.clear,"any+Escape"),closeOverlay:_(t.closeOverlay,"any+Escape"),acceptOverlayDown:_(t.acceptOverlayDown,"Enter"),acceptOverlayUp:_(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:_(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:_(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:_(t.delete,l?"Backspace|Delete":"Delete"),downFill:_(t.downFill,"primary+_68"),scrollToSelectedCell:_(t.scrollToSelectedCell,"primary+Enter"),goDownCell:_(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:_(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:_(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:_(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:_(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:_(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:_(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:_(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:_(t.goToFirstCell,"primary+Home"),goToFirstColumn:_(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:_(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:_(t.goToLastCell,"primary+End"),goToLastColumn:_(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:_(t.goToLastRow,"primary+ArrowDown"),goToNextPage:_(t.goToNextPage,"PageDown"),goToPreviousPage:_(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:_(t.rightFill,"primary+_82"),search:_(t.search,"primary+f"),selectAll:_(t.selectAll,"primary+a"),selectColumn:_(t.selectColumn,"ctrl+ "),selectGrowDown:_(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:_(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:_(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:_(t.selectGrowUp,"shift+ArrowUp"),selectRow:_(t.selectRow,"shift+ "),selectToFirstCell:_(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:_(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:_(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:_(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:_(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:_(t.selectToLastRow,"primary+shift+ArrowDown")}}function Us(t){const l=yi(t);return me.useMemo(()=>{if(l===void 0)return zr(vt);const u={...l,goToNextPage:(l==null?void 0:l.goToNextPage)??(l==null?void 0:l.pageDown)??vt.goToNextPage,goToPreviousPage:(l==null?void 0:l.goToPreviousPage)??(l==null?void 0:l.pageUp)??vt.goToPreviousPage,goToFirstCell:(l==null?void 0:l.goToFirstCell)??(l==null?void 0:l.first)??vt.goToFirstCell,goToLastCell:(l==null?void 0:l.goToLastCell)??(l==null?void 0:l.last)??vt.goToLastCell,selectToFirstCell:(l==null?void 0:l.selectToFirstCell)??(l==null?void 0:l.first)??vt.selectToFirstCell,selectToLastCell:(l==null?void 0:l.selectToLastCell)??(l==null?void 0:l.last)??vt.selectToLastCell};return zr({...vt,...u})},[l])}function Os(t){function l(m,w,R){if(typeof m=="number")return{headerIndex:m,isCollapsed:!1,depth:w,path:R};const D={headerIndex:m.headerIndex,isCollapsed:m.isCollapsed,depth:w,path:R};return m.subGroups!==void 0&&(D.subGroups=m.subGroups.map((b,S)=>l(b,w+1,[...R,S])).sort((b,S)=>b.headerIndex-S.headerIndex)),D}return t.map((m,w)=>l(m,0,[w])).sort((m,w)=>m.headerIndex-w.headerIndex)}function An(t,l){const u=[];function m(b,S,H=!1){let p=S!==null?S-b.headerIndex:l-b.headerIndex;if(b.subGroups!==void 0&&(p=b.subGroups[0].headerIndex-b.headerIndex),p--,u.push({rowIndex:-1,headerIndex:b.headerIndex,contentIndex:-1,skip:H,isCollapsed:b.isCollapsed,depth:b.depth,path:b.path,rows:p}),b.subGroups)for(let y=0;y<b.subGroups.length;y++){const T=y<b.subGroups.length-1?b.subGroups[y+1].headerIndex:S;m(b.subGroups[y],T,H||b.isCollapsed)}}const w=Os(t.groups);for(let b=0;b<w.length;b++){const S=b<w.length-1?w[b+1].headerIndex:null;m(w[b],S)}let R=0,D=0;for(const b of u)b.contentIndex=D,D+=b.rows,b.rowIndex=R,R+=b.isCollapsed?1:b.rows+1;return u.filter(b=>b.skip===!1).map(b=>{const{skip:S,...H}=b;return H})}function Fn(t,l){if(l===void 0||An.length===0)return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1};let u=t;for(const m of l){if(u===0)return{path:[...m.path,-1],originalIndex:m.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:m.rows};if(m.isCollapsed)u--;else{if(u<=m.rows)return{path:[...m.path,u-1],originalIndex:m.headerIndex+u,isGroupHeader:!1,groupIndex:u-1,contentIndex:m.contentIndex+u-1,groupRows:m.rows};u=u-m.rows-1}}return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1}}function _s(t,l,u,m){const w=me.useMemo(()=>t===void 0?void 0:An(t,l),[t,l]),R=me.useMemo(()=>w==null?void 0:w.reduce((p,y)=>(p[y.rowIndex]=y,p),{}),[w]),D=me.useMemo(()=>w===void 0?l:w.reduce((p,y)=>p+(y.isCollapsed?1:y.rows+1),0),[w,l]),b=me.useMemo(()=>t===void 0||typeof u=="number"&&t.height===u?u:p=>R!=null&&R[p]?t.height:typeof u=="number"?u:u(p),[R,t,u]),S=me.useCallback(p=>{if(w===void 0)return p;let y=p;for(const T of w){if(y===0)return;if(y--,!T.isCollapsed){if(y<T.rows)return T.contentIndex+y;y-=T.rows}}return p},[w]),H=wt(m??(t==null?void 0:t.themeOverride),me.useCallback(p=>{if(t===void 0)return m==null?void 0:m(p,p,p);if(m===void 0&&(t==null?void 0:t.themeOverride)===void 0)return;const{isGroupHeader:y,contentIndex:T,groupIndex:V}=Fn(p,w);return y?t.themeOverride:m==null?void 0:m(p,V,T)},[w,m,t]));return t===void 0?{rowHeight:b,rows:l,rowNumberMapper:S,getRowThemeOverride:H}:{rowHeight:b,rows:D,rowNumberMapper:S,getRowThemeOverride:H}}function Xs(t,l){const u=me.useMemo(()=>t===void 0?void 0:An(t,l),[t,l]);return{getRowGroupingForPath:Fr,updateRowGroupingByPath:$r,mapper:me.useCallback(m=>{if(typeof m=="number")return Fn(m,u);const w=Fn(m[1],u);return{...w,originalIndex:[m[0],w.originalIndex]}},[u])}}function $r(t,l,u){const[m,...w]=l;return w[0]===-1?t.map((R,D)=>D===m?{...R,...u}:R):t.map((R,D)=>D===m?{...R,subGroups:$r(R.subGroups??[],w,u)}:R)}function Fr(t,l){const[u,...m]=l;return m[0]===-1?t[u]:Fr(t[u].subGroups??[],m)}function Ys(t,l){const[u]=i.useState(()=>({value:t,callback:l,facade:{get current(){return u.value},set current(m){const w=u.value;w!==m&&(u.value=m,u.callback(m,w))}}}));return u.callback=l,u.facade}function qs(t,l,u,m,w){const[R,D]=i.useMemo(()=>[l!==void 0&&typeof u=="number"?Math.floor(l/u):0,l!==void 0&&typeof u=="number"?-(l%u):0],[l,u]),b=i.useMemo(()=>({x:m.current.x,y:R,width:m.current.width??1,height:m.current.height??1,ty:D}),[m,D,R]),[S,H,p]=bi(b),y=i.useRef(w);y.current=w;const T=Ys(null,X=>{X!==null&&l!==void 0?X.scrollTop=l:X!==null&&t!==void 0&&(X.scrollLeft=t)}),V=(S.height??1)>1;i.useLayoutEffect(()=>{if(l!==void 0&&T.current!==null&&V){if(T.current.scrollTop===l)return;T.current.scrollTop=l,T.current.scrollTop!==l&&p(),y.current()}},[l,V,p,T]);const Y=(S.width??1)>1;return i.useLayoutEffect(()=>{if(t!==void 0&&T.current!==null&&Y){if(T.current.scrollLeft===t)return;T.current.scrollLeft=t,T.current.scrollLeft!==t&&p(),y.current()}},[t,Y,p,T]),{visibleRegion:S,setVisibleRegion:H,scrollRef:T}}const Zs=tn("textarea")({name:"GhostInputBox",class:"gxeqqyx",propsAsIs:!1}),Js=(t,l)=>{const{onInput:u,onCompositionStart:m,onCompositionEnd:w,onKeyDown:R,onKeyUp:D,onFocus:b,onBlur:S,disabled:H=!1}=t,p=i.useRef(null),y=i.useRef(!1),T=i.useRef({width:0,height:0}),V=i.useCallback(()=>{const z=p.current;if(!z||z.style.opacity==="0")return;const Q=T.current.width,fe=T.current.height;z.style.width=`${Q}px`,z.style.height=`${fe}px`;const q=Math.max(Q,z.scrollWidth+2),Z=Math.max(fe,z.scrollHeight+2);z.style.width=`${q}px`,z.style.height=`${Z}px`},[]);i.useImperativeHandle(l,()=>({focus:()=>{var z;(z=p.current)==null||z.focus({preventScroll:!0})},blur:()=>{var z;(z=p.current)==null||z.blur()},clear:()=>{p.current&&(p.current.value="",p.current.setSelectionRange(0,0))},getValue:()=>{var z;return((z=p.current)==null?void 0:z.value)??""},setValue:z=>{if(p.current){p.current.value=z;const Q=z.length;p.current.setSelectionRange(Q,Q)}},setPosition:(z,Q,fe,q)=>{const Z=p.current;Z&&(T.current={width:fe,height:q},Z.style.left=`${z}px`,Z.style.top=`${Q}px`,Z.style.width=`${fe}px`,Z.style.height=`${q}px`)},setVisible:z=>{const Q=p.current;Q&&(z?(Q.style.opacity="1",Q.style.pointerEvents="auto",Q.style.zIndex="10000"):(Q.style.left="-9999px",Q.style.top="0",Q.style.width="1px",Q.style.height="1px",Q.style.opacity="0",Q.style.pointerEvents="none",Q.style.zIndex="0"))}}));const Y=i.useCallback(z=>{const Q=z.currentTarget;u(Q.value,y.current),V()},[u,V]),X=i.useCallback(()=>{y.current=!0,m()},[m]),de=i.useCallback(z=>{y.current=!1,w(z.currentTarget.value)},[w]),ve=i.useCallback(z=>{R(z)},[R]),K=i.useCallback(z=>{D==null||D(z)},[D]);return i.createElement(Zs,{ref:p,defaultValue:"",tabIndex:H?-1:0,disabled:H,onInput:Y,onCompositionStart:X,onCompositionEnd:de,onKeyDown:ve,onKeyUp:K,onFocus:b,onBlur:S,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},Qs=i.memo(i.forwardRef(Js)),js=i.lazy(async()=>await pi(()=>import("./image-window-loader-Ce11dqI5.js").then(t=>t.$),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let ec=0;function tc(t){return Bi(Tr(Tr(t).filter(l=>l.span!==void 0).map(l=>{var u,m;return Xt((((u=l.span)==null?void 0:u[0])??0)+1,(((m=l.span)==null?void 0:m[1])??0)+1)})))}function Qo(t,l){return t===void 0||l===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+l,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+l},rangeStack:t.current.rangeStack.map(u=>({...u,x:u.x+l}))},rows:t.rows,columns:t.columns.offset(l)}}const pt={kind:U.Loading,allowOverlay:!1},Hn={columns:ne.empty(),rows:ne.empty(),current:void 0},oc=(t,l)=>{var pr,wr,Cr;const[u,m]=i.useState(Hn),[w,R]=i.useState(),D=i.useRef(null),b=i.useRef(null),[S,H]=i.useState(),p=i.useRef(void 0),y=i.useRef(null),[T,V]=i.useState(!1),Y=i.useRef(T);Y.current=T;const X=i.useRef(w);X.current=w;const de=typeof window>"u"?null:window,{imageEditorOverride:ve,getRowThemeOverride:K,markdownDivCreateNode:z,width:Q,height:fe,columns:q,rows:Z,getCellContent:te,onCellClicked:se,onCellActivated:A,onFillPattern:Be,onFinishedEditing:Fe,coercePasteValue:Ie,drawHeader:rt,drawCell:Xe,editorBloom:$t,onHeaderClicked:Ye,onColumnProposeMove:lt,rangeSelectionColumnSpanning:go=!0,spanRangeBehavior:mo="default",onGroupHeaderClicked:F,onCellContextMenu:le,className:Ce,onHeaderContextMenu:ye,getCellsForSelection:Je,onGroupHeaderContextMenu:Se,onGroupHeaderRenamed:Qe,onCellEdited:Ft,onCellsEdited:At,onSearchResultsChanged:je,searchResults:vo,onSearchValueChange:on,searchValue:po,onKeyDown:Yt,onKeyUp:Ct,keybindings:nn,editOnType:qt=!0,onRowAppended:it,onColumnAppended:st,onColumnMoved:yt,validateCell:De,highlightRegions:He,rangeSelect:bt="rect",columnSelect:$e="multi",rowSelect:Ae="multi",rangeSelectionBlending:Ar="exclusive",columnSelectionBlending:Gr="exclusive",rowSelectionBlending:Kr="exclusive",onDelete:rn,onDragStart:wo,onMouseMove:Co,onPaste:xt,copyHeaders:Gn=!1,freezeColumns:et=0,cellActivationBehavior:yo="second-click",rowSelectionMode:ln="auto",columnSelectionMode:Zt="auto",onHeaderMenuClick:bo,onHeaderIndicatorClick:xo,getGroupDetails:ko,rowGrouping:ct,onSearchClose:sn,onItemHovered:Ro,onSelectionCleared:at,showSearch:Pr,onVisibleRegionChanged:Mo,gridSelection:kt,onGridSelectionChange:cn,minColumnWidth:Nr=50,maxColumnWidth:Wr=500,maxColumnAutoWidth:Vr,provideEditor:Br,trailingRowOptions:j,freezeTrailingRows:tt=0,allowedFillDirections:Kn="orthogonal",scrollOffsetX:Ur,scrollOffsetY:Or,verticalBorder:Gt,onDragOverCell:_r,onDrop:Xr,onColumnResize:Jt,onColumnResizeEnd:Qt,onColumnResizeStart:jt,customRenderers:So,fillHandle:Yr,experimental:he,fixedShadowX:qr,fixedShadowY:Zr,headerIcons:Jr,imageWindowLoader:Qr,initialSize:jr,isDraggable:el,onDragLeave:tl,onRowMoved:eo,overscrollX:ol,overscrollY:nl,preventDiagonalScrolling:rl,rightElement:ll,rightElementProps:il,trapFocus:Pn=!1,smoothScrollX:sl,smoothScrollY:cl,scaleToRem:al=!1,rowHeight:ul=34,headerHeight:Nn=36,groupHeaderHeight:dl=Nn,theme:fl,isOutsideClick:hl,renderers:an,resizeIndicator:gl,scrollToActiveCell:Wn=!0,drawFocusRing:Vn=!0,portalElementRef:To,onRowStatus:Eo,onRowId:zo}=t,Bn=Vn==="no-editor"?w===void 0:Vn,W=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,ml=(W==null?void 0:W.rowNumber)??!1;let Lo=(W==null?void 0:W.kind)??t.rowMarkers??"none",ot=ml;(Lo==="both"||Lo==="checkbox-and-number")&&(Lo="checkbox",ot=!0);const Ge=Lo,vl=(W==null?void 0:W.width)??t.rowMarkerWidth,un=(W==null?void 0:W.startIndex)??t.rowMarkerStartIndex??1,dn=(W==null?void 0:W.theme)??t.rowMarkerTheme,fn=W==null?void 0:W.headerTheme,Un=W==null?void 0:W.headerAlwaysVisible,Io=Ae!=="multi"||(W==null?void 0:W.headerDisabled)===!0,Kt=(W==null?void 0:W.checkboxStyle)??"square",pl=(W==null?void 0:W.rowStatus)??!1,On=(W==null?void 0:W.rowStatusWidth)??40,Do=W==null?void 0:W.rowStatusTheme,wl=(W==null?void 0:W.rowId)??!1,_n=(W==null?void 0:W.rowIdWidth)??80,Ho=W==null?void 0:W.rowIdTheme,Pt=Math.max(Nr,20),$o=Math.max(Wr,Pt),Cl=Math.max(Vr??$o,Pt),Xn=i.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:G,rowNumberMapper:hn,rowHeight:yl,getRowThemeOverride:nt}=_s(ct,Z,ul,K),bl=i.useMemo(()=>Number.parseFloat(Xn.fontSize),[Xn]),{rowHeight:ut,headerHeight:Yn,groupHeaderHeight:gn,theme:qn,overscrollX:xl,overscrollY:kl}=Bs({groupHeaderHeight:dl,headerHeight:Nn,overscrollX:ol,overscrollY:nl,remSize:bl,rowHeight:yl,scaleToRem:al,theme:fl}),dt=Us(nn),Rt=vl??(Z>1e4?48:Z>1e3?44:Z>100?36:32),qe=Ge!=="none",to=pl===!0,oo=wl===!0,d=(qe?ot?2:1:0)+(to?1:0)+(oo?1:0),ce=j!==void 0,no=(j==null?void 0:j.sticky)===!0,[Rl,Zn]=i.useState(!1),Ml=Pr??Rl,Sl=i.useCallback(()=>{sn!==void 0?sn():Zn(!1)},[sn]),h=i.useMemo(()=>kt===void 0?void 0:Qo(kt,d),[kt,d])??u,Ke=i.useRef(new AbortController);i.useEffect(()=>()=>Ke==null?void 0:Ke.current.abort(),[]);const[pe,Tl]=Fs(Je,te,d,Ke.current,G),El=i.useCallback((e,o,n)=>{if(De===void 0)return!0;const r=[e[0]-d,e[1]];return De==null?void 0:De(r,o,n)},[d,De]),Fo=i.useRef(kt),Pe=i.useCallback((e,o)=>{o&&(e=xi(e,pe,d,mo,Ke.current)),cn!==void 0?(Fo.current=Qo(e,-d),cn(Fo.current)):m(e)},[cn,pe,d,mo]),Nt=wt(Jt,i.useCallback((e,o,n,r)=>{Jt==null||Jt(q[n-d],o,n-d,r)},[Jt,d,q])),zl=wt(Qt,i.useCallback((e,o,n,r)=>{Qt==null||Qt(q[n-d],o,n-d,r)},[Qt,d,q])),Ll=wt(jt,i.useCallback((e,o,n,r)=>{jt==null||jt(q[n-d],o,n-d,r)},[jt,d,q])),Il=wt(rt,i.useCallback((e,o)=>(rt==null?void 0:rt({...e,columnIndex:e.columnIndex-d},o))??!1,[rt,d])),Dl=wt(Xe,i.useCallback((e,o)=>(Xe==null?void 0:Xe({...e,col:e.col-d},o))??!1,[Xe,d])),ft=i.useCallback(e=>{if(rn!==void 0){const o=rn(Qo(e,-d));return typeof o=="boolean"?o:Qo(o,d)}return!0},[rn,d]),[we,Re,ge]=$s(h,Pe,Ar,Gr,Kr,bt,go),be=i.useMemo(()=>In(Lr(),qn),[qn]),[mn,Hl]=i.useState([0,0,0]),Jn=i.useMemo(()=>{if(an===void 0)return{};const e={};for(const o of an)e[o.kind]=o;return e},[an]),Me=i.useCallback(e=>e.kind!==U.Custom?Jn[e.kind]:So==null?void 0:So.find(o=>o.isMatch(e)),[So,Jn]);let{sizedColumns:Ne,nonGrowWidth:Qn}=Ds(q,G,Tl,mn[0]-(d===0?0:Rt)-mn[2],Pt,Cl,be,Me,Ke.current);Ge!=="none"&&(Qn+=Rt);const ro=i.useMemo(()=>{let e=0;for(const o of Ne)o.group!==void 0&&(typeof o.group=="string"?e=Math.max(e,1):e=Math.max(e,o.group.length));return e},[Ne]),jn=ro>0,er=i.useMemo(()=>ro===0?[]:Array(ro).fill(gn),[ro,gn]),$l=er.reduce((e,o)=>e+o,0),lo=Yn+$l,tr=h.rows.length,or=Ge==="none"?void 0:tr===0?!1:tr===G?!0:void 0,J=i.useMemo(()=>{const e=[];return Ge!=="none"&&(ot&&e.push({title:"",width:Rt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:dn,rowMarker:Kt,rowMarkerChecked:!1,headerRowMarkerTheme:fn,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),e.push({title:"",width:Rt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:dn,rowMarker:Kt,rowMarkerChecked:or,headerRowMarkerTheme:fn,headerRowMarkerAlwaysVisible:Un,headerRowMarkerDisabled:Io})),to&&e.push({title:"",width:On,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Do}),oo&&e.push({title:"ID",width:_n,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Ho}),[...e,...Ne]},[to,On,Do,oo,_n,Ho,Ge,Ne,Rt,dn,Kt,or,fn,Un,Io,ot]),Te=i.useRef({height:1,width:1,x:0,y:0}),Ao=i.useRef(!1),{setVisibleRegion:nr,visibleRegion:Mt,scrollRef:ee}=qs(Ur,Or,ut,Te,()=>Ao.current=!0);Te.current=Mt;const Fl=Mt.x+d,Go=Mt.y,ae=i.useRef(null),xe=i.useCallback(e=>{var o;e===!0?(o=y.current)==null||o.focus():window.requestAnimationFrame(()=>{var n;(n=y.current)==null||n.focus()})},[]),ke=ce?G+1:G,Ee=i.useCallback(e=>{const o=d===0?e:e.map(r=>({...r,location:[r.location[0]-d,r.location[1]]})),n=At==null?void 0:At(o);if(n!==!0)for(const r of o)Ft==null||Ft(r.location,r.value);return n},[Ft,At,d]),[St,vn]=i.useState(),Ko=h.current!==void 0&&h.current.range.width*h.current.range.height>1?h.current.range:void 0,Wt=Bn?(pr=h.current)==null?void 0:pr.cell:void 0,Po=Wt==null?void 0:Wt[0],No=Wt==null?void 0:Wt[1],Al=i.useMemo(()=>{if((He===void 0||He.length===0)&&(Ko??Po??No??St)===void 0)return;const e=[];if(He!==void 0)for(const o of He){const n=J.length-o.range.x-d;n>0&&e.push({color:o.color,range:{...o.range,x:o.range.x+d,width:Math.min(n,o.range.width)},style:o.style})}return St!==void 0&&e.push({color:br(be.accentColor,0),range:St,style:"dashed"}),Ko!==void 0&&e.push({color:br(be.accentColor,.5),range:Ko,style:"solid-outline"}),Po!==void 0&&No!==void 0&&e.push({color:be.accentColor,range:{x:Po,y:No,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[St,Ko,Po,No,He,J.length,be.accentColor,d]),rr=i.useRef(J);rr.current=J;const ue=i.useCallback(([e,o],n=!1)=>{var v,C,k,x,P,M,B,$,E;const r=ce&&o===ke-1;let s=0,f=-1,c=-1,a=-1,g=-1;if(qe&&ot&&(f=s++),qe&&(c=s++),to&&(a=s++),oo&&(g=s++),e===f){if(r)return pt;const L=hn(o);return L===void 0?pt:{kind:It.Marker,allowOverlay:!1,checkboxStyle:Kt,checked:!1,markerKind:"number",row:un+L,drawHandle:!1,cursor:void 0,disabled:((v=t.disabledRows)==null?void 0:v.call(t,o))===!0}}if(e===c){if(r)return pt;const L=hn(o);if(L===void 0)return pt;let N;return ot?N=Ge==="checkbox-visible"?"checkbox-visible":"checkbox":Ge==="clickable-number"?N="number":N=Ge,{kind:It.Marker,allowOverlay:!1,checkboxStyle:Kt,checked:(h==null?void 0:h.rows.hasIndex(o))===!0,markerKind:N,row:un+L,drawHandle:eo!==void 0,cursor:ot?void 0:Ge==="clickable-number"?"pointer":void 0,disabled:((C=t.disabledRows)==null?void 0:C.call(t,o))===!0}}if(e===a){if(r)return pt;const L=Eo==null?void 0:Eo(o);return{kind:It.RowStatus,allowOverlay:!1,status:L,themeOverride:Do}}if(e===g){if(r)return pt;const L=zo==null?void 0:zo(o);return{kind:It.RowId,allowOverlay:!1,rowId:L,themeOverride:Ho}}if(r){const N=e===d?(j==null?void 0:j.hint)??"":"",I=rr.current[e];if(((k=I==null?void 0:I.trailingRowOptions)==null?void 0:k.disabled)===!0)return pt;{const oe=((x=I==null?void 0:I.trailingRowOptions)==null?void 0:x.hint)??N,ze=((P=I==null?void 0:I.trailingRowOptions)==null?void 0:P.addIcon)??(j==null?void 0:j.addIcon);return{kind:It.NewRow,hint:oe,allowOverlay:!1,icon:ze}}}else{const L=e-d;if(n||(he==null?void 0:he.strict)===!0){const I=Te.current,oe=I.x>L||L>I.x+I.width||I.y>o||o>I.y+I.height||o>=yn.current,ze=L===((B=(M=I.extras)==null?void 0:M.selected)==null?void 0:B[0])&&o===(($=I.extras)==null?void 0:$.selected[1]);let Le=!1;if(((E=I.extras)==null?void 0:E.freezeRegions)!==void 0){for(const Ve of I.extras.freezeRegions)if(ki(Ve,L,o)){Le=!0;break}}if(oe&&!ze&&!Le)return pt}let N=te([L,o]);return d!==0&&N.span!==void 0&&(N={...N,span:[N.span[0]+d,N.span[1]+d]}),N}},[ce,ke,to,Eo,Do,oo,zo,Ho,qe,hn,Kt,h==null?void 0:h.rows,Ge,un,eo,d,j==null?void 0:j.hint,j==null?void 0:j.addIcon,he==null?void 0:he.strict,te,ot]),pn=i.useCallback(e=>{let o=(ko==null?void 0:ko(e))??{name:e};return Qe!==void 0&&e!==""&&(o={icon:o.icon,name:o.name,overrideTheme:o.overrideTheme,actions:[...o.actions??[],{title:"Rename",icon:"renameIcon",onClick:n=>xn({group:o.name,bounds:n.bounds})}]}),o},[ko,Qe]),Wo=i.useCallback(e=>{var a;const[o,n]=e.cell,r=J[o],s=(r==null?void 0:r.group)!==void 0?(a=pn(r.group))==null?void 0:a.overrideTheme:void 0,f=r==null?void 0:r.themeOverride,c=nt==null?void 0:nt(n);R({...e,theme:In(be,s,f,c,e.content.themeOverride)})},[nt,J,pn,be]),Ue=i.useCallback((e,o,n)=>{var c,a,g,v,C,k,x;if(h.current===void 0)return;const[r,s]=h.current.cell,f=ue([r,s]);if(f.kind!==U.Boolean&&f.allowOverlay){let P=f;if(n!==void 0)switch(P.kind){case U.Number:{const $=Ri(()=>n==="-"?-0:Number.parseFloat(n),0);P={...P,data:Number.isNaN($)?0:$};break}case U.Text:case U.Markdown:case U.Uri:P={...P,data:n};break}Wo({target:e,content:P,initialValue:n,cell:[r,s],highlight:n===void 0,forceEditMode:n!==void 0,activation:o});const M=P.kind===U.Custom;n!==void 0&&!M?((c=y.current)==null||c.setPosition(e.x,e.y,e.width,e.height),n.length>0&&((a=y.current)==null||a.setValue(n)),(g=y.current)==null||g.setVisible(!0),V(!0)):M&&n!==void 0&&((v=y.current)==null||v.clear(),(C=y.current)==null||C.setVisible(!1),(k=y.current)==null||k.blur(),V(!1))}else f.kind===U.Boolean&&o.inputType==="keyboard"&&f.readonly!==!0&&(Ee([{location:h.current.cell,value:{...f,data:xr(f.data)}}]),(x=ae.current)==null||x.damage([{cell:h.current.cell}]))},[ue,h,Ee,Wo]),lr=i.useCallback((e,o)=>{var s;const n=(s=ae.current)==null?void 0:s.getBounds(e,o);if(n===void 0||ee.current===null)return;const r=ue([e,o]);r.allowOverlay&&Wo({target:n,content:r,initialValue:void 0,highlight:!0,cell:[e,o],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[ue,ee,Wo]),ie=i.useCallback((e,o,n="both",r=0,s=0,f=void 0)=>{if(ee.current!==null){const c=ae.current,a=b.current,g=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,v=typeof o!="number"?o.unit==="cell"?o.amount:void 0:o,C=typeof e!="number"&&e.unit==="px"?e.amount:void 0,k=typeof o!="number"&&o.unit==="px"?o.amount:void 0;if(c!==null&&a!==null){let x={x:0,y:0,width:0,height:0},P=0,M=0;if((g!==void 0||v!==void 0)&&(x=c.getBounds((g??0)+d,v??0)??x,x.width===0||x.height===0))return;const B=a.getBoundingClientRect(),$=B.width/a.offsetWidth;if(C!==void 0&&(x={...x,x:C-B.left-ee.current.scrollLeft,width:1}),k!==void 0&&(x={...x,y:k+B.top-ee.current.scrollTop,height:1}),x!==void 0){const E={x:x.x-r,y:x.y-s,width:x.width+2*r,height:x.height+2*s};let L=0;for(let Ln=0;Ln<et;Ln++)L+=Ne[Ln].width;let N=0;const I=tt+(no?1:0);I>0&&(N=Mi(ke,I,ut));let oe=L*$+B.left+d*Rt*$,ze=B.right,Le=B.top+lo*$,Ve=B.bottom-N*$;const Yo=x.width+r*2;switch(f==null?void 0:f.hAlign){case"start":ze=oe+Yo;break;case"end":oe=ze-Yo;break;case"center":oe=Math.floor((oe+ze)/2)-Yo/2,ze=oe+Yo;break}const qo=x.height+s*2;switch(f==null?void 0:f.vAlign){case"start":Ve=Le+qo;break;case"end":Le=Ve-qo;break;case"center":Le=Math.floor((Le+Ve)/2)-qo/2,Ve=Le+qo;break}oe>E.x?P=E.x-oe:ze<E.x+E.width&&(P=E.x+E.width-ze),Le>E.y?M=E.y-Le:Ve<E.y+E.height&&(M=E.y+E.height-Ve),n==="vertical"||typeof e=="number"&&e<et?P=0:(n==="horizontal"||typeof o=="number"&&o>=ke-I)&&(M=0),(P!==0||M!==0)&&($!==1&&(P/=$,M/=$),ee.current.scrollTo({left:P+ee.current.scrollLeft,top:M+ee.current.scrollTop,behavior:(f==null?void 0:f.behavior)??"auto"}))}}}},[d,tt,Rt,ee,lo,et,Ne,ke,no,ut]),wn=i.useRef(lr),Cn=i.useRef(te);wn.current=lr,Cn.current=te;const yn=i.useRef(G);yn.current=G;const ir=i.useRef(J.length);ir.current=J.length;const ht=i.useCallback(async(e,o=!0,n)=>{var v;const r=J[e];if(((v=r==null?void 0:r.trailingRowOptions)==null?void 0:v.disabled)===!0)return;const s=it==null?void 0:it();let f,c=!0;s!==void 0&&(f=await s,f==="top"&&(c=!1),typeof f=="number"&&(c=!1));let a=0;const g=()=>{if(yn.current<=G){a<500&&window.setTimeout(g,a),a=50+a*2;return}const C=typeof f=="number"?f:c?G:0;Xo.current(e-d,C,"both",0,20,n?{behavior:n}:void 0),we({cell:[e,C],range:{x:e,y:C,width:1,height:1}},!1,!1,"edit");const k=Cn.current([e-d,C]);k.allowOverlay&&Dt(k)&&k.readonly!==!0&&o&&window.setTimeout(()=>{wn.current(e,C)},0)};g()},[J,it,d,G,we]),Vo=i.useCallback(async(e,o=!0)=>{const n=st==null?void 0:st();let r,s=!0;n!==void 0&&(r=await n,r==="left"&&(s=!1),typeof r=="number"&&(s=!1));let f=0;const c=()=>{if(ir.current<=J.length){f<500&&window.setTimeout(c,f),f=50+f*2;return}const a=typeof r=="number"?r:s?J.length:0;ie(a-d,e),we({cell:[a,e],range:{x:a,y:e,width:1,height:1}},!1,!1,"edit");const g=Cn.current([a-d,e]);g.allowOverlay&&Dt(g)&&g.readonly!==!0&&o&&window.setTimeout(()=>{wn.current(a,e)},0)};c()},[J,st,d,ie,we]),Vt=i.useCallback(e=>{var n,r;const o=((r=(n=Ne[e])==null?void 0:n.trailingRowOptions)==null?void 0:r.targetColumn)??(j==null?void 0:j.targetColumn);if(typeof o=="number")return o+(qe?1:0);if(typeof o=="object"){const s=q.indexOf(o);if(s>=0)return s+(qe?1:0)}},[Ne,q,qe,j==null?void 0:j.targetColumn]),gt=i.useRef(void 0),Bt=i.useRef(void 0),io=i.useCallback((e,o)=>{var s;const[n,r]=o;return In(be,(s=J[n])==null?void 0:s.themeOverride,nt==null?void 0:nt(r),e.themeOverride)},[nt,J,be]),{mapper:Tt}=Xs(ct,Z),Oe=ct==null?void 0:ct.navigationBehavior,so=i.useCallback(e=>{var v,C,k;const o=en.value?e.metaKey:e.ctrlKey,n=o&&Ae==="multi",[r,s]=e.location,f=h.columns,c=h.rows,[a,g]=((v=h.current)==null?void 0:v.cell)??[];if(e.kind==="cell"){if(Bt.current=void 0,Et.current=[r,s],r===(ot?1:0)&&qe){if(ce===!0&&s===G||Ge==="number"||Ae==="none")return;const M=ue(e.location);if(M.kind!==It.Marker||M.disabled===!0)return;if(eo!==void 0){const E=Me(M);jo((E==null?void 0:E.kind)===It.Marker);const L=(C=E==null?void 0:E.onClick)==null?void 0:C.call(E,{...e,cell:M,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:io(M,e.location),preventDefault:()=>{}});if(L===void 0||L.checked===M.checked)return}R(void 0),xe();const B=c.hasIndex(s),$=gt.current;if(Ae==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&$!==void 0&&c.hasIndex($)){const E=[Math.min($,s),Math.max($,s)+1];n||ln==="multi"?Re(void 0,E,!0):Re(ne.fromSingleSelection(E),void 0,n)}else Ae==="multi"&&(n||e.isTouch||ln==="multi")?B?Re(c.remove(s),void 0,!0):(Re(void 0,s,!0),gt.current=s):B&&c.length===1?Re(ne.empty(),void 0,o):(Re(ne.fromSingleSelection(s),void 0,o),gt.current=s)}else if(r>=d&&ce&&s===G){const M=Vt(r);ht(M??r)}else if(a!==r||g!==s){const M=ue(e.location),B=Me(M);if((B==null?void 0:B.onSelect)!==void 0){let L=!1;if(B.onSelect({...e,cell:M,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>L=!0,theme:io(M,e.location)}),L)return}if(Oe==="block"&&Tt(s).isGroupHeader)return;const $=no&&s===G,E=no&&h!==void 0&&((k=h.current)==null?void 0:k.cell[1])===G;if((e.shiftKey||e.isLongTouch===!0)&&a!==void 0&&g!==void 0&&h.current!==void 0&&!E){if($)return;const L=Math.min(r,a),N=Math.max(r,a),I=Math.min(s,g),oe=Math.max(s,g);we({...h.current,range:{x:L,y:I,width:N-L+1,height:oe-I+1}},!0,o,"click"),gt.current=void 0,xe()}else{const L=h.rows.length>0;we({cell:[r,s],range:{x:r,y:s,width:1,height:1}},!0,o||L,"click"),gt.current=void 0,R(void 0),xe()}}}else if(e.kind==="header")if(Et.current=[r,s],R(void 0),qe&&r===0)gt.current=void 0,Bt.current=void 0,!Io&&Ae==="multi"&&(c.length!==G?Re(ne.fromSingleSelection([0,G]),void 0,o):Re(ne.empty(),void 0,o),xe());else{const x=Bt.current;if($e==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&x!==void 0&&f.hasIndex(x)){const P=[Math.min(x,r),Math.max(x,r)+1];o||e.isTouch||Zt==="multi"?ge(void 0,P,o):ge(ne.fromSingleSelection(P),void 0,o)}else $e==="multi"&&(o||e.isTouch||Zt==="multi")?(f.hasIndex(r)?ge(f.remove(r),void 0,o):ge(void 0,r,o),Bt.current=r):$e!=="none"&&(f.hasIndex(r)?ge(f.remove(r),void 0,o):ge(ne.fromSingleSelection(r),void 0,o),Bt.current=r);gt.current=void 0,xe()}else e.kind===_t?Et.current=[r,s]:e.kind===kr&&!e.isMaybeScrollbar&&(Pe(Hn,!1),R(void 0),xe(),at==null||at(),gt.current=void 0,Bt.current=void 0)},[Ae,$e,h,qe,d,ce,G,Ge,ue,eo,xe,ln,Zt,Me,io,Re,Vt,ht,Oe,Tt,no,we,Io,ge,Pe,at]),co=i.useRef(!1),Et=i.useRef(void 0),sr=i.useRef(Mt),We=i.useRef(void 0),Gl=i.useCallback(e=>{if(Ut.current=!1,sr.current=Te.current,e.button!==0&&e.button!==1){We.current=void 0;return}const o=performance.now();We.current={button:e.button,time:o,location:e.location},(e==null?void 0:e.kind)==="header"&&(co.current=!0);const n=e.kind==="cell"&&e.isFillHandle;!n&&e.kind!=="cell"&&e.isEdge||(H({previousSelection:h,fillHandle:n}),Et.current=void 0,!e.isTouch&&e.button===0&&!n?so(e):!e.isTouch&&e.button===1&&(Et.current=e.location))},[h,so]),[bn,xn]=i.useState(),cr=i.useCallback(e=>{if(e.kind!==_t||$e!=="multi")return;const o=en.value?e.metaKey:e.ctrlKey,[n,r]=e.location,s=h.columns;if(n<d)return;const f=J[n];let c=n,a=n;const g=r<=-2?-(r+2):0,v=Array.isArray(f.group)?f.group.length:1,C=(k,x)=>v>1?Ki(k,x,g,v):Pi(k,x);for(let k=n-1;k>=d&&C(f.group,J[k].group);k--)c--;for(let k=n+1;k<J.length&&C(f.group,J[k].group);k++)a++;if(xe(),o||e.isTouch||Zt==="multi")if(s.hasAll([c,a+1])){let k=s;for(let x=c;x<=a;x++)k=k.remove(x);ge(k,void 0,o)}else ge(void 0,[c,a+1],o);else ge(ne.fromSingleSelection([c,a+1]),void 0,o)},[$e,xe,h.columns,J,d,ge,Zt]),Ut=i.useRef(!1),Bo=i.useCallback(async e=>{if(pe!==void 0&&Nt!==void 0){const o=Te.current.y,n=Te.current.height;let r=pe({x:e,y:o,width:1,height:Math.min(n,G-o)},Ke.current.signal);typeof r!="object"&&(r=await r());const s=Ne[e-d],c=document.createElement("canvas").getContext("2d",{alpha:!1});if(c!==null){c.font=be.baseFontFull;const a=Dr(c,be,s,0,r,Pt,$o,!1,Me);Nt==null||Nt(s,a.width,e,a.width)}}},[Ne,pe,$o,be,Pt,Nt,d,G,Me]),[Kl,kn]=i.useState(),Ot=i.useCallback(async(e,o)=>{var a,g;const n=(a=e.current)==null?void 0:a.range;if(n===void 0||pe===void 0||o.current===void 0)return;const r=o.current.range;if(Be!==void 0){let v=!1;if(Be({fillDestination:{...r,x:r.x-d},patternSource:{...n,x:n.x-d},preventDefault:()=>v=!0}),v)return}let s=pe(n,Ke.current.signal);typeof s!="object"&&(s=await s());const f=s,c=[];for(let v=0;v<r.width;v++)for(let C=0;C<r.height;C++){const k=[r.x+v,r.y+C];if(Si(k,n))continue;const x=f[C%n.height][v%n.width];Jo(x)||!Dt(x)||c.push({location:k,value:{...x}})}Ee(c),(g=ae.current)==null||g.damage(c.map(v=>({cell:v.location})))},[pe,Ee,Be,d]),ar=i.useCallback(()=>{if(h.current===void 0||h.current.range.width<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,width:1}}};Ot(e,h)},[Ot,h]),ur=i.useCallback(()=>{if(h.current===void 0||h.current.range.height<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,height:1}}};Ot(e,h)},[Ot,h]),Pl=i.useCallback((e,o)=>{var C,k;const n=S;if(H(void 0),vn(void 0),kn(void 0),co.current=!1,o)return;if((n==null?void 0:n.fillHandle)===!0&&h.current!==void 0&&((C=n.previousSelection)==null?void 0:C.current)!==void 0){if(St===void 0)return;const x={...h,current:{...h.current,range:Ti(n.previousSelection.current.range,St)}};Ot(n.previousSelection,x),Pe(x,!0);return}const[r,s]=e.location,[f,c]=Et.current??[],a=()=>{Ut.current=!0},g=x=>{var M,B,$;const P=x.isTouch||f===r&&c===s;if(P&&(se==null||se([r-d,s],{...x,preventDefault:a})),x.button===1)return!Ut.current;if(!Ut.current){const E=ue(e.location),L=Me(E);if(L!==void 0&&L.onClick!==void 0&&P){const I=L.onClick({...x,cell:E,posX:x.localEventX,posY:x.localEventY,bounds:x.bounds,theme:io(E,e.location),preventDefault:a});I!==void 0&&!Jo(I)&&ho(I)&&(Ee([{location:x.location,value:I}]),(M=ae.current)==null||M.damage([{cell:x.location}]))}if(Ut.current||h.current===void 0)return!1;let N=!1;switch(E.activationBehaviorOverride??yo){case"double-click":case"second-click":{if((($=(B=n==null?void 0:n.previousSelection)==null?void 0:B.current)==null?void 0:$.cell)===void 0)break;const[I,oe]=h.current.cell,[ze,Le]=n.previousSelection.current.cell;N=r===I&&r===ze&&s===oe&&s===Le&&(x.isDoubleClick===!0||yo==="second-click");break}case"single-click":{N=!0;break}}if(N){const oe={inputType:"pointer",pointerActivation:x.isDoubleClick===!0?"double-click":E.activationBehaviorOverride??yo,pointerType:x.isTouch?"touch":"mouse"};return A==null||A([r-d,s],oe),Ue(x.bounds,oe),!0}}return!1},v=e.location[0]-d;if(e.isTouch){const x=Te.current,P=sr.current;if(x.x!==P.x||x.y!==P.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&Ei((k=h.current)==null?void 0:k.cell,e.location)){le==null||le([v,e.location[1]],{...e,preventDefault:a});return}else if(e.kind==="header"&&h.columns.hasIndex(r)){ye==null||ye(v,{...e,preventDefault:a});return}else if(e.kind===_t){if(v<0)return;Se==null||Se(v,{...e,preventDefault:a});return}}e.kind==="cell"?g(e)||so(e):e.kind===_t?F==null||F(v,{...e,preventDefault:a}):(e.kind===zi&&(Ye==null||Ye(v,{...e,preventDefault:a})),so(e));return}if(e.kind==="header"){if(v<0)return;e.isEdge?e.isDoubleClick===!0&&Bo(r):e.button===0&&r===f&&s===c&&(Ye==null||Ye(v,{...e,preventDefault:a}))}if(e.kind===_t){if(v<0)return;e.button===0&&r===f&&s===c&&(F==null||F(v,{...e,preventDefault:a}),Ut.current||cr(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&g(e),Et.current=void 0},[S,h,d,St,Ot,Pe,se,ue,Me,yo,io,Ee,A,Ue,le,ye,Se,so,F,Ye,Bo,cr]),Nl=i.useCallback(e=>{const o={...e,location:[e.location[0]-d,e.location[1]]};Co==null||Co(o),S!==void 0&&e.buttons===0&&(H(void 0),vn(void 0),kn(void 0),co.current=!1),kn(n=>{var r;return co.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(n==null?void 0:n[0])&&e.scrollEdge[1]===n[1]?n:S===void 0||(((r=We.current)==null?void 0:r.location[0])??0)<d?void 0:e.scrollEdge})},[S,Co,d]),Wl=i.useCallback((e,o)=>{bo==null||bo(e-d,o)},[bo,d]),Vl=i.useCallback((e,o)=>{xo==null||xo(e-d,o)},[xo,d]);i.useEffect(()=>{if(w===void 0)return;const e=r=>{const s=[];let f=r.parentElement;for(;f&&f!==document.documentElement;){const c=window.getComputedStyle(f),a=c.overflow+c.overflowY+c.overflowX;(a.includes("scroll")||a.includes("auto"))&&s.push(f),f=f.parentElement}return s},o=r=>{const s=r.target;ee.current&&!ee.current.contains(s)&&R(void 0)},n=[];if(ee.current){const r=e(ee.current);n.push(...r)}return n.forEach(r=>{r.addEventListener("scroll",o)}),window.addEventListener("scroll",o),document.addEventListener("scroll",o,!0),()=>{n.forEach(r=>{r.removeEventListener("scroll",o)}),window.removeEventListener("scroll",o),document.removeEventListener("scroll",o,!0)}},[w,R,ee]);const Ze=(wr=h==null?void 0:h.current)==null?void 0:wr.cell,Bl=i.useCallback((e,o,n,r,s,f)=>{if(Ao.current=!1,w!==void 0){const C=Te.current;(C.x!==e.x||C.y!==e.y)&&R(void 0)}let c=Ze;c!==void 0&&(c=[c[0]-d,c[1]]);const a=et===0?void 0:{x:0,y:e.y,width:et,height:e.height},g=[];a!==void 0&&g.push(a),tt>0&&(g.push({x:e.x-d,y:G-tt,width:e.width,height:tt}),et>0&&g.push({x:0,y:G-tt,width:et,height:tt}));const v={x:e.x-d,y:e.y,width:e.width,height:ce&&e.y+e.height>=G?e.height-1:e.height,tx:s,ty:f,extras:{selected:c,freezeRegion:a,freezeRegions:g}};Te.current=v,nr(v),Hl([o,n,r]),Mo==null||Mo(v,v.tx,v.ty,v.extras)},[Ze,w,d,ce,G,et,tt,R,nr,Mo]),Ul=wt(lt,i.useCallback((e,o)=>(lt==null?void 0:lt(e-d,o-d))!==!1,[lt,d])),Ol=wt(yt,i.useCallback((e,o)=>{yt==null||yt(e-d,o-d),$e!=="none"&&ge(ne.fromSingleSelection(o),void 0,!0)},[$e,yt,d,ge])),Rn=i.useRef(!1),_l=i.useCallback(e=>{if(e.location[0]===0&&d>0){e.preventDefault();return}wo==null||wo({...e,location:[e.location[0]-d,e.location[1]]}),e.defaultPrevented()||(Rn.current=!0),H(void 0)},[wo,d]),Xl=i.useCallback(()=>{Rn.current=!1},[]),dr=ct==null?void 0:ct.selectionBehavior,Uo=i.useCallback(e=>{if(dr!=="block-spanning")return;const{isGroupHeader:o,path:n,groupRows:r}=Tt(e);if(o)return[e,e];const s=n[n.length-1],f=e-s,c=e+r-s-1;return[f,c]},[Tt,dr]),Mn=i.useRef(void 0),Sn=i.useCallback(e=>{var o,n,r;if(!Li(e,Mn.current)&&(Mn.current=e,!(((o=We==null?void 0:We.current)==null?void 0:o.button)!==void 0&&We.current.button>=1))){if(e.buttons!==0&&S!==void 0&&((n=We.current)==null?void 0:n.location[0])===0&&d===1&&Ae==="multi"&&S.previousSelection&&!S.previousSelection.rows.hasIndex(We.current.location[1])&&h.rows.hasIndex(We.current.location[1])){const s=Math.min(We.current.location[1],e.location[1]),f=Math.max(We.current.location[1],e.location[1])+1;Re(ne.fromSingleSelection([s,f]),void 0,!1)}else if(e.buttons!==0&&S!==void 0&&h.current!==void 0&&!Rn.current&&!co.current&&(bt==="rect"||bt==="multi-rect")){const[s,f]=h.current.cell;let[c,a]=e.location;if(a<0&&(a=Te.current.y),S.fillHandle===!0&&((r=S.previousSelection)==null?void 0:r.current)!==void 0){const g=S.previousSelection.current.range;a=Math.min(a,ce?G-1:G);const v=Ii(g,c,a,Kn);vn(v)}else{if(ce&&f===G)return;if(ce&&a===G)if(e.kind===kr)a--;else return;c=Math.max(c,d);const C=Uo(f);a=C===void 0?a:Ht(a,C[0],C[1]);const k=c-s,x=a-f,P={x:k>=0?s:c,y:x>=0?f:a,width:Math.abs(k)+1,height:Math.abs(x)+1};we({...h.current,range:P},!0,!1,"drag")}}Ro==null||Ro({...e,location:[e.location[0]-d,e.location[1]]})}},[S,d,Ae,h,bt,Ro,Re,ce,G,Kn,Uo,we]),Yl=i.useCallback(()=>{var c,a;const e=Mn.current;if(e===void 0)return;const[o,n]=e.scrollEdge;let[r,s]=e.location;const f=Te.current;o===-1?r=((a=(c=f.extras)==null?void 0:c.freezeRegion)==null?void 0:a.x)??f.x:o===1&&(r=f.x+f.width),n===-1?s=Math.max(0,f.y):n===1&&(s=Math.min(G-1,f.y+f.height)),r=Ht(r,0,J.length-1),s=Ht(s,0,G-1),Sn({...e,location:[r,s]})},[J.length,Sn,G]);Vs(Kl,ee,Yl);const _e=i.useCallback(e=>{if(h.current===void 0)return;const[o,n]=e,[r,s]=h.current.cell,f=h.current.range;let c=f.x,a=f.x+f.width,g=f.y,v=f.y+f.height;const[C,k]=Uo(s)??[0,G-1],x=k+1;if(n!==0)switch(n){case 2:{v=x,g=s,ie(0,v,"vertical");break}case-2:{g=C,v=s+1,ie(0,g,"vertical");break}case 1:{g<s?(g++,ie(0,g,"vertical")):(v=Math.min(x,v+1),ie(0,v,"vertical"));break}case-1:{v>s+1?(v--,ie(0,v,"vertical")):(g=Math.max(C,g-1),ie(0,g,"vertical"));break}default:Rr()}if(o!==0)if(o===2)a=J.length,c=r,ie(a-1-d,0,"horizontal");else if(o===-2)c=d,a=r+1,ie(c-d,0,"horizontal");else{let P=[];if(pe!==void 0){const M=pe({x:c,y:g,width:a-c-d,height:v-g},Ke.current.signal);typeof M=="object"&&(P=tc(M))}if(o===1){let M=!1;if(c<r){if(P.length>0){const B=Xt(c+1,r+1).find($=>!P.includes($-d));B!==void 0&&(c=B,M=!0)}else c++,M=!0;M&&ie(c,0,"horizontal")}M||(a=Math.min(J.length,a+1),ie(a-1-d,0,"horizontal"))}else if(o===-1){let M=!1;if(a>r+1){if(P.length>0){const B=Xt(a-1,r,-1).find($=>!P.includes($-d));B!==void 0&&(a=B,M=!0)}else a--,M=!0;M&&ie(a-d,0,"horizontal")}M||(c=Math.max(d,c-1),ie(c-d,0,"horizontal"))}else Rr()}we({cell:h.current.cell,range:{x:c,y:g,width:a-c,height:v-g}},!0,!1,"keyboard-select")},[pe,Uo,h,J.length,d,G,ie,we]),Tn=i.useRef(Wn);Tn.current=Wn;const mt=i.useCallback((e,o,n,r)=>{const s=ke-(n?0:1);e=Ht(e,d,Ne.length-1+d),o=Ht(o,0,s);const f=Ze==null?void 0:Ze[0],c=Ze==null?void 0:Ze[1];if(e===f&&o===c)return!1;if(r&&h.current!==void 0){const a=[...h.current.rangeStack];(h.current.range.width>1||h.current.range.height>1)&&a.push(h.current.range),Pe({...h,current:{cell:[e,o],range:{x:e,y:o,width:1,height:1},rangeStack:a}},!0)}else we({cell:[e,o],range:{x:e,y:o,width:1,height:1}},!0,!1,"keyboard-nav");return p.current!==void 0&&p.current[0]===e&&p.current[1]===o&&(p.current=void 0),Tn.current&&ie(e-d,o,"both",0,20),!0},[ke,d,Ne.length,Ze,h,ie,Pe,we]),ao=i.useCallback((e,o)=>{var C,k,x,P;const n=X.current;Y.current;let r=e;const s=((C=y.current)==null?void 0:C.getValue())??"",f=((k=n==null?void 0:n.content)==null?void 0:k.kind)===U.Custom;if((n==null?void 0:n.cell)!==void 0&&s.length>0&&n.content!==void 0&&!f){const M=n.content;if(M.kind===U.Text)r={...M,data:s,displayData:s};else if(M.kind===U.Number){const B=Number.parseFloat(s),$=Number.isNaN(B)?0:B;r={...M,data:$,displayData:$.toLocaleString()}}else M.kind===U.Uri?r={...M,data:s,displayData:s}:M.kind===U.Markdown&&(r={...M,data:s})}else f&&(r=e);if(r!==void 0&&s.length===0)if(r.kind===U.Text&&r.data!==r.displayData)r={...r,displayData:r.data};else if(r.kind===U.Number){const M=r.data!==void 0?r.data.toLocaleString():"0";r.displayData!==M&&(r={...r,displayData:M})}else r.kind===U.Uri&&r.data!==r.displayData&&(r={...r,displayData:r.data});const c=n==null?void 0:n.content,a=()=>{if(r===void 0||c===void 0)return!1;if(r.kind!==c.kind)return!0;switch(r.kind){case U.Text:case U.Uri:case U.Markdown:return r.data!==c.data;case U.Number:return r.data!==c.data;case U.Boolean:return r.data!==c.data;default:return!0}};(n==null?void 0:n.cell)!==void 0&&r!==void 0&&ho(r)&&a()&&(Ee([{location:n.cell,value:r}]),window.requestAnimationFrame(()=>{var M;(M=ae.current)==null||M.damage([{cell:n.cell}])})),(x=y.current)==null||x.clear(),(P=y.current)==null||P.setVisible(!1),V(!1),xe(!0),X.current=void 0,R(void 0);const[g,v]=o;if(h.current!==void 0&&(g!==0||v!==0)){const M=h.current.cell[1]===ke-1;if(M&&v===1){Fe==null||Fe(e,[0,0]);return}const B=h.current.cell[0]===J.length-1&&e!==void 0;let $=!0;if(M&&v===1&&it!==void 0){$=!1;const E=h.current.cell[0]+g,L=Vt(E);ht(L??E,!1)}if(B&&g===1&&st!==void 0){$=!1;const E=h.current.cell[1]+v;Vo(E,!1)}if($){const E=Ht(h.current.cell[0]+g,d,J.length-1),L=Ht(h.current.cell[1]+v,0,ke-1);mt(E,L,M,!1),window.requestAnimationFrame(()=>{var N;(N=y.current)==null||N.focus()})}}Fe==null||Fe(e,o)},[xe,h,Fe,Ee,ke,mt,J.length,ht,Vo,it,st,Vt,d]),ql=i.useMemo(()=>`gdg-overlay-${ec++}`,[]),zt=i.useCallback(e=>{var n,r,s,f;xe();const o=[];for(let c=e.x;c<e.x+e.width;c++)for(let a=e.y;a<e.y+e.height;a++){const g=te([c-d,a]);if(!g.allowOverlay&&g.kind!==U.Boolean)continue;let v;if(g.kind===U.Custom){const C=Me(g),k=(n=C==null?void 0:C.provideEditor)==null?void 0:n.call(C,{...g,location:[c-d,a]});(C==null?void 0:C.onDelete)!==void 0?v=C.onDelete(g):Di(k)&&(v=(r=k==null?void 0:k.deletedValue)==null?void 0:r.call(k,g))}else if(ho(g)&&g.allowOverlay||g.kind===U.Boolean){const C=Me(g);v=(s=C==null?void 0:C.onDelete)==null?void 0:s.call(C,g)}v!==void 0&&!Jo(v)&&ho(v)&&o.push({location:[c,a],value:v})}Ee(o),(f=ae.current)==null||f.damage(o.map(c=>({cell:c.location})))},[xe,te,Me,Ee,d]),uo=w!==void 0,fr=i.useCallback(e=>{var B,$,E,L;const o=()=>{e.stopPropagation(),e.preventDefault()},n={didMatch:!1},{bounds:r}=e,s=h.columns,f=h.rows,c=dt;if(!uo&&O(c.clear,e,n)){const N=((B=h.current)==null?void 0:B.cell)??[d,0];Pe({columns:ne.empty(),rows:ne.empty(),current:{cell:N,range:{x:N[0],y:N[1],width:1,height:1},rangeStack:[]}},!1),at==null||at(),xe()}else if(!uo&&O(c.selectAll,e,n))Pe({columns:ne.empty(),rows:ne.empty(),current:{cell:(($=h.current)==null?void 0:$.cell)??[d,0],range:{x:d,y:0,width:q.length,height:G},rangeStack:[]}},!1);else if(O(c.search,e,n))(E=D==null?void 0:D.current)==null||E.focus({preventScroll:!0}),Zn(!0);else if(O(c.delete,e,n)){const N=(ft==null?void 0:ft(h))??!0;if(N!==!1){const I=N===!0?h:N;if(I.current!==void 0){zt(I.current.range);for(const oe of I.current.rangeStack)zt(oe)}for(const oe of I.rows)zt({x:d,y:oe,width:q.length,height:1});for(const oe of I.columns)zt({x:oe,y:0,width:1,height:G})}}if(n.didMatch)return o(),!0;if(h.current===void 0)return!1;let[a,g]=h.current.cell;const[,v]=h.current.cell;let C=!1,k=!1;if(O(c.scrollToSelectedCell,e,n))Xo.current(a-d,g);else if($e!=="none"&&O(c.selectColumn,e,n))s.hasIndex(a)?ge(s.remove(a),void 0,!0):$e==="single"?ge(ne.fromSingleSelection(a),void 0,!0):ge(void 0,a,!0);else if(Ae!=="none"&&O(c.selectRow,e,n))f.hasIndex(g)?Re(f.remove(g),void 0,!0):Ae==="single"?Re(ne.fromSingleSelection(g),void 0,!0):Re(void 0,g,!0);else if(!uo&&r!==void 0&&O(c.activateCell,e,n))if(g===G&&ce)window.setTimeout(()=>{const N=Vt(a);ht(N??a)},0);else{const N={inputType:"keyboard",key:e.key},I=ue([a,g]);I.kind===U.Boolean&&I.readonly!==!0?(A==null||A([a-d,g],N),e.key===" "?(Ee([{location:[a,g],value:{...I,data:xr(I.data)}}]),(L=ae.current)==null||L.damage([{cell:[a,g]}])):e.key==="Enter"&&(g+=1)):(A==null||A([a-d,g],N),Ue(r,N))}else h.current.range.height>1&&O(c.downFill,e,n)?ur():h.current.range.width>1&&O(c.rightFill,e,n)?ar():O(c.goToNextPage,e,n)?g+=Math.max(1,Te.current.height-4):O(c.goToPreviousPage,e,n)?g-=Math.max(1,Te.current.height-4):O(c.goToFirstCell,e,n)?(R(void 0),g=0,a=0):O(c.goToLastCell,e,n)?(R(void 0),g=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER):O(c.selectToFirstCell,e,n)?(R(void 0),_e([-2,-2])):O(c.selectToLastCell,e,n)?(R(void 0),_e([2,2])):uo?(O(c.closeOverlay,e,n)&&R(void 0),O(c.acceptOverlayDown,e,n)&&(R(void 0),g++),O(c.acceptOverlayUp,e,n)&&(R(void 0),g--),O(c.acceptOverlayLeft,e,n)&&(R(void 0),a--),O(c.acceptOverlayRight,e,n)&&(R(void 0),a++)):(O(c.goDownCell,e,n)?g+=1:O(c.goUpCell,e,n)?g-=1:O(c.goRightCell,e,n)?a+=1:O(c.goLeftCell,e,n)?a-=1:O(c.goDownCellRetainSelection,e,n)?(g+=1,C=!0):O(c.goUpCellRetainSelection,e,n)?(g-=1,C=!0):O(c.goRightCellRetainSelection,e,n)?(a+=1,C=!0):O(c.goLeftCellRetainSelection,e,n)?(a-=1,C=!0):O(c.goToLastRow,e,n)?g=G-1:O(c.goToFirstRow,e,n)?g=Number.MIN_SAFE_INTEGER:O(c.goToLastColumn,e,n)?a=Number.MAX_SAFE_INTEGER:O(c.goToFirstColumn,e,n)?a=Number.MIN_SAFE_INTEGER:(bt==="rect"||bt==="multi-rect")&&(O(c.selectGrowDown,e,n)?_e([0,1]):O(c.selectGrowUp,e,n)?_e([0,-1]):O(c.selectGrowRight,e,n)?_e([1,0]):O(c.selectGrowLeft,e,n)?_e([-1,0]):O(c.selectToLastRow,e,n)?_e([0,2]):O(c.selectToFirstRow,e,n)?_e([0,-2]):O(c.selectToLastColumn,e,n)?_e([2,0]):O(c.selectToFirstColumn,e,n)&&_e([-2,0])),k=n.didMatch);if(Oe!==void 0&&Oe!=="normal"&&g!==v){const N=Oe==="skip-up"||Oe==="skip"||Oe==="block",I=Oe==="skip-down"||Oe==="skip"||Oe==="block",oe=g<v;if(oe&&N){for(;g>=0&&Tt(g).isGroupHeader;)g--;g<0&&(g=v)}else if(!oe&&I){for(;g<G&&Tt(g).isGroupHeader;)g++;g>=G&&(g=v)}}const P=mt(a,g,!1,C),M=n.didMatch;return M&&(P||!k||Pn)&&o(),M},[Oe,uo,h,dt,$e,Ae,bt,d,Tt,G,mt,Pe,at,q.length,ft,Pn,zt,ge,Re,ce,Vt,ht,A,Ue,ur,ar,_e,ue,Ee]),Lt=i.useCallback(e=>{let o=!1;if(Yt!==void 0&&Yt({...e,...e.location&&{location:[e.location[0]-d,e.location[1]]},cancel:()=>{o=!0}}),o||fr(e)||h.current===void 0)return;const[n,r]=h.current.cell,s=Te.current,f=e.keyCode===229,c=qt&&!e.metaKey&&!e.ctrlKey&&e.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(e.key);if((f||c)&&e.bounds!==void 0&&Dt(te([n-d,Math.max(0,Math.min(r,G-1))]))){if((!ce||r!==G)&&(s.y>r||r>s.y+s.height||s.x>n||n>s.x+s.width))return;if(e.stopPropagation(),e.preventDefault(),f){const a={inputType:"keyboard",key:""};A==null||A([n-d,r],a),Ue(e.bounds,a,"")}else{const a={inputType:"keyboard",key:e.key};A==null||A([n-d,r],a),Ue(e.bounds,a,e.key)}}},[qt,Yt,fr,h,te,d,G,ce,A,Ue]),Zl=i.useCallback((e,o)=>{var n;if(X.current===void 0&&!o&&e.length>0&&e.trim().length>0&&h.current!==void 0){const[r,s]=h.current.cell,f=ue([r,s]);if(f.kind===U.Custom){const c=f.data,a=c==null?void 0:c.kind;if(a!=="number-cell"&&a!=="date-picker-cell")return}if(f.allowOverlay&&Dt(f)&&f.readonly!==!0){const c=(n=ae.current)==null?void 0:n.getBounds(r,s);if(c!==void 0){const a={inputType:"keyboard",key:e};A==null||A([r-d,s],a),Ue(c,a,e)}}}},[h,ue,d,A,Ue]),Jl=i.useCallback(()=>{var r,s,f,c,a;if(h.current===void 0)return;const[e,o]=h.current.cell,n=(r=X.current)==null?void 0:r.cell;if(n!==void 0&&(n[0]!==e||n[1]!==o)&&((s=y.current)==null||s.clear(),(f=y.current)==null||f.setVisible(!1),V(!1),X.current=void 0,R(void 0)),X.current===void 0){const g=ue([e,o]);if(g.kind===U.Custom){const v=g.data,C=v==null?void 0:v.kind;if(C!=="number-cell"&&C!=="date-picker-cell")return}if(g.allowOverlay&&Dt(g)&&g.readonly!==!0){const v=(c=ae.current)==null?void 0:c.getBounds(e,o);if(v!==void 0){(a=y.current)==null||a.clear();const C={inputType:"keyboard",key:""};A==null||A([e-d,o],C),Ue(v,C,"")}}}},[h,ue,d,A,Ue]),Ql=i.useCallback(e=>{},[]),jl=i.useCallback(e=>{var f,c;if(e.nativeEvent.isComposing)return;if(X.current!==void 0&&Y.current){const a=e.key;if(X.current.content.kind===U.Custom){const v=e.key;(v==="Enter"||v==="Tab"||v==="Escape")&&(e.preventDefault(),e.stopPropagation());return}if(a==="Escape"){e.preventDefault(),e.stopPropagation(),ao(void 0,[0,0]);return}if(a==="Enter"&&!e.shiftKey){e.preventDefault(),e.stopPropagation(),ao(void 0,[0,1]);return}if(a==="Tab"){e.preventDefault(),e.stopPropagation(),ao(void 0,e.shiftKey?[-1,0]:[1,0]);return}}{const a=e.key;if(a.length===1&&!e.ctrlKey&&!e.metaKey&&!e.altKey)if(a===" "&&h.current!==void 0){const v=h.current.cell,C=ue(v);if(!(C.kind===U.Boolean&&C.readonly!==!0))return}else return}if(X.current!==void 0&&Y.current){const a=e.key;if(a==="Backspace"||a==="Delete"||(a==="ArrowLeft"||a==="ArrowRight"||a==="ArrowUp"||a==="ArrowDown"||a==="Home"||a==="End"))return}const o=(f=h.current)==null?void 0:f.cell,n=o!==void 0?(c=ae.current)==null?void 0:c.getBounds(o[0],o[1]):void 0;let r=!1;const s={bounds:n,cancel:()=>{r=!0},stopPropagation:()=>e.stopPropagation(),preventDefault:()=>e.preventDefault(),ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey,key:e.key,keyCode:e.keyCode,rawEvent:e,location:o};Lt(s),r&&(e.preventDefault(),e.stopPropagation())},[h,Lt,ao,ue]),ei=i.useCallback(e=>{var s,f;const o=(s=h.current)==null?void 0:s.cell,r={bounds:o!==void 0?(f=ae.current)==null?void 0:f.getBounds(o[0],o[1]):void 0,cancel:()=>{},stopPropagation:()=>e.stopPropagation(),preventDefault:()=>e.preventDefault(),ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey,key:e.key,keyCode:e.keyCode,rawEvent:e,location:o};Ct==null||Ct(r)},[h,Ct]),ti=i.useCallback(()=>{zn(!0)},[]),oi=i.useCallback(()=>{zn(!1)},[]),ni=i.useCallback((e,o)=>{const n=e.location[0]-d;if(e.kind==="header"&&(ye==null||ye(n,{...e,preventDefault:o})),e.kind===_t){if(n<0)return;Se==null||Se(n,{...e,preventDefault:o})}if(e.kind==="cell"){const[r,s]=e.location;le==null||le([n,s],{...e,preventDefault:o}),Hi(h,e.location)||mt(r,s,!1,!1)}},[h,le,Se,ye,d,mt]),En=i.useCallback(async e=>{var c,a,g;if(!dt.paste)return;function o(v,C,k,x){var M,B;const P=typeof k=="object"?(k==null?void 0:k.join(`
`))??"":(k==null?void 0:k.toString())??"";if(!Jo(v)&&Dt(v)&&v.readonly!==!0){const $=Ie==null?void 0:Ie(P,v);if($!==void 0&&ho($))return{location:C,value:$};const E=Me(v);if(E===void 0)return;if(E.kind===U.Custom){jo(v.kind===U.Custom);const L=(M=E.onPaste)==null?void 0:M.call(E,P,v.data);return L===void 0?void 0:{location:C,value:{...v,data:L}}}else{const L=(B=E.onPaste)==null?void 0:B.call(E,P,v,{formatted:x,formattedString:typeof x=="string"?x:x==null?void 0:x.join(`
`),rawValue:k});return L===void 0?void 0:(jo(L.kind===v.kind),{location:C,value:L})}}}const n=h.columns,r=h.rows,s=((c=ee.current)==null?void 0:c.contains(document.activeElement))===!0||((a=b.current)==null?void 0:a.contains(document.activeElement))===!0;let f;if(h.current!==void 0?f=[h.current.range.x,h.current.range.y]:n.length===1?f=[n.first()??0,0]:r.length===1&&(f=[d,r.first()??0]),s&&f!==void 0){let v,C;const k="text/plain",x="text/html";if(navigator.clipboard.read!==void 0){const $=await navigator.clipboard.read();for(const E of $){if(E.types.includes(x)){const N=await(await E.getType(x)).text(),I=Mr(N);if(I!==void 0){v=I;break}}E.types.includes(k)&&(C=await(await E.getType(k)).text())}}else if(navigator.clipboard.readText!==void 0)C=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(x)){const $=e.clipboardData.getData(x);v=Mr($)}v===void 0&&e.clipboardData.types.includes(k)&&(C=e.clipboardData.getData(k))}else return;const[P,M]=f,B=[];do{if(xt===void 0){const $=ue(f),E=C??(v==null?void 0:v.map(N=>N.map(I=>I.rawValue).join("	")).join("	"))??"",L=o($,f,E,void 0);L!==void 0&&B.push(L);break}if(v===void 0){if(C===void 0)return;v=$i(C)}if(xt===!1||typeof xt=="function"&&(xt==null?void 0:xt([f[0]-d,f[1]],v.map($=>$.map(E=>{var L;return((L=E.rawValue)==null?void 0:L.toString())??""}))))!==!0)return;for(const[$,E]of v.entries()){if($+M>=G)break;for(const[L,N]of E.entries()){const I=[L+P,$+M],[oe,ze]=I;if(oe>=J.length||ze>=ke)continue;const Le=ue(I),Ve=o(Le,I,N.rawValue,N.formatted);Ve!==void 0&&B.push(Ve)}}}while(!1);Ee(B),(g=ae.current)==null||g.damage(B.map($=>({cell:$.location})))}},[Ie,Me,ue,h,dt.paste,ee,J.length,Ee,ke,xt,d,G]);Dn("paste",En,de,!1,!0);const fo=i.useCallback(async(e,o)=>{var c,a;if(!dt.copy)return;const n=o===!0||((c=ee.current)==null?void 0:c.contains(document.activeElement))===!0||((a=b.current)==null?void 0:a.contains(document.activeElement))===!0,r=h.columns,s=h.rows,f=(g,v)=>{if(!Gn)Sr(g,v,e);else{const C=v.map(k=>({kind:U.Text,data:q[k].title,displayData:q[k].title,allowOverlay:!1}));Sr([C,...g],v,e)}};if(n&&pe!==void 0){if(h.current!==void 0){let g=pe(h.current.range,Ke.current.signal);typeof g!="object"&&(g=await g()),f(g,Xt(h.current.range.x-d,h.current.range.x+h.current.range.width-d))}else if(s!==void 0&&s.length>0){const v=[...s].map(C=>{const k=pe({x:d,y:C,width:q.length,height:1},Ke.current.signal);return typeof k=="object"?k[0]:k().then(x=>x[0])});if(v.some(C=>C instanceof Promise)){const C=await Promise.all(v);f(C,Xt(q.length))}else f(v,Xt(q.length))}else if(r.length>0){const g=[],v=[];for(const C of r){let k=pe({x:C,y:0,width:1,height:G},Ke.current.signal);typeof k!="object"&&(k=await k()),g.push(k),v.push(C-d)}if(g.length===1)f(g[0],v);else{const C=g.reduce((k,x)=>k.map((P,M)=>[...P,...x[M]]));f(C,v)}}}},[q,pe,h,dt.copy,d,ee,G,Gn]);Dn("copy",fo,de,!1,!1);const ri=i.useCallback(async e=>{var n,r;if(!(!dt.cut||!(((n=ee.current)==null?void 0:n.contains(document.activeElement))===!0||((r=b.current)==null?void 0:r.contains(document.activeElement))===!0))&&(await fo(e),h.current!==void 0)){let s={current:{cell:h.current.cell,range:h.current.range,rangeStack:[]},rows:ne.empty(),columns:ne.empty()};const f=ft==null?void 0:ft(s);if(f===!1||(s=f===!0?s:f,s.current===void 0))return;zt(s.current.range)}},[zt,h,dt.cut,fo,ee,ft]);Dn("cut",ri,de,!1,!1);const li=i.useCallback((e,o)=>{if(je!==void 0){d!==0&&(e=e.map(s=>[s[0]-d,s[1]])),je(e,o);return}if(e.length===0||o===-1)return;const[n,r]=e[o];p.current!==void 0&&p.current[0]===n&&p.current[1]===r||(p.current=[n,r],mt(n,r,!1,!1))},[je,d,mt]),[Oo,_o]=((Cr=kt==null?void 0:kt.current)==null?void 0:Cr.cell)??[],Xo=i.useRef(ie);Xo.current=ie,i.useLayoutEffect(()=>{var e,o,n,r;Tn.current&&!Ao.current&&Oo!==void 0&&_o!==void 0&&(Oo!==((o=(e=Fo.current)==null?void 0:e.current)==null?void 0:o.cell[0])||_o!==((r=(n=Fo.current)==null?void 0:n.current)==null?void 0:r.cell[1]))&&Xo.current(Oo,_o),Ao.current=!1},[Oo,_o]);const hr=h.current!==void 0&&(h.current.cell[0]>=J.length||h.current.cell[1]>=ke);i.useLayoutEffect(()=>{hr&&Pe(Hn,!1)},[hr,Pe]);const ii=i.useMemo(()=>ce===!0&&(j==null?void 0:j.tint)===!0?ne.fromSingleSelection(ke-1):ne.empty(),[ke,ce,j==null?void 0:j.tint]),si=i.useCallback(e=>typeof Gt=="boolean"?Gt:(Gt==null?void 0:Gt(e-d))??!0,[d,Gt]),ci=i.useMemo(()=>{if(bn===void 0||b.current===null)return null;const{bounds:e,group:o}=bn,n=b.current.getBoundingClientRect();return i.createElement(Ls,{bounds:e,group:o,canvasBounds:n,onClose:()=>xn(void 0),onFinish:r=>{xn(void 0),Qe==null||Qe(o,r)}})},[Qe,bn]),ai=Math.min(J.length,et+d);i.useImperativeHandle(l,()=>({appendRow:(e,o)=>ht(e+d,o),appendColumn:(e,o)=>Vo(e,o),updateCells:e=>{var o;return d!==0&&(e=e.map(n=>({cell:[n.cell[0]+d,n.cell[1]]}))),(o=ae.current)==null?void 0:o.damage(e)},getBounds:(e,o)=>{var n;if(!((b==null?void 0:b.current)===null||(ee==null?void 0:ee.current)===null)){if(e===void 0&&o===void 0){const r=b.current.getBoundingClientRect(),s=r.width/ee.current.clientWidth;return{x:r.x-ee.current.scrollLeft*s,y:r.y-ee.current.scrollTop*s,width:ee.current.scrollWidth*s,height:ee.current.scrollHeight*s}}return(n=ae.current)==null?void 0:n.getBounds((e??0)+d,o)}},focus:()=>{var e;return(e=ae.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":Lt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Lt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Lt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await fo(void 0,!0);break;case"paste":await En();break}},scrollTo:ie,remeasureColumns:e=>{for(const o of e)Bo(o+d)},getMouseArgsForPosition:(e,o,n)=>{if((ae==null?void 0:ae.current)===null)return;const r=ae.current.getMouseArgsForPosition(e,o,n);if(r!==void 0)return{...r,location:[r.location[0]-d,r.location[1]]}}}),[ht,Vo,Bo,ee,fo,Lt,En,d,ie]);const[gr,mr]=Ze??[],ui=i.useCallback(e=>{const[o,n]=e;if(n===-1){$e!=="none"&&(ge(ne.fromSingleSelection(o),void 0,!1),xe());return}gr===o&&mr===n||(we({cell:e,range:{x:o,y:n,width:1,height:1}},!0,!1,"keyboard-nav"),ie(o,n))},[$e,xe,ie,gr,mr,we,ge]),[di,zn]=i.useState(!1),vr=i.useRef(Vi(e=>{zn(e)},5)),fi=i.useCallback(()=>{vr.current(!0),h.current===void 0&&h.columns.length===0&&h.rows.length===0&&S===void 0&&we({cell:[d,Go],range:{x:d,y:Go,width:1,height:1}},!0,!1,"keyboard-select")},[Go,h,S,d,we]),hi=i.useCallback(()=>{vr.current(!1)},[]),[gi,mi]=i.useMemo(()=>{let e;const o=(he==null?void 0:he.scrollbarWidthOverride)??Fi(),n=G+(ce?1:0);if(typeof ut=="number")e=lo+n*ut;else{let s=0;const f=Math.min(n,10);for(let c=0;c<f;c++)s+=ut(c);s=Math.floor(s/f),e=lo+n*s}e+=o;const r=J.reduce((s,f)=>f.width+s,0)+o;return[`${Math.min(1e5,r)}px`,`${Math.min(1e5,e)}px`]},[J,he==null?void 0:he.scrollbarWidthOverride,ut,G,ce,lo]),vi=i.useMemo(()=>Ai(be),[be]);return i.createElement(Gi.Provider,{value:be},i.createElement(Ps,{style:vi,className:Ce,inWidth:Q??gi,inHeight:fe??mi},i.createElement(Ts,{fillHandle:Yr,drawFocusRing:Bn,experimental:he,fixedShadowX:qr,fixedShadowY:Zr,getRowThemeOverride:nt,headerIcons:Jr,imageWindowLoader:Qr,initialSize:jr,isDraggable:el,onDragLeave:tl,onRowMoved:eo,overscrollX:xl,overscrollY:kl,preventDiagonalScrolling:rl,rightElement:ll,rightElementProps:il,smoothScrollX:sl,smoothScrollY:cl,className:Ce,enableGroups:jn,onCanvasFocused:fi,onCanvasBlur:hi,canvasRef:b,onContextMenu:ni,theme:be,cellXOffset:Fl,cellYOffset:Go,accessibilityHeight:Mt.height,onDragEnd:Xl,columns:J,nonGrowWidth:Qn,drawHeader:Il,onColumnProposeMove:Ul,drawCell:Dl,disabledRows:ii,freezeColumns:ai,lockColumns:d,firstColAccessible:d===0,getCellContent:ue,minColumnWidth:Pt,maxColumnWidth:$o,searchInputRef:D,showSearch:Ml,onSearchClose:Sl,highlightRegions:Al,getCellsForSelection:pe,getGroupDetails:pn,headerHeight:Yn,isFocused:di,groupHeaderHeight:jn?gn:0,groupLevels:ro,groupHeaderHeights:er,freezeTrailingRows:tt+(ce&&(j==null?void 0:j.sticky)===!0?1:0),hasAppendRow:ce,onColumnResize:Nt,onColumnResizeEnd:zl,onColumnResizeStart:Ll,onCellFocused:ui,onColumnMoved:Ol,onDragStart:_l,onHeaderMenuClick:Wl,onHeaderIndicatorClick:Vl,onItemHovered:Sn,isFilling:(S==null?void 0:S.fillHandle)===!0,onMouseMove:Nl,onKeyDown:Lt,onKeyUp:Ct,onMouseDown:Gl,onMouseUp:Pl,onDragOverCell:_r,onDrop:Xr,onSearchResultsChanged:li,onVisibleRegionChanged:Bl,clientSize:mn,rowHeight:ut,searchResults:vo,searchValue:po,onSearchValueChange:on,rows:ke,scrollRef:ee,selection:h,translateX:Mt.tx,translateY:Mt.ty,verticalBorder:si,gridRef:ae,getCellRenderer:Me,resizeIndicator:gl}),ci,w!==void 0&&i.createElement(i.Suspense,{fallback:null},i.createElement(js,{...w,validateCell:El,bloom:$t,id:ql,getCellRenderer:Me,className:(he==null?void 0:he.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Br,imageEditorOverride:ve,portalElementRef:To,onFinishEditing:ao,markdownDivCreateNode:z,isOutsideClick:hl,customEventTarget:he==null?void 0:he.eventTarget,isGhostMode:T}))),(()=>{const e=(To==null?void 0:To.current)??document.getElementById("portal");return e===null?null:wi.createPortal(i.createElement(Qs,{ref:y,onInput:Zl,onCompositionStart:Jl,onCompositionEnd:Ql,onKeyDown:jl,onKeyUp:ei,onFocus:ti,onBlur:oi}),e)})())},nc=i.forwardRef(oc),rc=(t,l)=>{const u=i.useMemo(()=>({...bs,...t.headerIcons}),[t.headerIcons]),m=i.useMemo(()=>t.renderers??Ni,[t.renderers]),w=i.useMemo(()=>t.imageWindowLoader??new Wi,[t.imageWindowLoader]);return i.createElement(nc,{...t,renderers:m,headerIcons:u,ref:l,imageWindowLoader:w})},gc=i.forwardRef(rc);export{gc as D,vt as k,Xs as u};
