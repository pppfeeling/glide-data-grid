const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-BjtgIQmE.js","./iframe-CI-U1wEL.js","./preload-helper-C1FmrZbK.js","./index-4z8rmTOn.js","./marked.esm-BmZ9459z.js","./throttle-CrC0zd7y.js","./flatten-Cjd8EGAb.js","./number-overlay-editor-dt4XM6vg.js","./react-number-format.es-DCDe1MGs.js"])))=>i.map(i=>d[i]);
var fa=Object.defineProperty;var ha=(e,t,n)=>t in e?fa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ne=(e,t,n)=>ha(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as Tt}from"./iframe-CI-U1wEL.js";import{_ as Zl}from"./preload-helper-C1FmrZbK.js";import{h as ga,g as Jl,j as ma,k as wa,v as ba,l as ya,m as vn,r as po,t as pa}from"./throttle-CrC0zd7y.js";import{u as va,f as kl}from"./flatten-Cjd8EGAb.js";import{s as fn,a as Ca}from"./marked.esm-BmZ9459z.js";function Ql(e="This should not happen"){throw new Error(e)}function cn(e,t="Assertion failed"){if(!e)return Ql(t)}function xr(e,t){return Ql(t??"Hell froze over")}function xa(e,t){try{return e()}catch{return t}}const Sl=Object.prototype.hasOwnProperty;function Ko(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Ko(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Sl.call(e,n)&&++o&&!Sl.call(t,n)||!(n in t)||!Ko(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Jr=null,Gi=void 0;var ne;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(ne||(ne={}));var Ml;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(Ml||(Ml={}));var Qr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Qr||(Qr={}));function Kr(e){return"width"in e&&typeof e.width=="number"}async function Rl(e){return typeof e=="object"?e:await e()}function Xo(e){return!(e.kind===ne.Loading||e.kind===ne.Bubble||e.kind===ne.RowID||e.kind===ne.Protected||e.kind===ne.Drilldown)}function lf(e){return!(e.kind===ne.Loading||e.kind===ne.Bubble||e.kind===ne.RowID||e.kind===ne.Protected||e.kind===ne.Drilldown||e.kind===ne.Boolean||e.kind===ne.Image||e.kind===ne.Custom)}function Go(e){return e.kind===Ot.Marker||e.kind===Ot.NewRow||e.kind===Ot.RowStatus}function Yo(e){if(!Xo(e)||e.kind===ne.Image)return!1;switch(e.kind){case ne.Text:case ne.Number:case ne.Markdown:case ne.Uri:case ne.Custom:case ne.Boolean:return e.readonly!==!0;default:xr(e,"A cell was passed with an invalid kind")}}function ka(e){return ga(e,"editor")}function _i(e){return!(e.readonly??!1)}var Ot;(function(e){e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id"})(Ot||(Ot={}));const ei={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Ii(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let El;const nn=class nn{constructor(t){Ne(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new nn(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Ii([...this.items,n]);return new nn(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[l,d]=a;if(l<=r&&o<=d){const f=[];l<o&&f.push([l,o]),r<d&&f.push([r,d]),n.splice(i,1,...f)}}return new nn(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Ne(nn,"create",t=>new nn(Ii(t))),Ne(nn,"empty",()=>El??(El=new nn([]))),Ne(nn,"fromSingleSelection",t=>nn.empty().add(t)),Ne(nn,"fromArray",t=>{if(t.length===0)return nn.empty();const n=t.map(r=>[r,r+1]),o=Ii(n);return new nn(o)});let it=nn;const Sa=fn("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Qt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,l=d=>{var f;(f=i.current)==null||f.call(a,d)};return a.addEventListener(e,l,{passive:o,capture:r}),()=>{a.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function eo(e,t){return e===void 0?void 0:t}const Ma=Math.PI;function Il(e){return e*Ma/180}const es=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ts=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},ns=(e,t,n)=>Math.min(e,t-n*2),os=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Ui=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Ra=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Ea(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const a=s.useRef(Jl(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const Ia="֑-߿יִ-﷽ﹰ-ﻼ",Ha="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",Ta=new RegExp("^[^"+Ha+"]*["+Ia+"]");function Ki(e){return Ta.test(e)?"rtl":"not-rtl"}let Vr;function Bi(){if(typeof document>"u")return 0;if(Vr!==void 0)return Vr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Vr=n-o,Vr}const yo=Symbol();function Da(e){const t=s.useRef([yo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const d=t.current[0];d!==yo&&(l=typeof l=="function"?l(d):l,l===d)||(d!==yo&&r({}),o(f=>typeof l=="function"?l(d===yo?f:d):l),t.current[0]=yo)},[]),a=s.useCallback(()=>{t.current[0]=yo,r({})},[]);return[t.current[0]===yo?n:t.current[0],i,a]}function rs(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Fa(e){const t=s.useRef(e);return Ko(e,t.current)||(t.current=e),t.current}const Aa=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const a=i.length>1;return s.createElement(Sa,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(ma.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(l=>{const d=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},d)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Ui,null)))},za=fn("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class Pa extends Tt.PureComponent{constructor(){super(...arguments);Ne(this,"targetElement",null);Ne(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=Ca(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let d=i==null?void 0:i(a);if(d===void 0){const u=document.createElement("template");u.innerHTML=a,d=u.content}n.append(d);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Tt.createElement(za,{ref:this.containerRefHook})}}const La=fn("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Ba=fn("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),Wa=fn("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let Hl=0;const Vi=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...l}=e,{onChange:d,className:f}=l,u=s.useRef(null),m=n??"";cn(d!==void 0,"GrowingEntry must be a controlled input area");const[g]=s.useState(()=>"input-box-"+(Hl=(Hl+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const b=m.toString().length;h.focus(),h.setSelectionRange(r?0:b,b)},[]),s.useLayoutEffect(()=>{var h;if(a!==void 0){const b=typeof a=="number"?[a,null]:a;(h=u.current)==null||h.setSelectionRange(b[0],b[1])}},[a]);const w=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(Wa,{className:"gdg-growing-entry"},s.createElement(Ba,{className:f},m+`
`),s.createElement(La,{...l,className:(f??"")+" gdg-input",id:g,ref:u,onKeyDown:w,value:m,placeholder:t,dir:"auto"}))},Hi={};let Zn=null;function $a(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Vo(e){const t=e.toLowerCase().trim();if(Hi[t]!==void 0)return Hi[t];Zn=Zn||$a(),Zn.style.color="#000",Zn.style.color=t;const n=getComputedStyle(Zn).color;Zn.style.color="#fff",Zn.style.color=t;const o=getComputedStyle(Zn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),Hi[t]=r,r}function oo(e,t){const[n,o,r]=Vo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const Tl=new Map;function Dl(e,t){const n=`${e}-${t}`,o=Tl.get(n);if(o!==void 0)return o;const r=dn(e,t);return Tl.set(n,r),r}function dn(e,t){if(t===void 0)return e;const[n,o,r,i]=Vo(e);if(i===1)return e;const[a,l,d,f]=Vo(t),u=i+f*(1-i),m=(i*n+f*a*(1-i))/u,g=(i*o+f*l*(1-i))/u,w=(i*r+f*d*(1-i))/u;return`rgba(${m}, ${g}, ${w}, ${u})`}function sf(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,a]=Vo(e),[l,d,f,u]=Vo(t),m=o*a,g=r*a,w=i*a,h=l*u,b=d*u,v=f*u,C=n,y=1-n,R=a*y+u*C;if(R===0)return"rgba(0, 0, 0, 0)";const T=Math.floor((m*y+h*C)/R),P=Math.floor((g*y+b*C)/R),N=Math.floor((w*y+v*C)/R);return`rgba(${T}, ${P}, ${N}, ${R})`}function af(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=Vo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Na(e,t){return Tt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function Oa(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(vr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function vo(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Wi(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function is(e,t){const n=vo(e),o=vo(t);return n===o}function ti(e,t,n,o){for(let r=0;r<=n;r++){const i=Wi(e,r,o)??"",a=Wi(t,r,o)??"";if(i!==a)return!1}return!0}function Xa(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function ls(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function vr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ss(e){return[e.x+e.width-1,e.y+e.height-1]}function Fl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[l,d]=e;if(d<i||d>a)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Ya(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&Fl(e,t,i)&&r++;for(const a of n.current.rangeStack)Fl(e,t,a)&&r++;return r}function as(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function qo(e,t){let n=0;const o=as(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function Co(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function $i(e,t,n,o,r){const i=as(e,o),a=[];for(const f of i)if(f.sticky)a.push(f);else break;if(a.length>0)for(const f of a)n-=f.width;let l=t,d=r??0;for(;d<=n&&l<i.length;)d+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||a.push(u)}return a}function Ga(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function _a(e,t,n,o,r,i,a,l,d,f,u,m){const g=u??(n?1:0),w=m??(n?[r]:[]),h=w.reduce((R,T)=>R+T,0),b=o+h;if(n&&g>0){let R=0;for(let T=0;T<g;T++)if(R+=w[T]??0,e<=R)return-(T+2)}if(e<=b)return-1;let v=t;for(let R=0;R<f;R++){const T=i-1-R,P=typeof a=="number"?a:a(T);if(v-=P,e>=v)return T}const C=i-f,y=e-(d??0);if(typeof a=="number"){const R=Math.floor((y-b)/a)+l;return R>=C?void 0:R}else{let R=b;for(let T=l;T<C;T++){const P=a(T);if(y<=R+P)return T;R+=P}return}}let Zr=0,Cr={};const Ua=typeof window>"u";async function Ka(){var e;Ua||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Zr=0,Cr={},ba())}Ka();function cs(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function xo(e,t,n,o="middle"){const r=cs(e,t,o,n);let i=Cr[r];return i===void 0&&(i=t.measureText(e),Cr[r]=i,Zr++),Zr>1e4&&(Cr={},Zr=0),i}function ds(e,t){const n=cs(e,void 0,"middle",t);return Cr[n]}function un(e,t){return typeof t!="string"&&(t=t.baseFontFull),Va(e,t)}function Al(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const zl=[];function Va(e,t){for(const i of zl)if(i.key===t)return i.val;const n=Al(e,"alphabetic"),r=-(Al(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return zl.push({key:t,val:r}),r}function qa(e,t,n,o,r,i){const{ctx:a,rect:l,theme:d}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const m=1-f/u;a.globalAlpha=m,a.fillStyle=d.bgSearchResult,a.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=d.bgSearchResult)}return f<u}function li(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function cf(e,t,n,o,r){const{rect:i,ctx:a,theme:l}=e;a.fillStyle=l.textDark,Xn({ctx:a,rect:i,theme:l},t,n,o,r)}function us(e,t,n,o,r,i,a,l,d){d==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+a):d==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+a)}function fs(e,t){const n=xo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function ja(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Za(e,t,n,o,r,i,a,l,d,f){const u=l.baseFontFull,m=wa(e,t,u,r-l.cellHorizontalPadding*2,f??!1),g=fs(e,u),w=l.lineHeight*g,h=g+w*(m.length-1),b=h+l.cellVerticalPadding>i;b&&(e.save(),e.rect(n,o,r,i),e.clip());const v=o+i/2-h/2;let C=Math.max(o+l.cellVerticalPadding,v);for(const y of m)if(us(e,y,n,C,r,g,a,l,d),C+=w,C>o+i)break;b&&e.restore()}function Xn(e,t,n,o,r){const{ctx:i,rect:a,theme:l}=e,{x:d,y:f,width:u,height:m}=a;o=o??!1,o||(t=ja(t,u));const g=un(i,l),w=Ki(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Za(i,t,d,f,u,m,g,l,n,r):us(i,t,d,f,u,m,g,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function Dn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Ja(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Qa(e,t,n){const o=function(l,d){const f=d.x-l.x,u=d.y-l.y,m=Math.sqrt(f*f+u*u),g=f/m,w=u/m;return{x:f,y:d.y-l.y,len:m,nx:g,ny:w,ang:Math.atan2(w,g)}};let r;const i=t.length;let a=t[i-1];for(let l=0;l<i;l++){let d=t[l%i];const f=t[(l+1)%i],u=o(d,a),m=o(d,f),g=u.nx*m.ny-u.ny*m.nx,w=u.nx*m.nx-u.ny*-m.ny;let h=Math.asin(g<-1?-1:g>1?1:g),b=1,v=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,b=-1,v=!0):h>0&&(b=-1,v=!0),r=d.radius!==void 0?d.radius:n;const C=h/2;let y=Math.abs(Math.cos(C)*r/Math.sin(C)),R;y>Math.min(u.len/2,m.len/2)?(y=Math.min(u.len/2,m.len/2),R=Math.abs(y*Math.sin(C)/Math.cos(C))):R=r;let T=d.x+m.nx*y,P=d.y+m.ny*y;T+=-m.ny*R*b,P+=m.nx*R*b,e.arc(T,P,R,u.ang+Math.PI/2*b,m.ang-Math.PI/2*b,v),a=d,d=f}e.closePath()}function Ni(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b,v){const C={x:0,y:i+f,width:0,height:0},y=b??(r>0?1:0),R=-(y+1);if(e>=w.length||t>=u||t<R||e<0)return C;const T=v??(r>0?[r]:[]),P=T.reduce((F,H)=>F+H,0),N=i-P;if(e>=m){const F=a>e?-1:1,H=qo(w);C.x+=H+d;for(let S=a;S!==e;S+=F)C.x+=w[F===1?S:S-1].width*F}else for(let F=0;F<e;F++)C.x+=w[F].width;if(C.width=w[e].width+1,t===-1)C.y=P,C.height=N;else if(t<=-2){const F=-(t+2);let H=0;for(let A=0;A<F;A++)H+=T[A]??0;C.y=H,C.height=T[F]??r;let S=e;const X=w[e].group,$=w[e].sticky;for(;S>0&&ti(w[S-1].group,X,F,y)&&w[S-1].sticky===$;){const A=w[S-1];C.x-=A.width,C.width+=A.width,S--}let D=e;for(;D+1<w.length&&ti(w[D+1].group,X,F,y)&&w[D+1].sticky===$;){const A=w[D+1];C.width+=A.width,D++}if(!$){const A=qo(w),B=C.x-A;B<0&&(C.x-=B,C.width+=B),C.x+C.width>n&&(C.width=n-C.x)}}else if(t>=u-g){let F=u-t;for(C.y=o;F>0;){const H=t+F-1;C.height=typeof h=="number"?h:h(H),C.y-=C.height,F--}C.height+=1}else{const F=l>t?-1:1;if(typeof h=="number"){const H=t-l;C.y+=H*h}else for(let H=l;H!==t;H+=F)C.y+=h(H)*F;C.height=(typeof h=="number"?h:h(t))+1}return C}const qi=1<<21;function Mn(e,t){return(t+2)*qi+e}function hs(e){return e%qi}function ji(e){return Math.floor(e/qi)-2}function Zi(e){const t=hs(e),n=ji(e);return[t,n]}class gs{constructor(){Ne(this,"visibleWindow",{x:0,y:0,width:0,height:0});Ne(this,"freezeCols",0);Ne(this,"freezeRows",[]);Ne(this,"isInWindow",t=>{const n=hs(t),o=ji(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Ko(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class ec extends gs{constructor(){super(...arguments);Ne(this,"cache",new Map);Ne(this,"setValue",(n,o)=>{this.cache.set(Mn(n[0],n[1]),o)});Ne(this,"getValue",n=>this.cache.get(Mn(n[0],n[1])));Ne(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Uo{constructor(t=[]){Ne(this,"cells");this.cells=new Set(t.map(n=>Mn(n[0],n[1])))}add(t){this.cells.add(Mn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(Mn(t[0],t[1]))}remove(t){this.cells.delete(Mn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(ji(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(Mn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Zi(t)}}function tc(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ms={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function ws(){return ms}const bs=Tt.createContext(ms);function df(){return Tt.useContext(bs)}function Fn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=dn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Oi=150;function nc(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Oi}function ys(e,t,n,o,r,i,a,l,d){let f=0;const u=r===void 0?[]:r.map(w=>{const h=nc(e,w[o],t,d);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let w=0;for(const b of u)w+=b;const h=w/u.length;for(let b=0;b<u.length;b++)u[b]>=h*2?u[b]=0:f=Math.max(f,u[b])}const m=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=m;const g=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(f)));return{...n,width:g}}function oc(e,t,n,o,r,i,a,l,d){const f=s.useRef(t),u=s.useRef(n),m=s.useRef(a);f.current=t,u.current=n,m.current=a;const[g,w]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const y=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",[y,y.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(g&&document.documentElement.append(g),()=>{g==null||g.remove()}),[g]);const h=s.useRef({}),b=s.useRef(),[v,C]=s.useState();return s.useLayoutEffect(()=>{const y=u.current;if(y===void 0||e.every(Kr))return;let R=Math.max(1,10-Math.floor(e.length/1e4)),T=0;R<f.current&&R>1&&(R--,T=1);const P={x:0,y:0,width:e.length,height:Math.min(f.current,R)},N={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const H=y(P,d.signal),S=T>0?y(N,d.signal):void 0;let X;typeof H=="object"?X=H:X=await Rl(H),S!==void 0&&(typeof S=="object"?X=[...X,...S]:X=[...X,...await Rl(S)]),b.current=e,C(X)})()},[d.signal,e]),s.useMemo(()=>{let R=e.every(Kr)?e:w===null?e.map(F=>Kr(F)?F:{...F,width:Oi}):(w.font=m.current.baseFontFull,e.map((F,H)=>{if(Kr(F))return F;if(h.current[F.id]!==void 0)return{...F,width:h.current[F.id]};if(v===void 0||b.current!==e||F.id===void 0)return{...F,width:Oi};const S=ys(w,a,F,H,v,r,i,!0,l);return h.current[F.id]=S.width,S})),T=0,P=0;const N=[];for(const[F,H]of R.entries())T+=H.width,H.grow!==void 0&&H.grow>0&&(P+=H.grow,N.push(F));if(T<o&&N.length>0){const F=[...R],H=o-T;let S=H;for(let X=0;X<N.length;X++){const $=N[X],D=(R[$].grow??0)/P,A=X===N.length-1?S:Math.min(S,Math.floor(H*D));F[$]={...R[$],growOffset:A,width:R[$].width+A},S-=A}R=F}return{sizedColumns:R,nonGrowWidth:T}},[o,e,w,v,a,r,i,l])}const pt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',rc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},ps=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},cc=e=>{const t=e.bgColor;return`${pt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},dc=ps,uc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},fc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},hc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},gc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},mc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},wc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},bc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},yc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},pc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},vc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},Cc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},xc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},kc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},Sc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},Mc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Rc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},Ec=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},Ic=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},Hc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},Tc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},Dc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},Fc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),Ac=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),zc={headerRowID:rc,headerNumber:lc,headerCode:ic,headerString:sc,headerBoolean:ac,headerAudioUri:dc,headerVideoUri:uc,headerEmoji:fc,headerImage:hc,headerUri:ps,headerPhone:gc,headerMarkdown:mc,headerDate:wc,headerTime:bc,headerEmail:yc,headerReference:pc,headerIfThenElse:vc,headerSingleValue:Cc,headerLookup:xc,headerTextTemplate:kc,headerMath:Sc,headerRollup:Mc,headerJoinStrings:Rc,headerSplitString:Ec,headerGeoDistance:Ic,headerArray:Hc,rowOwnerOverlay:Tc,protectedColumnOverlay:Dc,renameIcon:cc,headerArrowDown:Fc,headerArrowUp:Ac};function Pc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Lc{constructor(t,n){Ne(this,"onSettled");Ne(this,"spriteMap",new Map);Ne(this,"headerIcons");Ne(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,l,d=1){const[f,u]=Pc(n,l),m=a*Math.ceil(window.devicePixelRatio),g=`${f}_${u}_${m}_${t}`;let w=this.spriteMap.get(g);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const b=w.getContext("2d");if(b===null)return;const v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(g,w);const C=v.decode();if(C===void 0)return;this.inFlight++,C.then(()=>{b.drawImage(v,0,0,m,m)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else d<1&&(o.globalAlpha=d),o.drawImage(w,0,0,m,m,r,i,a,a),d<1&&(o.globalAlpha=1)}}function vs(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function si(e,t,n,o,r,i,a,l,d){l=l??t;let f=t,u=e;const m=o-i;let g=!1;for(;f<n&&u<m;){const w=r(u);if(f+w>l&&d(f,u,w,!1,a&&u===o-1)===!0){g=!0;break}f+=w,u++}if(!g){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,d(f,u,h,!0,a&&u===o-1)}}}function ro(e,t,n,o,r,i){let a=0,l=0;const d=r+o;for(const f of e){const u=f.sticky?l:a+n;if(i(f,u,d,f.sticky?0:l,t)===!0)break;a+=f.width,l+=f.sticky?f.width:0}}function Bc(e,t,n,o,r){let i=0,a=0;for(let l=0;l<e.length;l++){const d=e[l];let f=l+1,u=d.width;for(d.sticky&&(a+=u);f<e.length&&is(e[f].group,d.group)&&e[f].sticky===e[l].sticky;){const b=e[f];u+=b.width,f++,l++,b.sticky&&(a+=b.width)}const m=d.sticky?0:n,g=i+m,w=d.sticky?0:Math.max(0,a-g),h=Math.min(u-w,t-(g+w));r([d.sourceIndex,e[f-1].sourceIndex],vo(d.group),g+w,0,h,o),i+=u}}function Wc(e,t,n,o,r,i){if(r===0)return;const a=[];let l=0;for(let u=0;u<r;u++)a.push(l),l+=o[u]??0;const d=[];let f=0;for(const u of e)d.push(f),f+=u.width;for(let u=0;u<r;u++){const m=a[u],g=o[u]??0;let w=0,h=0;for(;h<e.length;){const b=e[h],v=Wi(b.group,u,r);if(v===void 0){b.sticky&&(w+=b.width),h++;continue}const C=d[h];let y=h+1,R=b.width;for(b.sticky&&(w+=b.width);y<e.length;){const H=e[y],S=ti(H.group,b.group,u,r),X=H.sticky===b.sticky;if(!S||!X)break;R+=H.width,H.sticky&&(w+=H.width),y++}const T=b.sticky?0:n,P=C+T,N=b.sticky?0:Math.max(0,w-P),F=Math.min(R-N,t-(P+N));F>0&&i([b.sourceIndex,e[y-1].sourceIndex],v,P+N,m,F,g,u),h=y}}}function Cs(e,t,n,o,r,i,a){var g;const[l,d]=e;let f,u;const m=((g=a.find(w=>!w.sticky))==null?void 0:g.sourceIndex)??0;if(d>m){const w=Math.max(l,m);let h=t,b=o;for(let v=i.sourceIndex-1;v>=w;v--)h-=a[v].width,b+=a[v].width;for(let v=i.sourceIndex+1;v<=d;v++)b+=a[v].width;u={x:h,y:n,width:b,height:r}}if(m>l){const w=Math.min(d,m-1);let h=t,b=o;for(let v=i.sourceIndex-1;v>=l;v--)h-=a[v].width,b+=a[v].width;for(let v=i.sourceIndex+1;v<=w;v++)b+=a[v].width;f={x:h,y:n,width:b,height:r}}return[f,u]}function $c(e,t,n,o){if(o==="any")return xs(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),ls([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,l=e.y+e.height-n,d=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return d===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:d===a?{x:e.x,y:n,width:e.width,height:e.y-n}:d===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function kr(e,t,n,o,r,i,a,l){return e<=r+a&&r<=e+n&&t<=i+l&&i<=t+o}function no(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function xs(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function Nc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Oc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,l=n+4,d=r-e.x,f=e.x+e.width-a,u=i-e.y,m=e.y+e.height-l,g=d>0?e.x+Math.floor(d/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,b=m>0?e.y+e.height-Math.floor(m/o)*o:e.y+e.height;return{x:g,y:h,width:w-g,height:b-h}}function Xc(e,t,n,o,r){const[i,a,l,d]=t,[f,u,m,g]=r,{x:w,y:h,width:b,height:v}=e,C=[];if(b<=0||v<=0)return C;const y=w+b,R=h+v,T=w<i,P=h<a,N=w+b>l,F=h+v>d,H=w>=i&&w<l||y>i&&y<=l||w<i&&y>l,S=h>=a&&h<d||R>a&&R<=d||h<a&&R>d;if(H&&S){const $=Math.max(w,i),D=Math.max(h,a),A=Math.min(y,l),B=Math.min(R,d);C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:f,y:u,width:m-f+1,height:g-u+1}})}if(T&&P){const $=w,D=h,A=Math.min(y,i),B=Math.min(R,a);C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:0,y:0,width:f+1,height:u+1}})}if(P&&H){const $=Math.max(w,i),D=h,A=Math.min(y,l),B=Math.min(R,a);C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:f,y:0,width:m-f+1,height:u+1}})}if(P&&N){const $=Math.max(w,l),D=h,A=y,B=Math.min(R,a);C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:m,y:0,width:n-m+1,height:u+1}})}if(T&&S){const $=w,D=Math.max(h,a),A=Math.min(y,i),B=Math.min(R,d);C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:0,y:u,width:f+1,height:g-u+1}})}if(N&&S){const $=Math.max(w,l),D=Math.max(h,a),A=y,B=Math.min(R,d);C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:m,y:u,width:n-m+1,height:g-u+1}})}if(T&&F){const $=w,D=Math.max(h,d),A=Math.min(y,i),B=R;C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:0,y:g,width:f+1,height:o-g+1}})}if(F&&H){const $=Math.max(w,i),D=Math.max(h,d),A=Math.min(y,l),B=R;C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:f,y:g,width:m-f+1,height:o-g+1}})}if(N&&F){const $=Math.max(w,l),D=Math.max(h,d),A=y,B=R;C.push({rect:{x:$,y:D,width:A-$,height:B-D},clip:{x:m,y:g,width:n-m+1,height:o-g+1}})}return C}const Yc={kind:ne.Loading,allowOverlay:!1};function Pl(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b,v,C,y,R,T,P,N,F,H,S,X,$,D,A,B,te,q,fe,pe){let ae=(R==null?void 0:R.size)??Number.MAX_SAFE_INTEGER;const J=performance.now();let V=A.baseFontFull;e.font=V;const ce={ctx:e},he=[0,0],ve=v>0?Co(d,v,f):0;let re,Ce;const ie=new Uo,j=new Set,Me=vs(y);if(ro(t,l,i,a,r,(ue,Ye,_e,xe,We)=>{const lt=Math.max(0,xe-Ye),dt=Ye+lt,Te=r+1,Mt=ue.width-lt,de=o-r-1;if(y.length>0){let Ae=!1;for(let Ue=0;Ue<y.length;Ue++){const ot=y[Ue];if(kr(dt,Te,Mt,de,ot.x,ot.y,ot.width,ot.height)){Ae=!0;break}}if(!Ae)return}const we=()=>{e.save(),e.beginPath(),e.rect(dt,Te,Mt,de),e.clip()},ge=T.columns.hasIndex(ue.sourceIndex),De=m(vo(ue.group)).overrideTheme,$e=ue.themeOverride===void 0&&De===void 0?A:Fn(A,De,ue.themeOverride),st=$e.baseFontFull;st!==V&&(V=st,e.font=st),we();let nt;return si(We,_e,o,d,f,v,C,Me,(Ae,Ue,ot,Dt,U)=>{var rn,Kt,Pn;if(Ue<0)return;if(he[0]=ue.sourceIndex,he[1]=Ue,ie.has(he)){ae--;return}if(R!==void 0&&!R.has(he))return;if(y.length>0){let Re=!1;for(let et=0;et<y.length;et++){const tt=y[et];if(kr(Ye,Ae,ue.width,ot,tt.x,tt.y,tt.width,tt.height)){Re=!0;break}}if(!Re)return}const mt=T.rows.hasIndex(Ue),at=w.hasIndex(Ue),le=Ue<d?u(he):Yc;let gt=Ye,ft=ue.width,Le=Ae,qe=ot,xt=!1,zt=!1;if(le.rowspan!==void 0){const[Re,et]=le.rowspan,tt=`${ue.sourceIndex}|${Re}`;if(j.has(tt)){ae--;return}else{let Wt=Ae;for(let Pe=Re;Pe<Ue;Pe++)Wt-=f(Pe);let Xt=0;for(let Pe=Re;Pe<et;Pe++)Xt+=f(Pe);if(Wt<Te+de&&Wt+Xt>Te){Le=Wt,qe=Xt,j.add(tt);for(let Pe=Re;Pe<et;Pe++)Pe!==Ue&&ie.add([ue.sourceIndex,Pe]);xt=!0}else{j.add(tt);for(let Pe=Re;Pe<et;Pe++)ie.add([ue.sourceIndex,Pe]);ae--;return}}}if(le.span!==void 0){const[Re,et]=le.span,tt=`${Ue},${Re},${et},${ue.sticky}`;if(Ce===void 0&&(Ce=new Set),Ce.has(tt)){ae--;return}else{const Wt=Cs(le.span,Ye,Ae,ue.width,ot,ue,n),Xt=ue.sticky?Wt[0]:Wt[1];!ue.sticky&&Wt[0]!==void 0&&(zt=!0),Xt!==void 0&&(gt=Xt.x,ft=Xt.width,Ce.add(tt),xt=!0)}}if(xt){e.restore(),nt=void 0,e.save(),e.beginPath();const Re=Math.max(0,xe-gt);e.rect(gt+Re,Le,ft-Re,qe),re===void 0&&(re=[]),re.push({x:gt+Re,y:Le,width:ft-Re,height:qe}),e.clip()}const qt=g==null?void 0:g(Ue),jt=U&&((rn=ue.trailingRowOptions)==null?void 0:rn.themeOverride)!==void 0?(Kt=ue.trailingRowOptions)==null?void 0:Kt.themeOverride:void 0,vt=le.themeOverride===void 0&&qt===void 0&&jt===void 0?$e:Fn($e,qt,jt,le.themeOverride);e.beginPath();const en=Xa(he,le,T);let Zt=Ya(he,le,T,b);const An=le.span!==void 0&&T.columns.some(Re=>le.span!==void 0&&Re>=le.span[0]&&Re<=le.span[1]);en&&!h&&b?Zt=0:en&&b&&(Zt=Math.max(Zt,1)),An&&Zt++,en||(mt&&Zt++,ge&&!U&&Zt++);const zn=le.kind===ne.Protected?vt.bgCellMedium:vt.bgCell;let yt;if((Dt||zn!==A.bgCell)&&(yt=dn(zn,yt)),Zt>0||at){at&&(yt=dn(vt.bgHeader,yt));for(let Re=0;Re<Zt;Re++)yt=dn(vt.accentLight,yt)}else if(P!==void 0){for(const Re of P)if(Re[0]===ue.sourceIndex&&Re[1]===Ue){yt=dn(vt.bgSearchResult,yt);break}}if(N!==void 0)for(let Re=0;Re<N.length;Re++){const et=N[Re],tt=et.range;et.style!=="solid-outline"&&tt.x<=ue.sourceIndex&&ue.sourceIndex<tt.x+tt.width&&tt.y<=Ue&&Ue<tt.y+tt.height&&(yt=dn(et.color,yt))}let Ke=!1;if(R!==void 0){const Re=Ae+1,tt=(Dt?Re+ot-1:Math.min(Re+ot-1,o-ve))-Re;(tt!==ot-1||gt+1<=xe)&&(Ke=!0,e.save(),e.beginPath(),e.rect(gt+1,Re,ft-1,tt),e.clip()),yt=yt===void 0?vt.bgCell:dn(yt,vt.bgCell)}const Je=ue.sourceIndex===n.length-1,Ut=Ue===d-1;yt!==void 0&&(e.fillStyle=yt,nt!==void 0&&(nt.fillStyle=yt),R!==void 0?e.fillRect(gt+1,Le+1,ft-(Je?2:1),qe-(Ut?2:1)):e.fillRect(gt,Le,ft,qe)),le.style==="faded"&&(e.globalAlpha=.6);let on;for(let Re=0;Re<S.length;Re++){const et=S[Re];if(et.item[0]===ue.sourceIndex&&et.item[1]===Ue){on=et;break}}if(ft>pe&&!zt){const Re=vt.baseFontFull;Re!==V&&(e.font=Re,V=Re);let et=0;if(le.rowspan!==void 0){const tt=le.rowSpanPosition??"top";if(tt==="top")et=ot/2-qe/2;else if(tt==="bottom"){const[Wt,Xt]=le.rowspan,Pe=f(Xt-1);et=qe/2-Pe/2}}nt=ks(e,le,ue.sourceIndex,Ue,Je,Ut,gt,Le,ft,qe,Zt>0,vt,yt??vt.bgCell,F,H,(on==null?void 0:on.hoverAmount)??0,X,D,J,$,nt,B,te,q,fe,et)}return Ke&&e.restore(),le.style==="faded"&&(e.globalAlpha=1),ae--,xt&&(e.restore(),(Pn=nt==null?void 0:nt.deprep)==null||Pn.call(nt,ce),nt=void 0,we(),V=st,e.font=st),ae<=0}),e.restore(),ae<=0}),re!==void 0)return re}const wr=[0,0],br={x:0,y:0,width:0,height:0},Ti=[void 0,()=>{}];let Xi=!1;function Gc(){Xi=!0}function ks(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b,v,C,y,R,T,P,N,F,H,S){var q,fe;let X,$;v!==void 0&&v[0][0]===n&&v[0][1]===o&&(X=v[1][0],$=v[1][1]);let D;wr[0]=n,wr[1]=o,br.x=a,br.y=l,br.width=d,br.height=f,Ti[0]=N.getValue(wr),Ti[1]=pe=>N.setValue(wr,pe),Xi=!1;const A={ctx:e,theme:m,col:n,row:o,cell:t,rect:br,highlighted:u,cellFillColor:g,hoverAmount:b,frameTime:y,hoverX:X,drawState:Ti,hoverY:$,imageLoader:w,spriteManager:h,hyperWrapping:C,overrideCursor:X!==void 0?H:void 0,requestAnimationFrame:Gc},B=qa(A,t.lastUpdated,y,T,r,i),te=F(t);if(te!==void 0){(T==null?void 0:T.renderer)!==te&&((q=T==null?void 0:T.deprep)==null||q.call(T,A),T=void 0);const pe=(fe=te.drawPrep)==null?void 0:fe.call(te,A,T);e.save(),e.translate(0,S),R!==void 0&&!Go(A.cell)?R(A,()=>te.draw(A,t)):te.draw(A,t),e.restore(),D=pe===void 0?void 0:{deprep:pe==null?void 0:pe.deprep,fillStyle:pe==null?void 0:pe.fillStyle,font:pe==null?void 0:pe.font,renderer:te}}return(B||Xi)&&(P==null||P(wr)),D}function ni(e,t,n,o,r,i,a,l,d=-20,f=-20,u=void 0,m="center",g="square",w=!1){const h=Math.floor(r+a/2),b=g==="circle"?1e4:t.roundingRadius??4;let v=ns(u??t.checkboxMaxSize,a,t.cellVerticalPadding),C=v/2;const y=ts(m,o,i,t.cellHorizontalPadding,v),R=es(y,h,v),T=os(o+d,r+f,R);switch(n){case!0:{e.beginPath(),Dn(e,y-v/2,h-v/2,v,v,b),g==="circle"&&(C*=.8,v*=.8),e.fillStyle=w?t.bgCellMedium:l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(y-C+v/4.23,h-C+v/1.97),e.lineTo(y-C+v/2.42,h-C+v/1.44),e.lineTo(y-C+v/1.29,h-C+v/3.25),e.strokeStyle=w?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Jr:case!1:{e.beginPath(),Dn(e,y-v/2+.5,h-v/2+.5,v-1,v-1,b),e.lineWidth=1,e.strokeStyle=w?t.textLight:T?t.textDark:t.textMedium,e.stroke();break}case Gi:{e.beginPath(),Dn(e,y-v/2,h-v/2,v,v,b),e.fillStyle=w?t.bgCellMedium:T?t.textMedium:t.textLight,e.fill(),g==="circle"&&(C*=.8,v*=.8),e.beginPath(),e.moveTo(y-v/3,h),e.lineTo(y+v/3,h),e.strokeStyle=w?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:xr()}}function _c(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b,v,C,y,R,T,P){var te,q,fe,pe;const N=T??(o?1:0),F=P??(o?[d]:[]),H=F.reduce((ae,J)=>ae+J,0),S=l+H;if(S<=0)return;e.fillStyle=g.bgHeader,C!==void 0&&o&&(T??1)>1?e.fillRect(0,H,i,l):e.fillRect(0,0,i,S);const X=(te=r==null?void 0:r[0])==null?void 0:te[0],$=(q=r==null?void 0:r[0])==null?void 0:q[1],D=(fe=r==null?void 0:r[1])==null?void 0:fe[0],A=(pe=r==null?void 0:r[1])==null?void 0:pe[1],B=g.headerFontFull;e.font=B,ro(t,0,a,0,S,(ae,J,V,ce)=>{var We;if(C!==void 0&&!C.has([ae.sourceIndex,-1]))return;const he=Math.max(0,ce-J);e.save(),e.beginPath(),e.rect(J+he,H,ae.width-he,l),e.clip();const ve=v(vo(ae.group)).overrideTheme,re=ae.themeOverride===void 0&&ve===void 0?g:Fn(g,ve,ae.themeOverride);re.bgHeader!==g.bgHeader&&(e.fillStyle=re.bgHeader,e.fill()),re!==g&&(e.font=re.headerFontFull);const Ce=m.columns.hasIndex(ae.sourceIndex),ie=f!==void 0||u||ae.headerRowMarkerDisabled===!0,j=!ie&&$===-1&&X===ae.sourceIndex,Me=ie?0:((We=h.find(lt=>lt.item[0]===ae.sourceIndex&&lt.item[1]===-1))==null?void 0:We.hoverAmount)??0,ue=(m==null?void 0:m.current)!==void 0&&m.current.cell[0]===ae.sourceIndex,Ye=Ce?re.accentColor:ue?re.bgHeaderHasFocus:re.bgHeader,_e=o?H:0,xe=ae.sourceIndex===0?0:1;Ce?(e.fillStyle=Ye,e.fillRect(J+xe,_e,ae.width-xe,l)):(ue||Me>0)&&(e.beginPath(),e.rect(J+xe,_e,ae.width-xe,l),ue&&(e.fillStyle=re.bgHeaderHasFocus,e.fill()),Me>0&&(e.globalAlpha=Me,e.fillStyle=re.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Ms(e,J,_e,ae.width,l,ae,Ce,re,j,j?D:void 0,j?A:void 0,ue,Me,w,y,R),e.restore()}),o&&(N>1?Kc(e,t,i,a,F,N,r,g,w,h,b,v,C):Uc(e,t,i,a,d,r,g,w,h,b,v,C)),o&&(T??1)>1&&(e.beginPath(),e.moveTo(0,H+.5),e.lineTo(i,H+.5),e.strokeStyle=g.borderColor,e.lineWidth=1,e.stroke())}function Uc(e,t,n,o,r,i,a,l,d,f,u,m){const[w,h]=(i==null?void 0:i[0])??[];let b=0;Bc(t,n,o,r,(v,C,y,R,T,P)=>{if(m!==void 0&&!m.hasItemInRectangle({x:v[0],y:-2,width:v[1]-v[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,R,T,P),e.clip();const N=u(C),F=(N==null?void 0:N.overrideTheme)===void 0?a:Fn(a,N.overrideTheme),H=h===-2&&w!==void 0&&w>=v[0]&&w<=v[1],S=H?F.bgGroupHeaderHovered??F.bgHeaderHovered:F.bgGroupHeader??F.bgHeader;if(S!==a.bgHeader&&(e.fillStyle=S,e.fill()),e.fillStyle=F.textGroupHeader??F.textHeader,N!==void 0){let X=y;if(N.icon!==void 0&&(l.drawSprite(N.icon,"normal",e,X+8,(r-20)/2,20,F),X+=26),e.fillText(N.name,X+8,r/2+un(e,a.headerFontFull)),N.actions!==void 0&&H){const $=Ji({x:y,y:R,width:T,height:P},N.actions);e.beginPath();const D=$[0].x-10,A=y+T-D;e.rect(D,0,A,r);const B=e.createLinearGradient(D,0,D+A,0),te=oo(S,0);B.addColorStop(0,te),B.addColorStop(10/A,S),B.addColorStop(1,S),e.fillStyle=B,e.fill(),e.globalAlpha=.6;const[q,fe]=(i==null?void 0:i[1])??[-1,-1];for(let pe=0;pe<N.actions.length;pe++){const ae=N.actions[pe],J=$[pe],V=no(J,q+y,fe);V&&(e.globalAlpha=1),l.drawSprite(ae.icon,"normal",e,J.x+J.width/2-10,J.y+J.height/2-10,20,F),V&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&f(v[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),b=y+T}),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}function Kc(e,t,n,o,r,i,a,l,d,f,u,m,g){const[w,h]=(a==null?void 0:a[0])??[];e.font=l.headerFontFull;const b=r.reduce((C,y)=>C+y,0);g===void 0&&(e.fillStyle=l.bgHeader,e.fillRect(0,0,n,b));let v=0;if(Wc(t,n,o,r,i,(C,y,R,T,P,N,F)=>{const H=-(F+2);if(g!==void 0&&!g.hasItemInRectangle({x:C[0],y:H,width:C[1]-C[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(R,T,P,N),e.clip();const S=m(y),X=(S==null?void 0:S.overrideTheme)===void 0?l:Fn(l,S.overrideTheme),$=h===H&&w!==void 0&&w>=C[0]&&w<=C[1],D=$?X.bgGroupHeaderHovered??X.bgHeaderHovered:X.bgGroupHeader??X.bgHeader;e.fillStyle=D,e.fillRect(R,T,P,N),e.fillStyle=X.textGroupHeader??X.textHeader;const A=(S==null?void 0:S.name)??y,te=e.measureText(A).width,q=(S==null?void 0:S.icon)!==void 0?26:0,fe=q+te,pe=R+(P-fe)/2;if((S==null?void 0:S.icon)!==void 0&&d.drawSprite(S.icon,"normal",e,pe,T+(N-20)/2,20,X),e.fillText(A,pe+q,T+N/2+un(e,l.headerFontFull)),S!==void 0&&S.actions!==void 0&&$){const ae=Ji({x:R,y:T,width:P,height:N},S.actions);e.beginPath();const J=ae[0].x-10,V=R+P-J;e.rect(J,T,V,N);const ce=e.createLinearGradient(J,0,J+V,0),he=oo(D,0);ce.addColorStop(0,he),ce.addColorStop(10/V,D),ce.addColorStop(1,D),e.fillStyle=ce,e.fill(),e.globalAlpha=.6;const[ve,re]=(a==null?void 0:a[1])??[-1,-1];for(let Ce=0;Ce<S.actions.length;Ce++){const ie=S.actions[Ce],j=ae[Ce],Me=no(j,ve+R,re);Me&&(e.globalAlpha=1),d.drawSprite(ie.icon,"normal",e,j.x+j.width/2-10,j.y+j.height/2-10,20,X),Me&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=l.borderColor,e.lineWidth=1,R!==0&&u(C[0])&&(e.beginPath(),e.moveTo(R+.5,T),e.lineTo(R+.5,T+N),e.stroke()),(F<i-1||g===void 0)&&(e.beginPath(),e.moveTo(R,T+N+.5),e.lineTo(R+P,T+N+.5),e.stroke()),e.restore(),v=Math.max(v,R+P)}),g===void 0){e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,b);let C=0;for(let y=0;y<i-1;y++)C+=r[y],e.moveTo(0,C+.5),e.lineTo(n,C+.5);e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}}const qr=30;function Vc(e,t,n,o,r){return{x:e+n-qr,y:Math.max(t,t+o/2-qr/2),width:qr,height:Math.min(qr,o)}}function Ji(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function yr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Ss(e,t,n,o,r,i,a,l){var F;const d=a.cellHorizontalPadding,f=a.headerIconSize,u=Vc(n,o,r,i);let m=n+d;const g=t.icon===void 0?void 0:{x:m,y:o+(i-f)/2,width:f,height:f},w=g===void 0||t.overlayIcon===void 0?void 0:{x:g.x+9,y:g.y+6,width:18,height:18};g!==void 0&&(m+=Math.ceil(f*1.3));const h=e===void 0?((F=ds(t.title,a.headerFontFull))==null?void 0:F.width)??0:xo(t.title,e,a.headerFontFull).width,b=t.hasMenu===!0?35:0,v=t.indicatorIcon!==void 0?f+d:0,C=h+v,y=r-(g!==void 0?Math.ceil(f*1.3)+d:d)-b-d,R=n+(g!==void 0?Math.ceil(f*1.3)+d:d)+(y-C)/2,T={x:Math.max(m,R),y:o,width:h,height:i};let P;t.indicatorIcon!==void 0&&(P={x:T.x+h+d,y:o+(i-f)/2,width:f,height:f});const N=n+r/2;return{menuBounds:yr(u,N,l),iconBounds:yr(g,N,l),iconOverlayBounds:yr(w,N,l),textBounds:yr(T,N,l),indicatorIconBounds:yr(P,N,l)}}function Ll(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const y=i.rowMarkerChecked;y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=m);const R=i.headerRowMarkerTheme!==void 0?Fn(l,i.headerRowMarkerTheme):l;ni(e,R,y,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const v=a?l.textHeaderSelected:l.textHeader,C=i.hasMenu===!0&&(d||w&&a)&&b.menuBounds!==void 0;if(i.icon!==void 0&&b.iconBounds!==void 0){let y=a?"selected":"normal";i.style==="highlight"&&(y=a?"selected":"special"),g.drawSprite(i.icon,y,e,b.iconBounds.x,b.iconBounds.y,b.iconBounds.width,l),i.overlayIcon!==void 0&&b.iconOverlayBounds!==void 0&&g.drawSprite(i.overlayIcon,a?"selected":"special",e,b.iconOverlayBounds.x,b.iconOverlayBounds.y,b.iconOverlayBounds.width,l)}if(C&&o>35){const R=h?35:o-35,T=h?35*.7:o-35*.7,P=R/o,N=T/o,F=e.createLinearGradient(t,0,t+o,0),H=oo(v,0);F.addColorStop(h?1:0,v),F.addColorStop(P,v),F.addColorStop(N,H),F.addColorStop(h?0:1,H),e.fillStyle=F}else e.fillStyle=v;if(h&&(e.textAlign="right"),b.textBounds!==void 0&&e.fillText(i.title,h?b.textBounds.x+b.textBounds.width:b.textBounds.x,n+r/2+un(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&b.indicatorIconBounds!==void 0&&(!C||!kr(b.menuBounds.x,b.menuBounds.y,b.menuBounds.width,b.menuBounds.height,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,b.indicatorIconBounds.height))){let y=a?"selected":"normal";i.style==="highlight"&&(y=a?"selected":"special"),g.drawSprite(i.indicatorIcon,y,e,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,l)}if(C&&b.menuBounds!==void 0){const y=b.menuBounds,R=f!==void 0&&u!==void 0&&no(y,f+t,u+n);if(R||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Qr.Triangle){e.beginPath();const T=y.x+y.width/2-5.5,P=y.y+y.height/2-3;Qa(e,[{x:T,y:P},{x:T+11,y:P},{x:T+5.5,y:P+6}],1),e.fillStyle=v,e.fill()}else if(i.menuIcon===Qr.Dots){e.beginPath();const T=y.x+y.width/2,P=y.y+y.height/2;Ja(e,T,P),e.fillStyle=v,e.fill()}else{const T=y.x+(y.width-l.headerIconSize)/2,P=y.y+(y.height-l.headerIconSize)/2;g.drawSprite(i.menuIcon,"normal",e,T,P,l.headerIconSize,l)}R||(e.globalAlpha=1)}}function Ms(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b){const v=Ki(i.title)==="rtl",C=Ss(e,i,t,n,o,r,l,v);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:g,isHovered:d,hasSelectedCell:m,spriteManager:w,menuBounds:(C==null?void 0:C.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>Ll(e,t,n,o,r,i,a,l,d,f,u,g,w,b,v,C)):Ll(e,t,n,o,r,i,a,l,d,f,u,g,w,b,v,C)}function qc(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b,v,C,y){if(C!==void 0||t[t.length-1]!==n[t.length-1])return;const R=vs(v);ro(t,d,a,l,i,(T,P,N,F,H)=>{if(T!==t[t.length-1])return;P+=T.width;const S=Math.max(P,F);S>o||(e.save(),e.beginPath(),e.rect(S,i+1,1e4,r-i-1),e.clip(),si(H,N,r,f,u,h,b,R,(X,$,D,A)=>{if(!A&&v.length>0&&!v.some(pe=>kr(P,X,1e4,D,pe.x,pe.y,pe.width,pe.height)))return;const B=g.hasIndex($),te=w.hasIndex($);e.beginPath();const q=m==null?void 0:m($),fe=q===void 0?y:Fn(y,q);fe.bgCell!==y.bgCell&&(e.fillStyle=fe.bgCell,e.fillRect(P,X,1e4,D)),te&&(e.fillStyle=fe.bgHeader,e.fillRect(P,X,1e4,D)),B&&(e.fillStyle=fe.accentLight,e.fillRect(P,X,1e4,D))}),e.restore())})}function jc(e,t,n,o,r,i,a,l,d){let f=!1;for(const h of t)if(!h.sticky){f=a(h.sourceIndex);break}const u=d.horizontalBorderColor??d.borderColor,m=d.borderColor,g=f?qo(t):0;let w;if(g!==0&&(w=Dl(m,d.bgCell),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=m===u&&w!==void 0?w:Dl(u,d.bgCell),b=Co(i,r,l);e.beginPath(),e.moveTo(0,o-b+.5),e.lineTo(n,o-b+.5),e.strokeStyle=h,e.stroke()}}const Rs=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),a=Math.max(a,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function Zc(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h){var D;const b=h.bgCell,{minX:v,maxX:C,minY:y,maxY:R}=Rs(l,i,a),T=[],P=a-Co(w,g,f);let N=d,F=n,H=0;for(;N+r<P;){const A=N+r,B=f(F);if(A>=y&&A<=R-1){const te=u==null?void 0:u(F),q=te==null?void 0:te.bgCell;q!==void 0&&q!==b&&F>=w-g&&T.push({x:v,y:A,w:C-v,h:B,color:q})}N+=B,F<w-g&&(H=N),F++}let S=0;const X=Math.min(P,R)-H;if(X>0)for(let A=0;A<t.length;A++){const B=t[A];if(B.width===0)continue;const te=B.sticky?S:S+o,q=(D=B.themeOverride)==null?void 0:D.bgCell;q!==void 0&&q!==b&&te>=v&&te<=C&&m(A+1)&&T.push({x:te,y:H,w:B.width,h:X,color:q}),S+=B.width}if(T.length===0)return;let $;e.beginPath();for(let A=T.length-1;A>=0;A--){const B=T[A];$===void 0?$=B.color:B.color!==$&&(e.fillStyle=$,e.fill(),e.beginPath(),$=B.color),e.rect(B.x,B.y,B.w,B.h)}$!==void 0&&(e.fillStyle=$,e.fill()),e.beginPath()}function Bl(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b,v,C=!1){if(d!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const D of d)e.rect(D.x+1,D.y+1,D.width-1,D.height-1);e.clip("evenodd")}const y=v.horizontalBorderColor??v.borderColor,R=v.borderColor,{minX:T,maxX:P,minY:N,maxY:F}=Rs(l,i,a),H=[];e.beginPath();let S=.5;for(let D=0;D<t.length;D++){const A=t[D];if(A.width===0)continue;S+=A.width;const B=A.sticky?S:S+o;B>=T&&B<=P&&w(D+1)&&H.push({x1:B,y1:Math.max(f,N),x2:B,y2:Math.min(a,F),color:R})}let X=a+.5;for(let D=b-h;D<b;D++){const A=m(D);X-=A,H.push({x1:T,y1:X,x2:P,y2:X,color:y})}if(C!==!0){let D=u+.5,A=n;const B=X;for(;D+r<B;){const te=D+r;if(te>=N&&te<=F-1){const q=g==null?void 0:g(A);H.push({x1:T,y1:te,x2:P,y2:te,color:(q==null?void 0:q.horizontalBorderColor)??(q==null?void 0:q.borderColor)??y})}D+=m(A),A++}}const $=ya(H,D=>D.color);for(const D of Object.keys($)){e.strokeStyle=D;for(const A of $[D])e.moveTo(A.x1,A.y1),e.lineTo(A.x2,A.y2);e.stroke(),e.beginPath()}d!==void 0&&e.restore()}function Jc(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b,v,C,y){const R=[];e.imageSmoothingEnabled=!1;const T=Math.min(r.cellYOffset,a),P=Math.max(r.cellYOffset,a);let N=0;if(typeof C=="number")N+=(P-T)*C;else for(let B=T;B<P;B++)N+=C(B);a>r.cellYOffset&&(N=-N),N+=d-r.translateY;const F=Math.min(r.cellXOffset,i),H=Math.max(r.cellXOffset,i);let S=0;for(let B=F;B<H;B++)S+=b[B].width;i>r.cellXOffset&&(S=-S),S+=l-r.translateX;const X=qo(v);if(S!==0&&N!==0)return{regions:[]};const $=f>0?Co(g,f,C):0,D=u-X-Math.abs(S),A=m-w-$-Math.abs(N)-1;if(D>150&&A>150){const B={sx:0,sy:0,sw:u*h,sh:m*h,dx:0,dy:0,dw:u*h,dh:m*h};if(N>0?(B.sy=(w+1)*h,B.sh=A*h,B.dy=(N+w+1)*h,B.dh=A*h,R.push({x:0,y:w,width:u,height:N+1})):N<0&&(B.sy=(-N+w+1)*h,B.sh=A*h,B.dy=(w+1)*h,B.dh=A*h,R.push({x:0,y:m+N-$,width:u,height:-N+$})),S>0?(B.sx=X*h,B.sw=D*h,B.dx=(S+X)*h,B.dw=D*h,R.push({x:X-1,y:0,width:S+2,height:m})):S<0&&(B.sx=(X-S)*h,B.sw=D*h,B.dx=X*h,B.dw=D*h,R.push({x:u+S,y:0,width:-S,height:m})),e.setTransform(1,0,0,1,0,0),y){if(X>0&&S!==0&&N===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const te=X*h,q=m*h;e.drawImage(t,0,0,te,q,0,0,te,q)}if($>0&&S===0&&N!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const te=(m-$)*h,q=u*h,fe=$*h;e.drawImage(t,0,te,q,fe,0,te,q,fe)}}e.drawImage(t,B.sx,B.sy,B.sw,B.sh,B.dx,B.dy,B.dw,B.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:R}}function Qc(e,t,n,o,r,i,a,l,d,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||ro(d,n,o,r,l,(m,g,w,h)=>{if(m.sourceIndex===f){const b=Math.max(g,h)+1;return u.push({x:b,y:0,width:i-b,height:a}),!0}}),u}function ed(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Ko(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...l}=r,{width:d,...f}=i;if(!Ko(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function Wl(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b){const v=h==null?void 0:h.filter(F=>F.style!=="no-outline");if(v===void 0||v.length===0)return;const C=qo(l),y=Co(w,g,m),R=[d,0,l.length,w-g],T=[C,0,t,n-y],P=v.map(F=>{const H=F.range,S=F.style??"dashed";return Xc(H,R,t,n,T).map(X=>{const $=X.rect,D=Ni($.x,$.y,t,n,u,f+u,o,r,i,a,w,d,g,l,m),A=$.width===1&&$.height===1?D:Ni($.x+$.width-1,$.y+$.height-1,t,n,u,f+u,o,r,i,a,w,d,g,l,m);return $.x+$.width>=l.length&&(A.width-=1),$.y+$.height>=w&&(A.height-=1),{color:F.color,style:S,clip:X.clip,rect:Oc({x:D.x,y:D.y,width:A.x+A.width-D.x,height:A.y+A.height-D.y},t,n,8)}})}),N=()=>{e.lineWidth=1;let F=!1;for(const H of P)for(const S of H)if((S==null?void 0:S.rect)!==void 0&&kr(0,0,t,n,S.rect.x,S.rect.y,S.rect.width,S.rect.height)){const X=F,$=!Nc(S.clip,S.rect);e.beginPath(),$&&(e.save(),e.rect(S.clip.x,S.clip.y,S.clip.width,S.clip.height),e.clip()),S.style==="dashed"&&!F?(e.setLineDash([5,3]),F=!0):(S.style==="solid"||S.style==="solid-outline")&&F&&(e.setLineDash([]),F=!1),e.strokeStyle=S.style==="solid-outline"?dn(dn(S.color,b.borderColor),b.bgCell):oo(S.color,1),e.closePath(),e.strokeRect(S.rect.x+.5,S.rect.y+.5,S.rect.width-1,S.rect.height-1),$&&(e.restore(),F=X)}F&&e.setLineDash([])};return N(),N}function $l(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Di(e,t,n,o,r,i,a,l,d,f,u,m,g,w,h,b,v){if(u.current===void 0)return;const C=b!==!1&&b!==void 0;if(!C)return;const y=typeof b=="object"?{...ei,...b}:ei,R=u.current.range,T=u.current.cell,P=[R.x+R.width-1,R.y+R.height-1];if(T[1]>=v&&P[1]>=v||!a.some(q=>q.sourceIndex===T[0]||q.sourceIndex===P[0]))return;const[F,H]=u.current.cell,S=g(u.current.cell),X=S.span??[F,F],$=H>=v-w,D=w>0&&!$?Co(v,w,m)-1:0,A=P[1];let B;if(ro(a,o,r,i,f,(q,fe,pe,ae,J)=>{if(q.sticky&&F>q.sourceIndex)return;const V=q.sourceIndex<X[0],ce=q.sourceIndex>X[1],he=q.sourceIndex===P[0];if(!(!he&&(V||ce)))return si(J,pe,n,v,m,w,h,void 0,(ve,re,Ce)=>{if(re!==H&&re!==A)return;let ie=fe,j=q.width;if(S.span!==void 0){const ue=Cs(S.span,fe,ve,q.width,Ce,q,l),Ye=q.sticky?ue[0]:ue[1];Ye!==void 0&&(ie=Ye.x,j=Ye.width)}return re===A&&he&&C&&(B=()=>{var We;ae>ie&&!q.sticky&&(e.beginPath(),e.rect(ae,0,t-ae,n),e.clip());const ue=y.size,Ye=ue/2,_e=ie+j+y.offsetX-Ye+.5,xe=ve+Ce+y.offsetY-Ye+.5;e.beginPath(),y.shape==="circle"?e.arc(_e+Ye,xe+Ye,Ye,0,Math.PI*2):e.rect(_e,xe,ue,ue),e.fillStyle=((We=q.themeOverride)==null?void 0:We.accentColor)??d.accentColor,e.fill(),y.outline>0&&(e.lineWidth=y.outline,e.strokeStyle=d.bgCell,y.shape==="circle"?(e.beginPath(),e.arc(_e+Ye,xe+Ye,Ye+y.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(_e-y.outline/2,xe-y.outline/2,ue+y.outline,ue+y.outline))}),B!==void 0}),B!==void 0}),B===void 0)return;const te=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-D),e.clip(),B==null||B(),e.restore()};return te(),te}function td(e,t,n,o,r,i,a,l,d){d===void 0||d.size===0||(e.beginPath(),ro(t,l,i,a,r,(f,u,m,g)=>{const w=Math.max(0,g-u),h=u+w+1,b=f.width-w-1;d.has([f.sourceIndex,-1])&&e.rect(h,o,b,r-o)}),e.clip())}function nd(e,t,n,o,r,i,a,l,d,f){let u=0;return ro(e,i,o,r,n,(m,g,w,h,b)=>(si(b,w,t,a,l,d,f,void 0,(v,C,y,R)=>{R||(u=Math.max(C,u))}),!0)),u}function Nl(e,t){var Ke;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:l,translateX:d,translateY:f,mappedColumns:u,enableGroups:m,freezeColumns:g,dragAndDropState:w,theme:h,drawFocus:b,headerHeight:v,groupHeaderHeight:C,groupLevels:y,groupHeaderHeights:R,disabledRows:T,rowHeight:P,verticalBorder:N,overrideCursor:F,isResizing:H,selection:S,fillHandle:X,freezeTrailingRows:$,rows:D,getCellContent:A,getGroupDetails:B,getRowThemeOverride:te,isFocused:q,drawHeaderCallback:fe,prelightCells:pe,drawCellCallback:ae,highlightRegions:J,resizeCol:V,imageLoader:ce,lastBlitData:he,hoverValues:ve,hyperWrapping:re,hoverInfo:Ce,spriteManager:ie,maxScaleFactor:j,hasAppendRow:Me,touchMode:ue,enqueue:Ye,renderStateProvider:_e,getCellRenderer:xe,renderStrategy:We,bufferACtx:lt,bufferBCtx:dt,damage:Te,minimumCellWidth:Mt,resizeIndicator:de}=e;if(r===0||i===0)return;const we=We==="double-buffer",ge=Math.min(j,Math.ceil(window.devicePixelRatio??1)),De=We!=="direct"&&ed(e,t),$e=n.canvas;($e.width!==r*ge||$e.height!==i*ge)&&($e.width=r*ge,$e.height=i*ge,$e.style.width=r+"px",$e.style.height=i+"px");const st=o.canvas,nt=R.reduce((Je,Ut)=>Je+Ut,0),Ae=v+nt,Ue=Ae+1;(st.width!==r*ge||st.height!==Ue*ge)&&(st.width=r*ge,st.height=Ue*ge,st.style.width=r+"px",st.style.height=Ue+"px");const ot=lt.canvas,Dt=dt.canvas;we&&(ot.width!==r*ge||ot.height!==i*ge)&&(ot.width=r*ge,ot.height=i*ge,he.current!==void 0&&(he.current.aBufferScroll=void 0)),we&&(Dt.width!==r*ge||Dt.height!==i*ge)&&(Dt.width=r*ge,Dt.height=i*ge,he.current!==void 0&&(he.current.bBufferScroll=void 0));const U=he.current;if(De===!0&&a===(U==null?void 0:U.cellXOffset)&&l===(U==null?void 0:U.cellYOffset)&&d===(U==null?void 0:U.translateX)&&f===(U==null?void 0:U.translateY))return;let mt=null;we&&(mt=n);const at=o;let le;we?Te!==void 0?le=(U==null?void 0:U.lastBuffer)==="b"?dt:lt:le=(U==null?void 0:U.lastBuffer)==="b"?lt:dt:le=n;const gt=le.canvas,ft=we?gt===ot?Dt:ot:$e,Le=typeof P=="number"?()=>P:P;at.save(),le.save(),at.beginPath(),le.beginPath(),at.textBaseline="middle",le.textBaseline="middle",ge!==1&&(at.scale(ge,ge),le.scale(ge,ge));const qe=$i(u,a,r,w,d);let xt=[];const zt=b&&((Ke=S.current)==null?void 0:Ke.cell[1])===l&&f===0;let qt=!1;if(J!==void 0){for(const Je of J)if(Je.style!=="no-outline"&&Je.range.y===l&&f===0){qt=!0;break}}const jt=()=>{at.fillStyle=h.bgHeader,at.fillRect(0,0,r,Ae+1),_c(at,qe,u,m,Ce,r,d,v,C,w,H,S,h,ie,ve,N,B,Te,fe,ue,y,R),Bl(at,qe,l,d,f,r,i,void 0,void 0,nt,Ae,Le,te,N,$,D,h,!0),at.beginPath(),at.moveTo(0,Ue-.5),at.lineTo(r,Ue-.5),at.strokeStyle=dn(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),at.stroke(),qt&&Wl(at,r,i,a,l,d,f,u,g,v,nt,P,$,D,J,h),zt&&Di(at,r,i,l,d,f,qe,u,h,Ae,S,Le,A,$,Me,X,D)};if(Te!==void 0){const Je=qe[qe.length-1].sourceIndex+1,Ut=Te.hasItemInRegion([{x:a,y:-2,width:Je,height:2},{x:a,y:l,width:Je,height:300},{x:0,y:l,width:g,height:300},{x:0,y:-2,width:g,height:2},{x:a,y:D-$,width:Je,height:$,when:$>0}]),on=rn=>{Pl(rn,qe,u,i,Ae,d,f,l,D,Le,A,B,te,T,q,b,$,Me,xt,Te,S,pe,J,ce,ie,ve,Ce,ae,re,h,Ye,_e,xe,F,Mt);const Kt=S.current;X!==!1&&X!==void 0&&b&&Kt!==void 0&&Te.has(ss(Kt.range))&&Di(rn,r,i,l,d,f,qe,u,h,Ae,S,Le,A,$,Me,X,D)};Ut&&(on(le),mt!==null&&(mt.save(),mt.scale(ge,ge),mt.textBaseline="middle",on(mt),mt.restore()),Te.hasHeader()&&(td(at,qe,r,nt,Ae,d,f,l,Te),jt())),le.restore(),at.restore();return}if((De!==!0||a!==(U==null?void 0:U.cellXOffset)||l!==(U==null?void 0:U.cellYOffset)||d!==(U==null?void 0:U.translateX)||f!==(U==null?void 0:U.translateY)||zt!==(U==null?void 0:U.mustDrawFocusOnHeader)||qt!==(U==null?void 0:U.mustDrawHighlightRingsOnHeader))&&jt(),De===!0){cn(ft!==void 0&&U!==void 0);const{regions:Je}=Jc(le,ft,ft===ot?U.aBufferScroll:U.bBufferScroll,ft===ot?U.bBufferScroll:U.aBufferScroll,U,a,l,d,f,$,r,i,D,Ae,ge,u,qe,P,we);xt=Je}else De!==!1&&(cn(U!==void 0),xt=Qc(U,a,l,d,f,r,i,Ae,qe,De));jc(le,qe,r,i,$,D,N,Le,h);const vt=Wl(le,r,i,a,l,d,f,u,g,v,nt,P,$,D,J,h),en=b?Di(le,r,i,l,d,f,qe,u,h,Ae,S,Le,A,$,Me,X,D):void 0;if(le.fillStyle=h.bgCell,xt.length>0){le.beginPath();for(const Je of xt)le.rect(Je.x,Je.y,Je.width,Je.height);le.clip(),le.fill(),le.beginPath()}else le.fillRect(0,0,r,i);const Zt=Pl(le,qe,u,i,Ae,d,f,l,D,Le,A,B,te,T,q,b,$,Me,xt,Te,S,pe,J,ce,ie,ve,Ce,ae,re,h,Ye,_e,xe,F,Mt);qc(le,qe,u,r,i,Ae,d,f,l,D,Le,te,S.rows,T,$,Me,xt,Te,h),Zc(le,qe,l,d,f,r,i,xt,Ae,Le,te,N,$,D,h),Bl(le,qe,l,d,f,r,i,xt,Zt,nt,Ae,Le,te,N,$,D,h),vt==null||vt(),en==null||en(),H&&de!=="none"&&ro(qe,0,d,0,Ae,(Je,Ut)=>Je.sourceIndex===V?($l(at,Ut+Je.width,0,Ae+1,dn(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),de==="full"&&$l(le,Ut+Je.width,Ae,i,dn(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),mt!==null&&(mt.fillStyle=h.bgCell,mt.fillRect(0,0,r,i),mt.drawImage(le.canvas,0,0));const An=nd(qe,i,Ae,d,f,l,D,Le,$,Me);ce==null||ce.setWindow({x:a,y:l,width:qe.length,height:An-l},g,Array.from({length:$},(Je,Ut)=>D-1-Ut));const zn=U!==void 0&&(a!==U.cellXOffset||d!==U.translateX),yt=U!==void 0&&(l!==U.cellYOffset||f!==U.translateY);he.current={cellXOffset:a,cellYOffset:l,translateX:d,translateY:f,mustDrawFocusOnHeader:zt,mustDrawHighlightRingsOnHeader:qt,lastBuffer:we?gt===ot?"a":"b":void 0,aBufferScroll:gt===ot?[zn,yt]:U==null?void 0:U.aBufferScroll,bBufferScroll:gt===Dt?[zn,yt]:U==null?void 0:U.bBufferScroll},le.restore(),at.restore()}const od=80;function rd(e){const t=e-1;return t*t*t+1}class id{constructor(t){Ne(this,"callback");Ne(this,"currentHoveredItem");Ne(this,"leavingItems",[]);Ne(this,"lastAnimationTime");Ne(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>vr(o.item,t.item))||this.leavingItems.push(t)});Ne(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>vr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Ne(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Ne(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Ne(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:rd(t.hoverAmount)})));Ne(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/od;for(const i of this.leavingItems)i.hoverAmount=vn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=vn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Ne(this,"setHovered",t=>{var n;if(!vr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class ld{constructor(t){Ne(this,"fn");Ne(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Qi(e){return new ld(e)}const sd=Qi(()=>window.navigator.userAgent.includes("Firefox")),oi=Qi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),ri=Qi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function ad(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const l=t.current.map(Zi);t.current=[],o.current(new Uo(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return s.useCallback(i=>{t.current.length===0&&r();const a=Mn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const to="header",Sn="group-header",ii="out-of-bounds";var _o;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(_o||(_o={}));function Es(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const cd=(e,t)=>{if(e.kind===ne.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},dd=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:l,headerHeight:d,fillHandle:f=!1,groupHeaderHeight:u,groupLevels:m,groupHeaderHeights:g,rowHeight:w,rows:h,getCellContent:b,getRowThemeOverride:v,onHeaderMenuClick:C,onHeaderIndicatorClick:y,enableGroups:R,isFilling:T,onCanvasFocused:P,onCanvasBlur:N,isFocused:F,selection:H,freezeColumns:S,onContextMenu:X,freezeTrailingRows:$,fixedShadowX:D=!0,fixedShadowY:A=!0,drawFocusRing:B,onMouseDown:te,onMouseUp:q,onMouseMoveRaw:fe,onMouseMove:pe,onItemHovered:ae,dragAndDropState:J,firstColAccessible:V,onKeyDown:ce,onKeyUp:he,highlightRegions:ve,canvasRef:re,onDragStart:Ce,onDragEnd:ie,eventTargetRef:j,isResizing:Me,resizeColumn:ue,isDragging:Ye,isDraggable:_e=!1,allowResize:xe,disabledRows:We,hasAppendRow:lt,getGroupDetails:dt,theme:Te,prelightCells:Mt,headerIcons:de,verticalBorder:we,drawCell:ge,drawHeader:De,onCellFocused:$e,onDragOverCell:st,onDrop:nt,onDragLeave:Ae,imageWindowLoader:Ue,smoothScrollX:ot=!1,smoothScrollY:Dt=!1,experimental:U,getCellRenderer:mt,resizeIndicator:at="full"}=e,le=e.translateX??0,gt=e.translateY??0,ft=Math.max(S,Math.min(i.length-1,a)),Le=s.useRef(null),qe=s.useRef((U==null?void 0:U.eventTarget)??window),xt=qe.current,zt=Ue,qt=s.useRef(),[jt,vt]=s.useState(!1),en=s.useRef([]),Zt=s.useRef(),[An,zn]=s.useState(),[yt,Ke]=s.useState(),Je=s.useRef(null),[Ut,on]=s.useState(),[rn,Kt]=s.useState(!1),Pn=s.useRef(rn);Pn.current=rn;const Re=s.useMemo(()=>new Lc(de,()=>{ko.current=void 0,lo.current()}),[de]),et=R?u+d:d,tt=s.useRef(-1),Wt=((U==null?void 0:U.enableFirefoxRescaling)??!1)&&sd.value,Xt=((U==null?void 0:U.enableSafariRescaling)??!1)&&oi.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!Wt&&!Xt||(tt.current!==-1&&vt(!0),window.clearTimeout(tt.current),tt.current=window.setTimeout(()=>{vt(!1),tt.current=-1},200))},[l,ft,le,gt,Wt,Xt]);const Pe=Na(i,S),Rt=s.useMemo(()=>D?qo(Pe,J):0,[Pe,J,D]),Pt=s.useCallback((E,_,se)=>{const x=E.getBoundingClientRect();if(_>=Pe.length||se>=h)return;const K=x.width/n,oe=Ni(_,se,n,o,u,et,ft,l,le,gt,h,S,$,Pe,w,m,g);return K!==1&&(oe.x*=K,oe.y*=K,oe.width*=K,oe.height*=K),oe.x+=x.x,oe.y+=x.y,oe},[n,o,u,et,ft,l,le,gt,h,S,$,Pe,w,m,g]),Lt=s.useCallback((E,_,se,x)=>{const K=E.getBoundingClientRect(),oe=K.width/n,Fe=(_-K.left)/oe,Ve=(se-K.top)/oe,be=5,Bt=$i(Pe,ft,n,void 0,le);let ke=0,I=0;const je=typeof PointerEvent<"u"&&x instanceof PointerEvent&&x.pointerType==="mouse"||typeof MouseEvent<"u"&&x instanceof MouseEvent,ze=typeof PointerEvent<"u"&&x instanceof PointerEvent&&x.pointerType==="touch"||typeof TouchEvent<"u"&&x instanceof TouchEvent;je&&(ke=x.button,I=x.buttons);const wt=Ga(Fe,Bt,le),Ft=_a(Ve,o,R,d,u,h,w,l,gt,$,m,g),kt=(x==null?void 0:x.shiftKey)===!0,At=(x==null?void 0:x.ctrlKey)===!0,Jt=(x==null?void 0:x.metaKey)===!0,mn=[Fe<0?-1:n<Fe?1:0,Ve<et?-1:o<Ve?1:0];let In;if(wt===-1||Ve<0||Fe<0||Ft===void 0||Fe>n||Ve>o){const ht=Fe>n?1:Fe<0?-1:0,Hn=Ve>o?1:Ve<0?-1:0;let Gt=ht*2,St=Hn*2;ht===0&&(Gt=wt===-1?_o.EndPadding:_o.Center),Hn===0&&(St=Ft===void 0?_o.EndPadding:_o.Center);let bt=!1;if(wt===-1&&Ft===-1){const Et=Pt(E,Pe.length-1,-1);cn(Et!==void 0),bt=_<Et.x+Et.width+be}const Ct=Fe>n&&Fe<n+Bi()||Ve>o&&Ve<o+Bi();In={kind:ii,location:[wt!==-1?wt:Fe<0?0:Pe.length-1,Ft??h-1],region:[Gt,St],shiftKey:kt,ctrlKey:At,metaKey:Jt,isEdge:bt,isTouch:ze,button:ke,buttons:I,scrollEdge:mn,isMaybeScrollbar:Ct}}else if(Ft<=-1){let ht=Pt(E,wt,Ft);cn(ht!==void 0);let Hn=ht!==void 0&&ht.x+ht.width-_<=be;const Gt=R&&Ft<=-2,St=Gt?-(Ft+2):void 0,bt=wt-1;_-ht.x<=be&&bt>=0?(Hn=!0,ht=Pt(E,bt,Ft),cn(ht!==void 0),In={kind:Gt?Sn:to,location:[bt,Ft],bounds:ht,group:vo(Pe[bt].group,St),isEdge:Hn,shiftKey:kt,ctrlKey:At,metaKey:Jt,isTouch:ze,localEventX:_-ht.x,localEventY:se-ht.y,button:ke,buttons:I,scrollEdge:mn}):In={kind:Gt?Sn:to,group:vo(Pe[wt].group,St),location:[wt,Ft],bounds:ht,isEdge:Hn,shiftKey:kt,ctrlKey:At,metaKey:Jt,isTouch:ze,localEventX:_-ht.x,localEventY:se-ht.y,button:ke,buttons:I,scrollEdge:mn}}else{const ht=Pt(E,wt,Ft);cn(ht!==void 0);const Hn=ht!==void 0&&ht.x+ht.width-_<be;let Gt=!1;if(f!==!1&&f!==void 0&&H.current!==void 0){const bt=typeof f=="object"?{...ei,...f}:ei,Ct=bt.size,Et=Ct/2,Po=ss(H.current.range),fo=Pt(E,Po[0],Po[1]);if(fo!==void 0){const Ar=fo.x+fo.width+bt.offsetX-Et+.5,_t=fo.y+fo.height+bt.offsetY-Et+.5;Gt=Math.abs(Ar-_)<Ct&&Math.abs(_t-se)<Ct}}In={kind:"cell",location:[wt,Ft],bounds:ht,isEdge:Hn,shiftKey:kt,ctrlKey:At,isFillHandle:Gt,metaKey:Jt,isTouch:ze,localEventX:_-ht.x,localEventY:se-ht.y,button:ke,buttons:I,scrollEdge:mn}}return In},[n,Pe,ft,le,o,R,d,u,h,w,l,gt,$,Pt,f,H,et]),[Ln]=An??[],Sr=s.useRef(()=>{}),Yn=s.useRef(An);Yn.current=An;const[Bn,Wn]=s.useMemo(()=>{const E=document.createElement("canvas"),_=document.createElement("canvas");return E.style.display="none",E.style.opacity="0",E.style.position="fixed",_.style.display="none",_.style.opacity="0",_.style.position="fixed",[E.getContext("2d",{alpha:!1}),_.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Bn===null||Wn===null))return document.documentElement.append(Bn.canvas),document.documentElement.append(Wn.canvas),()=>{Bn.canvas.remove(),Wn.canvas.remove()}},[Bn,Wn]);const Rn=s.useMemo(()=>new ec,[]),Mr=Wt&&jt?1:Xt&&jt?2:5,Rr=(U==null?void 0:U.disableMinimumCellWidth)===!0?1:10,ko=s.useRef(),So=s.useRef(null),Mo=s.useRef(null),io=s.useCallback(()=>{var Fe;const E=Le.current,_=Je.current;if(E===null||_===null||(So.current===null&&(So.current=E.getContext("2d",{alpha:!1}),E.width=0,E.height=0),Mo.current===null&&(Mo.current=_.getContext("2d",{alpha:!1}),_.width=0,_.height=0),So.current===null||Mo.current===null||Bn===null||Wn===null))return;let se=!1;const x=Ve=>{se=!0,on(Ve)},K=ko.current,oe={headerCanvasCtx:Mo.current,canvasCtx:So.current,bufferACtx:Bn,bufferBCtx:Wn,width:n,height:o,cellXOffset:ft,cellYOffset:l,translateX:Math.round(le),translateY:Math.round(gt),mappedColumns:Pe,enableGroups:R,freezeColumns:S,dragAndDropState:J,theme:Te,headerHeight:d,groupHeaderHeight:u,groupLevels:m,groupHeaderHeights:g,disabledRows:We??it.empty(),rowHeight:w,verticalBorder:we,isResizing:Me,resizeCol:ue,isFocused:F,selection:H,fillHandle:f,drawCellCallback:ge,hasAppendRow:lt,overrideCursor:x,maxScaleFactor:Mr,freezeTrailingRows:$,rows:h,drawFocus:B,getCellContent:b,getGroupDetails:dt??(Ve=>({name:Ve})),getRowThemeOverride:v,drawHeaderCallback:De,prelightCells:Mt,highlightRegions:ve,imageLoader:zt,lastBlitData:Zt,damage:qt.current,hoverValues:en.current,hoverInfo:Yn.current,spriteManager:Re,scrolling:jt,hyperWrapping:(U==null?void 0:U.hyperWrapping)??!1,touchMode:rn,enqueue:Sr.current,renderStateProvider:Rn,renderStrategy:(U==null?void 0:U.renderStrategy)??(oi.value?"double-buffer":"single-buffer"),getCellRenderer:mt,minimumCellWidth:Rr,resizeIndicator:at};oe.damage===void 0?(ko.current=oe,Nl(oe,K)):Nl(oe,void 0),!se&&(oe.damage===void 0||oe.damage.has((Fe=Yn==null?void 0:Yn.current)==null?void 0:Fe[0]))&&on(void 0)},[Bn,Wn,n,o,ft,l,le,gt,Pe,R,S,J,Te,d,u,m,g,We,w,we,Me,lt,ue,F,H,f,$,h,B,Mr,b,dt,v,ge,De,Mt,ve,zt,Re,jt,U==null?void 0:U.hyperWrapping,U==null?void 0:U.renderStrategy,rn,Rn,mt,Rr,at]),lo=s.useRef(io);s.useLayoutEffect(()=>{io(),lo.current=io},[io]),s.useLayoutEffect(()=>{(async()=>{var _;((_=document==null?void 0:document.fonts)==null?void 0:_.ready)!==void 0&&(await document.fonts.ready,ko.current=void 0,lo.current())})()},[]);const Gn=s.useCallback(E=>{qt.current=E,lo.current(),qt.current=void 0},[]),ai=ad(Gn);Sr.current=ai;const Er=s.useCallback(E=>{Gn(new Uo(E.map(_=>_.cell)))},[Gn]);zt.setCallback(Gn);const[Ir,ci]=s.useState(!1),[$n,_n]=Ln??[],jo=$n!==void 0&&_n===-1&&$n>=0&&$n<Pe.length&&Pe[$n].headerRowMarkerDisabled!==!0,di=$n!==void 0&&_n===-2;let Zo=!1,Jo=!1,Ro=Ut;if(Ro===void 0&&$n!==void 0&&_n!==void 0&&_n>-1&&_n<h){const E=b([$n,_n],!0);Zo=E.kind===Ot.NewRow||E.kind===Ot.Marker&&E.markerKind!=="number",Jo=E.kind===ne.Boolean&&_i(E),Ro=E.cursor}const ao=Ye?"grabbing":(yt??!1)||Me?"col-resize":Ir||T?"crosshair":Ro!==void 0?Ro:jo||Zo||Jo||di?"pointer":"default",Un=s.useMemo(()=>({contain:"strict",display:"block",cursor:ao}),[ao]),Qo=s.useRef("default"),Ee=j==null?void 0:j.current;Ee!=null&&Qo.current!==Un.cursor&&(Ee.style.cursor=Qo.current=Un.cursor);const Eo=s.useCallback((E,_,se,x)=>{if(dt===void 0)return;const K=dt(E);if(K.actions!==void 0){const oe=Ji(_,K.actions);for(const[Fe,Ve]of oe.entries())if(no(Ve,se+_.x,x+Ve.y))return K.actions[Fe]}},[dt]),Cn=s.useCallback((E,_,se,x)=>{const K=Pe[_];if(!Ye&&!Me&&!(yt??!1)){const oe=Pt(E,_,-1);cn(oe!==void 0);const Fe=Ss(void 0,K,oe.x,oe.y,oe.width,oe.height,Te,Ki(K.title)==="rtl");if(K.hasMenu===!0&&Fe.menuBounds!==void 0&&no(Fe.menuBounds,se,x))return{area:"menu",bounds:Fe.menuBounds};if(K.indicatorIcon!==void 0&&Fe.indicatorIconBounds!==void 0&&no(Fe.indicatorIconBounds,se,x))return{area:"indicator",bounds:Fe.indicatorIconBounds}}},[Pe,Pt,yt,Ye,Me,Te]),ln=s.useRef(0),Yt=s.useRef(),er=s.useRef(!1),tr=s.useCallback(E=>{const _=Le.current,se=j==null?void 0:j.current;if(_===null||E.target!==_&&E.target!==se)return;er.current=!0;const x=E.clientX,K=E.clientY;if(E.target===se&&se!==null){const Fe=se.getBoundingClientRect();if(x>Fe.right||K>Fe.bottom)return}const oe=Lt(_,x,K,E);Yt.current=oe.location,oe.isTouch&&(ln.current=Date.now()),Pn.current!==oe.isTouch&&Kt(oe.isTouch),!(oe.kind===to&&Cn(_,oe.location[0],x,K)!==void 0)&&(oe.kind===Sn&&Eo(oe.group,oe.bounds,oe.localEventX,oe.localEventY)!==void 0||(te==null||te(oe),!oe.isTouch&&_e!==!0&&_e!==oe.kind&&oe.button<3&&oe.button!==1&&E.preventDefault()))},[j,_e,Lt,Eo,Cn,te]);Qt("pointerdown",tr,xt,!1);const Io=s.useRef(0),nr=s.useCallback(E=>{var I,je;const _=Io.current;Io.current=Date.now();const se=Le.current;if(er.current=!1,q===void 0||se===null)return;const x=j==null?void 0:j.current,K=E.target!==se&&E.target!==x,oe=E.clientX,Fe=E.clientY,Ve=E.pointerType==="mouse"?E.button<3:!0;let be=Lt(se,oe,Fe,E);be.isTouch&&ln.current!==0&&Date.now()-ln.current>500&&(be={...be,isLongTouch:!0}),_!==0&&Date.now()-_<(be.isTouch?1e3:500)&&(be={...be,isDoubleClick:!0}),Pn.current!==be.isTouch&&Kt(be.isTouch),!K&&E.cancelable&&Ve&&E.preventDefault();const[Bt]=be.location,ke=Cn(se,Bt,oe,Fe);if(be.kind===to&&ke!==void 0){(be.button!==0||((I=Yt.current)==null?void 0:I[0])!==Bt||((je=Yt.current)==null?void 0:je[1])!==-1)&&q(be,!0);return}else if(be.kind===Sn){const ze=Eo(be.group,be.bounds,be.localEventX,be.localEventY);if(ze!==void 0){be.button===0&&ze.onClick(be);return}}q(be,K)},[q,j,Lt,Cn,Eo]);Qt("pointerup",nr,xt,!1);const Hr=s.useCallback(E=>{var Bt,ke;const _=Le.current;if(_===null)return;const se=j==null?void 0:j.current,x=E.target!==_&&E.target!==se;let K,oe,Fe=!0;E instanceof MouseEvent?(K=E.clientX,oe=E.clientY,Fe=E.button<3):(K=E.changedTouches[0].clientX,oe=E.changedTouches[0].clientY);const Ve=Lt(_,K,oe,E);Pn.current!==Ve.isTouch&&Kt(Ve.isTouch),!x&&E.cancelable&&Fe&&E.preventDefault();const[be]=Ve.location;if(Ve.kind===to){const I=Cn(_,be,K,oe);I!==void 0&&Ve.button===0&&((Bt=Yt.current)==null?void 0:Bt[0])===be&&((ke=Yt.current)==null?void 0:ke[1])===-1&&(I.area==="menu"?C==null||C(be,I.bounds):I.area==="indicator"&&(y==null||y(be,I.bounds)))}},[j,Lt,Cn,C,y]);Qt("click",Hr,xt,!1);const Ho=s.useCallback(E=>{const _=Le.current,se=j==null?void 0:j.current;if(_===null||E.target!==_&&E.target!==se||X===void 0)return;const x=Lt(_,E.clientX,E.clientY,E);X(x,()=>{E.cancelable&&E.preventDefault()})},[j,Lt,X]);Qt("contextmenu",Ho,(j==null?void 0:j.current)??null,!1);const Nn=s.useCallback(E=>{qt.current=new Uo(E.map(_=>_.item)),en.current=E,lo.current(),qt.current=void 0},[]),Tr=s.useMemo(()=>new id(Nn),[Nn]),or=s.useRef(Tr);or.current=Tr,s.useLayoutEffect(()=>{const E=or.current;if(Ln===void 0||Ln[1]<0){E.setHovered(Ln);return}const _=b(Ln,!0),se=mt(_),x=se===void 0&&_.kind===ne.Custom||(se==null?void 0:se.needsHover)!==void 0&&(typeof se.needsHover=="boolean"?se.needsHover:se.needsHover(_));E.setHovered(x?Ln:void 0)},[b,mt,Ln]);const co=s.useRef(),ui=s.useCallback(E=>{var Ve;const _=Le.current;if(_===null)return;const se=j==null?void 0:j.current,x=E.target!==_&&E.target!==se,K=Lt(_,E.clientX,E.clientY,E);if(K.kind!=="out-of-bounds"&&x&&!er.current&&!K.isTouch)return;const oe=(be,Bt)=>{zn(ke=>ke===be||(ke==null?void 0:ke[0][0])===(be==null?void 0:be[0][0])&&(ke==null?void 0:ke[0][1])===(be==null?void 0:be[0][1])&&((ke==null?void 0:ke[1][0])===(be==null?void 0:be[1][0])&&(ke==null?void 0:ke[1][1])===(be==null?void 0:be[1][1])||!Bt)?ke:be)};if(!Es(K,co.current))on(void 0),ae==null||ae(K),oe(K.kind===ii?void 0:[K.location,[K.localEventX,K.localEventY]],!0),co.current=K;else if(K.kind==="cell"||K.kind===to||K.kind===Sn){let be=!1,Bt=!0;if(K.kind==="cell"){const I=b(K.location);Bt=((Ve=mt(I))==null?void 0:Ve.needsHoverPosition)??I.kind===ne.Custom,be=Bt}else be=!0;const ke=[K.location,[K.localEventX,K.localEventY]];oe(ke,Bt),Yn.current=ke,be&&Gn(new Uo([K.location]))}const Fe=K.location[0]>=(V?0:1);Ke(K.kind===to&&K.isEdge&&Fe&&xe===!0),ci(K.kind==="cell"&&K.isFillHandle),fe==null||fe(E),pe(K)},[j,Lt,V,xe,fe,pe,ae,b,mt,Gn]);Qt("pointermove",ui,xt,!0);const Dr=s.useCallback(E=>{const _=Le.current;if(_===null)return;let se,x;H.current!==void 0&&(se=Pt(_,H.current.cell[0],H.current.cell[1]),x=H.current.cell),ce==null||ce({bounds:se,stopPropagation:()=>E.stopPropagation(),preventDefault:()=>E.preventDefault(),cancel:()=>{},ctrlKey:E.ctrlKey,metaKey:E.metaKey,shiftKey:E.shiftKey,altKey:E.altKey,key:E.key,keyCode:E.keyCode,rawEvent:E,location:x})},[ce,H,Pt]),To=s.useCallback(E=>{const _=Le.current;if(_===null)return;let se,x;H.current!==void 0&&(se=Pt(_,H.current.cell[0],H.current.cell[1]),x=H.current.cell),he==null||he({bounds:se,stopPropagation:()=>E.stopPropagation(),preventDefault:()=>E.preventDefault(),cancel:()=>{},ctrlKey:E.ctrlKey,metaKey:E.metaKey,shiftKey:E.shiftKey,altKey:E.altKey,key:E.key,keyCode:E.keyCode,rawEvent:E,location:x})},[he,H,Pt]),Kn=s.useCallback(E=>{if(Le.current=E,re!==void 0&&(re.current=E),U!=null&&U.eventTarget)qe.current=U.eventTarget;else if(E===null)qe.current=window;else{const _=E.getRootNode();_===document&&(qe.current=window),qe.current=_}},[re,U==null?void 0:U.eventTarget]),Do=s.useCallback(E=>{const _=Le.current;if(_===null||_e===!1||Me){E.preventDefault();return}let se,x;const K=Lt(_,E.clientX,E.clientY);if(_e!==!0&&K.kind!==_e){E.preventDefault();return}const oe=(I,je)=>{se=I,x=je};let Fe,Ve,be;const Bt=(I,je,ze)=>{Fe=I,Ve=je,be=ze};let ke=!1;if(Ce==null||Ce({...K,setData:oe,setDragImage:Bt,preventDefault:()=>ke=!0,defaultPrevented:()=>ke}),!ke&&se!==void 0&&x!==void 0&&E.dataTransfer!==null)if(E.dataTransfer.setData(se,x),E.dataTransfer.effectAllowed="copyLink",Fe!==void 0&&Ve!==void 0&&be!==void 0)E.dataTransfer.setDragImage(Fe,Ve,be);else{const[I,je]=K.location;if(je!==void 0){const ze=document.createElement("canvas"),wt=Pt(_,I,je);cn(wt!==void 0);const Ft=Math.ceil(window.devicePixelRatio??1);ze.width=wt.width*Ft,ze.height=wt.height*Ft;const kt=ze.getContext("2d");kt!==null&&(kt.scale(Ft,Ft),kt.textBaseline="middle",je===-1?(kt.font=Te.headerFontFull,kt.fillStyle=Te.bgHeader,kt.fillRect(0,0,ze.width,ze.height),Ms(kt,0,0,wt.width,wt.height,Pe[I],!1,Te,!1,void 0,void 0,!1,0,Re,De,!1)):(kt.font=Te.baseFontFull,kt.fillStyle=Te.bgCell,kt.fillRect(0,0,ze.width,ze.height),ks(kt,b([I,je]),0,je,!1,!1,0,0,wt.width,wt.height,!1,Te,Te.bgCell,zt,Re,1,void 0,!1,0,void 0,void 0,void 0,Rn,mt,()=>{},0))),ze.style.left="-100%",ze.style.position="absolute",ze.style.width=`${wt.width}px`,ze.style.height=`${wt.height}px`,document.body.append(ze),E.dataTransfer.setDragImage(ze,wt.width/2,wt.height/2),window.setTimeout(()=>{ze.remove()},0)}}else E.preventDefault()},[_e,Me,Lt,Ce,Pt,Te,Pe,Re,De,b,zt,Rn,mt]);Qt("dragstart",Do,(j==null?void 0:j.current)??null,!1,!1);const rr=s.useRef(),Fr=s.useCallback(E=>{const _=Le.current;if(nt!==void 0&&E.preventDefault(),_===null||st===void 0)return;const se=Lt(_,E.clientX,E.clientY),[x,K]=se.location,oe=x-(V?0:1),[Fe,Ve]=rr.current??[];(Fe!==oe||Ve!==K)&&(rr.current=[oe,K],st([oe,K],E.dataTransfer))},[V,Lt,st,nt]);Qt("dragover",Fr,(j==null?void 0:j.current)??null,!1,!1);const Ie=s.useCallback(()=>{rr.current=void 0,ie==null||ie()},[ie]);Qt("dragend",Ie,(j==null?void 0:j.current)??null,!1,!1);const ir=s.useCallback(E=>{const _=Le.current;if(_===null||nt===void 0)return;E.preventDefault();const se=Lt(_,E.clientX,E.clientY),[x,K]=se.location,oe=x-(V?0:1);nt([oe,K],E.dataTransfer)},[V,Lt,nt]);Qt("drop",ir,(j==null?void 0:j.current)??null,!1,!1);const fi=s.useCallback(()=>{Ae==null||Ae()},[Ae]);Qt("dragleave",fi,(j==null?void 0:j.current)??null,!1,!1);const hn=s.useRef(H);hn.current=H;const Fo=s.useRef(null),gn=s.useCallback(E=>{var _;Le.current===null||!Le.current.contains(document.activeElement)||(E===null&&hn.current.current!==void 0?(_=re==null?void 0:re.current)==null||_.focus({preventScroll:!0}):E!==null&&E.focus({preventScroll:!0}),Fo.current=E)},[re]);s.useImperativeHandle(t,()=>({focus:()=>{var _;const E=Fo.current;E===null||!document.contains(E)?(_=re==null?void 0:re.current)==null||_.focus({preventScroll:!0}):E.focus({preventScroll:!0})},getBounds:(E,_)=>{if(!(re===void 0||re.current===null))return Pt(re.current,E??0,_??-1)},damage:Er,getMouseArgsForPosition:(E,_,se)=>{if(!(re===void 0||re.current===null))return Lt(re.current,E,_,se)}}),[re,Er,Pt,Lt]);const Ao=s.useRef(),lr=Ea(()=>{var Ve,be,Bt;if(n<50||(U==null?void 0:U.disableAccessibilityTree)===!0)return null;let E=$i(Pe,ft,n,J,le);const _=V?0:-1;!V&&((Ve=E[0])==null?void 0:Ve.sourceIndex)===0&&(E=E.slice(1));const[se,x]=((be=H.current)==null?void 0:be.cell)??[],K=(Bt=H.current)==null?void 0:Bt.range,oe=E.map(ke=>ke.sourceIndex),Fe=po(l,Math.min(h,l+r));return se!==void 0&&x!==void 0&&!(oe.includes(se)&&Fe.includes(x))&&gn(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":h+1,"aria-multiselectable":"true","aria-colcount":Pe.length+_},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},E.map(ke=>s.createElement("th",{role:"columnheader","aria-selected":H.columns.hasIndex(ke.sourceIndex),"aria-colindex":ke.sourceIndex+1+_,tabIndex:-1,onFocus:I=>{if(I.target!==Fo.current)return $e==null?void 0:$e([ke.sourceIndex,-1])},key:ke.sourceIndex},ke.title)))),s.createElement("tbody",{role:"rowgroup"},Fe.map(ke=>s.createElement("tr",{role:"row","aria-selected":H.rows.hasIndex(ke),key:ke,"aria-rowindex":ke+2},E.map(I=>{const je=I.sourceIndex,ze=Mn(je,ke),wt=se===je&&x===ke,Ft=K!==void 0&&je>=K.x&&je<K.x+K.width&&ke>=K.y&&ke<K.y+K.height,kt=`glide-cell-${je}-${ke}`,At=[je,ke],Jt=b(At,!0);return s.createElement("td",{key:ze,role:"gridcell","aria-colindex":je+1+_,"aria-selected":Ft,"aria-readonly":Go(Jt)||!Yo(Jt),id:kt,"data-testid":kt,onClick:()=>{const mn=re==null?void 0:re.current;if(mn!=null)return ce==null?void 0:ce({bounds:Pt(mn,je,ke),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:At})},onFocusCapture:mn=>{var In,ht;if(!(mn.target===Fo.current||((In=Ao.current)==null?void 0:In[0])===je&&((ht=Ao.current)==null?void 0:ht[1])===ke))return Ao.current=At,$e==null?void 0:$e(At)},ref:wt?gn:void 0,tabIndex:-1},cd(Jt,mt))})))))},[n,Pe,ft,J,le,h,l,r,H,gn,b,re,ce,Pt,$e],200),uo=S===0||!D?0:ft>S?1:vn(-le/100,0,1),hi=-l*32+gt,zo=A?vn(-hi/100,0,1):0,En=s.useMemo(()=>{if(!uo&&!zo)return null;const E={position:"absolute",top:0,left:Rt,width:n-Rt,height:o,opacity:uo,pointerEvents:"none",transition:ot?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},_={position:"absolute",top:et,left:0,width:n,height:o,opacity:zo,pointerEvents:"none",transition:Dt?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,uo>0&&s.createElement("div",{id:"shadow-x",style:E}),zo>0&&s.createElement("div",{id:"shadow-y",style:_}))},[uo,zo,Rt,n,ot,et,o,Dt]),On=s.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Dr,onKeyUp:To,onFocus:P,onBlur:N,ref:Kn,style:Un},lr),s.createElement("canvas",{ref:Je,style:On}),En)},ud=s.memo(s.forwardRef(dd));function pr(e,t,n,o){return vn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const fd=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,a]=s.useState(),[l,d]=s.useState(),[f,u]=s.useState(!1),[m,g]=s.useState(),[w,h]=s.useState(),[b,v]=s.useState(),[C,y]=s.useState(!1),[R,T]=s.useState(),{onHeaderMenuClick:P,onHeaderIndicatorClick:N,getCellContent:F,onColumnMoved:H,onColumnResize:S,onColumnResizeStart:X,onColumnResizeEnd:$,gridRef:D,maxColumnWidth:A,minColumnWidth:B,onRowMoved:te,lockColumns:q,onColumnProposeMove:fe,onMouseDown:pe,onMouseUp:ae,onItemHovered:J,onDragStart:V,canvasRef:ce}=e,he=(S??$??X)!==void 0,{columns:ve,selection:re}=e,Ce=re.columns,ie=s.useCallback(de=>{const[we,ge]=de.location;i!==void 0&&l!==we&&we>=q?(u(!0),d(we)):w!==void 0&&ge!==void 0?(y(!0),v(Math.max(0,ge))):o===void 0&&!f&&!C&&(J==null||J(de))},[i,w,l,J,q,o,f,C]),j=H!==void 0,Me=s.useCallback(de=>{var we;if(de.button===0){const[ge,De]=de.location;if(de.kind==="out-of-bounds"&&de.isEdge&&he){const $e=(we=D==null?void 0:D.current)==null?void 0:we.getBounds(ve.length-1,-1);$e!==void 0&&(n($e.x),r(ve.length-1))}else if(de.kind==="header"&&ge>=q){const $e=ce==null?void 0:ce.current;if(de.isEdge&&he&&$e){n(de.bounds.x),r(ge);const nt=$e.getBoundingClientRect().width/$e.offsetWidth,Ae=de.bounds.width/nt;X==null||X(ve[ge],Ae,ge,Ae+(ve[ge].growOffset??0))}else de.kind==="header"&&j&&(g(de.bounds.x),a(ge))}else de.kind==="cell"&&q>0&&ge===0&&De!==void 0&&te!==void 0&&(T(de.bounds.y),h(De))}pe==null||pe(de)},[pe,he,q,te,D,ve,j,X,ce]),ue=s.useCallback((de,we)=>{f||C||P==null||P(de,we)},[f,C,P]),Ye=s.useCallback((de,we)=>{f||C||N==null||N(de,we)},[f,C,N]),_e=s.useRef(-1),xe=s.useCallback(()=>{_e.current=-1,h(void 0),v(void 0),T(void 0),y(!1),a(void 0),d(void 0),g(void 0),u(!1),r(void 0),n(void 0)},[]),We=s.useCallback((de,we)=>{if(de.button===0){if(o!==void 0){if((Ce==null?void 0:Ce.hasIndex(o))===!0)for(const De of Ce){if(De===o)continue;const $e=ve[De],st=pr($e,_e.current,B,A);S==null||S($e,st,De,st+($e.growOffset??0))}const ge=pr(ve[o],_e.current,B,A);if($==null||$(ve[o],ge,o,ge+(ve[o].growOffset??0)),Ce.hasIndex(o))for(const De of Ce){if(De===o)continue;const $e=ve[De],st=pr($e,_e.current,B,A);$==null||$($e,st,De,st+($e.growOffset??0))}}xe(),i!==void 0&&l!==void 0&&(fe==null?void 0:fe(i,l))!==!1&&(H==null||H(i,l)),w!==void 0&&b!==void 0&&(te==null||te(w,b))}ae==null||ae(de,we)},[ae,o,i,l,w,b,Ce,$,ve,B,A,S,H,te,xe,fe]),lt=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(fe==null?void 0:fe(i,l))!==!1)return{src:i,dest:l}},[i,l,fe]),dt=s.useCallback(de=>{const we=ce==null?void 0:ce.current;if(i!==void 0&&m!==void 0)Math.abs(de.clientX-m)>20&&u(!0);else if(w!==void 0&&R!==void 0)Math.abs(de.clientY-R)>20&&y(!0);else if(o!==void 0&&t!==void 0&&we){const De=we.getBoundingClientRect().width/we.offsetWidth,$e=(de.clientX-t)/De,st=ve[o],nt=pr(st,$e,B,A);if(S==null||S(st,nt,o,nt+(st.growOffset??0)),_e.current=$e,(Ce==null?void 0:Ce.first())===o)for(const Ae of Ce){if(Ae===o)continue;const Ue=ve[Ae],ot=pr(Ue,_e.current,B,A);S==null||S(Ue,ot,Ae,ot+(Ue.growOffset??0))}}},[i,m,w,R,o,t,ve,B,A,S,Ce,ce]),Te=s.useCallback((de,we)=>{if(w===void 0||b===void 0)return F(de,we);let[ge,De]=de;return De===b?De=w:(De>b&&(De-=1),De>=w&&(De+=1)),F([ge,De],we)},[w,b,F]),Mt=s.useCallback(de=>{V==null||V(de),de.defaultPrevented()||xe()},[xe,V]);return s.createElement(ud,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:Te,isResizing:o!==void 0,onHeaderMenuClick:ue,onHeaderIndicatorClick:Ye,isDragging:f,onItemHovered:ie,onDragStart:Mt,onMouseDown:Me,allowResize:he,onMouseUp:We,dragAndDropState:lt,onMouseMoveRaw:dt,ref:D})};function hd(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=a=>{for(const l of a){const{width:d,height:f}=l&&l.contentRect||{};o(u=>u.width===d&&u.height===f?u:{width:d,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const gd=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),a=s.useRef(0),l=s.useRef(t);l.current=t;const d=n.current;s.useEffect(()=>{const f=()=>{var g,w;if(r.current===!1&&d!==null){const h=[d.scrollLeft,d.scrollTop];if(((g=i.current)==null?void 0:g[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},m=g=>{g.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&d!==null){const g=d;return g.addEventListener("touchstart",u),g.addEventListener("touchend",m),()=>{g.removeEventListener("touchstart",u),g.removeEventListener("touchend",m),o.current!==null&&window.clearTimeout(o.current)}}},[e,d])},md=()=>e=>e.isSafari?"scroll":"auto",wd=fn("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[md()]}}),bd=33554400,yd=5e6;function pd(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Qt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Qt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const vd=e=>{var re,Ce;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:l,preventDiagonalScrolling:d=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:m,rightElementProps:g,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:b}=e,v=[],C=(g==null?void 0:g.sticky)??!1,y=(g==null?void 0:g.fill)??!1,R=s.useRef(0),T=s.useRef(0),P=s.useRef(null),N=typeof window>"u"?1:window.devicePixelRatio,F=s.useRef(N);s.useEffect(()=>{if(F.current!==N){R.current=0,T.current=0,F.current=N;const ie=P.current;ie!==null&&te.current(ie.scrollLeft,ie.scrollTop)}},[N]);const H=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),S=s.useRef(null),X=pd(200),[$,D]=s.useState(!0),A=s.useRef(0);s.useLayoutEffect(()=>{if(!$||X||H.current.lockDirection===void 0)return;const ie=P.current;if(ie===null)return;const[j,Me]=H.current.lockDirection;j!==void 0?ie.scrollLeft=j:Me!==void 0&&(ie.scrollTop=Me),H.current.lockDirection=void 0},[X,$]);const B=s.useCallback((ie,j)=>{var ge;const Me=P.current;if(Me===null)return;j=j??Me.scrollTop,ie=ie??Me.scrollLeft;const ue=H.current.scrollTop,Ye=H.current.scrollLeft,_e=ie-Ye,xe=j-ue;X&&_e!==0&&xe!==0&&(Math.abs(_e)>3||Math.abs(xe)>3)&&d&&H.current.lockDirection===void 0&&(H.current.lockDirection=Math.abs(_e)<Math.abs(xe)?[Ye,void 0]:[void 0,ue]);const We=H.current.lockDirection;ie=(We==null?void 0:We[0])??ie,j=(We==null?void 0:We[1])??j,H.current.scrollLeft=ie,H.current.scrollTop=j;const lt=Me.clientWidth,dt=Me.clientHeight,Te=j,Mt=T.current-Te,de=Me.scrollHeight-dt;T.current=Te;let we;if(de>0&&o>Me.scrollHeight+5)if(Math.abs(Mt)>2e3||Te===0||Te===de){const De=Math.max(0,Math.min(1,Te/de)),$e=o-dt;we=De*$e,R.current=we}else R.current-=Mt,we=R.current;else we=Te,R.current=we;we=Math.max(0,Math.min(we,o-dt)),R.current=we,We!==void 0&&(window.clearTimeout(A.current),D(!1),A.current=window.setTimeout(()=>D(!0),200)),i({x:ie,y:we,width:lt-u,height:dt-f,paddingRight:((ge=S.current)==null?void 0:ge.clientWidth)??0})},[f,u,o,i,d,X]);gd(w&&oi.value,B,P);const te=s.useRef(B);te.current=B;const q=s.useRef(),fe=s.useRef(!1);s.useLayoutEffect(()=>{fe.current?B():fe.current=!0},[B,f,u]);const pe=s.useCallback(ie=>{P.current=ie,h!==void 0&&(h.current=ie)},[h]);let ae=0,J=0;const V=Math.min(o,bd);for(v.push(s.createElement("div",{key:ae++,style:{width:r,height:0}}));J<V;){const ie=Math.min(yd,V-J);v.push(s.createElement("div",{key:ae++,style:{width:0,height:ie}})),J+=ie}const{ref:ce,width:he,height:ve}=hd(b);return typeof window<"u"&&(((re=q.current)==null?void 0:re.height)!==ve||((Ce=q.current)==null?void 0:Ce.width)!==he)&&(window.setTimeout(()=>te.current(),0),q.current={width:he,height:ve}),(he??0)===0||(ve??0)===0?s.createElement("div",{ref:ce}):s.createElement("div",{ref:ce},s.createElement(wd,{isSafari:oi.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:pe,style:q.current,draggable:a,onDragStart:ie=>{a||(ie.stopPropagation(),ie.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>B()},s.createElement("div",{className:"dvn-scroll-inner"+(m===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},v),m!==void 0&&s.createElement(s.Fragment,null,!y&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:S,style:{height:ve,maxHeight:n-Math.ceil(N%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:y?1:void 0,right:C?u??0:void 0,pointerEvents:"auto"}},m))))))},Cd=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:l,experimental:d,nonGrowWidth:f,clientSize:u,className:m,onVisibleRegionChanged:g,scrollRef:w,preventDiagonalScrolling:h,rightElement:b,rightElementProps:v,overscrollX:C,overscrollY:y,initialSize:R,smoothScrollX:T=!1,smoothScrollY:P=!1,isDraggable:N}=e,{paddingRight:F,paddingBottom:H}=d??{},[S,X]=u,$=s.useRef(),D=s.useRef(),A=s.useRef(),B=s.useRef(),te=f+Math.max(0,C??0);let q=a?r+i:r;if(typeof o=="number")q+=n*o;else for(let J=0;J<n;J++)q+=o(J);y!==void 0&&(q+=y);const fe=s.useRef(),pe=s.useCallback(()=>{var Ye,_e;if(fe.current===void 0)return;const J={...fe.current};let V=0,ce=J.x<0?-J.x:0,he=0,ve=0;J.x=J.x<0?0:J.x;let re=0;for(let xe=0;xe<l;xe++)re+=t[xe].width;for(const xe of t){const We=V-re;if(J.x>=We+xe.width)V+=xe.width,ve++,he++;else if(J.x>We)V+=xe.width,T?ce+=We-J.x:ve++,he++;else if(J.x+J.width>We)V+=xe.width,he++;else break}let Ce=0,ie=0,j=0;if(typeof o=="number")P?(ie=Math.floor(J.y/o),Ce=ie*o-J.y):ie=Math.ceil(J.y/o),j=Math.ceil(J.height/o)+ie,Ce<0&&j++;else{let xe=0;for(let We=0;We<n;We++){const lt=o(We),dt=xe+(P?0:lt/2);if(J.y>=xe+lt)xe+=lt,ie++,j++;else if(J.y>dt)xe+=lt,P?Ce+=dt-J.y:ie++,j++;else if(J.y+J.height>lt/2+xe)xe+=lt,j++;else break}}ie=Math.max(0,Math.min(ie,n-1)),j=Math.max(ie,Math.min(j,n));const Me={x:ve,y:ie,width:he-ve,height:j-ie},ue=$.current;(ue===void 0||ue.y!==Me.y||ue.x!==Me.x||ue.height!==Me.height||ue.width!==Me.width||D.current!==ce||A.current!==Ce||J.width!==((Ye=B.current)==null?void 0:Ye[0])||J.height!==((_e=B.current)==null?void 0:_e[1]))&&(g==null||g({x:ve,y:ie,width:he-ve,height:j-ie},J.width,J.height,J.paddingRight??0,ce,Ce),$.current=Me,D.current=ce,A.current=Ce,B.current=[J.width,J.height])},[t,o,n,g,l,T,P]),ae=s.useCallback(J=>{fe.current=J,pe()},[pe]);return s.useEffect(()=>{pe()},[pe]),s.createElement(vd,{scrollRef:w,className:m,kineticScrollPerfHack:d==null?void 0:d.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:N===!0||typeof N=="string",scrollWidth:te+(F??0),scrollHeight:q+(H??0),clientHeight:X,rightElement:b,paddingBottom:H,paddingRight:F,rightElementProps:v,update:ae,initialSize:R},s.createElement(fd,{eventTargetRef:w,width:S,height:X,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},xd=fn("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),kd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Sd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Md=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Rd=10,Ed=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:l,onSearchValueChange:d,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:m=!1,onSearchClose:g}=e,[w]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,b]=s.useState(""),v=a??h,C=s.useCallback(V=>{b(V),d==null||d(V)},[d]),[y,R]=s.useState(),T=s.useRef(y);T.current=y,s.useEffect(()=>{l!==void 0&&(l.length>0?R(V=>({rowsSearched:o,results:l.length,selectedIndex:(V==null?void 0:V.selectedIndex)??-1})):R(void 0))},[o,l]);const P=s.useRef();P.current===void 0&&(P.current=new AbortController);const N=s.useRef(),[F,H]=s.useState([]),S=l??F,X=s.useCallback(()=>{N.current!==void 0&&(window.cancelAnimationFrame(N.current),N.current=void 0),P.current!==void 0&&P.current.abort(),P.current=new AbortController},[]),$=s.useRef(n);$.current=n;const D=s.useCallback(V=>{const ce=new RegExp(V.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let he=$.current,ve=Math.min(10,o),re=0;R(void 0),H([]);const Ce=[],ie=async()=>{var Te;if(f===void 0)return;const j=performance.now(),Me=o-re;let ue=f({x:0,y:he,width:r.length,height:Math.min(ve,Me,o-he)},P.current.signal);typeof ue=="function"&&(ue=await ue());let Ye=!1;for(const[Mt,de]of ue.entries())for(const[we,ge]of de.entries()){let De;switch(ge.kind){case ne.Text:case ne.Number:De=ge.displayData;break;case ne.Uri:case ne.Markdown:De=ge.data;break;case ne.Boolean:De=typeof ge.data=="boolean"?ge.data.toString():void 0;break;case ne.Image:case ne.Bubble:De=ge.data.join("🐳");break;case ne.Custom:De=ge.copyData;break}De!==void 0&&ce.test(De)&&(Ce.push([we,Mt+he]),Ye=!0)}const _e=performance.now();Ye&&H([...Ce]),re+=ue.length,cn(re<=o);const xe=((Te=T.current)==null?void 0:Te.selectedIndex)??-1;R({results:Ce.length,rowsSearched:re,selectedIndex:xe}),u==null||u(Ce,xe),he+ve>=o?he=0:he+=ve;const We=_e-j,lt=Math.max(We,1),dt=Rd/lt;ve=Math.ceil(ve*dt),re<o&&Ce.length<1e3&&(N.current=window.requestAnimationFrame(ie))};X(),N.current=window.requestAnimationFrame(ie)},[X,r.length,f,u,o]),A=s.useCallback(()=>{var V;g==null||g(),R(void 0),H([]),u==null||u([],-1),X(),(V=t==null?void 0:t.current)==null||V.focus()},[X,t,g,u]),B=s.useCallback(V=>{C(V.target.value),l===void 0&&(V.target.value===""?(R(void 0),H([]),X()):D(V.target.value))},[D,X,C,l]);s.useEffect(()=>{i.current!==null&&(C(""),R(void 0),F.length>0&&(H([]),u==null||u([],-1)),m?i.current.focus({preventScroll:!0}):X())},[m,i]);const te=s.useCallback(V=>{var he;if((he=V==null?void 0:V.stopPropagation)==null||he.call(V),y===void 0||y.results===0)return;const ce=(y.selectedIndex+1)%y.results;R({...y,selectedIndex:ce}),u==null||u(S,ce)},[y,u,S]),q=s.useCallback(V=>{var he;if((he=V==null?void 0:V.stopPropagation)==null||he.call(V),y===void 0||y.results===0)return;let ce=(y.selectedIndex-1)%y.results;ce<0&&(ce+=y.results),R({...y,selectedIndex:ce}),u==null||u(S,ce)},[u,S,y]),fe=s.useCallback(V=>{(V.ctrlKey||V.metaKey)&&V.nativeEvent.code==="KeyF"||V.key==="Escape"?(A(),V.stopPropagation(),V.preventDefault()):V.key==="Enter"&&(V.shiftKey?q():te())},[A,te,q]);s.useEffect(()=>()=>{X()},[X]);const[pe,ae]=s.useState(!1);s.useEffect(()=>{if(m)ae(!0);else{const V=setTimeout(()=>ae(!1),150);return()=>clearTimeout(V)}},[m]);const J=s.useMemo(()=>{if(!m&&!pe)return null;let V;y!==void 0&&(V=y.results>=1e3?"over 1000":`${y.results} result${y.results!==1?"s":""}`,y.selectedIndex>=0&&(V=`${y.selectedIndex+1} of ${V}`));const ce=re=>{re.stopPropagation()},ve={width:`${o>0?Math.floor(((y==null?void 0:y.rowsSearched)??0)/o*100):0}%`};return s.createElement(xd,{className:"gdg-search-bar"+(m?"":" out"),onMouseDown:ce,onMouseMove:ce,onMouseUp:ce,onClick:ce},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:w,"aria-hidden":!m,"data-testid":"search-input",ref:i,onChange:B,value:v,tabIndex:m?void 0:-1,onKeyDownCapture:fe}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:q,disabled:((y==null?void 0:y.results)??0)===0},kd),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:te,disabled:((y==null?void 0:y.results)??0)===0},Sd),g!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!m,"data-testid":"search-close-button",tabIndex:m?void 0:-1,onClick:A},Md)),y!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},V)),s.createElement("div",{className:"gdg-search-progress",style:ve})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:w},"Type to search")))},[m,pe,y,o,w,i,B,v,fe,q,te,g,A]);return s.createElement(s.Fragment,null,s.createElement(Cd,{prelightCells:S,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),J)};class Id extends s.PureComponent{constructor(){super(...arguments);Ne(this,"wrapperRef",s.createRef());Ne(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const Hd=()=>e=>Math.max(16,e.targetHeight-10),Td=fn("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[Hd(),"px"]}}),Dd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,l]=Tt.useState(n);return Tt.createElement(Id,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Tt.createElement(Td,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:d=>d.target.setSelectionRange(0,a.length),onChange:d=>l(d.target.value),onKeyDown:d=>{d.key==="Enter"?i(a):d.key==="Escape"&&o()},autoFocus:!0}))};function Fd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Oe(e,t,n){const o=Is(e,t);return o&&(n.didMatch=!0),o}function Is(e,t){if(e.length===0)return!1;if(e.includes("|")){const d=e.split("|");for(const f of d)if(Is(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),l=a.pop();if(!Fd(l,t))return!1;if(a[0]==="any")return!0;for(const d of a)switch(d){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":ri.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function Ad(e,t,n,o,r,i,a){const l=Tt.useCallback((u,m,g,w)=>{var R;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!a&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(g||w==="drag")||n==="additive",b=(o==="mixed"||o==="additive")&&h,v=g||(r==="mixed"||r==="additive")&&h;let C={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((R=e.current)==null?void 0:R.rangeStack)??[]:[]},columns:b?e.columns:it.empty(),rows:v?e.rows:it.empty()};g&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,m)},[o,e,n,i,a,r,t]),d=Tt.useCallback((u,m,g)=>{u=u??e.rows,m!==void 0&&(u=u.add(m));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:it.empty(),rows:u};else{const h=g&&n==="mixed"||n==="additive",b=g&&o==="mixed"||o==="additive";w={current:h?e.current:void 0,columns:b?e.columns:it.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=Tt.useCallback((u,m,g)=>{u=u??e.columns,m!==void 0&&(u=u.add(m));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:it.empty(),columns:u};else{const h=g&&n==="mixed"||n==="additive",b=g&&r==="mixed"||r==="additive";w={current:h?e.current:void 0,rows:b?e.rows:it.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,d,f]}function zd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let m=f.y;m<f.y+f.height;m++){const g=[];for(let w=f.x;w<f.x+f.width;w++)w<0||m>=r?g.push({kind:ne.Loading,allowOverlay:!1}):g.push(t([w,m]));u.push(g)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,l=s.useCallback(f=>{if(a===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const m=a(u,o.signal);return typeof m=="function"?async()=>(await m()).map(g=>[{kind:ne.Loading,allowOverlay:!1},...g]):m.map(g=>[{kind:ne.Loading,allowOverlay:!1},...g])}return a(u,o.signal)},[o.signal,a,n]);return[e!==void 0?l:void 0,a]}function Pd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case ne.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Gi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case ne.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case ne.Image:case ne.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case ne.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case ne.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case ne.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case ne.Markdown:case ne.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case ne.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case ne.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case ne.Protected:return{formatted:"************",rawValue:"",format:"string"};default:xr()}}function Ld(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:Pd(a))})}function Ol(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Bd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>Ol(a,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:Ol(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Fi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Xl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Wd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function $d(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Fi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,l)=>`<li gdg-raw-value=${Xl(r.rawValue[l])}>`+Fi(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Xl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Fi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function Nd(e,t){const n=Ld(e,t),o=Bd(n),r=$d(n);return{textPlain:o,textHtml:r}}function Yl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const d=l.cloneNode(!0),u=d.children.length===1&&d.children[0].nodeName==="P"?d.children[0]:null,m=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",g=d.querySelectorAll("br");for(const b of g)b.replaceWith(`
`);const w=d.getAttribute("gdg-raw-value"),h=d.getAttribute("gdg-format")??"string";if(d.querySelector("a")!==null)i==null||i.push({rawValue:((a=d.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:d.textContent??"",format:h});else if(d.querySelector("ol")!==null){const b=d.querySelectorAll("li");i==null||i.push({rawValue:[...b].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...b].map(v=>v.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:Wd(w),formatted:d.textContent??"",format:h});else{let b=d.textContent??"";m&&(b=b.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:b??"",formatted:b??"",format:h})}}}return i!==void 0&&r.push(i),r}function Od(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const d=(l=e.current)==null?void 0:l.range,f=[];if(d.width>2){const g=t({x:d.x,y:d.y,width:1,height:d.height},r.signal);if(typeof g=="function")return i;f.push(...g);const w=t({x:d.x+d.width-1,y:d.y,width:1,height:d.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const g=t({x:d.x,y:d.y,width:d.width,height:d.height},r.signal);if(typeof g=="function")return i;f.push(...g)}let u=d.x-n,m=d.x+d.width-1-n;for(const g of f)for(const w of g)w.span!==void 0&&(u=Math.min(w.span[0],u),m=Math.max(w.span[1],m));u===d.x-n&&m===d.x+d.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:d.y,width:m-u+1,height:d.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function Gl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Xd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,a)),r=a+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Gl(e.slice(r,a))),r=a+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(Gl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(d=>({rawValue:d,formatted:d,format:"string"})))}function _l(e,t,n){var l;const o=Nd(e,t),r=d=>{var f;(f=window.navigator.clipboard)==null||f.writeText(d)},i=(d,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([d],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},a=(d,f)=>{var u,m;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",d),(m=n==null?void 0:n.clipboardData)==null||m.setData("text/html",f)}catch{i(d,f)||r(d)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function Hs(e){return e!==!0}function Ul(e){return typeof e=="string"?e:`${e}px`}const Yd=()=>e=>e.innerWidth,Gd=()=>e=>e.innerHeight,_d=fn("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Yd()],"wmyidgi-1":[Gd()]}}),Ud=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(_d,{innerHeight:Ul(n),innerWidth:Ul(t),...r},o)},Kd=2,Vd=1300;function qd(e,t,n){const o=Tt.useRef(0),[r,i]=e??[0,0];Tt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,l=0;const d=f=>{var u;if(!a){if(l===0)l=f;else{const m=f-l;o.current=Math.min(1,o.current+m/Vd);const g=o.current**1.618*m*Kd;(u=t.current)==null||u.scrollBy(r*g,i*g),l=f,n==null||n()}window.requestAnimationFrame(d)}};return window.requestAnimationFrame(d),()=>{a=!0}},[t,r,i,n])}function jd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:l}){const[d,f,u,m,g,w]=Tt.useMemo(()=>{if(!a||l===16)return[e,t,n,o,r,i];const h=l/16,b=e,v=ws();return[typeof b=="number"?b*h:C=>Math.ceil(b(C)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??v.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??v.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??v.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,a,o]);return{rowHeight:d,headerHeight:f,groupHeaderHeight:u,theme:m,overscrollX:g,overscrollY:w}}const Jn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Xe(e,t){return e===!0?t:e===!1?"":e}function Kl(e){const t=ri.value;return{activateCell:Xe(e.activateCell," |Enter|shift+Enter"),clear:Xe(e.clear,"any+Escape"),closeOverlay:Xe(e.closeOverlay,"any+Escape"),acceptOverlayDown:Xe(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Xe(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Xe(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Xe(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Xe(e.delete,t?"Backspace|Delete":"Delete"),downFill:Xe(e.downFill,"primary+_68"),scrollToSelectedCell:Xe(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Xe(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Xe(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Xe(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Xe(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Xe(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Xe(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Xe(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Xe(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Xe(e.goToFirstCell,"primary+Home"),goToFirstColumn:Xe(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Xe(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Xe(e.goToLastCell,"primary+End"),goToLastColumn:Xe(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Xe(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Xe(e.goToNextPage,"PageDown"),goToPreviousPage:Xe(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Xe(e.rightFill,"primary+_82"),search:Xe(e.search,"primary+f"),selectAll:Xe(e.selectAll,"primary+a"),selectColumn:Xe(e.selectColumn,"ctrl+ "),selectGrowDown:Xe(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Xe(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Xe(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Xe(e.selectGrowUp,"shift+ArrowUp"),selectRow:Xe(e.selectRow,"shift+ "),selectToFirstCell:Xe(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Xe(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Xe(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Xe(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Xe(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Xe(e.selectToLastRow,"primary+shift+ArrowDown")}}function Zd(e){const t=Fa(e);return Tt.useMemo(()=>{if(t===void 0)return Kl(Jn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Jn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Jn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Jn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Jn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Jn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Jn.selectToLastCell};return Kl({...Jn,...n})},[t])}function Jd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const a={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(a.subGroups=o.subGroups.map((l,d)=>t(l,r+1,[...i,d])).sort((l,d)=>l.headerIndex-d.headerIndex)),a}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function el(e,t){const n=[];function o(l,d,f=!1){let u=d!==null?d-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let m=0;m<l.subGroups.length;m++){const g=m<l.subGroups.length-1?l.subGroups[m+1].headerIndex:d;o(l.subGroups[m],g,f||l.isCollapsed)}}const r=Jd(e.groups);for(let l=0;l<r.length;l++){const d=l<r.length-1?r[l+1].headerIndex:null;o(r[l],d)}let i=0,a=0;for(const l of n)l.contentIndex=a,a+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:d,...f}=l;return f})}function Yi(e,t){if(t===void 0||el.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Qd(e,t,n,o){const r=Tt.useMemo(()=>e===void 0?void 0:el(e,t),[e,t]),i=Tt.useMemo(()=>r==null?void 0:r.reduce((u,m)=>(u[m.rowIndex]=m,u),{}),[r]),a=Tt.useMemo(()=>r===void 0?t:r.reduce((u,m)=>u+(m.isCollapsed?1:m.rows+1),0),[r,t]),l=Tt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),d=Tt.useCallback(u=>{if(r===void 0)return u;let m=u;for(const g of r){if(m===0)return;if(m--,!g.isCollapsed){if(m<g.rows)return g.contentIndex+m;m-=g.rows}}return u},[r]),f=eo(o??(e==null?void 0:e.themeOverride),Tt.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:m,contentIndex:g,groupIndex:w}=Yi(u,r);return m?e.themeOverride:o==null?void 0:o(u,w,g)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:d,getRowThemeOverride:f}:{rowHeight:l,rows:a,rowNumberMapper:d,getRowThemeOverride:f}}function eu(e,t){const n=Tt.useMemo(()=>e===void 0?void 0:el(e,t),[e,t]);return{getRowGroupingForPath:Ds,updateRowGroupingByPath:Ts,mapper:Tt.useCallback(o=>{if(typeof o=="number")return Yi(o,n);const r=Yi(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function Ts(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,a)=>a===o?{...i,...n}:i):e.map((i,a)=>a===o?{...i,subGroups:Ts(i.subGroups??[],r,n)}:i)}function Ds(e,t){const[n,...o]=t;return o[0]===-1?e[n]:Ds(e[n].subGroups??[],o)}function tu(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function nu(e,t,n,o,r){const[i,a]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:a}),[o,a,i]),[d,f,u]=Da(l),m=s.useRef(r);m.current=r;const g=tu(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),w=(d.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&g.current!==null&&w){if(g.current.scrollTop===t)return;g.current.scrollTop=t,g.current.scrollTop!==t&&u(),m.current()}},[t,w,u,g]);const h=(d.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&g.current!==null&&h){if(g.current.scrollLeft===e)return;g.current.scrollLeft=e,g.current.scrollLeft!==e&&u(),m.current()}},[e,h,u,g]),{visibleRegion:d,setVisibleRegion:f,scrollRef:g}}const ou=s.lazy(async()=>await Zl(()=>import("./data-grid-overlay-editor-BjtgIQmE.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let ru=0;function iu(e){return va(kl(kl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return po((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function jr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Qn={kind:ne.Loading,allowOverlay:!1},Ai={columns:it.empty(),rows:it.empty(),current:void 0},lu=(e,t)=>{var vl,Cl,xl;const[n,o]=s.useState(Ai),[r,i]=s.useState(),a=s.useRef(null),l=s.useRef(null),[d,f]=s.useState(),u=s.useRef(void 0),m=typeof window>"u"?null:window,{imageEditorOverride:g,getRowThemeOverride:w,markdownDivCreateNode:h,width:b,height:v,columns:C,rows:y,getCellContent:R,onCellClicked:T,onCellActivated:P,onFillPattern:N,onFinishedEditing:F,coercePasteValue:H,drawHeader:S,drawCell:X,editorBloom:$,onHeaderClicked:D,onColumnProposeMove:A,rangeSelectionColumnSpanning:B=!0,spanRangeBehavior:te="default",onGroupHeaderClicked:q,onCellContextMenu:fe,className:pe,onHeaderContextMenu:ae,getCellsForSelection:J,onGroupHeaderContextMenu:V,onGroupHeaderRenamed:ce,onCellEdited:he,onCellsEdited:ve,onSearchResultsChanged:re,searchResults:Ce,onSearchValueChange:ie,searchValue:j,onKeyDown:Me,onKeyUp:ue,keybindings:Ye,editOnType:_e=!0,onRowAppended:xe,onColumnAppended:We,onColumnMoved:lt,validateCell:dt,highlightRegions:Te,rangeSelect:Mt="rect",columnSelect:de="multi",rowSelect:we="multi",rangeSelectionBlending:ge="exclusive",columnSelectionBlending:De="exclusive",rowSelectionBlending:$e="exclusive",onDelete:st,onDragStart:nt,onMouseMove:Ae,onPaste:Ue,copyHeaders:ot=!1,freezeColumns:Dt=0,cellActivationBehavior:U="second-click",rowSelectionMode:mt="auto",columnSelectionMode:at="auto",onHeaderMenuClick:le,onHeaderIndicatorClick:gt,getGroupDetails:ft,rowGrouping:Le,onSearchClose:qe,onItemHovered:xt,onSelectionCleared:zt,showSearch:qt,onVisibleRegionChanged:jt,gridSelection:vt,onGridSelectionChange:en,minColumnWidth:Zt=50,maxColumnWidth:An=500,maxColumnAutoWidth:zn,provideEditor:yt,trailingRowOptions:Ke,freezeTrailingRows:Je=0,allowedFillDirections:Ut="orthogonal",scrollOffsetX:on,scrollOffsetY:rn,verticalBorder:Kt,onDragOverCell:Pn,onDrop:Re,onColumnResize:et,onColumnResizeEnd:tt,onColumnResizeStart:Wt,customRenderers:Xt,fillHandle:Pe,experimental:Rt,fixedShadowX:Pt,fixedShadowY:Lt,headerIcons:Ln,imageWindowLoader:Sr,initialSize:Yn,isDraggable:Bn,onDragLeave:Wn,onRowMoved:Rn,overscrollX:Mr,overscrollY:Rr,preventDiagonalScrolling:ko,rightElement:So,rightElementProps:Mo,trapFocus:io=!1,smoothScrollX:lo,smoothScrollY:Gn,scaleToRem:ai=!1,rowHeight:Er=34,headerHeight:Ir=36,groupHeaderHeight:ci=Ir,theme:$n,isOutsideClick:_n,renderers:jo,resizeIndicator:di,scrollToActiveCell:Zo=!0,drawFocusRing:Jo=!0,portalElementRef:Ro,isActivationOnEnter:so,onRowStatus:ao,onRowId:Un}=e,Qo=Jo==="no-editor"?r===void 0:Jo,Ee=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Eo=(Ee==null?void 0:Ee.rowNumber)??!1;let Cn=(Ee==null?void 0:Ee.kind)??e.rowMarkers??"none",ln=Eo;(Cn==="both"||Cn==="checkbox-and-number")&&(Cn="checkbox",ln=!0);const Yt=Cn,er=(Ee==null?void 0:Ee.width)??e.rowMarkerWidth,tr=(Ee==null?void 0:Ee.startIndex)??e.rowMarkerStartIndex??1,Io=(Ee==null?void 0:Ee.theme)??e.rowMarkerTheme,nr=Ee==null?void 0:Ee.headerTheme,Hr=Ee==null?void 0:Ee.headerAlwaysVisible,Ho=we!=="multi"||(Ee==null?void 0:Ee.headerDisabled)===!0,Nn=(Ee==null?void 0:Ee.checkboxStyle)??"square",Tr=(Ee==null?void 0:Ee.rowStatus)??!1,or=(Ee==null?void 0:Ee.rowStatusWidth)??40,co=Ee==null?void 0:Ee.rowStatusTheme,ui=(Ee==null?void 0:Ee.rowId)??!1,Dr=(Ee==null?void 0:Ee.rowIdWidth)??80,To=Ee==null?void 0:Ee.rowIdTheme,Kn=Math.max(Zt,20),Do=Math.max(An,Kn),rr=Math.max(zn??Do,Kn),Fr=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Ie,rowNumberMapper:ir,rowHeight:fi,getRowThemeOverride:hn}=Qd(Le,y,Er,w),Fo=s.useMemo(()=>Number.parseFloat(Fr.fontSize),[Fr]),{rowHeight:gn,headerHeight:Ao,groupHeaderHeight:lr,theme:uo,overscrollX:hi,overscrollY:zo}=jd({groupHeaderHeight:ci,headerHeight:Ir,overscrollX:Mr,overscrollY:Rr,remSize:Fo,rowHeight:fi,scaleToRem:ai,theme:$n}),En=Zd(Ye),On=er??(y>1e4?48:y>1e3?44:y>100?36:32),E=Yt!=="none",_=Tr===!0,se=ui===!0,x=(E?ln?2:1:0)+(_?1:0)+(se?1:0),K=Ke!==void 0,oe=(Ke==null?void 0:Ke.sticky)===!0,[Fe,Ve]=s.useState(!1),be=qt??Fe,Bt=s.useCallback(()=>{qe!==void 0?qe():Ve(!1)},[qe]),I=s.useMemo(()=>vt===void 0?void 0:jr(vt,x),[vt,x])??n,je=s.useRef(new AbortController);s.useEffect(()=>()=>je==null?void 0:je.current.abort(),[]);const[ze,wt]=zd(J,R,x,je.current,Ie),Ft=s.useCallback((c,p,k)=>{if(dt===void 0)return!0;const M=[c[0]-x,c[1]];return dt==null?void 0:dt(M,p,k)},[x,dt]),kt=s.useRef(vt),At=s.useCallback((c,p)=>{p&&(c=Od(c,ze,x,te,je.current)),en!==void 0?(kt.current=jr(c,-x),en(kt.current)):o(c)},[en,ze,x,te]),Jt=eo(et,s.useCallback((c,p,k,M)=>{et==null||et(C[k-x],p,k-x,M)},[et,x,C])),mn=eo(tt,s.useCallback((c,p,k,M)=>{tt==null||tt(C[k-x],p,k-x,M)},[tt,x,C])),In=eo(Wt,s.useCallback((c,p,k,M)=>{Wt==null||Wt(C[k-x],p,k-x,M)},[Wt,x,C])),ht=eo(S,s.useCallback((c,p)=>(S==null?void 0:S({...c,columnIndex:c.columnIndex-x},p))??!1,[S,x])),Hn=eo(X,s.useCallback((c,p)=>(X==null?void 0:X({...c,col:c.col-x},p))??!1,[X,x])),Gt=s.useCallback(c=>{if(st!==void 0){const p=st(jr(c,-x));return typeof p=="boolean"?p:jr(p,x)}return!0},[st,x]),[St,bt,Ct]=Ad(I,At,ge,De,$e,Mt,B),Et=s.useMemo(()=>Fn(ws(),uo),[uo]),[Po,fo]=s.useState([0,0,0]),Ar=s.useMemo(()=>{if(jo===void 0)return{};const c={};for(const p of jo)c[p.kind]=p;return c},[jo]),_t=s.useCallback(c=>c.kind!==ne.Custom?Ar[c.kind]:Xt==null?void 0:Xt.find(p=>p.isMatch(c)),[Xt,Ar]);let{sizedColumns:wn,nonGrowWidth:tl}=oc(C,Ie,wt,Po[0]-(x===0?0:On)-Po[2],Kn,rr,Et,_t,je.current);Yt!=="none"&&(tl+=On);const sr=s.useMemo(()=>{let c=0;for(const p of wn)p.group!==void 0&&(typeof p.group=="string"?c=Math.max(c,1):c=Math.max(c,p.group.length));return c},[wn]),nl=sr>0,ol=s.useMemo(()=>sr===0?[]:Array(sr).fill(lr),[sr,lr]),zs=ol.reduce((c,p)=>c+p,0),ar=Ao+zs,rl=I.rows.length,il=Yt==="none"?void 0:rl===0?!1:rl===Ie?!0:void 0,Ze=s.useMemo(()=>{const c=[];return Yt!=="none"&&(ln&&c.push({title:"",width:On,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Io,rowMarker:Nn,rowMarkerChecked:!1,headerRowMarkerTheme:nr,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),c.push({title:"",width:On,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Io,rowMarker:Nn,rowMarkerChecked:il,headerRowMarkerTheme:nr,headerRowMarkerAlwaysVisible:Hr,headerRowMarkerDisabled:Ho})),_&&c.push({title:"",width:or,icon:void 0,hasMenu:!1,style:"normal",themeOverride:co}),se&&c.push({title:"ID",width:Dr,icon:void 0,hasMenu:!1,style:"normal",themeOverride:To}),[...c,...wn]},[_,or,co,se,Dr,To,Yt,wn,On,Io,Nn,il,nr,Hr,Ho,ln]),sn=s.useRef({height:1,width:1,x:0,y:0}),zr=s.useRef(!1),{setVisibleRegion:ll,visibleRegion:ho,scrollRef:ct}=nu(on,rn,gn,sn,()=>zr.current=!0);sn.current=ho;const Ps=ho.x+x,Pr=ho.y,$t=s.useRef(null),Vt=s.useCallback(c=>{var p;c===!0?(p=$t.current)==null||p.focus():window.requestAnimationFrame(()=>{var k;(k=$t.current)==null||k.focus()})},[]),Nt=K?Ie+1:Ie,bn=s.useCallback(c=>{const p=x===0?c:c.map(M=>({...M,location:[M.location[0]-x,M.location[1]]})),k=ve==null?void 0:ve(p);if(k!==!0)for(const M of p)he==null||he(M.location,M.value);return k},[he,ve,x]),[go,gi]=s.useState(),Lr=I.current!==void 0&&I.current.range.width*I.current.range.height>1?I.current.range:void 0,Lo=Qo?(vl=I.current)==null?void 0:vl.cell:void 0,Br=Lo==null?void 0:Lo[0],Wr=Lo==null?void 0:Lo[1],Ls=s.useMemo(()=>{if((Te===void 0||Te.length===0)&&(Lr??Br??Wr??go)===void 0)return;const c=[];if(Te!==void 0)for(const p of Te){const k=Ze.length-p.range.x-x;k>0&&c.push({color:p.color,range:{...p.range,x:p.range.x+x,width:Math.min(k,p.range.width)},style:p.style})}return go!==void 0&&c.push({color:oo(Et.accentColor,0),range:go,style:"dashed"}),Lr!==void 0&&c.push({color:oo(Et.accentColor,.5),range:Lr,style:"solid-outline"}),Br!==void 0&&Wr!==void 0&&c.push({color:Et.accentColor,range:{x:Br,y:Wr,width:1,height:1},style:"solid-outline"}),c.length>0?c:void 0},[go,Lr,Br,Wr,Te,Ze.length,Et.accentColor,x]),sl=s.useRef(Ze);sl.current=Ze;const an=s.useCallback(([c,p],k=!1)=>{var G,Z,ee,Q,Ge,He,Qe,Be,ye;const M=K&&p===Nt-1;let W=0,Y=-1,L=-1,z=-1,O=-1;if(E&&ln&&(Y=W++),E&&(L=W++),_&&(z=W++),se&&(O=W++),c===Y){if(M)return Qn;const Se=ir(p);return Se===void 0?Qn:{kind:Ot.Marker,allowOverlay:!1,checkboxStyle:Nn,checked:!1,markerKind:"number",row:tr+Se,drawHandle:!1,cursor:void 0,disabled:((G=e.disabledRows)==null?void 0:G.call(e,p))===!0}}if(c===L){if(M)return Qn;const Se=ir(p);if(Se===void 0)return Qn;let rt;return ln?rt=Yt==="checkbox-visible"?"checkbox-visible":"checkbox":Yt==="clickable-number"?rt="number":rt=Yt,{kind:Ot.Marker,allowOverlay:!1,checkboxStyle:Nn,checked:(I==null?void 0:I.rows.hasIndex(p))===!0,markerKind:rt,row:tr+Se,drawHandle:Rn!==void 0,cursor:ln?void 0:Yt==="clickable-number"?"pointer":void 0,disabled:((Z=e.disabledRows)==null?void 0:Z.call(e,p))===!0}}if(c===z){if(M)return Qn;const Se=ao==null?void 0:ao(p);return{kind:Ot.RowStatus,allowOverlay:!1,status:Se,themeOverride:co}}if(c===O){if(M)return Qn;const Se=Un==null?void 0:Un(p);return{kind:Ot.RowId,allowOverlay:!1,rowId:Se,themeOverride:To}}if(M){const rt=c===x?(Ke==null?void 0:Ke.hint)??"":"",me=sl.current[c];if(((ee=me==null?void 0:me.trailingRowOptions)==null?void 0:ee.disabled)===!0)return Qn;{const ut=((Q=me==null?void 0:me.trailingRowOptions)==null?void 0:Q.hint)??rt,Ht=((Ge=me==null?void 0:me.trailingRowOptions)==null?void 0:Ge.addIcon)??(Ke==null?void 0:Ke.addIcon);return{kind:Ot.NewRow,hint:ut,allowOverlay:!1,icon:Ht}}}else{const Se=c-x;if(k||(Rt==null?void 0:Rt.strict)===!0){const me=sn.current,ut=me.x>Se||Se>me.x+me.width||me.y>p||p>me.y+me.height||p>=yi.current,Ht=Se===((Qe=(He=me.extras)==null?void 0:He.selected)==null?void 0:Qe[0])&&p===((Be=me.extras)==null?void 0:Be.selected[1]);let tn=!1;if(((ye=me.extras)==null?void 0:ye.freezeRegions)!==void 0){for(const pn of me.extras.freezeRegions)if(no(pn,Se,p)){tn=!0;break}}if(ut&&!Ht&&!tn)return Qn}let rt=R([Se,p]);return x!==0&&rt.span!==void 0&&(rt={...rt,span:[rt.span[0]+x,rt.span[1]+x]}),rt}},[K,Nt,_,ao,co,se,Un,To,E,ir,Nn,I==null?void 0:I.rows,Yt,tr,Rn,x,Ke==null?void 0:Ke.hint,Ke==null?void 0:Ke.addIcon,Rt==null?void 0:Rt.strict,R,ln]),mi=s.useCallback(c=>{let p=(ft==null?void 0:ft(c))??{name:c};return ce!==void 0&&c!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:k=>vi({group:p.name,bounds:k.bounds})}]}),p},[ft,ce]),Bo=s.useCallback(c=>{var z;const[p,k]=c.cell,M=Ze[p],W=(M==null?void 0:M.group)!==void 0?(z=mi(M.group))==null?void 0:z.overrideTheme:void 0,Y=M==null?void 0:M.themeOverride,L=hn==null?void 0:hn(k);i({...c,theme:Fn(Et,W,Y,L,c.content.themeOverride)})},[hn,Ze,mi,Et]),cr=s.useCallback((c,p,k)=>{var L;if(I.current===void 0)return;const[M,W]=I.current.cell,Y=an([M,W]);if(Y.kind!==ne.Boolean&&Y.allowOverlay){let z=Y;if(k!==void 0)switch(z.kind){case ne.Number:{const O=xa(()=>k==="-"?-0:Number.parseFloat(k),0);z={...z,data:Number.isNaN(O)?0:O};break}case ne.Text:case ne.Markdown:case ne.Uri:z={...z,data:k};break}Bo({target:c,content:z,initialValue:k,cell:[M,W],highlight:k===void 0,forceEditMode:k!==void 0,activation:p})}else Y.kind===ne.Boolean&&p.inputType==="keyboard"&&Y.readonly!==!0&&(bn([{location:I.current.cell,value:{...Y,data:Hs(Y.data)}}]),(L=$t.current)==null||L.damage([{cell:I.current.cell}]))},[an,I,bn,Bo]),al=s.useCallback((c,p)=>{var W;const k=(W=$t.current)==null?void 0:W.getBounds(c,p);if(k===void 0||ct.current===null)return;const M=an([c,p]);M.allowOverlay&&Bo({target:k,content:M,initialValue:void 0,highlight:!0,cell:[c,p],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[an,ct,Bo]),It=s.useCallback((c,p,k="both",M=0,W=0,Y=void 0)=>{if(ct.current!==null){const L=$t.current,z=l.current,O=typeof c!="number"?c.unit==="cell"?c.amount:void 0:c,G=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,Z=typeof c!="number"&&c.unit==="px"?c.amount:void 0,ee=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(L!==null&&z!==null){let Q={x:0,y:0,width:0,height:0},Ge=0,He=0;if((O!==void 0||G!==void 0)&&(Q=L.getBounds((O??0)+x,G??0)??Q,Q.width===0||Q.height===0))return;const Qe=z.getBoundingClientRect(),Be=Qe.width/z.offsetWidth;if(Z!==void 0&&(Q={...Q,x:Z-Qe.left-ct.current.scrollLeft,width:1}),ee!==void 0&&(Q={...Q,y:ee+Qe.top-ct.current.scrollTop,height:1}),Q!==void 0){const ye={x:Q.x-M,y:Q.y-W,width:Q.width+2*M,height:Q.height+2*W};let Se=0;for(let Ei=0;Ei<Dt;Ei++)Se+=wn[Ei].width;let rt=0;const me=Je+(oe?1:0);me>0&&(rt=Co(Nt,me,gn));let ut=Se*Be+Qe.left+x*On*Be,Ht=Qe.right,tn=Qe.top+ar*Be,pn=Qe.bottom-rt*Be;const _r=Q.width+M*2;switch(Y==null?void 0:Y.hAlign){case"start":Ht=ut+_r;break;case"end":ut=Ht-_r;break;case"center":ut=Math.floor((ut+Ht)/2)-_r/2,Ht=ut+_r;break}const Ur=Q.height+W*2;switch(Y==null?void 0:Y.vAlign){case"start":pn=tn+Ur;break;case"end":tn=pn-Ur;break;case"center":tn=Math.floor((tn+pn)/2)-Ur/2,pn=tn+Ur;break}ut>ye.x?Ge=ye.x-ut:Ht<ye.x+ye.width&&(Ge=ye.x+ye.width-Ht),tn>ye.y?He=ye.y-tn:pn<ye.y+ye.height&&(He=ye.y+ye.height-pn),k==="vertical"||typeof c=="number"&&c<Dt?Ge=0:(k==="horizontal"||typeof p=="number"&&p>=Nt-me)&&(He=0),(Ge!==0||He!==0)&&(Be!==1&&(Ge/=Be,He/=Be),ct.current.scrollTo({left:Ge+ct.current.scrollLeft,top:He+ct.current.scrollTop,behavior:(Y==null?void 0:Y.behavior)??"auto"}))}}}},[x,Je,On,ct,ar,Dt,wn,Nt,oe,gn]),wi=s.useRef(al),bi=s.useRef(R);wi.current=al,bi.current=R;const yi=s.useRef(Ie);yi.current=Ie;const cl=s.useRef(Ze.length);cl.current=Ze.length;const Vn=s.useCallback(async(c,p=!0,k)=>{var G;const M=Ze[c];if(((G=M==null?void 0:M.trailingRowOptions)==null?void 0:G.disabled)===!0)return;const W=xe==null?void 0:xe();let Y,L=!0;W!==void 0&&(Y=await W,Y==="top"&&(L=!1),typeof Y=="number"&&(L=!1));let z=0;const O=()=>{if(yi.current<=Ie){z<500&&window.setTimeout(O,z),z=50+z*2;return}const Z=typeof Y=="number"?Y:L?Ie:0;Gr.current(c-x,Z,"both",0,20,k?{behavior:k}:void 0),St({cell:[c,Z],range:{x:c,y:Z,width:1,height:1}},!1,!1,"edit");const ee=bi.current([c-x,Z]);ee.allowOverlay&&Yo(ee)&&ee.readonly!==!0&&p&&window.setTimeout(()=>{wi.current(c,Z)},0)};O()},[Ze,xe,x,Ie,St]),$r=s.useCallback(async(c,p=!0)=>{const k=We==null?void 0:We();let M,W=!0;k!==void 0&&(M=await k,M==="left"&&(W=!1),typeof M=="number"&&(W=!1));let Y=0;const L=()=>{if(cl.current<=Ze.length){Y<500&&window.setTimeout(L,Y),Y=50+Y*2;return}const z=typeof M=="number"?M:W?Ze.length:0;It(z-x,c),St({cell:[z,c],range:{x:z,y:c,width:1,height:1}},!1,!1,"edit");const O=bi.current([z-x,c]);O.allowOverlay&&Yo(O)&&O.readonly!==!0&&p&&window.setTimeout(()=>{wi.current(z,c)},0)};L()},[Ze,We,x,It,St]),Wo=s.useCallback(c=>{var k,M;const p=((M=(k=wn[c])==null?void 0:k.trailingRowOptions)==null?void 0:M.targetColumn)??(Ke==null?void 0:Ke.targetColumn);if(typeof p=="number")return p+(E?1:0);if(typeof p=="object"){const W=C.indexOf(p);if(W>=0)return W+(E?1:0)}},[wn,C,E,Ke==null?void 0:Ke.targetColumn]),qn=s.useRef(void 0),$o=s.useRef(void 0),dr=s.useCallback((c,p)=>{var W;const[k,M]=p;return Fn(Et,(W=Ze[k])==null?void 0:W.themeOverride,hn==null?void 0:hn(M),c.themeOverride)},[hn,Ze,Et]),{mapper:mo}=eu(Le,y),xn=Le==null?void 0:Le.navigationBehavior,ur=s.useCallback(c=>{var G,Z,ee;const p=ri.value?c.metaKey:c.ctrlKey,k=p&&we==="multi",[M,W]=c.location,Y=I.columns,L=I.rows,[z,O]=((G=I.current)==null?void 0:G.cell)??[];if(c.kind==="cell"){if($o.current=void 0,wo.current=[M,W],M===(ln?1:0)&&E){if(K===!0&&W===Ie||Yt==="number"||we==="none")return;const He=an(c.location);if(He.kind!==Ot.Marker||He.disabled===!0)return;if(Rn!==void 0){const ye=_t(He);cn((ye==null?void 0:ye.kind)===Ot.Marker);const Se=(Z=ye==null?void 0:ye.onClick)==null?void 0:Z.call(ye,{...c,cell:He,posX:c.localEventX,posY:c.localEventY,bounds:c.bounds,theme:dr(He,c.location),preventDefault:()=>{}});if(Se===void 0||Se.checked===He.checked)return}i(void 0),Vt();const Qe=L.hasIndex(W),Be=qn.current;if(we==="multi"&&(c.shiftKey||c.isLongTouch===!0)&&Be!==void 0&&L.hasIndex(Be)){const ye=[Math.min(Be,W),Math.max(Be,W)+1];k||mt==="multi"?bt(void 0,ye,!0):bt(it.fromSingleSelection(ye),void 0,k)}else we==="multi"&&(k||c.isTouch||mt==="multi")?Qe?bt(L.remove(W),void 0,!0):(bt(void 0,W,!0),qn.current=W):Qe&&L.length===1?bt(it.empty(),void 0,p):(bt(it.fromSingleSelection(W),void 0,p),qn.current=W)}else if(M>=x&&K&&W===Ie){const He=Wo(M);Vn(He??M)}else if(z!==M||O!==W){const He=an(c.location),Qe=_t(He);if((Qe==null?void 0:Qe.onSelect)!==void 0){let Se=!1;if(Qe.onSelect({...c,cell:He,posX:c.localEventX,posY:c.localEventY,bounds:c.bounds,preventDefault:()=>Se=!0,theme:dr(He,c.location)}),Se)return}if(xn==="block"&&mo(W).isGroupHeader)return;const Be=oe&&W===Ie,ye=oe&&I!==void 0&&((ee=I.current)==null?void 0:ee.cell[1])===Ie;if((c.shiftKey||c.isLongTouch===!0)&&z!==void 0&&O!==void 0&&I.current!==void 0&&!ye){if(Be)return;const Se=Math.min(M,z),rt=Math.max(M,z),me=Math.min(W,O),ut=Math.max(W,O);St({...I.current,range:{x:Se,y:me,width:rt-Se+1,height:ut-me+1}},!0,p,"click"),qn.current=void 0,Vt()}else{const Se=I.rows.length>0;St({cell:[M,W],range:{x:M,y:W,width:1,height:1}},!0,p||Se,"click"),qn.current=void 0,i(void 0),Vt()}}}else if(c.kind==="header")if(wo.current=[M,W],i(void 0),E&&M===0)qn.current=void 0,$o.current=void 0,!Ho&&we==="multi"&&(L.length!==Ie?bt(it.fromSingleSelection([0,Ie]),void 0,p):bt(it.empty(),void 0,p),Vt());else{const Q=$o.current;if(de==="multi"&&(c.shiftKey||c.isLongTouch===!0)&&Q!==void 0&&Y.hasIndex(Q)){const Ge=[Math.min(Q,M),Math.max(Q,M)+1];p||c.isTouch||at==="multi"?Ct(void 0,Ge,p):Ct(it.fromSingleSelection(Ge),void 0,p)}else de==="multi"&&(p||c.isTouch||at==="multi")?(Y.hasIndex(M)?Ct(Y.remove(M),void 0,p):Ct(void 0,M,p),$o.current=M):de!=="none"&&(Y.hasIndex(M)?Ct(Y.remove(M),void 0,p):Ct(it.fromSingleSelection(M),void 0,p),$o.current=M);qn.current=void 0,Vt()}else c.kind===Sn?wo.current=[M,W]:c.kind===ii&&!c.isMaybeScrollbar&&(At(Ai,!1),i(void 0),Vt(),zt==null||zt(),qn.current=void 0,$o.current=void 0)},[we,de,I,E,x,K,Ie,Yt,an,Rn,Vt,mt,at,_t,dr,bt,Wo,Vn,xn,mo,oe,St,Ho,Ct,At,zt]),fr=s.useRef(!1),wo=s.useRef(void 0),dl=s.useRef(ho),yn=s.useRef(void 0),Bs=s.useCallback(c=>{if(No.current=!1,dl.current=sn.current,c.button!==0&&c.button!==1){yn.current=void 0;return}const p=performance.now();yn.current={button:c.button,time:p,location:c.location},(c==null?void 0:c.kind)==="header"&&(fr.current=!0);const k=c.kind==="cell"&&c.isFillHandle;!k&&c.kind!=="cell"&&c.isEdge||(f({previousSelection:I,fillHandle:k}),wo.current=void 0,!c.isTouch&&c.button===0&&!k?ur(c):!c.isTouch&&c.button===1&&(wo.current=c.location))},[I,ur]),[pi,vi]=s.useState(),ul=s.useCallback(c=>{if(c.kind!==Sn||de!=="multi")return;const p=ri.value?c.metaKey:c.ctrlKey,[k,M]=c.location,W=I.columns;if(k<x)return;const Y=Ze[k];let L=k,z=k;const O=M<=-2?-(M+2):0,G=Array.isArray(Y.group)?Y.group.length:1,Z=(ee,Q)=>G>1?ti(ee,Q,O,G):is(ee,Q);for(let ee=k-1;ee>=x&&Z(Y.group,Ze[ee].group);ee--)L--;for(let ee=k+1;ee<Ze.length&&Z(Y.group,Ze[ee].group);ee++)z++;if(Vt(),p||c.isTouch||at==="multi")if(W.hasAll([L,z+1])){let ee=W;for(let Q=L;Q<=z;Q++)ee=ee.remove(Q);Ct(ee,void 0,p)}else Ct(void 0,[L,z+1],p);else Ct(it.fromSingleSelection([L,z+1]),void 0,p)},[de,Vt,I.columns,Ze,x,Ct,at]),No=s.useRef(!1),Nr=s.useCallback(async c=>{if(ze!==void 0&&Jt!==void 0){const p=sn.current.y,k=sn.current.height;let M=ze({x:c,y:p,width:1,height:Math.min(k,Ie-p)},je.current.signal);typeof M!="object"&&(M=await M());const W=wn[c-x],L=document.createElement("canvas").getContext("2d",{alpha:!1});if(L!==null){L.font=Et.baseFontFull;const z=ys(L,Et,W,0,M,Kn,Do,!1,_t);Jt==null||Jt(W,z.width,c,z.width)}}},[wn,ze,Do,Et,Kn,Jt,x,Ie,_t]),[Ws,Ci]=s.useState(),Oo=s.useCallback(async(c,p)=>{var z,O;const k=(z=c.current)==null?void 0:z.range;if(k===void 0||ze===void 0||p.current===void 0)return;const M=p.current.range;if(N!==void 0){let G=!1;if(N({fillDestination:{...M,x:M.x-x},patternSource:{...k,x:k.x-x},preventDefault:()=>G=!0}),G)return}let W=ze(k,je.current.signal);typeof W!="object"&&(W=await W());const Y=W,L=[];for(let G=0;G<M.width;G++)for(let Z=0;Z<M.height;Z++){const ee=[M.x+G,M.y+Z];if(ls(ee,k))continue;const Q=Y[Z%k.height][G%k.width];Go(Q)||!Yo(Q)||L.push({location:ee,value:{...Q}})}bn(L),(O=$t.current)==null||O.damage(L.map(G=>({cell:G.location})))},[ze,bn,N,x]),fl=s.useCallback(()=>{if(I.current===void 0||I.current.range.width<=1)return;const c={...I,current:{...I.current,range:{...I.current.range,width:1}}};Oo(c,I)},[Oo,I]),hl=s.useCallback(()=>{if(I.current===void 0||I.current.range.height<=1)return;const c={...I,current:{...I.current,range:{...I.current.range,height:1}}};Oo(c,I)},[Oo,I]),$s=s.useCallback((c,p)=>{var Z,ee;const k=d;if(f(void 0),gi(void 0),Ci(void 0),fr.current=!1,p)return;if((k==null?void 0:k.fillHandle)===!0&&I.current!==void 0&&((Z=k.previousSelection)==null?void 0:Z.current)!==void 0){if(go===void 0)return;const Q={...I,current:{...I.current,range:xs(k.previousSelection.current.range,go)}};Oo(k.previousSelection,Q),At(Q,!0);return}const[M,W]=c.location,[Y,L]=wo.current??[],z=()=>{No.current=!0},O=Q=>{var He,Qe,Be;const Ge=Q.isTouch||Y===M&&L===W;if(Ge&&(T==null||T([M-x,W],{...Q,preventDefault:z})),Q.button===1)return!No.current;if(!No.current){const ye=an(c.location),Se=_t(ye);if(Se!==void 0&&Se.onClick!==void 0&&Ge){const me=Se.onClick({...Q,cell:ye,posX:Q.localEventX,posY:Q.localEventY,bounds:Q.bounds,theme:dr(ye,c.location),preventDefault:z});me!==void 0&&!Go(me)&&Xo(me)&&(bn([{location:Q.location,value:me}]),(He=$t.current)==null||He.damage([{cell:Q.location}]))}if(No.current||I.current===void 0)return!1;let rt=!1;switch(ye.activationBehaviorOverride??U){case"double-click":case"second-click":{if(((Be=(Qe=k==null?void 0:k.previousSelection)==null?void 0:Qe.current)==null?void 0:Be.cell)===void 0)break;const[me,ut]=I.current.cell,[Ht,tn]=k.previousSelection.current.cell;rt=M===me&&M===Ht&&W===ut&&W===tn&&(Q.isDoubleClick===!0||U==="second-click");break}case"single-click":{rt=!0;break}}if(rt){const ut={inputType:"pointer",pointerActivation:Q.isDoubleClick===!0?"double-click":ye.activationBehaviorOverride??U,pointerType:Q.isTouch?"touch":"mouse"};return P==null||P([M-x,W],ut),cr(Q.bounds,ut),!0}}return!1},G=c.location[0]-x;if(c.isTouch){const Q=sn.current,Ge=dl.current;if(Q.x!==Ge.x||Q.y!==Ge.y)return;if(c.isLongTouch===!0){if(c.kind==="cell"&&vr((ee=I.current)==null?void 0:ee.cell,c.location)){fe==null||fe([G,c.location[1]],{...c,preventDefault:z});return}else if(c.kind==="header"&&I.columns.hasIndex(M)){ae==null||ae(G,{...c,preventDefault:z});return}else if(c.kind===Sn){if(G<0)return;V==null||V(G,{...c,preventDefault:z});return}}c.kind==="cell"?O(c)||ur(c):c.kind===Sn?q==null||q(G,{...c,preventDefault:z}):(c.kind===to&&(D==null||D(G,{...c,preventDefault:z})),ur(c));return}if(c.kind==="header"){if(G<0)return;c.isEdge?c.isDoubleClick===!0&&Nr(M):c.button===0&&M===Y&&W===L&&(D==null||D(G,{...c,preventDefault:z}))}if(c.kind===Sn){if(G<0)return;c.button===0&&M===Y&&W===L&&(q==null||q(G,{...c,preventDefault:z}),No.current||ul(c))}c.kind==="cell"&&(c.button===0||c.button===1)&&O(c),wo.current=void 0},[d,I,x,go,Oo,At,T,an,_t,U,dr,bn,P,cr,fe,ae,V,ur,q,D,Nr,ul]),Ns=s.useCallback(c=>{const p={...c,location:[c.location[0]-x,c.location[1]]};Ae==null||Ae(p),d!==void 0&&c.buttons===0&&(f(void 0),gi(void 0),Ci(void 0),fr.current=!1),Ci(k=>{var M;return fr.current?[c.scrollEdge[0],0]:c.scrollEdge[0]===(k==null?void 0:k[0])&&c.scrollEdge[1]===k[1]?k:d===void 0||(((M=yn.current)==null?void 0:M.location[0])??0)<x?void 0:c.scrollEdge})},[d,Ae,x]),Os=s.useCallback((c,p)=>{le==null||le(c-x,p)},[le,x]),Xs=s.useCallback((c,p)=>{gt==null||gt(c-x,p)},[gt,x]);s.useEffect(()=>{if(r===void 0)return;const c=M=>{const W=[];let Y=M.parentElement;for(;Y&&Y!==document.documentElement;){const L=window.getComputedStyle(Y),z=L.overflow+L.overflowY+L.overflowX;(z.includes("scroll")||z.includes("auto"))&&W.push(Y),Y=Y.parentElement}return W},p=M=>{const W=M.target;ct.current&&!ct.current.contains(W)&&i(void 0)},k=[];if(ct.current){const M=c(ct.current);k.push(...M)}return k.forEach(M=>{M.addEventListener("scroll",p)}),window.addEventListener("scroll",p),document.addEventListener("scroll",p,!0),()=>{k.forEach(M=>{M.removeEventListener("scroll",p)}),window.removeEventListener("scroll",p),document.removeEventListener("scroll",p,!0)}},[r,i,ct]);const Tn=(Cl=I==null?void 0:I.current)==null?void 0:Cl.cell,Ys=s.useCallback((c,p,k,M,W,Y)=>{if(zr.current=!1,r!==void 0){const Z=sn.current;(Z.x!==c.x||Z.y!==c.y)&&i(void 0)}let L=Tn;L!==void 0&&(L=[L[0]-x,L[1]]);const z=Dt===0?void 0:{x:0,y:c.y,width:Dt,height:c.height},O=[];z!==void 0&&O.push(z),Je>0&&(O.push({x:c.x-x,y:Ie-Je,width:c.width,height:Je}),Dt>0&&O.push({x:0,y:Ie-Je,width:Dt,height:Je}));const G={x:c.x-x,y:c.y,width:c.width,height:K&&c.y+c.height>=Ie?c.height-1:c.height,tx:W,ty:Y,extras:{selected:L,freezeRegion:z,freezeRegions:O}};sn.current=G,ll(G),fo([p,k,M]),jt==null||jt(G,G.tx,G.ty,G.extras)},[Tn,r,x,K,Ie,Dt,Je,i,ll,jt]),Gs=eo(A,s.useCallback((c,p)=>(A==null?void 0:A(c-x,p-x))!==!1,[A,x])),_s=eo(lt,s.useCallback((c,p)=>{lt==null||lt(c-x,p-x),de!=="none"&&Ct(it.fromSingleSelection(p),void 0,!0)},[de,lt,x,Ct])),xi=s.useRef(!1),Us=s.useCallback(c=>{if(c.location[0]===0&&x>0){c.preventDefault();return}nt==null||nt({...c,location:[c.location[0]-x,c.location[1]]}),c.defaultPrevented()||(xi.current=!0),f(void 0)},[nt,x]),Ks=s.useCallback(()=>{xi.current=!1},[]),gl=Le==null?void 0:Le.selectionBehavior,Or=s.useCallback(c=>{if(gl!=="block-spanning")return;const{isGroupHeader:p,path:k,groupRows:M}=mo(c);if(p)return[c,c];const W=k[k.length-1],Y=c-W,L=c+M-W-1;return[Y,L]},[mo,gl]),ki=s.useRef(void 0),Si=s.useCallback(c=>{var p,k,M;if(!Es(c,ki.current)&&(ki.current=c,!(((p=yn==null?void 0:yn.current)==null?void 0:p.button)!==void 0&&yn.current.button>=1))){if(c.buttons!==0&&d!==void 0&&((k=yn.current)==null?void 0:k.location[0])===0&&x===1&&we==="multi"&&d.previousSelection&&!d.previousSelection.rows.hasIndex(yn.current.location[1])&&I.rows.hasIndex(yn.current.location[1])){const W=Math.min(yn.current.location[1],c.location[1]),Y=Math.max(yn.current.location[1],c.location[1])+1;bt(it.fromSingleSelection([W,Y]),void 0,!1)}else if(c.buttons!==0&&d!==void 0&&I.current!==void 0&&!xi.current&&!fr.current&&(Mt==="rect"||Mt==="multi-rect")){const[W,Y]=I.current.cell;let[L,z]=c.location;if(z<0&&(z=sn.current.y),d.fillHandle===!0&&((M=d.previousSelection)==null?void 0:M.current)!==void 0){const O=d.previousSelection.current.range;z=Math.min(z,K?Ie-1:Ie);const G=$c(O,L,z,Ut);gi(G)}else{if(K&&Y===Ie)return;if(K&&z===Ie)if(c.kind===ii)z--;else return;L=Math.max(L,x);const Z=Or(Y);z=Z===void 0?z:vn(z,Z[0],Z[1]);const ee=L-W,Q=z-Y,Ge={x:ee>=0?W:L,y:Q>=0?Y:z,width:Math.abs(ee)+1,height:Math.abs(Q)+1};St({...I.current,range:Ge},!0,!1,"drag")}}xt==null||xt({...c,location:[c.location[0]-x,c.location[1]]})}},[d,x,we,I,Mt,xt,bt,K,Ie,Ut,Or,St]),Vs=s.useCallback(()=>{var L,z;const c=ki.current;if(c===void 0)return;const[p,k]=c.scrollEdge;let[M,W]=c.location;const Y=sn.current;p===-1?M=((z=(L=Y.extras)==null?void 0:L.freezeRegion)==null?void 0:z.x)??Y.x:p===1&&(M=Y.x+Y.width),k===-1?W=Math.max(0,Y.y):k===1&&(W=Math.min(Ie-1,Y.y+Y.height)),M=vn(M,0,Ze.length-1),W=vn(W,0,Ie-1),Si({...c,location:[M,W]})},[Ze.length,Si,Ie]);qd(Ws,ct,Vs);const kn=s.useCallback(c=>{if(I.current===void 0)return;const[p,k]=c,[M,W]=I.current.cell,Y=I.current.range;let L=Y.x,z=Y.x+Y.width,O=Y.y,G=Y.y+Y.height;const[Z,ee]=Or(W)??[0,Ie-1],Q=ee+1;if(k!==0)switch(k){case 2:{G=Q,O=W,It(0,G,"vertical");break}case-2:{O=Z,G=W+1,It(0,O,"vertical");break}case 1:{O<W?(O++,It(0,O,"vertical")):(G=Math.min(Q,G+1),It(0,G,"vertical"));break}case-1:{G>W+1?(G--,It(0,G,"vertical")):(O=Math.max(Z,O-1),It(0,O,"vertical"));break}default:xr()}if(p!==0)if(p===2)z=Ze.length,L=M,It(z-1-x,0,"horizontal");else if(p===-2)L=x,z=M+1,It(L-x,0,"horizontal");else{let Ge=[];if(ze!==void 0){const He=ze({x:L,y:O,width:z-L-x,height:G-O},je.current.signal);typeof He=="object"&&(Ge=iu(He))}if(p===1){let He=!1;if(L<M){if(Ge.length>0){const Qe=po(L+1,M+1).find(Be=>!Ge.includes(Be-x));Qe!==void 0&&(L=Qe,He=!0)}else L++,He=!0;He&&It(L,0,"horizontal")}He||(z=Math.min(Ze.length,z+1),It(z-1-x,0,"horizontal"))}else if(p===-1){let He=!1;if(z>M+1){if(Ge.length>0){const Qe=po(z-1,M,-1).find(Be=>!Ge.includes(Be-x));Qe!==void 0&&(z=Qe,He=!0)}else z--,He=!0;He&&It(z-x,0,"horizontal")}He||(L=Math.max(x,L-1),It(L-x,0,"horizontal"))}else xr()}St({cell:I.current.cell,range:{x:L,y:O,width:z-L,height:G-O}},!0,!1,"keyboard-select")},[ze,Or,I,Ze.length,x,Ie,It,St]),Mi=s.useRef(Zo);Mi.current=Zo;const jn=s.useCallback((c,p,k,M)=>{const W=Nt-(k?0:1);c=vn(c,x,wn.length-1+x),p=vn(p,0,W);const Y=Tn==null?void 0:Tn[0],L=Tn==null?void 0:Tn[1];if(c===Y&&p===L)return!1;if(M&&I.current!==void 0){const z=[...I.current.rangeStack];(I.current.range.width>1||I.current.range.height>1)&&z.push(I.current.range),At({...I,current:{cell:[c,p],range:{x:c,y:p,width:1,height:1},rangeStack:z}},!0)}else St({cell:[c,p],range:{x:c,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===c&&u.current[1]===p&&(u.current=void 0),Mi.current&&It(c-x,p,"both",0,20),!0},[Nt,x,wn.length,Tn,I,It,At,St]),qs=s.useCallback((c,p)=>{(r==null?void 0:r.cell)!==void 0&&c!==void 0&&Xo(c)&&(bn([{location:r.cell,value:c}]),window.requestAnimationFrame(()=>{var W;(W=$t.current)==null||W.damage([{cell:r.cell}])})),Vt(!0),i(void 0);const[k,M]=p;if(I.current!==void 0&&(k!==0||M!==0)){const W=I.current.cell[1]===Nt-1;if(W&&M===1){F==null||F(c,[0,0]);return}const Y=I.current.cell[0]===Ze.length-1&&c!==void 0;let L=!0;if(W&&M===1&&xe!==void 0){L=!1;const z=I.current.cell[0]+k,O=Wo(z);Vn(O??z,!1)}if(Y&&k===1&&We!==void 0){L=!1;const z=I.current.cell[1]+M;$r(z,!1)}if(L){let z=I.current.cell[0]+k,O=I.current.cell[1]+M,G=!1;so&&k===1&&M===0?z>=Ze.length?O>=Nt-1?(z=I.current.cell[0],O=I.current.cell[1],G=!1):(z=x,O+=1,G=!0):G=!0:(z=vn(z,x,Ze.length-1),O=vn(O,0,Nt-1),G=so===!0&&k===0&&M===1),jn(z,O,W,!1),G&&window.setTimeout(()=>{var ee;const Z=R([z-x,O]);if(Yo(Z)){const Q=(ee=$t.current)==null?void 0:ee.getBounds(z,O);if(Q&&Z.allowOverlay){const Ge={inputType:"keyboard",key:"Enter"};P==null||P([z-x,O],Ge),Bo({target:Q,content:Z,initialValue:void 0,cell:[z,O],highlight:!0,forceEditMode:!0,activation:Ge})}}},50)}}F==null||F(c,p)},[r==null?void 0:r.cell,Vt,I,F,bn,Nt,jn,Ze.length,Vn,$r,xe,We,Wo,R,x,P,Bo,so]),js=s.useMemo(()=>`gdg-overlay-${ru++}`,[]),bo=s.useCallback(c=>{var k,M,W,Y;Vt();const p=[];for(let L=c.x;L<c.x+c.width;L++)for(let z=c.y;z<c.y+c.height;z++){const O=R([L-x,z]);if(!O.allowOverlay&&O.kind!==ne.Boolean)continue;let G;if(O.kind===ne.Custom){const Z=_t(O),ee=(k=Z==null?void 0:Z.provideEditor)==null?void 0:k.call(Z,{...O,location:[L-x,z]});(Z==null?void 0:Z.onDelete)!==void 0?G=Z.onDelete(O):ka(ee)&&(G=(M=ee==null?void 0:ee.deletedValue)==null?void 0:M.call(ee,O))}else if(Xo(O)&&O.allowOverlay||O.kind===ne.Boolean){const Z=_t(O);G=(W=Z==null?void 0:Z.onDelete)==null?void 0:W.call(Z,O)}G!==void 0&&!Go(G)&&Xo(G)&&p.push({location:[L,z],value:G})}bn(p),(Y=$t.current)==null||Y.damage(p.map(L=>({cell:L.location})))},[Vt,R,_t,bn,x]),hr=r!==void 0,ml=s.useCallback(c=>{var ye,Se,rt;const p=()=>{c.stopPropagation(),c.preventDefault()},k={didMatch:!1},{bounds:M}=c,W=I.columns,Y=I.rows,L=En;if(!hr&&Oe(L.clear,c,k)){const me=((ye=I.current)==null?void 0:ye.cell)??[x,0];At({columns:it.empty(),rows:it.empty(),current:{cell:me,range:{x:me[0],y:me[1],width:1,height:1},rangeStack:[]}},!1),zt==null||zt(),Vt()}else if(!hr&&Oe(L.selectAll,c,k))At({columns:it.empty(),rows:it.empty(),current:{cell:((Se=I.current)==null?void 0:Se.cell)??[x,0],range:{x,y:0,width:C.length,height:Ie},rangeStack:[]}},!1);else if(Oe(L.search,c,k))(rt=a==null?void 0:a.current)==null||rt.focus({preventScroll:!0}),Ve(!0);else if(Oe(L.delete,c,k)){const me=(Gt==null?void 0:Gt(I))??!0;if(me!==!1){const ut=me===!0?I:me;if(ut.current!==void 0){bo(ut.current.range);for(const Ht of ut.current.rangeStack)bo(Ht)}for(const Ht of ut.rows)bo({x,y:Ht,width:C.length,height:1});for(const Ht of ut.columns)bo({x:Ht,y:0,width:1,height:Ie})}}if(k.didMatch)return p(),!0;if(I.current===void 0)return!1;let[z,O]=I.current.cell;const[,G]=I.current.cell;let Z=!1,ee=!1;if(Oe(L.scrollToSelectedCell,c,k))Gr.current(z-x,O);else if(de!=="none"&&Oe(L.selectColumn,c,k))W.hasIndex(z)?Ct(W.remove(z),void 0,!0):de==="single"?Ct(it.fromSingleSelection(z),void 0,!0):Ct(void 0,z,!0);else if(we!=="none"&&Oe(L.selectRow,c,k))Y.hasIndex(O)?bt(Y.remove(O),void 0,!0):we==="single"?bt(it.fromSingleSelection(O),void 0,!0):bt(void 0,O,!0);else if(!hr&&M!==void 0&&Oe(L.activateCell,c,k))if(O===Ie&&K)window.setTimeout(()=>{const me=Wo(z);Vn(me??z)},0);else{const me={inputType:"keyboard",key:c.key};P==null||P([z-x,O],me),cr(M,me)}else if(I.current.range.height>1&&Oe(L.downFill,c,k))hl();else if(I.current.range.width>1&&Oe(L.rightFill,c,k))fl();else if(Oe(L.goToNextPage,c,k))O+=Math.max(1,sn.current.height-4);else if(Oe(L.goToPreviousPage,c,k))O-=Math.max(1,sn.current.height-4);else if(Oe(L.goToFirstCell,c,k))i(void 0),O=0,z=0;else if(Oe(L.goToLastCell,c,k))i(void 0),O=Number.MAX_SAFE_INTEGER,z=Number.MAX_SAFE_INTEGER;else if(Oe(L.selectToFirstCell,c,k))i(void 0),kn([-2,-2]);else if(Oe(L.selectToLastCell,c,k))i(void 0),kn([2,2]);else if(hr)Oe(L.closeOverlay,c,k)&&i(void 0),Oe(L.acceptOverlayDown,c,k)&&(i(void 0),O++),Oe(L.acceptOverlayUp,c,k)&&(i(void 0),O--),Oe(L.acceptOverlayLeft,c,k)&&(i(void 0),z--),Oe(L.acceptOverlayRight,c,k)&&(i(void 0),z++);else{if(Oe(L.goDownCell,c,k))O+=1;else if(Oe(L.goUpCell,c,k))O-=1;else if(Oe(L.goRightCell,c,k)){const me=c.key==="Tab"&&!c.shiftKey;if(so===!0&&me){const ut=Ze.length-1;z>=ut?O<Nt-1&&(z=x,O+=1):z+=1}else z+=1}else Oe(L.goLeftCell,c,k)?z-=1:Oe(L.goDownCellRetainSelection,c,k)?(O+=1,Z=!0):Oe(L.goUpCellRetainSelection,c,k)?(O-=1,Z=!0):Oe(L.goRightCellRetainSelection,c,k)?(z+=1,Z=!0):Oe(L.goLeftCellRetainSelection,c,k)?(z-=1,Z=!0):Oe(L.goToLastRow,c,k)?O=Ie-1:Oe(L.goToFirstRow,c,k)?O=Number.MIN_SAFE_INTEGER:Oe(L.goToLastColumn,c,k)?z=Number.MAX_SAFE_INTEGER:Oe(L.goToFirstColumn,c,k)?z=Number.MIN_SAFE_INTEGER:(Mt==="rect"||Mt==="multi-rect")&&(Oe(L.selectGrowDown,c,k)?kn([0,1]):Oe(L.selectGrowUp,c,k)?kn([0,-1]):Oe(L.selectGrowRight,c,k)?kn([1,0]):Oe(L.selectGrowLeft,c,k)?kn([-1,0]):Oe(L.selectToLastRow,c,k)?kn([0,2]):Oe(L.selectToFirstRow,c,k)?kn([0,-2]):Oe(L.selectToLastColumn,c,k)?kn([2,0]):Oe(L.selectToFirstColumn,c,k)&&kn([-2,0]));ee=k.didMatch}if(xn!==void 0&&xn!=="normal"&&O!==G){const me=xn==="skip-up"||xn==="skip"||xn==="block",ut=xn==="skip-down"||xn==="skip"||xn==="block",Ht=O<G;if(Ht&&me){for(;O>=0&&mo(O).isGroupHeader;)O--;O<0&&(O=G)}else if(!Ht&&ut){for(;O<Ie&&mo(O).isGroupHeader;)O++;O>=Ie&&(O=G)}}const Ge=jn(z,O,!1,Z),He=k.didMatch,Qe=c.key==="Tab";return He&&(Ge||!ee||io||so===!0&&Qe)&&p(),He},[xn,hr,I,En,de,we,Mt,x,mo,Ie,jn,At,zt,C.length,Gt,io,bo,Ct,bt,K,Wo,Vn,P,cr,hl,fl,kn,so,Ze.length,Nt]),gr=s.useCallback(c=>{let p=!1;Me!==void 0&&Me({...c,...c.location&&{location:[c.location[0]-x,c.location[1]]},cancel:()=>{p=!0}}),!p&&(ml(c)||I.current)},[_e,Me,ml,I,R,x,Ie,K,P,cr]),Zs=s.useCallback((c,p)=>{const k=c.location[0]-x;if(c.kind==="header"&&(ae==null||ae(k,{...c,preventDefault:p})),c.kind===Sn){if(k<0)return;V==null||V(k,{...c,preventDefault:p})}if(c.kind==="cell"){const[M,W]=c.location;fe==null||fe([k,W],{...c,preventDefault:p}),Oa(I,c.location)||jn(M,W,!1,!1)}},[I,fe,V,ae,x,jn]),Ri=s.useCallback(async c=>{var L,z,O;if(!En.paste)return;function p(G,Z,ee,Q){var He,Qe;const Ge=typeof ee=="object"?(ee==null?void 0:ee.join(`
`))??"":(ee==null?void 0:ee.toString())??"";if(!Go(G)&&Yo(G)&&G.readonly!==!0){const Be=H==null?void 0:H(Ge,G);if(Be!==void 0&&Xo(Be))return{location:Z,value:Be};const ye=_t(G);if(ye===void 0)return;if(ye.kind===ne.Custom){cn(G.kind===ne.Custom);const Se=(He=ye.onPaste)==null?void 0:He.call(ye,Ge,G.data);return Se===void 0?void 0:{location:Z,value:{...G,data:Se}}}else{const Se=(Qe=ye.onPaste)==null?void 0:Qe.call(ye,Ge,G,{formatted:Q,formattedString:typeof Q=="string"?Q:Q==null?void 0:Q.join(`
`),rawValue:ee});return Se===void 0?void 0:(cn(Se.kind===G.kind),{location:Z,value:Se})}}}const k=I.columns,M=I.rows,W=((L=ct.current)==null?void 0:L.contains(document.activeElement))===!0||((z=l.current)==null?void 0:z.contains(document.activeElement))===!0;let Y;if(I.current!==void 0?Y=[I.current.range.x,I.current.range.y]:k.length===1?Y=[k.first()??0,0]:M.length===1&&(Y=[x,M.first()??0]),W&&Y!==void 0){let G,Z;const ee="text/plain",Q="text/html";if(navigator.clipboard.read!==void 0){const Be=await navigator.clipboard.read();for(const ye of Be){if(ye.types.includes(Q)){const rt=await(await ye.getType(Q)).text(),me=Yl(rt);if(me!==void 0){G=me;break}}ye.types.includes(ee)&&(Z=await(await ye.getType(ee)).text())}}else if(navigator.clipboard.readText!==void 0)Z=await navigator.clipboard.readText();else if(c!==void 0&&(c==null?void 0:c.clipboardData)!==null){if(c.clipboardData.types.includes(Q)){const Be=c.clipboardData.getData(Q);G=Yl(Be)}G===void 0&&c.clipboardData.types.includes(ee)&&(Z=c.clipboardData.getData(ee))}else return;const[Ge,He]=Y,Qe=[];do{if(Ue===void 0){const Be=an(Y),ye=Z??(G==null?void 0:G.map(rt=>rt.map(me=>me.rawValue).join("	")).join("	"))??"",Se=p(Be,Y,ye,void 0);Se!==void 0&&Qe.push(Se);break}if(G===void 0){if(Z===void 0)return;G=Xd(Z)}if(Ue===!1||typeof Ue=="function"&&(Ue==null?void 0:Ue([Y[0]-x,Y[1]],G.map(Be=>Be.map(ye=>{var Se;return((Se=ye.rawValue)==null?void 0:Se.toString())??""}))))!==!0)return;for(const[Be,ye]of G.entries()){if(Be+He>=Ie)break;for(const[Se,rt]of ye.entries()){const me=[Se+Ge,Be+He],[ut,Ht]=me;if(ut>=Ze.length||Ht>=Nt)continue;const tn=an(me),pn=p(tn,me,rt.rawValue,rt.formatted);pn!==void 0&&Qe.push(pn)}}}while(!1);bn(Qe),(O=$t.current)==null||O.damage(Qe.map(Be=>({cell:Be.location})))}},[H,_t,an,I,En.paste,ct,Ze.length,bn,Nt,Ue,x,Ie]);Qt("paste",Ri,m,!1,!0);const mr=s.useCallback(async(c,p)=>{var L,z;if(!En.copy)return;const k=p===!0||((L=ct.current)==null?void 0:L.contains(document.activeElement))===!0||((z=l.current)==null?void 0:z.contains(document.activeElement))===!0,M=I.columns,W=I.rows,Y=(O,G)=>{if(!ot)_l(O,G,c);else{const Z=G.map(ee=>({kind:ne.Text,data:C[ee].title,displayData:C[ee].title,allowOverlay:!1}));_l([Z,...O],G,c)}};if(k&&ze!==void 0){if(I.current!==void 0){let O=ze(I.current.range,je.current.signal);typeof O!="object"&&(O=await O()),Y(O,po(I.current.range.x-x,I.current.range.x+I.current.range.width-x))}else if(W!==void 0&&W.length>0){const G=[...W].map(Z=>{const ee=ze({x,y:Z,width:C.length,height:1},je.current.signal);return typeof ee=="object"?ee[0]:ee().then(Q=>Q[0])});if(G.some(Z=>Z instanceof Promise)){const Z=await Promise.all(G);Y(Z,po(C.length))}else Y(G,po(C.length))}else if(M.length>0){const O=[],G=[];for(const Z of M){let ee=ze({x:Z,y:0,width:1,height:Ie},je.current.signal);typeof ee!="object"&&(ee=await ee()),O.push(ee),G.push(Z-x)}if(O.length===1)Y(O[0],G);else{const Z=O.reduce((ee,Q)=>ee.map((Ge,He)=>[...Ge,...Q[He]]));Y(Z,G)}}}},[C,ze,I,En.copy,x,ct,Ie,ot]);Qt("copy",mr,m,!1,!1);const Js=s.useCallback(async c=>{var k,M;if(!(!En.cut||!(((k=ct.current)==null?void 0:k.contains(document.activeElement))===!0||((M=l.current)==null?void 0:M.contains(document.activeElement))===!0))&&(await mr(c),I.current!==void 0)){let W={current:{cell:I.current.cell,range:I.current.range,rangeStack:[]},rows:it.empty(),columns:it.empty()};const Y=Gt==null?void 0:Gt(W);if(Y===!1||(W=Y===!0?W:Y,W.current===void 0))return;bo(W.current.range)}},[bo,I,En.cut,mr,ct,Gt]);Qt("cut",Js,m,!1,!1);const Qs=s.useCallback((c,p)=>{if(re!==void 0){x!==0&&(c=c.map(W=>[W[0]-x,W[1]])),re(c,p);return}if(c.length===0||p===-1)return;const[k,M]=c[p];u.current!==void 0&&u.current[0]===k&&u.current[1]===M||(u.current=[k,M],jn(k,M,!1,!1))},[re,x,jn]),[Xr,Yr]=((xl=vt==null?void 0:vt.current)==null?void 0:xl.cell)??[],Gr=s.useRef(It);Gr.current=It,s.useLayoutEffect(()=>{var c,p,k,M;Mi.current&&!zr.current&&Xr!==void 0&&Yr!==void 0&&(Xr!==((p=(c=kt.current)==null?void 0:c.current)==null?void 0:p.cell[0])||Yr!==((M=(k=kt.current)==null?void 0:k.current)==null?void 0:M.cell[1]))&&Gr.current(Xr,Yr),zr.current=!1},[Xr,Yr]);const wl=I.current!==void 0&&(I.current.cell[0]>=Ze.length||I.current.cell[1]>=Nt);s.useLayoutEffect(()=>{wl&&At(Ai,!1)},[wl,At]);const ea=s.useMemo(()=>K===!0&&(Ke==null?void 0:Ke.tint)===!0?it.fromSingleSelection(Nt-1):it.empty(),[Nt,K,Ke==null?void 0:Ke.tint]),ta=s.useCallback(c=>typeof Kt=="boolean"?Kt:(Kt==null?void 0:Kt(c-x))??!0,[x,Kt]),na=s.useMemo(()=>{if(pi===void 0||l.current===null)return null;const{bounds:c,group:p}=pi,k=l.current.getBoundingClientRect();return s.createElement(Dd,{bounds:c,group:p,canvasBounds:k,onClose:()=>vi(void 0),onFinish:M=>{vi(void 0),ce==null||ce(p,M)}})},[ce,pi]),oa=Math.min(Ze.length,Dt+x);s.useImperativeHandle(t,()=>({appendRow:(c,p)=>Vn(c+x,p),appendColumn:(c,p)=>$r(c,p),updateCells:c=>{var p;return x!==0&&(c=c.map(k=>({cell:[k.cell[0]+x,k.cell[1]]}))),(p=$t.current)==null?void 0:p.damage(c)},getBounds:(c,p)=>{var k;if(!((l==null?void 0:l.current)===null||(ct==null?void 0:ct.current)===null)){if(c===void 0&&p===void 0){const M=l.current.getBoundingClientRect(),W=M.width/ct.current.clientWidth;return{x:M.x-ct.current.scrollLeft*W,y:M.y-ct.current.scrollTop*W,width:ct.current.scrollWidth*W,height:ct.current.scrollHeight*W}}return(k=$t.current)==null?void 0:k.getBounds((c??0)+x,p)}},focus:()=>{var c;return(c=$t.current)==null?void 0:c.focus()},emit:async c=>{switch(c){case"delete":gr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":gr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":gr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await mr(void 0,!0);break;case"paste":await Ri();break}},scrollTo:It,remeasureColumns:c=>{for(const p of c)Nr(p+x)},getMouseArgsForPosition:(c,p,k)=>{if(($t==null?void 0:$t.current)===null)return;const M=$t.current.getMouseArgsForPosition(c,p,k);if(M!==void 0)return{...M,location:[M.location[0]-x,M.location[1]]}}}),[Vn,$r,Nr,ct,mr,gr,Ri,x,It]);const[bl,yl]=Tn??[],ra=s.useCallback(c=>{const[p,k]=c;if(k===-1){de!=="none"&&(Ct(it.fromSingleSelection(p),void 0,!1),Vt());return}bl===p&&yl===k||(St({cell:c,range:{x:p,y:k,width:1,height:1}},!0,!1,"keyboard-nav"),It(p,k))},[de,Vt,It,bl,yl,St,Ct]),[ia,la]=s.useState(!1),pl=s.useRef(Jl(c=>{la(c)},5)),sa=s.useCallback(()=>{pl.current(!0),I.current===void 0&&I.columns.length===0&&I.rows.length===0&&d===void 0&&St({cell:[x,Pr],range:{x,y:Pr,width:1,height:1}},!0,!1,"keyboard-select")},[Pr,I,d,x,St]),aa=s.useCallback(()=>{pl.current(!1)},[]),[ca,da]=s.useMemo(()=>{let c;const p=(Rt==null?void 0:Rt.scrollbarWidthOverride)??Bi(),k=Ie+(K?1:0);if(typeof gn=="number")c=ar+k*gn;else{let W=0;const Y=Math.min(k,10);for(let L=0;L<Y;L++)W+=gn(L);W=Math.floor(W/Y),c=ar+k*W}c+=p;const M=Ze.reduce((W,Y)=>Y.width+W,0)+p;return[`${Math.min(1e5,M)}px`,`${Math.min(1e5,c)}px`]},[Ze,Rt==null?void 0:Rt.scrollbarWidthOverride,gn,Ie,K,ar]),ua=s.useMemo(()=>tc(Et),[Et]);return s.createElement(bs.Provider,{value:Et},s.createElement(Ud,{style:ua,className:pe,inWidth:b??ca,inHeight:v??da},s.createElement(Ed,{fillHandle:Pe,drawFocusRing:Qo,experimental:Rt,fixedShadowX:Pt,fixedShadowY:Lt,getRowThemeOverride:hn,headerIcons:Ln,imageWindowLoader:Sr,initialSize:Yn,isDraggable:Bn,onDragLeave:Wn,onRowMoved:Rn,overscrollX:hi,overscrollY:zo,preventDiagonalScrolling:ko,rightElement:So,rightElementProps:Mo,smoothScrollX:lo,smoothScrollY:Gn,className:pe,enableGroups:nl,onCanvasFocused:sa,onCanvasBlur:aa,canvasRef:l,onContextMenu:Zs,theme:Et,cellXOffset:Ps,cellYOffset:Pr,accessibilityHeight:ho.height,onDragEnd:Ks,columns:Ze,nonGrowWidth:tl,drawHeader:ht,onColumnProposeMove:Gs,drawCell:Hn,disabledRows:ea,freezeColumns:oa,lockColumns:x,firstColAccessible:x===0,getCellContent:an,minColumnWidth:Kn,maxColumnWidth:Do,searchInputRef:a,showSearch:be,onSearchClose:Bt,highlightRegions:Ls,getCellsForSelection:ze,getGroupDetails:mi,headerHeight:Ao,isFocused:ia,groupHeaderHeight:nl?lr:0,groupLevels:sr,groupHeaderHeights:ol,freezeTrailingRows:Je+(K&&(Ke==null?void 0:Ke.sticky)===!0?1:0),hasAppendRow:K,onColumnResize:Jt,onColumnResizeEnd:mn,onColumnResizeStart:In,onCellFocused:ra,onColumnMoved:_s,onDragStart:Us,onHeaderMenuClick:Os,onHeaderIndicatorClick:Xs,onItemHovered:Si,isFilling:(d==null?void 0:d.fillHandle)===!0,onMouseMove:Ns,onKeyDown:gr,onKeyUp:ue,onMouseDown:Bs,onMouseUp:$s,onDragOverCell:Pn,onDrop:Re,onSearchResultsChanged:Qs,onVisibleRegionChanged:Ys,clientSize:Po,rowHeight:gn,searchResults:Ce,searchValue:j,onSearchValueChange:ie,rows:Nt,scrollRef:ct,selection:I,translateX:ho.tx,translateY:ho.ty,verticalBorder:ta,gridRef:$t,getCellRenderer:_t,resizeIndicator:di}),na,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(ou,{...r,validateCell:Ft,bloom:$,id:js,getCellRenderer:_t,className:(Rt==null?void 0:Rt.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:yt,imageEditorOverride:g,portalElementRef:Ro,onFinishEditing:qs,markdownDivCreateNode:h,isOutsideClick:_n,customEventTarget:Rt==null?void 0:Rt.eventTarget}))))},su=s.forwardRef(lu);function Vl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:l,x:d,y:f}=r,u=t.maxSize??i.checkboxMaxSize,m=Math.floor(r.y+l/2),g=ns(u,l,i.cellVerticalPadding),w=ts(t.contentAlign??"center",d,a,i.cellHorizontalPadding,g),h=es(w,m,g),b=os(d+n,f+o,h);return _i(t)&&b}const au={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:ne.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>cu(e,e.cell.data,_i(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Vl(e)&&e.preventDefault()},onClick:e=>{if(Vl(e))return{...e.cell,data:Hs(e.cell.data)}},onPaste:(e,t)=>{let n=Jr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Gi),n===t.data?void 0:{...t,data:n}}};function cu(e,t,n,o,r){if(!n&&t===Jr)return;const{ctx:i,hoverAmount:a,theme:l,rect:d,highlighted:f,hoverX:u,hoverY:m,cell:{contentAlign:g}}=e,{x:w,y:h,width:b,height:v}=d;let C=!1;if(r>0){let y=n?1-r+r*a:.4;if(t===Jr&&(y*=a),y===0)return;y<1&&(C=!0,i.globalAlpha=y)}ni(i,l,t,w,h,b,v,f,u,m,o,g),C&&(i.globalAlpha=1)}const du=fn("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),uu=e=>{const{bubbles:t}=e;return s.createElement(du,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},fu={getAccessibilityString:e=>rs(e.data),kind:ne.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>hu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(uu,{bubbles:t.data})},onPaste:()=>{}};function hu(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:l,width:d,height:f}=n;let u=a+o.cellHorizontalPadding;const m=[];for(const g of t){if(u>a+d)break;const w=xo(g,r,o.baseFontFull).width;m.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const g of m)Dn(r,g.x,l+(f-o.bubbleHeight)/2,g.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[g,w]of m.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[g],w.x+o.bubblePadding,l+f/2+un(r,o))}const gu=fn("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),mu=e=>{const{drilldowns:t}=e;return s.createElement(gu,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},wu={getAccessibilityString:e=>rs(e.data.map(t=>t.text)),kind:ne.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>yu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(mu,{drilldowns:t.data})},onPaste:()=>{}},zi={};function bu(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,l=4,d=n*r,f=o+i,u=o*3,m=(u+i*2)*r,g=`${e},${t},${r},${n}`;if(zi[g]!==void 0)return{el:zi[g],height:d,width:m,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=m,w.height=d,h.scale(r,r),zi[g]=w,h.beginPath(),Dn(h,i,i,u,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Dn(h,i+.5,i+.5,u,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:d,width:m,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function yu(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:l}=e,{x:d,width:f}=n,u=o.baseFontFull,m=fs(r,u),g=Math.min(n.height,Math.max(16,Math.ceil(m*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-g)/2),h=g-10,b=o.bubblePadding,v=o.bubbleMargin;let C=d+o.cellHorizontalPadding;const y=o.roundingRadius??6,R=bu(o.bgCell,o.drilldownBorder,g,y),T=[];for(const P of t){if(C>d+f)break;const F=xo(P.text,r,u).width;let H=0;P.img!==void 0&&i.loadOrGetImage(P.img,a,l)!==void 0&&(H=h-8+4);const S=F+H+b*2;T.push({x:C,width:S}),C+=S+v}if(R!==null){const{el:P,height:N,middleWidth:F,sideWidth:H,width:S,dpr:X,padding:$}=R,D=H/X,A=$/X;for(const B of T){const te=Math.floor(B.x),q=Math.floor(B.width),fe=q-(D-A)*2;r.imageSmoothingEnabled=!1,r.drawImage(P,0,0,H,N,te-A,w,D,g),fe>0&&r.drawImage(P,H,0,F,N,te+(D-A),w,fe,g),r.drawImage(P,S-H,0,H,N,te+q-(D-A),w,D,g),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[P,N]of T.entries()){const F=t[P];let H=N.x+b;if(F.img!==void 0){const S=i.loadOrGetImage(F.img,a,l);if(S!==void 0){const X=h-8;let $=0,D=0,A=S.width,B=S.height;A>B?($+=(A-B)/2,A=B):B>A&&(D+=(B-A)/2,B=A),r.beginPath(),Dn(r,H,w+g/2-X/2,X,X,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(S,$,D,A,B,H,w+g/2-X/2,X,X),r.restore(),H+=X+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(F.text,H,w+g/2+un(r,o))}}const pu={getAccessibilityString:e=>e.data.join(", "),kind:ne.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>vu(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??Aa;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Pi=4;function vu(e,t,n,o){const{rect:r,col:i,row:a,theme:l,ctx:d,imageLoader:f}=e,{x:u,y:m,height:g,width:w}=r,h=g-l.cellVerticalPadding*2,b=[];let v=0;for(let y=0;y<t.length;y++){const R=t[y];if(R.length===0)continue;const T=f.loadOrGetImage(R,i,a);if(T!==void 0){b[y]=T;const P=T.width*(h/T.height);v+=P+Pi}}if(v===0)return;v-=Pi;let C=u+l.cellHorizontalPadding;o==="right"?C=Math.floor(u+w-l.cellHorizontalPadding-v):o==="center"&&(C=Math.floor(u+w/2-v/2));for(const y of b){if(y===void 0)continue;const R=y.width*(h/y.height);n>0&&(d.beginPath(),Dn(d,C,m+l.cellVerticalPadding,R,h,n),d.save(),d.clip()),d.drawImage(y,C,m+l.cellVerticalPadding,R,h),n>0&&d.restore(),C+=R+Pi}}function Cu(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const xu={getAccessibilityString:()=>"",kind:ne.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(Cu(n,o)*t.skeletonWidthVariability));const d=a.cellHorizontalPadding;l+d*2>=i.width&&(l=i.width-d*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);Dn(r,i.x+d,i.y+(i.height-f)/2,l,f,a.roundingRadius??3),r.fillStyle=oo(a.textDark,.1),r.fill()},onPaste:()=>{}},ku=()=>e=>e.targetWidth,ql=fn("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[ku(),"px"]}}),Su=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:l}=e,d=t.data,f=t.readonly===!0,[u,m]=s.useState(d===""||o),g=s.useCallback(()=>{m(h=>!h)},[]),w=d?"gdg-ml-6":"";return u?s.createElement(ql,{targetWidth:i.width-20},s.createElement(Vi,{autoFocus:!0,highlight:!1,validatedSelection:l,value:d,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${w}`,onClick:()=>a(t)},s.createElement(Ra,null))):s.createElement(ql,{targetWidth:i.width},s.createElement(Pa,{contents:d,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${w}`,onClick:g},s.createElement(Ui,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Mu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:li,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Xn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:l}=e;return s.createElement(Su,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:d=>t({...n,data:d.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Ru={getAccessibilityString:e=>e.row.toString(),kind:Ot.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Eu,measure:()=>44,draw:e=>Hu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e;if(n.disabled===!0)return;const{width:i,height:a}=t,l=n.drawHandle?7+(i-7)/2:i/2,d=a/2;if(Math.abs(o-l)<=10&&Math.abs(r-d)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Eu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=Iu,n.textAlign="center",i}function Iu(e){const{ctx:t}=e;t.textAlign="start"}function Hu(e,t,n,o,r,i,a){if(a){const{ctx:v,rect:C,theme:y}=e,{x:R,y:T,width:P,height:N}=C,F=o==="checkbox"?"checkbox-visible":o;if(F!=="number"&&(v.globalAlpha=n?1:.4,ni(v,y,n,r?R+7:R,T,r?P-7:P,N,!1,-20,-20,y.checkboxMaxSize,"center",i,!0),v.globalAlpha=1),F==="number"||F==="both"&&!n){const H=t.toString(),S=y.markerFontFull,X=R+P/2;v.fillStyle="#cccccc",v.font=S,v.fillText(H,X,T+N/2+un(v,S))}if(r){v.globalAlpha=.4,v.beginPath();for(const H of[3,6])for(const S of[-5,-1,3])v.rect(R+H,T+N/2+S,2,2);v.fillStyle="#cccccc",v.fill(),v.beginPath(),v.globalAlpha=1}return}const{ctx:l,rect:d,hoverAmount:f,theme:u}=e,{x:m,y:g,width:w,height:h}=d,b=n?1:o==="checkbox-visible"?.6+.4*f:f;if(o!=="number"&&b>0){l.globalAlpha=b;const v=7*(n?f:1);if(ni(l,u,n,r?m+v:m,g,r?w-v:w,h,!0,void 0,void 0,u.checkboxMaxSize,"center",i,a),r){l.globalAlpha=f,l.beginPath();for(const C of[3,6])for(const y of[-5,-1,3])l.rect(m+C,g+h/2+y,2,2);l.fillStyle=u.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const v=t.toString(),C=u.markerFontFull,y=m+w/2;o==="both"&&f!==0&&(l.globalAlpha=1-f),l.fillStyle=u.textLight,l.font=C,l.fillText(v,y,g+h/2+un(l,C)),f!==0&&(l.globalAlpha=1)}}const Tu={getAccessibilityString:()=>"",kind:Ot.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Du(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Du(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:l}=e,{x:d,y:f,width:u,height:m}=r;o.beginPath(),o.globalAlpha=i,o.rect(d+1,f+1,u,m-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let w=0;if(n!==void 0){const b=m-8,v=d+8/2,C=f+8/2;l.drawSprite(n,"normal",o,v,C,b,a,g?1:i),w=b}else{w=24;const h=12,b=g?h:i*h,v=g?0:(1-i)*h*.5,C=a.cellHorizontalPadding+4;b>0&&(o.moveTo(d+C+v,f+m/2),o.lineTo(d+C+v+b,f+m/2),o.moveTo(d+C+v+b*.5,f+m/2-b*.5),o.lineTo(d+C+v+b*.5,f+m/2+b*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,w+d+a.cellHorizontalPadding+.5,f+m/2+un(o,a)),o.beginPath()}function Fs(e,t,n,o,r,i,a){e.textBaseline="alphabetic";const l=Fu(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Dn(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??oo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function Fu(e,t,n,o,r){const i=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+a/2+1,width:t.width-i,height:t.height-a-1};const l=xo(n,e,o.baseFontFull,"alphabetic"),d=t.height-a,f=Math.min(d,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const Au=s.lazy(async()=>await Zl(()=>import("./number-overlay-editor-dt4XM6vg.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),zu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:li,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:a}=e,{hoverEffect:l,displayData:d,hoverEffectTheme:f}=n;l===!0&&t>0&&Fs(o,r,f,d,i,t,a),Xn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(Au,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Pu={getAccessibilityString:()=>"",measure:()=>108,kind:ne.Protected,needsHover:!1,needsHoverPosition:!1,draw:Lu,onPaste:()=>{}};function Lu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const l=2.5;let d=r+n.cellHorizontalPadding+l;const f=i+a/2,u=Math.cos(Il(30))*l,m=Math.sin(Il(30))*l;for(let g=0;g<12;g++)t.moveTo(d,f-l),t.lineTo(d,f+l),t.moveTo(d+u,f-m),t.lineTo(d-u,f+m),t.moveTo(d-u,f-m),t.lineTo(d+u,f+m),d+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Bu={getAccessibilityString:e=>e.rowId??"",kind:Ot.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>xo(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:r}=e,i=o.rowId;if(!i)return;t.fillStyle=r.textDark,t.font=r.baseFontStyle,t.textAlign="left";const a=n.x+r.cellHorizontalPadding,l=n.y+n.height/2;t.fillText(i,a,l+un(t,r))},onClick:()=>{},onPaste:()=>{}},Wu={getAccessibilityString:e=>e.rowId??"",kind:Ot.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:$u,measure:()=>80,draw:e=>Ou(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function $u(e,t){const{ctx:n}=e,o="12px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=Nu,n.textAlign="left",r}function Nu(e){const{ctx:t}=e;t.textAlign="start"}function Ou(e,t){if(!t)return;const{ctx:n,rect:o,theme:r}=e,{x:i,y:a,height:l}=o;n.fillStyle=r.textDark,n.font="12px sans-serif";const d=i+8,f=a+l/2;n.fillText(t,d,f+un(n,n.font))}const Xu={getAccessibilityString:e=>e.status??"",kind:Ot.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:Yu,measure:()=>40,draw:e=>_u(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function Yu(e,t){const{ctx:n}=e,o="bold 14px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=Gu,n.textAlign="center",r}function Gu(e){const{ctx:t}=e;t.textAlign="start"}function _u(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:r,y:i,width:a,height:l}=o,d={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=d[t],n.font="bold 14px sans-serif";const f=r+a/2,u=i+l/2;n.fillText(t,f,u+un(n,n.font))}const Uu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:li,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:l}=e,{displayData:d,contentAlign:f,hoverEffect:u,allowWrapping:m,hoverEffectTheme:g}=t;u===!0&&n>0&&Fs(r,a,g,d,i,n,l),Xn(e,d,f,m,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Vi,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Ku=fn("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),Vu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[l,d]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{d(!0)},[]);return l?s.createElement(Vi,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(Ku,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Ui,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function As(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:l}}function jl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=ds(a,i.baseFontFull);if(l===void 0)return!1;const d=As(l,n,i,t.contentAlign);return no({x:d.x-4,y:d.y-4,width:d.width+8,height:d.height+8},o,r)}const qu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ne.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:li,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:l}=e,d=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=xo(d,l,n.baseFontFull),m=As(u,a,n,t.contentAlign),{x:g,y:w,width:h,height:b}=m;if(r>=g-4&&r<=g-4+h+8&&i>=w-4&&i<=w-4+b+8){const v=un(l,n.baseFontFull);o("pointer");const C=5,y=w-v;l.beginPath(),l.moveTo(a.x+g,Math.floor(a.y+y+b+C)+.5),l.lineTo(a.x+g+h,Math.floor(a.y+y+b+C)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Xn({...e,rect:{...a,x:a.x-1}},d,t.contentAlign),Xn({...e,rect:{...a,x:a.x-2}},d,t.contentAlign),Xn({...e,rect:{...a,x:a.x+1}},d,t.contentAlign),Xn({...e,rect:{...a,x:a.x+2}},d,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Xn(e,d,t.contentAlign)},onSelect:e=>{jl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;jl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(Vu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},ju=[Ru,Tu,Xu,Wu,au,fu,wu,pu,xu,Mu,zu,Pu,Bu,Uu,qu],Li=[];class Zu extends gs{constructor(){super(...arguments);Ne(this,"imageLoaded",()=>{});Ne(this,"loadedLocations",[]);Ne(this,"cache",{});Ne(this,"sendLoaded",pa(()=>{this.imageLoaded(new Uo(this.loadedLocations)),this.loadedLocations=[]},20));Ne(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const l=r.cells[a];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const l=Li.pop()??new Image;let d=!1;const f={img:void 0,cells:[Mn(o,r)],url:n,cancel:()=>{d||(d=!0,Li.length<12?Li.unshift(l):a||(l.src=""))}},u=new Promise(m=>l.addEventListener("load",()=>m(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const m=this.cache[i];if(m!==void 0&&!d){m.img=l;for(const g of m.cells)this.loadedLocations.push(Zi(g));a=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const l=Mn(o,r);return a.cells.includes(l)||a.cells.push(l),a.img}else this.loadImage(n,o,r,i)}}const Ju=(e,t)=>{const n=s.useMemo(()=>({...zc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??ju,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new Zu,[e.imageWindowLoader]);return s.createElement(su,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},uf=s.forwardRef(Ju);export{Id as C,uf as D,ne as G,bs as T,Vi as a,fs as b,dn as c,cf as d,af as e,lf as f,un as g,Xo as h,sf as i,Ml as j,Go as k,ka as l,xo as m,tc as n,Vo as p,Dn as r,df as u};
