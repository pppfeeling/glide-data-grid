const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-CMpp4Kyr.js","./iframe-DDTcUdjc.js","./preload-helper-C1FmrZbK.js","./marked.esm-jmFFBRfF.js","./react-number-format.es-DGgnyrUu.js","./number-overlay-editor-DjcVbkae.css"])))=>i.map(i=>d[i]);
var Ui=Object.defineProperty;var Vi=(e,t,n)=>t in e?Ui(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ee=(e,t,n)=>Vi(e,typeof t!="symbol"?t+"":t,n);import{r as v,R as cn}from"./iframe-DDTcUdjc.js";import{h as ji,g as Ki,k as Gi,v as Ji,l as Qi,m as Mn,r as Zi,j as er,t as tr}from"./throttle-C2-49NaF.js";import{s as vt,a as nr}from"./marked.esm-jmFFBRfF.js";import{_ as or}from"./preload-helper-C1FmrZbK.js";function Qo(e="This should not happen"){throw new Error(e)}function yt(e,t="Assertion failed"){if(!e)return Qo(t)}function to(e,t){return Qo(t??"Hell froze over")}function bl(e,t){try{return e()}catch{return t}}const Fo=Object.prototype.hasOwnProperty;function jt(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&jt(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Fo.call(e,n)&&++o&&!Fo.call(t,n)||!(n in t)||!jt(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const In=null,no=void 0;var ce=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(ce||{}),ir=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp",e))(ir||{}),Vn=(e=>(e.Triangle="triangle",e.Dots="dots",e))(Vn||{});function yl(e){return"width"in e&&typeof e.width=="number"}async function vl(e){return typeof e=="object"?e:await e()}function rr(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function pl(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function Zo(e){return e.kind==="marker"||e.kind==="new-row"||e.kind==="row-status"}function sr(e){if(!rr(e)||e.kind==="image")return!1;switch(e.kind){case"text":case"number":case"markdown":case"uri":case"custom":case"boolean":return e.readonly!==!0;default:to(e,"A cell was passed with an invalid kind")}}function wl(e){return ji(e,"editor")}function oo(e){return!(e.readonly??!1)}var Mt=(e=>(e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id",e))(Mt||{});const En={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Nn(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Ho;const $e=class $e{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new $e(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Nn([...this.items,n]);return new $e(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const c=[];s<o&&c.push([s,o]),i<a&&c.push([i,a]),n.splice(r,1,...c)}}return new $e(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};ee($e,"create",t=>new $e(Nn(t))),ee($e,"empty",()=>Ho??(Ho=new $e([]))),ee($e,"fromSingleSelection",t=>$e.empty().add(t)),ee($e,"fromArray",t=>{if(t.length===0)return $e.empty();const n=t.map(i=>[i,i+1]),o=Nn(n);return new $e(o)});let jn=$e;function ut(e,t,n,o,i=!1){const r=v.useRef();r.current=t,v.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var c;(c=r.current)==null||c.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function kl(e,t){return e===void 0?void 0:t}const lr=Math.PI;function Bo(e){return e*lr/180}const ei=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ti=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},ni=(e,t,n)=>Math.min(e,t-n*2),oi=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,io=e=>{const t=e.fgColor??"currentColor";return v.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},v.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),v.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},ar=e=>{const t=e.fgColor??"currentColor";return v.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},v.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function cr(e,t,n){const[o,i]=v.useState(e),r=v.useRef(!0);v.useEffect(()=>()=>{r.current=!1},[]);const l=v.useRef(Ki(s=>{r.current&&i(s)},n));return v.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const dr="֑-߿יִ-﷽ﹰ-ﻼ",ur="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",fr=new RegExp("^[^"+ur+"]*["+dr+"]");function ro(e){return fr.test(e)?"rtl":"not-rtl"}let kn;function Po(){if(typeof document>"u")return 0;if(kn!==void 0)return kn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),kn=n-o,kn}const Tt=Symbol();function xl(e){const t=v.useRef([Tt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=v.useState(e),[,i]=v.useState(),r=v.useCallback(s=>{const a=t.current[0];a!==Tt&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Tt&&i({}),o(c=>typeof s=="function"?s(a===Tt?c:a):s),t.current[0]=Tt)},[]),l=v.useCallback(()=>{t.current[0]=Tt,i({})},[]);return[t.current[0]===Tt?n:t.current[0],r,l]}function ii(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Sl(e){const t=v.useRef(e);return jt(e,t.current)||(t.current=e),t.current}function hr(e,t){return cn.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function Cl(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(Sn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function Lt(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Kn(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function gr(e,t){const n=Lt(e),o=Lt(t);return n===o}function Gn(e,t,n,o){for(let i=0;i<=n;i++){const r=Kn(e,i,o)??"",l=Kn(t,i,o)??"";if(r!==l)return!1}return!0}function mr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function br(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function Sn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ri(e){return[e.x+e.width-1,e.y+e.height-1]}function Ao(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[c,u]=t.span;return c>=o&&c<=i||u>=o&&c<=i||c<o&&u>i}function yr(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&Ao(e,t,r)&&i++;for(const l of n.current.rangeStack)Ao(e,t,l)&&i++;return i}function si(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function Kt(e,t){let n=0;const o=si(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Gt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function Jn(e,t,n,o,i){const r=si(e,o),l=[];for(const c of r)if(c.sticky)l.push(c);else break;if(l.length>0)for(const c of l)n-=c.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let c=t;c<s;c++){const u=r[c];u.sticky||l.push(u)}return l}function vr(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function pr(e,t,n,o,i,r,l,s,a,c,u,m){const h=u??(n?1:0),f=m??(n?[i]:[]),d=f.reduce((x,C)=>x+C,0),g=o+d;if(n&&h>0){let x=0;for(let C=0;C<h;C++)if(x+=f[C]??0,e<=x)return-(C+2)}if(e<=g)return-1;let b=t;for(let x=0;x<c;x++){const C=r-1-x,B=typeof l=="number"?l:l(C);if(b-=B,e>=b)return C}const p=r-c,y=e-(a??0);if(typeof l=="number"){const x=Math.floor((y-g)/l)+s;return x>=p?void 0:x}else{let x=g;for(let C=s;C<p;C++){const B=l(C);if(y<=x+B)return C;x+=B}return}}let Cn=0,an={};const wr=typeof window>"u";async function kr(){var e;wr||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Cn=0,an={},Ji())}kr();function li(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Ot(e,t,n,o="middle"){const i=li(e,t,o,n);let r=an[i];return r===void 0&&(r=t.measureText(e),an[i]=r,Cn++),Cn>1e4&&(an={},Cn=0),r}function ai(e,t){const n=li(e,void 0,"middle",t);return an[n]}function Ze(e,t){return typeof t!="string"&&(t=t.baseFontFull),xr(e,t)}function Do(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Ro=[];function xr(e,t){for(const r of Ro)if(r.key===t)return r.val;const n=Do(e,"alphabetic"),i=-(Do(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Ro.push({key:t,val:i}),i}function Sr(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let c=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(c=n-t,c<u)){const m=1-c/u;l.globalAlpha=m,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return c<u}function Hn(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function ci(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function di(e,t){const n=Ot("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Cr(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Mr(e,t,n,o,i,r,l,s,a,c){const u=s.baseFontFull,m=Gi(e,t,u,i-s.cellHorizontalPadding*2,c??!1),h=di(e,u),f=s.lineHeight*h,d=h+f*(m.length-1),g=d+s.cellVerticalPadding>r;g&&(e.save(),e.rect(n,o,i,r),e.clip());const b=o+r/2-d/2;let p=Math.max(o+s.cellVerticalPadding,b);for(const y of m)if(ci(e,y,n,p,i,h,l,s,a),p+=f,p>o+r)break;g&&e.restore()}function Ct(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:c,width:u,height:m}=l;o=o??!1,o||(t=Cr(t,u));const h=Ze(r,s),f=ro(t)==="rtl";if(n===void 0&&f&&(n="right"),f&&(r.direction="rtl"),t.length>0){let d=!1;n==="right"?(r.textAlign="right",d=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,d=!0),o?Mr(r,t,a,c,u,m,h,s,n,i):ci(r,t,a,c,u,m,h,s,n),d&&(r.textAlign="start"),f&&(r.direction="inherit")}}function ft(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function Ir(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Er(e,t,n){const o=function(s,a){const c=a.x-s.x,u=a.y-s.y,m=Math.sqrt(c*c+u*u),h=c/m,f=u/m;return{x:c,y:a.y-s.y,len:m,nx:h,ny:f,ang:Math.atan2(f,h)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const c=t[(s+1)%r],u=o(a,l),m=o(a,c),h=u.nx*m.ny-u.ny*m.nx,f=u.nx*m.nx-u.ny*-m.ny;let d=Math.asin(h<-1?-1:h>1?1:h),g=1,b=!1;f<0?d<0?d=Math.PI+d:(d=Math.PI-d,g=-1,b=!0):d>0&&(g=-1,b=!0),i=a.radius!==void 0?a.radius:n;const p=d/2;let y=Math.abs(Math.cos(p)*i/Math.sin(p)),x;y>Math.min(u.len/2,m.len/2)?(y=Math.min(u.len/2,m.len/2),x=Math.abs(y*Math.sin(p)/Math.cos(p))):x=i;let C=a.x+m.nx*y,B=a.y+m.ny*y;C+=-m.ny*x*g,B+=m.nx*x*g,e.arc(C,B,x,u.ang+Math.PI/2*g,m.ang-Math.PI/2*g,b),l=a,a=c}e.closePath()}function Qn(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g,b){const p={x:0,y:r+c,width:0,height:0},y=g??(i>0?1:0),x=-(y+1);if(e>=f.length||t>=u||t<x||e<0)return p;const C=b??(i>0?[i]:[]),B=C.reduce((H,F)=>H+F,0),P=r-B;if(e>=m){const H=l>e?-1:1,F=Kt(f);p.x+=F+a;for(let k=l;k!==e;k+=H)p.x+=f[H===1?k:k-1].width*H}else for(let H=0;H<e;H++)p.x+=f[H].width;if(p.width=f[e].width+1,t===-1)p.y=B,p.height=P;else if(t<=-2){const H=-(t+2);let F=0;for(let I=0;I<H;I++)F+=C[I]??0;p.y=F,p.height=C[H]??i;let k=e;const R=f[e].group,E=f[e].sticky;for(;k>0&&Gn(f[k-1].group,R,H,y)&&f[k-1].sticky===E;){const I=f[k-1];p.x-=I.width,p.width+=I.width,k--}let S=e;for(;S+1<f.length&&Gn(f[S+1].group,R,H,y)&&f[S+1].sticky===E;){const I=f[S+1];p.width+=I.width,S++}if(!E){const I=Kt(f),M=p.x-I;M<0&&(p.x-=M,p.width+=M),p.x+p.width>n&&(p.width=n-p.x)}}else if(t>=u-h){let H=u-t;for(p.y=o;H>0;){const F=t+H-1;p.height=typeof d=="number"?d:d(F),p.y-=p.height,H--}p.height+=1}else{const H=s>t?-1:1;if(typeof d=="number"){const F=t-s;p.y+=F*d}else for(let F=s;F!==t;F+=H)p.y+=d(F)*H;p.height=(typeof d=="number"?d:d(t))+1}return p}const so=1<<21;function lt(e,t){return(t+2)*so+e}function ui(e){return e%so}function lo(e){return Math.floor(e/so)-2}function ao(e){const t=ui(e),n=lo(e);return[t,n]}class fi{constructor(){ee(this,"visibleWindow",{x:0,y:0,width:0,height:0});ee(this,"freezeCols",0);ee(this,"freezeRows",[]);ee(this,"isInWindow",t=>{const n=ui(t),o=lo(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&jt(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Fr extends fi{constructor(){super(...arguments);ee(this,"cache",new Map);ee(this,"setValue",(n,o)=>{this.cache.set(lt(n[0],n[1]),o)});ee(this,"getValue",n=>this.cache.get(lt(n[0],n[1])));ee(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Vt{constructor(t=[]){ee(this,"cells");this.cells=new Set(t.map(n=>lt(n[0],n[1])))}add(t){this.cells.add(lt(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(lt(t[0],t[1]))}remove(t){this.cells.delete(lt(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(lo(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(lt(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield ao(t)}}function Hr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Br{constructor(t,n){ee(this,"spriteMap",new Map);ee(this,"headerIcons");ee(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[c,u]=Hr(n,s),m=l*Math.ceil(window.devicePixelRatio),h=`${c}_${u}_${m}_${t}`;let f=this.spriteMap.get(h);if(f===void 0){const d=this.headerIcons[t];if(d===void 0)return;f=document.createElement("canvas");const g=f.getContext("2d");if(g===null)return;const b=new Image;b.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(d({fgColor:u,bgColor:c}))}`,this.spriteMap.set(h,f);const p=b.decode();if(p===void 0)return;this.inFlight++,p.then(()=>{g.drawImage(b,0,0,m,m)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(f,0,0,m,m,i,r,l,l),a<1&&(o.globalAlpha=1)}}const On={};let St=null;function Pr(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Zn(e){const t=e.toLowerCase().trim();if(On[t]!==void 0)return On[t];St=St||Pr(),St.style.color="#000",St.style.color=t;const n=getComputedStyle(St).color;St.style.color="#fff",St.style.color=t;const o=getComputedStyle(St).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),On[t]=i,i}function Jt(e,t){const[n,o,i]=Zn(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const To=new Map;function Wo(e,t){const n=`${e}-${t}`,o=To.get(n);if(o!==void 0)return o;const i=Qe(e,t);return To.set(n,i),i}function Qe(e,t){if(t===void 0)return e;const[n,o,i,r]=Zn(e);if(r===1)return e;const[l,s,a,c]=Zn(t),u=r+c*(1-r),m=(r*n+c*l*(1-r))/u,h=(r*o+c*s*(1-r))/u,f=(r*i+c*a*(1-r))/u;return`rgba(${m}, ${h}, ${f}, ${u})`}function hi(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Bn(e,t,n,o,i,r,l,s,a){s=s??t;let c=t,u=e;const m=o-r;let h=!1;for(;c<n&&u<m;){const f=i(u);if(c+f>s&&a(c,u,f,!1,l&&u===o-1)===!0){h=!0;break}c+=f,u++}if(!h){c=n;for(let f=0;f<r;f++){u=o-1-f;const d=i(u);c-=d,a(c,u,d,!0,l&&u===o-1)}}}function It(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const c of e){const u=c.sticky?s:l+n;if(r(c,u,a,c.sticky?0:s,t)===!0)break;l+=c.width,s+=c.sticky?c.width:0}}function Ar(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let c=s+1,u=a.width;for(a.sticky&&(l+=u);c<e.length&&gr(e[c].group,a.group)&&e[c].sticky===e[s].sticky;){const g=e[c];u+=g.width,c++,s++,g.sticky&&(l+=g.width)}const m=a.sticky?0:n,h=r+m,f=a.sticky?0:Math.max(0,l-h),d=Math.min(u-f,t-(h+f));i([a.sourceIndex,e[c-1].sourceIndex],Lt(a.group),h+f,0,d,o),r+=u}}function Dr(e,t,n,o,i,r){if(i===0)return;const l=[];let s=0;for(let u=0;u<i;u++)l.push(s),s+=o[u]??0;const a=[];let c=0;for(const u of e)a.push(c),c+=u.width;for(let u=0;u<i;u++){const m=l[u],h=o[u]??0;let f=0,d=0;for(;d<e.length;){const g=e[d],b=Kn(g.group,u,i);if(b===void 0){g.sticky&&(f+=g.width),d++;continue}const p=a[d];let y=d+1,x=g.width;for(g.sticky&&(f+=g.width);y<e.length;){const F=e[y],k=Gn(F.group,g.group,u,i),R=F.sticky===g.sticky;if(!k||!R)break;x+=F.width,F.sticky&&(f+=F.width),y++}const C=g.sticky?0:n,B=p+C,P=g.sticky?0:Math.max(0,f-B),H=Math.min(x-P,t-(B+P));H>0&&r([g.sourceIndex,e[y-1].sourceIndex],b,B+P,m,H,h,u),d=y}}}function gi(e,t,n,o,i,r,l){var h;const[s,a]=e;let c,u;const m=((h=l.find(f=>!f.sticky))==null?void 0:h.sourceIndex)??0;if(a>m){const f=Math.max(s,m);let d=t,g=o;for(let b=r.sourceIndex-1;b>=f;b--)d-=l[b].width,g+=l[b].width;for(let b=r.sourceIndex+1;b<=a;b++)g+=l[b].width;u={x:d,y:n,width:g,height:i}}if(m>s){const f=Math.min(a,m-1);let d=t,g=o;for(let b=r.sourceIndex-1;b>=s;b--)d-=l[b].width,g+=l[b].width;for(let b=r.sourceIndex+1;b<=f;b++)g+=l[b].width;c={x:d,y:n,width:g,height:i}}return[c,u]}function Ml(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const mi={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function Il(){return mi}const Rr=cn.createContext(mi);function El(){return cn.useContext(Rr)}function Nt(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=Qe(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function Fl(e,t,n,o){if(o==="any")return Tr(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),br([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function dn(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function zt(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Tr(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Wr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function zr(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,c=e.x+e.width-l,u=r-e.y,m=e.y+e.height-s,h=a>0?e.x+Math.floor(a/o)*o:e.x,f=c>0?e.x+e.width-Math.floor(c/o)*o:e.x+e.width,d=u>0?e.y+Math.floor(u/o)*o:e.y,g=m>0?e.y+e.height-Math.floor(m/o)*o:e.y+e.height;return{x:h,y:d,width:f-h,height:g-d}}function Lr(e,t,n,o,i){const[r,l,s,a]=t,[c,u,m,h]=i,{x:f,y:d,width:g,height:b}=e,p=[];if(g<=0||b<=0)return p;const y=f+g,x=d+b,C=f<r,B=d<l,P=f+g>s,H=d+b>a,F=f>=r&&f<s||y>r&&y<=s||f<r&&y>s,k=d>=l&&d<a||x>l&&x<=a||d<l&&x>a;if(F&&k){const E=Math.max(f,r),S=Math.max(d,l),I=Math.min(y,s),M=Math.min(x,a);p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:c,y:u,width:m-c+1,height:h-u+1}})}if(C&&B){const E=f,S=d,I=Math.min(y,r),M=Math.min(x,l);p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:0,y:0,width:c+1,height:u+1}})}if(B&&F){const E=Math.max(f,r),S=d,I=Math.min(y,s),M=Math.min(x,l);p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:c,y:0,width:m-c+1,height:u+1}})}if(B&&P){const E=Math.max(f,s),S=d,I=y,M=Math.min(x,l);p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:m,y:0,width:n-m+1,height:u+1}})}if(C&&k){const E=f,S=Math.max(d,l),I=Math.min(y,r),M=Math.min(x,a);p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:0,y:u,width:c+1,height:h-u+1}})}if(P&&k){const E=Math.max(f,s),S=Math.max(d,l),I=y,M=Math.min(x,a);p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:m,y:u,width:n-m+1,height:h-u+1}})}if(C&&H){const E=f,S=Math.max(d,a),I=Math.min(y,r),M=x;p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:0,y:h,width:c+1,height:o-h+1}})}if(H&&F){const E=Math.max(f,r),S=Math.max(d,a),I=Math.min(y,s),M=x;p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:c,y:h,width:m-c+1,height:o-h+1}})}if(P&&H){const E=Math.max(f,s),S=Math.max(d,a),I=y,M=x;p.push({rect:{x:E,y:S,width:I-E,height:M-S},clip:{x:m,y:h,width:n-m+1,height:o-h+1}})}return p}const Nr={kind:ce.Loading,allowOverlay:!1};function zo(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g,b,p,y,x,C,B,P,H,F,k,R,E,S,I,M,Y,z,ne,J){let K=(x==null?void 0:x.size)??Number.MAX_SAFE_INTEGER;const Q=performance.now();let ue=I.baseFontFull;e.font=ue;const we={ctx:e},fe=[0,0],Xe=b>0?Gt(a,b,c):0;let q,ke;const Be=new Vt,N=new Set,ye=hi(y);if(It(t,s,r,l,i,(V,he,Pe,De,_e)=>{const et=Math.max(0,De-he),tt=he+et,de=i+1,pt=V.width-et,ht=o-i-1;if(y.length>0){let ie=!1;for(let ge=0;ge<y.length;ge++){const ve=y[ge];if(dn(tt,de,pt,ht,ve.x,ve.y,ve.width,ve.height)){ie=!0;break}}if(!ie)return}const qe=()=>{e.save(),e.beginPath(),e.rect(tt,de,pt,ht),e.clip()},re=C.columns.hasIndex(V.sourceIndex),Ue=m(Lt(V.group)).overrideTheme,Re=V.themeOverride===void 0&&Ue===void 0?I:Nt(I,Ue,V.themeOverride),Ye=Re.baseFontFull;Ye!==ue&&(ue=Ye,e.font=Ye),qe();let Me;return Bn(_e,Pe,o,a,c,b,p,ye,(ie,ge,ve,nt,D)=>{var rt,gt,Bt;if(ge<0)return;if(fe[0]=V.sourceIndex,fe[1]=ge,Be.has(fe)){K--;return}if(x!==void 0&&!x.has(fe))return;if(y.length>0){let U=!1;for(let se=0;se<y.length;se++){const le=y[se];if(dn(he,ie,V.width,ve,le.x,le.y,le.width,le.height)){U=!0;break}}if(!U)return}const Fe=C.rows.hasIndex(ge),xe=f.hasIndex(ge),L=ge<a?u(fe):Nr;let He=he,Ie=V.width,oe=ie,te=ve,Te=!1,ot=!1;if(L.rowspan!==void 0){const[U,se]=L.rowspan,le=`${V.sourceIndex}|${U}`;if(N.has(le)){K--;return}else{let Ge=ie;for(let G=U;G<ge;G++)Ge-=c(G);let Je=0;for(let G=U;G<se;G++)Je+=c(G);if(Ge<de+ht&&Ge+Je>de){oe=Ge,te=Je,N.add(le);for(let G=U;G<se;G++)G!==ge&&Be.add([V.sourceIndex,G]);Te=!0}else{N.add(le);for(let G=U;G<se;G++)Be.add([V.sourceIndex,G]);K--;return}}}if(L.span!==void 0){const[U,se]=L.span,le=`${ge},${U},${se},${V.sticky}`;if(ke===void 0&&(ke=new Set),ke.has(le)){K--;return}else{const Ge=gi(L.span,he,ie,V.width,ve,V,n),Je=V.sticky?Ge[0]:Ge[1];!V.sticky&&Ge[0]!==void 0&&(ot=!0),Je!==void 0&&(He=Je.x,Ie=Je.width,ke.add(le),Te=!0)}}if(Te){e.restore(),Me=void 0,e.save(),e.beginPath();const U=Math.max(0,De-He);e.rect(He+U,oe,Ie-U,te),q===void 0&&(q=[]),q.push({x:He+U,y:oe,width:Ie-U,height:te}),e.clip()}const Ve=h==null?void 0:h(ge),at=D&&((rt=V.trailingRowOptions)==null?void 0:rt.themeOverride)!==void 0?(gt=V.trailingRowOptions)==null?void 0:gt.themeOverride:void 0,Oe=L.themeOverride===void 0&&Ve===void 0&&at===void 0?Re:Nt(Re,Ve,at,L.themeOverride);e.beginPath();const ct=mr(fe,L,C);let je=yr(fe,L,C,g);const Et=L.span!==void 0&&C.columns.some(U=>L.span!==void 0&&U>=L.span[0]&&U<=L.span[1]);ct&&!d&&g?je=0:ct&&g&&(je=Math.max(je,1)),Et&&je++,ct||(Fe&&je++,re&&!D&&je++);const Ft=L.kind===ce.Protected?Oe.bgCellMedium:Oe.bgCell;let Ee;if((nt||Ft!==I.bgCell)&&(Ee=Qe(Ft,Ee)),je>0||xe){xe&&(Ee=Qe(Oe.bgHeader,Ee));for(let U=0;U<je;U++)Ee=Qe(Oe.accentLight,Ee)}else if(B!==void 0){for(const U of B)if(U[0]===V.sourceIndex&&U[1]===ge){Ee=Qe(Oe.bgSearchResult,Ee);break}}if(P!==void 0)for(let U=0;U<P.length;U++){const se=P[U],le=se.range;se.style!=="solid-outline"&&le.x<=V.sourceIndex&&V.sourceIndex<le.x+le.width&&le.y<=ge&&ge<le.y+le.height&&(Ee=Qe(se.color,Ee))}let Ht=!1;if(x!==void 0){const U=ie+1,le=(nt?U+ve-1:Math.min(U+ve-1,o-Xe))-U;(le!==ve-1||He+1<=De)&&(Ht=!0,e.save(),e.beginPath(),e.rect(He+1,U,Ie-1,le),e.clip()),Ee=Ee===void 0?Oe.bgCell:Qe(Ee,Oe.bgCell)}const me=V.sourceIndex===n.length-1,Ke=ge===a-1;Ee!==void 0&&(e.fillStyle=Ee,Me!==void 0&&(Me.fillStyle=Ee),x!==void 0?e.fillRect(He+1,oe+1,Ie-(me?2:1),te-(Ke?2:1)):e.fillRect(He,oe,Ie,te)),L.style==="faded"&&(e.globalAlpha=.6);let it;for(let U=0;U<k.length;U++){const se=k[U];if(se.item[0]===V.sourceIndex&&se.item[1]===ge){it=se;break}}if(Ie>J&&!ot){const U=Oe.baseFontFull;U!==ue&&(e.font=U,ue=U);let se=0;if(L.rowspan!==void 0){const le=L.rowSpanPosition??"top";if(le==="top")se=ve/2-te/2;else if(le==="bottom"){const[Ge,Je]=L.rowspan,G=c(Je-1);se=te/2-G/2}}Me=bi(e,L,V.sourceIndex,ge,me,Ke,He,oe,Ie,te,je>0,Oe,Ee??Oe.bgCell,H,F,(it==null?void 0:it.hoverAmount)??0,R,S,Q,E,Me,M,Y,z,ne,se)}return Ht&&e.restore(),L.style==="faded"&&(e.globalAlpha=1),K--,Te&&(e.restore(),(Bt=Me==null?void 0:Me.deprep)==null||Bt.call(Me,we),Me=void 0,qe(),ue=Ye,e.font=Ye),K<=0}),e.restore(),K<=0}),q!==void 0)return q}const nn=[0,0],on={x:0,y:0,width:0,height:0},Xn=[void 0,()=>{}];let eo=!1;function Or(){eo=!0}function bi(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g,b,p,y,x,C,B,P,H,F,k){var z,ne;let R,E;b!==void 0&&b[0][0]===n&&b[0][1]===o&&(R=b[1][0],E=b[1][1]);let S;nn[0]=n,nn[1]=o,on.x=l,on.y=s,on.width=a,on.height=c,Xn[0]=P.getValue(nn),Xn[1]=J=>P.setValue(nn,J),eo=!1;const I={ctx:e,theme:m,col:n,row:o,cell:t,rect:on,highlighted:u,cellFillColor:h,hoverAmount:g,frameTime:y,hoverX:R,drawState:Xn,hoverY:E,imageLoader:f,spriteManager:d,hyperWrapping:p,overrideCursor:R!==void 0?F:void 0,requestAnimationFrame:Or},M=Sr(I,t.lastUpdated,y,C,i,r),Y=H(t);if(Y!==void 0){(C==null?void 0:C.renderer)!==Y&&((z=C==null?void 0:C.deprep)==null||z.call(C,I),C=void 0);const J=(ne=Y.drawPrep)==null?void 0:ne.call(Y,I,C);e.save(),e.translate(0,k),x!==void 0&&!Zo(I.cell)?x(I,()=>Y.draw(I,t)):Y.draw(I,t),e.restore(),S=J===void 0?void 0:{deprep:J==null?void 0:J.deprep,fillStyle:J==null?void 0:J.fillStyle,font:J==null?void 0:J.font,renderer:Y}}return(M||eo)&&(B==null||B(nn)),S}function Fn(e,t,n,o,i,r,l,s,a=-20,c=-20,u=void 0,m="center",h="square",f=!1){const d=Math.floor(i+l/2),g=h==="circle"?1e4:t.roundingRadius??4;let b=ni(u??t.checkboxMaxSize,l,t.cellVerticalPadding),p=b/2;const y=ti(m,o,r,t.cellHorizontalPadding,b),x=ei(y,d,b),C=oi(o+a,i+c,x);switch(n){case!0:{e.beginPath(),ft(e,y-b/2,d-b/2,b,b,g),h==="circle"&&(p*=.8,b*=.8),e.fillStyle=f?t.bgCellMedium:s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(y-p+b/4.23,d-p+b/1.97),e.lineTo(y-p+b/2.42,d-p+b/1.44),e.lineTo(y-p+b/1.29,d-p+b/3.25),e.strokeStyle=f?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case In:case!1:{e.beginPath(),ft(e,y-b/2+.5,d-b/2+.5,b-1,b-1,g),e.lineWidth=1,e.strokeStyle=f?t.textLight:C?t.textDark:t.textMedium,e.stroke();break}case no:{e.beginPath(),ft(e,y-b/2,d-b/2,b,b,g),e.fillStyle=f?t.bgCellMedium:C?t.textMedium:t.textLight,e.fill(),h==="circle"&&(p*=.8,b*=.8),e.beginPath(),e.moveTo(y-b/3,d),e.lineTo(y+b/3,d),e.strokeStyle=f?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:to()}}function Xr(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g,b,p,y,x,C,B){var Y,z,ne,J;const P=C??(o?1:0),H=B??(o?[a]:[]),F=H.reduce((K,Q)=>K+Q,0),k=s+F;if(k<=0)return;e.fillStyle=h.bgHeader,p!==void 0&&o&&(C??1)>1?e.fillRect(0,F,r,s):e.fillRect(0,0,r,k);const R=(Y=i==null?void 0:i[0])==null?void 0:Y[0],E=(z=i==null?void 0:i[0])==null?void 0:z[1],S=(ne=i==null?void 0:i[1])==null?void 0:ne[0],I=(J=i==null?void 0:i[1])==null?void 0:J[1],M=h.headerFontFull;e.font=M,It(t,0,l,0,k,(K,Q,ue,we)=>{var _e;if(p!==void 0&&!p.has([K.sourceIndex,-1]))return;const fe=Math.max(0,we-Q);e.save(),e.beginPath(),e.rect(Q+fe,F,K.width-fe,s),e.clip();const Xe=b(Lt(K.group)).overrideTheme,q=K.themeOverride===void 0&&Xe===void 0?h:Nt(h,Xe,K.themeOverride);q.bgHeader!==h.bgHeader&&(e.fillStyle=q.bgHeader,e.fill()),q!==h&&(e.font=q.headerFontFull);const ke=m.columns.hasIndex(K.sourceIndex),Be=c!==void 0||u||K.headerRowMarkerDisabled===!0,N=!Be&&E===-1&&R===K.sourceIndex,ye=Be?0:((_e=d.find(et=>et.item[0]===K.sourceIndex&&et.item[1]===-1))==null?void 0:_e.hoverAmount)??0,V=(m==null?void 0:m.current)!==void 0&&m.current.cell[0]===K.sourceIndex,he=ke?q.accentColor:V?q.bgHeaderHasFocus:q.bgHeader,Pe=o?F:0,De=K.sourceIndex===0?0:1;ke?(e.fillStyle=he,e.fillRect(Q+De,Pe,K.width-De,s)):(V||ye>0)&&(e.beginPath(),e.rect(Q+De,Pe,K.width-De,s),V&&(e.fillStyle=q.bgHeaderHasFocus,e.fill()),ye>0&&(e.globalAlpha=ye,e.fillStyle=q.bgHeaderHovered,e.fill(),e.globalAlpha=1)),vi(e,Q,Pe,K.width,s,K,ke,q,N,N?S:void 0,N?I:void 0,V,ye,f,y,x),e.restore()}),o&&(P>1?$r(e,t,r,l,H,P,i,h,f,d,g,b,p):Yr(e,t,r,l,a,i,h,f,d,g,b,p)),o&&(C??1)>1&&(e.beginPath(),e.moveTo(0,F+.5),e.lineTo(r,F+.5),e.strokeStyle=h.borderColor,e.lineWidth=1,e.stroke())}function Yr(e,t,n,o,i,r,l,s,a,c,u,m){const[f,d]=(r==null?void 0:r[0])??[];let g=0;Ar(t,n,o,i,(b,p,y,x,C,B)=>{if(m!==void 0&&!m.hasItemInRectangle({x:b[0],y:-2,width:b[1]-b[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,x,C,B),e.clip();const P=u(p),H=(P==null?void 0:P.overrideTheme)===void 0?l:Nt(l,P.overrideTheme),F=d===-2&&f!==void 0&&f>=b[0]&&f<=b[1],k=F?H.bgGroupHeaderHovered??H.bgHeaderHovered:H.bgGroupHeader??H.bgHeader;if(k!==l.bgHeader&&(e.fillStyle=k,e.fill()),e.fillStyle=H.textGroupHeader??H.textHeader,P!==void 0){let R=y;if(P.icon!==void 0&&(s.drawSprite(P.icon,"normal",e,R+8,(i-20)/2,20,H),R+=26),e.fillText(P.name,R+8,i/2+Ze(e,l.headerFontFull)),P.actions!==void 0&&F){const E=co({x:y,y:x,width:C,height:B},P.actions);e.beginPath();const S=E[0].x-10,I=y+C-S;e.rect(S,0,I,i);const M=e.createLinearGradient(S,0,S+I,0),Y=Jt(k,0);M.addColorStop(0,Y),M.addColorStop(10/I,k),M.addColorStop(1,k),e.fillStyle=M,e.fill(),e.globalAlpha=.6;const[z,ne]=(r==null?void 0:r[1])??[-1,-1];for(let J=0;J<P.actions.length;J++){const K=P.actions[J],Q=E[J],ue=zt(Q,z+y,ne);ue&&(e.globalAlpha=1),s.drawSprite(K.icon,"normal",e,Q.x+Q.width/2-10,Q.y+Q.height/2-10,20,H),ue&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&c(b[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),g=y+C}),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}function $r(e,t,n,o,i,r,l,s,a,c,u,m,h){const[f,d]=(l==null?void 0:l[0])??[];e.font=s.headerFontFull;const g=i.reduce((p,y)=>p+y,0);h===void 0&&(e.fillStyle=s.bgHeader,e.fillRect(0,0,n,g));let b=0;if(Dr(t,n,o,i,r,(p,y,x,C,B,P,H)=>{const F=-(H+2);if(h!==void 0&&!h.hasItemInRectangle({x:p[0],y:F,width:p[1]-p[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(x,C,B,P),e.clip();const k=m(y),R=(k==null?void 0:k.overrideTheme)===void 0?s:Nt(s,k.overrideTheme),E=d===F&&f!==void 0&&f>=p[0]&&f<=p[1],S=E?R.bgGroupHeaderHovered??R.bgHeaderHovered:R.bgGroupHeader??R.bgHeader;e.fillStyle=S,e.fillRect(x,C,B,P),e.fillStyle=R.textGroupHeader??R.textHeader;const I=(k==null?void 0:k.name)??y,Y=e.measureText(I).width,z=(k==null?void 0:k.icon)!==void 0?26:0,ne=z+Y,J=x+(B-ne)/2;if((k==null?void 0:k.icon)!==void 0&&a.drawSprite(k.icon,"normal",e,J,C+(P-20)/2,20,R),e.fillText(I,J+z,C+P/2+Ze(e,s.headerFontFull)),k!==void 0&&k.actions!==void 0&&E){const K=co({x,y:C,width:B,height:P},k.actions);e.beginPath();const Q=K[0].x-10,ue=x+B-Q;e.rect(Q,C,ue,P);const we=e.createLinearGradient(Q,0,Q+ue,0),fe=Jt(S,0);we.addColorStop(0,fe),we.addColorStop(10/ue,S),we.addColorStop(1,S),e.fillStyle=we,e.fill(),e.globalAlpha=.6;const[Xe,q]=(l==null?void 0:l[1])??[-1,-1];for(let ke=0;ke<k.actions.length;ke++){const Be=k.actions[ke],N=K[ke],ye=zt(N,Xe+x,q);ye&&(e.globalAlpha=1),a.drawSprite(Be.icon,"normal",e,N.x+N.width/2-10,N.y+N.height/2-10,20,R),ye&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=s.borderColor,e.lineWidth=1,x!==0&&u(p[0])&&(e.beginPath(),e.moveTo(x+.5,C),e.lineTo(x+.5,C+P),e.stroke()),(H<r-1||h===void 0)&&(e.beginPath(),e.moveTo(x,C+P+.5),e.lineTo(x+B,C+P+.5),e.stroke()),e.restore(),b=Math.max(b,x+B)}),h===void 0){e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,g);let p=0;for(let y=0;y<r-1;y++)p+=i[y],e.moveTo(0,p+.5),e.lineTo(n,p+.5);e.strokeStyle=s.borderColor,e.lineWidth=1,e.stroke()}}const xn=30;function _r(e,t,n,o,i){return{x:e+n-xn,y:Math.max(t,t+o/2-xn/2),width:xn,height:Math.min(xn,o)}}function co(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function rn(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function yi(e,t,n,o,i,r,l,s){var H;const a=l.cellHorizontalPadding,c=l.headerIconSize,u=_r(n,o,i,r);let m=n+a;const h=t.icon===void 0?void 0:{x:m,y:o+(r-c)/2,width:c,height:c},f=h===void 0||t.overlayIcon===void 0?void 0:{x:h.x+9,y:h.y+6,width:18,height:18};h!==void 0&&(m+=Math.ceil(c*1.3));const d=e===void 0?((H=ai(t.title,l.headerFontFull))==null?void 0:H.width)??0:Ot(t.title,e,l.headerFontFull).width,g=t.hasMenu===!0?35:0,b=t.indicatorIcon!==void 0?c+a:0,p=d+b,y=i-(h!==void 0?Math.ceil(c*1.3)+a:a)-g-a,x=n+(h!==void 0?Math.ceil(c*1.3)+a:a)+(y-p)/2,C={x:Math.max(m,x),y:o,width:d,height:r};let B;t.indicatorIcon!==void 0&&(B={x:C.x+d+a,y:o+(r-c)/2,width:c,height:c});const P=n+i/2;return{menuBounds:rn(u,P,s),iconBounds:rn(h,P,s),iconOverlayBounds:rn(f,P,s),textBounds:rn(C,P,s),indicatorIconBounds:rn(B,P,s)}}function Lo(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const y=r.rowMarkerChecked;y!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=m);const x=r.headerRowMarkerTheme!==void 0?Nt(s,r.headerRowMarkerTheme):s;Fn(e,x,y,t,n,o,i,!1,void 0,void 0,s.checkboxMaxSize,"center",r.rowMarker),y!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const b=l?s.textHeaderSelected:s.textHeader,p=r.hasMenu===!0&&(a||f&&l)&&g.menuBounds!==void 0;if(r.icon!==void 0&&g.iconBounds!==void 0){let y=l?"selected":"normal";r.style==="highlight"&&(y=l?"selected":"special"),h.drawSprite(r.icon,y,e,g.iconBounds.x,g.iconBounds.y,g.iconBounds.width,s),r.overlayIcon!==void 0&&g.iconOverlayBounds!==void 0&&h.drawSprite(r.overlayIcon,l?"selected":"special",e,g.iconOverlayBounds.x,g.iconOverlayBounds.y,g.iconOverlayBounds.width,s)}if(p&&o>35){const x=d?35:o-35,C=d?35*.7:o-35*.7,B=x/o,P=C/o,H=e.createLinearGradient(t,0,t+o,0),F=Jt(b,0);H.addColorStop(d?1:0,b),H.addColorStop(B,b),H.addColorStop(P,F),H.addColorStop(d?0:1,F),e.fillStyle=H}else e.fillStyle=b;if(d&&(e.textAlign="right"),g.textBounds!==void 0&&e.fillText(r.title,d?g.textBounds.x+g.textBounds.width:g.textBounds.x,n+i/2+Ze(e,s.headerFontFull)),d&&(e.textAlign="left"),r.indicatorIcon!==void 0&&g.indicatorIconBounds!==void 0&&(!p||!dn(g.menuBounds.x,g.menuBounds.y,g.menuBounds.width,g.menuBounds.height,g.indicatorIconBounds.x,g.indicatorIconBounds.y,g.indicatorIconBounds.width,g.indicatorIconBounds.height))){let y=l?"selected":"normal";r.style==="highlight"&&(y=l?"selected":"special"),h.drawSprite(r.indicatorIcon,y,e,g.indicatorIconBounds.x,g.indicatorIconBounds.y,g.indicatorIconBounds.width,s)}if(p&&g.menuBounds!==void 0){const y=g.menuBounds,x=c!==void 0&&u!==void 0&&zt(y,c+t,u+n);if(x||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===Vn.Triangle){e.beginPath();const C=y.x+y.width/2-5.5,B=y.y+y.height/2-3;Er(e,[{x:C,y:B},{x:C+11,y:B},{x:C+5.5,y:B+6}],1),e.fillStyle=b,e.fill()}else if(r.menuIcon===Vn.Dots){e.beginPath();const C=y.x+y.width/2,B=y.y+y.height/2;Ir(e,C,B),e.fillStyle=b,e.fill()}else{const C=y.x+(y.width-s.headerIconSize)/2,B=y.y+(y.height-s.headerIconSize)/2;h.drawSprite(r.menuIcon,"normal",e,C,B,s.headerIconSize,s)}x||(e.globalAlpha=1)}}function vi(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g){const b=ro(r.title)==="rtl",p=yi(e,r,t,n,o,i,s,b);d!==void 0?d({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:h,isHovered:a,hasSelectedCell:m,spriteManager:f,menuBounds:(p==null?void 0:p.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:c,hoverY:u},()=>Lo(e,t,n,o,i,r,l,s,a,c,u,h,f,g,b,p)):Lo(e,t,n,o,i,r,l,s,a,c,u,h,f,g,b,p)}function qr(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g,b,p,y){if(p!==void 0||t[t.length-1]!==n[t.length-1])return;const x=hi(b);It(t,a,l,s,r,(C,B,P,H,F)=>{if(C!==t[t.length-1])return;B+=C.width;const k=Math.max(B,H);k>o||(e.save(),e.beginPath(),e.rect(k,r+1,1e4,i-r-1),e.clip(),Bn(F,P,i,c,u,d,g,x,(R,E,S,I)=>{if(!I&&b.length>0&&!b.some(J=>dn(B,R,1e4,S,J.x,J.y,J.width,J.height)))return;const M=h.hasIndex(E),Y=f.hasIndex(E);e.beginPath();const z=m==null?void 0:m(E),ne=z===void 0?y:Nt(y,z);ne.bgCell!==y.bgCell&&(e.fillStyle=ne.bgCell,e.fillRect(B,R,1e4,S)),Y&&(e.fillStyle=ne.bgHeader,e.fillRect(B,R,1e4,S)),M&&(e.fillStyle=ne.accentLight,e.fillRect(B,R,1e4,S))}),e.restore())})}function Ur(e,t,n,o,i,r,l,s,a){let c=!1;for(const d of t)if(!d.sticky){c=l(d.sourceIndex);break}const u=a.horizontalBorderColor??a.borderColor,m=a.borderColor,h=c?Kt(t):0;let f;if(h!==0&&(f=Wo(m,a.bgCell),e.beginPath(),e.moveTo(h+.5,0),e.lineTo(h+.5,o),e.strokeStyle=f,e.stroke()),i>0){const d=m===u&&f!==void 0?f:Wo(u,a.bgCell),g=Gt(r,i,s);e.beginPath(),e.moveTo(0,o-g+.5),e.lineTo(n,o-g+.5),e.strokeStyle=d,e.stroke()}}const pi=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function Vr(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d){var S;const g=d.bgCell,{minX:b,maxX:p,minY:y,maxY:x}=pi(s,r,l),C=[],B=l-Gt(f,h,c);let P=a,H=n,F=0;for(;P+i<B;){const I=P+i,M=c(H);if(I>=y&&I<=x-1){const Y=u==null?void 0:u(H),z=Y==null?void 0:Y.bgCell;z!==void 0&&z!==g&&H>=f-h&&C.push({x:b,y:I,w:p-b,h:M,color:z})}P+=M,H<f-h&&(F=P),H++}let k=0;const R=Math.min(B,x)-F;if(R>0)for(let I=0;I<t.length;I++){const M=t[I];if(M.width===0)continue;const Y=M.sticky?k:k+o,z=(S=M.themeOverride)==null?void 0:S.bgCell;z!==void 0&&z!==g&&Y>=b&&Y<=p&&m(I+1)&&C.push({x:Y,y:F,w:M.width,h:R,color:z}),k+=M.width}if(C.length===0)return;let E;e.beginPath();for(let I=C.length-1;I>=0;I--){const M=C[I];E===void 0?E=M.color:M.color!==E&&(e.fillStyle=E,e.fill(),e.beginPath(),E=M.color),e.rect(M.x,M.y,M.w,M.h)}E!==void 0&&(e.fillStyle=E,e.fill()),e.beginPath()}function No(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g,b,p=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const S of a)e.rect(S.x+1,S.y+1,S.width-1,S.height-1);e.clip("evenodd")}const y=b.horizontalBorderColor??b.borderColor,x=b.borderColor,{minX:C,maxX:B,minY:P,maxY:H}=pi(s,r,l),F=[];e.beginPath();let k=.5;for(let S=0;S<t.length;S++){const I=t[S];if(I.width===0)continue;k+=I.width;const M=I.sticky?k:k+o;M>=C&&M<=B&&f(S+1)&&F.push({x1:M,y1:Math.max(c,P),x2:M,y2:Math.min(l,H),color:x})}let R=l+.5;for(let S=g-d;S<g;S++){const I=m(S);R-=I,F.push({x1:C,y1:R,x2:B,y2:R,color:y})}if(p!==!0){let S=u+.5,I=n;const M=R;for(;S+i<M;){const Y=S+i;if(Y>=P&&Y<=H-1){const z=h==null?void 0:h(I);F.push({x1:C,y1:Y,x2:B,y2:Y,color:(z==null?void 0:z.horizontalBorderColor)??(z==null?void 0:z.borderColor)??y})}S+=m(I),I++}}const E=Qi(F,S=>S.color);for(const S of Object.keys(E)){e.strokeStyle=S;for(const I of E[S])e.moveTo(I.x1,I.y1),e.lineTo(I.x2,I.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function jr(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g,b,p,y){const x=[];e.imageSmoothingEnabled=!1;const C=Math.min(i.cellYOffset,l),B=Math.max(i.cellYOffset,l);let P=0;if(typeof p=="number")P+=(B-C)*p;else for(let M=C;M<B;M++)P+=p(M);l>i.cellYOffset&&(P=-P),P+=a-i.translateY;const H=Math.min(i.cellXOffset,r),F=Math.max(i.cellXOffset,r);let k=0;for(let M=H;M<F;M++)k+=g[M].width;r>i.cellXOffset&&(k=-k),k+=s-i.translateX;const R=Kt(b);if(k!==0&&P!==0)return{regions:[]};const E=c>0?Gt(h,c,p):0,S=u-R-Math.abs(k),I=m-f-E-Math.abs(P)-1;if(S>150&&I>150){const M={sx:0,sy:0,sw:u*d,sh:m*d,dx:0,dy:0,dw:u*d,dh:m*d};if(P>0?(M.sy=(f+1)*d,M.sh=I*d,M.dy=(P+f+1)*d,M.dh=I*d,x.push({x:0,y:f,width:u,height:P+1})):P<0&&(M.sy=(-P+f+1)*d,M.sh=I*d,M.dy=(f+1)*d,M.dh=I*d,x.push({x:0,y:m+P-E,width:u,height:-P+E})),k>0?(M.sx=R*d,M.sw=S*d,M.dx=(k+R)*d,M.dw=S*d,x.push({x:R-1,y:0,width:k+2,height:m})):k<0&&(M.sx=(R-k)*d,M.sw=S*d,M.dx=R*d,M.dw=S*d,x.push({x:u+k,y:0,width:-k,height:m})),e.setTransform(1,0,0,1,0,0),y){if(R>0&&k!==0&&P===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const Y=R*d,z=m*d;e.drawImage(t,0,0,Y,z,0,0,Y,z)}if(E>0&&k===0&&P!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const Y=(m-E)*d,z=u*d,ne=E*d;e.drawImage(t,0,Y,z,ne,0,Y,z,ne)}}e.drawImage(t,M.sx,M.sy,M.sw,M.sh,M.dx,M.dy,M.dw,M.dh),e.scale(d,d)}return e.imageSmoothingEnabled=!0,{regions:x}}function Kr(e,t,n,o,i,r,l,s,a,c){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||It(a,n,o,i,s,(m,h,f,d)=>{if(m.sourceIndex===c){const g=Math.max(h,d)+1;return u.push({x:g,y:0,width:r-g,height:l}),!0}}),u}function Gr(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(jt(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...c}=r;if(!jt(s,c))return!1;n=o}return n===void 0?!0:n}return!0}function Oo(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g){const b=d==null?void 0:d.filter(H=>H.style!=="no-outline");if(b===void 0||b.length===0)return;const p=Kt(s),y=Gt(f,h,m),x=[a,0,s.length,f-h],C=[p,0,t,n-y],B=b.map(H=>{const F=H.range,k=H.style??"dashed";return Lr(F,x,t,n,C).map(R=>{const E=R.rect,S=Qn(E.x,E.y,t,n,u,c+u,o,i,r,l,f,a,h,s,m),I=E.width===1&&E.height===1?S:Qn(E.x+E.width-1,E.y+E.height-1,t,n,u,c+u,o,i,r,l,f,a,h,s,m);return E.x+E.width>=s.length&&(I.width-=1),E.y+E.height>=f&&(I.height-=1),{color:H.color,style:k,clip:R.clip,rect:zr({x:S.x,y:S.y,width:I.x+I.width-S.x,height:I.y+I.height-S.y},t,n,8)}})}),P=()=>{e.lineWidth=1;let H=!1;for(const F of B)for(const k of F)if((k==null?void 0:k.rect)!==void 0&&dn(0,0,t,n,k.rect.x,k.rect.y,k.rect.width,k.rect.height)){const R=H,E=!Wr(k.clip,k.rect);e.beginPath(),E&&(e.save(),e.rect(k.clip.x,k.clip.y,k.clip.width,k.clip.height),e.clip()),k.style==="dashed"&&!H?(e.setLineDash([5,3]),H=!0):(k.style==="solid"||k.style==="solid-outline")&&H&&(e.setLineDash([]),H=!1),e.strokeStyle=k.style==="solid-outline"?Qe(Qe(k.color,g.borderColor),g.bgCell):Jt(k.color,1),e.closePath(),e.strokeRect(k.rect.x+.5,k.rect.y+.5,k.rect.width-1,k.rect.height-1),E&&(e.restore(),H=R)}H&&e.setLineDash([])};return P(),P}function Xo(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function Yn(e,t,n,o,i,r,l,s,a,c,u,m,h,f,d,g,b){if(u.current===void 0)return;const p=g!==!1&&g!==void 0;if(!p)return;const y=typeof g=="object"?{...En,...g}:En,x=u.current.range,C=u.current.cell,B=[x.x+x.width-1,x.y+x.height-1];if(C[1]>=b&&B[1]>=b||!l.some(z=>z.sourceIndex===C[0]||z.sourceIndex===B[0]))return;const[H,F]=u.current.cell,k=h(u.current.cell),R=k.span??[H,H],E=F>=b-f,S=f>0&&!E?Gt(b,f,m)-1:0,I=B[1];let M;if(It(l,o,i,r,c,(z,ne,J,K,Q)=>{if(z.sticky&&H>z.sourceIndex)return;const ue=z.sourceIndex<R[0],we=z.sourceIndex>R[1],fe=z.sourceIndex===B[0];if(!(!fe&&(ue||we)))return Bn(Q,J,n,b,m,f,d,void 0,(Xe,q,ke)=>{if(q!==F&&q!==I)return;let Be=ne,N=z.width;if(k.span!==void 0){const V=gi(k.span,ne,Xe,z.width,ke,z,s),he=z.sticky?V[0]:V[1];he!==void 0&&(Be=he.x,N=he.width)}return q===I&&fe&&p&&(M=()=>{var _e;K>Be&&!z.sticky&&(e.beginPath(),e.rect(K,0,t-K,n),e.clip());const V=y.size,he=V/2,Pe=Be+N+y.offsetX-he+.5,De=Xe+ke+y.offsetY-he+.5;e.beginPath(),y.shape==="circle"?e.arc(Pe+he,De+he,he,0,Math.PI*2):e.rect(Pe,De,V,V),e.fillStyle=((_e=z.themeOverride)==null?void 0:_e.accentColor)??a.accentColor,e.fill(),y.outline>0&&(e.lineWidth=y.outline,e.strokeStyle=a.bgCell,y.shape==="circle"?(e.beginPath(),e.arc(Pe+he,De+he,he+y.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(Pe-y.outline/2,De-y.outline/2,V+y.outline,V+y.outline))}),M!==void 0}),M!==void 0}),M===void 0)return;const Y=()=>{e.save(),e.beginPath(),e.rect(0,c,t,n-c-S),e.clip(),M==null||M(),e.restore()};return Y(),Y}function Jr(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),It(t,s,r,l,i,(c,u,m,h)=>{const f=Math.max(0,h-u),d=u+f+1,g=c.width-f-1;a.has([c.sourceIndex,-1])&&e.rect(d,o,g,i-o)}),e.clip())}function Qr(e,t,n,o,i,r,l,s,a,c){let u=0;return It(e,r,o,i,n,(m,h,f,d,g)=>(Bn(g,f,t,l,s,a,c,void 0,(b,p,y,x)=>{x||(u=Math.max(p,u))}),!0)),u}function Yo(e,t){var Ht;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mappedColumns:u,enableGroups:m,freezeColumns:h,dragAndDropState:f,theme:d,drawFocus:g,headerHeight:b,groupHeaderHeight:p,groupLevels:y,groupHeaderHeights:x,disabledRows:C,rowHeight:B,verticalBorder:P,overrideCursor:H,isResizing:F,selection:k,fillHandle:R,freezeTrailingRows:E,rows:S,getCellContent:I,getGroupDetails:M,getRowThemeOverride:Y,isFocused:z,drawHeaderCallback:ne,prelightCells:J,drawCellCallback:K,highlightRegions:Q,resizeCol:ue,imageLoader:we,lastBlitData:fe,hoverValues:Xe,hyperWrapping:q,hoverInfo:ke,spriteManager:Be,maxScaleFactor:N,hasAppendRow:ye,touchMode:V,enqueue:he,renderStateProvider:Pe,getCellRenderer:De,renderStrategy:_e,bufferACtx:et,bufferBCtx:tt,damage:de,minimumCellWidth:pt,resizeIndicator:ht}=e;if(i===0||r===0)return;const qe=_e==="double-buffer",re=Math.min(N,Math.ceil(window.devicePixelRatio??1)),Ue=_e!=="direct"&&Gr(e,t),Re=n.canvas;(Re.width!==i*re||Re.height!==r*re)&&(Re.width=i*re,Re.height=r*re,Re.style.width=i+"px",Re.style.height=r+"px");const Ye=o.canvas,Me=x.reduce((me,Ke)=>me+Ke,0),ie=b+Me,ge=ie+1;(Ye.width!==i*re||Ye.height!==ge*re)&&(Ye.width=i*re,Ye.height=ge*re,Ye.style.width=i+"px",Ye.style.height=ge+"px");const ve=et.canvas,nt=tt.canvas;qe&&(ve.width!==i*re||ve.height!==r*re)&&(ve.width=i*re,ve.height=r*re,fe.current!==void 0&&(fe.current.aBufferScroll=void 0)),qe&&(nt.width!==i*re||nt.height!==r*re)&&(nt.width=i*re,nt.height=r*re,fe.current!==void 0&&(fe.current.bBufferScroll=void 0));const D=fe.current;if(Ue===!0&&l===(D==null?void 0:D.cellXOffset)&&s===(D==null?void 0:D.cellYOffset)&&a===(D==null?void 0:D.translateX)&&c===(D==null?void 0:D.translateY))return;let Fe=null;qe&&(Fe=n);const xe=o;let L;qe?de!==void 0?L=(D==null?void 0:D.lastBuffer)==="b"?tt:et:L=(D==null?void 0:D.lastBuffer)==="b"?et:tt:L=n;const He=L.canvas,Ie=qe?He===ve?nt:ve:Re,oe=typeof B=="number"?()=>B:B;xe.save(),L.save(),xe.beginPath(),L.beginPath(),xe.textBaseline="middle",L.textBaseline="middle",re!==1&&(xe.scale(re,re),L.scale(re,re));const te=Jn(u,l,i,f,a);let Te=[];const ot=g&&((Ht=k.current)==null?void 0:Ht.cell[1])===s&&c===0;let Ve=!1;if(Q!==void 0){for(const me of Q)if(me.style!=="no-outline"&&me.range.y===s&&c===0){Ve=!0;break}}const at=()=>{xe.fillStyle=d.bgHeader,xe.fillRect(0,0,i,ie+1),Xr(xe,te,u,m,ke,i,a,b,p,f,F,k,d,Be,Xe,P,M,de,ne,V,y,x),No(xe,te,s,a,c,i,r,void 0,void 0,Me,ie,oe,Y,P,E,S,d,!0),xe.beginPath(),xe.moveTo(0,ge-.5),xe.lineTo(i,ge-.5),xe.strokeStyle=Qe(d.headerBottomBorderColor??d.horizontalBorderColor??d.borderColor,d.bgHeader),xe.stroke(),Ve&&Oo(xe,i,r,l,s,a,c,u,h,b,Me,B,E,S,Q,d),ot&&Yn(xe,i,r,s,a,c,te,u,d,ie,k,oe,I,E,ye,R,S)};if(de!==void 0){const me=te[te.length-1].sourceIndex+1,Ke=de.hasItemInRegion([{x:l,y:-2,width:me,height:2},{x:l,y:s,width:me,height:300},{x:0,y:s,width:h,height:300},{x:0,y:-2,width:h,height:2},{x:l,y:S-E,width:me,height:E,when:E>0}]),it=rt=>{zo(rt,te,u,r,ie,a,c,s,S,oe,I,M,Y,C,z,g,E,ye,Te,de,k,J,Q,we,Be,Xe,ke,K,q,d,he,Pe,De,H,pt);const gt=k.current;R!==!1&&R!==void 0&&g&&gt!==void 0&&de.has(ri(gt.range))&&Yn(rt,i,r,s,a,c,te,u,d,ie,k,oe,I,E,ye,R,S)};Ke&&(it(L),Fe!==null&&(Fe.save(),Fe.scale(re,re),Fe.textBaseline="middle",it(Fe),Fe.restore()),de.hasHeader()&&(Jr(xe,te,i,Me,ie,a,c,s,de),at())),L.restore(),xe.restore();return}if((Ue!==!0||l!==(D==null?void 0:D.cellXOffset)||s!==(D==null?void 0:D.cellYOffset)||a!==(D==null?void 0:D.translateX)||c!==(D==null?void 0:D.translateY)||ot!==(D==null?void 0:D.mustDrawFocusOnHeader)||Ve!==(D==null?void 0:D.mustDrawHighlightRingsOnHeader))&&at(),Ue===!0){yt(Ie!==void 0&&D!==void 0);const{regions:me}=jr(L,Ie,Ie===ve?D.aBufferScroll:D.bBufferScroll,Ie===ve?D.bBufferScroll:D.aBufferScroll,D,l,s,a,c,E,i,r,S,ie,re,u,te,B,qe);Te=me}else Ue!==!1&&(yt(D!==void 0),Te=Kr(D,l,s,a,c,i,r,ie,te,Ue));Ur(L,te,i,r,E,S,P,oe,d);const Oe=Oo(L,i,r,l,s,a,c,u,h,b,Me,B,E,S,Q,d),ct=g?Yn(L,i,r,s,a,c,te,u,d,ie,k,oe,I,E,ye,R,S):void 0;if(L.fillStyle=d.bgCell,Te.length>0){L.beginPath();for(const me of Te)L.rect(me.x,me.y,me.width,me.height);L.clip(),L.fill(),L.beginPath()}else L.fillRect(0,0,i,r);const je=zo(L,te,u,r,ie,a,c,s,S,oe,I,M,Y,C,z,g,E,ye,Te,de,k,J,Q,we,Be,Xe,ke,K,q,d,he,Pe,De,H,pt);qr(L,te,u,i,r,ie,a,c,s,S,oe,Y,k.rows,C,E,ye,Te,de,d),Vr(L,te,s,a,c,i,r,Te,ie,oe,Y,P,E,S,d),No(L,te,s,a,c,i,r,Te,je,Me,ie,oe,Y,P,E,S,d),Oe==null||Oe(),ct==null||ct(),F&&ht!=="none"&&It(te,0,a,0,ie,(me,Ke)=>me.sourceIndex===ue?(Xo(xe,Ke+me.width,0,ie+1,Qe(d.resizeIndicatorColor??d.accentLight,d.bgHeader)),ht==="full"&&Xo(L,Ke+me.width,ie,r,Qe(d.resizeIndicatorColor??d.accentLight,d.bgCell)),!0):!1),Fe!==null&&(Fe.fillStyle=d.bgCell,Fe.fillRect(0,0,i,r),Fe.drawImage(L.canvas,0,0));const Et=Qr(te,r,ie,a,c,s,S,oe,E,ye);we==null||we.setWindow({x:l,y:s,width:te.length,height:Et-s},h,Array.from({length:E},(me,Ke)=>S-1-Ke));const Ft=D!==void 0&&(l!==D.cellXOffset||a!==D.translateX),Ee=D!==void 0&&(s!==D.cellYOffset||c!==D.translateY);fe.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mustDrawFocusOnHeader:ot,mustDrawHighlightRingsOnHeader:Ve,lastBuffer:qe?He===ve?"a":"b":void 0,aBufferScroll:He===ve?[Ft,Ee]:D==null?void 0:D.aBufferScroll,bBufferScroll:He===nt?[Ft,Ee]:D==null?void 0:D.bBufferScroll},L.restore(),xe.restore()}const Zr=80;function es(e){const t=e-1;return t*t*t+1}class ts{constructor(t){ee(this,"currentHoveredItem");ee(this,"leavingItems",[]);ee(this,"lastAnimationTime");ee(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>Sn(o.item,t.item))||this.leavingItems.push(t)});ee(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>Sn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});ee(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});ee(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});ee(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:es(t.hoverAmount)})));ee(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Zr;for(const r of this.leavingItems)r.hoverAmount=Mn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=Mn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});ee(this,"setHovered",t=>{var n;if(!Sn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class ns{constructor(t){ee(this,"fn");ee(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function uo(e){return new ns(e)}const os=uo(()=>window.navigator.userAgent.includes("Firefox")),$o=uo(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Hl=uo(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function is(e){const t=v.useRef([]),n=v.useRef(0),o=v.useRef(e);o.current=e;const i=v.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(ao);t.current=[],o.current(new Vt(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return v.useCallback(r=>{t.current.length===0&&i();const l=lt(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const Wt="header",sn="group-header",_o="out-of-bounds";var ln=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(ln||{});function rs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const ss=(e,t)=>{if(e.kind===ce.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},ls=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:c=!1,groupHeaderHeight:u,groupLevels:m,groupHeaderHeights:h,rowHeight:f,rows:d,getCellContent:g,getRowThemeOverride:b,onHeaderMenuClick:p,onHeaderIndicatorClick:y,enableGroups:x,isFilling:C,onCanvasFocused:B,onCanvasBlur:P,isFocused:H,selection:F,freezeColumns:k,onContextMenu:R,freezeTrailingRows:E,fixedShadowX:S=!0,fixedShadowY:I=!0,drawFocusRing:M,onMouseDown:Y,onMouseUp:z,onMouseMoveRaw:ne,onMouseMove:J,onItemHovered:K,dragAndDropState:Q,firstColAccessible:ue,onKeyDown:we,onKeyUp:fe,highlightRegions:Xe,canvasRef:q,onDragStart:ke,onDragEnd:Be,eventTargetRef:N,isResizing:ye,resizeColumn:V,isDragging:he,isDraggable:Pe=!1,allowResize:De,disabledRows:_e,hasAppendRow:et,getGroupDetails:tt,theme:de,prelightCells:pt,headerIcons:ht,verticalBorder:qe,drawCell:re,drawHeader:Ue,onCellFocused:Re,onDragOverCell:Ye,onDrop:Me,onDragLeave:ie,imageWindowLoader:ge,smoothScrollX:ve=!1,smoothScrollY:nt=!1,experimental:D,getCellRenderer:Fe,resizeIndicator:xe="full"}=e,L=e.translateX??0,He=e.translateY??0,Ie=Math.max(k,Math.min(r.length-1,l)),oe=v.useRef(null),te=v.useRef((D==null?void 0:D.eventTarget)??window),Te=te.current,ot=ge,Ve=v.useRef(),[at,Oe]=v.useState(!1),ct=v.useRef([]),je=v.useRef(),[Et,Ft]=v.useState(),[Ee,Ht]=v.useState(),me=v.useRef(null),[Ke,it]=v.useState(),[rt,gt]=v.useState(!1),Bt=v.useRef(rt);Bt.current=rt;const U=v.useMemo(()=>new Br(ht,()=>{fn.current=void 0,Qt.current()}),[ht]),se=x?u+a:a,le=v.useRef(-1),Ge=((D==null?void 0:D.enableFirefoxRescaling)??!1)&&os.value,Je=((D==null?void 0:D.enableSafariRescaling)??!1)&&$o.value;v.useLayoutEffect(()=>{window.devicePixelRatio===1||!Ge&&!Je||(le.current!==-1&&Oe(!0),window.clearTimeout(le.current),le.current=window.setTimeout(()=>{Oe(!1),le.current=-1},200))},[s,Ie,L,He,Ge,Je]);const G=hr(r,k),Pn=v.useMemo(()=>S?Kt(G,Q):0,[G,Q,S]),ze=v.useCallback((w,A,O)=>{const X=w.getBoundingClientRect();if(A>=G.length||O>=d)return;const T=X.width/n,W=Qn(A,O,n,o,u,se,Ie,s,L,He,d,k,E,G,f,m,h);return T!==1&&(W.x*=T,W.y*=T,W.width*=T,W.height*=T),W.x+=X.x,W.y+=X.y,W},[n,o,u,se,Ie,s,L,He,d,k,E,G,f,m,h]),Le=v.useCallback((w,A,O,X)=>{const T=w.getBoundingClientRect(),W=T.width/n,j=(A-T.left)/W,Z=(O-T.top)/W,$=5,Ne=Jn(G,Ie,n,void 0,L);let _=0,ae=0;const Se=typeof PointerEvent<"u"&&X instanceof PointerEvent&&X.pointerType==="mouse"||typeof MouseEvent<"u"&&X instanceof MouseEvent,pe=typeof PointerEvent<"u"&&X instanceof PointerEvent&&X.pointerType==="touch"||typeof TouchEvent<"u"&&X instanceof TouchEvent;Se&&(_=X.button,ae=X.buttons);const Ce=vr(j,Ne,L),Ae=pr(Z,o,x,a,u,d,f,s,He,E,m,h),We=(X==null?void 0:X.shiftKey)===!0,mt=(X==null?void 0:X.ctrlKey)===!0,wt=(X==null?void 0:X.metaKey)===!0,dt=[j<0?-1:n<j?1:0,Z<se?-1:o<Z?1:0];let kt;if(Ce===-1||Z<0||j<0||Ae===void 0||j>n||Z>o){const be=j>n?1:j<0?-1:0,xt=Z>o?1:Z<0?-1:0;let bt=be*2,qt=xt*2;be===0&&(bt=Ce===-1?ln.EndPadding:ln.Center),xt===0&&(qt=Ae===void 0?ln.EndPadding:ln.Center);let st=!1;if(Ce===-1&&Ae===-1){const Ut=ze(w,G.length-1,-1);yt(Ut!==void 0),st=A<Ut.x+Ut.width+$}const en=j>n&&j<n+Po()||Z>o&&Z<o+Po();kt={kind:_o,location:[Ce!==-1?Ce:j<0?0:G.length-1,Ae??d-1],region:[bt,qt],shiftKey:We,ctrlKey:mt,metaKey:wt,isEdge:st,isTouch:pe,button:_,buttons:ae,scrollEdge:dt,isMaybeScrollbar:en}}else if(Ae<=-1){let be=ze(w,Ce,Ae);yt(be!==void 0);let xt=be!==void 0&&be.x+be.width-A<=$;const bt=x&&Ae<=-2,qt=bt?-(Ae+2):void 0,st=Ce-1;A-be.x<=$&&st>=0?(xt=!0,be=ze(w,st,Ae),yt(be!==void 0),kt={kind:bt?sn:Wt,location:[st,Ae],bounds:be,group:Lt(G[st].group,qt),isEdge:xt,shiftKey:We,ctrlKey:mt,metaKey:wt,isTouch:pe,localEventX:A-be.x,localEventY:O-be.y,button:_,buttons:ae,scrollEdge:dt}):kt={kind:bt?sn:Wt,group:Lt(G[Ce].group,qt),location:[Ce,Ae],bounds:be,isEdge:xt,shiftKey:We,ctrlKey:mt,metaKey:wt,isTouch:pe,localEventX:A-be.x,localEventY:O-be.y,button:_,buttons:ae,scrollEdge:dt}}else{const be=ze(w,Ce,Ae);yt(be!==void 0);const xt=be!==void 0&&be.x+be.width-A<$;let bt=!1;if(c!==!1&&c!==void 0&&F.current!==void 0){const st=typeof c=="object"?{...En,...c}:En,en=st.size,Ut=en/2,Eo=ri(F.current.range),tn=ze(w,Eo[0],Eo[1]);if(tn!==void 0){const _i=tn.x+tn.width+st.offsetX-Ut+.5,qi=tn.y+tn.height+st.offsetY-Ut+.5;bt=Math.abs(_i-A)<en&&Math.abs(qi-O)<en}}kt={kind:"cell",location:[Ce,Ae],bounds:be,isEdge:xt,shiftKey:We,ctrlKey:mt,isFillHandle:bt,metaKey:wt,isTouch:pe,localEventX:A-be.x,localEventY:O-be.y,button:_,buttons:ae,scrollEdge:dt}}return kt},[n,G,Ie,L,o,x,a,u,d,f,s,He,E,ze,c,F,se]),[Pt]=Et??[],ho=v.useRef(()=>{}),Xt=v.useRef(Et);Xt.current=Et;const[At,Dt]=v.useMemo(()=>{const w=document.createElement("canvas"),A=document.createElement("canvas");return w.style.display="none",w.style.opacity="0",w.style.position="fixed",A.style.display="none",A.style.opacity="0",A.style.position="fixed",[w.getContext("2d",{alpha:!1}),A.getContext("2d",{alpha:!1})]},[]);v.useLayoutEffect(()=>{if(!(At===null||Dt===null))return document.documentElement.append(At.canvas),document.documentElement.append(Dt.canvas),()=>{At.canvas.remove(),Dt.canvas.remove()}},[At,Dt]);const un=v.useMemo(()=>new Fr,[]),go=Ge&&at?1:Je&&at?2:5,mo=(D==null?void 0:D.disableMinimumCellWidth)===!0?1:10,fn=v.useRef(),hn=v.useRef(null),gn=v.useRef(null),mn=v.useCallback(()=>{var j;const w=oe.current,A=me.current;if(w===null||A===null||(hn.current===null&&(hn.current=w.getContext("2d",{alpha:!1}),w.width=0,w.height=0),gn.current===null&&(gn.current=A.getContext("2d",{alpha:!1}),A.width=0,A.height=0),hn.current===null||gn.current===null||At===null||Dt===null))return;let O=!1;const X=Z=>{O=!0,it(Z)},T=fn.current,W={headerCanvasCtx:gn.current,canvasCtx:hn.current,bufferACtx:At,bufferBCtx:Dt,width:n,height:o,cellXOffset:Ie,cellYOffset:s,translateX:Math.round(L),translateY:Math.round(He),mappedColumns:G,enableGroups:x,freezeColumns:k,dragAndDropState:Q,theme:de,headerHeight:a,groupHeaderHeight:u,groupLevels:m,groupHeaderHeights:h,disabledRows:_e??jn.empty(),rowHeight:f,verticalBorder:qe,isResizing:ye,resizeCol:V,isFocused:H,selection:F,fillHandle:c,drawCellCallback:re,hasAppendRow:et,overrideCursor:X,maxScaleFactor:go,freezeTrailingRows:E,rows:d,drawFocus:M,getCellContent:g,getGroupDetails:tt??(Z=>({name:Z})),getRowThemeOverride:b,drawHeaderCallback:Ue,prelightCells:pt,highlightRegions:Xe,imageLoader:ot,lastBlitData:je,damage:Ve.current,hoverValues:ct.current,hoverInfo:Xt.current,spriteManager:U,scrolling:at,hyperWrapping:(D==null?void 0:D.hyperWrapping)??!1,touchMode:rt,enqueue:ho.current,renderStateProvider:un,renderStrategy:(D==null?void 0:D.renderStrategy)??($o.value?"double-buffer":"single-buffer"),getCellRenderer:Fe,minimumCellWidth:mo,resizeIndicator:xe};W.damage===void 0?(fn.current=W,Yo(W,T)):Yo(W,void 0),!O&&(W.damage===void 0||W.damage.has((j=Xt==null?void 0:Xt.current)==null?void 0:j[0]))&&it(void 0)},[At,Dt,n,o,Ie,s,L,He,G,x,k,Q,de,a,u,m,h,_e,f,qe,ye,et,V,H,F,c,E,d,M,go,g,tt,b,re,Ue,pt,Xe,ot,U,at,D==null?void 0:D.hyperWrapping,D==null?void 0:D.renderStrategy,rt,un,Fe,mo,xe]),Qt=v.useRef(mn);v.useLayoutEffect(()=>{mn(),Qt.current=mn},[mn]),v.useLayoutEffect(()=>{(async()=>{var A;((A=document==null?void 0:document.fonts)==null?void 0:A.ready)!==void 0&&(await document.fonts.ready,fn.current=void 0,Qt.current())})()},[]);const Yt=v.useCallback(w=>{Ve.current=w,Qt.current(),Ve.current=void 0},[]),xi=is(Yt);ho.current=xi;const bo=v.useCallback(w=>{Yt(new Vt(w.map(A=>A.cell)))},[Yt]);ot.setCallback(Yt);const[Si,Ci]=v.useState(!1),[Rt,$t]=Pt??[],Mi=Rt!==void 0&&$t===-1&&Rt>=0&&Rt<G.length&&G[Rt].headerRowMarkerDisabled!==!0,Ii=Rt!==void 0&&$t===-2;let yo=!1,vo=!1,bn=Ke;if(bn===void 0&&Rt!==void 0&&$t!==void 0&&$t>-1&&$t<d){const w=g([Rt,$t],!0);yo=w.kind===Mt.NewRow||w.kind===Mt.Marker&&w.markerKind!=="number",vo=w.kind===ce.Boolean&&oo(w),bn=w.cursor}const po=he?"grabbing":(Ee??!1)||ye?"col-resize":Si||C?"crosshair":bn!==void 0?bn:Mi||yo||vo||Ii?"pointer":"default",An=v.useMemo(()=>({contain:"strict",display:"block",cursor:po}),[po]),wo=v.useRef("default"),Dn=N==null?void 0:N.current;Dn!=null&&wo.current!==An.cursor&&(Dn.style.cursor=wo.current=An.cursor);const yn=v.useCallback((w,A,O,X)=>{if(tt===void 0)return;const T=tt(w);if(T.actions!==void 0){const W=co(A,T.actions);for(const[j,Z]of W.entries())if(zt(Z,O+A.x,X+Z.y))return T.actions[j]}},[tt]),_t=v.useCallback((w,A,O,X)=>{const T=G[A];if(!he&&!ye&&!(Ee??!1)){const W=ze(w,A,-1);yt(W!==void 0);const j=yi(void 0,T,W.x,W.y,W.width,W.height,de,ro(T.title)==="rtl");if(T.hasMenu===!0&&j.menuBounds!==void 0&&zt(j.menuBounds,O,X))return{area:"menu",bounds:j.menuBounds};if(T.indicatorIcon!==void 0&&j.indicatorIconBounds!==void 0&&zt(j.indicatorIconBounds,O,X))return{area:"indicator",bounds:j.indicatorIconBounds}}},[G,ze,Ee,he,ye,de]),Rn=v.useRef(0),Zt=v.useRef(),Tn=v.useRef(!1),Ei=v.useCallback(w=>{const A=oe.current,O=N==null?void 0:N.current;if(A===null||w.target!==A&&w.target!==O)return;Tn.current=!0;const X=w.clientX,T=w.clientY;if(w.target===O&&O!==null){const j=O.getBoundingClientRect();if(X>j.right||T>j.bottom)return}const W=Le(A,X,T,w);Zt.current=W.location,W.isTouch&&(Rn.current=Date.now()),Bt.current!==W.isTouch&&gt(W.isTouch),!(W.kind===Wt&&_t(A,W.location[0],X,T)!==void 0)&&(W.kind===sn&&yn(W.group,W.bounds,W.localEventX,W.localEventY)!==void 0||(Y==null||Y(W),!W.isTouch&&Pe!==!0&&Pe!==W.kind&&W.button<3&&W.button!==1&&w.preventDefault()))},[N,Pe,Le,yn,_t,Y]);ut("pointerdown",Ei,Te,!1);const ko=v.useRef(0),Fi=v.useCallback(w=>{var ae,Se;const A=ko.current;ko.current=Date.now();const O=oe.current;if(Tn.current=!1,z===void 0||O===null)return;const X=N==null?void 0:N.current,T=w.target!==O&&w.target!==X,W=w.clientX,j=w.clientY,Z=w.pointerType==="mouse"?w.button<3:!0;let $=Le(O,W,j,w);$.isTouch&&Rn.current!==0&&Date.now()-Rn.current>500&&($={...$,isLongTouch:!0}),A!==0&&Date.now()-A<($.isTouch?1e3:500)&&($={...$,isDoubleClick:!0}),Bt.current!==$.isTouch&&gt($.isTouch),!T&&w.cancelable&&Z&&w.preventDefault();const[Ne]=$.location,_=_t(O,Ne,W,j);if($.kind===Wt&&_!==void 0){($.button!==0||((ae=Zt.current)==null?void 0:ae[0])!==Ne||((Se=Zt.current)==null?void 0:Se[1])!==-1)&&z($,!0);return}else if($.kind===sn){const pe=yn($.group,$.bounds,$.localEventX,$.localEventY);if(pe!==void 0){$.button===0&&pe.onClick($);return}}z($,T)},[z,N,Le,_t,yn]);ut("pointerup",Fi,Te,!1);const Hi=v.useCallback(w=>{var Ne,_;const A=oe.current;if(A===null)return;const O=N==null?void 0:N.current,X=w.target!==A&&w.target!==O;let T,W,j=!0;w instanceof MouseEvent?(T=w.clientX,W=w.clientY,j=w.button<3):(T=w.changedTouches[0].clientX,W=w.changedTouches[0].clientY);const Z=Le(A,T,W,w);Bt.current!==Z.isTouch&&gt(Z.isTouch),!X&&w.cancelable&&j&&w.preventDefault();const[$]=Z.location;if(Z.kind===Wt){const ae=_t(A,$,T,W);ae!==void 0&&Z.button===0&&((Ne=Zt.current)==null?void 0:Ne[0])===$&&((_=Zt.current)==null?void 0:_[1])===-1&&(ae.area==="menu"?p==null||p($,ae.bounds):ae.area==="indicator"&&(y==null||y($,ae.bounds)))}},[N,Le,_t,p,y]);ut("click",Hi,Te,!1);const Bi=v.useCallback(w=>{const A=oe.current,O=N==null?void 0:N.current;if(A===null||w.target!==A&&w.target!==O||R===void 0)return;const X=Le(A,w.clientX,w.clientY,w);R(X,()=>{w.cancelable&&w.preventDefault()})},[N,Le,R]);ut("contextmenu",Bi,(N==null?void 0:N.current)??null,!1);const xo=v.useCallback(w=>{Ve.current=new Vt(w.map(A=>A.item)),ct.current=w,Qt.current(),Ve.current=void 0},[]),So=v.useMemo(()=>new ts(xo),[xo]),Co=v.useRef(So);Co.current=So,v.useLayoutEffect(()=>{const w=Co.current;if(Pt===void 0||Pt[1]<0){w.setHovered(Pt);return}const A=g(Pt,!0),O=Fe(A),X=O===void 0&&A.kind===ce.Custom||(O==null?void 0:O.needsHover)!==void 0&&(typeof O.needsHover=="boolean"?O.needsHover:O.needsHover(A));w.setHovered(X?Pt:void 0)},[g,Fe,Pt]);const Mo=v.useRef(),Pi=v.useCallback(w=>{var Z;const A=oe.current;if(A===null)return;const O=N==null?void 0:N.current,X=w.target!==A&&w.target!==O,T=Le(A,w.clientX,w.clientY,w);if(T.kind!=="out-of-bounds"&&X&&!Tn.current&&!T.isTouch)return;const W=($,Ne)=>{Ft(_=>_===$||(_==null?void 0:_[0][0])===($==null?void 0:$[0][0])&&(_==null?void 0:_[0][1])===($==null?void 0:$[0][1])&&((_==null?void 0:_[1][0])===($==null?void 0:$[1][0])&&(_==null?void 0:_[1][1])===($==null?void 0:$[1][1])||!Ne)?_:$)};if(!rs(T,Mo.current))it(void 0),K==null||K(T),W(T.kind===_o?void 0:[T.location,[T.localEventX,T.localEventY]],!0),Mo.current=T;else if(T.kind==="cell"||T.kind===Wt||T.kind===sn){let $=!1,Ne=!0;if(T.kind==="cell"){const ae=g(T.location);Ne=((Z=Fe(ae))==null?void 0:Z.needsHoverPosition)??ae.kind===ce.Custom,$=Ne}else $=!0;const _=[T.location,[T.localEventX,T.localEventY]];W(_,Ne),Xt.current=_,$&&Yt(new Vt([T.location]))}const j=T.location[0]>=(ue?0:1);Ht(T.kind===Wt&&T.isEdge&&j&&De===!0),Ci(T.kind==="cell"&&T.isFillHandle),ne==null||ne(w),J(T)},[N,Le,ue,De,ne,J,K,g,Fe,Yt]);ut("pointermove",Pi,Te,!0);const Ai=v.useCallback(w=>{const A=oe.current;if(A===null)return;let O,X;F.current!==void 0&&(O=ze(A,F.current.cell[0],F.current.cell[1]),X=F.current.cell),we==null||we({bounds:O,stopPropagation:()=>w.stopPropagation(),preventDefault:()=>w.preventDefault(),cancel:()=>{},ctrlKey:w.ctrlKey,metaKey:w.metaKey,shiftKey:w.shiftKey,altKey:w.altKey,key:w.key,keyCode:w.keyCode,rawEvent:w,location:X})},[we,F,ze]),Di=v.useCallback(w=>{const A=oe.current;if(A===null)return;let O,X;F.current!==void 0&&(O=ze(A,F.current.cell[0],F.current.cell[1]),X=F.current.cell),fe==null||fe({bounds:O,stopPropagation:()=>w.stopPropagation(),preventDefault:()=>w.preventDefault(),cancel:()=>{},ctrlKey:w.ctrlKey,metaKey:w.metaKey,shiftKey:w.shiftKey,altKey:w.altKey,key:w.key,keyCode:w.keyCode,rawEvent:w,location:X})},[fe,F,ze]),Ri=v.useCallback(w=>{if(oe.current=w,q!==void 0&&(q.current=w),D!=null&&D.eventTarget)te.current=D.eventTarget;else if(w===null)te.current=window;else{const A=w.getRootNode();A===document&&(te.current=window),te.current=A}},[q,D==null?void 0:D.eventTarget]),Ti=v.useCallback(w=>{const A=oe.current;if(A===null||Pe===!1||ye){w.preventDefault();return}let O,X;const T=Le(A,w.clientX,w.clientY);if(Pe!==!0&&T.kind!==Pe){w.preventDefault();return}const W=(ae,Se)=>{O=ae,X=Se};let j,Z,$;const Ne=(ae,Se,pe)=>{j=ae,Z=Se,$=pe};let _=!1;if(ke==null||ke({...T,setData:W,setDragImage:Ne,preventDefault:()=>_=!0,defaultPrevented:()=>_}),!_&&O!==void 0&&X!==void 0&&w.dataTransfer!==null)if(w.dataTransfer.setData(O,X),w.dataTransfer.effectAllowed="copyLink",j!==void 0&&Z!==void 0&&$!==void 0)w.dataTransfer.setDragImage(j,Z,$);else{const[ae,Se]=T.location;if(Se!==void 0){const pe=document.createElement("canvas"),Ce=ze(A,ae,Se);yt(Ce!==void 0);const Ae=Math.ceil(window.devicePixelRatio??1);pe.width=Ce.width*Ae,pe.height=Ce.height*Ae;const We=pe.getContext("2d");We!==null&&(We.scale(Ae,Ae),We.textBaseline="middle",Se===-1?(We.font=de.headerFontFull,We.fillStyle=de.bgHeader,We.fillRect(0,0,pe.width,pe.height),vi(We,0,0,Ce.width,Ce.height,G[ae],!1,de,!1,void 0,void 0,!1,0,U,Ue,!1)):(We.font=de.baseFontFull,We.fillStyle=de.bgCell,We.fillRect(0,0,pe.width,pe.height),bi(We,g([ae,Se]),0,Se,!1,!1,0,0,Ce.width,Ce.height,!1,de,de.bgCell,ot,U,1,void 0,!1,0,void 0,void 0,void 0,un,Fe,()=>{},0))),pe.style.left="-100%",pe.style.position="absolute",pe.style.width=`${Ce.width}px`,pe.style.height=`${Ce.height}px`,document.body.append(pe),w.dataTransfer.setDragImage(pe,Ce.width/2,Ce.height/2),window.setTimeout(()=>{pe.remove()},0)}}else w.preventDefault()},[Pe,ye,Le,ke,ze,de,G,U,Ue,g,ot,un,Fe]);ut("dragstart",Ti,(N==null?void 0:N.current)??null,!1,!1);const Wn=v.useRef(),Wi=v.useCallback(w=>{const A=oe.current;if(Me!==void 0&&w.preventDefault(),A===null||Ye===void 0)return;const O=Le(A,w.clientX,w.clientY),[X,T]=O.location,W=X-(ue?0:1),[j,Z]=Wn.current??[];(j!==W||Z!==T)&&(Wn.current=[W,T],Ye([W,T],w.dataTransfer))},[ue,Le,Ye,Me]);ut("dragover",Wi,(N==null?void 0:N.current)??null,!1,!1);const zi=v.useCallback(()=>{Wn.current=void 0,Be==null||Be()},[Be]);ut("dragend",zi,(N==null?void 0:N.current)??null,!1,!1);const Li=v.useCallback(w=>{const A=oe.current;if(A===null||Me===void 0)return;w.preventDefault();const O=Le(A,w.clientX,w.clientY),[X,T]=O.location,W=X-(ue?0:1);Me([W,T],w.dataTransfer)},[ue,Le,Me]);ut("drop",Li,(N==null?void 0:N.current)??null,!1,!1);const Ni=v.useCallback(()=>{ie==null||ie()},[ie]);ut("dragleave",Ni,(N==null?void 0:N.current)??null,!1,!1);const Io=v.useRef(F);Io.current=F;const vn=v.useRef(null),zn=v.useCallback(w=>{var A;oe.current===null||!oe.current.contains(document.activeElement)||(w===null&&Io.current.current!==void 0?(A=q==null?void 0:q.current)==null||A.focus({preventScroll:!0}):w!==null&&w.focus({preventScroll:!0}),vn.current=w)},[q]);v.useImperativeHandle(t,()=>({focus:()=>{var A;const w=vn.current;w===null||!document.contains(w)?(A=q==null?void 0:q.current)==null||A.focus({preventScroll:!0}):w.focus({preventScroll:!0})},getBounds:(w,A)=>{if(!(q===void 0||q.current===null))return ze(q.current,w??0,A??-1)},damage:bo,getMouseArgsForPosition:(w,A,O)=>{if(!(q===void 0||q.current===null))return Le(q.current,w,A,O)}}),[q,bo,ze,Le]);const Ln=v.useRef(),Oi=cr(()=>{var Z,$,Ne;if(n<50||(D==null?void 0:D.disableAccessibilityTree)===!0)return null;let w=Jn(G,Ie,n,Q,L);const A=ue?0:-1;!ue&&((Z=w[0])==null?void 0:Z.sourceIndex)===0&&(w=w.slice(1));const[O,X]=(($=F.current)==null?void 0:$.cell)??[],T=(Ne=F.current)==null?void 0:Ne.range,W=w.map(_=>_.sourceIndex),j=Zi(s,Math.min(d,s+i));return O!==void 0&&X!==void 0&&!(W.includes(O)&&j.includes(X))&&zn(null),v.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":d+1,"aria-multiselectable":"true","aria-colcount":G.length+A},v.createElement("thead",{role:"rowgroup"},v.createElement("tr",{role:"row","aria-rowindex":1},w.map(_=>v.createElement("th",{role:"columnheader","aria-selected":F.columns.hasIndex(_.sourceIndex),"aria-colindex":_.sourceIndex+1+A,tabIndex:-1,onFocus:ae=>{if(ae.target!==vn.current)return Re==null?void 0:Re([_.sourceIndex,-1])},key:_.sourceIndex},_.title)))),v.createElement("tbody",{role:"rowgroup"},j.map(_=>v.createElement("tr",{role:"row","aria-selected":F.rows.hasIndex(_),key:_,"aria-rowindex":_+2},w.map(ae=>{const Se=ae.sourceIndex,pe=lt(Se,_),Ce=O===Se&&X===_,Ae=T!==void 0&&Se>=T.x&&Se<T.x+T.width&&_>=T.y&&_<T.y+T.height,We=`glide-cell-${Se}-${_}`,mt=[Se,_],wt=g(mt,!0);return v.createElement("td",{key:pe,role:"gridcell","aria-colindex":Se+1+A,"aria-selected":Ae,"aria-readonly":Zo(wt)||!sr(wt),id:We,"data-testid":We,onClick:()=>{const dt=q==null?void 0:q.current;if(dt!=null)return we==null?void 0:we({bounds:ze(dt,Se,_),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:mt})},onFocusCapture:dt=>{var kt,be;if(!(dt.target===vn.current||((kt=Ln.current)==null?void 0:kt[0])===Se&&((be=Ln.current)==null?void 0:be[1])===_))return Ln.current=mt,Re==null?void 0:Re(mt)},ref:Ce?zn:void 0,tabIndex:-1},ss(wt,Fe))})))))},[n,G,Ie,Q,L,d,s,i,F,zn,g,q,we,ze,Re],200),pn=k===0||!S?0:Ie>k?1:Mn(-L/100,0,1),Xi=-s*32+He,wn=I?Mn(-Xi/100,0,1):0,Yi=v.useMemo(()=>{if(!pn&&!wn)return null;const w={position:"absolute",top:0,left:Pn,width:n-Pn,height:o,opacity:pn,pointerEvents:"none",transition:ve?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},A={position:"absolute",top:se,left:0,width:n,height:o,opacity:wn,pointerEvents:"none",transition:nt?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return v.createElement(v.Fragment,null,pn>0&&v.createElement("div",{id:"shadow-x",style:w}),wn>0&&v.createElement("div",{id:"shadow-y",style:A}))},[pn,wn,Pn,n,ve,se,o,nt]),$i=v.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return v.createElement(v.Fragment,null,v.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Ai,onKeyUp:Di,onFocus:B,onBlur:P,ref:Ri,style:An},Oi),v.createElement("canvas",{ref:me,style:$i}),Yi)},Bl=v.memo(v.forwardRef(ls));function as(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case ce.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===no?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case ce.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case ce.Image:case ce.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case ce.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case ce.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case ce.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case ce.Markdown:case ce.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case ce.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case ce.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case ce.Protected:return{formatted:"************",rawValue:"",format:"string"};default:to()}}function cs(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:as(l))})}function qo(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function ds(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>qo(l,!0)).join(",")):i.push(r.doNotEscape===!0?r.formatted:qo(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function $n(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Uo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function us(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function fs(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${$n(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${Uo(i.rawValue[s])}>`+$n(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Uo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${$n(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function hs(e,t){const n=cs(e,t),o=ds(n),i=fs(n);return{textPlain:o,textHtml:i}}function Pl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),u=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,m=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",h=a.querySelectorAll("br");for(const g of h)g.replaceWith(`
`);const f=a.getAttribute("gdg-raw-value"),d=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:d});else if(a.querySelector("ol")!==null){const g=a.querySelectorAll("li");r==null||r.push({rawValue:[...g].map(b=>b.getAttribute("gdg-raw-value")??""),formatted:[...g].map(b=>b.textContent??""),format:"string-array"})}else if(f!==null)r==null||r.push({rawValue:us(f),formatted:a.textContent??"",format:d});else{let g=a.textContent??"";m&&(g=g.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:g??"",formatted:g??"",format:d})}}}return r!==void 0&&i.push(r),i}function Al(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,c=[];if(a.width>2){const h=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof h=="function")return r;c.push(...h);const f=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof f=="function")return r;c.push(...f)}else{const h=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof h=="function")return r;c.push(...h)}let u=a.x-n,m=a.x+a.width-1-n;for(const h of c)for(const f of h)f.span!==void 0&&(u=Math.min(f.span[0],u),m=Math.max(f.span[1],m));u===a.x-n&&m===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:a.y,width:m-u+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function Vo(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Dl(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push(Vo(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push(Vo(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function Rl(e,t,n){var s;const o=hs(e,t),i=a=>{var c;(c=window.navigator.clipboard)==null||c.writeText(a)},r=(a,c)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([c],{type:"text/html"})})]),!0)},l=(a,c)=>{var u,m;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",a),(m=n==null?void 0:n.clipboardData)==null||m.setData("text/html",c)}catch{r(a,c)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function gs(e){return e!==!0}function jo(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:c}=i,u=t.maxSize??r.checkboxMaxSize,m=Math.floor(i.y+s/2),h=ni(u,s,r.cellVerticalPadding),f=ti(t.contentAlign??"center",a,l,r.cellHorizontalPadding,h),d=ei(f,m,h),g=oi(a+n,c+o,d);return oo(t)&&g}const ms={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:ce.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>bs(e,e.cell.data,oo(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{jo(e)&&e.preventDefault()},onClick:e=>{if(jo(e))return{...e.cell,data:gs(e.cell.data)}},onPaste:(e,t)=>{let n=In;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=no),n===t.data?void 0:{...t,data:n}}};function bs(e,t,n,o,i){if(!n&&t===In)return;const{ctx:r,hoverAmount:l,theme:s,rect:a,highlighted:c,hoverX:u,hoverY:m,cell:{contentAlign:h}}=e,{x:f,y:d,width:g,height:b}=a;let p=!1;if(i>0){let y=n?1-i+i*l:.4;if(t===In&&(y*=l),y===0)return;y<1&&(p=!0,r.globalAlpha=y)}Fn(r,s,t,f,d,g,b,c,u,m,o,h),p&&(r.globalAlpha=1)}const ys=vt("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),vs=e=>{const{bubbles:t}=e;return v.createElement(ys,null,t.map((n,o)=>v.createElement("div",{key:o,className:"boe-bubble"},n)),v.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},ps={getAccessibilityString:e=>ii(e.data),kind:ce.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((i,r)=>e.measureText(r).width+i+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>ws(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return v.createElement(vs,{bubbles:t.data})},onPaste:()=>{}};function ws(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:c}=n;let u=l+o.cellHorizontalPadding;const m=[];for(const h of t){if(u>l+a)break;const f=Ot(h,i,o.baseFontFull).width;m.push({x:u,width:f}),u+=f+o.bubblePadding*2+o.bubbleMargin}i.beginPath();for(const h of m)ft(i,h.x,s+(c-o.bubbleHeight)/2,h.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[h,f]of m.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[h],f.x+o.bubblePadding,s+c/2+Ze(i,o))}const ks=vt("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),xs=e=>{const{drilldowns:t}=e;return v.createElement(ks,null,t.map((n,o)=>v.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&v.createElement("img",{src:n.img}),v.createElement("div",null,n.text))))},Ss={getAccessibilityString:e=>ii(e.data.map(t=>t.text)),kind:ce.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+n.bubblePadding*2+n.bubbleMargin+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Ms(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return v.createElement(xs,{drilldowns:t.data})},onPaste:()=>{}},_n={};function Cs(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,c=o+r,u=o*3,m=(u+r*2)*i,h=`${e},${t},${i},${n}`;if(_n[h]!==void 0)return{el:_n[h],height:a,width:m,middleWidth:s*i,sideWidth:c*i,padding:r*i,dpr:i};const f=document.createElement("canvas"),d=f.getContext("2d");return d===null?null:(f.width=m,f.height=a,d.scale(i,i),_n[h]=f,d.beginPath(),ft(d,r,r,u,l,o),d.shadowColor="rgba(24, 25, 34, 0.4)",d.shadowBlur=1,d.fillStyle=e,d.fill(),d.shadowColor="rgba(24, 25, 34, 0.3)",d.shadowOffsetY=1,d.shadowBlur=5,d.fillStyle=e,d.fill(),d.shadowOffsetY=0,d.shadowBlur=0,d.shadowBlur=0,d.beginPath(),ft(d,r+.5,r+.5,u,l,o),d.strokeStyle=t,d.lineWidth=1,d.stroke(),{el:f,height:a,width:m,sideWidth:c*i,middleWidth:o*i,padding:r*i,dpr:i})}function Ms(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:c}=n,u=o.baseFontFull,m=di(i,u),h=Math.min(n.height,Math.max(16,Math.ceil(m*o.lineHeight)*2)),f=Math.floor(n.y+(n.height-h)/2),d=h-10,g=o.bubblePadding,b=o.bubbleMargin;let p=a+o.cellHorizontalPadding;const y=o.roundingRadius??6,x=Cs(o.bgCell,o.drilldownBorder,h,y),C=[];for(const B of t){if(p>a+c)break;const H=Ot(B.text,i,u).width;let F=0;B.img!==void 0&&r.loadOrGetImage(B.img,l,s)!==void 0&&(F=d-8+4);const k=H+F+g*2;C.push({x:p,width:k}),p+=k+b}if(x!==null){const{el:B,height:P,middleWidth:H,sideWidth:F,width:k,dpr:R,padding:E}=x,S=F/R,I=E/R;for(const M of C){const Y=Math.floor(M.x),z=Math.floor(M.width),ne=z-(S-I)*2;i.imageSmoothingEnabled=!1,i.drawImage(B,0,0,F,P,Y-I,f,S,h),ne>0&&i.drawImage(B,F,0,H,P,Y+(S-I),f,ne,h),i.drawImage(B,k-F,0,F,P,Y+z-(S-I),f,S,h),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[B,P]of C.entries()){const H=t[B];let F=P.x+g;if(H.img!==void 0){const k=r.loadOrGetImage(H.img,l,s);if(k!==void 0){const R=d-8;let E=0,S=0,I=k.width,M=k.height;I>M?(E+=(I-M)/2,I=M):M>I&&(S+=(M-I)/2,M=I),i.beginPath(),ft(i,F,f+h/2-R/2,R,R,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(k,E,S,I,M,F,f+h/2-R/2,R,R),i.restore(),F+=R+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(H.text,F,f+h/2+Ze(i,o))}}const Is=vt("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),Es=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return v.createElement(Is,{"data-testid":"GDG-default-image-overlay-editor"},v.createElement(er.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},r.map(s=>{const a=(i==null?void 0:i(s))??v.createElement("img",{draggable:!1,src:s});return v.createElement("div",{className:"gdg-centering-container",key:s},a)})),n&&o&&v.createElement("button",{className:"gdg-edit-icon",onClick:o},v.createElement(io,null)))},Fs={getAccessibilityString:e=>e.data.join(", "),kind:ce.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Hs(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??Es;return v.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},qn=4;function Hs(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:c}=e,{x:u,y:m,height:h,width:f}=i,d=h-s.cellVerticalPadding*2,g=[];let b=0;for(let y=0;y<t.length;y++){const x=t[y];if(x.length===0)continue;const C=c.loadOrGetImage(x,r,l);if(C!==void 0){g[y]=C;const B=C.width*(d/C.height);b+=B+qn}}if(b===0)return;b-=qn;let p=u+s.cellHorizontalPadding;o==="right"?p=Math.floor(u+f-s.cellHorizontalPadding-b):o==="center"&&(p=Math.floor(u+f/2-b/2));for(const y of g){if(y===void 0)continue;const x=y.width*(d/y.height);n>0&&(a.beginPath(),ft(a,p,m+s.cellVerticalPadding,x,d,n),a.save(),a.clip()),a.drawImage(y,p,m+s.cellVerticalPadding,x,d),n>0&&a.restore(),p+=x+qn}}function Bs(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Ps={getAccessibilityString:()=>"",kind:ce.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Bs(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding;s+a*2>=r.width&&(s=r.width-a*2-1);const c=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);ft(i,r.x+a,r.y+(r.height-c)/2,s,c,l.roundingRadius??3),i.fillStyle=Jt(l.textDark,.1),i.fill()},onPaste:()=>{}},As=vt("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Ds extends cn.PureComponent{constructor(){super(...arguments);ee(this,"targetElement",null);ee(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=nr(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const u=document.createElement("template");u.innerHTML=l,a=u.content}n.append(a);const c=n.getElementsByTagName("a");for(const u of c)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),cn.createElement(As,{ref:this.containerRefHook})}}const Rs=vt("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Ts=vt("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Ws=vt("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let Ko=0;const fo=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,...s}=e,{onChange:a,className:c}=s,u=v.useRef(null),m=n??"";yt(a!==void 0,"GrowingEntry must be a controlled input area");const[h]=v.useState(()=>"input-box-"+(Ko=(Ko+1)%1e7));v.useEffect(()=>{const d=u.current;if(d===null||d.disabled)return;const g=m.toString().length;d.focus(),d.setSelectionRange(i?0:g,g)},[]),v.useLayoutEffect(()=>{var d;if(l!==void 0){const g=typeof l=="number"?[l,null]:l;(d=u.current)==null||d.setSelectionRange(g[0],g[1])}},[l]);const f=v.useCallback(d=>{d.key==="Enter"&&d.shiftKey&&r===!0||o==null||o(d)},[r,o]);return v.createElement(Ws,{className:"gdg-growing-entry"},v.createElement(Ts,{className:c},m+`
`),v.createElement(Rs,{...s,className:(c??"")+" gdg-input",id:h,ref:u,onKeyDown:f,value:m,placeholder:t,dir:"auto"}))},zs=()=>e=>e.targetWidth,Go=vt("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[zs(),"px"]}}),Ls=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,a=t.data,c=t.readonly===!0,[u,m]=v.useState(a===""||o),h=v.useCallback(()=>{m(d=>!d)},[]),f=a?"gdg-ml-6":"";return u?v.createElement(Go,{targetWidth:r.width-20},v.createElement(fo,{autoFocus:!0,highlight:!1,validatedSelection:s,value:a,onKeyDown:d=>{d.key==="Enter"&&d.stopPropagation()},onChange:n}),v.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${f}`,onClick:()=>l(t)},v.createElement(ar,null))):v.createElement(Go,{targetWidth:r.width},v.createElement(Ds,{contents:a,createNode:i}),!c&&v.createElement(v.Fragment,null,v.createElement("div",{className:"spacer"}),v.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${f}`,onClick:h},v.createElement(io,null))),v.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Ns={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ce.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:Hn,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Ct(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return v.createElement(Ls,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Os={getAccessibilityString:e=>e.row.toString(),kind:Mt.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Xs,measure:()=>44,draw:e=>$s(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e;if(n.disabled===!0)return;const{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Xs(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=Ys,n.textAlign="center",r}function Ys(e){const{ctx:t}=e;t.textAlign="start"}function $s(e,t,n,o,i,r,l){if(l){const{ctx:b,rect:p,theme:y}=e,{x,y:C,width:B,height:P}=p,H=o==="checkbox"?"checkbox-visible":o;if(H!=="number"&&(b.globalAlpha=n?1:.4,Fn(b,y,n,i?x+7:x,C,i?B-7:B,P,!1,-20,-20,y.checkboxMaxSize,"center",r,!0),b.globalAlpha=1),H==="number"||H==="both"&&!n){const F=t.toString(),k=y.markerFontFull,R=x+B/2;b.fillStyle="#cccccc",b.font=k,b.fillText(F,R,C+P/2+Ze(b,k))}if(i){b.globalAlpha=.4,b.beginPath();for(const F of[3,6])for(const k of[-5,-1,3])b.rect(x+F,C+P/2+k,2,2);b.fillStyle="#cccccc",b.fill(),b.beginPath(),b.globalAlpha=1}return}const{ctx:s,rect:a,hoverAmount:c,theme:u}=e,{x:m,y:h,width:f,height:d}=a,g=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&g>0){s.globalAlpha=g;const b=7*(n?c:1);if(Fn(s,u,n,i?m+b:m,h,i?f-b:f,d,!0,void 0,void 0,u.checkboxMaxSize,"center",r,l),i){s.globalAlpha=c,s.beginPath();for(const p of[3,6])for(const y of[-5,-1,3])s.rect(m+p,h+d/2+y,2,2);s.fillStyle=u.textLight,s.fill(),s.beginPath()}s.globalAlpha=1}if(o==="number"||o==="both"&&!n){const b=t.toString(),p=u.markerFontFull,y=m+f/2;o==="both"&&c!==0&&(s.globalAlpha=1-c),s.fillStyle=u.textLight,s.font=p,s.fillText(b,y,h+d/2+Ze(s,p)),c!==0&&(s.globalAlpha=1)}}const _s={getAccessibilityString:()=>"",kind:Mt.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>qs(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function qs(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:c,width:u,height:m}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,c+1,u,m-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const h=t!=="";let f=0;if(n!==void 0){const g=m-8,b=a+8/2,p=c+8/2;s.drawSprite(n,"normal",o,b,p,g,l,h?1:r),f=g}else{f=24;const d=12,g=h?d:r*d,b=h?0:(1-r)*d*.5,p=l.cellHorizontalPadding+4;g>0&&(o.moveTo(a+p+b,c+m/2),o.lineTo(a+p+b+g,c+m/2),o.moveTo(a+p+b+g*.5,c+m/2-g*.5),o.lineTo(a+p+b+g*.5,c+m/2+g*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,f+a+l.cellHorizontalPadding+.5,c+m/2+Ze(o,l)),o.beginPath()}function wi(e,t,n,o,i,r,l){e.textBaseline="alphabetic";const s=Us(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),ft(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??Jt(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function Us(e,t,n,o,i){const r=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+l/2+1,width:t.width-r,height:t.height-l-1};const s=Ot(n,e,o.baseFontFull,"alphabetic"),a=t.height-l,c=Math.min(a,s.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-c)/2+1,width:s.width+r*3,height:c-1}}const Vs=v.lazy(async()=>await or(()=>import("./number-overlay-editor-CMpp4Kyr.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),js={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ce.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:Hn,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:l}=e,{hoverEffect:s,displayData:a,hoverEffectTheme:c}=n;s===!0&&t>0&&wi(o,i,c,a,r,t,l),Ct(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return v.createElement(v.Suspense,{fallback:null},v.createElement(Vs,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:i,onChange:r=>n({...o,data:Number.isNaN(r.floatValue??0)?0:r.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Ks={getAccessibilityString:()=>"",measure:()=>108,kind:ce.Protected,needsHover:!1,needsHoverPosition:!1,draw:Gs,onPaste:()=>{}};function Gs(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const c=r+l/2,u=Math.cos(Bo(30))*s,m=Math.sin(Bo(30))*s;for(let h=0;h<12;h++)t.moveTo(a,c-s),t.lineTo(a,c+s),t.moveTo(a+u,c-m),t.lineTo(a-u,c+m),t.moveTo(a-u,c-m),t.lineTo(a+u,c+m),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Js={getAccessibilityString:e=>e.rowId??"",kind:Mt.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>Ot(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:i}=e,r=o.rowId;if(!r)return;t.fillStyle=i.textDark,t.font=i.baseFontStyle,t.textAlign="left";const l=n.x+i.cellHorizontalPadding,s=n.y+n.height/2;t.fillText(r,l,s+Ze(t,i))},onClick:()=>{},onPaste:()=>{}},Qs={getAccessibilityString:e=>e.rowId??"",kind:Mt.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:Zs,measure:()=>80,draw:e=>tl(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function Zs(e,t){const{ctx:n}=e,o="12px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=el,n.textAlign="left",i}function el(e){const{ctx:t}=e;t.textAlign="start"}function tl(e,t){if(!t)return;const{ctx:n,rect:o,theme:i}=e,{x:r,y:l,height:s}=o;n.fillStyle=i.textDark,n.font="12px sans-serif";const a=r+8,c=l+s/2;n.fillText(t,a,c+Ze(n,n.font))}const nl={getAccessibilityString:e=>e.status??"",kind:Mt.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:ol,measure:()=>40,draw:e=>rl(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function ol(e,t){const{ctx:n}=e,o="bold 14px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=il,n.textAlign="center",i}function il(e){const{ctx:t}=e;t.textAlign="start"}function rl(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:i,y:r,width:l,height:s}=o,a={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=a[t],n.font="bold 14px sans-serif";const c=i+l/2,u=r+s/2;n.fillText(t,c,u+Ze(n,n.font))}const sl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ce.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:Hn,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:c,hoverEffect:u,allowWrapping:m,hoverEffectTheme:h}=t;u===!0&&n>0&&wi(i,l,h,a,r,n,s),Ct(e,a,c,m,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return v.createElement(fo,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},ll=vt("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),al=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,[s,a]=v.useState(!i&&(t===""||o)),c=v.useCallback(()=>{a(!0)},[]);return s?v.createElement(fo,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):v.createElement(ll,null,v.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!i&&v.createElement("div",{className:"gdg-edit-icon",onClick:c},v.createElement(io,null)),v.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ki(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}function Jo(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=ai(l,r.baseFontFull);if(s===void 0)return!1;const a=ki(s,n,r,t.contentAlign);return zt({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)}const cl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ce.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:Hn,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,c=t.hoverEffect===!0;if(o!==void 0&&c&&i!==void 0&&r!==void 0){const u=Ot(a,s,n.baseFontFull),m=ki(u,l,n,t.contentAlign),{x:h,y:f,width:d,height:g}=m;if(i>=h-4&&i<=h-4+d+8&&r>=f-4&&r<=f-4+g+8){const b=Ze(s,n.baseFontFull);o("pointer");const p=5,y=f-b;s.beginPath(),s.moveTo(l.x+h,Math.floor(l.y+y+g+p)+.5),s.lineTo(l.x+h+d,Math.floor(l.y+y+g+p)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,Ct({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),Ct({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),Ct({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),Ct({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=c?n.linkColor:n.textDark,Ct(e,a,t.contentAlign)},onSelect:e=>{Jo(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Jo(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return v.createElement(al,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Tl=[Os,_s,nl,Qs,ms,ps,Ss,Fs,Ps,Ns,js,Ks,Js,sl,cl],Un=[];class Wl extends fi{constructor(){super(...arguments);ee(this,"imageLoaded",()=>{});ee(this,"loadedLocations",[]);ee(this,"cache",{});ee(this,"sendLoaded",tr(()=>{this.imageLoaded(new Vt(this.loadedLocations)),this.loadedLocations=[]},20));ee(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=Un.pop()??new Image;let a=!1;const c={img:void 0,cells:[lt(o,i)],url:n,cancel:()=>{a||(a=!0,Un.length<12?Un.unshift(s):l||(s.src=""))}},u=new Promise(m=>s.addEventListener("load",()=>m(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const m=this.cache[r];if(m!==void 0&&!a){m.img=s;for(const h of m.cells)this.loadedLocations.push(ao(h));l=!0,this.sendLoaded()}}catch{c.cancel()}}),this.cache[r]=c}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=lt(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}export{Sn as A,Wt as B,jn as C,rs as D,Fl as E,to as F,ce as G,wl as H,Mt as I,Cl as J,Pl as K,Dl as L,Po as M,Ml as N,Gn as O,gr as P,Rl as Q,Tl as R,Wl as S,Rr as T,Bl as U,$o as V,os as W,pl as X,Os as Y,ir as a,ut as b,Lt as c,yt as d,yl as e,Hl as f,Il as g,Sl as h,rr as i,xl as j,Al as k,Jt as l,Nt as m,bl as n,Gt as o,zt as p,sn as q,vl as r,_o as s,gs as t,El as u,br as v,kl as w,Zo as x,sr as y,Tr as z};
