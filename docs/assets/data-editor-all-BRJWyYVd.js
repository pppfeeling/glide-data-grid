const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-CtJxsYrd.js","./iframe-BRH0sI4T.js","./preload-helper-C1FmrZbK.js","./marked.esm-C8Dy4b6m.js","./react-number-format.es-DC9-dj3n.js","./index-CNdQ_i0E.js","./throttle-CLO2z2b9.js","./flatten-DLKYwgY1.js"])))=>i.map(i=>d[i]);
var Ha=Object.defineProperty;var Da=(e,t,n)=>t in e?Ha(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ue=(e,t,n)=>Da(e,typeof t!="symbol"?t+"":t,n);import{r as a,R as It}from"./iframe-BRH0sI4T.js";import{_ as ls}from"./preload-helper-C1FmrZbK.js";import{r as ss}from"./index-CNdQ_i0E.js";import{h as Fa,g as as,j as Ta,k as Aa,v as Pa,l as za,m as vn,r as Mo,t as La}from"./throttle-CLO2z2b9.js";import{u as Ba,f as Tl}from"./flatten-DLKYwgY1.js";import{s as tn,a as Wa}from"./marked.esm-C8Dy4b6m.js";function cs(e="This should not happen"){throw new Error(e)}function hn(e,t="Assertion failed"){if(!e)return cs(t)}function xr(e,t){return cs(t??"Hell froze over")}function Oa(e,t){try{return e()}catch{return t}}const Al=Object.prototype.hasOwnProperty;function Zo(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Zo(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Al.call(e,n)&&++o&&!Al.call(t,n)||!(n in t)||!Zo(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const ti=null,Zi=void 0;var j;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(j||(j={}));var Pl;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(Pl||(Pl={}));var ni;(function(e){e.Triangle="triangle",e.Dots="dots"})(ni||(ni={}));function jr(e){return"width"in e&&typeof e.width=="number"}async function zl(e){return typeof e=="object"?e:await e()}function Yn(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown)}function zf(e){return!(e.kind===j.Loading||e.kind===j.Bubble||e.kind===j.RowID||e.kind===j.Protected||e.kind===j.Drilldown||e.kind===j.Boolean||e.kind===j.Image||e.kind===j.Custom)}function Ro(e){return e.kind===Nt.Marker||e.kind===Nt.NewRow||e.kind===Nt.RowStatus}function io(e){if(!Yn(e)||e.kind===j.Image)return!1;switch(e.kind){case j.Text:case j.Number:case j.Markdown:case j.Uri:case j.Custom:case j.Boolean:return e.readonly!==!0;default:xr(e,"A cell was passed with an invalid kind")}}function ds(e){return Fa(e,"editor")}function Ji(e){return!(e.readonly??!1)}var Nt;(function(e){e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id"})(Nt||(Nt={}));const oi={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Pi(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let Ll;const sn=class sn{constructor(t){Ue(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new sn(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Pi([...this.items,n]);return new sn(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,c]of n.entries()){const[l,d]=c;if(l<=r&&o<=d){const f=[];l<o&&f.push([l,o]),r<d&&f.push([r,d]),n.splice(i,1,...f)}}return new sn(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Ue(sn,"create",t=>new sn(Pi(t))),Ue(sn,"empty",()=>Ll??(Ll=new sn([]))),Ue(sn,"fromSingleSelection",t=>sn.empty().add(t)),Ue(sn,"fromArray",t=>{if(t.length===0)return sn.empty();const n=t.map(r=>[r,r+1]),o=Pi(n);return new sn(o)});let lt=sn;const Na=tn("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function en(e,t,n,o,r=!1){const i=a.useRef();i.current=t,a.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const c=n,l=d=>{var f;(f=i.current)==null||f.call(c,d)};return c.addEventListener(e,l,{passive:o,capture:r}),()=>{c.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function lo(e,t){return e===void 0?void 0:t}const $a=Math.PI;function Bl(e){return e*$a/180}const us=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),fs=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},hs=(e,t,n)=>Math.min(e,t-n*2),gs=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Qi=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),a.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Xa=e=>{const t=e.fgColor??"currentColor";return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Ga(e,t,n){const[o,r]=a.useState(e),i=a.useRef(!0);a.useEffect(()=>()=>{i.current=!1},[]);const c=a.useRef(as(l=>{i.current&&r(l)},n));return a.useLayoutEffect(()=>{i.current&&c.current(()=>e())},t),o}const Ya="֑-߿יִ-﷽ﹰ-ﻼ",Ka="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",_a=new RegExp("^[^"+Ka+"]*["+Ya+"]");function el(e){return _a.test(e)?"rtl":"not-rtl"}let Zr;function Gi(){if(typeof document>"u")return 0;if(Zr!==void 0)return Zr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Zr=n-o,Zr}const So=Symbol();function Va(e){const t=a.useRef([So,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=a.useState(e),[,r]=a.useState(),i=a.useCallback(l=>{const d=t.current[0];d!==So&&(l=typeof l=="function"?l(d):l,l===d)||(d!==So&&r({}),o(f=>typeof l=="function"?l(d===So?f:d):l),t.current[0]=So)},[]),c=a.useCallback(()=>{t.current[0]=So,r({})},[]);return[t.current[0]===So?n:t.current[0],i,c]}function ms(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Ua(e){const t=a.useRef(e);return Zo(e,t.current)||(t.current=e),t.current}const qa=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const c=i.length>1;return a.createElement(Na,{"data-testid":"GDG-default-image-overlay-editor"},a.createElement(Ta.Carousel,{showArrows:c,showThumbs:!1,swipeable:c,emulateTouch:c,infiniteLoop:c},i.map(l=>{const d=(r==null?void 0:r(l))??a.createElement("img",{draggable:!1,src:l});return a.createElement("div",{className:"gdg-centering-container",key:l},d)})),n&&o&&a.createElement("button",{className:"gdg-edit-icon",onClick:o},a.createElement(Qi,null)))},ja=tn("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class Za extends It.PureComponent{constructor(){super(...arguments);Ue(this,"targetElement",null);Ue(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,c=Wa(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let d=i==null?void 0:i(c);if(d===void 0){const u=document.createElement("template");u.innerHTML=c,d=u.content}n.append(d);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),It.createElement(ja,{ref:this.containerRefHook})}}const Ja=tn("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Qa=tn("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),ec=tn("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});class ws extends a.PureComponent{constructor(){super(...arguments);Ue(this,"wrapperRef",a.createRef());Ue(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return a.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const zi={};let no=null;function tc(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Jo(e){const t=e.toLowerCase().trim();if(zi[t]!==void 0)return zi[t];no=no||tc(),no.style.color="#000",no.style.color=t;const n=getComputedStyle(no).color;no.style.color="#fff",no.style.color=t;const o=getComputedStyle(no).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),zi[t]=r,r}function co(e,t){const[n,o,r]=Jo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const Wl=new Map;function Ol(e,t){const n=`${e}-${t}`,o=Wl.get(n);if(o!==void 0)return o;const r=gn(e,t);return Wl.set(n,r),r}function gn(e,t){if(t===void 0)return e;const[n,o,r,i]=Jo(e);if(i===1)return e;const[c,l,d,f]=Jo(t),u=i+f*(1-i),m=(i*n+f*c*(1-i))/u,g=(i*o+f*l*(1-i))/u,w=(i*r+f*d*(1-i))/u;return`rgba(${m}, ${g}, ${w}, ${u})`}function Lf(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,c]=Jo(e),[l,d,f,u]=Jo(t),m=o*c,g=r*c,w=i*c,h=l*u,p=d*u,v=f*u,S=n,b=1-n,x=c*b+u*S;if(x===0)return"rgba(0, 0, 0, 0)";const E=Math.floor((m*b+h*S)/x),$=Math.floor((g*b+p*S)/x),A=Math.floor((w*b+v*S)/x);return`rgba(${E}, ${$}, ${A}, ${x})`}function Bf(e){if(e==="transparent")return 0;function t(i){const c=i/255;return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const[n,o,r]=Jo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function ps(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const bs={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function ys(){return bs}const tl=It.createContext(bs);function Wf(){return It.useContext(tl)}function Ln(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=gn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const nc=()=>e=>e.targetX,oc=()=>e=>e.targetY,rc=()=>e=>e.targetWidth,ic=()=>e=>e.targetHeight,lc=()=>e=>e.targetY+10,sc=()=>e=>Math.max(0,(e.targetHeight-28)/2),ac=tn("div")({name:"DataGridOverlayEditorStyle",class:"gdg-d19meir1",propsAsIs:!1,vars:{"d19meir1-0":[oc(),"px"],"d19meir1-1":[nc(),"px"],"d19meir1-2":[rc(),"px"],"d19meir1-3":[ic(),"px"],"d19meir1-4":[lc(),"px"],"d19meir1-5":[sc(),"px"]}});function cc(){const[e,t]=a.useState();return[e??void 0,t]}function dc(){const[e,t]=cc(),[n,o]=a.useState(0),[r,i]=a.useState(!0);a.useLayoutEffect(()=>{if(e===void 0||!("IntersectionObserver"in window))return;const l=new IntersectionObserver(d=>{d.length!==0&&i(d[0].isIntersecting)},{threshold:1});return l.observe(e),()=>l.disconnect()},[e]),a.useEffect(()=>{if(r||e===void 0)return;let l;const d=()=>{const{right:f}=e.getBoundingClientRect();o(u=>Math.min(u+window.innerWidth-f-10,0)),l=requestAnimationFrame(d)};return l=requestAnimationFrame(d),()=>{l!==void 0&&cancelAnimationFrame(l)}},[e,r]);const c=a.useMemo(()=>({transform:`translateX(${n}px)`}),[n]);return{ref:t,style:c}}const er=a.createContext({isGhostMode:!1,ghostValue:""}),uc=e=>{const{target:t,content:n,onFinishEditing:o,forceEditMode:r,initialValue:i,imageEditorOverride:c,markdownDivCreateNode:l,highlight:d,className:f,theme:u,id:m,cell:g,bloom:w,portalElementRef:h,validateCell:p,getCellRenderer:v,provideEditor:S,isOutsideClick:b,customEventTarget:x,activation:E,ghostValue:$,isGhostMode:A}=e,[D,F]=a.useState(r?n:void 0),M=a.useRef(D??n);M.current=D??n;const[W,N]=a.useState(()=>p===void 0?!0:!(Yn(n)&&(p==null?void 0:p(g,n,M.current))===!1)),P=a.useCallback((oe,Re)=>{o(W?oe:void 0,Re)},[W,o]),O=a.useCallback(oe=>{if(p!==void 0&&oe!==void 0&&Yn(oe)){const Re=p(g,oe,M.current);Re===!1?N(!1):(typeof Re=="object"&&(oe=Re),N(!0))}F(oe)},[g,p]),B=a.useRef(!1),J=a.useRef(void 0),Q=a.useCallback(()=>{P(D,[0,0]),B.current=!0},[D,P]),pe=a.useCallback((oe,Re)=>{console.log("[onEditorFinished] newValue:",oe),console.log("[onEditorFinished] movement:",Re),console.log("[onEditorFinished] calling onFinishEditing"),P(oe,Re??J.current??[0,0]),console.log("[onEditorFinished] onFinishEditing called"),B.current=!0},[P]),be=a.useCallback(async oe=>{if(oe.nativeEvent.isComposing)return;let Re=!1;oe.key==="Escape"?(oe.stopPropagation(),oe.preventDefault(),J.current=[0,0]):oe.key==="Enter"&&!oe.shiftKey?(oe.stopPropagation(),oe.preventDefault(),J.current=[0,1],Re=!0):oe.key==="Tab"&&(oe.stopPropagation(),oe.preventDefault(),J.current=[oe.shiftKey?-1:1,0],Re=!0),window.setTimeout(()=>{!B.current&&J.current!==void 0&&(P(Re?D:void 0,J.current),B.current=!0)},0)},[P,D]),ye=D??n,[Z,U]=a.useMemo(()=>{var Qe,ft;if(Ro(n))return[];const oe={...n,location:g,activation:E},Re=S==null?void 0:S(oe);return Re!==void 0?[Re,!1]:[(ft=(Qe=v(n))==null?void 0:Qe.provideEditor)==null?void 0:ft.call(Qe,oe),!1]},[g,n,v,S,E]),{ref:ae,style:Ce}=dc();let we=!0,ce,ue=!0,re;if(Z!==void 0){we=Z.disablePadding!==!0,ue=Z.disableStyling!==!0;const oe=ds(Z);oe&&(re=Z.styleOverride);const Re=oe?Z.editor:Z;ce=a.createElement(Re,{portalElementRef:h,isHighlighted:d,activation:E,onChange:O,value:ye,initialValue:i,onFinishedEditing:pe,validatedSelection:Yn(ye)?ye.selectionRange:void 0,forceEditMode:r,target:t,imageEditorOverride:c,markdownDivCreateNode:l,isValid:W,theme:u})}re={...re,...Ce};const q=(h==null?void 0:h.current)??document.getElementById("portal");if(q===null)return console.error('Cannot open Data Grid overlay editor, because portal not found. Please, either provide a portalElementRef or add `<div id="portal" />` as the last child of your `<body>`.'),null;let Me=ue?"gdg-style":"gdg-unstyle";W||(Me+=" gdg-invalid"),we&&(Me+=" gdg-pad");const de=(w==null?void 0:w[0])??1,Oe=(w==null?void 0:w[1])??1,Ge=a.useMemo(()=>({isGhostMode:A??!1,ghostValue:$??""}),[A,$]);return ss.createPortal(a.createElement(tl.Provider,{value:u},a.createElement(er.Provider,{value:Ge},a.createElement(ws,{style:ps(u),className:f,onClickOutside:Q,isOutsideClick:b,customEventTarget:x},a.createElement(ac,{ref:ae,id:m,className:Me,style:A?{...re,visibility:"hidden"}:re,as:U===!0?"label":void 0,targetX:t.x-de,targetY:t.y-Oe,targetWidth:t.width+de*2,targetHeight:t.height+Oe*2},a.createElement("div",{className:"gdg-clip-region",onKeyDown:be},ce))))),q)},fc=Object.freeze(Object.defineProperty({__proto__:null,GhostModeContext:er,default:uc},Symbol.toStringTag,{value:"Module"}));let Nl=0;const nl=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:c,autoFocus:l,...d}=e,{onChange:f,className:u}=d,m=a.useRef(null),{isGhostMode:g,ghostValue:w}=a.useContext(er),h=g&&w?w:n??"";hn(f!==void 0,"GrowingEntry must be a controlled input area");const[p]=a.useState(()=>"input-box-"+(Nl=(Nl+1)%1e7));a.useEffect(()=>{if(g)return;const b=m.current;if(b===null||b.disabled)return;const x=h.toString().length;b.focus(),b.setSelectionRange(r?0:x,x)},[g]),a.useLayoutEffect(()=>{var b;if(c!==void 0){const x=typeof c=="number"?[c,null]:c;(b=m.current)==null||b.setSelectionRange(x[0],x[1])}},[c]);const v=a.useCallback(b=>{b.key==="Enter"&&b.shiftKey&&i===!0||o==null||o(b)},[i,o]),S=g?{visibility:"hidden"}:void 0;return a.createElement(ec,{className:"gdg-growing-entry"},a.createElement(Qa,{className:u},h+`
`),a.createElement(Ja,{...d,className:(u??"")+" gdg-input",id:p,ref:m,onKeyDown:v,value:h,placeholder:t,dir:"auto",style:S}))};function hc(e,t){return It.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function gc(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(kr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function Eo(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Yi(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function Cs(e,t){const n=Eo(e),o=Eo(t);return n===o}function ri(e,t,n,o){for(let r=0;r<=n;r++){const i=Yi(e,r,o)??"",c=Yi(t,r,o)??"";if(i!==c)return!1}return!0}function mc(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function ks(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function kr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function vs(e){return[e.x+e.width-1,e.y+e.height-1]}function $l(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,c=n.y+n.height-1,[l,d]=e;if(d<i||d>c)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function wc(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&$l(e,t,i)&&r++;for(const c of n.current.rangeStack)$l(e,t,c)&&r++;return r}function xs(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,c)=>({...i,sticky:e[c].sticky})),n=o}return n}function Qo(e,t){let n=0;const o=xs(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function Io(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Ki(e,t,n,o,r){const i=xs(e,o),c=[];for(const f of i)if(f.sticky)c.push(f);else break;if(c.length>0)for(const f of c)n-=f.width;let l=t,d=r??0;for(;d<=n&&l<i.length;)d+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||c.push(u)}return c}function pc(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function bc(e,t,n,o,r,i,c,l,d,f,u,m){const g=u??(n?1:0),w=m??(n?[r]:[]),h=w.reduce((x,E)=>x+E,0),p=o+h;if(n&&g>0){let x=0;for(let E=0;E<g;E++)if(x+=w[E]??0,e<=x)return-(E+2)}if(e<=p)return-1;let v=t;for(let x=0;x<f;x++){const E=i-1-x,$=typeof c=="number"?c:c(E);if(v-=$,e>=v)return E}const S=i-f,b=e-(d??0);if(typeof c=="number"){const x=Math.floor((b-p)/c)+l;return x>=S?void 0:x}else{let x=p;for(let E=l;E<S;E++){const $=c(E);if(b<=x+$)return E;x+=$}return}}let ei=0,vr={};const yc=typeof window>"u";async function Cc(){var e;yc||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,ei=0,vr={},Pa())}Cc();function Ss(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Ho(e,t,n,o="middle"){const r=Ss(e,t,o,n);let i=vr[r];return i===void 0&&(i=t.measureText(e),vr[r]=i,ei++),ei>1e4&&(vr={},ei=0),i}function Ms(e,t){const n=Ss(e,void 0,"middle",t);return vr[n]}function mn(e,t){return typeof t!="string"&&(t=t.baseFontFull),kc(e,t)}function Xl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Gl=[];function kc(e,t){for(const i of Gl)if(i.key===t)return i.val;const n=Xl(e,"alphabetic"),r=-(Xl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Gl.push({key:t,val:r}),r}function vc(e,t,n,o,r,i){const{ctx:c,rect:l,theme:d}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const m=1-f/u;c.globalAlpha=m,c.fillStyle=d.bgSearchResult,c.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),c.globalAlpha=1,o!==void 0&&(o.fillStyle=d.bgSearchResult)}return f<u}function ci(e,t,n){const{ctx:o,theme:r}=e,i=t??{},c=n??r.textDark;return c!==i.fillStyle&&(o.fillStyle=c,i.fillStyle=c),i}function Of(e,t,n,o,r){const{rect:i,ctx:c,theme:l}=e;c.fillStyle=l.textDark,Kn({ctx:c,rect:i,theme:l},t,n,o,r)}function Rs(e,t,n,o,r,i,c,l,d){d==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+c):d==="center"?e.fillText(t,n+r/2,o+i/2+c):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+c)}function Es(e,t){const n=Ho("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function xc(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Sc(e,t,n,o,r,i,c,l,d,f){const u=l.baseFontFull,m=Aa(e,t,u,r-l.cellHorizontalPadding*2,f??!1),g=Es(e,u),w=l.lineHeight*g,h=g+w*(m.length-1),p=h+l.cellVerticalPadding>i;p&&(e.save(),e.rect(n,o,r,i),e.clip());const v=o+i/2-h/2;let S=Math.max(o+l.cellVerticalPadding,v);for(const b of m)if(Rs(e,b,n,S,r,g,c,l,d),S+=w,S>o+i)break;p&&e.restore()}function Kn(e,t,n,o,r){const{ctx:i,rect:c,theme:l}=e,{x:d,y:f,width:u,height:m}=c;o=o??!1,o||(t=xc(t,u));const g=mn(i,l),w=el(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Sc(i,t,d,f,u,m,g,l,n,r):Rs(i,t,d,f,u,m,g,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function Bn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Mc(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Rc(e,t,n){const o=function(l,d){const f=d.x-l.x,u=d.y-l.y,m=Math.sqrt(f*f+u*u),g=f/m,w=u/m;return{x:f,y:d.y-l.y,len:m,nx:g,ny:w,ang:Math.atan2(w,g)}};let r;const i=t.length;let c=t[i-1];for(let l=0;l<i;l++){let d=t[l%i];const f=t[(l+1)%i],u=o(d,c),m=o(d,f),g=u.nx*m.ny-u.ny*m.nx,w=u.nx*m.nx-u.ny*-m.ny;let h=Math.asin(g<-1?-1:g>1?1:g),p=1,v=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,p=-1,v=!0):h>0&&(p=-1,v=!0),r=d.radius!==void 0?d.radius:n;const S=h/2;let b=Math.abs(Math.cos(S)*r/Math.sin(S)),x;b>Math.min(u.len/2,m.len/2)?(b=Math.min(u.len/2,m.len/2),x=Math.abs(b*Math.sin(S)/Math.cos(S))):x=r;let E=d.x+m.nx*b,$=d.y+m.ny*b;E+=-m.ny*x*p,$+=m.nx*x*p,e.arc(E,$,x,u.ang+Math.PI/2*p,m.ang-Math.PI/2*p,v),c=d,d=f}e.closePath()}function _i(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,v){const S={x:0,y:i+f,width:0,height:0},b=p??(r>0?1:0),x=-(b+1);if(e>=w.length||t>=u||t<x||e<0)return S;const E=v??(r>0?[r]:[]),$=E.reduce((D,F)=>D+F,0),A=i-$;if(e>=m){const D=c>e?-1:1,F=Qo(w);S.x+=F+d;for(let M=c;M!==e;M+=D)S.x+=w[D===1?M:M-1].width*D}else for(let D=0;D<e;D++)S.x+=w[D].width;if(S.width=w[e].width+1,t===-1)S.y=$,S.height=A;else if(t<=-2){const D=-(t+2);let F=0;for(let O=0;O<D;O++)F+=E[O]??0;S.y=F,S.height=E[D]??r;let M=e;const W=w[e].group,N=w[e].sticky;for(;M>0&&ri(w[M-1].group,W,D,b)&&w[M-1].sticky===N;){const O=w[M-1];S.x-=O.width,S.width+=O.width,M--}let P=e;for(;P+1<w.length&&ri(w[P+1].group,W,D,b)&&w[P+1].sticky===N;){const O=w[P+1];S.width+=O.width,P++}if(!N){const O=Qo(w),B=S.x-O;B<0&&(S.x-=B,S.width+=B),S.x+S.width>n&&(S.width=n-S.x)}}else if(t>=u-g){let D=u-t;for(S.y=o;D>0;){const F=t+D-1;S.height=typeof h=="number"?h:h(F),S.y-=S.height,D--}S.height+=1}else{const D=l>t?-1:1;if(typeof h=="number"){const F=t-l;S.y+=F*h}else for(let F=l;F!==t;F+=D)S.y+=h(F)*D;S.height=(typeof h=="number"?h:h(t))+1}return S}const ol=1<<21;function Fn(e,t){return(t+2)*ol+e}function Is(e){return e%ol}function rl(e){return Math.floor(e/ol)-2}function il(e){const t=Is(e),n=rl(e);return[t,n]}class Hs{constructor(){Ue(this,"visibleWindow",{x:0,y:0,width:0,height:0});Ue(this,"freezeCols",0);Ue(this,"freezeRows",[]);Ue(this,"isInWindow",t=>{const n=Is(t),o=rl(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,c=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&c})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Zo(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Ec extends Hs{constructor(){super(...arguments);Ue(this,"cache",new Map);Ue(this,"setValue",(n,o)=>{this.cache.set(Fn(n[0],n[1]),o)});Ue(this,"getValue",n=>this.cache.get(Fn(n[0],n[1])));Ue(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class jo{constructor(t=[]){Ue(this,"cells");this.cells=new Set(t.map(n=>Fn(n[0],n[1])))}add(t){this.cells.add(Fn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(Fn(t[0],t[1]))}remove(t){this.cells.delete(Fn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(rl(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(Fn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield il(t)}}const Vi=150;function Ic(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Vi}function Ds(e,t,n,o,r,i,c,l,d){let f=0;const u=r===void 0?[]:r.map(w=>{const h=Ic(e,w[o],t,d);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let w=0;for(const p of u)w+=p;const h=w/u.length;for(let p=0;p<u.length;p++)u[p]>=h*2?u[p]=0:f=Math.max(f,u[p])}const m=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=m;const g=Math.max(Math.ceil(i),Math.min(Math.floor(c),Math.ceil(f)));return{...n,width:g}}function Hc(e,t,n,o,r,i,c,l,d){const f=a.useRef(t),u=a.useRef(n),m=a.useRef(c);f.current=t,u.current=n,m.current=c;const[g,w]=a.useMemo(()=>{if(typeof window>"u")return[null,null];const b=document.createElement("canvas");return b.style.display="none",b.style.opacity="0",b.style.position="fixed",[b,b.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>(g&&document.documentElement.append(g),()=>{g==null||g.remove()}),[g]);const h=a.useRef({}),p=a.useRef(),[v,S]=a.useState();return a.useLayoutEffect(()=>{const b=u.current;if(b===void 0||e.every(jr))return;let x=Math.max(1,10-Math.floor(e.length/1e4)),E=0;x<f.current&&x>1&&(x--,E=1);const $={x:0,y:0,width:e.length,height:Math.min(f.current,x)},A={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const F=b($,d.signal),M=E>0?b(A,d.signal):void 0;let W;typeof F=="object"?W=F:W=await zl(F),M!==void 0&&(typeof M=="object"?W=[...W,...M]:W=[...W,...await zl(M)]),p.current=e,S(W)})()},[d.signal,e]),a.useMemo(()=>{let x=e.every(jr)?e:w===null?e.map(D=>jr(D)?D:{...D,width:Vi}):(w.font=m.current.baseFontFull,e.map((D,F)=>{if(jr(D))return D;if(h.current[D.id]!==void 0)return{...D,width:h.current[D.id]};if(v===void 0||p.current!==e||D.id===void 0)return{...D,width:Vi};const M=Ds(w,c,D,F,v,r,i,!0,l);return h.current[D.id]=M.width,M})),E=0,$=0;const A=[];for(const[D,F]of x.entries())E+=F.width,F.grow!==void 0&&F.grow>0&&($+=F.grow,A.push(D));if(E<o&&A.length>0){const D=[...x],F=o-E;let M=F;for(let W=0;W<A.length;W++){const N=A[W],P=(x[N].grow??0)/$,O=W===A.length-1?M:Math.min(M,Math.floor(F*P));D[N]={...x[N],growOffset:O,width:x[N].width+O},M-=O}x=D}return{sizedColumns:x,nonGrowWidth:E}},[o,e,w,v,c,r,i,l])}const vt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Dc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Fc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Tc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Ac=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Pc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Fs=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},zc=e=>{const t=e.bgColor;return`${vt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Lc=Fs,Bc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Wc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Oc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},$c=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Xc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Gc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Yc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Kc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},_c=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},Vc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Uc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},qc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},jc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},Zc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Jc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},Qc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},ed=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},td=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},nd=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},od=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},rd=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),id=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),ld={headerRowID:Dc,headerNumber:Tc,headerCode:Fc,headerString:Ac,headerBoolean:Pc,headerAudioUri:Lc,headerVideoUri:Bc,headerEmoji:Wc,headerImage:Oc,headerUri:Fs,headerPhone:Nc,headerMarkdown:$c,headerDate:Xc,headerTime:Gc,headerEmail:Yc,headerReference:Kc,headerIfThenElse:_c,headerSingleValue:Vc,headerLookup:Uc,headerTextTemplate:qc,headerMath:jc,headerRollup:Zc,headerJoinStrings:Jc,headerSplitString:Qc,headerGeoDistance:ed,headerArray:td,rowOwnerOverlay:nd,protectedColumnOverlay:od,renameIcon:zc,headerArrowDown:rd,headerArrowUp:id};function sd(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class ad{constructor(t,n){Ue(this,"onSettled");Ue(this,"spriteMap",new Map);Ue(this,"headerIcons");Ue(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,c,l,d=1){const[f,u]=sd(n,l),m=c*Math.ceil(window.devicePixelRatio),g=`${f}_${u}_${m}_${t}`;let w=this.spriteMap.get(g);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const p=w.getContext("2d");if(p===null)return;const v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(g,w);const S=v.decode();if(S===void 0)return;this.inFlight++,S.then(()=>{p.drawImage(v,0,0,m,m)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else d<1&&(o.globalAlpha=d),o.drawImage(w,0,0,m,m,r,i,c,c),d<1&&(o.globalAlpha=1)}}function Ts(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function di(e,t,n,o,r,i,c,l,d){l=l??t;let f=t,u=e;const m=o-i;let g=!1;for(;f<n&&u<m;){const w=r(u);if(f+w>l&&d(f,u,w,!1,c&&u===o-1)===!0){g=!0;break}f+=w,u++}if(!g){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,d(f,u,h,!0,c&&u===o-1)}}}function uo(e,t,n,o,r,i){let c=0,l=0;const d=r+o;for(const f of e){const u=f.sticky?l:c+n;if(i(f,u,d,f.sticky?0:l,t)===!0)break;c+=f.width,l+=f.sticky?f.width:0}}function cd(e,t,n,o,r){let i=0,c=0;for(let l=0;l<e.length;l++){const d=e[l];let f=l+1,u=d.width;for(d.sticky&&(c+=u);f<e.length&&Cs(e[f].group,d.group)&&e[f].sticky===e[l].sticky;){const p=e[f];u+=p.width,f++,l++,p.sticky&&(c+=p.width)}const m=d.sticky?0:n,g=i+m,w=d.sticky?0:Math.max(0,c-g),h=Math.min(u-w,t-(g+w));r([d.sourceIndex,e[f-1].sourceIndex],Eo(d.group),g+w,0,h,o),i+=u}}function dd(e,t,n,o,r,i){if(r===0)return;const c=[];let l=0;for(let u=0;u<r;u++)c.push(l),l+=o[u]??0;const d=[];let f=0;for(const u of e)d.push(f),f+=u.width;for(let u=0;u<r;u++){const m=c[u],g=o[u]??0;let w=0,h=0;for(;h<e.length;){const p=e[h],v=Yi(p.group,u,r);if(v===void 0){p.sticky&&(w+=p.width),h++;continue}const S=d[h];let b=h+1,x=p.width;for(p.sticky&&(w+=p.width);b<e.length;){const F=e[b],M=ri(F.group,p.group,u,r),W=F.sticky===p.sticky;if(!M||!W)break;x+=F.width,F.sticky&&(w+=F.width),b++}const E=p.sticky?0:n,$=S+E,A=p.sticky?0:Math.max(0,w-$),D=Math.min(x-A,t-($+A));D>0&&i([p.sourceIndex,e[b-1].sourceIndex],v,$+A,m,D,g,u),h=b}}}function As(e,t,n,o,r,i,c){var g;const[l,d]=e;let f,u;const m=((g=c.find(w=>!w.sticky))==null?void 0:g.sourceIndex)??0;if(d>m){const w=Math.max(l,m);let h=t,p=o;for(let v=i.sourceIndex-1;v>=w;v--)h-=c[v].width,p+=c[v].width;for(let v=i.sourceIndex+1;v<=d;v++)p+=c[v].width;u={x:h,y:n,width:p,height:r}}if(m>l){const w=Math.min(d,m-1);let h=t,p=o;for(let v=i.sourceIndex-1;v>=l;v--)h-=c[v].width,p+=c[v].width;for(let v=i.sourceIndex+1;v<=w;v++)p+=c[v].width;f={x:h,y:n,width:p,height:r}}return[f,u]}function ud(e,t,n,o){if(o==="any")return Ps(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),ks([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,c=n-e.y+1,l=e.y+e.height-n,d=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:c,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return d===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:d===c?{x:e.x,y:n,width:e.width,height:e.y-n}:d===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function Sr(e,t,n,o,r,i,c,l){return e<=r+c&&r<=e+n&&t<=i+l&&i<=t+o}function ao(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Ps(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function fd(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function hd(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,c=t+4,l=n+4,d=r-e.x,f=e.x+e.width-c,u=i-e.y,m=e.y+e.height-l,g=d>0?e.x+Math.floor(d/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,p=m>0?e.y+e.height-Math.floor(m/o)*o:e.y+e.height;return{x:g,y:h,width:w-g,height:p-h}}function gd(e,t,n,o,r){const[i,c,l,d]=t,[f,u,m,g]=r,{x:w,y:h,width:p,height:v}=e,S=[];if(p<=0||v<=0)return S;const b=w+p,x=h+v,E=w<i,$=h<c,A=w+p>l,D=h+v>d,F=w>=i&&w<l||b>i&&b<=l||w<i&&b>l,M=h>=c&&h<d||x>c&&x<=d||h<c&&x>d;if(F&&M){const N=Math.max(w,i),P=Math.max(h,c),O=Math.min(b,l),B=Math.min(x,d);S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:f,y:u,width:m-f+1,height:g-u+1}})}if(E&&$){const N=w,P=h,O=Math.min(b,i),B=Math.min(x,c);S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:0,y:0,width:f+1,height:u+1}})}if($&&F){const N=Math.max(w,i),P=h,O=Math.min(b,l),B=Math.min(x,c);S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:f,y:0,width:m-f+1,height:u+1}})}if($&&A){const N=Math.max(w,l),P=h,O=b,B=Math.min(x,c);S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:m,y:0,width:n-m+1,height:u+1}})}if(E&&M){const N=w,P=Math.max(h,c),O=Math.min(b,i),B=Math.min(x,d);S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:0,y:u,width:f+1,height:g-u+1}})}if(A&&M){const N=Math.max(w,l),P=Math.max(h,c),O=b,B=Math.min(x,d);S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:m,y:u,width:n-m+1,height:g-u+1}})}if(E&&D){const N=w,P=Math.max(h,d),O=Math.min(b,i),B=x;S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:0,y:g,width:f+1,height:o-g+1}})}if(D&&F){const N=Math.max(w,i),P=Math.max(h,d),O=Math.min(b,l),B=x;S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:f,y:g,width:m-f+1,height:o-g+1}})}if(A&&D){const N=Math.max(w,l),P=Math.max(h,d),O=b,B=x;S.push({rect:{x:N,y:P,width:O-N,height:B-P},clip:{x:m,y:g,width:n-m+1,height:o-g+1}})}return S}const md={kind:j.Loading,allowOverlay:!1};function Yl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,v,S,b,x,E,$,A,D,F,M,W,N,P,O,B,J,Q,pe,be){let ye=(x==null?void 0:x.size)??Number.MAX_SAFE_INTEGER;const Z=performance.now();let U=O.baseFontFull;e.font=U;const ae={ctx:e},Ce=[0,0],we=v>0?Io(d,v,f):0;let ce,ue;const re=new jo,q=new Set,Me=Ts(b);if(uo(t,l,i,c,r,(de,Oe,Ge,oe,Re)=>{const Qe=Math.max(0,oe-Oe),ft=Oe+Qe,Ne=r+1,Ht=de.width-Qe,Ee=o-r-1;if(b.length>0){let Ke=!1;for(let tt=0;tt<b.length;tt++){const st=b[tt];if(Sr(ft,Ne,Ht,Ee,st.x,st.y,st.width,st.height)){Ke=!0;break}}if(!Ke)return}const De=()=>{e.save(),e.beginPath(),e.rect(ft,Ne,Ht,Ee),e.clip()},he=E.columns.hasIndex(de.sourceIndex),Te=m(Eo(de.group)).overrideTheme,Be=de.themeOverride===void 0&&Te===void 0?O:Ln(O,Te,de.themeOverride),Ye=Be.baseFontFull;Ye!==U&&(U=Ye,e.font=Ye),De();let Xe;return di(Re,Ge,o,d,f,v,S,Me,(Ke,tt,st,Kt,K)=>{var cn,_e,Gt;if(tt<0)return;if(Ce[0]=de.sourceIndex,Ce[1]=tt,re.has(Ce)){ye--;return}if(x!==void 0&&!x.has(Ce))return;if(b.length>0){let Ae=!1;for(let at=0;at<b.length;at++){const ct=b[at];if(Sr(Oe,Ke,de.width,st,ct.x,ct.y,ct.width,ct.height)){Ae=!0;break}}if(!Ae)return}const wt=E.rows.hasIndex(tt),nt=w.hasIndex(tt),me=tt<d?u(Ce):md;let ot=Oe,ht=de.width,Je=Ke,Ze=st,xt=!1,Xt=!1;if(me.rowspan!==void 0){const[Ae,at]=me.rowspan,ct=`${de.sourceIndex}|${Ae}`;if(q.has(ct)){ye--;return}else{let Wt=Ke;for(let $e=Ae;$e<tt;$e++)Wt-=f($e);let Jt=0;for(let $e=Ae;$e<at;$e++)Jt+=f($e);if(Wt<Ne+Ee&&Wt+Jt>Ne){Je=Wt,Ze=Jt,q.add(ct);for(let $e=Ae;$e<at;$e++)$e!==tt&&re.add([de.sourceIndex,$e]);xt=!0}else{q.add(ct);for(let $e=Ae;$e<at;$e++)re.add([de.sourceIndex,$e]);ye--;return}}}if(me.span!==void 0){const[Ae,at]=me.span,ct=`${tt},${Ae},${at},${de.sticky}`;if(ue===void 0&&(ue=new Set),ue.has(ct)){ye--;return}else{const Wt=As(me.span,Oe,Ke,de.width,st,de,n),Jt=de.sticky?Wt[0]:Wt[1];!de.sticky&&Wt[0]!==void 0&&(Xt=!0),Jt!==void 0&&(ot=Jt.x,ht=Jt.width,ue.add(ct),xt=!0)}}if(xt){e.restore(),Xe=void 0,e.save(),e.beginPath();const Ae=Math.max(0,oe-ot);e.rect(ot+Ae,Je,ht-Ae,Ze),ce===void 0&&(ce=[]),ce.push({x:ot+Ae,y:Je,width:ht-Ae,height:Ze}),e.clip()}const $t=g==null?void 0:g(tt),Ot=K&&((cn=de.trailingRowOptions)==null?void 0:cn.themeOverride)!==void 0?(_e=de.trailingRowOptions)==null?void 0:_e.themeOverride:void 0,Tt=me.themeOverride===void 0&&$t===void 0&&Ot===void 0?Be:Ln(Be,$t,Ot,me.themeOverride);e.beginPath();const jt=mc(Ce,me,E);let Dt=wc(Ce,me,E,p);const Wn=me.span!==void 0&&E.columns.some(Ae=>me.span!==void 0&&Ae>=me.span[0]&&Ae<=me.span[1]);jt&&!h&&p?Dt=0:jt&&p&&(Dt=Math.max(Dt,1)),Wn&&Dt++,jt||(wt&&Dt++,he&&!K&&Dt++);const wn=me.kind===j.Protected?Tt.bgCellMedium:Tt.bgCell;let rt;if((Kt||wn!==O.bgCell)&&(rt=gn(wn,rt)),Dt>0||nt){nt&&(rt=gn(Tt.bgHeader,rt));for(let Ae=0;Ae<Dt;Ae++)rt=gn(Tt.accentLight,rt)}else if($!==void 0){for(const Ae of $)if(Ae[0]===de.sourceIndex&&Ae[1]===tt){rt=gn(Tt.bgSearchResult,rt);break}}if(A!==void 0)for(let Ae=0;Ae<A.length;Ae++){const at=A[Ae],ct=at.range;at.style!=="solid-outline"&&ct.x<=de.sourceIndex&&de.sourceIndex<ct.x+ct.width&&ct.y<=tt&&tt<ct.y+ct.height&&(rt=gn(at.color,rt))}let xn=!1;if(x!==void 0){const Ae=Ke+1,ct=(Kt?Ae+st-1:Math.min(Ae+st-1,o-we))-Ae;(ct!==st-1||ot+1<=oe)&&(xn=!0,e.save(),e.beginPath(),e.rect(ot+1,Ae,ht-1,ct),e.clip()),rt=rt===void 0?Tt.bgCell:gn(rt,Tt.bgCell)}const gt=de.sourceIndex===n.length-1,Zt=tt===d-1;rt!==void 0&&(e.fillStyle=rt,Xe!==void 0&&(Xe.fillStyle=rt),x!==void 0?e.fillRect(ot+1,Je+1,ht-(gt?2:1),Ze-(Zt?2:1)):e.fillRect(ot,Je,ht,Ze)),me.style==="faded"&&(e.globalAlpha=.6);let an;for(let Ae=0;Ae<M.length;Ae++){const at=M[Ae];if(at.item[0]===de.sourceIndex&&at.item[1]===tt){an=at;break}}if(ht>be&&!Xt){const Ae=Tt.baseFontFull;Ae!==U&&(e.font=Ae,U=Ae);let at=0;if(me.rowspan!==void 0){const ct=me.rowSpanPosition??"top";if(ct==="top")at=st/2-Ze/2;else if(ct==="bottom"){const[Wt,Jt]=me.rowspan,$e=f(Jt-1);at=Ze/2-$e/2}}Xe=zs(e,me,de.sourceIndex,tt,gt,Zt,ot,Je,ht,Ze,Dt>0,Tt,rt??Tt.bgCell,D,F,(an==null?void 0:an.hoverAmount)??0,W,P,Z,N,Xe,B,J,Q,pe,at)}return xn&&e.restore(),me.style==="faded"&&(e.globalAlpha=1),ye--,xt&&(e.restore(),(Gt=Xe==null?void 0:Xe.deprep)==null||Gt.call(Xe,ae),Xe=void 0,De(),U=Ye,e.font=Ye),ye<=0}),e.restore(),ye<=0}),ce!==void 0)return ce}const pr=[0,0],br={x:0,y:0,width:0,height:0},Li=[void 0,()=>{}];let Ui=!1;function wd(){Ui=!0}function zs(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,v,S,b,x,E,$,A,D,F,M){var Q,pe;let W,N;v!==void 0&&v[0][0]===n&&v[0][1]===o&&(W=v[1][0],N=v[1][1]);let P;pr[0]=n,pr[1]=o,br.x=c,br.y=l,br.width=d,br.height=f,Li[0]=A.getValue(pr),Li[1]=be=>A.setValue(pr,be),Ui=!1;const O={ctx:e,theme:m,col:n,row:o,cell:t,rect:br,highlighted:u,cellFillColor:g,hoverAmount:p,frameTime:b,hoverX:W,drawState:Li,hoverY:N,imageLoader:w,spriteManager:h,hyperWrapping:S,overrideCursor:W!==void 0?F:void 0,requestAnimationFrame:wd},B=vc(O,t.lastUpdated,b,E,r,i),J=D(t);if(J!==void 0){(E==null?void 0:E.renderer)!==J&&((Q=E==null?void 0:E.deprep)==null||Q.call(E,O),E=void 0);const be=(pe=J.drawPrep)==null?void 0:pe.call(J,O,E);e.save(),e.translate(0,M),x!==void 0&&!Ro(O.cell)?x(O,()=>J.draw(O,t)):J.draw(O,t),e.restore(),P=be===void 0?void 0:{deprep:be==null?void 0:be.deprep,fillStyle:be==null?void 0:be.fillStyle,font:be==null?void 0:be.font,renderer:J}}return(B||Ui)&&($==null||$(pr)),P}function ii(e,t,n,o,r,i,c,l,d=-20,f=-20,u=void 0,m="center",g="square",w=!1){const h=Math.floor(r+c/2),p=g==="circle"?1e4:t.roundingRadius??4;let v=hs(u??t.checkboxMaxSize,c,t.cellVerticalPadding),S=v/2;const b=fs(m,o,i,t.cellHorizontalPadding,v),x=us(b,h,v),E=gs(o+d,r+f,x);switch(n){case!0:{e.beginPath(),Bn(e,b-v/2,h-v/2,v,v,p),g==="circle"&&(S*=.8,v*=.8),e.fillStyle=w?t.bgCellMedium:l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(b-S+v/4.23,h-S+v/1.97),e.lineTo(b-S+v/2.42,h-S+v/1.44),e.lineTo(b-S+v/1.29,h-S+v/3.25),e.strokeStyle=w?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case ti:case!1:{e.beginPath(),Bn(e,b-v/2+.5,h-v/2+.5,v-1,v-1,p),e.lineWidth=1,e.strokeStyle=w?t.textLight:E?t.textDark:t.textMedium,e.stroke();break}case Zi:{e.beginPath(),Bn(e,b-v/2,h-v/2,v,v,p),e.fillStyle=w?t.bgCellMedium:E?t.textMedium:t.textLight,e.fill(),g==="circle"&&(S*=.8,v*=.8),e.beginPath(),e.moveTo(b-v/3,h),e.lineTo(b+v/3,h),e.strokeStyle=w?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:xr()}}function pd(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,v,S,b,x,E,$){var J,Q,pe,be;const A=E??(o?1:0),D=$??(o?[d]:[]),F=D.reduce((ye,Z)=>ye+Z,0),M=l+F;if(M<=0)return;e.fillStyle=g.bgHeader,S!==void 0&&o&&(E??1)>1?e.fillRect(0,F,i,l):e.fillRect(0,0,i,M);const W=(J=r==null?void 0:r[0])==null?void 0:J[0],N=(Q=r==null?void 0:r[0])==null?void 0:Q[1],P=(pe=r==null?void 0:r[1])==null?void 0:pe[0],O=(be=r==null?void 0:r[1])==null?void 0:be[1],B=g.headerFontFull;e.font=B,uo(t,0,c,0,M,(ye,Z,U,ae)=>{var Re;if(S!==void 0&&!S.has([ye.sourceIndex,-1]))return;const Ce=Math.max(0,ae-Z);e.save(),e.beginPath(),e.rect(Z+Ce,F,ye.width-Ce,l),e.clip();const we=v(Eo(ye.group)).overrideTheme,ce=ye.themeOverride===void 0&&we===void 0?g:Ln(g,we,ye.themeOverride);ce.bgHeader!==g.bgHeader&&(e.fillStyle=ce.bgHeader,e.fill()),ce!==g&&(e.font=ce.headerFontFull);const ue=m.columns.hasIndex(ye.sourceIndex),re=f!==void 0||u||ye.headerRowMarkerDisabled===!0,q=!re&&N===-1&&W===ye.sourceIndex,Me=re?0:((Re=h.find(Qe=>Qe.item[0]===ye.sourceIndex&&Qe.item[1]===-1))==null?void 0:Re.hoverAmount)??0,de=(m==null?void 0:m.current)!==void 0&&m.current.cell[0]===ye.sourceIndex,Oe=ue?ce.accentColor:de?ce.bgHeaderHasFocus:ce.bgHeader,Ge=o?F:0,oe=ye.sourceIndex===0?0:1;ue?(e.fillStyle=Oe,e.fillRect(Z+oe,Ge,ye.width-oe,l)):(de||Me>0)&&(e.beginPath(),e.rect(Z+oe,Ge,ye.width-oe,l),de&&(e.fillStyle=ce.bgHeaderHasFocus,e.fill()),Me>0&&(e.globalAlpha=Me,e.fillStyle=ce.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Bs(e,Z,Ge,ye.width,l,ye,ue,ce,q,q?P:void 0,q?O:void 0,de,Me,w,b,x),e.restore()}),o&&(A>1?yd(e,t,i,c,D,A,r,g,w,h,p,v,S):bd(e,t,i,c,d,r,g,w,h,p,v,S)),o&&(E??1)>1&&(e.beginPath(),e.moveTo(0,F+.5),e.lineTo(i,F+.5),e.strokeStyle=g.borderColor,e.lineWidth=1,e.stroke())}function bd(e,t,n,o,r,i,c,l,d,f,u,m){const[w,h]=(i==null?void 0:i[0])??[];let p=0;cd(t,n,o,r,(v,S,b,x,E,$)=>{if(m!==void 0&&!m.hasItemInRectangle({x:v[0],y:-2,width:v[1]-v[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(b,x,E,$),e.clip();const A=u(S),D=(A==null?void 0:A.overrideTheme)===void 0?c:Ln(c,A.overrideTheme),F=h===-2&&w!==void 0&&w>=v[0]&&w<=v[1],M=F?D.bgGroupHeaderHovered??D.bgHeaderHovered:D.bgGroupHeader??D.bgHeader;if(M!==c.bgHeader&&(e.fillStyle=M,e.fill()),e.fillStyle=D.textGroupHeader??D.textHeader,A!==void 0){let W=b;if(A.icon!==void 0&&(l.drawSprite(A.icon,"normal",e,W+8,(r-20)/2,20,D),W+=26),e.fillText(A.name,W+8,r/2+mn(e,c.headerFontFull)),A.actions!==void 0&&F){const N=ll({x:b,y:x,width:E,height:$},A.actions);e.beginPath();const P=N[0].x-10,O=b+E-P;e.rect(P,0,O,r);const B=e.createLinearGradient(P,0,P+O,0),J=co(M,0);B.addColorStop(0,J),B.addColorStop(10/O,M),B.addColorStop(1,M),e.fillStyle=B,e.fill(),e.globalAlpha=.6;const[Q,pe]=(i==null?void 0:i[1])??[-1,-1];for(let be=0;be<A.actions.length;be++){const ye=A.actions[be],Z=N[be],U=ao(Z,Q+b,pe);U&&(e.globalAlpha=1),l.drawSprite(ye.icon,"normal",e,Z.x+Z.width/2-10,Z.y+Z.height/2-10,20,D),U&&(e.globalAlpha=.6)}e.globalAlpha=1}}b!==0&&f(v[0])&&(e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.strokeStyle=c.borderColor,e.lineWidth=1,e.stroke()),e.restore(),p=b+E}),e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=c.borderColor,e.lineWidth=1,e.stroke()}function yd(e,t,n,o,r,i,c,l,d,f,u,m,g){const[w,h]=(c==null?void 0:c[0])??[];e.font=l.headerFontFull;const p=r.reduce((S,b)=>S+b,0);g===void 0&&(e.fillStyle=l.bgHeader,e.fillRect(0,0,n,p));let v=0;if(dd(t,n,o,r,i,(S,b,x,E,$,A,D)=>{const F=-(D+2);if(g!==void 0&&!g.hasItemInRectangle({x:S[0],y:F,width:S[1]-S[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(x,E,$,A),e.clip();const M=m(b),W=(M==null?void 0:M.overrideTheme)===void 0?l:Ln(l,M.overrideTheme),N=h===F&&w!==void 0&&w>=S[0]&&w<=S[1],P=N?W.bgGroupHeaderHovered??W.bgHeaderHovered:W.bgGroupHeader??W.bgHeader;e.fillStyle=P,e.fillRect(x,E,$,A),e.fillStyle=W.textGroupHeader??W.textHeader;const O=(M==null?void 0:M.name)??b,J=e.measureText(O).width,Q=(M==null?void 0:M.icon)!==void 0?26:0,pe=Q+J,be=x+($-pe)/2;if((M==null?void 0:M.icon)!==void 0&&d.drawSprite(M.icon,"normal",e,be,E+(A-20)/2,20,W),e.fillText(O,be+Q,E+A/2+mn(e,l.headerFontFull)),M!==void 0&&M.actions!==void 0&&N){const ye=ll({x,y:E,width:$,height:A},M.actions);e.beginPath();const Z=ye[0].x-10,U=x+$-Z;e.rect(Z,E,U,A);const ae=e.createLinearGradient(Z,0,Z+U,0),Ce=co(P,0);ae.addColorStop(0,Ce),ae.addColorStop(10/U,P),ae.addColorStop(1,P),e.fillStyle=ae,e.fill(),e.globalAlpha=.6;const[we,ce]=(c==null?void 0:c[1])??[-1,-1];for(let ue=0;ue<M.actions.length;ue++){const re=M.actions[ue],q=ye[ue],Me=ao(q,we+x,ce);Me&&(e.globalAlpha=1),d.drawSprite(re.icon,"normal",e,q.x+q.width/2-10,q.y+q.height/2-10,20,W),Me&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=l.borderColor,e.lineWidth=1,x!==0&&u(S[0])&&(e.beginPath(),e.moveTo(x+.5,E),e.lineTo(x+.5,E+A),e.stroke()),(D<i-1||g===void 0)&&(e.beginPath(),e.moveTo(x,E+A+.5),e.lineTo(x+$,E+A+.5),e.stroke()),e.restore(),v=Math.max(v,x+$)}),g===void 0){e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,p);let S=0;for(let b=0;b<i-1;b++)S+=r[b],e.moveTo(0,S+.5),e.lineTo(n,S+.5);e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}}const Jr=30;function Cd(e,t,n,o,r){return{x:e+n-Jr,y:Math.max(t,t+o/2-Jr/2),width:Jr,height:Math.min(Jr,o)}}function ll(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,c=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:c,height:i}),o+=26;return n}function yr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Ls(e,t,n,o,r,i,c,l){var D;const d=c.cellHorizontalPadding,f=c.headerIconSize,u=Cd(n,o,r,i);let m=n+d;const g=t.icon===void 0?void 0:{x:m,y:o+(i-f)/2,width:f,height:f},w=g===void 0||t.overlayIcon===void 0?void 0:{x:g.x+9,y:g.y+6,width:18,height:18};g!==void 0&&(m+=Math.ceil(f*1.3));const h=e===void 0?((D=Ms(t.title,c.headerFontFull))==null?void 0:D.width)??0:Ho(t.title,e,c.headerFontFull).width,p=t.hasMenu===!0?35:0,v=t.indicatorIcon!==void 0?f+d:0,S=h+v,b=r-(g!==void 0?Math.ceil(f*1.3)+d:d)-p-d,x=n+(g!==void 0?Math.ceil(f*1.3)+d:d)+(b-S)/2,E={x:Math.max(m,x),y:o,width:h,height:i};let $;t.indicatorIcon!==void 0&&($={x:E.x+h+d,y:o+(i-f)/2,width:f,height:f});const A=n+r/2;return{menuBounds:yr(u,A,l),iconBounds:yr(g,A,l),iconOverlayBounds:yr(w,A,l),textBounds:yr(E,A,l),indicatorIconBounds:yr($,A,l)}}function Kl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const b=i.rowMarkerChecked;b!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=m);const x=i.headerRowMarkerTheme!==void 0?Ln(l,i.headerRowMarkerTheme):l;ii(e,x,b,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),b!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const v=c?l.textHeaderSelected:l.textHeader,S=i.hasMenu===!0&&(d||w&&c)&&p.menuBounds!==void 0;if(i.icon!==void 0&&p.iconBounds!==void 0){let b=c?"selected":"normal";i.style==="highlight"&&(b=c?"selected":"special"),g.drawSprite(i.icon,b,e,p.iconBounds.x,p.iconBounds.y,p.iconBounds.width,l),i.overlayIcon!==void 0&&p.iconOverlayBounds!==void 0&&g.drawSprite(i.overlayIcon,c?"selected":"special",e,p.iconOverlayBounds.x,p.iconOverlayBounds.y,p.iconOverlayBounds.width,l)}if(S&&o>35){const x=h?35:o-35,E=h?35*.7:o-35*.7,$=x/o,A=E/o,D=e.createLinearGradient(t,0,t+o,0),F=co(v,0);D.addColorStop(h?1:0,v),D.addColorStop($,v),D.addColorStop(A,F),D.addColorStop(h?0:1,F),e.fillStyle=D}else e.fillStyle=v;if(h&&(e.textAlign="right"),p.textBounds!==void 0&&e.fillText(i.title,h?p.textBounds.x+p.textBounds.width:p.textBounds.x,n+r/2+mn(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&p.indicatorIconBounds!==void 0&&(!S||!Sr(p.menuBounds.x,p.menuBounds.y,p.menuBounds.width,p.menuBounds.height,p.indicatorIconBounds.x,p.indicatorIconBounds.y,p.indicatorIconBounds.width,p.indicatorIconBounds.height))){let b=c?"selected":"normal";i.style==="highlight"&&(b=c?"selected":"special"),g.drawSprite(i.indicatorIcon,b,e,p.indicatorIconBounds.x,p.indicatorIconBounds.y,p.indicatorIconBounds.width,l)}if(S&&p.menuBounds!==void 0){const b=p.menuBounds,x=f!==void 0&&u!==void 0&&ao(b,f+t,u+n);if(x||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===ni.Triangle){e.beginPath();const E=b.x+b.width/2-5.5,$=b.y+b.height/2-3;Rc(e,[{x:E,y:$},{x:E+11,y:$},{x:E+5.5,y:$+6}],1),e.fillStyle=v,e.fill()}else if(i.menuIcon===ni.Dots){e.beginPath();const E=b.x+b.width/2,$=b.y+b.height/2;Mc(e,E,$),e.fillStyle=v,e.fill()}else{const E=b.x+(b.width-l.headerIconSize)/2,$=b.y+(b.height-l.headerIconSize)/2;g.drawSprite(i.menuIcon,"normal",e,E,$,l.headerIconSize,l)}x||(e.globalAlpha=1)}}function Bs(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p){const v=el(i.title)==="rtl",S=Ls(e,i,t,n,o,r,l,v);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:c,hoverAmount:g,isHovered:d,hasSelectedCell:m,spriteManager:w,menuBounds:(S==null?void 0:S.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>Kl(e,t,n,o,r,i,c,l,d,f,u,g,w,p,v,S)):Kl(e,t,n,o,r,i,c,l,d,f,u,g,w,p,v,S)}function kd(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,v,S,b){if(S!==void 0||t[t.length-1]!==n[t.length-1])return;const x=Ts(v);uo(t,d,c,l,i,(E,$,A,D,F)=>{if(E!==t[t.length-1])return;$+=E.width;const M=Math.max($,D);M>o||(e.save(),e.beginPath(),e.rect(M,i+1,1e4,r-i-1),e.clip(),di(F,A,r,f,u,h,p,x,(W,N,P,O)=>{if(!O&&v.length>0&&!v.some(be=>Sr($,W,1e4,P,be.x,be.y,be.width,be.height)))return;const B=g.hasIndex(N),J=w.hasIndex(N);e.beginPath();const Q=m==null?void 0:m(N),pe=Q===void 0?b:Ln(b,Q);pe.bgCell!==b.bgCell&&(e.fillStyle=pe.bgCell,e.fillRect($,W,1e4,P)),J&&(e.fillStyle=pe.bgHeader,e.fillRect($,W,1e4,P)),B&&(e.fillStyle=pe.accentLight,e.fillRect($,W,1e4,P))}),e.restore())})}function vd(e,t,n,o,r,i,c,l,d){let f=!1;for(const h of t)if(!h.sticky){f=c(h.sourceIndex);break}const u=d.horizontalBorderColor??d.borderColor,m=d.borderColor,g=f?Qo(t):0;let w;if(g!==0&&(w=Ol(m,d.bgCell),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=m===u&&w!==void 0?w:Ol(u,d.bgCell),p=Io(i,r,l);e.beginPath(),e.moveTo(0,o-p+.5),e.lineTo(n,o-p+.5),e.strokeStyle=h,e.stroke()}}const Ws=(e,t,n)=>{let o=0,r=t,i=0,c=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),c=Math.max(c,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:c}};function xd(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h){var P;const p=h.bgCell,{minX:v,maxX:S,minY:b,maxY:x}=Ws(l,i,c),E=[],$=c-Io(w,g,f);let A=d,D=n,F=0;for(;A+r<$;){const O=A+r,B=f(D);if(O>=b&&O<=x-1){const J=u==null?void 0:u(D),Q=J==null?void 0:J.bgCell;Q!==void 0&&Q!==p&&D>=w-g&&E.push({x:v,y:O,w:S-v,h:B,color:Q})}A+=B,D<w-g&&(F=A),D++}let M=0;const W=Math.min($,x)-F;if(W>0)for(let O=0;O<t.length;O++){const B=t[O];if(B.width===0)continue;const J=B.sticky?M:M+o,Q=(P=B.themeOverride)==null?void 0:P.bgCell;Q!==void 0&&Q!==p&&J>=v&&J<=S&&m(O+1)&&E.push({x:J,y:F,w:B.width,h:W,color:Q}),M+=B.width}if(E.length===0)return;let N;e.beginPath();for(let O=E.length-1;O>=0;O--){const B=E[O];N===void 0?N=B.color:B.color!==N&&(e.fillStyle=N,e.fill(),e.beginPath(),N=B.color),e.rect(B.x,B.y,B.w,B.h)}N!==void 0&&(e.fillStyle=N,e.fill()),e.beginPath()}function _l(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,v,S=!1){if(d!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,c);for(const P of d)e.rect(P.x+1,P.y+1,P.width-1,P.height-1);e.clip("evenodd")}const b=v.horizontalBorderColor??v.borderColor,x=v.borderColor,{minX:E,maxX:$,minY:A,maxY:D}=Ws(l,i,c),F=[];e.beginPath();let M=.5;for(let P=0;P<t.length;P++){const O=t[P];if(O.width===0)continue;M+=O.width;const B=O.sticky?M:M+o;B>=E&&B<=$&&w(P+1)&&F.push({x1:B,y1:Math.max(f,A),x2:B,y2:Math.min(c,D),color:x})}let W=c+.5;for(let P=p-h;P<p;P++){const O=m(P);W-=O,F.push({x1:E,y1:W,x2:$,y2:W,color:b})}if(S!==!0){let P=u+.5,O=n;const B=W;for(;P+r<B;){const J=P+r;if(J>=A&&J<=D-1){const Q=g==null?void 0:g(O);F.push({x1:E,y1:J,x2:$,y2:J,color:(Q==null?void 0:Q.horizontalBorderColor)??(Q==null?void 0:Q.borderColor)??b})}P+=m(O),O++}}const N=za(F,P=>P.color);for(const P of Object.keys(N)){e.strokeStyle=P;for(const O of N[P])e.moveTo(O.x1,O.y1),e.lineTo(O.x2,O.y2);e.stroke(),e.beginPath()}d!==void 0&&e.restore()}function Sd(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,v,S,b){const x=[];e.imageSmoothingEnabled=!1;const E=Math.min(r.cellYOffset,c),$=Math.max(r.cellYOffset,c);let A=0;if(typeof S=="number")A+=($-E)*S;else for(let B=E;B<$;B++)A+=S(B);c>r.cellYOffset&&(A=-A),A+=d-r.translateY;const D=Math.min(r.cellXOffset,i),F=Math.max(r.cellXOffset,i);let M=0;for(let B=D;B<F;B++)M+=p[B].width;i>r.cellXOffset&&(M=-M),M+=l-r.translateX;const W=Qo(v);if(M!==0&&A!==0)return{regions:[]};const N=f>0?Io(g,f,S):0,P=u-W-Math.abs(M),O=m-w-N-Math.abs(A)-1;if(P>150&&O>150){const B={sx:0,sy:0,sw:u*h,sh:m*h,dx:0,dy:0,dw:u*h,dh:m*h};if(A>0?(B.sy=(w+1)*h,B.sh=O*h,B.dy=(A+w+1)*h,B.dh=O*h,x.push({x:0,y:w,width:u,height:A+1})):A<0&&(B.sy=(-A+w+1)*h,B.sh=O*h,B.dy=(w+1)*h,B.dh=O*h,x.push({x:0,y:m+A-N,width:u,height:-A+N})),M>0?(B.sx=W*h,B.sw=P*h,B.dx=(M+W)*h,B.dw=P*h,x.push({x:W-1,y:0,width:M+2,height:m})):M<0&&(B.sx=(W-M)*h,B.sw=P*h,B.dx=W*h,B.dw=P*h,x.push({x:u+M,y:0,width:-M,height:m})),e.setTransform(1,0,0,1,0,0),b){if(W>0&&M!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const J=W*h,Q=m*h;e.drawImage(t,0,0,J,Q,0,0,J,Q)}if(N>0&&M===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const J=(m-N)*h,Q=u*h,pe=N*h;e.drawImage(t,0,J,Q,pe,0,J,Q,pe)}}e.drawImage(t,B.sx,B.sy,B.sw,B.sh,B.dx,B.dy,B.dw,B.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:x}}function Md(e,t,n,o,r,i,c,l,d,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||uo(d,n,o,r,l,(m,g,w,h)=>{if(m.sourceIndex===f){const p=Math.max(g,h)+1;return u.push({x:p,y:0,width:i-p,height:c}),!0}}),u}function Rd(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Zo(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:c,...l}=r,{width:d,...f}=i;if(!Zo(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function Vl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p){const v=h==null?void 0:h.filter(D=>D.style!=="no-outline");if(v===void 0||v.length===0)return;const S=Qo(l),b=Io(w,g,m),x=[d,0,l.length,w-g],E=[S,0,t,n-b],$=v.map(D=>{const F=D.range,M=D.style??"dashed";return gd(F,x,t,n,E).map(W=>{const N=W.rect,P=_i(N.x,N.y,t,n,u,f+u,o,r,i,c,w,d,g,l,m),O=N.width===1&&N.height===1?P:_i(N.x+N.width-1,N.y+N.height-1,t,n,u,f+u,o,r,i,c,w,d,g,l,m);return N.x+N.width>=l.length&&(O.width-=1),N.y+N.height>=w&&(O.height-=1),{color:D.color,style:M,clip:W.clip,rect:hd({x:P.x,y:P.y,width:O.x+O.width-P.x,height:O.y+O.height-P.y},t,n,8)}})}),A=()=>{e.lineWidth=1;let D=!1;for(const F of $)for(const M of F)if((M==null?void 0:M.rect)!==void 0&&Sr(0,0,t,n,M.rect.x,M.rect.y,M.rect.width,M.rect.height)){const W=D,N=!fd(M.clip,M.rect);e.beginPath(),N&&(e.save(),e.rect(M.clip.x,M.clip.y,M.clip.width,M.clip.height),e.clip()),M.style==="dashed"&&!D?(e.setLineDash([5,3]),D=!0):(M.style==="solid"||M.style==="solid-outline")&&D&&(e.setLineDash([]),D=!1),e.strokeStyle=M.style==="solid-outline"?gn(gn(M.color,p.borderColor),p.bgCell):co(M.color,1),e.closePath(),e.strokeRect(M.rect.x+.5,M.rect.y+.5,M.rect.width-1,M.rect.height-1),N&&(e.restore(),D=W)}D&&e.setLineDash([])};return A(),A}function Ul(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Bi(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,v){if(u.current===void 0)return;const S=p!==!1&&p!==void 0;if(!S)return;const b=typeof p=="object"?{...oi,...p}:oi,x=u.current.range,E=u.current.cell,$=[x.x+x.width-1,x.y+x.height-1];if(E[1]>=v&&$[1]>=v||!c.some(Q=>Q.sourceIndex===E[0]||Q.sourceIndex===$[0]))return;const[D,F]=u.current.cell,M=g(u.current.cell),W=M.span??[D,D],N=F>=v-w,P=w>0&&!N?Io(v,w,m)-1:0,O=$[1];let B;if(uo(c,o,r,i,f,(Q,pe,be,ye,Z)=>{if(Q.sticky&&D>Q.sourceIndex)return;const U=Q.sourceIndex<W[0],ae=Q.sourceIndex>W[1],Ce=Q.sourceIndex===$[0];if(!(!Ce&&(U||ae)))return di(Z,be,n,v,m,w,h,void 0,(we,ce,ue)=>{if(ce!==F&&ce!==O)return;let re=pe,q=Q.width;if(M.span!==void 0){const de=As(M.span,pe,we,Q.width,ue,Q,l),Oe=Q.sticky?de[0]:de[1];Oe!==void 0&&(re=Oe.x,q=Oe.width)}return ce===O&&Ce&&S&&(B=()=>{var Re;ye>re&&!Q.sticky&&(e.beginPath(),e.rect(ye,0,t-ye,n),e.clip());const de=b.size,Oe=de/2,Ge=re+q+b.offsetX-Oe+.5,oe=we+ue+b.offsetY-Oe+.5;e.beginPath(),b.shape==="circle"?e.arc(Ge+Oe,oe+Oe,Oe,0,Math.PI*2):e.rect(Ge,oe,de,de),e.fillStyle=((Re=Q.themeOverride)==null?void 0:Re.accentColor)??d.accentColor,e.fill(),b.outline>0&&(e.lineWidth=b.outline,e.strokeStyle=d.bgCell,b.shape==="circle"?(e.beginPath(),e.arc(Ge+Oe,oe+Oe,Oe+b.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(Ge-b.outline/2,oe-b.outline/2,de+b.outline,de+b.outline))}),B!==void 0}),B!==void 0}),B===void 0)return;const J=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-P),e.clip(),B==null||B(),e.restore()};return J(),J}function Ed(e,t,n,o,r,i,c,l,d){d===void 0||d.size===0||(e.beginPath(),uo(t,l,i,c,r,(f,u,m,g)=>{const w=Math.max(0,g-u),h=u+w+1,p=f.width-w-1;d.has([f.sourceIndex,-1])&&e.rect(h,o,p,r-o)}),e.clip())}function Id(e,t,n,o,r,i,c,l,d,f){let u=0;return uo(e,i,o,r,n,(m,g,w,h,p)=>(di(p,w,t,c,l,d,f,void 0,(v,S,b,x)=>{x||(u=Math.max(S,u))}),!0)),u}function ql(e,t){var xn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:c,cellYOffset:l,translateX:d,translateY:f,mappedColumns:u,enableGroups:m,freezeColumns:g,dragAndDropState:w,theme:h,drawFocus:p,headerHeight:v,groupHeaderHeight:S,groupLevels:b,groupHeaderHeights:x,disabledRows:E,rowHeight:$,verticalBorder:A,overrideCursor:D,isResizing:F,selection:M,fillHandle:W,freezeTrailingRows:N,rows:P,getCellContent:O,getGroupDetails:B,getRowThemeOverride:J,isFocused:Q,drawHeaderCallback:pe,prelightCells:be,drawCellCallback:ye,highlightRegions:Z,resizeCol:U,imageLoader:ae,lastBlitData:Ce,hoverValues:we,hyperWrapping:ce,hoverInfo:ue,spriteManager:re,maxScaleFactor:q,hasAppendRow:Me,touchMode:de,enqueue:Oe,renderStateProvider:Ge,getCellRenderer:oe,renderStrategy:Re,bufferACtx:Qe,bufferBCtx:ft,damage:Ne,minimumCellWidth:Ht,resizeIndicator:Ee}=e;if(r===0||i===0)return;const De=Re==="double-buffer",he=Math.min(q,Math.ceil(window.devicePixelRatio??1)),Te=Re!=="direct"&&Rd(e,t),Be=n.canvas;(Be.width!==r*he||Be.height!==i*he)&&(Be.width=r*he,Be.height=i*he,Be.style.width=r+"px",Be.style.height=i+"px");const Ye=o.canvas,Xe=x.reduce((gt,Zt)=>gt+Zt,0),Ke=v+Xe,tt=Ke+1;(Ye.width!==r*he||Ye.height!==tt*he)&&(Ye.width=r*he,Ye.height=tt*he,Ye.style.width=r+"px",Ye.style.height=tt+"px");const st=Qe.canvas,Kt=ft.canvas;De&&(st.width!==r*he||st.height!==i*he)&&(st.width=r*he,st.height=i*he,Ce.current!==void 0&&(Ce.current.aBufferScroll=void 0)),De&&(Kt.width!==r*he||Kt.height!==i*he)&&(Kt.width=r*he,Kt.height=i*he,Ce.current!==void 0&&(Ce.current.bBufferScroll=void 0));const K=Ce.current;if(Te===!0&&c===(K==null?void 0:K.cellXOffset)&&l===(K==null?void 0:K.cellYOffset)&&d===(K==null?void 0:K.translateX)&&f===(K==null?void 0:K.translateY))return;let wt=null;De&&(wt=n);const nt=o;let me;De?Ne!==void 0?me=(K==null?void 0:K.lastBuffer)==="b"?ft:Qe:me=(K==null?void 0:K.lastBuffer)==="b"?Qe:ft:me=n;const ot=me.canvas,ht=De?ot===st?Kt:st:Be,Je=typeof $=="number"?()=>$:$;nt.save(),me.save(),nt.beginPath(),me.beginPath(),nt.textBaseline="middle",me.textBaseline="middle",he!==1&&(nt.scale(he,he),me.scale(he,he));const Ze=Ki(u,c,r,w,d);let xt=[];const Xt=p&&((xn=M.current)==null?void 0:xn.cell[1])===l&&f===0;let $t=!1;if(Z!==void 0){for(const gt of Z)if(gt.style!=="no-outline"&&gt.range.y===l&&f===0){$t=!0;break}}const Ot=()=>{nt.fillStyle=h.bgHeader,nt.fillRect(0,0,r,Ke+1),pd(nt,Ze,u,m,ue,r,d,v,S,w,F,M,h,re,we,A,B,Ne,pe,de,b,x),_l(nt,Ze,l,d,f,r,i,void 0,void 0,Xe,Ke,Je,J,A,N,P,h,!0),nt.beginPath(),nt.moveTo(0,tt-.5),nt.lineTo(r,tt-.5),nt.strokeStyle=gn(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),nt.stroke(),$t&&Vl(nt,r,i,c,l,d,f,u,g,v,Xe,$,N,P,Z,h),Xt&&Bi(nt,r,i,l,d,f,Ze,u,h,Ke,M,Je,O,N,Me,W,P)};if(Ne!==void 0){const gt=Ze[Ze.length-1].sourceIndex+1,Zt=Ne.hasItemInRegion([{x:c,y:-2,width:gt,height:2},{x:c,y:l,width:gt,height:300},{x:0,y:l,width:g,height:300},{x:0,y:-2,width:g,height:2},{x:c,y:P-N,width:gt,height:N,when:N>0}]),an=cn=>{Yl(cn,Ze,u,i,Ke,d,f,l,P,Je,O,B,J,E,Q,p,N,Me,xt,Ne,M,be,Z,ae,re,we,ue,ye,ce,h,Oe,Ge,oe,D,Ht);const _e=M.current;W!==!1&&W!==void 0&&p&&_e!==void 0&&Ne.has(vs(_e.range))&&Bi(cn,r,i,l,d,f,Ze,u,h,Ke,M,Je,O,N,Me,W,P)};Zt&&(an(me),wt!==null&&(wt.save(),wt.scale(he,he),wt.textBaseline="middle",an(wt),wt.restore()),Ne.hasHeader()&&(Ed(nt,Ze,r,Xe,Ke,d,f,l,Ne),Ot())),me.restore(),nt.restore();return}if((Te!==!0||c!==(K==null?void 0:K.cellXOffset)||l!==(K==null?void 0:K.cellYOffset)||d!==(K==null?void 0:K.translateX)||f!==(K==null?void 0:K.translateY)||Xt!==(K==null?void 0:K.mustDrawFocusOnHeader)||$t!==(K==null?void 0:K.mustDrawHighlightRingsOnHeader))&&Ot(),Te===!0){hn(ht!==void 0&&K!==void 0);const{regions:gt}=Sd(me,ht,ht===st?K.aBufferScroll:K.bBufferScroll,ht===st?K.bBufferScroll:K.aBufferScroll,K,c,l,d,f,N,r,i,P,Ke,he,u,Ze,$,De);xt=gt}else Te!==!1&&(hn(K!==void 0),xt=Md(K,c,l,d,f,r,i,Ke,Ze,Te));vd(me,Ze,r,i,N,P,A,Je,h);const Tt=Vl(me,r,i,c,l,d,f,u,g,v,Xe,$,N,P,Z,h),jt=p?Bi(me,r,i,l,d,f,Ze,u,h,Ke,M,Je,O,N,Me,W,P):void 0;if(me.fillStyle=h.bgCell,xt.length>0){me.beginPath();for(const gt of xt)me.rect(gt.x,gt.y,gt.width,gt.height);me.clip(),me.fill(),me.beginPath()}else me.fillRect(0,0,r,i);const Dt=Yl(me,Ze,u,i,Ke,d,f,l,P,Je,O,B,J,E,Q,p,N,Me,xt,Ne,M,be,Z,ae,re,we,ue,ye,ce,h,Oe,Ge,oe,D,Ht);kd(me,Ze,u,r,i,Ke,d,f,l,P,Je,J,M.rows,E,N,Me,xt,Ne,h),xd(me,Ze,l,d,f,r,i,xt,Ke,Je,J,A,N,P,h),_l(me,Ze,l,d,f,r,i,xt,Dt,Xe,Ke,Je,J,A,N,P,h),Tt==null||Tt(),jt==null||jt(),F&&Ee!=="none"&&uo(Ze,0,d,0,Ke,(gt,Zt)=>gt.sourceIndex===U?(Ul(nt,Zt+gt.width,0,Ke+1,gn(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),Ee==="full"&&Ul(me,Zt+gt.width,Ke,i,gn(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),wt!==null&&(wt.fillStyle=h.bgCell,wt.fillRect(0,0,r,i),wt.drawImage(me.canvas,0,0));const Wn=Id(Ze,i,Ke,d,f,l,P,Je,N,Me);ae==null||ae.setWindow({x:c,y:l,width:Ze.length,height:Wn-l},g,Array.from({length:N},(gt,Zt)=>P-1-Zt));const wn=K!==void 0&&(c!==K.cellXOffset||d!==K.translateX),rt=K!==void 0&&(l!==K.cellYOffset||f!==K.translateY);Ce.current={cellXOffset:c,cellYOffset:l,translateX:d,translateY:f,mustDrawFocusOnHeader:Xt,mustDrawHighlightRingsOnHeader:$t,lastBuffer:De?ot===st?"a":"b":void 0,aBufferScroll:ot===st?[wn,rt]:K==null?void 0:K.aBufferScroll,bBufferScroll:ot===Kt?[wn,rt]:K==null?void 0:K.bBufferScroll},me.restore(),nt.restore()}const Hd=80;function Dd(e){const t=e-1;return t*t*t+1}class Fd{constructor(t){Ue(this,"callback");Ue(this,"currentHoveredItem");Ue(this,"leavingItems",[]);Ue(this,"lastAnimationTime");Ue(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>kr(o.item,t.item))||this.leavingItems.push(t)});Ue(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>kr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Ue(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Ue(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Ue(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Dd(t.hoverAmount)})));Ue(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Hd;for(const i of this.leavingItems)i.hoverAmount=vn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=vn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Ue(this,"setHovered",t=>{var n;if(!kr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Td{constructor(t){Ue(this,"fn");Ue(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function sl(e){return new Td(e)}const Ad=sl(()=>window.navigator.userAgent.includes("Firefox")),li=sl(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),si=sl(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Pd(e){const t=a.useRef([]),n=a.useRef(0),o=a.useRef(e);o.current=e;const r=a.useCallback(()=>{const i=()=>window.requestAnimationFrame(c),c=()=>{const l=t.current.map(il);t.current=[],o.current(new jo(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:c)},[]);return a.useCallback(i=>{t.current.length===0&&r();const c=Fn(i[0],i[1]);t.current.includes(c)||t.current.push(c)},[r])}const so="header",Dn="group-header",ai="out-of-bounds";var qo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(qo||(qo={}));function Os(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const zd=(e,t)=>{if(e.kind===j.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Ld=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:c,cellYOffset:l,headerHeight:d,fillHandle:f=!1,groupHeaderHeight:u,groupLevels:m,groupHeaderHeights:g,rowHeight:w,rows:h,getCellContent:p,getRowThemeOverride:v,onHeaderMenuClick:S,onHeaderIndicatorClick:b,enableGroups:x,isFilling:E,onCanvasFocused:$,onCanvasBlur:A,isFocused:D,selection:F,freezeColumns:M,onContextMenu:W,freezeTrailingRows:N,fixedShadowX:P=!0,fixedShadowY:O=!0,drawFocusRing:B,onMouseDown:J,onMouseUp:Q,onMouseMoveRaw:pe,onMouseMove:be,onItemHovered:ye,dragAndDropState:Z,firstColAccessible:U,onKeyDown:ae,onKeyUp:Ce,highlightRegions:we,canvasRef:ce,onDragStart:ue,onDragEnd:re,eventTargetRef:q,isResizing:Me,resizeColumn:de,isDragging:Oe,isDraggable:Ge=!1,allowResize:oe,disabledRows:Re,hasAppendRow:Qe,getGroupDetails:ft,theme:Ne,prelightCells:Ht,headerIcons:Ee,verticalBorder:De,drawCell:he,drawHeader:Te,onCellFocused:Be,onDragOverCell:Ye,onDrop:Xe,onDragLeave:Ke,imageWindowLoader:tt,smoothScrollX:st=!1,smoothScrollY:Kt=!1,experimental:K,getCellRenderer:wt,resizeIndicator:nt="full"}=e,me=e.translateX??0,ot=e.translateY??0,ht=Math.max(M,Math.min(i.length-1,c)),Je=a.useRef(null),Ze=a.useRef((K==null?void 0:K.eventTarget)??window),xt=Ze.current,Xt=tt,$t=a.useRef(),[Ot,Tt]=a.useState(!1),jt=a.useRef([]),Dt=a.useRef(),[Wn,wn]=a.useState(),[rt,xn]=a.useState(),gt=a.useRef(null),[Zt,an]=a.useState(),[cn,_e]=a.useState(!1),Gt=a.useRef(cn);Gt.current=cn;const Ae=a.useMemo(()=>new ad(Ee,()=>{Fo.current=void 0,fo.current()}),[Ee]),at=x?u+d:d,ct=a.useRef(-1),Wt=((K==null?void 0:K.enableFirefoxRescaling)??!1)&&Ad.value,Jt=((K==null?void 0:K.enableSafariRescaling)??!1)&&li.value;a.useLayoutEffect(()=>{window.devicePixelRatio===1||!Wt&&!Jt||(ct.current!==-1&&Tt(!0),window.clearTimeout(ct.current),ct.current=window.setTimeout(()=>{Tt(!1),ct.current=-1},200))},[l,ht,me,ot,Wt,Jt]);const $e=hc(i,M),On=a.useMemo(()=>P?Qo($e,Z):0,[$e,Z,P]),St=a.useCallback((L,_,se)=>{const fe=L.getBoundingClientRect();if(_>=$e.length||se>=h)return;const ee=fe.width/n,le=_i(_,se,n,o,u,at,ht,l,me,ot,h,M,N,$e,w,m,g);return ee!==1&&(le.x*=ee,le.y*=ee,le.width*=ee,le.height*=ee),le.x+=fe.x,le.y+=fe.y,le},[n,o,u,at,ht,l,me,ot,h,M,N,$e,w,m,g]),Mt=a.useCallback((L,_,se,fe)=>{const ee=L.getBoundingClientRect(),le=ee.width/n,Pe=(_-ee.left)/le,R=(se-ee.top)/le,ke=5,Ve=Ki($e,ht,n,void 0,me);let ve=0,dt=0;const pt=typeof PointerEvent<"u"&&fe instanceof PointerEvent&&fe.pointerType==="mouse"||typeof MouseEvent<"u"&&fe instanceof MouseEvent,bt=typeof PointerEvent<"u"&&fe instanceof PointerEvent&&fe.pointerType==="touch"||typeof TouchEvent<"u"&&fe instanceof TouchEvent;pt&&(ve=fe.button,dt=fe.buttons);const yt=pc(Pe,Ve,me),At=bc(R,o,x,d,u,h,w,l,ot,N,m,g),z=(fe==null?void 0:fe.shiftKey)===!0,Ft=(fe==null?void 0:fe.ctrlKey)===!0,kt=(fe==null?void 0:fe.metaKey)===!0,bn=[Pe<0?-1:n<Pe?1:0,R<at?-1:o<R?1:0];let Pn;if(yt===-1||R<0||Pe<0||At===void 0||Pe>n||R>o){const it=Pe>n?1:Pe<0?-1:0,Pt=R>o?1:R<0?-1:0;let _t=it*2,Zn=Pt*2;it===0&&(_t=yt===-1?qo.EndPadding:qo.Center),Pt===0&&(Zn=At===void 0?qo.EndPadding:qo.Center);let fn=!1;if(yt===-1&&At===-1){const Jn=St(L,$e.length-1,-1);hn(Jn!==void 0),fn=_<Jn.x+Jn.width+ke}const po=Pe>n&&Pe<n+Gi()||R>o&&R<o+Gi();Pn={kind:ai,location:[yt!==-1?yt:Pe<0?0:$e.length-1,At??h-1],region:[_t,Zn],shiftKey:z,ctrlKey:Ft,metaKey:kt,isEdge:fn,isTouch:bt,button:ve,buttons:dt,scrollEdge:bn,isMaybeScrollbar:po}}else if(At<=-1){let it=St(L,yt,At);hn(it!==void 0);let Pt=it!==void 0&&it.x+it.width-_<=ke;const _t=x&&At<=-2,Zn=_t?-(At+2):void 0,fn=yt-1;_-it.x<=ke&&fn>=0?(Pt=!0,it=St(L,fn,At),hn(it!==void 0),Pn={kind:_t?Dn:so,location:[fn,At],bounds:it,group:Eo($e[fn].group,Zn),isEdge:Pt,shiftKey:z,ctrlKey:Ft,metaKey:kt,isTouch:bt,localEventX:_-it.x,localEventY:se-it.y,button:ve,buttons:dt,scrollEdge:bn}):Pn={kind:_t?Dn:so,group:Eo($e[yt].group,Zn),location:[yt,At],bounds:it,isEdge:Pt,shiftKey:z,ctrlKey:Ft,metaKey:kt,isTouch:bt,localEventX:_-it.x,localEventY:se-it.y,button:ve,buttons:dt,scrollEdge:bn}}else{const it=St(L,yt,At);hn(it!==void 0);const Pt=it!==void 0&&it.x+it.width-_<ke;let _t=!1;if(f!==!1&&f!==void 0&&F.current!==void 0){const fn=typeof f=="object"?{...oi,...f}:oi,po=fn.size,Jn=po/2,Rn=vs(F.current.range),Rt=St(L,Rn[0],Rn[1]);if(Rt!==void 0){const Yt=Rt.x+Rt.width+fn.offsetX-Jn+.5,zt=Rt.y+Rt.height+fn.offsetY-Jn+.5;_t=Math.abs(Yt-_)<po&&Math.abs(zt-se)<po}}Pn={kind:"cell",location:[yt,At],bounds:it,isEdge:Pt,shiftKey:z,ctrlKey:Ft,isFillHandle:_t,metaKey:kt,isTouch:bt,localEventX:_-it.x,localEventY:se-it.y,button:ve,buttons:dt,scrollEdge:bn}}return Pn},[n,$e,ht,me,o,x,d,u,h,w,l,ot,N,St,f,F,at]),[pn]=Wn??[],Mr=a.useRef(()=>{}),Ct=a.useRef(Wn);Ct.current=Wn;const[Nn,$n]=a.useMemo(()=>{const L=document.createElement("canvas"),_=document.createElement("canvas");return L.style.display="none",L.style.opacity="0",L.style.position="fixed",_.style.display="none",_.style.opacity="0",_.style.position="fixed",[L.getContext("2d",{alpha:!1}),_.getContext("2d",{alpha:!1})]},[]);a.useLayoutEffect(()=>{if(!(Nn===null||$n===null))return document.documentElement.append(Nn.canvas),document.documentElement.append($n.canvas),()=>{Nn.canvas.remove(),$n.canvas.remove()}},[Nn,$n]);const Do=a.useMemo(()=>new Ec,[]),Rr=Wt&&Ot?1:Jt&&Ot?2:5,Er=(K==null?void 0:K.disableMinimumCellWidth)===!0?1:10,Fo=a.useRef(),To=a.useRef(null),Tn=a.useRef(null),Ao=a.useCallback(()=>{var Pe;const L=Je.current,_=gt.current;if(L===null||_===null||(To.current===null&&(To.current=L.getContext("2d",{alpha:!1}),L.width=0,L.height=0),Tn.current===null&&(Tn.current=_.getContext("2d",{alpha:!1}),_.width=0,_.height=0),To.current===null||Tn.current===null||Nn===null||$n===null))return;let se=!1;const fe=R=>{se=!0,an(R)},ee=Fo.current,le={headerCanvasCtx:Tn.current,canvasCtx:To.current,bufferACtx:Nn,bufferBCtx:$n,width:n,height:o,cellXOffset:ht,cellYOffset:l,translateX:Math.round(me),translateY:Math.round(ot),mappedColumns:$e,enableGroups:x,freezeColumns:M,dragAndDropState:Z,theme:Ne,headerHeight:d,groupHeaderHeight:u,groupLevels:m,groupHeaderHeights:g,disabledRows:Re??lt.empty(),rowHeight:w,verticalBorder:De,isResizing:Me,resizeCol:de,isFocused:D,selection:F,fillHandle:f,drawCellCallback:he,hasAppendRow:Qe,overrideCursor:fe,maxScaleFactor:Rr,freezeTrailingRows:N,rows:h,drawFocus:B,getCellContent:p,getGroupDetails:ft??(R=>({name:R})),getRowThemeOverride:v,drawHeaderCallback:Te,prelightCells:Ht,highlightRegions:we,imageLoader:Xt,lastBlitData:Dt,damage:$t.current,hoverValues:jt.current,hoverInfo:Ct.current,spriteManager:Ae,scrolling:Ot,hyperWrapping:(K==null?void 0:K.hyperWrapping)??!1,touchMode:cn,enqueue:Mr.current,renderStateProvider:Do,renderStrategy:(K==null?void 0:K.renderStrategy)??(li.value?"double-buffer":"single-buffer"),getCellRenderer:wt,minimumCellWidth:Er,resizeIndicator:nt};le.damage===void 0?(Fo.current=le,ql(le,ee)):ql(le,void 0),!se&&(le.damage===void 0||le.damage.has((Pe=Ct==null?void 0:Ct.current)==null?void 0:Pe[0]))&&an(void 0)},[Nn,$n,n,o,ht,l,me,ot,$e,x,M,Z,Ne,d,u,m,g,Re,w,De,Me,Qe,de,D,F,f,N,h,B,Rr,p,ft,v,he,Te,Ht,we,Xt,Ae,Ot,K==null?void 0:K.hyperWrapping,K==null?void 0:K.renderStrategy,cn,Do,wt,Er,nt]),fo=a.useRef(Ao);a.useLayoutEffect(()=>{Ao(),fo.current=Ao},[Ao]),a.useLayoutEffect(()=>{(async()=>{var _;((_=document==null?void 0:document.fonts)==null?void 0:_.ready)!==void 0&&(await document.fonts.ready,Fo.current=void 0,fo.current())})()},[]);const _n=a.useCallback(L=>{$t.current=L,fo.current(),$t.current=void 0},[]),ui=Pd(_n);Mr.current=ui;const Ir=a.useCallback(L=>{_n(new jo(L.map(_=>_.cell)))},[_n]);Xt.setCallback(_n);const[Hr,fi]=a.useState(!1),[Xn,Vn]=pn??[],hi=Xn!==void 0&&Vn===-1&&Xn>=0&&Xn<$e.length&&$e[Xn].headerRowMarkerDisabled!==!0,Dr=Xn!==void 0&&Vn===-2;let Fr=!1,Tr=!1,Po=Zt;if(Po===void 0&&Xn!==void 0&&Vn!==void 0&&Vn>-1&&Vn<h){const L=p([Xn,Vn],!0);Fr=L.kind===Nt.NewRow||L.kind===Nt.Marker&&L.markerKind!=="number",Tr=L.kind===j.Boolean&&Ji(L),Po=L.cursor}const Pr=Oe?"grabbing":(rt??!1)||Me?"col-resize":Hr||E?"crosshair":Po!==void 0?Po:hi||Fr||Tr||Dr?"pointer":"default",zo=a.useMemo(()=>({contain:"strict",display:"block",cursor:Pr}),[Pr]),tr=a.useRef("default"),Un=q==null?void 0:q.current;Un!=null&&tr.current!==zo.cursor&&(Un.style.cursor=tr.current=zo.cursor);const Gn=a.useCallback((L,_,se,fe)=>{if(ft===void 0)return;const ee=ft(L);if(ee.actions!==void 0){const le=ll(_,ee.actions);for(const[Pe,R]of le.entries())if(ao(R,se+_.x,fe+R.y))return ee.actions[Pe]}},[ft]),Sn=a.useCallback((L,_,se,fe)=>{const ee=$e[_];if(!Oe&&!Me&&!(rt??!1)){const le=St(L,_,-1);hn(le!==void 0);const Pe=Ls(void 0,ee,le.x,le.y,le.width,le.height,Ne,el(ee.title)==="rtl");if(ee.hasMenu===!0&&Pe.menuBounds!==void 0&&ao(Pe.menuBounds,se,fe))return{area:"menu",bounds:Pe.menuBounds};if(ee.indicatorIcon!==void 0&&Pe.indicatorIconBounds!==void 0&&ao(Pe.indicatorIconBounds,se,fe))return{area:"indicator",bounds:Pe.indicatorIconBounds}}},[$e,St,rt,Oe,Me,Ne]),Lo=a.useRef(0),Fe=a.useRef(),nr=a.useRef(!1),Bo=a.useCallback(L=>{const _=Je.current,se=q==null?void 0:q.current;if(_===null||L.target!==_&&L.target!==se)return;nr.current=!0;const fe=L.clientX,ee=L.clientY;if(L.target===se&&se!==null){const Pe=se.getBoundingClientRect();if(fe>Pe.right||ee>Pe.bottom)return}const le=Mt(_,fe,ee,L);Fe.current=le.location,le.isTouch&&(Lo.current=Date.now()),Gt.current!==le.isTouch&&_e(le.isTouch),!(le.kind===so&&Sn(_,le.location[0],fe,ee)!==void 0)&&(le.kind===Dn&&Gn(le.group,le.bounds,le.localEventX,le.localEventY)!==void 0||(J==null||J(le),!le.isTouch&&Ge!==!0&&Ge!==le.kind&&le.button<3&&le.button!==1&&L.preventDefault()))},[q,Ge,Mt,Gn,Sn,J]);en("pointerdown",Bo,xt,!1);const dn=a.useRef(0),un=a.useCallback(L=>{var dt,pt;const _=dn.current;dn.current=Date.now();const se=Je.current;if(nr.current=!1,Q===void 0||se===null)return;const fe=q==null?void 0:q.current,ee=L.target!==se&&L.target!==fe,le=L.clientX,Pe=L.clientY,R=L.pointerType==="mouse"?L.button<3:!0;let ke=Mt(se,le,Pe,L);ke.isTouch&&Lo.current!==0&&Date.now()-Lo.current>500&&(ke={...ke,isLongTouch:!0}),_!==0&&Date.now()-_<(ke.isTouch?1e3:500)&&(ke={...ke,isDoubleClick:!0}),Gt.current!==ke.isTouch&&_e(ke.isTouch),!ee&&L.cancelable&&R&&L.preventDefault();const[Ve]=ke.location,ve=Sn(se,Ve,le,Pe);if(ke.kind===so&&ve!==void 0){(ke.button!==0||((dt=Fe.current)==null?void 0:dt[0])!==Ve||((pt=Fe.current)==null?void 0:pt[1])!==-1)&&Q(ke,!0);return}else if(ke.kind===Dn){const bt=Gn(ke.group,ke.bounds,ke.localEventX,ke.localEventY);if(bt!==void 0){ke.button===0&&bt.onClick(ke);return}}Q(ke,ee)},[Q,q,Mt,Sn,Gn]);en("pointerup",un,xt,!1);const gi=a.useCallback(L=>{var Ve,ve;const _=Je.current;if(_===null)return;const se=q==null?void 0:q.current,fe=L.target!==_&&L.target!==se;let ee,le,Pe=!0;L instanceof MouseEvent?(ee=L.clientX,le=L.clientY,Pe=L.button<3):(ee=L.changedTouches[0].clientX,le=L.changedTouches[0].clientY);const R=Mt(_,ee,le,L);Gt.current!==R.isTouch&&_e(R.isTouch),!fe&&L.cancelable&&Pe&&L.preventDefault();const[ke]=R.location;if(R.kind===so){const dt=Sn(_,ke,ee,le);dt!==void 0&&R.button===0&&((Ve=Fe.current)==null?void 0:Ve[0])===ke&&((ve=Fe.current)==null?void 0:ve[1])===-1&&(dt.area==="menu"?S==null||S(ke,dt.bounds):dt.area==="indicator"&&(b==null||b(ke,dt.bounds)))}},[q,Mt,Sn,S,b]);en("click",gi,xt,!1);const or=a.useCallback(L=>{const _=Je.current,se=q==null?void 0:q.current;if(_===null||L.target!==_&&L.target!==se||W===void 0)return;const fe=Mt(_,L.clientX,L.clientY,L);W(fe,()=>{L.cancelable&&L.preventDefault()})},[q,Mt,W]);en("contextmenu",or,(q==null?void 0:q.current)??null,!1);const Wo=a.useCallback(L=>{$t.current=new jo(L.map(_=>_.item)),jt.current=L,fo.current(),$t.current=void 0},[]),Oo=a.useMemo(()=>new Fd(Wo),[Wo]),rr=a.useRef(Oo);rr.current=Oo,a.useLayoutEffect(()=>{const L=rr.current;if(pn===void 0||pn[1]<0){L.setHovered(pn);return}const _=p(pn,!0),se=wt(_),fe=se===void 0&&_.kind===j.Custom||(se==null?void 0:se.needsHover)!==void 0&&(typeof se.needsHover=="boolean"?se.needsHover:se.needsHover(_));L.setHovered(fe?pn:void 0)},[p,wt,pn]);const ho=a.useRef(),qn=a.useCallback(L=>{var R;const _=Je.current;if(_===null)return;const se=q==null?void 0:q.current,fe=L.target!==_&&L.target!==se,ee=Mt(_,L.clientX,L.clientY,L);if(ee.kind!=="out-of-bounds"&&fe&&!nr.current&&!ee.isTouch)return;const le=(ke,Ve)=>{wn(ve=>ve===ke||(ve==null?void 0:ve[0][0])===(ke==null?void 0:ke[0][0])&&(ve==null?void 0:ve[0][1])===(ke==null?void 0:ke[0][1])&&((ve==null?void 0:ve[1][0])===(ke==null?void 0:ke[1][0])&&(ve==null?void 0:ve[1][1])===(ke==null?void 0:ke[1][1])||!Ve)?ve:ke)};if(!Os(ee,ho.current))an(void 0),ye==null||ye(ee),le(ee.kind===ai?void 0:[ee.location,[ee.localEventX,ee.localEventY]],!0),ho.current=ee;else if(ee.kind==="cell"||ee.kind===so||ee.kind===Dn){let ke=!1,Ve=!0;if(ee.kind==="cell"){const dt=p(ee.location);Ve=((R=wt(dt))==null?void 0:R.needsHoverPosition)??dt.kind===j.Custom,ke=Ve}else ke=!0;const ve=[ee.location,[ee.localEventX,ee.localEventY]];le(ve,Ve),Ct.current=ve,ke&&_n(new jo([ee.location]))}const Pe=ee.location[0]>=(U?0:1);xn(ee.kind===so&&ee.isEdge&&Pe&&oe===!0),fi(ee.kind==="cell"&&ee.isFillHandle),pe==null||pe(L),be(ee)},[q,Mt,U,oe,pe,be,ye,p,wt,_n]);en("pointermove",qn,xt,!0);const mi=a.useCallback(L=>{const _=Je.current;if(_===null)return;let se,fe;F.current!==void 0&&(se=St(_,F.current.cell[0],F.current.cell[1]),fe=F.current.cell),ae==null||ae({bounds:se,stopPropagation:()=>L.stopPropagation(),preventDefault:()=>L.preventDefault(),cancel:()=>{},ctrlKey:L.ctrlKey,metaKey:L.metaKey,shiftKey:L.shiftKey,altKey:L.altKey,key:L.key,keyCode:L.keyCode,rawEvent:L,location:fe})},[ae,F,St]),ir=a.useCallback(L=>{const _=Je.current;if(_===null)return;let se,fe;F.current!==void 0&&(se=St(_,F.current.cell[0],F.current.cell[1]),fe=F.current.cell),Ce==null||Ce({bounds:se,stopPropagation:()=>L.stopPropagation(),preventDefault:()=>L.preventDefault(),cancel:()=>{},ctrlKey:L.ctrlKey,metaKey:L.metaKey,shiftKey:L.shiftKey,altKey:L.altKey,key:L.key,keyCode:L.keyCode,rawEvent:L,location:fe})},[Ce,F,St]),No=a.useCallback(L=>{if(Je.current=L,ce!==void 0&&(ce.current=L),K!=null&&K.eventTarget)Ze.current=K.eventTarget;else if(L===null)Ze.current=window;else{const _=L.getRootNode();_===document&&(Ze.current=window),Ze.current=_}},[ce,K==null?void 0:K.eventTarget]),wi=a.useCallback(L=>{const _=Je.current;if(_===null||Ge===!1||Me){L.preventDefault();return}let se,fe;const ee=Mt(_,L.clientX,L.clientY);if(Ge!==!0&&ee.kind!==Ge){L.preventDefault();return}const le=(dt,pt)=>{se=dt,fe=pt};let Pe,R,ke;const Ve=(dt,pt,bt)=>{Pe=dt,R=pt,ke=bt};let ve=!1;if(ue==null||ue({...ee,setData:le,setDragImage:Ve,preventDefault:()=>ve=!0,defaultPrevented:()=>ve}),!ve&&se!==void 0&&fe!==void 0&&L.dataTransfer!==null)if(L.dataTransfer.setData(se,fe),L.dataTransfer.effectAllowed="copyLink",Pe!==void 0&&R!==void 0&&ke!==void 0)L.dataTransfer.setDragImage(Pe,R,ke);else{const[dt,pt]=ee.location;if(pt!==void 0){const bt=document.createElement("canvas"),yt=St(_,dt,pt);hn(yt!==void 0);const At=Math.ceil(window.devicePixelRatio??1);bt.width=yt.width*At,bt.height=yt.height*At;const z=bt.getContext("2d");z!==null&&(z.scale(At,At),z.textBaseline="middle",pt===-1?(z.font=Ne.headerFontFull,z.fillStyle=Ne.bgHeader,z.fillRect(0,0,bt.width,bt.height),Bs(z,0,0,yt.width,yt.height,$e[dt],!1,Ne,!1,void 0,void 0,!1,0,Ae,Te,!1)):(z.font=Ne.baseFontFull,z.fillStyle=Ne.bgCell,z.fillRect(0,0,bt.width,bt.height),zs(z,p([dt,pt]),0,pt,!1,!1,0,0,yt.width,yt.height,!1,Ne,Ne.bgCell,Xt,Ae,1,void 0,!1,0,void 0,void 0,void 0,Do,wt,()=>{},0))),bt.style.left="-100%",bt.style.position="absolute",bt.style.width=`${yt.width}px`,bt.style.height=`${yt.height}px`,document.body.append(bt),L.dataTransfer.setDragImage(bt,yt.width/2,yt.height/2),window.setTimeout(()=>{bt.remove()},0)}}else L.preventDefault()},[Ge,Me,Mt,ue,St,Ne,$e,Ae,Te,p,Xt,Do,wt]);en("dragstart",wi,(q==null?void 0:q.current)??null,!1,!1);const go=a.useRef(),$o=a.useCallback(L=>{const _=Je.current;if(Xe!==void 0&&L.preventDefault(),_===null||Ye===void 0)return;const se=Mt(_,L.clientX,L.clientY),[fe,ee]=se.location,le=fe-(U?0:1),[Pe,R]=go.current??[];(Pe!==le||R!==ee)&&(go.current=[le,ee],Ye([le,ee],L.dataTransfer))},[U,Mt,Ye,Xe]);en("dragover",$o,(q==null?void 0:q.current)??null,!1,!1);const jn=a.useCallback(()=>{go.current=void 0,re==null||re()},[re]);en("dragend",jn,(q==null?void 0:q.current)??null,!1,!1);const Xo=a.useCallback(L=>{const _=Je.current;if(_===null||Xe===void 0)return;L.preventDefault();const se=Mt(_,L.clientX,L.clientY),[fe,ee]=se.location,le=fe-(U?0:1);Xe([le,ee],L.dataTransfer)},[U,Mt,Xe]);en("drop",Xo,(q==null?void 0:q.current)??null,!1,!1);const pi=a.useCallback(()=>{Ke==null||Ke()},[Ke]);en("dragleave",pi,(q==null?void 0:q.current)??null,!1,!1);const lr=a.useRef(F);lr.current=F;const Ie=a.useRef(null),mo=a.useCallback(L=>{var _;Je.current===null||!Je.current.contains(document.activeElement)||(L===null&&lr.current.current!==void 0?(_=ce==null?void 0:ce.current)==null||_.focus({preventScroll:!0}):L!==null&&L.focus({preventScroll:!0}),Ie.current=L)},[ce]);a.useImperativeHandle(t,()=>({focus:()=>{var _;const L=Ie.current;L===null||!document.contains(L)?(_=ce==null?void 0:ce.current)==null||_.focus({preventScroll:!0}):L.focus({preventScroll:!0})},getBounds:(L,_)=>{if(!(ce===void 0||ce.current===null))return St(ce.current,L??0,_??-1)},damage:Ir,getMouseArgsForPosition:(L,_,se)=>{if(!(ce===void 0||ce.current===null))return Mt(ce.current,L,_,se)}}),[ce,Ir,St,Mt]);const sr=a.useRef(),Mn=Ga(()=>{var R,ke,Ve;if(n<50||(K==null?void 0:K.disableAccessibilityTree)===!0)return null;let L=Ki($e,ht,n,Z,me);const _=U?0:-1;!U&&((R=L[0])==null?void 0:R.sourceIndex)===0&&(L=L.slice(1));const[se,fe]=((ke=F.current)==null?void 0:ke.cell)??[],ee=(Ve=F.current)==null?void 0:Ve.range,le=L.map(ve=>ve.sourceIndex),Pe=Mo(l,Math.min(h,l+r));return se!==void 0&&fe!==void 0&&!(le.includes(se)&&Pe.includes(fe))&&mo(null),a.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":h+1,"aria-multiselectable":"true","aria-colcount":$e.length+_},a.createElement("thead",{role:"rowgroup"},a.createElement("tr",{role:"row","aria-rowindex":1},L.map(ve=>a.createElement("th",{role:"columnheader","aria-selected":F.columns.hasIndex(ve.sourceIndex),"aria-colindex":ve.sourceIndex+1+_,tabIndex:-1,onFocus:dt=>{if(dt.target!==Ie.current)return Be==null?void 0:Be([ve.sourceIndex,-1])},key:ve.sourceIndex},ve.title)))),a.createElement("tbody",{role:"rowgroup"},Pe.map(ve=>a.createElement("tr",{role:"row","aria-selected":F.rows.hasIndex(ve),key:ve,"aria-rowindex":ve+2},L.map(dt=>{const pt=dt.sourceIndex,bt=Fn(pt,ve),yt=se===pt&&fe===ve,At=ee!==void 0&&pt>=ee.x&&pt<ee.x+ee.width&&ve>=ee.y&&ve<ee.y+ee.height,z=`glide-cell-${pt}-${ve}`,Ft=[pt,ve],kt=p(Ft,!0);return a.createElement("td",{key:bt,role:"gridcell","aria-colindex":pt+1+_,"aria-selected":At,"aria-readonly":Ro(kt)||!io(kt),id:z,"data-testid":z,onClick:()=>{const bn=ce==null?void 0:ce.current;if(bn!=null)return ae==null?void 0:ae({bounds:St(bn,pt,ve),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:Ft})},onFocusCapture:bn=>{var Pn,it;if(!(bn.target===Ie.current||((Pn=sr.current)==null?void 0:Pn[0])===pt&&((it=sr.current)==null?void 0:it[1])===ve))return sr.current=Ft,Be==null?void 0:Be(Ft)},ref:yt?mo:void 0,tabIndex:-1},zd(kt,wt))})))))},[n,$e,ht,Z,me,h,l,r,F,mo,p,ce,ae,St,Be],200),Go=M===0||!P?0:ht>M?1:vn(-me/100,0,1),An=-l*32+ot,wo=O?vn(-An/100,0,1):0,ar=a.useMemo(()=>{if(!Go&&!wo)return null;const L={position:"absolute",top:0,left:On,width:n-On,height:o,opacity:Go,pointerEvents:"none",transition:st?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},_={position:"absolute",top:at,left:0,width:n,height:o,opacity:wo,pointerEvents:"none",transition:Kt?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return a.createElement(a.Fragment,null,Go>0&&a.createElement("div",{id:"shadow-x",style:L}),wo>0&&a.createElement("div",{id:"shadow-y",style:_}))},[Go,wo,On,n,st,at,o,Kt]),zr=a.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return a.createElement(a.Fragment,null,a.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:-1,onKeyDown:mi,onKeyUp:ir,onFocus:$,onBlur:A,ref:No,style:zo},Mn),a.createElement("canvas",{ref:gt,style:zr}),ar)},Bd=a.memo(a.forwardRef(Ld));function Cr(e,t,n,o){return vn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Wd=e=>{const[t,n]=a.useState(),[o,r]=a.useState(),[i,c]=a.useState(),[l,d]=a.useState(),[f,u]=a.useState(!1),[m,g]=a.useState(),[w,h]=a.useState(),[p,v]=a.useState(),[S,b]=a.useState(!1),[x,E]=a.useState(),{onHeaderMenuClick:$,onHeaderIndicatorClick:A,getCellContent:D,onColumnMoved:F,onColumnResize:M,onColumnResizeStart:W,onColumnResizeEnd:N,gridRef:P,maxColumnWidth:O,minColumnWidth:B,onRowMoved:J,lockColumns:Q,onColumnProposeMove:pe,onMouseDown:be,onMouseUp:ye,onItemHovered:Z,onDragStart:U,canvasRef:ae}=e,Ce=(M??N??W)!==void 0,{columns:we,selection:ce}=e,ue=ce.columns,re=a.useCallback(Ee=>{const[De,he]=Ee.location;i!==void 0&&l!==De&&De>=Q?(u(!0),d(De)):w!==void 0&&he!==void 0?(b(!0),v(Math.max(0,he))):o===void 0&&!f&&!S&&(Z==null||Z(Ee))},[i,w,l,Z,Q,o,f,S]),q=F!==void 0,Me=a.useCallback(Ee=>{var De;if(Ee.button===0){const[he,Te]=Ee.location;if(Ee.kind==="out-of-bounds"&&Ee.isEdge&&Ce){const Be=(De=P==null?void 0:P.current)==null?void 0:De.getBounds(we.length-1,-1);Be!==void 0&&(n(Be.x),r(we.length-1))}else if(Ee.kind==="header"&&he>=Q){const Be=ae==null?void 0:ae.current;if(Ee.isEdge&&Ce&&Be){n(Ee.bounds.x),r(he);const Xe=Be.getBoundingClientRect().width/Be.offsetWidth,Ke=Ee.bounds.width/Xe;W==null||W(we[he],Ke,he,Ke+(we[he].growOffset??0))}else Ee.kind==="header"&&q&&(g(Ee.bounds.x),c(he))}else Ee.kind==="cell"&&Q>0&&he===0&&Te!==void 0&&J!==void 0&&(E(Ee.bounds.y),h(Te))}be==null||be(Ee)},[be,Ce,Q,J,P,we,q,W,ae]),de=a.useCallback((Ee,De)=>{f||S||$==null||$(Ee,De)},[f,S,$]),Oe=a.useCallback((Ee,De)=>{f||S||A==null||A(Ee,De)},[f,S,A]),Ge=a.useRef(-1),oe=a.useCallback(()=>{Ge.current=-1,h(void 0),v(void 0),E(void 0),b(!1),c(void 0),d(void 0),g(void 0),u(!1),r(void 0),n(void 0)},[]),Re=a.useCallback((Ee,De)=>{if(Ee.button===0){if(o!==void 0){if((ue==null?void 0:ue.hasIndex(o))===!0)for(const Te of ue){if(Te===o)continue;const Be=we[Te],Ye=Cr(Be,Ge.current,B,O);M==null||M(Be,Ye,Te,Ye+(Be.growOffset??0))}const he=Cr(we[o],Ge.current,B,O);if(N==null||N(we[o],he,o,he+(we[o].growOffset??0)),ue.hasIndex(o))for(const Te of ue){if(Te===o)continue;const Be=we[Te],Ye=Cr(Be,Ge.current,B,O);N==null||N(Be,Ye,Te,Ye+(Be.growOffset??0))}}oe(),i!==void 0&&l!==void 0&&(pe==null?void 0:pe(i,l))!==!1&&(F==null||F(i,l)),w!==void 0&&p!==void 0&&(J==null||J(w,p))}ye==null||ye(Ee,De)},[ye,o,i,l,w,p,ue,N,we,B,O,M,F,J,oe,pe]),Qe=a.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(pe==null?void 0:pe(i,l))!==!1)return{src:i,dest:l}},[i,l,pe]),ft=a.useCallback(Ee=>{const De=ae==null?void 0:ae.current;if(i!==void 0&&m!==void 0)Math.abs(Ee.clientX-m)>20&&u(!0);else if(w!==void 0&&x!==void 0)Math.abs(Ee.clientY-x)>20&&b(!0);else if(o!==void 0&&t!==void 0&&De){const Te=De.getBoundingClientRect().width/De.offsetWidth,Be=(Ee.clientX-t)/Te,Ye=we[o],Xe=Cr(Ye,Be,B,O);if(M==null||M(Ye,Xe,o,Xe+(Ye.growOffset??0)),Ge.current=Be,(ue==null?void 0:ue.first())===o)for(const Ke of ue){if(Ke===o)continue;const tt=we[Ke],st=Cr(tt,Ge.current,B,O);M==null||M(tt,st,Ke,st+(tt.growOffset??0))}}},[i,m,w,x,o,t,we,B,O,M,ue,ae]),Ne=a.useCallback((Ee,De)=>{if(w===void 0||p===void 0)return D(Ee,De);let[he,Te]=Ee;return Te===p?Te=w:(Te>p&&(Te-=1),Te>=w&&(Te+=1)),D([he,Te],De)},[w,p,D]),Ht=a.useCallback(Ee=>{U==null||U(Ee),Ee.defaultPrevented()||oe()},[oe,U]);return a.createElement(Bd,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:Ne,isResizing:o!==void 0,onHeaderMenuClick:de,onHeaderIndicatorClick:Oe,isDragging:f,onItemHovered:re,onDragStart:Ht,onMouseDown:Me,allowResize:Ce,onMouseUp:Re,dragAndDropState:Qe,onMouseMoveRaw:ft,ref:P})};function Od(e){const t=a.useRef(null),[n,o]=a.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return a.useLayoutEffect(()=>{const r=c=>{for(const l of c){const{width:d,height:f}=l&&l.contentRect||{};o(u=>u.width===d&&u.height===f?u:{width:d,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Nd=(e,t,n)=>{const o=a.useRef(null),r=a.useRef(null),i=a.useRef(null),c=a.useRef(0),l=a.useRef(t);l.current=t;const d=n.current;a.useEffect(()=>{const f=()=>{var g,w;if(r.current===!1&&d!==null){const h=[d.scrollLeft,d.scrollTop];if(((g=i.current)==null?void 0:g[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(c.current>10){i.current=null,r.current=null;return}else c.current++;else c.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},m=g=>{g.touches.length===0&&(r.current=!1,c.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&d!==null){const g=d;return g.addEventListener("touchstart",u),g.addEventListener("touchend",m),()=>{g.removeEventListener("touchstart",u),g.removeEventListener("touchend",m),o.current!==null&&window.clearTimeout(o.current)}}},[e,d])},$d=()=>e=>e.isSafari?"scroll":"auto",Xd=tn("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[$d()]}}),Gd=33554400,Yd=5e6;function Kd(e){const[t,n]=a.useState(!1),o=typeof window>"u"?null:window,r=a.useRef(0);return en("touchstart",a.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),en("touchend",a.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const _d=e=>{var ce,ue;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:c,className:l,preventDiagonalScrolling:d=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:m,rightElementProps:g,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:p}=e,v=[],S=(g==null?void 0:g.sticky)??!1,b=(g==null?void 0:g.fill)??!1,x=a.useRef(0),E=a.useRef(0),$=a.useRef(null),A=typeof window>"u"?1:window.devicePixelRatio,D=a.useRef(A);a.useEffect(()=>{if(D.current!==A){x.current=0,E.current=0,D.current=A;const re=$.current;re!==null&&J.current(re.scrollLeft,re.scrollTop)}},[A]);const F=a.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),M=a.useRef(null),W=Kd(200),[N,P]=a.useState(!0),O=a.useRef(0);a.useLayoutEffect(()=>{if(!N||W||F.current.lockDirection===void 0)return;const re=$.current;if(re===null)return;const[q,Me]=F.current.lockDirection;q!==void 0?re.scrollLeft=q:Me!==void 0&&(re.scrollTop=Me),F.current.lockDirection=void 0},[W,N]);const B=a.useCallback((re,q)=>{var he;const Me=$.current;if(Me===null)return;q=q??Me.scrollTop,re=re??Me.scrollLeft;const de=F.current.scrollTop,Oe=F.current.scrollLeft,Ge=re-Oe,oe=q-de;W&&Ge!==0&&oe!==0&&(Math.abs(Ge)>3||Math.abs(oe)>3)&&d&&F.current.lockDirection===void 0&&(F.current.lockDirection=Math.abs(Ge)<Math.abs(oe)?[Oe,void 0]:[void 0,de]);const Re=F.current.lockDirection;re=(Re==null?void 0:Re[0])??re,q=(Re==null?void 0:Re[1])??q,F.current.scrollLeft=re,F.current.scrollTop=q;const Qe=Me.clientWidth,ft=Me.clientHeight,Ne=q,Ht=E.current-Ne,Ee=Me.scrollHeight-ft;E.current=Ne;let De;if(Ee>0&&o>Me.scrollHeight+5)if(Math.abs(Ht)>2e3||Ne===0||Ne===Ee){const Te=Math.max(0,Math.min(1,Ne/Ee)),Be=o-ft;De=Te*Be,x.current=De}else x.current-=Ht,De=x.current;else De=Ne,x.current=De;De=Math.max(0,Math.min(De,o-ft)),x.current=De,Re!==void 0&&(window.clearTimeout(O.current),P(!1),O.current=window.setTimeout(()=>P(!0),200)),i({x:re,y:De,width:Qe-u,height:ft-f,paddingRight:((he=M.current)==null?void 0:he.clientWidth)??0})},[f,u,o,i,d,W]);Nd(w&&li.value,B,$);const J=a.useRef(B);J.current=B;const Q=a.useRef(),pe=a.useRef(!1);a.useLayoutEffect(()=>{pe.current?B():pe.current=!0},[B,f,u]);const be=a.useCallback(re=>{$.current=re,h!==void 0&&(h.current=re)},[h]);let ye=0,Z=0;const U=Math.min(o,Gd);for(v.push(a.createElement("div",{key:ye++,style:{width:r,height:0}}));Z<U;){const re=Math.min(Yd,U-Z);v.push(a.createElement("div",{key:ye++,style:{width:0,height:re}})),Z+=re}const{ref:ae,width:Ce,height:we}=Od(p);return typeof window<"u"&&(((ce=Q.current)==null?void 0:ce.height)!==we||((ue=Q.current)==null?void 0:ue.width)!==Ce)&&(window.setTimeout(()=>J.current(),0),Q.current={width:Ce,height:we}),(Ce??0)===0||(we??0)===0?a.createElement("div",{ref:ae}):a.createElement("div",{ref:ae},a.createElement(Xd,{isSafari:li.value},a.createElement("div",{className:"dvn-underlay"},t),a.createElement("div",{ref:be,style:Q.current,draggable:c,onDragStart:re=>{c||(re.stopPropagation(),re.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>B()},a.createElement("div",{className:"dvn-scroll-inner"+(m===void 0?" dvn-hidden":"")},a.createElement("div",{className:"dvn-stack"},v),m!==void 0&&a.createElement(a.Fragment,null,!b&&a.createElement("div",{className:"dvn-spacer"}),a.createElement("div",{ref:M,style:{height:we,maxHeight:n-Math.ceil(A%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:b?1:void 0,right:S?u??0:void 0,pointerEvents:"auto"}},m))))))},Vd=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:c,freezeColumns:l,experimental:d,nonGrowWidth:f,clientSize:u,className:m,onVisibleRegionChanged:g,scrollRef:w,preventDiagonalScrolling:h,rightElement:p,rightElementProps:v,overscrollX:S,overscrollY:b,initialSize:x,smoothScrollX:E=!1,smoothScrollY:$=!1,isDraggable:A}=e,{paddingRight:D,paddingBottom:F}=d??{},[M,W]=u,N=a.useRef(),P=a.useRef(),O=a.useRef(),B=a.useRef(),J=f+Math.max(0,S??0);let Q=c?r+i:r;if(typeof o=="number")Q+=n*o;else for(let Z=0;Z<n;Z++)Q+=o(Z);b!==void 0&&(Q+=b);const pe=a.useRef(),be=a.useCallback(()=>{var Oe,Ge;if(pe.current===void 0)return;const Z={...pe.current};let U=0,ae=Z.x<0?-Z.x:0,Ce=0,we=0;Z.x=Z.x<0?0:Z.x;let ce=0;for(let oe=0;oe<l;oe++)ce+=t[oe].width;for(const oe of t){const Re=U-ce;if(Z.x>=Re+oe.width)U+=oe.width,we++,Ce++;else if(Z.x>Re)U+=oe.width,E?ae+=Re-Z.x:we++,Ce++;else if(Z.x+Z.width>Re)U+=oe.width,Ce++;else break}let ue=0,re=0,q=0;if(typeof o=="number")$?(re=Math.floor(Z.y/o),ue=re*o-Z.y):re=Math.ceil(Z.y/o),q=Math.ceil(Z.height/o)+re,ue<0&&q++;else{let oe=0;for(let Re=0;Re<n;Re++){const Qe=o(Re),ft=oe+($?0:Qe/2);if(Z.y>=oe+Qe)oe+=Qe,re++,q++;else if(Z.y>ft)oe+=Qe,$?ue+=ft-Z.y:re++,q++;else if(Z.y+Z.height>Qe/2+oe)oe+=Qe,q++;else break}}re=Math.max(0,Math.min(re,n-1)),q=Math.max(re,Math.min(q,n));const Me={x:we,y:re,width:Ce-we,height:q-re},de=N.current;(de===void 0||de.y!==Me.y||de.x!==Me.x||de.height!==Me.height||de.width!==Me.width||P.current!==ae||O.current!==ue||Z.width!==((Oe=B.current)==null?void 0:Oe[0])||Z.height!==((Ge=B.current)==null?void 0:Ge[1]))&&(g==null||g({x:we,y:re,width:Ce-we,height:q-re},Z.width,Z.height,Z.paddingRight??0,ae,ue),N.current=Me,P.current=ae,O.current=ue,B.current=[Z.width,Z.height])},[t,o,n,g,l,E,$]),ye=a.useCallback(Z=>{pe.current=Z,be()},[be]);return a.useEffect(()=>{be()},[be]),a.createElement(_d,{scrollRef:w,className:m,kineticScrollPerfHack:d==null?void 0:d.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:A===!0||typeof A=="string",scrollWidth:J+(D??0),scrollHeight:Q+(F??0),clientHeight:W,rightElement:p,paddingBottom:F,paddingRight:D,rightElementProps:v,update:ye,initialSize:x},a.createElement(Wd,{eventTargetRef:w,width:M,height:W,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Ud=tn("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),qd=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),jd=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Zd=a.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},a.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Jd=10,Qd=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:c,searchResults:l,onSearchValueChange:d,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:m=!1,onSearchClose:g}=e,[w]=a.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,p]=a.useState(""),v=c??h,S=a.useCallback(U=>{p(U),d==null||d(U)},[d]),[b,x]=a.useState(),E=a.useRef(b);E.current=b,a.useEffect(()=>{l!==void 0&&(l.length>0?x(U=>({rowsSearched:o,results:l.length,selectedIndex:(U==null?void 0:U.selectedIndex)??-1})):x(void 0))},[o,l]);const $=a.useRef();$.current===void 0&&($.current=new AbortController);const A=a.useRef(),[D,F]=a.useState([]),M=l??D,W=a.useCallback(()=>{A.current!==void 0&&(window.cancelAnimationFrame(A.current),A.current=void 0),$.current!==void 0&&$.current.abort(),$.current=new AbortController},[]),N=a.useRef(n);N.current=n;const P=a.useCallback(U=>{const ae=new RegExp(U.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let Ce=N.current,we=Math.min(10,o),ce=0;x(void 0),F([]);const ue=[],re=async()=>{var Ne;if(f===void 0)return;const q=performance.now(),Me=o-ce;let de=f({x:0,y:Ce,width:r.length,height:Math.min(we,Me,o-Ce)},$.current.signal);typeof de=="function"&&(de=await de());let Oe=!1;for(const[Ht,Ee]of de.entries())for(const[De,he]of Ee.entries()){let Te;switch(he.kind){case j.Text:case j.Number:Te=he.displayData;break;case j.Uri:case j.Markdown:Te=he.data;break;case j.Boolean:Te=typeof he.data=="boolean"?he.data.toString():void 0;break;case j.Image:case j.Bubble:Te=he.data.join("🐳");break;case j.Custom:Te=he.copyData;break}Te!==void 0&&ae.test(Te)&&(ue.push([De,Ht+Ce]),Oe=!0)}const Ge=performance.now();Oe&&F([...ue]),ce+=de.length,hn(ce<=o);const oe=((Ne=E.current)==null?void 0:Ne.selectedIndex)??-1;x({results:ue.length,rowsSearched:ce,selectedIndex:oe}),u==null||u(ue,oe),Ce+we>=o?Ce=0:Ce+=we;const Re=Ge-q,Qe=Math.max(Re,1),ft=Jd/Qe;we=Math.ceil(we*ft),ce<o&&ue.length<1e3&&(A.current=window.requestAnimationFrame(re))};W(),A.current=window.requestAnimationFrame(re)},[W,r.length,f,u,o]),O=a.useCallback(()=>{var U;g==null||g(),x(void 0),F([]),u==null||u([],-1),W(),(U=t==null?void 0:t.current)==null||U.focus()},[W,t,g,u]),B=a.useCallback(U=>{S(U.target.value),l===void 0&&(U.target.value===""?(x(void 0),F([]),W()):P(U.target.value))},[P,W,S,l]);a.useEffect(()=>{i.current!==null&&(S(""),x(void 0),D.length>0&&(F([]),u==null||u([],-1)),m?i.current.focus({preventScroll:!0}):W())},[m,i]);const J=a.useCallback(U=>{var Ce;if((Ce=U==null?void 0:U.stopPropagation)==null||Ce.call(U),b===void 0||b.results===0)return;const ae=(b.selectedIndex+1)%b.results;x({...b,selectedIndex:ae}),u==null||u(M,ae)},[b,u,M]),Q=a.useCallback(U=>{var Ce;if((Ce=U==null?void 0:U.stopPropagation)==null||Ce.call(U),b===void 0||b.results===0)return;let ae=(b.selectedIndex-1)%b.results;ae<0&&(ae+=b.results),x({...b,selectedIndex:ae}),u==null||u(M,ae)},[u,M,b]),pe=a.useCallback(U=>{(U.ctrlKey||U.metaKey)&&U.nativeEvent.code==="KeyF"||U.key==="Escape"?(O(),U.stopPropagation(),U.preventDefault()):U.key==="Enter"&&(U.shiftKey?Q():J())},[O,J,Q]);a.useEffect(()=>()=>{W()},[W]);const[be,ye]=a.useState(!1);a.useEffect(()=>{if(m)ye(!0);else{const U=setTimeout(()=>ye(!1),150);return()=>clearTimeout(U)}},[m]);const Z=a.useMemo(()=>{if(!m&&!be)return null;let U;b!==void 0&&(U=b.results>=1e3?"over 1000":`${b.results} result${b.results!==1?"s":""}`,b.selectedIndex>=0&&(U=`${b.selectedIndex+1} of ${U}`));const ae=ce=>{ce.stopPropagation()},we={width:`${o>0?Math.floor(((b==null?void 0:b.rowsSearched)??0)/o*100):0}%`};return a.createElement(Ud,{className:"gdg-search-bar"+(m?"":" out"),onMouseDown:ae,onMouseMove:ae,onMouseUp:ae,onClick:ae},a.createElement("div",{className:"gdg-search-bar-inner"},a.createElement("input",{id:w,"aria-hidden":!m,"data-testid":"search-input",ref:i,onChange:B,value:v,tabIndex:m?void 0:-1,onKeyDownCapture:pe}),a.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:Q,disabled:((b==null?void 0:b.results)??0)===0},qd),a.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:J,disabled:((b==null?void 0:b.results)??0)===0},jd),g!==void 0&&a.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!m,"data-testid":"search-close-button",tabIndex:m?void 0:-1,onClick:O},Zd)),b!==void 0?a.createElement(a.Fragment,null,a.createElement("div",{className:"gdg-search-status"},a.createElement("div",{"data-testid":"search-result-area"},U)),a.createElement("div",{className:"gdg-search-progress",style:we})):a.createElement("div",{className:"gdg-search-status"},a.createElement("label",{htmlFor:w},"Type to search")))},[m,be,b,o,w,i,B,v,pe,Q,J,g,O]);return a.createElement(a.Fragment,null,a.createElement(Vd,{prelightCells:M,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Z)},eu=()=>e=>Math.max(16,e.targetHeight-10),tu=tn("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[eu(),"px"]}}),nu=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[c,l]=It.useState(n);return It.createElement(ws,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},It.createElement(tu,{targetHeight:t.height,"data-testid":"group-rename-input",value:c,onBlur:o,onFocus:d=>d.target.setSelectionRange(0,c.length),onChange:d=>l(d.target.value),onKeyDown:d=>{d.key==="Enter"?i(c):d.key==="Escape"&&o()},autoFocus:!0}))};function ou(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function qe(e,t,n){const o=Ns(e,t);return o&&(n.didMatch=!0),o}function Ns(e,t){if(e.length===0)return!1;if(e.includes("|")){const d=e.split("|");for(const f of d)if(Ns(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const c=e.split("+"),l=c.pop();if(!ou(l,t))return!1;if(c[0]==="any")return!0;for(const d of c)switch(d){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":si.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function ru(e,t,n,o,r,i,c){const l=It.useCallback((u,m,g,w)=>{var x;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!c&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(g||w==="drag")||n==="additive",p=(o==="mixed"||o==="additive")&&h,v=g||(r==="mixed"||r==="additive")&&h;let S={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((x=e.current)==null?void 0:x.rangeStack)??[]:[]},columns:p?e.columns:lt.empty(),rows:v?e.rows:lt.empty()};g&&(i==="multi-rect"||i==="multi-cell")&&S.current!==void 0&&e.current!==void 0&&(S={...S,current:{...S.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(S,m)},[o,e,n,i,c,r,t]),d=It.useCallback((u,m,g)=>{u=u??e.rows,m!==void 0&&(u=u.add(m));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:lt.empty(),rows:u};else{const h=g&&n==="mixed"||n==="additive",p=g&&o==="mixed"||o==="additive";w={current:h?e.current:void 0,columns:p?e.columns:lt.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=It.useCallback((u,m,g)=>{u=u??e.columns,m!==void 0&&(u=u.add(m));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:lt.empty(),columns:u};else{const h=g&&n==="mixed"||n==="additive",p=g&&r==="mixed"||r==="additive";w={current:h?e.current:void 0,rows:p?e.rows:lt.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,d,f]}function iu(e,t,n,o,r){const i=a.useCallback(f=>{if(e===!0){const u=[];for(let m=f.y;m<f.y+f.height;m++){const g=[];for(let w=f.x;w<f.x+f.width;w++)w<0||m>=r?g.push({kind:j.Loading,allowOverlay:!1}):g.push(t([w,m]));u.push(g)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),c=e!==void 0?i:void 0,l=a.useCallback(f=>{if(c===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const m=c(u,o.signal);return typeof m=="function"?async()=>(await m()).map(g=>[{kind:j.Loading,allowOverlay:!1},...g]):m.map(g=>[{kind:j.Loading,allowOverlay:!1},...g])}return c(u,o.signal)},[o.signal,c,n]);return[e!==void 0?l:void 0,c]}function lu(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case j.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Zi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case j.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case j.Image:case j.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case j.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case j.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case j.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case j.Markdown:case j.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case j.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case j.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case j.Protected:return{formatted:"************",rawValue:"",format:"string"};default:xr()}}function su(e,t){return e.map((o,r)=>{const i=t[r];return o.map(c=>c.span!==void 0&&c.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:lu(c))})}function jl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function au(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(c=>jl(c,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:jl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Wi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Zl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function cu(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function du(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Wi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((c,l)=>`<li gdg-raw-value=${Zl(r.rawValue[l])}>`+Wi(c)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Zl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Wi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function uu(e,t){const n=su(e,t),o=au(n),r=du(n);return{textPlain:o,textHtml:r}}function Jl(e){var c;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const d=l.cloneNode(!0),u=d.children.length===1&&d.children[0].nodeName==="P"?d.children[0]:null,m=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",g=d.querySelectorAll("br");for(const p of g)p.replaceWith(`
`);const w=d.getAttribute("gdg-raw-value"),h=d.getAttribute("gdg-format")??"string";if(d.querySelector("a")!==null)i==null||i.push({rawValue:((c=d.querySelector("a"))==null?void 0:c.getAttribute("href"))??"",formatted:d.textContent??"",format:h});else if(d.querySelector("ol")!==null){const p=d.querySelectorAll("li");i==null||i.push({rawValue:[...p].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...p].map(v=>v.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:cu(w),formatted:d.textContent??"",format:h});else{let p=d.textContent??"";m&&(p=p.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:p??"",formatted:p??"",format:h})}}}return i!==void 0&&r.push(i),r}function fu(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let c=!1;do{if((e==null?void 0:e.current)===void 0)break;const d=(l=e.current)==null?void 0:l.range,f=[];if(d.width>2){const g=t({x:d.x,y:d.y,width:1,height:d.height},r.signal);if(typeof g=="function")return i;f.push(...g);const w=t({x:d.x+d.width-1,y:d.y,width:1,height:d.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const g=t({x:d.x,y:d.y,width:d.width,height:d.height},r.signal);if(typeof g=="function")return i;f.push(...g)}let u=d.x-n,m=d.x+d.width-1-n;for(const g of f)for(const w of g)w.span!==void 0&&(u=Math.min(w.span[0],u),m=Math.max(w.span[1],m));u===d.x-n&&m===d.x+d.width-1-n?c=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:d.y,width:m-u+1,height:d.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!c);return e}function Ql(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function hu(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let c=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,c)),r=c+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Ql(e.slice(r,c))),r=c+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}c++}return r<e.length&&o.push(Ql(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(d=>({rawValue:d,formatted:d,format:"string"})))}function es(e,t,n){var l;const o=uu(e,t),r=d=>{var f;(f=window.navigator.clipboard)==null||f.writeText(d)},i=(d,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([d],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},c=(d,f)=>{var u,m;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",d),(m=n==null?void 0:n.clipboardData)==null||m.setData("text/html",f)}catch{i(d,f)||r(d)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?c(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function qi(e){return e!==!0}function ts(e){return typeof e=="string"?e:`${e}px`}const gu=()=>e=>e.innerWidth,mu=()=>e=>e.innerHeight,wu=tn("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[gu()],"wmyidgi-1":[mu()]}}),pu=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return a.createElement(wu,{innerHeight:ts(n),innerWidth:ts(t),...r},o)},bu=2,yu=1300;function Cu(e,t,n){const o=It.useRef(0),[r,i]=e??[0,0];It.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let c=!1,l=0;const d=f=>{var u;if(!c){if(l===0)l=f;else{const m=f-l;o.current=Math.min(1,o.current+m/yu);const g=o.current**1.618*m*bu;(u=t.current)==null||u.scrollBy(r*g,i*g),l=f,n==null||n()}window.requestAnimationFrame(d)}};return window.requestAnimationFrame(d),()=>{c=!0}},[t,r,i,n])}function ku({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:c,remSize:l}){const[d,f,u,m,g,w]=It.useMemo(()=>{if(!c||l===16)return[e,t,n,o,r,i];const h=l/16,p=e,v=ys();return[typeof p=="number"?p*h:S=>Math.ceil(p(S)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??v.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??v.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??v.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,c,o]);return{rowHeight:d,headerHeight:f,groupHeaderHeight:u,theme:m,overscrollX:g,overscrollY:w}}const oo={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function je(e,t){return e===!0?t:e===!1?"":e}function ns(e){const t=si.value;return{activateCell:je(e.activateCell," |Enter|shift+Enter"),clear:je(e.clear,"any+Escape"),closeOverlay:je(e.closeOverlay,"any+Escape"),acceptOverlayDown:je(e.acceptOverlayDown,"Enter"),acceptOverlayUp:je(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:je(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:je(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:je(e.delete,t?"Backspace|Delete":"Delete"),downFill:je(e.downFill,"primary+_68"),scrollToSelectedCell:je(e.scrollToSelectedCell,"primary+Enter"),goDownCell:je(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:je(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:je(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:je(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:je(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:je(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:je(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:je(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:je(e.goToFirstCell,"primary+Home"),goToFirstColumn:je(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:je(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:je(e.goToLastCell,"primary+End"),goToLastColumn:je(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:je(e.goToLastRow,"primary+ArrowDown"),goToNextPage:je(e.goToNextPage,"PageDown"),goToPreviousPage:je(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:je(e.rightFill,"primary+_82"),search:je(e.search,"primary+f"),selectAll:je(e.selectAll,"primary+a"),selectColumn:je(e.selectColumn,"ctrl+ "),selectGrowDown:je(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:je(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:je(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:je(e.selectGrowUp,"shift+ArrowUp"),selectRow:je(e.selectRow,"shift+ "),selectToFirstCell:je(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:je(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:je(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:je(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:je(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:je(e.selectToLastRow,"primary+shift+ArrowDown")}}function vu(e){const t=Ua(e);return It.useMemo(()=>{if(t===void 0)return ns(oo);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??oo.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??oo.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??oo.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??oo.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??oo.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??oo.selectToLastCell};return ns({...oo,...n})},[t])}function xu(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const c={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(c.subGroups=o.subGroups.map((l,d)=>t(l,r+1,[...i,d])).sort((l,d)=>l.headerIndex-d.headerIndex)),c}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function al(e,t){const n=[];function o(l,d,f=!1){let u=d!==null?d-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let m=0;m<l.subGroups.length;m++){const g=m<l.subGroups.length-1?l.subGroups[m+1].headerIndex:d;o(l.subGroups[m],g,f||l.isCollapsed)}}const r=xu(e.groups);for(let l=0;l<r.length;l++){const d=l<r.length-1?r[l+1].headerIndex:null;o(r[l],d)}let i=0,c=0;for(const l of n)l.contentIndex=c,c+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:d,...f}=l;return f})}function ji(e,t){if(t===void 0||al.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Su(e,t,n,o){const r=It.useMemo(()=>e===void 0?void 0:al(e,t),[e,t]),i=It.useMemo(()=>r==null?void 0:r.reduce((u,m)=>(u[m.rowIndex]=m,u),{}),[r]),c=It.useMemo(()=>r===void 0?t:r.reduce((u,m)=>u+(m.isCollapsed?1:m.rows+1),0),[r,t]),l=It.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),d=It.useCallback(u=>{if(r===void 0)return u;let m=u;for(const g of r){if(m===0)return;if(m--,!g.isCollapsed){if(m<g.rows)return g.contentIndex+m;m-=g.rows}}return u},[r]),f=lo(o??(e==null?void 0:e.themeOverride),It.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:m,contentIndex:g,groupIndex:w}=ji(u,r);return m?e.themeOverride:o==null?void 0:o(u,w,g)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:d,getRowThemeOverride:f}:{rowHeight:l,rows:c,rowNumberMapper:d,getRowThemeOverride:f}}function Mu(e,t){const n=It.useMemo(()=>e===void 0?void 0:al(e,t),[e,t]);return{getRowGroupingForPath:Xs,updateRowGroupingByPath:$s,mapper:It.useCallback(o=>{if(typeof o=="number")return ji(o,n);const r=ji(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function $s(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,c)=>c===o?{...i,...n}:i):e.map((i,c)=>c===o?{...i,subGroups:$s(i.subGroups??[],r,n)}:i)}function Xs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:Xs(e[n].subGroups??[],o)}function Ru(e,t){const[n]=a.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Eu(e,t,n,o,r){const[i,c]=a.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=a.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:c}),[o,c,i]),[d,f,u]=Va(l),m=a.useRef(r);m.current=r;const g=Ru(null,p=>{p!==null&&t!==void 0?p.scrollTop=t:p!==null&&e!==void 0&&(p.scrollLeft=e)}),w=(d.height??1)>1;a.useLayoutEffect(()=>{if(t!==void 0&&g.current!==null&&w){if(g.current.scrollTop===t)return;g.current.scrollTop=t,g.current.scrollTop!==t&&u(),m.current()}},[t,w,u,g]);const h=(d.width??1)>1;return a.useLayoutEffect(()=>{if(e!==void 0&&g.current!==null&&h){if(g.current.scrollLeft===e)return;g.current.scrollLeft=e,g.current.scrollLeft!==e&&u(),m.current()}},[e,h,u,g]),{visibleRegion:d,setVisibleRegion:f,scrollRef:g}}const Iu=tn("textarea")({name:"GhostInputBox",class:"gdg-g1wsindo",propsAsIs:!1}),Hu=(e,t)=>{const{onInput:n,onCompositionStart:o,onCompositionEnd:r,onKeyDown:i,onKeyUp:c,onFocus:l,onBlur:d,disabled:f=!1}=e,u=a.useRef(null),m=a.useRef(!1),g=a.useRef({width:0,height:0}),w=a.useCallback(()=>{const x=u.current;if(!x||x.style.opacity==="0")return;const E=g.current.width,$=g.current.height;x.style.width=`${E}px`,x.style.height=`${$}px`;const A=Math.max(E,x.scrollWidth+2),D=Math.max($,x.scrollHeight+2);x.style.width=`${A}px`,x.style.height=`${D}px`},[]);a.useImperativeHandle(t,()=>({focus:()=>{var x;(x=u.current)==null||x.focus({preventScroll:!0})},blur:()=>{var x;(x=u.current)==null||x.blur()},clear:()=>{u.current&&(u.current.value="",u.current.setSelectionRange(0,0))},getValue:()=>{var x;return((x=u.current)==null?void 0:x.value)??""},setValue:x=>{if(u.current){u.current.value=x;const E=x.length;u.current.setSelectionRange(E,E)}},setPosition:(x,E,$,A)=>{const D=u.current;D&&(g.current={width:$,height:A},D.style.left=`${x}px`,D.style.top=`${E}px`,D.style.width=`${$}px`,D.style.height=`${A}px`)},setVisible:x=>{const E=u.current;E&&(x?(E.style.opacity="1",E.style.pointerEvents="auto",E.style.zIndex="10000"):(E.style.left="-9999px",E.style.top="0",E.style.width="1px",E.style.height="1px",E.style.opacity="0",E.style.pointerEvents="none",E.style.zIndex="0"))}}));const h=a.useCallback(x=>{const E=x.currentTarget;n(E.value,m.current),w()},[n,w]),p=a.useCallback(()=>{m.current=!0,o()},[o]),v=a.useCallback(x=>{m.current=!1,r(x.currentTarget.value)},[r]),S=a.useCallback(x=>{i(x)},[i]),b=a.useCallback(x=>{c==null||c(x)},[c]);return a.createElement(Iu,{ref:u,defaultValue:"",tabIndex:f?-1:0,disabled:f,onInput:h,onCompositionStart:p,onCompositionEnd:v,onKeyDown:S,onKeyUp:b,onFocus:l,onBlur:d,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},Du=a.memo(a.forwardRef(Hu)),Fu=a.lazy(async()=>await ls(()=>Promise.resolve().then(()=>fc),void 0,import.meta.url));let Tu=0;function Au(e){return Ba(Tl(Tl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return Mo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Qr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const ro={kind:j.Loading,allowOverlay:!1},Oi={columns:lt.empty(),rows:lt.empty(),current:void 0},Pu=(e,t)=>{var Hl,Dl,Fl;const[n,o]=a.useState(Oi),[r,i]=a.useState(),c=a.useRef(null),l=a.useRef(null),[d,f]=a.useState(),u=a.useRef(void 0),m=a.useRef(null),[g,w]=a.useState(!1),h=a.useRef(g);h.current=g;const p=a.useRef(r);p.current=r;const v=typeof window>"u"?null:window,{imageEditorOverride:S,getRowThemeOverride:b,markdownDivCreateNode:x,width:E,height:$,columns:A,rows:D,getCellContent:F,onCellClicked:M,onCellActivated:W,onFillPattern:N,onFinishedEditing:P,coercePasteValue:O,drawHeader:B,drawCell:J,editorBloom:Q,onHeaderClicked:pe,onColumnProposeMove:be,rangeSelectionColumnSpanning:ye=!0,spanRangeBehavior:Z="default",onGroupHeaderClicked:U,onCellContextMenu:ae,className:Ce,onHeaderContextMenu:we,getCellsForSelection:ce,onGroupHeaderContextMenu:ue,onGroupHeaderRenamed:re,onCellEdited:q,onCellsEdited:Me,onSearchResultsChanged:de,searchResults:Oe,onSearchValueChange:Ge,searchValue:oe,onKeyDown:Re,onKeyUp:Qe,keybindings:ft,editOnType:Ne=!0,onRowAppended:Ht,onColumnAppended:Ee,onColumnMoved:De,validateCell:he,highlightRegions:Te,rangeSelect:Be="rect",columnSelect:Ye="multi",rowSelect:Xe="multi",rangeSelectionBlending:Ke="exclusive",columnSelectionBlending:tt="exclusive",rowSelectionBlending:st="exclusive",onDelete:Kt,onDragStart:K,onMouseMove:wt,onPaste:nt,copyHeaders:me=!1,freezeColumns:ot=0,cellActivationBehavior:ht="second-click",rowSelectionMode:Je="auto",columnSelectionMode:Ze="auto",onHeaderMenuClick:xt,onHeaderIndicatorClick:Xt,getGroupDetails:$t,rowGrouping:Ot,onSearchClose:Tt,onItemHovered:jt,onSelectionCleared:Dt,showSearch:Wn,onVisibleRegionChanged:wn,gridSelection:rt,onGridSelectionChange:xn,minColumnWidth:gt=50,maxColumnWidth:Zt=500,maxColumnAutoWidth:an,provideEditor:cn,trailingRowOptions:_e,freezeTrailingRows:Gt=0,allowedFillDirections:Ae="orthogonal",scrollOffsetX:at,scrollOffsetY:ct,verticalBorder:Wt,onDragOverCell:Jt,onDrop:$e,onColumnResize:On,onColumnResizeEnd:St,onColumnResizeStart:Mt,customRenderers:pn,fillHandle:Mr,experimental:Ct,fixedShadowX:Nn,fixedShadowY:$n,headerIcons:Do,imageWindowLoader:Rr,initialSize:Er,isDraggable:Fo,onDragLeave:To,onRowMoved:Tn,overscrollX:Ao,overscrollY:fo,preventDiagonalScrolling:_n,rightElement:ui,rightElementProps:Ir,trapFocus:Hr=!1,smoothScrollX:fi,smoothScrollY:Xn,scaleToRem:Vn=!1,rowHeight:hi=34,headerHeight:Dr=36,groupHeaderHeight:Fr=Dr,theme:Tr,isOutsideClick:Po,renderers:Ar,resizeIndicator:Pr,scrollToActiveCell:zo=!0,drawFocusRing:tr=!0,portalElementRef:Un,onRowStatus:Gn,onRowId:Sn}=e,Lo=tr==="no-editor"?r===void 0:tr,Fe=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,nr=(Fe==null?void 0:Fe.rowNumber)??!1;let Bo=(Fe==null?void 0:Fe.kind)??e.rowMarkers??"none",dn=nr;(Bo==="both"||Bo==="checkbox-and-number")&&(Bo="checkbox",dn=!0);const un=Bo,gi=(Fe==null?void 0:Fe.width)??e.rowMarkerWidth,or=(Fe==null?void 0:Fe.startIndex)??e.rowMarkerStartIndex??1,Wo=(Fe==null?void 0:Fe.theme)??e.rowMarkerTheme,Oo=Fe==null?void 0:Fe.headerTheme,rr=Fe==null?void 0:Fe.headerAlwaysVisible,ho=Xe!=="multi"||(Fe==null?void 0:Fe.headerDisabled)===!0,qn=(Fe==null?void 0:Fe.checkboxStyle)??"square",mi=(Fe==null?void 0:Fe.rowStatus)??!1,ir=(Fe==null?void 0:Fe.rowStatusWidth)??40,No=Fe==null?void 0:Fe.rowStatusTheme,wi=(Fe==null?void 0:Fe.rowId)??!1,go=(Fe==null?void 0:Fe.rowIdWidth)??80,$o=Fe==null?void 0:Fe.rowIdTheme,jn=Math.max(gt,20),Xo=Math.max(Zt,jn),pi=Math.max(an??Xo,jn),lr=a.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Ie,rowNumberMapper:mo,rowHeight:sr,getRowThemeOverride:Mn}=Su(Ot,D,hi,b),Go=a.useMemo(()=>Number.parseFloat(lr.fontSize),[lr]),{rowHeight:An,headerHeight:wo,groupHeaderHeight:ar,theme:zr,overscrollX:L,overscrollY:_}=ku({groupHeaderHeight:Fr,headerHeight:Dr,overscrollX:Ao,overscrollY:fo,remSize:Go,rowHeight:sr,scaleToRem:Vn,theme:Tr}),se=vu(ft),fe=gi??(D>1e4?48:D>1e3?44:D>100?36:32),ee=un!=="none",le=mi===!0,Pe=wi===!0,R=(ee?dn?2:1:0)+(le?1:0)+(Pe?1:0),ke=(ee?(dn?2:1)*fe:0)+(le?ir:0)+(Pe?go:0),Ve=_e!==void 0,ve=(_e==null?void 0:_e.sticky)===!0,[dt,pt]=a.useState(!1),bt=Wn??dt,yt=a.useCallback(()=>{Tt!==void 0?Tt():pt(!1)},[Tt]),z=a.useMemo(()=>rt===void 0?void 0:Qr(rt,R),[rt,R])??n,Ft=a.useRef(new AbortController);a.useEffect(()=>()=>Ft==null?void 0:Ft.current.abort(),[]);const[kt,bn]=iu(ce,F,R,Ft.current,Ie),Pn=a.useCallback((s,y,C)=>{if(he===void 0)return!0;const k=[s[0]-R,s[1]];return he==null?void 0:he(k,y,C)},[R,he]),it=a.useRef(rt),Pt=a.useCallback((s,y)=>{y&&(s=fu(s,kt,R,Z,Ft.current)),xn!==void 0?(it.current=Qr(s,-R),xn(it.current)):o(s)},[xn,kt,R,Z]),_t=lo(On,a.useCallback((s,y,C,k)=>{On==null||On(A[C-R],y,C-R,k)},[On,R,A])),Zn=lo(St,a.useCallback((s,y,C,k)=>{St==null||St(A[C-R],y,C-R,k)},[St,R,A])),fn=lo(Mt,a.useCallback((s,y,C,k)=>{Mt==null||Mt(A[C-R],y,C-R,k)},[Mt,R,A])),po=lo(B,a.useCallback((s,y)=>(B==null?void 0:B({...s,columnIndex:s.columnIndex-R},y))??!1,[B,R])),Jn=lo(J,a.useCallback((s,y)=>(J==null?void 0:J({...s,col:s.col-R},y))??!1,[J,R])),Rn=a.useCallback(s=>{if(Kt!==void 0){const y=Kt(Qr(s,-R));return typeof y=="boolean"?y:Qr(y,R)}return!0},[Kt,R]),[Rt,Yt,zt]=ru(z,Pt,Ke,tt,st,Be,ye),Vt=a.useMemo(()=>Ln(ys(),zr),[zr]),[bi,Ks]=a.useState([0,0,0]),cl=a.useMemo(()=>{if(Ar===void 0)return{};const s={};for(const y of Ar)s[y.kind]=y;return s},[Ar]),Qt=a.useCallback(s=>s.kind!==j.Custom?cl[s.kind]:pn==null?void 0:pn.find(y=>y.isMatch(s)),[pn,cl]);let{sizedColumns:yn,nonGrowWidth:dl}=Hc(A,Ie,bn,bi[0]-ke-bi[2],jn,pi,Vt,Qt,Ft.current);dl+=ke;const cr=a.useMemo(()=>{let s=0;for(const y of yn)y.group!==void 0&&(typeof y.group=="string"?s=Math.max(s,1):s=Math.max(s,y.group.length));return s},[yn]),ul=cr>0,fl=a.useMemo(()=>cr===0?[]:Array(cr).fill(ar),[cr,ar]),_s=fl.reduce((s,y)=>s+y,0),dr=wo+_s,hl=z.rows.length,gl=un==="none"?void 0:hl===0?!1:hl===Ie?!0:void 0,et=a.useMemo(()=>{const s=[];return un!=="none"&&(dn&&s.push({title:"",width:fe,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Wo,rowMarker:qn,rowMarkerChecked:!1,headerRowMarkerTheme:Oo,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),s.push({title:"",width:fe,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Wo,rowMarker:qn,rowMarkerChecked:gl,headerRowMarkerTheme:Oo,headerRowMarkerAlwaysVisible:rr,headerRowMarkerDisabled:ho})),le&&s.push({title:"",width:ir,icon:void 0,hasMenu:!1,style:"normal",themeOverride:No}),Pe&&s.push({title:"ID",width:go,icon:void 0,hasMenu:!1,style:"normal",themeOverride:$o}),[...s,...yn]},[le,ir,No,Pe,go,$o,un,yn,fe,Wo,qn,gl,Oo,rr,ho,dn]),nn=a.useRef({height:1,width:1,x:0,y:0}),Lr=a.useRef(!1),{setVisibleRegion:ml,visibleRegion:bo,scrollRef:ut}=Eu(at,ct,An,nn,()=>Lr.current=!0);nn.current=bo;const Vs=bo.x+R,Br=bo.y,Lt=a.useRef(null),Ut=a.useCallback(s=>{var y;s===!0?(y=m.current)==null||y.focus():window.requestAnimationFrame(()=>{var C;(C=m.current)==null||C.focus()})},[]),qt=Ve?Ie+1:Ie,on=a.useCallback(s=>{const y=R===0?s:s.map(k=>({...k,location:[k.location[0]-R,k.location[1]]})),C=Me==null?void 0:Me(y);if(C!==!0)for(const k of y)q==null||q(k.location,k.value);return C},[q,Me,R]),[yo,yi]=a.useState(),Wr=z.current!==void 0&&z.current.range.width*z.current.range.height>1?z.current.range:void 0,Yo=Lo?(Hl=z.current)==null?void 0:Hl.cell:void 0,Or=Yo==null?void 0:Yo[0],Nr=Yo==null?void 0:Yo[1],Us=a.useMemo(()=>{if((Te===void 0||Te.length===0)&&(Wr??Or??Nr??yo)===void 0)return;const s=[];if(Te!==void 0)for(const y of Te){const C=et.length-y.range.x-R;C>0&&s.push({color:y.color,range:{...y.range,x:y.range.x+R,width:Math.min(C,y.range.width)},style:y.style})}return yo!==void 0&&s.push({color:co(Vt.accentColor,0),range:yo,style:"dashed"}),Wr!==void 0&&s.push({color:co(Vt.accentColor,.5),range:Wr,style:"solid-outline"}),Or!==void 0&&Nr!==void 0&&s.push({color:Vt.accentColor,range:{x:Or,y:Nr,width:1,height:1},style:"solid-outline"}),s.length>0?s:void 0},[yo,Wr,Or,Nr,Te,et.length,Vt.accentColor,R]),wl=a.useRef(et);wl.current=et;const Bt=a.useCallback(([s,y],C=!1)=>{var Y,V,ne,te,ze,ie,We,He,ge;const k=Ve&&y===qt-1;let I=0,X=-1,H=-1,T=-1,G=-1;if(ee&&dn&&(X=I++),ee&&(H=I++),le&&(T=I++),Pe&&(G=I++),s===X){if(k)return ro;const xe=mo(y);return xe===void 0?ro:{kind:Nt.Marker,allowOverlay:!1,checkboxStyle:qn,checked:!1,markerKind:"number",row:or+xe,drawHandle:!1,cursor:void 0,disabled:((Y=e.disabledRows)==null?void 0:Y.call(e,y))===!0}}if(s===H){if(k)return ro;const xe=mo(y);if(xe===void 0)return ro;let Le;return dn?Le=un==="checkbox-visible"?"checkbox-visible":"checkbox":un==="clickable-number"?Le="number":Le=un,{kind:Nt.Marker,allowOverlay:!1,checkboxStyle:qn,checked:(z==null?void 0:z.rows.hasIndex(y))===!0,markerKind:Le,row:or+xe,drawHandle:Tn!==void 0,cursor:dn?void 0:un==="clickable-number"?"pointer":void 0,disabled:((V=e.disabledRows)==null?void 0:V.call(e,y))===!0}}if(s===T){if(k)return ro;const xe=Gn==null?void 0:Gn(y);return{kind:Nt.RowStatus,allowOverlay:!1,status:xe,themeOverride:No}}if(s===G){if(k)return ro;const xe=Sn==null?void 0:Sn(y);return{kind:Nt.RowId,allowOverlay:!1,rowId:xe,themeOverride:$o}}if(k){const Le=s===R?(_e==null?void 0:_e.hint)??"":"",Se=wl.current[s];if(((ne=Se==null?void 0:Se.trailingRowOptions)==null?void 0:ne.disabled)===!0)return ro;{const mt=((te=Se==null?void 0:Se.trailingRowOptions)==null?void 0:te.hint)??Le,rn=((ze=Se==null?void 0:Se.trailingRowOptions)==null?void 0:ze.addIcon)??(_e==null?void 0:_e.addIcon);return{kind:Nt.NewRow,hint:mt,allowOverlay:!1,icon:rn}}}else{const xe=s-R;if(C||(Ct==null?void 0:Ct.strict)===!0){const Se=nn.current,mt=Se.x>xe||xe>Se.x+Se.width||Se.y>y||y>Se.y+Se.height||y>=xi.current,rn=xe===((We=(ie=Se.extras)==null?void 0:ie.selected)==null?void 0:We[0])&&y===((He=Se.extras)==null?void 0:He.selected[1]);let ln=!1;if(((ge=Se.extras)==null?void 0:ge.freezeRegions)!==void 0){for(const kn of Se.extras.freezeRegions)if(ao(kn,xe,y)){ln=!0;break}}if(mt&&!rn&&!ln)return ro}let Le=F([xe,y]);return R!==0&&Le.span!==void 0&&(Le={...Le,span:[Le.span[0]+R,Le.span[1]+R]}),Le}},[Ve,qt,le,Gn,No,Pe,Sn,$o,ee,mo,qn,z==null?void 0:z.rows,un,or,Tn,R,_e==null?void 0:_e.hint,_e==null?void 0:_e.addIcon,Ct==null?void 0:Ct.strict,F,dn]),Ci=a.useCallback(s=>{let y=($t==null?void 0:$t(s))??{name:s};return re!==void 0&&s!==""&&(y={icon:y.icon,name:y.name,overrideTheme:y.overrideTheme,actions:[...y.actions??[],{title:"Rename",icon:"renameIcon",onClick:C=>Mi({group:y.name,bounds:C.bounds})}]}),y},[$t,re]),$r=a.useCallback(s=>{var T;const[y,C]=s.cell,k=et[y],I=(k==null?void 0:k.group)!==void 0?(T=Ci(k.group))==null?void 0:T.overrideTheme:void 0,X=k==null?void 0:k.themeOverride,H=Mn==null?void 0:Mn(C);i({...s,theme:Ln(Vt,I,X,H,s.content.themeOverride)})},[Mn,et,Ci,Vt]),En=a.useCallback((s,y,C)=>{var H,T,G,Y,V,ne,te;if(z.current===void 0)return;const[k,I]=z.current.cell,X=Bt([k,I]);if(X.kind!==j.Boolean&&X.allowOverlay){let ze=X;if(C!==void 0)switch(ze.kind){case j.Number:{const He=Oa(()=>C==="-"?-0:Number.parseFloat(C),0);ze={...ze,data:Number.isNaN(He)?0:He};break}case j.Text:case j.Markdown:case j.Uri:ze={...ze,data:C};break}$r({target:s,content:ze,initialValue:C,cell:[k,I],highlight:C===void 0,forceEditMode:C!==void 0,activation:y});const ie=ze.kind===j.Custom;C!==void 0&&!ie?((H=m.current)==null||H.setPosition(s.x,s.y,s.width,s.height),C.length>0&&((T=m.current)==null||T.setValue(C)),(G=m.current)==null||G.setVisible(!0),w(!0)):ie&&C!==void 0&&((Y=m.current)==null||Y.clear(),(V=m.current)==null||V.setVisible(!1),(ne=m.current)==null||ne.blur(),w(!1))}else X.kind===j.Boolean&&y.inputType==="keyboard"&&X.readonly!==!0&&(on([{location:z.current.cell,value:{...X,data:qi(X.data)}}]),(te=Lt.current)==null||te.damage([{cell:z.current.cell}]))},[Bt,z,on,$r]),pl=a.useCallback((s,y)=>{var I;const C=(I=Lt.current)==null?void 0:I.getBounds(s,y);if(C===void 0||ut.current===null)return;const k=Bt([s,y]);k.allowOverlay&&$r({target:C,content:k,initialValue:void 0,highlight:!0,cell:[s,y],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Bt,ut,$r]),Et=a.useCallback((s,y,C="both",k=0,I=0,X=void 0)=>{if(ut.current!==null){const H=Lt.current,T=l.current,G=typeof s!="number"?s.unit==="cell"?s.amount:void 0:s,Y=typeof y!="number"?y.unit==="cell"?y.amount:void 0:y,V=typeof s!="number"&&s.unit==="px"?s.amount:void 0,ne=typeof y!="number"&&y.unit==="px"?y.amount:void 0;if(H!==null&&T!==null){let te={x:0,y:0,width:0,height:0},ze=0,ie=0;if((G!==void 0||Y!==void 0)&&(te=H.getBounds((G??0)+R,Y??0)??te,te.width===0||te.height===0))return;const We=T.getBoundingClientRect(),He=We.width/T.offsetWidth;if(V!==void 0&&(te={...te,x:V-We.left-ut.current.scrollLeft,width:1}),ne!==void 0&&(te={...te,y:ne+We.top-ut.current.scrollTop,height:1}),te!==void 0){const ge={x:te.x-k,y:te.y-I,width:te.width+2*k,height:te.height+2*I};let xe=0;for(let Ai=0;Ai<ot;Ai++)xe+=yn[Ai].width;let Le=0;const Se=Gt+(ve?1:0);Se>0&&(Le=Io(qt,Se,An));let mt=xe*He+We.left+ke*He,rn=We.right,ln=We.top+dr*He,kn=We.bottom-Le*He;const Ur=te.width+k*2;switch(X==null?void 0:X.hAlign){case"start":rn=mt+Ur;break;case"end":mt=rn-Ur;break;case"center":mt=Math.floor((mt+rn)/2)-Ur/2,rn=mt+Ur;break}const qr=te.height+I*2;switch(X==null?void 0:X.vAlign){case"start":kn=ln+qr;break;case"end":ln=kn-qr;break;case"center":ln=Math.floor((ln+kn)/2)-qr/2,kn=ln+qr;break}mt>ge.x?ze=ge.x-mt:rn<ge.x+ge.width&&(ze=ge.x+ge.width-rn),ln>ge.y?ie=ge.y-ln:kn<ge.y+ge.height&&(ie=ge.y+ge.height-kn),C==="vertical"||typeof s=="number"&&s<ot?ze=0:(C==="horizontal"||typeof y=="number"&&y>=qt-Se)&&(ie=0),(ze!==0||ie!==0)&&(He!==1&&(ze/=He,ie/=He),ut.current.scrollTo({left:ze+ut.current.scrollLeft,top:ie+ut.current.scrollTop,behavior:(X==null?void 0:X.behavior)??"auto"}))}}}},[R,Gt,fe,ut,dr,ot,yn,qt,ve,An]),ki=a.useRef(pl),vi=a.useRef(F);ki.current=pl,vi.current=F;const xi=a.useRef(Ie);xi.current=Ie;const bl=a.useRef(et.length);bl.current=et.length;const Qn=a.useCallback(async(s,y=!0,C)=>{var Y;const k=et[s];if(((Y=k==null?void 0:k.trailingRowOptions)==null?void 0:Y.disabled)===!0)return;const I=Ht==null?void 0:Ht();let X,H=!0;I!==void 0&&(X=await I,X==="top"&&(H=!1),typeof X=="number"&&(H=!1));let T=0;const G=()=>{if(xi.current<=Ie){T<500&&window.setTimeout(G,T),T=50+T*2;return}const V=typeof X=="number"?X:H?Ie:0;Vr.current(s-R,V,"both",0,20,C?{behavior:C}:void 0),Rt({cell:[s,V],range:{x:s,y:V,width:1,height:1}},!1,!1,"edit");const ne=vi.current([s-R,V]);ne.allowOverlay&&io(ne)&&ne.readonly!==!0&&y&&window.setTimeout(()=>{ki.current(s,V)},0)};G()},[et,Ht,R,Ie,Rt]),Xr=a.useCallback(async(s,y=!0)=>{const C=Ee==null?void 0:Ee();let k,I=!0;C!==void 0&&(k=await C,k==="left"&&(I=!1),typeof k=="number"&&(I=!1));let X=0;const H=()=>{if(bl.current<=et.length){X<500&&window.setTimeout(H,X),X=50+X*2;return}const T=typeof k=="number"?k:I?et.length:0;Et(T-R,s),Rt({cell:[T,s],range:{x:T,y:s,width:1,height:1}},!1,!1,"edit");const G=vi.current([T-R,s]);G.allowOverlay&&io(G)&&G.readonly!==!0&&y&&window.setTimeout(()=>{ki.current(T,s)},0)};H()},[et,Ee,R,Et,Rt]),Ko=a.useCallback(s=>{var C,k;const y=((k=(C=yn[s])==null?void 0:C.trailingRowOptions)==null?void 0:k.targetColumn)??(_e==null?void 0:_e.targetColumn);if(typeof y=="number")return y+(ee?1:0);if(typeof y=="object"){const I=A.indexOf(y);if(I>=0)return I+(ee?1:0)}},[yn,A,ee,_e==null?void 0:_e.targetColumn]),eo=a.useRef(void 0),_o=a.useRef(void 0),ur=a.useCallback((s,y)=>{var I;const[C,k]=y;return Ln(Vt,(I=et[C])==null?void 0:I.themeOverride,Mn==null?void 0:Mn(k),s.themeOverride)},[Mn,et,Vt]),{mapper:Co}=Mu(Ot,D),In=Ot==null?void 0:Ot.navigationBehavior,fr=a.useCallback(s=>{var Y,V,ne;const y=si.value?s.metaKey:s.ctrlKey,C=y&&Xe==="multi",[k,I]=s.location,X=z.columns,H=z.rows,[T,G]=((Y=z.current)==null?void 0:Y.cell)??[];if(s.kind==="cell"){if(_o.current=void 0,ko.current=[k,I],k===(dn?1:0)&&ee){if(Ve===!0&&I===Ie||un==="number"||Xe==="none")return;const ie=Bt(s.location);if(ie.kind!==Nt.Marker||ie.disabled===!0)return;if(Tn!==void 0){const ge=Qt(ie);hn((ge==null?void 0:ge.kind)===Nt.Marker);const xe=(V=ge==null?void 0:ge.onClick)==null?void 0:V.call(ge,{...s,cell:ie,posX:s.localEventX,posY:s.localEventY,bounds:s.bounds,theme:ur(ie,s.location),preventDefault:()=>{}});if(xe===void 0||xe.checked===ie.checked)return}i(void 0),Ut();const We=H.hasIndex(I),He=eo.current;if(Xe==="multi"&&(s.shiftKey||s.isLongTouch===!0)&&He!==void 0&&H.hasIndex(He)){const ge=[Math.min(He,I),Math.max(He,I)+1];C||Je==="multi"?Yt(void 0,ge,!0):Yt(lt.fromSingleSelection(ge),void 0,C)}else Xe==="multi"&&(C||s.isTouch||Je==="multi")?We?Yt(H.remove(I),void 0,!0):(Yt(void 0,I,!0),eo.current=I):We&&H.length===1?Yt(lt.empty(),void 0,y):(Yt(lt.fromSingleSelection(I),void 0,y),eo.current=I)}else if(k>=R&&Ve&&I===Ie){const ie=Ko(k);Qn(ie??k)}else if(T!==k||G!==I){const ie=Bt(s.location),We=Qt(ie);if((We==null?void 0:We.onSelect)!==void 0){let xe=!1;if(We.onSelect({...s,cell:ie,posX:s.localEventX,posY:s.localEventY,bounds:s.bounds,preventDefault:()=>xe=!0,theme:ur(ie,s.location)}),xe)return}if(In==="block"&&Co(I).isGroupHeader)return;const He=ve&&I===Ie,ge=ve&&z!==void 0&&((ne=z.current)==null?void 0:ne.cell[1])===Ie;if((s.shiftKey||s.isLongTouch===!0)&&T!==void 0&&G!==void 0&&z.current!==void 0&&!ge){if(He)return;const xe=Math.min(k,T),Le=Math.max(k,T),Se=Math.min(I,G),mt=Math.max(I,G);Rt({...z.current,range:{x:xe,y:Se,width:Le-xe+1,height:mt-Se+1}},!0,y,"click"),eo.current=void 0,Ut()}else{const xe=z.rows.length>0;Rt({cell:[k,I],range:{x:k,y:I,width:1,height:1}},!0,y||xe,"click"),eo.current=void 0,i(void 0),Ut()}}}else if(s.kind==="header")if(ko.current=[k,I],i(void 0),ee&&k===0)eo.current=void 0,_o.current=void 0,!ho&&Xe==="multi"&&(H.length!==Ie?Yt(lt.fromSingleSelection([0,Ie]),void 0,y):Yt(lt.empty(),void 0,y),Ut());else{const te=_o.current;if(Ye==="multi"&&(s.shiftKey||s.isLongTouch===!0)&&te!==void 0&&X.hasIndex(te)){const ze=[Math.min(te,k),Math.max(te,k)+1];y||s.isTouch||Ze==="multi"?zt(void 0,ze,y):zt(lt.fromSingleSelection(ze),void 0,y)}else Ye==="multi"&&(y||s.isTouch||Ze==="multi")?(X.hasIndex(k)?zt(X.remove(k),void 0,y):zt(void 0,k,y),_o.current=k):Ye!=="none"&&(X.hasIndex(k)?zt(X.remove(k),void 0,y):zt(lt.fromSingleSelection(k),void 0,y),_o.current=k);eo.current=void 0,Ut()}else s.kind===Dn?ko.current=[k,I]:s.kind===ai&&!s.isMaybeScrollbar&&(Pt(Oi,!1),i(void 0),Ut(),Dt==null||Dt(),eo.current=void 0,_o.current=void 0)},[Xe,Ye,z,ee,R,Ve,Ie,un,Bt,Tn,Ut,Je,Ze,Qt,ur,Yt,Ko,Qn,In,Co,ve,Rt,ho,zt,Pt,Dt]),hr=a.useRef(!1),ko=a.useRef(void 0),yl=a.useRef(bo),Cn=a.useRef(void 0),qs=a.useCallback(s=>{if(Vo.current=!1,yl.current=nn.current,s.button!==0&&s.button!==1){Cn.current=void 0;return}const y=performance.now();Cn.current={button:s.button,time:y,location:s.location},(s==null?void 0:s.kind)==="header"&&(hr.current=!0);const C=s.kind==="cell"&&s.isFillHandle;!C&&s.kind!=="cell"&&s.isEdge||(f({previousSelection:z,fillHandle:C}),ko.current=void 0,!s.isTouch&&s.button===0&&!C?fr(s):!s.isTouch&&s.button===1&&(ko.current=s.location))},[z,fr]),[Si,Mi]=a.useState(),Cl=a.useCallback(s=>{if(s.kind!==Dn||Ye!=="multi")return;const y=si.value?s.metaKey:s.ctrlKey,[C,k]=s.location,I=z.columns;if(C<R)return;const X=et[C];let H=C,T=C;const G=k<=-2?-(k+2):0,Y=Array.isArray(X.group)?X.group.length:1,V=(ne,te)=>Y>1?ri(ne,te,G,Y):Cs(ne,te);for(let ne=C-1;ne>=R&&V(X.group,et[ne].group);ne--)H--;for(let ne=C+1;ne<et.length&&V(X.group,et[ne].group);ne++)T++;if(Ut(),y||s.isTouch||Ze==="multi")if(I.hasAll([H,T+1])){let ne=I;for(let te=H;te<=T;te++)ne=ne.remove(te);zt(ne,void 0,y)}else zt(void 0,[H,T+1],y);else zt(lt.fromSingleSelection([H,T+1]),void 0,y)},[Ye,Ut,z.columns,et,R,zt,Ze]),Vo=a.useRef(!1),Gr=a.useCallback(async s=>{if(kt!==void 0&&_t!==void 0){const y=nn.current.y,C=nn.current.height;let k=kt({x:s,y,width:1,height:Math.min(C,Ie-y)},Ft.current.signal);typeof k!="object"&&(k=await k());const I=yn[s-R],H=document.createElement("canvas").getContext("2d",{alpha:!1});if(H!==null){H.font=Vt.baseFontFull;const T=Ds(H,Vt,I,0,k,jn,Xo,!1,Qt);_t==null||_t(I,T.width,s,T.width)}}},[yn,kt,Xo,Vt,jn,_t,R,Ie,Qt]),[js,Ri]=a.useState(),Uo=a.useCallback(async(s,y)=>{var T,G;const C=(T=s.current)==null?void 0:T.range;if(C===void 0||kt===void 0||y.current===void 0)return;const k=y.current.range;if(N!==void 0){let Y=!1;if(N({fillDestination:{...k,x:k.x-R},patternSource:{...C,x:C.x-R},preventDefault:()=>Y=!0}),Y)return}let I=kt(C,Ft.current.signal);typeof I!="object"&&(I=await I());const X=I,H=[];for(let Y=0;Y<k.width;Y++)for(let V=0;V<k.height;V++){const ne=[k.x+Y,k.y+V];if(ks(ne,C))continue;const te=X[V%C.height][Y%C.width];Ro(te)||!io(te)||H.push({location:ne,value:{...te}})}on(H),(G=Lt.current)==null||G.damage(H.map(Y=>({cell:Y.location})))},[kt,on,N,R]),kl=a.useCallback(()=>{if(z.current===void 0||z.current.range.width<=1)return;const s={...z,current:{...z.current,range:{...z.current.range,width:1}}};Uo(s,z)},[Uo,z]),vl=a.useCallback(()=>{if(z.current===void 0||z.current.range.height<=1)return;const s={...z,current:{...z.current,range:{...z.current.range,height:1}}};Uo(s,z)},[Uo,z]),Zs=a.useCallback((s,y)=>{var V,ne;const C=d;if(f(void 0),yi(void 0),Ri(void 0),hr.current=!1,y)return;if((C==null?void 0:C.fillHandle)===!0&&z.current!==void 0&&((V=C.previousSelection)==null?void 0:V.current)!==void 0){if(yo===void 0)return;const te={...z,current:{...z.current,range:Ps(C.previousSelection.current.range,yo)}};Uo(C.previousSelection,te),Pt(te,!0);return}const[k,I]=s.location,[X,H]=ko.current??[],T=()=>{Vo.current=!0},G=te=>{var ie,We,He;const ze=te.isTouch||X===k&&H===I;if(ze&&(M==null||M([k-R,I],{...te,preventDefault:T})),te.button===1)return!Vo.current;if(!Vo.current){const ge=Bt(s.location),xe=Qt(ge);if(xe!==void 0&&xe.onClick!==void 0&&ze){const Se=xe.onClick({...te,cell:ge,posX:te.localEventX,posY:te.localEventY,bounds:te.bounds,theme:ur(ge,s.location),preventDefault:T});Se!==void 0&&!Ro(Se)&&Yn(Se)&&(on([{location:te.location,value:Se}]),(ie=Lt.current)==null||ie.damage([{cell:te.location}]))}if(Vo.current||z.current===void 0)return!1;let Le=!1;switch(ge.activationBehaviorOverride??ht){case"double-click":case"second-click":{if(((He=(We=C==null?void 0:C.previousSelection)==null?void 0:We.current)==null?void 0:He.cell)===void 0)break;const[Se,mt]=z.current.cell,[rn,ln]=C.previousSelection.current.cell;Le=k===Se&&k===rn&&I===mt&&I===ln&&(te.isDoubleClick===!0||ht==="second-click");break}case"single-click":{Le=!0;break}}if(Le){const mt={inputType:"pointer",pointerActivation:te.isDoubleClick===!0?"double-click":ge.activationBehaviorOverride??ht,pointerType:te.isTouch?"touch":"mouse"};return W==null||W([k-R,I],mt),En(te.bounds,mt),!0}}return!1},Y=s.location[0]-R;if(s.isTouch){const te=nn.current,ze=yl.current;if(te.x!==ze.x||te.y!==ze.y)return;if(s.isLongTouch===!0){if(s.kind==="cell"&&kr((ne=z.current)==null?void 0:ne.cell,s.location)){ae==null||ae([Y,s.location[1]],{...s,preventDefault:T});return}else if(s.kind==="header"&&z.columns.hasIndex(k)){we==null||we(Y,{...s,preventDefault:T});return}else if(s.kind===Dn){if(Y<0)return;ue==null||ue(Y,{...s,preventDefault:T});return}}s.kind==="cell"?G(s)||fr(s):s.kind===Dn?U==null||U(Y,{...s,preventDefault:T}):(s.kind===so&&(pe==null||pe(Y,{...s,preventDefault:T})),fr(s));return}if(s.kind==="header"){if(Y<0)return;s.isEdge?s.isDoubleClick===!0&&Gr(k):s.button===0&&k===X&&I===H&&(pe==null||pe(Y,{...s,preventDefault:T}))}if(s.kind===Dn){if(Y<0)return;s.button===0&&k===X&&I===H&&(U==null||U(Y,{...s,preventDefault:T}),Vo.current||Cl(s))}s.kind==="cell"&&(s.button===0||s.button===1)&&G(s),ko.current=void 0},[d,z,R,yo,Uo,Pt,M,Bt,Qt,ht,ur,on,W,En,ae,we,ue,fr,U,pe,Gr,Cl]),Js=a.useCallback(s=>{const y={...s,location:[s.location[0]-R,s.location[1]]};wt==null||wt(y),d!==void 0&&s.buttons===0&&(f(void 0),yi(void 0),Ri(void 0),hr.current=!1),Ri(C=>{var k;return hr.current?[s.scrollEdge[0],0]:s.scrollEdge[0]===(C==null?void 0:C[0])&&s.scrollEdge[1]===C[1]?C:d===void 0||(((k=Cn.current)==null?void 0:k.location[0])??0)<R?void 0:s.scrollEdge})},[d,wt,R]),Qs=a.useCallback((s,y)=>{xt==null||xt(s-R,y)},[xt,R]),ea=a.useCallback((s,y)=>{Xt==null||Xt(s-R,y)},[Xt,R]);a.useEffect(()=>{if(r===void 0)return;const s=k=>{const I=[];let X=k.parentElement;for(;X&&X!==document.documentElement;){const H=window.getComputedStyle(X),T=H.overflow+H.overflowY+H.overflowX;(T.includes("scroll")||T.includes("auto"))&&I.push(X),X=X.parentElement}return I},y=k=>{const I=k.target;ut.current&&!ut.current.contains(I)&&i(void 0)},C=[];if(ut.current){const k=s(ut.current);C.push(...k)}return C.forEach(k=>{k.addEventListener("scroll",y)}),window.addEventListener("scroll",y),document.addEventListener("scroll",y,!0),()=>{C.forEach(k=>{k.removeEventListener("scroll",y)}),window.removeEventListener("scroll",y),document.removeEventListener("scroll",y,!0)}},[r,i,ut]);const zn=(Dl=z==null?void 0:z.current)==null?void 0:Dl.cell,ta=a.useCallback((s,y,C,k,I,X)=>{if(Lr.current=!1,r!==void 0){const V=nn.current;(V.x!==s.x||V.y!==s.y)&&i(void 0)}let H=zn;H!==void 0&&(H=[H[0]-R,H[1]]);const T=ot===0?void 0:{x:0,y:s.y,width:ot,height:s.height},G=[];T!==void 0&&G.push(T),Gt>0&&(G.push({x:s.x-R,y:Ie-Gt,width:s.width,height:Gt}),ot>0&&G.push({x:0,y:Ie-Gt,width:ot,height:Gt}));const Y={x:s.x-R,y:s.y,width:s.width,height:Ve&&s.y+s.height>=Ie?s.height-1:s.height,tx:I,ty:X,extras:{selected:H,freezeRegion:T,freezeRegions:G}};nn.current=Y,ml(Y),Ks([y,C,k]),wn==null||wn(Y,Y.tx,Y.ty,Y.extras)},[zn,r,R,Ve,Ie,ot,Gt,i,ml,wn]),na=lo(be,a.useCallback((s,y)=>(be==null?void 0:be(s-R,y-R))!==!1,[be,R])),oa=lo(De,a.useCallback((s,y)=>{De==null||De(s-R,y-R),Ye!=="none"&&zt(lt.fromSingleSelection(y),void 0,!0)},[Ye,De,R,zt])),Ei=a.useRef(!1),ra=a.useCallback(s=>{if(s.location[0]===0&&R>0){s.preventDefault();return}K==null||K({...s,location:[s.location[0]-R,s.location[1]]}),s.defaultPrevented()||(Ei.current=!0),f(void 0)},[K,R]),ia=a.useCallback(()=>{Ei.current=!1},[]),xl=Ot==null?void 0:Ot.selectionBehavior,Yr=a.useCallback(s=>{if(xl!=="block-spanning")return;const{isGroupHeader:y,path:C,groupRows:k}=Co(s);if(y)return[s,s];const I=C[C.length-1],X=s-I,H=s+k-I-1;return[X,H]},[Co,xl]),Ii=a.useRef(void 0),Hi=a.useCallback(s=>{var y,C,k;if(!Os(s,Ii.current)&&(Ii.current=s,!(((y=Cn==null?void 0:Cn.current)==null?void 0:y.button)!==void 0&&Cn.current.button>=1))){if(s.buttons!==0&&d!==void 0&&((C=Cn.current)==null?void 0:C.location[0])===0&&R===1&&Xe==="multi"&&d.previousSelection&&!d.previousSelection.rows.hasIndex(Cn.current.location[1])&&z.rows.hasIndex(Cn.current.location[1])){const I=Math.min(Cn.current.location[1],s.location[1]),X=Math.max(Cn.current.location[1],s.location[1])+1;Yt(lt.fromSingleSelection([I,X]),void 0,!1)}else if(s.buttons!==0&&d!==void 0&&z.current!==void 0&&!Ei.current&&!hr.current&&(Be==="rect"||Be==="multi-rect")){const[I,X]=z.current.cell;let[H,T]=s.location;if(T<0&&(T=nn.current.y),d.fillHandle===!0&&((k=d.previousSelection)==null?void 0:k.current)!==void 0){const G=d.previousSelection.current.range;T=Math.min(T,Ve?Ie-1:Ie);const Y=ud(G,H,T,Ae);yi(Y)}else{if(Ve&&X===Ie)return;if(Ve&&T===Ie)if(s.kind===ai)T--;else return;H=Math.max(H,R);const V=Yr(X);T=V===void 0?T:vn(T,V[0],V[1]);const ne=H-I,te=T-X,ze={x:ne>=0?I:H,y:te>=0?X:T,width:Math.abs(ne)+1,height:Math.abs(te)+1};Rt({...z.current,range:ze},!0,!1,"drag")}}jt==null||jt({...s,location:[s.location[0]-R,s.location[1]]})}},[d,R,Xe,z,Be,jt,Yt,Ve,Ie,Ae,Yr,Rt]),la=a.useCallback(()=>{var H,T;const s=Ii.current;if(s===void 0)return;const[y,C]=s.scrollEdge;let[k,I]=s.location;const X=nn.current;y===-1?k=((T=(H=X.extras)==null?void 0:H.freezeRegion)==null?void 0:T.x)??X.x:y===1&&(k=X.x+X.width),C===-1?I=Math.max(0,X.y):C===1&&(I=Math.min(Ie-1,X.y+X.height)),k=vn(k,0,et.length-1),I=vn(I,0,Ie-1),Hi({...s,location:[k,I]})},[et.length,Hi,Ie]);Cu(js,ut,la);const Hn=a.useCallback(s=>{if(z.current===void 0)return;const[y,C]=s,[k,I]=z.current.cell,X=z.current.range;let H=X.x,T=X.x+X.width,G=X.y,Y=X.y+X.height;const[V,ne]=Yr(I)??[0,Ie-1],te=ne+1;if(C!==0)switch(C){case 2:{Y=te,G=I,Et(0,Y,"vertical");break}case-2:{G=V,Y=I+1,Et(0,G,"vertical");break}case 1:{G<I?(G++,Et(0,G,"vertical")):(Y=Math.min(te,Y+1),Et(0,Y,"vertical"));break}case-1:{Y>I+1?(Y--,Et(0,Y,"vertical")):(G=Math.max(V,G-1),Et(0,G,"vertical"));break}default:xr()}if(y!==0)if(y===2)T=et.length,H=k,Et(T-1-R,0,"horizontal");else if(y===-2)H=R,T=k+1,Et(H-R,0,"horizontal");else{let ze=[];if(kt!==void 0){const ie=kt({x:H,y:G,width:T-H-R,height:Y-G},Ft.current.signal);typeof ie=="object"&&(ze=Au(ie))}if(y===1){let ie=!1;if(H<k){if(ze.length>0){const We=Mo(H+1,k+1).find(He=>!ze.includes(He-R));We!==void 0&&(H=We,ie=!0)}else H++,ie=!0;ie&&Et(H,0,"horizontal")}ie||(T=Math.min(et.length,T+1),Et(T-1-R,0,"horizontal"))}else if(y===-1){let ie=!1;if(T>k+1){if(ze.length>0){const We=Mo(T-1,k,-1).find(He=>!ze.includes(He-R));We!==void 0&&(T=We,ie=!0)}else T--,ie=!0;ie&&Et(T-R,0,"horizontal")}ie||(H=Math.max(R,H-1),Et(H-R,0,"horizontal"))}else xr()}Rt({cell:z.current.cell,range:{x:H,y:G,width:T-H,height:Y-G}},!0,!1,"keyboard-select")},[kt,Yr,z,et.length,R,Ie,Et,Rt]),Di=a.useRef(zo);Di.current=zo;const to=a.useCallback((s,y,C,k)=>{const I=qt-(C?0:1);s=vn(s,R,yn.length-1+R),y=vn(y,0,I);const X=zn==null?void 0:zn[0],H=zn==null?void 0:zn[1];if(s===X&&y===H)return!1;if(k&&z.current!==void 0){const T=[...z.current.rangeStack];(z.current.range.width>1||z.current.range.height>1)&&T.push(z.current.range),Pt({...z,current:{cell:[s,y],range:{x:s,y,width:1,height:1},rangeStack:T}},!0)}else Rt({cell:[s,y],range:{x:s,y,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===s&&u.current[1]===y&&(u.current=void 0),Di.current&&Et(s-R,y,"both",0,20),!0},[qt,R,yn.length,zn,z,Et,Pt,Rt]),gr=a.useCallback((s,y)=>{var V,ne,te,ze;const C=p.current;h.current;let k=s;const I=((V=m.current)==null?void 0:V.getValue())??"",X=((ne=C==null?void 0:C.content)==null?void 0:ne.kind)===j.Custom;if((C==null?void 0:C.cell)!==void 0&&I.length>0&&C.content!==void 0&&!X){const ie=C.content;if(ie.kind===j.Text)k={...ie,data:I,displayData:I};else if(ie.kind===j.Number){const We=Number.parseFloat(I),He=Number.isNaN(We)?0:We;k={...ie,data:He,displayData:He.toLocaleString()}}else ie.kind===j.Uri?k={...ie,data:I,displayData:I}:ie.kind===j.Markdown&&(k={...ie,data:I})}else X&&(k=s);if(k!==void 0&&I.length===0)if(k.kind===j.Text&&k.data!==k.displayData)k={...k,displayData:k.data};else if(k.kind===j.Number){const ie=k.data!==void 0?k.data.toLocaleString():"0";k.displayData!==ie&&(k={...k,displayData:ie})}else k.kind===j.Uri&&k.data!==k.displayData&&(k={...k,displayData:k.data});const H=C==null?void 0:C.content,T=()=>{if(k===void 0||H===void 0)return!1;if(k.kind!==H.kind)return!0;switch(k.kind){case j.Text:case j.Uri:case j.Markdown:return k.data!==H.data;case j.Number:return k.data!==H.data;case j.Boolean:return k.data!==H.data;default:return!0}};(C==null?void 0:C.cell)!==void 0&&k!==void 0&&Yn(k)&&T()&&(on([{location:C.cell,value:k}]),window.requestAnimationFrame(()=>{var ie;(ie=Lt.current)==null||ie.damage([{cell:C.cell}])})),(te=m.current)==null||te.clear(),(ze=m.current)==null||ze.setVisible(!1),w(!1),Ut(!0),p.current=void 0,i(void 0);const[G,Y]=y;if(z.current!==void 0&&(G!==0||Y!==0)){const ie=z.current.cell[1]===qt-1;if(ie&&Y===1){P==null||P(s,[0,0]);return}const We=z.current.cell[0]===et.length-1&&s!==void 0;let He=!0;if(ie&&Y===1&&Ht!==void 0){He=!1;const ge=z.current.cell[0]+G,xe=Ko(ge);Qn(xe??ge,!1)}if(We&&G===1&&Ee!==void 0){He=!1;const ge=z.current.cell[1]+Y;Xr(ge,!1)}if(He){const ge=vn(z.current.cell[0]+G,R,et.length-1),xe=vn(z.current.cell[1]+Y,0,qt-1);to(ge,xe,ie,!1),window.requestAnimationFrame(()=>{var Le;(Le=m.current)==null||Le.focus()})}}P==null||P(s,y)},[Ut,z,P,on,qt,to,et.length,Qn,Xr,Ht,Ee,Ko,R]),sa=a.useMemo(()=>`gdg-overlay-${Tu++}`,[]),vo=a.useCallback(s=>{var C,k,I,X;Ut();const y=[];for(let H=s.x;H<s.x+s.width;H++)for(let T=s.y;T<s.y+s.height;T++){const G=F([H-R,T]);if(!G.allowOverlay&&G.kind!==j.Boolean)continue;let Y;if(G.kind===j.Custom){const V=Qt(G),ne=(C=V==null?void 0:V.provideEditor)==null?void 0:C.call(V,{...G,location:[H-R,T]});(V==null?void 0:V.onDelete)!==void 0?Y=V.onDelete(G):ds(ne)&&(Y=(k=ne==null?void 0:ne.deletedValue)==null?void 0:k.call(ne,G))}else if(Yn(G)&&G.allowOverlay||G.kind===j.Boolean){const V=Qt(G);Y=(I=V==null?void 0:V.onDelete)==null?void 0:I.call(V,G)}Y!==void 0&&!Ro(Y)&&Yn(Y)&&y.push({location:[H,T],value:Y})}on(y),(X=Lt.current)==null||X.damage(y.map(H=>({cell:H.location})))},[Ut,F,Qt,on,R]),mr=r!==void 0,Sl=a.useCallback(s=>{var We,He,ge,xe;const y=()=>{s.stopPropagation(),s.preventDefault()},C={didMatch:!1},{bounds:k}=s,I=z.columns,X=z.rows,H=se;if(!mr&&qe(H.clear,s,C)){const Le=((We=z.current)==null?void 0:We.cell)??[R,0];Pt({columns:lt.empty(),rows:lt.empty(),current:{cell:Le,range:{x:Le[0],y:Le[1],width:1,height:1},rangeStack:[]}},!1),Dt==null||Dt(),Ut()}else if(!mr&&qe(H.selectAll,s,C))Pt({columns:lt.empty(),rows:lt.empty(),current:{cell:((He=z.current)==null?void 0:He.cell)??[R,0],range:{x:R,y:0,width:A.length,height:Ie},rangeStack:[]}},!1);else if(qe(H.search,s,C))(ge=c==null?void 0:c.current)==null||ge.focus({preventScroll:!0}),pt(!0);else if(qe(H.delete,s,C)){const Le=(Rn==null?void 0:Rn(z))??!0;if(Le!==!1){const Se=Le===!0?z:Le;if(Se.current!==void 0){vo(Se.current.range);for(const mt of Se.current.rangeStack)vo(mt)}for(const mt of Se.rows)vo({x:R,y:mt,width:A.length,height:1});for(const mt of Se.columns)vo({x:mt,y:0,width:1,height:Ie})}}if(C.didMatch)return y(),!0;if(z.current===void 0)return!1;let[T,G]=z.current.cell;const[,Y]=z.current.cell;let V=!1,ne=!1;if(qe(H.scrollToSelectedCell,s,C))Vr.current(T-R,G);else if(Ye!=="none"&&qe(H.selectColumn,s,C))I.hasIndex(T)?zt(I.remove(T),void 0,!0):Ye==="single"?zt(lt.fromSingleSelection(T),void 0,!0):zt(void 0,T,!0);else if(Xe!=="none"&&qe(H.selectRow,s,C))X.hasIndex(G)?Yt(X.remove(G),void 0,!0):Xe==="single"?Yt(lt.fromSingleSelection(G),void 0,!0):Yt(void 0,G,!0);else if(!mr&&k!==void 0&&qe(H.activateCell,s,C))if(G===Ie&&Ve)window.setTimeout(()=>{const Le=Ko(T);Qn(Le??T)},0);else{const Le={inputType:"keyboard",key:s.key},Se=Bt([T,G]);Se.kind===j.Boolean&&Se.readonly!==!0?(W==null||W([T-R,G],Le),on([{location:[T,G],value:{...Se,data:qi(Se.data)}}]),(xe=Lt.current)==null||xe.damage([{cell:[T,G]}])):(W==null||W([T-R,G],Le),En(k,Le))}else z.current.range.height>1&&qe(H.downFill,s,C)?vl():z.current.range.width>1&&qe(H.rightFill,s,C)?kl():qe(H.goToNextPage,s,C)?G+=Math.max(1,nn.current.height-4):qe(H.goToPreviousPage,s,C)?G-=Math.max(1,nn.current.height-4):qe(H.goToFirstCell,s,C)?(i(void 0),G=0,T=0):qe(H.goToLastCell,s,C)?(i(void 0),G=Number.MAX_SAFE_INTEGER,T=Number.MAX_SAFE_INTEGER):qe(H.selectToFirstCell,s,C)?(i(void 0),Hn([-2,-2])):qe(H.selectToLastCell,s,C)?(i(void 0),Hn([2,2])):mr?(qe(H.closeOverlay,s,C)&&i(void 0),qe(H.acceptOverlayDown,s,C)&&(i(void 0),G++),qe(H.acceptOverlayUp,s,C)&&(i(void 0),G--),qe(H.acceptOverlayLeft,s,C)&&(i(void 0),T--),qe(H.acceptOverlayRight,s,C)&&(i(void 0),T++)):(qe(H.goDownCell,s,C)?G+=1:qe(H.goUpCell,s,C)?G-=1:qe(H.goRightCell,s,C)?T+=1:qe(H.goLeftCell,s,C)?T-=1:qe(H.goDownCellRetainSelection,s,C)?(G+=1,V=!0):qe(H.goUpCellRetainSelection,s,C)?(G-=1,V=!0):qe(H.goRightCellRetainSelection,s,C)?(T+=1,V=!0):qe(H.goLeftCellRetainSelection,s,C)?(T-=1,V=!0):qe(H.goToLastRow,s,C)?G=Ie-1:qe(H.goToFirstRow,s,C)?G=Number.MIN_SAFE_INTEGER:qe(H.goToLastColumn,s,C)?T=Number.MAX_SAFE_INTEGER:qe(H.goToFirstColumn,s,C)?T=Number.MIN_SAFE_INTEGER:(Be==="rect"||Be==="multi-rect")&&(qe(H.selectGrowDown,s,C)?Hn([0,1]):qe(H.selectGrowUp,s,C)?Hn([0,-1]):qe(H.selectGrowRight,s,C)?Hn([1,0]):qe(H.selectGrowLeft,s,C)?Hn([-1,0]):qe(H.selectToLastRow,s,C)?Hn([0,2]):qe(H.selectToFirstRow,s,C)?Hn([0,-2]):qe(H.selectToLastColumn,s,C)?Hn([2,0]):qe(H.selectToFirstColumn,s,C)&&Hn([-2,0])),ne=C.didMatch);if(In!==void 0&&In!=="normal"&&G!==Y){const Le=In==="skip-up"||In==="skip"||In==="block",Se=In==="skip-down"||In==="skip"||In==="block",mt=G<Y;if(mt&&Le){for(;G>=0&&Co(G).isGroupHeader;)G--;G<0&&(G=Y)}else if(!mt&&Se){for(;G<Ie&&Co(G).isGroupHeader;)G++;G>=Ie&&(G=Y)}}const ze=to(T,G,!1,V),ie=C.didMatch;return ie&&(ze||!ne||Hr)&&y(),ie},[In,mr,z,se,Ye,Xe,Be,R,Co,Ie,to,Pt,Dt,A.length,Rn,Hr,vo,zt,Yt,Ve,Ko,Qn,W,En,vl,kl,Hn,Bt,on]),xo=a.useCallback(s=>{let y=!1;if(Re!==void 0&&Re({...s,...s.location&&{location:[s.location[0]-R,s.location[1]]},cancel:()=>{y=!0}}),y||Sl(s)||z.current===void 0)return;const[C,k]=z.current.cell,I=nn.current,X=s.keyCode===229,H=Ne&&!s.metaKey&&!s.ctrlKey&&s.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(s.key);if((X||H)&&s.bounds!==void 0&&io(F([C-R,Math.max(0,Math.min(k,Ie-1))]))){if((!Ve||k!==Ie)&&(I.y>k||k>I.y+I.height||I.x>C||C>I.x+I.width))return;if(s.stopPropagation(),s.preventDefault(),X){const T={inputType:"keyboard",key:""};W==null||W([C-R,k],T),En(s.bounds,T,"")}else{const T={inputType:"keyboard",key:s.key};W==null||W([C-R,k],T),En(s.bounds,T,s.key)}}},[Ne,Re,Sl,z,F,R,Ie,Ve,W,En]),aa=a.useCallback((s,y)=>{var C;if(p.current===void 0&&!y&&s.length>0&&s.trim().length>0&&z.current!==void 0){const[k,I]=z.current.cell,X=Bt([k,I]);if(X.kind===j.Custom){const H=X.data,T=H==null?void 0:H.kind;if(T!=="number-cell"&&T!=="date-picker-cell")return}if(X.allowOverlay&&io(X)&&X.readonly!==!0){const H=(C=Lt.current)==null?void 0:C.getBounds(k,I);if(H!==void 0){const T={inputType:"keyboard",key:s};W==null||W([k-R,I],T),En(H,T,s)}}}},[z,Bt,R,W,En]),ca=a.useCallback(()=>{var k,I,X,H,T;if(z.current===void 0)return;const[s,y]=z.current.cell,C=(k=p.current)==null?void 0:k.cell;if(C!==void 0&&(C[0]!==s||C[1]!==y)&&((I=m.current)==null||I.clear(),(X=m.current)==null||X.setVisible(!1),w(!1),p.current=void 0,i(void 0)),p.current===void 0){const G=Bt([s,y]);if(G.kind===j.Custom){const Y=G.data,V=Y==null?void 0:Y.kind;if(V!=="number-cell"&&V!=="date-picker-cell")return}if(G.allowOverlay&&io(G)&&G.readonly!==!0){const Y=(H=Lt.current)==null?void 0:H.getBounds(s,y);if(Y!==void 0){(T=m.current)==null||T.clear();const V={inputType:"keyboard",key:""};W==null||W([s-R,y],V),En(Y,V,"")}}}},[z,Bt,R,W,En]),da=a.useCallback(s=>{},[]),ua=a.useCallback(s=>{var X,H;if(s.nativeEvent.isComposing)return;if(p.current!==void 0&&h.current){const T=s.key;if(p.current.content.kind===j.Custom){const Y=s.key;(Y==="Enter"||Y==="Tab"||Y==="Escape")&&(s.preventDefault(),s.stopPropagation());return}if(T==="Escape"){s.preventDefault(),s.stopPropagation(),gr(void 0,[0,0]);return}if(T==="Enter"&&!s.shiftKey){s.preventDefault(),s.stopPropagation(),gr(void 0,[0,1]);return}if(T==="Tab"){s.preventDefault(),s.stopPropagation(),gr(void 0,s.shiftKey?[-1,0]:[1,0]);return}}{const T=s.key;if(T.length===1&&!s.ctrlKey&&!s.metaKey&&!s.altKey)if(T===" "&&z.current!==void 0){const Y=z.current.cell,V=Bt(Y);if(!(V.kind===j.Boolean&&V.readonly!==!0))return}else return}if(p.current!==void 0&&h.current){const T=s.key;if(T==="Backspace"||T==="Delete"||(T==="ArrowLeft"||T==="ArrowRight"||T==="ArrowUp"||T==="ArrowDown"||T==="Home"||T==="End"))return}const y=(X=z.current)==null?void 0:X.cell,C=y!==void 0?(H=Lt.current)==null?void 0:H.getBounds(y[0],y[1]):void 0;let k=!1;const I={bounds:C,cancel:()=>{k=!0},stopPropagation:()=>s.stopPropagation(),preventDefault:()=>s.preventDefault(),ctrlKey:s.ctrlKey,metaKey:s.metaKey,shiftKey:s.shiftKey,altKey:s.altKey,key:s.key,keyCode:s.keyCode,rawEvent:s,location:y};xo(I),k&&(s.preventDefault(),s.stopPropagation())},[z,xo,gr,Bt]),fa=a.useCallback(s=>{var I,X;const y=(I=z.current)==null?void 0:I.cell,k={bounds:y!==void 0?(X=Lt.current)==null?void 0:X.getBounds(y[0],y[1]):void 0,cancel:()=>{},stopPropagation:()=>s.stopPropagation(),preventDefault:()=>s.preventDefault(),ctrlKey:s.ctrlKey,metaKey:s.metaKey,shiftKey:s.shiftKey,altKey:s.altKey,key:s.key,keyCode:s.keyCode,rawEvent:s,location:y};Qe==null||Qe(k)},[z,Qe]),ha=a.useCallback(()=>{Ti(!0)},[]),ga=a.useCallback(()=>{Ti(!1)},[]),ma=a.useCallback((s,y)=>{const C=s.location[0]-R;if(s.kind==="header"&&(we==null||we(C,{...s,preventDefault:y})),s.kind===Dn){if(C<0)return;ue==null||ue(C,{...s,preventDefault:y})}if(s.kind==="cell"){const[k,I]=s.location;ae==null||ae([C,I],{...s,preventDefault:y}),gc(z,s.location)||to(k,I,!1,!1)}},[z,ae,ue,we,R,to]),Fi=a.useCallback(async s=>{var H,T,G;if(!se.paste)return;function y(Y,V,ne,te){var ie,We;const ze=typeof ne=="object"?(ne==null?void 0:ne.join(`
`))??"":(ne==null?void 0:ne.toString())??"";if(!Ro(Y)&&io(Y)&&Y.readonly!==!0){const He=O==null?void 0:O(ze,Y);if(He!==void 0&&Yn(He))return{location:V,value:He};const ge=Qt(Y);if(ge===void 0)return;if(ge.kind===j.Custom){hn(Y.kind===j.Custom);const xe=(ie=ge.onPaste)==null?void 0:ie.call(ge,ze,Y.data);return xe===void 0?void 0:{location:V,value:{...Y,data:xe}}}else{const xe=(We=ge.onPaste)==null?void 0:We.call(ge,ze,Y,{formatted:te,formattedString:typeof te=="string"?te:te==null?void 0:te.join(`
`),rawValue:ne});return xe===void 0?void 0:(hn(xe.kind===Y.kind),{location:V,value:xe})}}}const C=z.columns,k=z.rows,I=((H=ut.current)==null?void 0:H.contains(document.activeElement))===!0||((T=l.current)==null?void 0:T.contains(document.activeElement))===!0;let X;if(z.current!==void 0?X=[z.current.range.x,z.current.range.y]:C.length===1?X=[C.first()??0,0]:k.length===1&&(X=[R,k.first()??0]),I&&X!==void 0){let Y,V;const ne="text/plain",te="text/html";if(navigator.clipboard.read!==void 0){const He=await navigator.clipboard.read();for(const ge of He){if(ge.types.includes(te)){const Le=await(await ge.getType(te)).text(),Se=Jl(Le);if(Se!==void 0){Y=Se;break}}ge.types.includes(ne)&&(V=await(await ge.getType(ne)).text())}}else if(navigator.clipboard.readText!==void 0)V=await navigator.clipboard.readText();else if(s!==void 0&&(s==null?void 0:s.clipboardData)!==null){if(s.clipboardData.types.includes(te)){const He=s.clipboardData.getData(te);Y=Jl(He)}Y===void 0&&s.clipboardData.types.includes(ne)&&(V=s.clipboardData.getData(ne))}else return;const[ze,ie]=X,We=[];do{if(nt===void 0){const He=Bt(X),ge=V??(Y==null?void 0:Y.map(Le=>Le.map(Se=>Se.rawValue).join("	")).join("	"))??"",xe=y(He,X,ge,void 0);xe!==void 0&&We.push(xe);break}if(Y===void 0){if(V===void 0)return;Y=hu(V)}if(nt===!1||typeof nt=="function"&&(nt==null?void 0:nt([X[0]-R,X[1]],Y.map(He=>He.map(ge=>{var xe;return((xe=ge.rawValue)==null?void 0:xe.toString())??""}))))!==!0)return;for(const[He,ge]of Y.entries()){if(He+ie>=Ie)break;for(const[xe,Le]of ge.entries()){const Se=[xe+ze,He+ie],[mt,rn]=Se;if(mt>=et.length||rn>=qt)continue;const ln=Bt(Se),kn=y(ln,Se,Le.rawValue,Le.formatted);kn!==void 0&&We.push(kn)}}}while(!1);on(We),(G=Lt.current)==null||G.damage(We.map(He=>({cell:He.location})))}},[O,Qt,Bt,z,se.paste,ut,et.length,on,qt,nt,R,Ie]);en("paste",Fi,v,!1,!0);const wr=a.useCallback(async(s,y)=>{var H,T;if(!se.copy)return;const C=y===!0||((H=ut.current)==null?void 0:H.contains(document.activeElement))===!0||((T=l.current)==null?void 0:T.contains(document.activeElement))===!0,k=z.columns,I=z.rows,X=(G,Y)=>{if(!me)es(G,Y,s);else{const V=Y.map(ne=>({kind:j.Text,data:A[ne].title,displayData:A[ne].title,allowOverlay:!1}));es([V,...G],Y,s)}};if(C&&kt!==void 0){if(z.current!==void 0){let G=kt(z.current.range,Ft.current.signal);typeof G!="object"&&(G=await G()),X(G,Mo(z.current.range.x-R,z.current.range.x+z.current.range.width-R))}else if(I!==void 0&&I.length>0){const Y=[...I].map(V=>{const ne=kt({x:R,y:V,width:A.length,height:1},Ft.current.signal);return typeof ne=="object"?ne[0]:ne().then(te=>te[0])});if(Y.some(V=>V instanceof Promise)){const V=await Promise.all(Y);X(V,Mo(A.length))}else X(Y,Mo(A.length))}else if(k.length>0){const G=[],Y=[];for(const V of k){let ne=kt({x:V,y:0,width:1,height:Ie},Ft.current.signal);typeof ne!="object"&&(ne=await ne()),G.push(ne),Y.push(V-R)}if(G.length===1)X(G[0],Y);else{const V=G.reduce((ne,te)=>ne.map((ze,ie)=>[...ze,...te[ie]]));X(V,Y)}}}},[A,kt,z,se.copy,R,ut,Ie,me]);en("copy",wr,v,!1,!1);const wa=a.useCallback(async s=>{var C,k;if(!(!se.cut||!(((C=ut.current)==null?void 0:C.contains(document.activeElement))===!0||((k=l.current)==null?void 0:k.contains(document.activeElement))===!0))&&(await wr(s),z.current!==void 0)){let I={current:{cell:z.current.cell,range:z.current.range,rangeStack:[]},rows:lt.empty(),columns:lt.empty()};const X=Rn==null?void 0:Rn(I);if(X===!1||(I=X===!0?I:X,I.current===void 0))return;vo(I.current.range)}},[vo,z,se.cut,wr,ut,Rn]);en("cut",wa,v,!1,!1);const pa=a.useCallback((s,y)=>{if(de!==void 0){R!==0&&(s=s.map(I=>[I[0]-R,I[1]])),de(s,y);return}if(s.length===0||y===-1)return;const[C,k]=s[y];u.current!==void 0&&u.current[0]===C&&u.current[1]===k||(u.current=[C,k],to(C,k,!1,!1))},[de,R,to]),[Kr,_r]=((Fl=rt==null?void 0:rt.current)==null?void 0:Fl.cell)??[],Vr=a.useRef(Et);Vr.current=Et,a.useLayoutEffect(()=>{var s,y,C,k;Di.current&&!Lr.current&&Kr!==void 0&&_r!==void 0&&(Kr!==((y=(s=it.current)==null?void 0:s.current)==null?void 0:y.cell[0])||_r!==((k=(C=it.current)==null?void 0:C.current)==null?void 0:k.cell[1]))&&Vr.current(Kr,_r),Lr.current=!1},[Kr,_r]);const Ml=z.current!==void 0&&(z.current.cell[0]>=et.length||z.current.cell[1]>=qt);a.useLayoutEffect(()=>{Ml&&Pt(Oi,!1)},[Ml,Pt]);const ba=a.useMemo(()=>Ve===!0&&(_e==null?void 0:_e.tint)===!0?lt.fromSingleSelection(qt-1):lt.empty(),[qt,Ve,_e==null?void 0:_e.tint]),ya=a.useCallback(s=>typeof Wt=="boolean"?Wt:(Wt==null?void 0:Wt(s-R))??!0,[R,Wt]),Ca=a.useMemo(()=>{if(Si===void 0||l.current===null)return null;const{bounds:s,group:y}=Si,C=l.current.getBoundingClientRect();return a.createElement(nu,{bounds:s,group:y,canvasBounds:C,onClose:()=>Mi(void 0),onFinish:k=>{Mi(void 0),re==null||re(y,k)}})},[re,Si]),ka=Math.min(et.length,ot+R);a.useImperativeHandle(t,()=>({appendRow:(s,y)=>Qn(s+R,y),appendColumn:(s,y)=>Xr(s,y),updateCells:s=>{var y;return R!==0&&(s=s.map(C=>({cell:[C.cell[0]+R,C.cell[1]]}))),(y=Lt.current)==null?void 0:y.damage(s)},getBounds:(s,y)=>{var C;if(!((l==null?void 0:l.current)===null||(ut==null?void 0:ut.current)===null)){if(s===void 0&&y===void 0){const k=l.current.getBoundingClientRect(),I=k.width/ut.current.clientWidth;return{x:k.x-ut.current.scrollLeft*I,y:k.y-ut.current.scrollTop*I,width:ut.current.scrollWidth*I,height:ut.current.scrollHeight*I}}return(C=Lt.current)==null?void 0:C.getBounds((s??0)+R,y)}},focus:()=>{var s;return(s=Lt.current)==null?void 0:s.focus()},emit:async s=>{switch(s){case"delete":xo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":xo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":xo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await wr(void 0,!0);break;case"paste":await Fi();break}},scrollTo:Et,remeasureColumns:s=>{for(const y of s)Gr(y+R)},getMouseArgsForPosition:(s,y,C)=>{if((Lt==null?void 0:Lt.current)===null)return;const k=Lt.current.getMouseArgsForPosition(s,y,C);if(k!==void 0)return{...k,location:[k.location[0]-R,k.location[1]]}}}),[Qn,Xr,Gr,ut,wr,xo,Fi,R,Et]);const[Rl,El]=zn??[],va=a.useCallback(s=>{const[y,C]=s;if(C===-1){Ye!=="none"&&(zt(lt.fromSingleSelection(y),void 0,!1),Ut());return}Rl===y&&El===C||(Rt({cell:s,range:{x:y,y:C,width:1,height:1}},!0,!1,"keyboard-nav"),Et(y,C))},[Ye,Ut,Et,Rl,El,Rt,zt]),[xa,Ti]=a.useState(!1),Il=a.useRef(as(s=>{Ti(s)},5)),Sa=a.useCallback(()=>{Il.current(!0),z.current===void 0&&z.columns.length===0&&z.rows.length===0&&d===void 0&&Rt({cell:[R,Br],range:{x:R,y:Br,width:1,height:1}},!0,!1,"keyboard-select")},[Br,z,d,R,Rt]),Ma=a.useCallback(()=>{Il.current(!1)},[]),[Ra,Ea]=a.useMemo(()=>{let s;const y=(Ct==null?void 0:Ct.scrollbarWidthOverride)??Gi(),C=Ie+(Ve?1:0);if(typeof An=="number")s=dr+C*An;else{let I=0;const X=Math.min(C,10);for(let H=0;H<X;H++)I+=An(H);I=Math.floor(I/X),s=dr+C*I}s+=y;const k=et.reduce((I,X)=>X.width+I,0)+y;return[`${Math.min(1e5,k)}px`,`${Math.min(1e5,s)}px`]},[et,Ct==null?void 0:Ct.scrollbarWidthOverride,An,Ie,Ve,dr]),Ia=a.useMemo(()=>ps(Vt),[Vt]);return a.createElement(tl.Provider,{value:Vt},a.createElement(pu,{style:Ia,className:Ce,inWidth:E??Ra,inHeight:$??Ea},a.createElement(Qd,{fillHandle:Mr,drawFocusRing:Lo,experimental:Ct,fixedShadowX:Nn,fixedShadowY:$n,getRowThemeOverride:Mn,headerIcons:Do,imageWindowLoader:Rr,initialSize:Er,isDraggable:Fo,onDragLeave:To,onRowMoved:Tn,overscrollX:L,overscrollY:_,preventDiagonalScrolling:_n,rightElement:ui,rightElementProps:Ir,smoothScrollX:fi,smoothScrollY:Xn,className:Ce,enableGroups:ul,onCanvasFocused:Sa,onCanvasBlur:Ma,canvasRef:l,onContextMenu:ma,theme:Vt,cellXOffset:Vs,cellYOffset:Br,accessibilityHeight:bo.height,onDragEnd:ia,columns:et,nonGrowWidth:dl,drawHeader:po,onColumnProposeMove:na,drawCell:Jn,disabledRows:ba,freezeColumns:ka,lockColumns:R,firstColAccessible:R===0,getCellContent:Bt,minColumnWidth:jn,maxColumnWidth:Xo,searchInputRef:c,showSearch:bt,onSearchClose:yt,highlightRegions:Us,getCellsForSelection:kt,getGroupDetails:Ci,headerHeight:wo,isFocused:xa,groupHeaderHeight:ul?ar:0,groupLevels:cr,groupHeaderHeights:fl,freezeTrailingRows:Gt+(Ve&&(_e==null?void 0:_e.sticky)===!0?1:0),hasAppendRow:Ve,onColumnResize:_t,onColumnResizeEnd:Zn,onColumnResizeStart:fn,onCellFocused:va,onColumnMoved:oa,onDragStart:ra,onHeaderMenuClick:Qs,onHeaderIndicatorClick:ea,onItemHovered:Hi,isFilling:(d==null?void 0:d.fillHandle)===!0,onMouseMove:Js,onKeyDown:xo,onKeyUp:Qe,onMouseDown:qs,onMouseUp:Zs,onDragOverCell:Jt,onDrop:$e,onSearchResultsChanged:pa,onVisibleRegionChanged:ta,clientSize:bi,rowHeight:An,searchResults:Oe,searchValue:oe,onSearchValueChange:Ge,rows:qt,scrollRef:ut,selection:z,translateX:bo.tx,translateY:bo.ty,verticalBorder:ya,gridRef:Lt,getCellRenderer:Qt,resizeIndicator:Pr}),Ca,r!==void 0&&a.createElement(a.Suspense,{fallback:null},a.createElement(Fu,{...r,validateCell:Pn,bloom:Q,id:sa,getCellRenderer:Qt,className:(Ct==null?void 0:Ct.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:cn,imageEditorOverride:S,portalElementRef:Un,onFinishEditing:gr,markdownDivCreateNode:x,isOutsideClick:Po,customEventTarget:Ct==null?void 0:Ct.eventTarget,isGhostMode:g}))),(()=>{const s=(Un==null?void 0:Un.current)??document.getElementById("portal");return s===null?null:ss.createPortal(a.createElement(Du,{ref:m,onInput:aa,onCompositionStart:ca,onCompositionEnd:da,onKeyDown:ua,onKeyUp:fa,onFocus:ha,onBlur:ga}),s)})())},zu=a.forwardRef(Pu);function os(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:c,height:l,x:d,y:f}=r,u=t.maxSize??i.checkboxMaxSize,m=Math.floor(r.y+l/2),g=hs(u,l,i.cellVerticalPadding),w=fs(t.contentAlign??"center",d,c,i.cellHorizontalPadding,g),h=us(w,m,g),p=gs(d+n,f+o,h);return Ji(t)&&p}const Lu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:j.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Bu(e,e.cell.data,Ji(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{os(e)&&e.preventDefault()},onClick:e=>{if(os(e))return{...e.cell,data:qi(e.cell.data)}},onPaste:(e,t)=>{let n=ti;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Zi),n===t.data?void 0:{...t,data:n}}};function Bu(e,t,n,o,r){if(!n&&t===ti)return;const{ctx:i,hoverAmount:c,theme:l,rect:d,highlighted:f,hoverX:u,hoverY:m,cell:{contentAlign:g}}=e,{x:w,y:h,width:p,height:v}=d;let S=!1;if(r>0){let b=n?1-r+r*c:.4;if(t===ti&&(b*=c),b===0)return;b<1&&(S=!0,i.globalAlpha=b)}ii(i,l,t,w,h,p,v,f,u,m,o,g),S&&(i.globalAlpha=1)}const Wu=tn("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Ou=e=>{const{bubbles:t}=e,{isGhostMode:n}=a.useContext(er);return a.createElement(Wu,null,t.map((o,r)=>a.createElement("div",{key:r,className:"boe-bubble"},o)),a.createElement("textarea",{className:"gdg-input",autoFocus:!n}))},Nu={getAccessibilityString:e=>ms(e.data),kind:j.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>$u(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Ou,{bubbles:t.data})},onPaste:()=>{}};function $u(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:c,y:l,width:d,height:f}=n;let u=c+o.cellHorizontalPadding;const m=[];for(const g of t){if(u>c+d)break;const w=Ho(g,r,o.baseFontFull).width;m.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const g of m)Bn(r,g.x,l+(f-o.bubbleHeight)/2,g.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[g,w]of m.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[g],w.x+o.bubblePadding,l+f/2+mn(r,o))}const Xu=tn("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Gu=e=>{const{drilldowns:t}=e;return a.createElement(Xu,null,t.map((n,o)=>a.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&a.createElement("img",{src:n.img}),a.createElement("div",null,n.text))))},Yu={getAccessibilityString:e=>ms(e.data.map(t=>t.text)),kind:j.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>_u(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return a.createElement(Gu,{drilldowns:t.data})},onPaste:()=>{}},Ni={};function Ku(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,c=n-i*2,l=4,d=n*r,f=o+i,u=o*3,m=(u+i*2)*r,g=`${e},${t},${r},${n}`;if(Ni[g]!==void 0)return{el:Ni[g],height:d,width:m,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=m,w.height=d,h.scale(r,r),Ni[g]=w,h.beginPath(),Bn(h,i,i,u,c,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Bn(h,i+.5,i+.5,u,c,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:d,width:m,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function _u(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:c,row:l}=e,{x:d,width:f}=n,u=o.baseFontFull,m=Es(r,u),g=Math.min(n.height,Math.max(16,Math.ceil(m*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-g)/2),h=g-10,p=o.bubblePadding,v=o.bubbleMargin;let S=d+o.cellHorizontalPadding;const b=o.roundingRadius??6,x=Ku(o.bgCell,o.drilldownBorder,g,b),E=[];for(const $ of t){if(S>d+f)break;const D=Ho($.text,r,u).width;let F=0;$.img!==void 0&&i.loadOrGetImage($.img,c,l)!==void 0&&(F=h-8+4);const M=D+F+p*2;E.push({x:S,width:M}),S+=M+v}if(x!==null){const{el:$,height:A,middleWidth:D,sideWidth:F,width:M,dpr:W,padding:N}=x,P=F/W,O=N/W;for(const B of E){const J=Math.floor(B.x),Q=Math.floor(B.width),pe=Q-(P-O)*2;r.imageSmoothingEnabled=!1,r.drawImage($,0,0,F,A,J-O,w,P,g),pe>0&&r.drawImage($,F,0,D,A,J+(P-O),w,pe,g),r.drawImage($,M-F,0,F,A,J+Q-(P-O),w,P,g),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[$,A]of E.entries()){const D=t[$];let F=A.x+p;if(D.img!==void 0){const M=i.loadOrGetImage(D.img,c,l);if(M!==void 0){const W=h-8;let N=0,P=0,O=M.width,B=M.height;O>B?(N+=(O-B)/2,O=B):B>O&&(P+=(B-O)/2,B=O),r.beginPath(),Bn(r,F,w+g/2-W/2,W,W,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(M,N,P,O,B,F,w+g/2-W/2,W,W),r.restore(),F+=W+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(D.text,F,w+g/2+mn(r,o))}}const Vu={getAccessibilityString:e=>e.data.join(", "),kind:j.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Uu(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??qa;return a.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},$i=4;function Uu(e,t,n,o){const{rect:r,col:i,row:c,theme:l,ctx:d,imageLoader:f}=e,{x:u,y:m,height:g,width:w}=r,h=g-l.cellVerticalPadding*2,p=[];let v=0;for(let b=0;b<t.length;b++){const x=t[b];if(x.length===0)continue;const E=f.loadOrGetImage(x,i,c);if(E!==void 0){p[b]=E;const $=E.width*(h/E.height);v+=$+$i}}if(v===0)return;v-=$i;let S=u+l.cellHorizontalPadding;o==="right"?S=Math.floor(u+w-l.cellHorizontalPadding-v):o==="center"&&(S=Math.floor(u+w/2-v/2));for(const b of p){if(b===void 0)continue;const x=b.width*(h/b.height);n>0&&(d.beginPath(),Bn(d,S,m+l.cellVerticalPadding,x,h,n),d.save(),d.clip()),d.drawImage(b,S,m+l.cellVerticalPadding,x,h),n>0&&d.restore(),S+=x+$i}}function qu(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const ju={getAccessibilityString:()=>"",kind:j.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:c}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(qu(n,o)*t.skeletonWidthVariability));const d=c.cellHorizontalPadding;l+d*2>=i.width&&(l=i.width-d*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*c.cellVerticalPadding);Bn(r,i.x+d,i.y+(i.height-f)/2,l,f,c.roundingRadius??3),r.fillStyle=co(c.textDark,.1),r.fill()},onPaste:()=>{}},Zu=()=>e=>e.targetWidth,rs=tn("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[Zu(),"px"]}}),Ju=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:c,validatedSelection:l}=e,{isGhostMode:d}=a.useContext(er),f=t.data,u=t.readonly===!0,[m,g]=a.useState(f===""||o),w=a.useCallback(()=>{g(p=>!p)},[]),h=f?"gdg-ml-6":"";return m?a.createElement(rs,{targetWidth:i.width-20},a.createElement(nl,{autoFocus:!d,highlight:!1,validatedSelection:l,value:f,onKeyDown:p=>{p.key==="Enter"&&p.stopPropagation()},onChange:n}),a.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${h}`,onClick:()=>c(t)},a.createElement(Xa,null))):a.createElement(rs,{targetWidth:i.width},a.createElement(Za,{contents:f,createNode:r}),!u&&a.createElement(a.Fragment,null,a.createElement("div",{className:"spacer"}),a.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${h}`,onClick:w},a.createElement(Qi,null))),a.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!d}))},Qu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:ci,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Kn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:c,validatedSelection:l}=e;return a.createElement(Ju,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:d=>t({...n,data:d.target.value}),forceEditMode:c,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},ef={getAccessibilityString:e=>e.row.toString(),kind:Nt.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:tf,measure:()=>44,draw:e=>of(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e;if(n.disabled===!0)return;const{width:i,height:c}=t,l=n.drawHandle?7+(i-7)/2:i/2,d=c/2;if(Math.abs(o-l)<=10&&Math.abs(r-d)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function tf(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=nf,n.textAlign="center",i}function nf(e){const{ctx:t}=e;t.textAlign="start"}function of(e,t,n,o,r,i,c){if(c){const{ctx:v,rect:S,theme:b}=e,{x,y:E,width:$,height:A}=S,D=o==="checkbox"?"checkbox-visible":o;if(D!=="number"&&(v.globalAlpha=n?1:.4,ii(v,b,n,r?x+7:x,E,r?$-7:$,A,!1,-20,-20,b.checkboxMaxSize,"center",i,!0),v.globalAlpha=1),D==="number"||D==="both"&&!n){const F=t.toString(),M=b.markerFontFull,W=x+$/2;v.fillStyle="#cccccc",v.font=M,v.fillText(F,W,E+A/2+mn(v,M))}if(r){v.globalAlpha=.4,v.beginPath();for(const F of[3,6])for(const M of[-5,-1,3])v.rect(x+F,E+A/2+M,2,2);v.fillStyle="#cccccc",v.fill(),v.beginPath(),v.globalAlpha=1}return}const{ctx:l,rect:d,hoverAmount:f,theme:u}=e,{x:m,y:g,width:w,height:h}=d,p=n?1:o==="checkbox-visible"?.6+.4*f:f;if(o!=="number"&&p>0){l.globalAlpha=p;const v=7*(n?f:1);if(ii(l,u,n,r?m+v:m,g,r?w-v:w,h,!0,void 0,void 0,u.checkboxMaxSize,"center",i,c),r){l.globalAlpha=f,l.beginPath();for(const S of[3,6])for(const b of[-5,-1,3])l.rect(m+S,g+h/2+b,2,2);l.fillStyle=u.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const v=t.toString(),S=u.markerFontFull,b=m+w/2;o==="both"&&f!==0&&(l.globalAlpha=1-f),l.fillStyle=u.textLight,l.font=S,l.fillText(v,b,g+h/2+mn(l,S)),f!==0&&(l.globalAlpha=1)}}const rf={getAccessibilityString:()=>"",kind:Nt.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>lf(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function lf(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:c,spriteManager:l}=e,{x:d,y:f,width:u,height:m}=r;o.beginPath(),o.globalAlpha=i,o.rect(d+1,f+1,u,m-2),o.fillStyle=c.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let w=0;if(n!==void 0){const p=m-8,v=d+8/2,S=f+8/2;l.drawSprite(n,"normal",o,v,S,p,c,g?1:i),w=p}else{w=24;const h=12,p=g?h:i*h,v=g?0:(1-i)*h*.5,S=c.cellHorizontalPadding+4;p>0&&(o.moveTo(d+S+v,f+m/2),o.lineTo(d+S+v+p,f+m/2),o.moveTo(d+S+v+p*.5,f+m/2-p*.5),o.lineTo(d+S+v+p*.5,f+m/2+p*.5),o.lineWidth=2,o.strokeStyle=c.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=c.textMedium,o.fillText(t,w+d+c.cellHorizontalPadding+.5,f+m/2+mn(o,c)),o.beginPath()}function Gs(e,t,n,o,r,i,c){e.textBaseline="alphabetic";const l=sf(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Bn(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??co(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",c==null||c("text")}function sf(e,t,n,o,r){const i=o.cellHorizontalPadding,c=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+c/2+1,width:t.width-i,height:t.height-c-1};const l=Ho(n,e,o.baseFontFull,"alphabetic"),d=t.height-c,f=Math.min(d,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const af=a.lazy(async()=>await ls(()=>import("./number-overlay-editor-CtJxsYrd.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),cf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:ci,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:c}=e,{hoverEffect:l,displayData:d,hoverEffectTheme:f}=n;l===!0&&t>0&&Gs(o,r,f,d,i,t,c),Kn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,onFinishedEditing:o,value:r,validatedSelection:i}=e;return a.createElement(a.Suspense,{fallback:null},a.createElement(af,{highlight:t,disabled:r.readonly===!0,value:r.data,fixedDecimals:r.fixedDecimals,allowNegative:r.allowNegative,thousandSeparator:r.thousandSeparator,decimalSeparator:r.decimalSeparator,validatedSelection:i,onChange:c=>n({...r,data:Number.isNaN(c.floatValue??0)?0:c.floatValue}),onKeyDown:c=>{c.key==="Enter"&&!c.shiftKey?(c.preventDefault(),o(r,[0,1])):c.key==="Tab"?(c.preventDefault(),o(r,[c.shiftKey?-1:1,0])):c.key==="Escape"&&(c.preventDefault(),o(void 0,[0,0]))}}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},df={getAccessibilityString:()=>"",measure:()=>108,kind:j.Protected,needsHover:!1,needsHoverPosition:!1,draw:uf,onPaste:()=>{}};function uf(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:c}=o;t.beginPath();const l=2.5;let d=r+n.cellHorizontalPadding+l;const f=i+c/2,u=Math.cos(Bl(30))*l,m=Math.sin(Bl(30))*l;for(let g=0;g<12;g++)t.moveTo(d,f-l),t.lineTo(d,f+l),t.moveTo(d+u,f-m),t.lineTo(d-u,f+m),t.moveTo(d-u,f-m),t.lineTo(d+u,f+m),d+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const ff={getAccessibilityString:e=>e.rowId??"",kind:Nt.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>Ho(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:r}=e,i=o.rowId;if(!i)return;t.fillStyle=r.textDark,t.font=r.baseFontStyle,t.textAlign="left";const c=n.x+r.cellHorizontalPadding,l=n.y+n.height/2;t.fillText(i,c,l+mn(t,r))},onClick:()=>{},onPaste:()=>{}},hf={getAccessibilityString:e=>e.rowId??"",kind:Nt.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:gf,measure:()=>80,draw:e=>wf(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function gf(e,t){const{ctx:n}=e,o="12px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=mf,n.textAlign="left",r}function mf(e){const{ctx:t}=e;t.textAlign="start"}function wf(e,t){if(!t)return;const{ctx:n,rect:o,theme:r}=e,{x:i,y:c,height:l}=o;n.fillStyle=r.textDark,n.font="12px sans-serif";const d=i+8,f=c+l/2;n.fillText(t,d,f+mn(n,n.font))}const pf={getAccessibilityString:e=>e.status??"",kind:Nt.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:bf,measure:()=>40,draw:e=>Cf(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function bf(e,t){const{ctx:n}=e,o="bold 14px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=yf,n.textAlign="center",r}function yf(e){const{ctx:t}=e;t.textAlign="start"}function Cf(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:r,y:i,width:c,height:l}=o,d={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=d[t],n.font="bold 14px sans-serif";const f=r+c/2,u=i+l/2;n.fillText(t,f,u+mn(n,n.font))}const kf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:ci,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:c,overrideCursor:l}=e,{displayData:d,contentAlign:f,hoverEffect:u,allowWrapping:m,hoverEffectTheme:g}=t;u===!0&&n>0&&Gs(r,c,g,d,i,n,l),Kn(e,d,f,m,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return a.createElement(nl,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:c=>o({...r,data:c.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},vf=tn("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),xf=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:c}=e,{isGhostMode:l}=a.useContext(er),[d,f]=a.useState(!r&&(t===""||o)),u=a.useCallback(()=>{f(!0)},[]);return d?a.createElement(nl,{validatedSelection:i,highlight:!0,autoFocus:!l,value:t,onChange:n}):a.createElement(vf,null,a.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},c),!r&&a.createElement("div",{className:"gdg-edit-icon",onClick:u},a.createElement(Qi,null)),a.createElement("textarea",{className:"gdg-input",autoFocus:!l}))};function Ys(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,c=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-c-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-c/2),{x:r,y:i,width:c,height:l}}function is(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,c=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=Ms(c,i.baseFontFull);if(l===void 0)return!1;const d=Ys(l,n,i,t.contentAlign);return ao({x:d.x-4,y:d.y-4,width:d.width+8,height:d.height+8},o,r)}const Sf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:j.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:ci,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:c,ctx:l}=e,d=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Ho(d,l,n.baseFontFull),m=Ys(u,c,n,t.contentAlign),{x:g,y:w,width:h,height:p}=m;if(r>=g-4&&r<=g-4+h+8&&i>=w-4&&i<=w-4+p+8){const v=mn(l,n.baseFontFull);o("pointer");const S=5,b=w-v;l.beginPath(),l.moveTo(c.x+g,Math.floor(c.y+b+p+S)+.5),l.lineTo(c.x+g+h,Math.floor(c.y+b+p+S)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Kn({...e,rect:{...c,x:c.x-1}},d,t.contentAlign),Kn({...e,rect:{...c,x:c.x-2}},d,t.contentAlign),Kn({...e,rect:{...c,x:c.x+1}},d,t.contentAlign),Kn({...e,rect:{...c,x:c.x+2}},d,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Kn(e,d,t.contentAlign)},onSelect:e=>{is(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;is(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return a.createElement(xf,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:c=>n({...o,data:c.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Mf=[ef,rf,pf,hf,Lu,Nu,Yu,Vu,ju,Qu,cf,df,ff,kf,Sf],Xi=[];class Rf extends Hs{constructor(){super(...arguments);Ue(this,"imageLoaded",()=>{});Ue(this,"loadedLocations",[]);Ue(this,"cache",{});Ue(this,"sendLoaded",La(()=>{this.imageLoaded(new jo(this.loadedLocations)),this.loadedLocations=[]},20));Ue(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let c=0;c<r.cells.length;c++){const l=r.cells[c];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let c=!1;const l=Xi.pop()??new Image;let d=!1;const f={img:void 0,cells:[Fn(o,r)],url:n,cancel:()=>{d||(d=!0,Xi.length<12?Xi.unshift(l):c||(l.src=""))}},u=new Promise(m=>l.addEventListener("load",()=>m(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const m=this.cache[i];if(m!==void 0&&!d){m.img=l;for(const g of m.cells)this.loadedLocations.push(il(g));c=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,c=this.cache[i];if(c!==void 0){const l=Fn(o,r);return c.cells.includes(l)||c.cells.push(l),c.img}else this.loadImage(n,o,r,i)}}const Ef=(e,t)=>{const n=a.useMemo(()=>({...ld,...e.headerIcons}),[e.headerIcons]),o=a.useMemo(()=>e.renderers??Mf,[e.renderers]),r=a.useMemo(()=>e.imageWindowLoader??new Rf,[e.imageWindowLoader]);return a.createElement(zu,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Nf=a.forwardRef(Ef);export{Nf as D,j as G,nl as a,Es as b,gn as c,Of as d,Bf as e,zf as f,mn as g,Yn as h,Lf as i,Pl as j,er as k,Ho as m,Jo as p,Bn as r,Wf as u};
