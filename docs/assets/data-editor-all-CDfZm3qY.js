const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./image-window-loader-Dk75Znu1.js","./iframe-ey5Dtog6.js","./preload-helper-C1FmrZbK.js","./throttle-CTAHWGOq.js","./marked.esm-C0N8jT3i.js","./index-D62X44zt.js","./image-window-loader-Bm61kU6i.css"])))=>i.map(i=>d[i]);
import{r,R as me}from"./iframe-ey5Dtog6.js";import{_ as pi}from"./preload-helper-C1FmrZbK.js";import{r as Ci}from"./index-D62X44zt.js";import{G as V,d as jo,e as wi,f as Zo,r as yl,h as en,C as ne,g as Il,j as yi,w as Ct,k as bi,l as xi,m as Ln,n as bl,I as Ht,p as ki,o as Ri,t as xl,q as Mi,s as Xt,v as kl,x as Si,y as Jo,z as Ft,A as Ei,B as Ti,D as zi,E as Ii,F as Li,H as Rl,i as $t,J as Di,K as Hi,L as Ml,M as Fi,b as Dn,N as $i,O as Ai,T as Gi,P as Ki,Q as Pi,R as Sl,S as Ni,U as Wi}from"./image-window-loader-Dk75Znu1.js";import{m as At,r as Yt,g as Vi}from"./throttle-CTAHWGOq.js";import{u as Bi,f as El}from"./flatten-D4WOz0LH.js";import{G as Ui}from"./scrolling-data-grid-CuqDAz7c.js";import{s as tn}from"./marked.esm-C0N8jT3i.js";const le='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Oi=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}<rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${l}"/></svg>`},_i=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}<rect x="2" y="2" width="16" height="16" rx="4" fill="${a}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${l}"/></svg>`},Xi=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${a}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${l}"/>
  </svg>`},Yi=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${a}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${l}"/>
</svg>`},qi=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${a}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${l}"
    />
</svg>`},Ll=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${a}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${l}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${l}"/>
</svg>
  `},Zi=t=>{const l=t.bgColor;return`${le}
    <path stroke="${l}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${l}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${l}"/>
  </svg>
`},Ji=Ll,Qi=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${a}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${l}"/>
</svg>`},ji=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${l}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${l}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${l}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${a}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${l}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${l}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${l}"/>
  </svg>`},es=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${a}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${l}"/>
</svg>`},ts=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <path fill="${l}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${a}"/>
  </svg>`},os=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${a}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${l}"/>
  </svg>`},ns=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${a}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${l}"/>
</svg>`},ls=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${a}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${l}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${l}"/>
  </svg>`},rs=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${l}"/>
</svg>`},is=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${a}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${a}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${l}"/>
  </svg>`},ss=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <path fill="${l}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${a}"/>
</svg>`},cs=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${l}"/>
  </svg>`},as=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${l}"/>
  </svg>`},us=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${l}"/>
</svg>`},ds=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${l}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${l}"/>
</svg>`},fs=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${a}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${l}"/>
  </svg>`},hs=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${l}"/>
</svg>`},gs=t=>{const l=t.fgColor,a=t.bgColor;return`
    ${le}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${l}"/>
  </svg>`},ms=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${a}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${l}"/>
</svg>`},vs=t=>{const l=t.fgColor,a=t.bgColor;return`${le}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${a}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${l}"/>
</svg>`},ps=t=>{const l=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${l}" stroke-width="2"/>
  </svg>`},Cs=t=>{const l=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${l}" stroke-width="2"/>
  </svg>
`},ws=t=>(t.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${t.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),ys=t=>(t.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${t.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),bs={headerRowID:Oi,headerNumber:Xi,headerCode:_i,headerString:Yi,headerBoolean:qi,headerAudioUri:Ji,headerVideoUri:Qi,headerEmoji:ji,headerImage:es,headerUri:Ll,headerPhone:ts,headerMarkdown:os,headerDate:ns,headerTime:ls,headerEmail:rs,headerReference:is,headerIfThenElse:ss,headerSingleValue:cs,headerLookup:as,headerTextTemplate:us,headerMath:ds,headerRollup:fs,headerJoinStrings:hs,headerSplitString:gs,headerGeoDistance:ms,headerArray:vs,rowOwnerOverlay:ps,protectedColumnOverlay:Cs,renameIcon:Zi,headerArrowDown:ws,headerArrowUp:ys},xs=tn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),ks=r.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},r.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Rs=r.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},r.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Ms=r.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},r.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Ss=10,Es=t=>{const{canvasRef:l,cellYOffset:a,rows:g,columns:w,searchInputRef:R,searchValue:D,searchResults:b,onSearchValueChange:M,getCellsForSelection:H,onSearchResultsChanged:p,showSearch:y=!1,onSearchClose:S}=t,[B]=r.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[Y,U]=r.useState(""),de=D??Y,ve=r.useCallback(A=>{U(A),M==null||M(A)},[M]),[P,I]=r.useState(),Q=r.useRef(P);Q.current=P,r.useEffect(()=>{b!==void 0&&(b.length>0?I(A=>({rowsSearched:g,results:b.length,selectedIndex:(A==null?void 0:A.selectedIndex)??-1})):I(void 0))},[g,b]);const fe=r.useRef();fe.current===void 0&&(fe.current=new AbortController);const q=r.useRef(),[Z,oe]=r.useState([]),se=b??Z,G=r.useCallback(()=>{q.current!==void 0&&(window.cancelAnimationFrame(q.current),q.current=void 0),fe.current!==void 0&&fe.current.abort(),fe.current=new AbortController},[]),Be=r.useRef(a);Be.current=a;const $e=r.useCallback(A=>{const re=new RegExp(A.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let we=Be.current,ye=Math.min(10,g),Je=0;I(void 0),oe([]);const Se=[],Qe=async()=>{var Zt;if(H===void 0)return;const wt=performance.now(),yt=g-Je;let je=H({x:0,y:we,width:w.length,height:Math.min(ye,yt,g-we)},fe.current.signal);typeof je=="function"&&(je=await je());let vo=!1;for(const[it,st]of je.entries())for(const[xt,De]of st.entries()){let He;switch(De.kind){case V.Text:case V.Number:He=De.displayData;break;case V.Uri:case V.Markdown:He=De.data;break;case V.Boolean:He=typeof De.data=="boolean"?De.data.toString():void 0;break;case V.Image:case V.Bubble:He=De.data.join("üê≥");break;case V.Custom:He=De.copyData;break}He!==void 0&&re.test(He)&&(Se.push([xt,it+we]),vo=!0)}const on=performance.now();vo&&oe([...Se]),Je+=je.length,jo(Je<=g);const po=((Zt=Q.current)==null?void 0:Zt.selectedIndex)??-1;I({results:Se.length,rowsSearched:Je,selectedIndex:po}),p==null||p(Se,po),we+ye>=g?we=0:we+=ye;const qt=on-wt,bt=Math.max(qt,1),nn=Ss/bt;ye=Math.ceil(ye*nn),Je<g&&Se.length<1e3&&(q.current=window.requestAnimationFrame(Qe))};G(),q.current=window.requestAnimationFrame(Qe)},[G,w.length,H,p,g]),Le=r.useCallback(()=>{var A;S==null||S(),I(void 0),oe([]),p==null||p([],-1),G(),(A=l==null?void 0:l.current)==null||A.focus()},[G,l,S,p]),lt=r.useCallback(A=>{ve(A.target.value),b===void 0&&(A.target.value===""?(I(void 0),oe([]),G()):$e(A.target.value))},[$e,G,ve,b]);r.useEffect(()=>{R.current!==null&&(ve(""),I(void 0),Z.length>0&&(oe([]),p==null||p([],-1)),y?R.current.focus({preventScroll:!0}):G())},[y,R]);const Xe=r.useCallback(A=>{var we;if((we=A==null?void 0:A.stopPropagation)==null||we.call(A),P===void 0||P.results===0)return;const re=(P.selectedIndex+1)%P.results;I({...P,selectedIndex:re}),p==null||p(se,re)},[P,p,se]),Gt=r.useCallback(A=>{var we;if((we=A==null?void 0:A.stopPropagation)==null||we.call(A),P===void 0||P.results===0)return;let re=(P.selectedIndex-1)%P.results;re<0&&(re+=P.results),I({...P,selectedIndex:re}),p==null||p(se,re)},[p,se,P]),Ye=r.useCallback(A=>{(A.ctrlKey||A.metaKey)&&A.nativeEvent.code==="KeyF"||A.key==="Escape"?(Le(),A.stopPropagation(),A.preventDefault()):A.key==="Enter"&&(A.shiftKey?Gt():Xe())},[Le,Xe,Gt]);r.useEffect(()=>()=>{G()},[G]);const[rt,go]=r.useState(!1);r.useEffect(()=>{if(y)go(!0);else{const A=setTimeout(()=>go(!1),150);return()=>clearTimeout(A)}},[y]);const mo=r.useMemo(()=>{if(!y&&!rt)return null;let A;P!==void 0&&(A=P.results>=1e3?"over 1000":`${P.results} result${P.results!==1?"s":""}`,P.selectedIndex>=0&&(A=`${P.selectedIndex+1} of ${A}`));const re=Je=>{Je.stopPropagation()},ye={width:`${g>0?Math.floor(((P==null?void 0:P.rowsSearched)??0)/g*100):0}%`};return r.createElement(xs,{className:"gdg-search-bar"+(y?"":" out"),onMouseDown:re,onMouseMove:re,onMouseUp:re,onClick:re},r.createElement("div",{className:"gdg-search-bar-inner"},r.createElement("input",{id:B,"aria-hidden":!y,"data-testid":"search-input",ref:R,onChange:lt,value:de,tabIndex:y?void 0:-1,onKeyDownCapture:Ye}),r.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!y,tabIndex:y?void 0:-1,onClick:Gt,disabled:((P==null?void 0:P.results)??0)===0},ks),r.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!y,tabIndex:y?void 0:-1,onClick:Xe,disabled:((P==null?void 0:P.results)??0)===0},Rs),S!==void 0&&r.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!y,"data-testid":"search-close-button",tabIndex:y?void 0:-1,onClick:Le},Ms)),P!==void 0?r.createElement(r.Fragment,null,r.createElement("div",{className:"gdg-search-status"},r.createElement("div",{"data-testid":"search-result-area"},A)),r.createElement("div",{className:"gdg-search-progress",style:ye})):r.createElement("div",{className:"gdg-search-status"},r.createElement("label",{htmlFor:B},"Type to search")))},[y,rt,P,g,B,R,lt,de,Ye,Gt,Xe,S,Le]);return r.createElement(r.Fragment,null,r.createElement(Ui,{prelightCells:se,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,groupLevels:t.groupLevels,groupHeaderHeights:t.groupHeaderHeights,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY,resizeIndicator:t.resizeIndicator}),mo)},Ts=()=>t=>Math.max(16,t.targetHeight-10),zs=tn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Ts(),"px"]}}),Is=t=>{const{bounds:l,group:a,onClose:g,canvasBounds:w,onFinish:R}=t,[D,b]=me.useState(a);return me.createElement(wi,{style:{position:"absolute",left:l.x-w.left+1,top:l.y-w.top,width:l.width-2,height:l.height},className:"c181oggi",onClickOutside:g},me.createElement(zs,{targetHeight:l.height,"data-testid":"group-rename-input",value:D,onBlur:g,onFocus:M=>M.target.setSelectionRange(0,D.length),onChange:M=>b(M.target.value),onKeyDown:M=>{M.key==="Enter"?R(D):M.key==="Escape"&&g()},autoFocus:!0}))},Fn=150;function Ls(t,l,a,g){var R;const w=g(l);return((R=w==null?void 0:w.measure)==null?void 0:R.call(w,t,l,a))??Fn}function Dl(t,l,a,g,w,R,D,b,M){let H=0;const p=w===void 0?[]:w.map(B=>{const Y=Ls(t,B[g],l,M);return H=Math.max(H,Y),Y});if(p.length>5&&b){H=0;let B=0;for(const U of p)B+=U;const Y=B/p.length;for(let U=0;U<p.length;U++)p[U]>=Y*2?p[U]=0:H=Math.max(H,p[U])}const y=t.font;t.font=l.headerFontFull,H=Math.max(H,t.measureText(a.title).width+l.cellHorizontalPadding*2+(a.icon===void 0?0:28)),t.font=y;const S=Math.max(Math.ceil(R),Math.min(Math.floor(D),Math.ceil(H)));return{...a,width:S}}function Ds(t,l,a,g,w,R,D,b,M){const H=r.useRef(l),p=r.useRef(a),y=r.useRef(D);H.current=l,p.current=a,y.current=D;const[S,B]=r.useMemo(()=>{if(typeof window>"u")return[null,null];const P=document.createElement("canvas");return P.style.display="none",P.style.opacity="0",P.style.position="fixed",[P,P.getContext("2d",{alpha:!1})]},[]);r.useLayoutEffect(()=>(S&&document.documentElement.append(S),()=>{S==null||S.remove()}),[S]);const Y=r.useRef({}),U=r.useRef(),[de,ve]=r.useState();return r.useLayoutEffect(()=>{const P=p.current;if(P===void 0||t.every(Zo))return;let I=Math.max(1,10-Math.floor(t.length/1e4)),Q=0;I<H.current&&I>1&&(I--,Q=1);const fe={x:0,y:0,width:t.length,height:Math.min(H.current,I)},q={x:0,y:H.current-1,width:t.length,height:1};(async()=>{const oe=P(fe,M.signal),se=Q>0?P(q,M.signal):void 0;let G;typeof oe=="object"?G=oe:G=await yl(oe),se!==void 0&&(typeof se=="object"?G=[...G,...se]:G=[...G,...await yl(se)]),U.current=t,ve(G)})()},[M.signal,t]),r.useMemo(()=>{let I=t.every(Zo)?t:B===null?t.map(Z=>Zo(Z)?Z:{...Z,width:Fn}):(B.font=y.current.baseFontFull,t.map((Z,oe)=>{if(Zo(Z))return Z;if(Y.current[Z.id]!==void 0)return{...Z,width:Y.current[Z.id]};if(de===void 0||U.current!==t||Z.id===void 0)return{...Z,width:Fn};const se=Dl(B,D,Z,oe,de,w,R,!0,b);return Y.current[Z.id]=se.width,se})),Q=0,fe=0;const q=[];for(const[Z,oe]of I.entries())Q+=oe.width,oe.grow!==void 0&&oe.grow>0&&(fe+=oe.grow,q.push(Z));if(Q<g&&q.length>0){const Z=[...I],oe=g-Q;let se=oe;for(let G=0;G<q.length;G++){const Be=q[G],$e=(I[Be].grow??0)/fe,Le=G===q.length-1?se:Math.min(se,Math.floor(oe*$e));Z[Be]={...I[Be],growOffset:Le,width:I[Be].width+Le},se-=Le}I=Z}return{sizedColumns:I,nonGrowWidth:Q}},[g,t,B,de,D,w,R,b])}function Hs(t,l){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===l.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===l.keyCode:t===l.key}function _(t,l,a){const g=Hl(t,l);return g&&(a.didMatch=!0),g}function Hl(t,l){if(t.length===0)return!1;if(t.includes("|")){const M=t.split("|");for(const H of M)if(Hl(H,l))return!0;return!1}let a=!1,g=!1,w=!1,R=!1;const D=t.split("+"),b=D.pop();if(!Hs(b,l))return!1;if(D[0]==="any")return!0;for(const M of D)switch(M){case"ctrl":a=!0;break;case"shift":g=!0;break;case"alt":w=!0;break;case"meta":R=!0;break;case"primary":en.value?R=!0:a=!0;break}return l.altKey===w&&l.ctrlKey===a&&l.shiftKey===g&&l.metaKey===R}function Fs(t,l,a,g,w,R,D){const b=me.useCallback((p,y,S,B)=>{var I;(R==="cell"||R==="multi-cell")&&p!==void 0&&(p={...p,range:{x:p.cell[0],y:p.cell[1],width:1,height:1}}),!D&&p!==void 0&&p.range.width>1&&(p={...p,range:{...p.range,width:1,x:p.cell[0]}});const Y=a==="mixed"&&(S||B==="drag")||a==="additive",U=(g==="mixed"||g==="additive")&&Y,de=S||(w==="mixed"||w==="additive")&&Y;let ve={current:p===void 0?void 0:{...p,rangeStack:B==="drag"?((I=t.current)==null?void 0:I.rangeStack)??[]:[]},columns:U?t.columns:ne.empty(),rows:de?t.rows:ne.empty()};S&&(R==="multi-rect"||R==="multi-cell")&&ve.current!==void 0&&t.current!==void 0&&(ve={...ve,current:{...ve.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),l(ve,y)},[g,t,a,R,D,w,l]),M=me.useCallback((p,y,S)=>{p=p??t.rows,y!==void 0&&(p=p.add(y));let B;if(w==="exclusive"&&p.length>0)B={current:void 0,columns:ne.empty(),rows:p};else{const Y=S&&a==="mixed"||a==="additive",U=S&&g==="mixed"||g==="additive";B={current:Y?t.current:void 0,columns:U?t.columns:ne.empty(),rows:p}}l(B,!1)},[g,t,a,w,l]),H=me.useCallback((p,y,S)=>{p=p??t.columns,y!==void 0&&(p=p.add(y));let B;if(g==="exclusive"&&p.length>0)B={current:void 0,rows:ne.empty(),columns:p};else{const Y=S&&a==="mixed"||a==="additive",U=S&&w==="mixed"||w==="additive";B={current:Y?t.current:void 0,rows:U?t.rows:ne.empty(),columns:p}}l(B,!1)},[g,t,a,w,l]);return[b,M,H]}function $s(t,l,a,g,w){const R=r.useCallback(H=>{if(t===!0){const p=[];for(let y=H.y;y<H.y+H.height;y++){const S=[];for(let B=H.x;B<H.x+H.width;B++)B<0||y>=w?S.push({kind:V.Loading,allowOverlay:!1}):S.push(l([B,y]));p.push(S)}return p}return(t==null?void 0:t(H,g.signal))??[]},[g.signal,l,t,w]),D=t!==void 0?R:void 0,b=r.useCallback(H=>{if(D===void 0)return[];const p={...H,x:H.x-a};if(p.x<0){p.x=0,p.width--;const y=D(p,g.signal);return typeof y=="function"?async()=>(await y()).map(S=>[{kind:V.Loading,allowOverlay:!1},...S]):y.map(S=>[{kind:V.Loading,allowOverlay:!1},...S])}return D(p,g.signal)},[g.signal,D,a]);return[t!==void 0?b:void 0,D]}function Tl(t){return typeof t=="string"?t:`${t}px`}const As=()=>t=>t.innerWidth,Gs=()=>t=>t.innerHeight,Ks=tn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[As()],"w2q57ts-1":[Gs()]}}),Ps=t=>{const{inWidth:l,inHeight:a,children:g,...w}=t;return r.createElement(Ks,{innerHeight:Tl(a),innerWidth:Tl(l),...w},g)},Ns=2,Ws=1300;function Vs(t,l,a){const g=me.useRef(0),[w,R]=t??[0,0];me.useEffect(()=>{if(w===0&&R===0){g.current=0;return}let D=!1,b=0;const M=H=>{var p;if(!D){if(b===0)b=H;else{const y=H-b;g.current=Math.min(1,g.current+y/Ws);const S=g.current**1.618*y*Ns;(p=l.current)==null||p.scrollBy(w*S,R*S),b=H,a==null||a()}window.requestAnimationFrame(M)}};return window.requestAnimationFrame(M),()=>{D=!0}},[l,w,R,a])}function Bs({rowHeight:t,headerHeight:l,groupHeaderHeight:a,theme:g,overscrollX:w,overscrollY:R,scaleToRem:D,remSize:b}){const[M,H,p,y,S,B]=me.useMemo(()=>{if(!D||b===16)return[t,l,a,g,w,R];const Y=b/16,U=t,de=Il();return[typeof U=="number"?U*Y:ve=>Math.ceil(U(ve)*Y),Math.ceil(l*Y),Math.ceil(a*Y),{...g,headerIconSize:((g==null?void 0:g.headerIconSize)??de.headerIconSize)*Y,cellHorizontalPadding:((g==null?void 0:g.cellHorizontalPadding)??de.cellHorizontalPadding)*Y,cellVerticalPadding:((g==null?void 0:g.cellVerticalPadding)??de.cellVerticalPadding)*Y},Math.ceil((w??0)*Y),Math.ceil((R??0)*Y)]},[a,l,w,R,b,t,D,g]);return{rowHeight:M,headerHeight:H,groupHeaderHeight:p,theme:y,overscrollX:S,overscrollY:B}}const vt={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function X(t,l){return t===!0?l:t===!1?"":t}function zl(t){const l=en.value;return{activateCell:X(t.activateCell," |Enter|shift+Enter"),clear:X(t.clear,"any+Escape"),closeOverlay:X(t.closeOverlay,"any+Escape"),acceptOverlayDown:X(t.acceptOverlayDown,"Enter"),acceptOverlayUp:X(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:X(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:X(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:X(t.delete,l?"Backspace|Delete":"Delete"),downFill:X(t.downFill,"primary+_68"),scrollToSelectedCell:X(t.scrollToSelectedCell,"primary+Enter"),goDownCell:X(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:X(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:X(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:X(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:X(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:X(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:X(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:X(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:X(t.goToFirstCell,"primary+Home"),goToFirstColumn:X(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:X(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:X(t.goToLastCell,"primary+End"),goToLastColumn:X(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:X(t.goToLastRow,"primary+ArrowDown"),goToNextPage:X(t.goToNextPage,"PageDown"),goToPreviousPage:X(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:X(t.rightFill,"primary+_82"),search:X(t.search,"primary+f"),selectAll:X(t.selectAll,"primary+a"),selectColumn:X(t.selectColumn,"ctrl+ "),selectGrowDown:X(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:X(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:X(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:X(t.selectGrowUp,"shift+ArrowUp"),selectRow:X(t.selectRow,"shift+ "),selectToFirstCell:X(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:X(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:X(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:X(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:X(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:X(t.selectToLastRow,"primary+shift+ArrowDown")}}function Us(t){const l=yi(t);return me.useMemo(()=>{if(l===void 0)return zl(vt);const a={...l,goToNextPage:(l==null?void 0:l.goToNextPage)??(l==null?void 0:l.pageDown)??vt.goToNextPage,goToPreviousPage:(l==null?void 0:l.goToPreviousPage)??(l==null?void 0:l.pageUp)??vt.goToPreviousPage,goToFirstCell:(l==null?void 0:l.goToFirstCell)??(l==null?void 0:l.first)??vt.goToFirstCell,goToLastCell:(l==null?void 0:l.goToLastCell)??(l==null?void 0:l.last)??vt.goToLastCell,selectToFirstCell:(l==null?void 0:l.selectToFirstCell)??(l==null?void 0:l.first)??vt.selectToFirstCell,selectToLastCell:(l==null?void 0:l.selectToLastCell)??(l==null?void 0:l.last)??vt.selectToLastCell};return zl({...vt,...a})},[l])}function Os(t){function l(g,w,R){if(typeof g=="number")return{headerIndex:g,isCollapsed:!1,depth:w,path:R};const D={headerIndex:g.headerIndex,isCollapsed:g.isCollapsed,depth:w,path:R};return g.subGroups!==void 0&&(D.subGroups=g.subGroups.map((b,M)=>l(b,w+1,[...R,M])).sort((b,M)=>b.headerIndex-M.headerIndex)),D}return t.map((g,w)=>l(g,0,[w])).sort((g,w)=>g.headerIndex-w.headerIndex)}function An(t,l){const a=[];function g(b,M,H=!1){let p=M!==null?M-b.headerIndex:l-b.headerIndex;if(b.subGroups!==void 0&&(p=b.subGroups[0].headerIndex-b.headerIndex),p--,a.push({rowIndex:-1,headerIndex:b.headerIndex,contentIndex:-1,skip:H,isCollapsed:b.isCollapsed,depth:b.depth,path:b.path,rows:p}),b.subGroups)for(let y=0;y<b.subGroups.length;y++){const S=y<b.subGroups.length-1?b.subGroups[y+1].headerIndex:M;g(b.subGroups[y],S,H||b.isCollapsed)}}const w=Os(t.groups);for(let b=0;b<w.length;b++){const M=b<w.length-1?w[b+1].headerIndex:null;g(w[b],M)}let R=0,D=0;for(const b of a)b.contentIndex=D,D+=b.rows,b.rowIndex=R,R+=b.isCollapsed?1:b.rows+1;return a.filter(b=>b.skip===!1).map(b=>{const{skip:M,...H}=b;return H})}function $n(t,l){if(l===void 0||An.length===0)return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1};let a=t;for(const g of l){if(a===0)return{path:[...g.path,-1],originalIndex:g.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:g.rows};if(g.isCollapsed)a--;else{if(a<=g.rows)return{path:[...g.path,a-1],originalIndex:g.headerIndex+a,isGroupHeader:!1,groupIndex:a-1,contentIndex:g.contentIndex+a-1,groupRows:g.rows};a=a-g.rows-1}}return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1}}function _s(t,l,a,g){const w=me.useMemo(()=>t===void 0?void 0:An(t,l),[t,l]),R=me.useMemo(()=>w==null?void 0:w.reduce((p,y)=>(p[y.rowIndex]=y,p),{}),[w]),D=me.useMemo(()=>w===void 0?l:w.reduce((p,y)=>p+(y.isCollapsed?1:y.rows+1),0),[w,l]),b=me.useMemo(()=>t===void 0||typeof a=="number"&&t.height===a?a:p=>R!=null&&R[p]?t.height:typeof a=="number"?a:a(p),[R,t,a]),M=me.useCallback(p=>{if(w===void 0)return p;let y=p;for(const S of w){if(y===0)return;if(y--,!S.isCollapsed){if(y<S.rows)return S.contentIndex+y;y-=S.rows}}return p},[w]),H=Ct(g??(t==null?void 0:t.themeOverride),me.useCallback(p=>{if(t===void 0)return g==null?void 0:g(p,p,p);if(g===void 0&&(t==null?void 0:t.themeOverride)===void 0)return;const{isGroupHeader:y,contentIndex:S,groupIndex:B}=$n(p,w);return y?t.themeOverride:g==null?void 0:g(p,B,S)},[w,g,t]));return t===void 0?{rowHeight:b,rows:l,rowNumberMapper:M,getRowThemeOverride:H}:{rowHeight:b,rows:D,rowNumberMapper:M,getRowThemeOverride:H}}function Xs(t,l){const a=me.useMemo(()=>t===void 0?void 0:An(t,l),[t,l]);return{getRowGroupingForPath:$l,updateRowGroupingByPath:Fl,mapper:me.useCallback(g=>{if(typeof g=="number")return $n(g,a);const w=$n(g[1],a);return{...w,originalIndex:[g[0],w.originalIndex]}},[a])}}function Fl(t,l,a){const[g,...w]=l;return w[0]===-1?t.map((R,D)=>D===g?{...R,...a}:R):t.map((R,D)=>D===g?{...R,subGroups:Fl(R.subGroups??[],w,a)}:R)}function $l(t,l){const[a,...g]=l;return g[0]===-1?t[a]:$l(t[a].subGroups??[],g)}function Ys(t,l){const[a]=r.useState(()=>({value:t,callback:l,facade:{get current(){return a.value},set current(g){const w=a.value;w!==g&&(a.value=g,a.callback(g,w))}}}));return a.callback=l,a.facade}function qs(t,l,a,g,w){const[R,D]=r.useMemo(()=>[l!==void 0&&typeof a=="number"?Math.floor(l/a):0,l!==void 0&&typeof a=="number"?-(l%a):0],[l,a]),b=r.useMemo(()=>({x:g.current.x,y:R,width:g.current.width??1,height:g.current.height??1,ty:D}),[g,D,R]),[M,H,p]=bi(b),y=r.useRef(w);y.current=w;const S=Ys(null,U=>{U!==null&&l!==void 0?U.scrollTop=l:U!==null&&t!==void 0&&(U.scrollLeft=t)}),B=(M.height??1)>1;r.useLayoutEffect(()=>{if(l!==void 0&&S.current!==null&&B){if(S.current.scrollTop===l)return;S.current.scrollTop=l,S.current.scrollTop!==l&&p(),y.current()}},[l,B,p,S]);const Y=(M.width??1)>1;return r.useLayoutEffect(()=>{if(t!==void 0&&S.current!==null&&Y){if(S.current.scrollLeft===t)return;S.current.scrollLeft=t,S.current.scrollLeft!==t&&p(),y.current()}},[t,Y,p,S]),{visibleRegion:M,setVisibleRegion:H,scrollRef:S}}const Zs=tn("textarea")({name:"GhostInputBox",class:"gxeqqyx",propsAsIs:!1}),Js=(t,l)=>{const{onInput:a,onCompositionStart:g,onCompositionEnd:w,onKeyDown:R,onKeyUp:D,onFocus:b,onBlur:M,disabled:H=!1}=t,p=r.useRef(null),y=r.useRef(!1),S=r.useRef({width:0,height:0}),B=r.useCallback(()=>{const I=p.current;if(!I||I.style.opacity==="0")return;const Q=S.current.width,fe=S.current.height;I.style.width=`${Q}px`,I.style.height=`${fe}px`;const q=Math.max(Q,I.scrollWidth+2),Z=Math.max(fe,I.scrollHeight+2);I.style.width=`${q}px`,I.style.height=`${Z}px`},[]);r.useImperativeHandle(l,()=>({focus:()=>{var I;(I=p.current)==null||I.focus({preventScroll:!0})},blur:()=>{var I;(I=p.current)==null||I.blur()},clear:()=>{p.current&&(p.current.value="",p.current.setSelectionRange(0,0))},getValue:()=>{var I;return((I=p.current)==null?void 0:I.value)??""},setValue:I=>{if(p.current){p.current.value=I;const Q=I.length;p.current.setSelectionRange(Q,Q)}},setPosition:(I,Q,fe,q)=>{const Z=p.current;Z&&(S.current={width:fe,height:q},Z.style.left=`${I}px`,Z.style.top=`${Q}px`,Z.style.width=`${fe}px`,Z.style.height=`${q}px`)},setVisible:I=>{const Q=p.current;Q&&(I?(Q.style.opacity="1",Q.style.pointerEvents="auto",Q.style.zIndex="10000"):(Q.style.left="-9999px",Q.style.top="0",Q.style.width="1px",Q.style.height="1px",Q.style.opacity="0",Q.style.pointerEvents="none",Q.style.zIndex="0"))}}));const Y=r.useCallback(I=>{const Q=I.currentTarget;a(Q.value,y.current),B()},[a,B]),U=r.useCallback(()=>{y.current=!0,g()},[g]),de=r.useCallback(I=>{y.current=!1,w(I.currentTarget.value)},[w]),ve=r.useCallback(I=>{R(I)},[R]),P=r.useCallback(I=>{D==null||D(I)},[D]);return r.createElement(Zs,{ref:p,defaultValue:"",tabIndex:H?-1:0,disabled:H,onInput:Y,onCompositionStart:U,onCompositionEnd:de,onKeyDown:ve,onKeyUp:P,onFocus:b,onBlur:M,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},Qs=r.memo(r.forwardRef(Js)),js=r.lazy(async()=>await pi(()=>import("./image-window-loader-Dk75Znu1.js").then(t=>t.$),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let ec=0;function tc(t){return Bi(El(El(t).filter(l=>l.span!==void 0).map(l=>{var a,g;return Yt((((a=l.span)==null?void 0:a[0])??0)+1,(((g=l.span)==null?void 0:g[1])??0)+1)})))}function Qo(t,l){return t===void 0||l===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+l,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+l},rangeStack:t.current.rangeStack.map(a=>({...a,x:a.x+l}))},rows:t.rows,columns:t.columns.offset(l)}}const pt={kind:V.Loading,allowOverlay:!1},Hn={columns:ne.empty(),rows:ne.empty(),current:void 0},oc=(t,l)=>{var pl,Cl,wl;const[a,g]=r.useState(Hn),[w,R]=r.useState(),D=r.useRef(null),b=r.useRef(null),[M,H]=r.useState(),p=r.useRef(void 0),y=r.useRef(null),[S,B]=r.useState(!1),Y=r.useRef(S);Y.current=S;const U=r.useRef(w);U.current=w;const de=typeof window>"u"?null:window,{imageEditorOverride:ve,getRowThemeOverride:P,markdownDivCreateNode:I,width:Q,height:fe,columns:q,rows:Z,getCellContent:oe,onCellClicked:se,onCellActivated:G,onFillPattern:Be,onFinishedEditing:$e,coercePasteValue:Le,drawHeader:lt,drawCell:Xe,editorBloom:Gt,onHeaderClicked:Ye,onColumnProposeMove:rt,rangeSelectionColumnSpanning:go=!0,spanRangeBehavior:mo="default",onGroupHeaderClicked:A,onCellContextMenu:re,className:we,onHeaderContextMenu:ye,getCellsForSelection:Je,onGroupHeaderContextMenu:Se,onGroupHeaderRenamed:Qe,onCellEdited:wt,onCellsEdited:yt,onSearchResultsChanged:je,searchResults:vo,onSearchValueChange:on,searchValue:po,onKeyDown:qt,onKeyUp:bt,keybindings:nn,editOnType:Zt=!0,onRowAppended:it,onColumnAppended:st,onColumnMoved:xt,validateCell:De,highlightRegions:He,rangeSelect:kt="rect",columnSelect:Fe="multi",rowSelect:Ae="multi",rangeSelectionBlending:Al="exclusive",columnSelectionBlending:Gl="exclusive",rowSelectionBlending:Kl="exclusive",onDelete:ln,onDragStart:Co,onMouseMove:wo,onPaste:Rt,copyHeaders:Gn=!1,freezeColumns:et=0,cellActivationBehavior:yo="second-click",rowSelectionMode:rn="auto",columnSelectionMode:Jt="auto",onHeaderMenuClick:bo,onHeaderIndicatorClick:xo,getGroupDetails:ko,rowGrouping:ct,onSearchClose:sn,onItemHovered:Ro,onSelectionCleared:at,showSearch:Pl,onVisibleRegionChanged:Mo,gridSelection:Mt,onGridSelectionChange:cn,minColumnWidth:Nl=50,maxColumnWidth:Wl=500,maxColumnAutoWidth:Vl,provideEditor:Bl,trailingRowOptions:ee,freezeTrailingRows:tt=0,allowedFillDirections:Kn="orthogonal",scrollOffsetX:Ul,scrollOffsetY:Ol,verticalBorder:Kt,onDragOverCell:_l,onDrop:Xl,onColumnResize:Qt,onColumnResizeEnd:jt,onColumnResizeStart:eo,customRenderers:So,fillHandle:Yl,experimental:he,fixedShadowX:ql,fixedShadowY:Zl,headerIcons:Jl,imageWindowLoader:Ql,initialSize:jl,isDraggable:er,onDragLeave:tr,onRowMoved:to,overscrollX:or,overscrollY:nr,preventDiagonalScrolling:lr,rightElement:rr,rightElementProps:ir,trapFocus:Pn=!1,smoothScrollX:sr,smoothScrollY:cr,scaleToRem:ar=!1,rowHeight:ur=34,headerHeight:Nn=36,groupHeaderHeight:dr=Nn,theme:fr,isOutsideClick:hr,renderers:an,resizeIndicator:gr,scrollToActiveCell:Wn=!0,drawFocusRing:Vn=!0,portalElementRef:Eo,onRowStatus:To,onRowId:zo}=t,Bn=Vn==="no-editor"?w===void 0:Vn,W=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,mr=(W==null?void 0:W.rowNumber)??!1;let Io=(W==null?void 0:W.kind)??t.rowMarkers??"none",ot=mr;(Io==="both"||Io==="checkbox-and-number")&&(Io="checkbox",ot=!0);const Ge=Io,vr=(W==null?void 0:W.width)??t.rowMarkerWidth,un=(W==null?void 0:W.startIndex)??t.rowMarkerStartIndex??1,dn=(W==null?void 0:W.theme)??t.rowMarkerTheme,fn=W==null?void 0:W.headerTheme,Un=W==null?void 0:W.headerAlwaysVisible,Lo=Ae!=="multi"||(W==null?void 0:W.headerDisabled)===!0,Pt=(W==null?void 0:W.checkboxStyle)??"square",pr=(W==null?void 0:W.rowStatus)??!1,On=(W==null?void 0:W.rowStatusWidth)??40,Do=W==null?void 0:W.rowStatusTheme,Cr=(W==null?void 0:W.rowId)??!1,_n=(W==null?void 0:W.rowIdWidth)??80,Ho=W==null?void 0:W.rowIdTheme,Nt=Math.max(Nl,20),Fo=Math.max(Wl,Nt),wr=Math.max(Vl??Fo,Nt),Xn=r.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:K,rowNumberMapper:hn,rowHeight:yr,getRowThemeOverride:nt}=_s(ct,Z,ur,P),br=r.useMemo(()=>Number.parseFloat(Xn.fontSize),[Xn]),{rowHeight:ut,headerHeight:Yn,groupHeaderHeight:gn,theme:qn,overscrollX:xr,overscrollY:kr}=Bs({groupHeaderHeight:dr,headerHeight:Nn,overscrollX:or,overscrollY:nr,remSize:br,rowHeight:yr,scaleToRem:ar,theme:fr}),dt=Us(nn),St=vr??(Z>1e4?48:Z>1e3?44:Z>100?36:32),qe=Ge!=="none",oo=pr===!0,no=Cr===!0,d=(qe?ot?2:1:0)+(oo?1:0)+(no?1:0),ce=ee!==void 0,lo=(ee==null?void 0:ee.sticky)===!0,[Rr,Zn]=r.useState(!1),Mr=Pl??Rr,Sr=r.useCallback(()=>{sn!==void 0?sn():Zn(!1)},[sn]),h=r.useMemo(()=>Mt===void 0?void 0:Qo(Mt,d),[Mt,d])??a,Ke=r.useRef(new AbortController);r.useEffect(()=>()=>Ke==null?void 0:Ke.current.abort(),[]);const[pe,Er]=$s(Je,oe,d,Ke.current,K),Tr=r.useCallback((e,o,n)=>{if(De===void 0)return!0;const i=[e[0]-d,e[1]];return De==null?void 0:De(i,o,n)},[d,De]),$o=r.useRef(Mt),Pe=r.useCallback((e,o)=>{o&&(e=xi(e,pe,d,mo,Ke.current)),cn!==void 0?($o.current=Qo(e,-d),cn($o.current)):g(e)},[cn,pe,d,mo]),Wt=Ct(Qt,r.useCallback((e,o,n,i)=>{Qt==null||Qt(q[n-d],o,n-d,i)},[Qt,d,q])),zr=Ct(jt,r.useCallback((e,o,n,i)=>{jt==null||jt(q[n-d],o,n-d,i)},[jt,d,q])),Ir=Ct(eo,r.useCallback((e,o,n,i)=>{eo==null||eo(q[n-d],o,n-d,i)},[eo,d,q])),Lr=Ct(lt,r.useCallback((e,o)=>(lt==null?void 0:lt({...e,columnIndex:e.columnIndex-d},o))??!1,[lt,d])),Dr=Ct(Xe,r.useCallback((e,o)=>(Xe==null?void 0:Xe({...e,col:e.col-d},o))??!1,[Xe,d])),ft=r.useCallback(e=>{if(ln!==void 0){const o=ln(Qo(e,-d));return typeof o=="boolean"?o:Qo(o,d)}return!0},[ln,d]),[Ce,Re,ge]=Fs(h,Pe,Al,Gl,Kl,kt,go),be=r.useMemo(()=>Ln(Il(),qn),[qn]),[mn,Hr]=r.useState([0,0,0]),Jn=r.useMemo(()=>{if(an===void 0)return{};const e={};for(const o of an)e[o.kind]=o;return e},[an]),Me=r.useCallback(e=>e.kind!==V.Custom?Jn[e.kind]:So==null?void 0:So.find(o=>o.isMatch(e)),[So,Jn]);let{sizedColumns:Ne,nonGrowWidth:Qn}=Ds(q,K,Er,mn[0]-(d===0?0:St)-mn[2],Nt,wr,be,Me,Ke.current);Ge!=="none"&&(Qn+=St);const ro=r.useMemo(()=>{let e=0;for(const o of Ne)o.group!==void 0&&(typeof o.group=="string"?e=Math.max(e,1):e=Math.max(e,o.group.length));return e},[Ne]),jn=ro>0,el=r.useMemo(()=>ro===0?[]:Array(ro).fill(gn),[ro,gn]),Fr=el.reduce((e,o)=>e+o,0),io=Yn+Fr,tl=h.rows.length,ol=Ge==="none"?void 0:tl===0?!1:tl===K?!0:void 0,J=r.useMemo(()=>{const e=[];return Ge!=="none"&&(ot&&e.push({title:"",width:St,icon:void 0,hasMenu:!1,style:"normal",themeOverride:dn,rowMarker:Pt,rowMarkerChecked:!1,headerRowMarkerTheme:fn,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),e.push({title:"",width:St,icon:void 0,hasMenu:!1,style:"normal",themeOverride:dn,rowMarker:Pt,rowMarkerChecked:ol,headerRowMarkerTheme:fn,headerRowMarkerAlwaysVisible:Un,headerRowMarkerDisabled:Lo})),oo&&e.push({title:"",width:On,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Do}),no&&e.push({title:"ID",width:_n,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Ho}),[...e,...Ne]},[oo,On,Do,no,_n,Ho,Ge,Ne,St,dn,Pt,ol,fn,Un,Lo,ot]),Ee=r.useRef({height:1,width:1,x:0,y:0}),Ao=r.useRef(!1),{setVisibleRegion:nl,visibleRegion:Et,scrollRef:te}=qs(Ul,Ol,ut,Ee,()=>Ao.current=!0);Ee.current=Et;const $r=Et.x+d,Go=Et.y,ae=r.useRef(null),xe=r.useCallback(e=>{var o;e===!0?(o=y.current)==null||o.focus():window.requestAnimationFrame(()=>{var n;(n=y.current)==null||n.focus()})},[]),ke=ce?K+1:K,Te=r.useCallback(e=>{console.log("[mangledOnCellsEdited] items:",e),console.log("[mangledOnCellsEdited] rowMarkerOffset:",d);const o=d===0?e:e.map(i=>({...i,location:[i.location[0]-d,i.location[1]]}));console.log("[mangledOnCellsEdited] mangledItems:",o),console.log("[mangledOnCellsEdited] onCellsEdited:",yt);const n=yt==null?void 0:yt(o);if(console.log("[mangledOnCellsEdited] onCellsEdited result:",n),n!==!0){console.log("[mangledOnCellsEdited] calling onCellEdited for each item, onCellEdited:",wt);for(const i of o)console.log("[mangledOnCellsEdited] calling onCellEdited with:",i.location,i.value),wt==null||wt(i.location,i.value)}return n},[wt,yt,d]),[Tt,vn]=r.useState(),Ko=h.current!==void 0&&h.current.range.width*h.current.range.height>1?h.current.range:void 0,Vt=Bn?(pl=h.current)==null?void 0:pl.cell:void 0,Po=Vt==null?void 0:Vt[0],No=Vt==null?void 0:Vt[1],Ar=r.useMemo(()=>{if((He===void 0||He.length===0)&&(Ko??Po??No??Tt)===void 0)return;const e=[];if(He!==void 0)for(const o of He){const n=J.length-o.range.x-d;n>0&&e.push({color:o.color,range:{...o.range,x:o.range.x+d,width:Math.min(n,o.range.width)},style:o.style})}return Tt!==void 0&&e.push({color:bl(be.accentColor,0),range:Tt,style:"dashed"}),Ko!==void 0&&e.push({color:bl(be.accentColor,.5),range:Ko,style:"solid-outline"}),Po!==void 0&&No!==void 0&&e.push({color:be.accentColor,range:{x:Po,y:No,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[Tt,Ko,Po,No,He,J.length,be.accentColor,d]),ll=r.useRef(J);ll.current=J;const ue=r.useCallback(([e,o],n=!1)=>{var v,C,k,x,N,F,O,E,z;const i=ce&&o===ke-1;let s=0,f=-1,u=-1,c=-1,m=-1;if(qe&&ot&&(f=s++),qe&&(u=s++),oo&&(c=s++),no&&(m=s++),e===f){if(i)return pt;const L=hn(o);return L===void 0?pt:{kind:Ht.Marker,allowOverlay:!1,checkboxStyle:Pt,checked:!1,markerKind:"number",row:un+L,drawHandle:!1,cursor:void 0,disabled:((v=t.disabledRows)==null?void 0:v.call(t,o))===!0}}if(e===u){if(i)return pt;const L=hn(o);if(L===void 0)return pt;let $;return ot?$=Ge==="checkbox-visible"?"checkbox-visible":"checkbox":Ge==="clickable-number"?$="number":$=Ge,{kind:Ht.Marker,allowOverlay:!1,checkboxStyle:Pt,checked:(h==null?void 0:h.rows.hasIndex(o))===!0,markerKind:$,row:un+L,drawHandle:to!==void 0,cursor:ot?void 0:Ge==="clickable-number"?"pointer":void 0,disabled:((C=t.disabledRows)==null?void 0:C.call(t,o))===!0}}if(e===c){if(i)return pt;const L=To==null?void 0:To(o);return{kind:Ht.RowStatus,allowOverlay:!1,status:L,themeOverride:Do}}if(e===m){if(i)return pt;const L=zo==null?void 0:zo(o);return{kind:Ht.RowId,allowOverlay:!1,rowId:L,themeOverride:Ho}}if(i){const $=e===d?(ee==null?void 0:ee.hint)??"":"",T=ll.current[e];if(((k=T==null?void 0:T.trailingRowOptions)==null?void 0:k.disabled)===!0)return pt;{const j=((x=T==null?void 0:T.trailingRowOptions)==null?void 0:x.hint)??$,ze=((N=T==null?void 0:T.trailingRowOptions)==null?void 0:N.addIcon)??(ee==null?void 0:ee.addIcon);return{kind:Ht.NewRow,hint:j,allowOverlay:!1,icon:ze}}}else{const L=e-d;if(n||(he==null?void 0:he.strict)===!0){const T=Ee.current,j=T.x>L||L>T.x+T.width||T.y>o||o>T.y+T.height||o>=yn.current,ze=L===((O=(F=T.extras)==null?void 0:F.selected)==null?void 0:O[0])&&o===((E=T.extras)==null?void 0:E.selected[1]);let Ie=!1;if(((z=T.extras)==null?void 0:z.freezeRegions)!==void 0){for(const Ve of T.extras.freezeRegions)if(ki(Ve,L,o)){Ie=!0;break}}if(j&&!ze&&!Ie)return pt}let $=oe([L,o]);return d!==0&&$.span!==void 0&&($={...$,span:[$.span[0]+d,$.span[1]+d]}),$}},[ce,ke,oo,To,Do,no,zo,Ho,qe,hn,Pt,h==null?void 0:h.rows,Ge,un,to,d,ee==null?void 0:ee.hint,ee==null?void 0:ee.addIcon,he==null?void 0:he.strict,oe,ot]),pn=r.useCallback(e=>{let o=(ko==null?void 0:ko(e))??{name:e};return Qe!==void 0&&e!==""&&(o={icon:o.icon,name:o.name,overrideTheme:o.overrideTheme,actions:[...o.actions??[],{title:"Rename",icon:"renameIcon",onClick:n=>xn({group:o.name,bounds:n.bounds})}]}),o},[ko,Qe]),Wo=r.useCallback(e=>{var c;const[o,n]=e.cell,i=J[o],s=(i==null?void 0:i.group)!==void 0?(c=pn(i.group))==null?void 0:c.overrideTheme:void 0,f=i==null?void 0:i.themeOverride,u=nt==null?void 0:nt(n);R({...e,theme:Ln(be,s,f,u,e.content.themeOverride)})},[nt,J,pn,be]),Ue=r.useCallback((e,o,n)=>{var u,c,m,v,C,k,x;if(h.current===void 0)return;const[i,s]=h.current.cell,f=ue([i,s]);if(f.kind!==V.Boolean&&f.allowOverlay){let N=f;if(n!==void 0)switch(N.kind){case V.Number:{const E=Ri(()=>n==="-"?-0:Number.parseFloat(n),0);N={...N,data:Number.isNaN(E)?0:E};break}case V.Text:case V.Markdown:case V.Uri:N={...N,data:n};break}Wo({target:e,content:N,initialValue:n,cell:[i,s],highlight:n===void 0,forceEditMode:n!==void 0,activation:o});const F=N.kind===V.Custom;n!==void 0&&!F?((u=y.current)==null||u.setPosition(e.x,e.y,e.width,e.height),n.length>0&&((c=y.current)==null||c.setValue(n)),(m=y.current)==null||m.setVisible(!0),B(!0)):F&&n!==void 0&&((v=y.current)==null||v.clear(),(C=y.current)==null||C.setVisible(!1),(k=y.current)==null||k.blur(),B(!1))}else f.kind===V.Boolean&&o.inputType==="keyboard"&&f.readonly!==!0&&(Te([{location:h.current.cell,value:{...f,data:xl(f.data)}}]),(x=ae.current)==null||x.damage([{cell:h.current.cell}]))},[ue,h,Te,Wo]),rl=r.useCallback((e,o)=>{var s;const n=(s=ae.current)==null?void 0:s.getBounds(e,o);if(n===void 0||te.current===null)return;const i=ue([e,o]);i.allowOverlay&&Wo({target:n,content:i,initialValue:void 0,highlight:!0,cell:[e,o],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[ue,te,Wo]),ie=r.useCallback((e,o,n="both",i=0,s=0,f=void 0)=>{if(te.current!==null){const u=ae.current,c=b.current,m=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,v=typeof o!="number"?o.unit==="cell"?o.amount:void 0:o,C=typeof e!="number"&&e.unit==="px"?e.amount:void 0,k=typeof o!="number"&&o.unit==="px"?o.amount:void 0;if(u!==null&&c!==null){let x={x:0,y:0,width:0,height:0},N=0,F=0;if((m!==void 0||v!==void 0)&&(x=u.getBounds((m??0)+d,v??0)??x,x.width===0||x.height===0))return;const O=c.getBoundingClientRect(),E=O.width/c.offsetWidth;if(C!==void 0&&(x={...x,x:C-O.left-te.current.scrollLeft,width:1}),k!==void 0&&(x={...x,y:k+O.top-te.current.scrollTop,height:1}),x!==void 0){const z={x:x.x-i,y:x.y-s,width:x.width+2*i,height:x.height+2*s};let L=0;for(let In=0;In<et;In++)L+=Ne[In].width;let $=0;const T=tt+(lo?1:0);T>0&&($=Mi(ke,T,ut));let j=L*E+O.left+d*St*E,ze=O.right,Ie=O.top+io*E,Ve=O.bottom-$*E;const Yo=x.width+i*2;switch(f==null?void 0:f.hAlign){case"start":ze=j+Yo;break;case"end":j=ze-Yo;break;case"center":j=Math.floor((j+ze)/2)-Yo/2,ze=j+Yo;break}const qo=x.height+s*2;switch(f==null?void 0:f.vAlign){case"start":Ve=Ie+qo;break;case"end":Ie=Ve-qo;break;case"center":Ie=Math.floor((Ie+Ve)/2)-qo/2,Ve=Ie+qo;break}j>z.x?N=z.x-j:ze<z.x+z.width&&(N=z.x+z.width-ze),Ie>z.y?F=z.y-Ie:Ve<z.y+z.height&&(F=z.y+z.height-Ve),n==="vertical"||typeof e=="number"&&e<et?N=0:(n==="horizontal"||typeof o=="number"&&o>=ke-T)&&(F=0),(N!==0||F!==0)&&(E!==1&&(N/=E,F/=E),te.current.scrollTo({left:N+te.current.scrollLeft,top:F+te.current.scrollTop,behavior:(f==null?void 0:f.behavior)??"auto"}))}}}},[d,tt,St,te,io,et,Ne,ke,lo,ut]),Cn=r.useRef(rl),wn=r.useRef(oe);Cn.current=rl,wn.current=oe;const yn=r.useRef(K);yn.current=K;const il=r.useRef(J.length);il.current=J.length;const ht=r.useCallback(async(e,o=!0,n)=>{var v;const i=J[e];if(((v=i==null?void 0:i.trailingRowOptions)==null?void 0:v.disabled)===!0)return;const s=it==null?void 0:it();let f,u=!0;s!==void 0&&(f=await s,f==="top"&&(u=!1),typeof f=="number"&&(u=!1));let c=0;const m=()=>{if(yn.current<=K){c<500&&window.setTimeout(m,c),c=50+c*2;return}const C=typeof f=="number"?f:u?K:0;Xo.current(e-d,C,"both",0,20,n?{behavior:n}:void 0),Ce({cell:[e,C],range:{x:e,y:C,width:1,height:1}},!1,!1,"edit");const k=wn.current([e-d,C]);k.allowOverlay&&Ft(k)&&k.readonly!==!0&&o&&window.setTimeout(()=>{Cn.current(e,C)},0)};m()},[J,it,d,K,Ce]),Vo=r.useCallback(async(e,o=!0)=>{const n=st==null?void 0:st();let i,s=!0;n!==void 0&&(i=await n,i==="left"&&(s=!1),typeof i=="number"&&(s=!1));let f=0;const u=()=>{if(il.current<=J.length){f<500&&window.setTimeout(u,f),f=50+f*2;return}const c=typeof i=="number"?i:s?J.length:0;ie(c-d,e),Ce({cell:[c,e],range:{x:c,y:e,width:1,height:1}},!1,!1,"edit");const m=wn.current([c-d,e]);m.allowOverlay&&Ft(m)&&m.readonly!==!0&&o&&window.setTimeout(()=>{Cn.current(c,e)},0)};u()},[J,st,d,ie,Ce]),Bt=r.useCallback(e=>{var n,i;const o=((i=(n=Ne[e])==null?void 0:n.trailingRowOptions)==null?void 0:i.targetColumn)??(ee==null?void 0:ee.targetColumn);if(typeof o=="number")return o+(qe?1:0);if(typeof o=="object"){const s=q.indexOf(o);if(s>=0)return s+(qe?1:0)}},[Ne,q,qe,ee==null?void 0:ee.targetColumn]),gt=r.useRef(void 0),Ut=r.useRef(void 0),so=r.useCallback((e,o)=>{var s;const[n,i]=o;return Ln(be,(s=J[n])==null?void 0:s.themeOverride,nt==null?void 0:nt(i),e.themeOverride)},[nt,J,be]),{mapper:zt}=Xs(ct,Z),Oe=ct==null?void 0:ct.navigationBehavior,co=r.useCallback(e=>{var v,C,k;const o=en.value?e.metaKey:e.ctrlKey,n=o&&Ae==="multi",[i,s]=e.location,f=h.columns,u=h.rows,[c,m]=((v=h.current)==null?void 0:v.cell)??[];if(e.kind==="cell"){if(Ut.current=void 0,It.current=[i,s],i===(ot?1:0)&&qe){if(ce===!0&&s===K||Ge==="number"||Ae==="none")return;const F=ue(e.location);if(F.kind!==Ht.Marker||F.disabled===!0)return;if(to!==void 0){const z=Me(F);jo((z==null?void 0:z.kind)===Ht.Marker);const L=(C=z==null?void 0:z.onClick)==null?void 0:C.call(z,{...e,cell:F,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:so(F,e.location),preventDefault:()=>{}});if(L===void 0||L.checked===F.checked)return}R(void 0),xe();const O=u.hasIndex(s),E=gt.current;if(Ae==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&E!==void 0&&u.hasIndex(E)){const z=[Math.min(E,s),Math.max(E,s)+1];n||rn==="multi"?Re(void 0,z,!0):Re(ne.fromSingleSelection(z),void 0,n)}else Ae==="multi"&&(n||e.isTouch||rn==="multi")?O?Re(u.remove(s),void 0,!0):(Re(void 0,s,!0),gt.current=s):O&&u.length===1?Re(ne.empty(),void 0,o):(Re(ne.fromSingleSelection(s),void 0,o),gt.current=s)}else if(i>=d&&ce&&s===K){const F=Bt(i);ht(F??i)}else if(c!==i||m!==s){const F=ue(e.location),O=Me(F);if((O==null?void 0:O.onSelect)!==void 0){let L=!1;if(O.onSelect({...e,cell:F,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>L=!0,theme:so(F,e.location)}),L)return}if(Oe==="block"&&zt(s).isGroupHeader)return;const E=lo&&s===K,z=lo&&h!==void 0&&((k=h.current)==null?void 0:k.cell[1])===K;if((e.shiftKey||e.isLongTouch===!0)&&c!==void 0&&m!==void 0&&h.current!==void 0&&!z){if(E)return;const L=Math.min(i,c),$=Math.max(i,c),T=Math.min(s,m),j=Math.max(s,m);Ce({...h.current,range:{x:L,y:T,width:$-L+1,height:j-T+1}},!0,o,"click"),gt.current=void 0,xe()}else{const L=h.rows.length>0;Ce({cell:[i,s],range:{x:i,y:s,width:1,height:1}},!0,o||L,"click"),gt.current=void 0,R(void 0),xe()}}}else if(e.kind==="header")if(It.current=[i,s],R(void 0),qe&&i===0)gt.current=void 0,Ut.current=void 0,!Lo&&Ae==="multi"&&(u.length!==K?Re(ne.fromSingleSelection([0,K]),void 0,o):Re(ne.empty(),void 0,o),xe());else{const x=Ut.current;if(Fe==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&x!==void 0&&f.hasIndex(x)){const N=[Math.min(x,i),Math.max(x,i)+1];o||e.isTouch||Jt==="multi"?ge(void 0,N,o):ge(ne.fromSingleSelection(N),void 0,o)}else Fe==="multi"&&(o||e.isTouch||Jt==="multi")?(f.hasIndex(i)?ge(f.remove(i),void 0,o):ge(void 0,i,o),Ut.current=i):Fe!=="none"&&(f.hasIndex(i)?ge(f.remove(i),void 0,o):ge(ne.fromSingleSelection(i),void 0,o),Ut.current=i);gt.current=void 0,xe()}else e.kind===Xt?It.current=[i,s]:e.kind===kl&&!e.isMaybeScrollbar&&(Pe(Hn,!1),R(void 0),xe(),at==null||at(),gt.current=void 0,Ut.current=void 0)},[Ae,Fe,h,qe,d,ce,K,Ge,ue,to,xe,rn,Jt,Me,so,Re,Bt,ht,Oe,zt,lo,Ce,Lo,ge,Pe,at]),ao=r.useRef(!1),It=r.useRef(void 0),sl=r.useRef(Et),We=r.useRef(void 0),Gr=r.useCallback(e=>{if(Ot.current=!1,sl.current=Ee.current,e.button!==0&&e.button!==1){We.current=void 0;return}const o=performance.now();We.current={button:e.button,time:o,location:e.location},(e==null?void 0:e.kind)==="header"&&(ao.current=!0);const n=e.kind==="cell"&&e.isFillHandle;!n&&e.kind!=="cell"&&e.isEdge||(H({previousSelection:h,fillHandle:n}),It.current=void 0,!e.isTouch&&e.button===0&&!n?co(e):!e.isTouch&&e.button===1&&(It.current=e.location))},[h,co]),[bn,xn]=r.useState(),cl=r.useCallback(e=>{if(e.kind!==Xt||Fe!=="multi")return;const o=en.value?e.metaKey:e.ctrlKey,[n,i]=e.location,s=h.columns;if(n<d)return;const f=J[n];let u=n,c=n;const m=i<=-2?-(i+2):0,v=Array.isArray(f.group)?f.group.length:1,C=(k,x)=>v>1?Ki(k,x,m,v):Pi(k,x);for(let k=n-1;k>=d&&C(f.group,J[k].group);k--)u--;for(let k=n+1;k<J.length&&C(f.group,J[k].group);k++)c++;if(xe(),o||e.isTouch||Jt==="multi")if(s.hasAll([u,c+1])){let k=s;for(let x=u;x<=c;x++)k=k.remove(x);ge(k,void 0,o)}else ge(void 0,[u,c+1],o);else ge(ne.fromSingleSelection([u,c+1]),void 0,o)},[Fe,xe,h.columns,J,d,ge,Jt]),Ot=r.useRef(!1),Bo=r.useCallback(async e=>{if(pe!==void 0&&Wt!==void 0){const o=Ee.current.y,n=Ee.current.height;let i=pe({x:e,y:o,width:1,height:Math.min(n,K-o)},Ke.current.signal);typeof i!="object"&&(i=await i());const s=Ne[e-d],u=document.createElement("canvas").getContext("2d",{alpha:!1});if(u!==null){u.font=be.baseFontFull;const c=Dl(u,be,s,0,i,Nt,Fo,!1,Me);Wt==null||Wt(s,c.width,e,c.width)}}},[Ne,pe,Fo,be,Nt,Wt,d,K,Me]),[Kr,kn]=r.useState(),_t=r.useCallback(async(e,o)=>{var c,m;const n=(c=e.current)==null?void 0:c.range;if(n===void 0||pe===void 0||o.current===void 0)return;const i=o.current.range;if(Be!==void 0){let v=!1;if(Be({fillDestination:{...i,x:i.x-d},patternSource:{...n,x:n.x-d},preventDefault:()=>v=!0}),v)return}let s=pe(n,Ke.current.signal);typeof s!="object"&&(s=await s());const f=s,u=[];for(let v=0;v<i.width;v++)for(let C=0;C<i.height;C++){const k=[i.x+v,i.y+C];if(Si(k,n))continue;const x=f[C%n.height][v%n.width];Jo(x)||!Ft(x)||u.push({location:k,value:{...x}})}Te(u),(m=ae.current)==null||m.damage(u.map(v=>({cell:v.location})))},[pe,Te,Be,d]),al=r.useCallback(()=>{if(h.current===void 0||h.current.range.width<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,width:1}}};_t(e,h)},[_t,h]),ul=r.useCallback(()=>{if(h.current===void 0||h.current.range.height<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,height:1}}};_t(e,h)},[_t,h]),Pr=r.useCallback((e,o)=>{var C,k;const n=M;if(H(void 0),vn(void 0),kn(void 0),ao.current=!1,o)return;if((n==null?void 0:n.fillHandle)===!0&&h.current!==void 0&&((C=n.previousSelection)==null?void 0:C.current)!==void 0){if(Tt===void 0)return;const x={...h,current:{...h.current,range:Ei(n.previousSelection.current.range,Tt)}};_t(n.previousSelection,x),Pe(x,!0);return}const[i,s]=e.location,[f,u]=It.current??[],c=()=>{Ot.current=!0},m=x=>{var F,O,E;const N=x.isTouch||f===i&&u===s;if(N&&(se==null||se([i-d,s],{...x,preventDefault:c})),x.button===1)return!Ot.current;if(!Ot.current){const z=ue(e.location),L=Me(z);if(L!==void 0&&L.onClick!==void 0&&N){const T=L.onClick({...x,cell:z,posX:x.localEventX,posY:x.localEventY,bounds:x.bounds,theme:so(z,e.location),preventDefault:c});T!==void 0&&!Jo(T)&&$t(T)&&(Te([{location:x.location,value:T}]),(F=ae.current)==null||F.damage([{cell:x.location}]))}if(Ot.current||h.current===void 0)return!1;let $=!1;switch(z.activationBehaviorOverride??yo){case"double-click":case"second-click":{if(((E=(O=n==null?void 0:n.previousSelection)==null?void 0:O.current)==null?void 0:E.cell)===void 0)break;const[T,j]=h.current.cell,[ze,Ie]=n.previousSelection.current.cell;$=i===T&&i===ze&&s===j&&s===Ie&&(x.isDoubleClick===!0||yo==="second-click");break}case"single-click":{$=!0;break}}if($){const j={inputType:"pointer",pointerActivation:x.isDoubleClick===!0?"double-click":z.activationBehaviorOverride??yo,pointerType:x.isTouch?"touch":"mouse"};return G==null||G([i-d,s],j),Ue(x.bounds,j),!0}}return!1},v=e.location[0]-d;if(e.isTouch){const x=Ee.current,N=sl.current;if(x.x!==N.x||x.y!==N.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&Ti((k=h.current)==null?void 0:k.cell,e.location)){re==null||re([v,e.location[1]],{...e,preventDefault:c});return}else if(e.kind==="header"&&h.columns.hasIndex(i)){ye==null||ye(v,{...e,preventDefault:c});return}else if(e.kind===Xt){if(v<0)return;Se==null||Se(v,{...e,preventDefault:c});return}}e.kind==="cell"?m(e)||co(e):e.kind===Xt?A==null||A(v,{...e,preventDefault:c}):(e.kind===zi&&(Ye==null||Ye(v,{...e,preventDefault:c})),co(e));return}if(e.kind==="header"){if(v<0)return;e.isEdge?e.isDoubleClick===!0&&Bo(i):e.button===0&&i===f&&s===u&&(Ye==null||Ye(v,{...e,preventDefault:c}))}if(e.kind===Xt){if(v<0)return;e.button===0&&i===f&&s===u&&(A==null||A(v,{...e,preventDefault:c}),Ot.current||cl(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&m(e),It.current=void 0},[M,h,d,Tt,_t,Pe,se,ue,Me,yo,so,Te,G,Ue,re,ye,Se,co,A,Ye,Bo,cl]),Nr=r.useCallback(e=>{const o={...e,location:[e.location[0]-d,e.location[1]]};wo==null||wo(o),M!==void 0&&e.buttons===0&&(H(void 0),vn(void 0),kn(void 0),ao.current=!1),kn(n=>{var i;return ao.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(n==null?void 0:n[0])&&e.scrollEdge[1]===n[1]?n:M===void 0||(((i=We.current)==null?void 0:i.location[0])??0)<d?void 0:e.scrollEdge})},[M,wo,d]),Wr=r.useCallback((e,o)=>{bo==null||bo(e-d,o)},[bo,d]),Vr=r.useCallback((e,o)=>{xo==null||xo(e-d,o)},[xo,d]);r.useEffect(()=>{if(w===void 0)return;const e=i=>{const s=[];let f=i.parentElement;for(;f&&f!==document.documentElement;){const u=window.getComputedStyle(f),c=u.overflow+u.overflowY+u.overflowX;(c.includes("scroll")||c.includes("auto"))&&s.push(f),f=f.parentElement}return s},o=i=>{const s=i.target;te.current&&!te.current.contains(s)&&R(void 0)},n=[];if(te.current){const i=e(te.current);n.push(...i)}return n.forEach(i=>{i.addEventListener("scroll",o)}),window.addEventListener("scroll",o),document.addEventListener("scroll",o,!0),()=>{n.forEach(i=>{i.removeEventListener("scroll",o)}),window.removeEventListener("scroll",o),document.removeEventListener("scroll",o,!0)}},[w,R,te]);const Ze=(Cl=h==null?void 0:h.current)==null?void 0:Cl.cell,Br=r.useCallback((e,o,n,i,s,f)=>{if(Ao.current=!1,w!==void 0){const C=Ee.current;(C.x!==e.x||C.y!==e.y)&&R(void 0)}let u=Ze;u!==void 0&&(u=[u[0]-d,u[1]]);const c=et===0?void 0:{x:0,y:e.y,width:et,height:e.height},m=[];c!==void 0&&m.push(c),tt>0&&(m.push({x:e.x-d,y:K-tt,width:e.width,height:tt}),et>0&&m.push({x:0,y:K-tt,width:et,height:tt}));const v={x:e.x-d,y:e.y,width:e.width,height:ce&&e.y+e.height>=K?e.height-1:e.height,tx:s,ty:f,extras:{selected:u,freezeRegion:c,freezeRegions:m}};Ee.current=v,nl(v),Hr([o,n,i]),Mo==null||Mo(v,v.tx,v.ty,v.extras)},[Ze,w,d,ce,K,et,tt,R,nl,Mo]),Ur=Ct(rt,r.useCallback((e,o)=>(rt==null?void 0:rt(e-d,o-d))!==!1,[rt,d])),Or=Ct(xt,r.useCallback((e,o)=>{xt==null||xt(e-d,o-d),Fe!=="none"&&ge(ne.fromSingleSelection(o),void 0,!0)},[Fe,xt,d,ge])),Rn=r.useRef(!1),_r=r.useCallback(e=>{if(e.location[0]===0&&d>0){e.preventDefault();return}Co==null||Co({...e,location:[e.location[0]-d,e.location[1]]}),e.defaultPrevented()||(Rn.current=!0),H(void 0)},[Co,d]),Xr=r.useCallback(()=>{Rn.current=!1},[]),dl=ct==null?void 0:ct.selectionBehavior,Uo=r.useCallback(e=>{if(dl!=="block-spanning")return;const{isGroupHeader:o,path:n,groupRows:i}=zt(e);if(o)return[e,e];const s=n[n.length-1],f=e-s,u=e+i-s-1;return[f,u]},[zt,dl]),Mn=r.useRef(void 0),Sn=r.useCallback(e=>{var o,n,i;if(!Ii(e,Mn.current)&&(Mn.current=e,!(((o=We==null?void 0:We.current)==null?void 0:o.button)!==void 0&&We.current.button>=1))){if(e.buttons!==0&&M!==void 0&&((n=We.current)==null?void 0:n.location[0])===0&&d===1&&Ae==="multi"&&M.previousSelection&&!M.previousSelection.rows.hasIndex(We.current.location[1])&&h.rows.hasIndex(We.current.location[1])){const s=Math.min(We.current.location[1],e.location[1]),f=Math.max(We.current.location[1],e.location[1])+1;Re(ne.fromSingleSelection([s,f]),void 0,!1)}else if(e.buttons!==0&&M!==void 0&&h.current!==void 0&&!Rn.current&&!ao.current&&(kt==="rect"||kt==="multi-rect")){const[s,f]=h.current.cell;let[u,c]=e.location;if(c<0&&(c=Ee.current.y),M.fillHandle===!0&&((i=M.previousSelection)==null?void 0:i.current)!==void 0){const m=M.previousSelection.current.range;c=Math.min(c,ce?K-1:K);const v=Li(m,u,c,Kn);vn(v)}else{if(ce&&f===K)return;if(ce&&c===K)if(e.kind===kl)c--;else return;u=Math.max(u,d);const C=Uo(f);c=C===void 0?c:At(c,C[0],C[1]);const k=u-s,x=c-f,N={x:k>=0?s:u,y:x>=0?f:c,width:Math.abs(k)+1,height:Math.abs(x)+1};Ce({...h.current,range:N},!0,!1,"drag")}}Ro==null||Ro({...e,location:[e.location[0]-d,e.location[1]]})}},[M,d,Ae,h,kt,Ro,Re,ce,K,Kn,Uo,Ce]),Yr=r.useCallback(()=>{var u,c;const e=Mn.current;if(e===void 0)return;const[o,n]=e.scrollEdge;let[i,s]=e.location;const f=Ee.current;o===-1?i=((c=(u=f.extras)==null?void 0:u.freezeRegion)==null?void 0:c.x)??f.x:o===1&&(i=f.x+f.width),n===-1?s=Math.max(0,f.y):n===1&&(s=Math.min(K-1,f.y+f.height)),i=At(i,0,J.length-1),s=At(s,0,K-1),Sn({...e,location:[i,s]})},[J.length,Sn,K]);Vs(Kr,te,Yr);const _e=r.useCallback(e=>{if(h.current===void 0)return;const[o,n]=e,[i,s]=h.current.cell,f=h.current.range;let u=f.x,c=f.x+f.width,m=f.y,v=f.y+f.height;const[C,k]=Uo(s)??[0,K-1],x=k+1;if(n!==0)switch(n){case 2:{v=x,m=s,ie(0,v,"vertical");break}case-2:{m=C,v=s+1,ie(0,m,"vertical");break}case 1:{m<s?(m++,ie(0,m,"vertical")):(v=Math.min(x,v+1),ie(0,v,"vertical"));break}case-1:{v>s+1?(v--,ie(0,v,"vertical")):(m=Math.max(C,m-1),ie(0,m,"vertical"));break}default:Rl()}if(o!==0)if(o===2)c=J.length,u=i,ie(c-1-d,0,"horizontal");else if(o===-2)u=d,c=i+1,ie(u-d,0,"horizontal");else{let N=[];if(pe!==void 0){const F=pe({x:u,y:m,width:c-u-d,height:v-m},Ke.current.signal);typeof F=="object"&&(N=tc(F))}if(o===1){let F=!1;if(u<i){if(N.length>0){const O=Yt(u+1,i+1).find(E=>!N.includes(E-d));O!==void 0&&(u=O,F=!0)}else u++,F=!0;F&&ie(u,0,"horizontal")}F||(c=Math.min(J.length,c+1),ie(c-1-d,0,"horizontal"))}else if(o===-1){let F=!1;if(c>i+1){if(N.length>0){const O=Yt(c-1,i,-1).find(E=>!N.includes(E-d));O!==void 0&&(c=O,F=!0)}else c--,F=!0;F&&ie(c-d,0,"horizontal")}F||(u=Math.max(d,u-1),ie(u-d,0,"horizontal"))}else Rl()}Ce({cell:h.current.cell,range:{x:u,y:m,width:c-u,height:v-m}},!0,!1,"keyboard-select")},[pe,Uo,h,J.length,d,K,ie,Ce]),En=r.useRef(Wn);En.current=Wn;const mt=r.useCallback((e,o,n,i)=>{const s=ke-(n?0:1);e=At(e,d,Ne.length-1+d),o=At(o,0,s);const f=Ze==null?void 0:Ze[0],u=Ze==null?void 0:Ze[1];if(e===f&&o===u)return!1;if(i&&h.current!==void 0){const c=[...h.current.rangeStack];(h.current.range.width>1||h.current.range.height>1)&&c.push(h.current.range),Pe({...h,current:{cell:[e,o],range:{x:e,y:o,width:1,height:1},rangeStack:c}},!0)}else Ce({cell:[e,o],range:{x:e,y:o,width:1,height:1}},!0,!1,"keyboard-nav");return p.current!==void 0&&p.current[0]===e&&p.current[1]===o&&(p.current=void 0),En.current&&ie(e-d,o,"both",0,20),!0},[ke,d,Ne.length,Ze,h,ie,Pe,Ce]),uo=r.useCallback((e,o)=>{var k,x,N,F,O;const n=U.current,i=Y.current;console.log("[onFinishEditing] isGhostMode:",i),console.log("[onFinishEditing] currentOverlay:",n),console.log("[onFinishEditing] ghostInputRef.current:",y.current),console.log("[onFinishEditing] ghostText:",(k=y.current)==null?void 0:k.getValue());let s=e;const f=((x=y.current)==null?void 0:x.getValue())??"";console.log("[onFinishEditing] ghostText from GhostInput:",f),console.log("[onFinishEditing] newValue:",e);const u=((N=n==null?void 0:n.content)==null?void 0:N.kind)===V.Custom;if((n==null?void 0:n.cell)!==void 0&&f.length>0&&n.content!==void 0&&!u){console.log("[onFinishEditing] Using ghostText from GhostInput (non-Custom cell)");const E=n.content;if(console.log("[onFinishEditing] cellContent.kind:",E.kind),E.kind===V.Text)s={...E,data:f,displayData:f};else if(E.kind===V.Number){const z=Number.parseFloat(f),L=Number.isNaN(z)?0:z;s={...E,data:L,displayData:L.toLocaleString()}}else E.kind===V.Uri?s={...E,data:f,displayData:f}:E.kind===V.Markdown&&(s={...E,data:f})}else u&&(console.log("[onFinishEditing] Custom cell - using newValue directly:",e),s=e);if(s!==void 0&&f.length===0)if(s.kind===V.Text&&s.data!==s.displayData)s={...s,displayData:s.data};else if(s.kind===V.Number){const E=s.data!==void 0?s.data.toLocaleString():"0";s.displayData!==E&&(s={...s,displayData:E})}else s.kind===V.Uri&&s.data!==s.displayData&&(s={...s,displayData:s.data});console.log("[onFinishEditing] finalValue:",s),console.log("[onFinishEditing] isEditableGridCell:",s!==void 0?$t(s):"N/A"),console.log("[onFinishEditing] condition check - cell:",n==null?void 0:n.cell,"finalValue:",s!==void 0,"isEditable:",s!==void 0&&$t(s));const c=n==null?void 0:n.content,m=()=>{if(s===void 0||c===void 0)return!1;if(s.kind!==c.kind)return!0;switch(s.kind){case V.Text:case V.Uri:case V.Markdown:return s.data!==c.data;case V.Number:return s.data!==c.data;case V.Boolean:return s.data!==c.data;default:return!0}};(n==null?void 0:n.cell)!==void 0&&s!==void 0&&$t(s)&&m()&&(console.log("[onFinishEditing] CALLING mangledOnCellsEdited with:",{location:n.cell,value:s}),Te([{location:n.cell,value:s}]),window.requestAnimationFrame(()=>{var E;(E=ae.current)==null||E.damage([{cell:n.cell}])})),(F=y.current)==null||F.clear(),(O=y.current)==null||O.setVisible(!1),B(!1),xe(!0),U.current=void 0,R(void 0);const[v,C]=o;if(h.current!==void 0&&(v!==0||C!==0)){const E=h.current.cell[1]===ke-1;if(E&&C===1){$e==null||$e(e,[0,0]);return}const z=h.current.cell[0]===J.length-1&&e!==void 0;let L=!0;if(E&&C===1&&it!==void 0){L=!1;const $=h.current.cell[0]+v,T=Bt($);ht(T??$,!1)}if(z&&v===1&&st!==void 0){L=!1;const $=h.current.cell[1]+C;Vo($,!1)}if(L){const $=At(h.current.cell[0]+v,d,J.length-1),T=At(h.current.cell[1]+C,0,ke-1);mt($,T,E,!1),window.requestAnimationFrame(()=>{var j;(j=y.current)==null||j.focus()})}}$e==null||$e(e,o)},[xe,h,$e,Te,ke,mt,J.length,ht,Vo,it,st,Bt,d]),qr=r.useMemo(()=>`gdg-overlay-${ec++}`,[]),Lt=r.useCallback(e=>{var n,i,s,f;xe();const o=[];for(let u=e.x;u<e.x+e.width;u++)for(let c=e.y;c<e.y+e.height;c++){const m=oe([u-d,c]);if(!m.allowOverlay&&m.kind!==V.Boolean)continue;let v;if(m.kind===V.Custom){const C=Me(m),k=(n=C==null?void 0:C.provideEditor)==null?void 0:n.call(C,{...m,location:[u-d,c]});(C==null?void 0:C.onDelete)!==void 0?v=C.onDelete(m):Di(k)&&(v=(i=k==null?void 0:k.deletedValue)==null?void 0:i.call(k,m))}else if($t(m)&&m.allowOverlay||m.kind===V.Boolean){const C=Me(m);v=(s=C==null?void 0:C.onDelete)==null?void 0:s.call(C,m)}v!==void 0&&!Jo(v)&&$t(v)&&o.push({location:[u,c],value:v})}Te(o),(f=ae.current)==null||f.damage(o.map(u=>({cell:u.location})))},[xe,oe,Me,Te,d]),fo=w!==void 0,fl=r.useCallback(e=>{var O,E,z,L;const o=()=>{e.stopPropagation(),e.preventDefault()},n={didMatch:!1},{bounds:i}=e,s=h.columns,f=h.rows,u=dt;if(!fo&&_(u.clear,e,n)){const $=((O=h.current)==null?void 0:O.cell)??[d,0];Pe({columns:ne.empty(),rows:ne.empty(),current:{cell:$,range:{x:$[0],y:$[1],width:1,height:1},rangeStack:[]}},!1),at==null||at(),xe()}else if(!fo&&_(u.selectAll,e,n))Pe({columns:ne.empty(),rows:ne.empty(),current:{cell:((E=h.current)==null?void 0:E.cell)??[d,0],range:{x:d,y:0,width:q.length,height:K},rangeStack:[]}},!1);else if(_(u.search,e,n))(z=D==null?void 0:D.current)==null||z.focus({preventScroll:!0}),Zn(!0);else if(_(u.delete,e,n)){const $=(ft==null?void 0:ft(h))??!0;if($!==!1){const T=$===!0?h:$;if(T.current!==void 0){Lt(T.current.range);for(const j of T.current.rangeStack)Lt(j)}for(const j of T.rows)Lt({x:d,y:j,width:q.length,height:1});for(const j of T.columns)Lt({x:j,y:0,width:1,height:K})}}if(n.didMatch)return o(),!0;if(h.current===void 0)return!1;let[c,m]=h.current.cell;const[,v]=h.current.cell;let C=!1,k=!1;if(_(u.scrollToSelectedCell,e,n))Xo.current(c-d,m);else if(Fe!=="none"&&_(u.selectColumn,e,n))s.hasIndex(c)?ge(s.remove(c),void 0,!0):Fe==="single"?ge(ne.fromSingleSelection(c),void 0,!0):ge(void 0,c,!0);else if(Ae!=="none"&&_(u.selectRow,e,n))f.hasIndex(m)?Re(f.remove(m),void 0,!0):Ae==="single"?Re(ne.fromSingleSelection(m),void 0,!0):Re(void 0,m,!0);else if(!fo&&i!==void 0&&_(u.activateCell,e,n))if(m===K&&ce)window.setTimeout(()=>{const $=Bt(c);ht($??c)},0);else{const $={inputType:"keyboard",key:e.key},T=ue([c,m]);console.log("[handleFixedKeybindings] activateCell triggered",{cellKind:T.kind,isBoolean:T.kind===V.Boolean,readonly:T.readonly,eventKey:e.key}),T.kind===V.Boolean&&T.readonly!==!0?(console.log("[handleFixedKeybindings] Boolean cell detected, handling Space/Enter"),G==null||G([c-d,m],$),e.key===" "?(console.log("[handleFixedKeybindings] Space key on Boolean cell - toggling value"),Te([{location:[c,m],value:{...T,data:xl(T.data)}}]),(L=ae.current)==null||L.damage([{cell:[c,m]}])):e.key==="Enter"&&(m+=1)):(G==null||G([c-d,m],$),Ue(i,$))}else h.current.range.height>1&&_(u.downFill,e,n)?ul():h.current.range.width>1&&_(u.rightFill,e,n)?al():_(u.goToNextPage,e,n)?m+=Math.max(1,Ee.current.height-4):_(u.goToPreviousPage,e,n)?m-=Math.max(1,Ee.current.height-4):_(u.goToFirstCell,e,n)?(R(void 0),m=0,c=0):_(u.goToLastCell,e,n)?(R(void 0),m=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER):_(u.selectToFirstCell,e,n)?(R(void 0),_e([-2,-2])):_(u.selectToLastCell,e,n)?(R(void 0),_e([2,2])):fo?(_(u.closeOverlay,e,n)&&R(void 0),_(u.acceptOverlayDown,e,n)&&(R(void 0),m++),_(u.acceptOverlayUp,e,n)&&(R(void 0),m--),_(u.acceptOverlayLeft,e,n)&&(R(void 0),c--),_(u.acceptOverlayRight,e,n)&&(R(void 0),c++)):(_(u.goDownCell,e,n)?m+=1:_(u.goUpCell,e,n)?m-=1:_(u.goRightCell,e,n)?c+=1:_(u.goLeftCell,e,n)?c-=1:_(u.goDownCellRetainSelection,e,n)?(m+=1,C=!0):_(u.goUpCellRetainSelection,e,n)?(m-=1,C=!0):_(u.goRightCellRetainSelection,e,n)?(c+=1,C=!0):_(u.goLeftCellRetainSelection,e,n)?(c-=1,C=!0):_(u.goToLastRow,e,n)?m=K-1:_(u.goToFirstRow,e,n)?m=Number.MIN_SAFE_INTEGER:_(u.goToLastColumn,e,n)?c=Number.MAX_SAFE_INTEGER:_(u.goToFirstColumn,e,n)?c=Number.MIN_SAFE_INTEGER:(kt==="rect"||kt==="multi-rect")&&(_(u.selectGrowDown,e,n)?_e([0,1]):_(u.selectGrowUp,e,n)?_e([0,-1]):_(u.selectGrowRight,e,n)?_e([1,0]):_(u.selectGrowLeft,e,n)?_e([-1,0]):_(u.selectToLastRow,e,n)?_e([0,2]):_(u.selectToFirstRow,e,n)?_e([0,-2]):_(u.selectToLastColumn,e,n)?_e([2,0]):_(u.selectToFirstColumn,e,n)&&_e([-2,0])),k=n.didMatch);if(Oe!==void 0&&Oe!=="normal"&&m!==v){const $=Oe==="skip-up"||Oe==="skip"||Oe==="block",T=Oe==="skip-down"||Oe==="skip"||Oe==="block",j=m<v;if(j&&$){for(;m>=0&&zt(m).isGroupHeader;)m--;m<0&&(m=v)}else if(!j&&T){for(;m<K&&zt(m).isGroupHeader;)m++;m>=K&&(m=v)}}const N=mt(c,m,!1,C),F=n.didMatch;return F&&(N||!k||Pn)&&o(),F},[Oe,fo,h,dt,Fe,Ae,kt,d,zt,K,mt,Pe,at,q.length,ft,Pn,Lt,ge,Re,ce,Bt,ht,G,Ue,ul,al,_e,ue,Te]),Dt=r.useCallback(e=>{let o=!1;if(qt!==void 0&&qt({...e,...e.location&&{location:[e.location[0]-d,e.location[1]]},cancel:()=>{o=!0}}),o||fl(e)||h.current===void 0)return;const[n,i]=h.current.cell,s=Ee.current,f=e.keyCode===229,u=Zt&&!e.metaKey&&!e.ctrlKey&&e.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(e.key);if((f||u)&&e.bounds!==void 0&&Ft(oe([n-d,Math.max(0,Math.min(i,K-1))]))){if((!ce||i!==K)&&(s.y>i||i>s.y+s.height||s.x>n||n>s.x+s.width))return;if(e.stopPropagation(),e.preventDefault(),f){const c={inputType:"keyboard",key:""};G==null||G([n-d,i],c),Ue(e.bounds,c,"")}else{const c={inputType:"keyboard",key:e.key};G==null||G([n-d,i],c),Ue(e.bounds,c,e.key)}}},[Zt,qt,fl,h,oe,d,K,ce,G,Ue]),Zr=r.useCallback((e,o)=>{var n;if(console.log("[onGhostInput] value:",e,"composing:",o,"overlay:",U.current!==void 0),U.current!==void 0){console.log("[onGhostInput] overlay already open, returning");return}if(!o&&e.length>0&&e.trim().length>0&&h.current!==void 0){const[i,s]=h.current.cell,f=ue([i,s]);if(f.kind===V.Custom){const u=f.data,c=u==null?void 0:u.kind;if(c!=="number-cell"&&c!=="date-picker-cell")return}if(f.allowOverlay&&Ft(f)&&f.readonly!==!0){const u=(n=ae.current)==null?void 0:n.getBounds(i,s);if(u!==void 0){const c={inputType:"keyboard",key:e};G==null||G([i-d,s],c),Ue(u,c,e)}}}},[h,ue,d,G,Ue]),Jr=r.useCallback(()=>{var i,s,f,u,c;if(console.log("[onGhostCompositionStart] called"),console.log("[onGhostCompositionStart] gridSelection.current:",h.current),console.log("[onGhostCompositionStart] overlayRef.current:",U.current),h.current===void 0)return;const[e,o]=h.current.cell,n=(i=U.current)==null?void 0:i.cell;if(n!==void 0&&(n[0]!==e||n[1]!==o)&&(console.log("[onGhostCompositionStart] Different cell detected, closing previous overlay"),(s=y.current)==null||s.clear(),(f=y.current)==null||f.setVisible(!1),B(!1),U.current=void 0,R(void 0)),U.current===void 0){const m=ue([e,o]);if(m.kind===V.Custom){const v=m.data,C=v==null?void 0:v.kind;if(C!=="number-cell"&&C!=="date-picker-cell")return}if(m.allowOverlay&&Ft(m)&&m.readonly!==!0){const v=(u=ae.current)==null?void 0:u.getBounds(e,o);if(v!==void 0){(c=y.current)==null||c.clear();const C={inputType:"keyboard",key:""};G==null||G([e-d,o],C),Ue(v,C,"")}}}},[h,ue,d,G,Ue]),Qr=r.useCallback(e=>{},[]),jr=r.useCallback(e=>{var f,u;if(console.log("[onGhostKeyDown] key:",e.key,"isComposing:",e.nativeEvent.isComposing),e.nativeEvent.isComposing){console.log("[onGhostKeyDown] IGNORED due to isComposing");return}if(U.current!==void 0&&Y.current){const c=e.key;if(U.current.content.kind===V.Custom){const v=e.key;(v==="Enter"||v==="Tab"||v==="Escape")&&(console.log("[onGhostKeyDown] Custom cell - preventing default for",v),e.preventDefault(),e.stopPropagation());return}if(c==="Escape"){e.preventDefault(),e.stopPropagation(),uo(void 0,[0,0]);return}if(c==="Enter"&&!e.shiftKey){e.preventDefault(),e.stopPropagation(),uo(void 0,[0,1]);return}if(c==="Tab"){e.preventDefault(),e.stopPropagation(),uo(void 0,e.shiftKey?[-1,0]:[1,0]);return}}{const c=e.key;if(c.length===1&&!e.ctrlKey&&!e.metaKey&&!e.altKey)if(c===" "&&h.current!==void 0){const v=h.current.cell,C=ue(v);if(!(C.kind===V.Boolean&&C.readonly!==!0))return}else return}if(U.current!==void 0&&Y.current){const c=e.key;if(c==="Backspace"||c==="Delete"||(c==="ArrowLeft"||c==="ArrowRight"||c==="ArrowUp"||c==="ArrowDown"||c==="Home"||c==="End"))return}const o=(f=h.current)==null?void 0:f.cell,n=o!==void 0?(u=ae.current)==null?void 0:u.getBounds(o[0],o[1]):void 0;let i=!1;const s={bounds:n,cancel:()=>{i=!0},stopPropagation:()=>e.stopPropagation(),preventDefault:()=>e.preventDefault(),ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey,key:e.key,keyCode:e.keyCode,rawEvent:e,location:o};Dt(s),i&&(e.preventDefault(),e.stopPropagation())},[h,Dt,uo,ue]),ei=r.useCallback(e=>{var s,f;const o=(s=h.current)==null?void 0:s.cell,i={bounds:o!==void 0?(f=ae.current)==null?void 0:f.getBounds(o[0],o[1]):void 0,cancel:()=>{},stopPropagation:()=>e.stopPropagation(),preventDefault:()=>e.preventDefault(),ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,altKey:e.altKey,key:e.key,keyCode:e.keyCode,rawEvent:e,location:o};bt==null||bt(i)},[h,bt]),ti=r.useCallback(()=>{zn(!0)},[]),oi=r.useCallback(()=>{zn(!1)},[]),ni=r.useCallback((e,o)=>{const n=e.location[0]-d;if(e.kind==="header"&&(ye==null||ye(n,{...e,preventDefault:o})),e.kind===Xt){if(n<0)return;Se==null||Se(n,{...e,preventDefault:o})}if(e.kind==="cell"){const[i,s]=e.location;re==null||re([n,s],{...e,preventDefault:o}),Hi(h,e.location)||mt(i,s,!1,!1)}},[h,re,Se,ye,d,mt]),Tn=r.useCallback(async e=>{var u,c,m;if(!dt.paste)return;function o(v,C,k,x){var F,O;const N=typeof k=="object"?(k==null?void 0:k.join(`
`))??"":(k==null?void 0:k.toString())??"";if(!Jo(v)&&Ft(v)&&v.readonly!==!0){const E=Le==null?void 0:Le(N,v);if(E!==void 0&&$t(E))return{location:C,value:E};const z=Me(v);if(z===void 0)return;if(z.kind===V.Custom){jo(v.kind===V.Custom);const L=(F=z.onPaste)==null?void 0:F.call(z,N,v.data);return L===void 0?void 0:{location:C,value:{...v,data:L}}}else{const L=(O=z.onPaste)==null?void 0:O.call(z,N,v,{formatted:x,formattedString:typeof x=="string"?x:x==null?void 0:x.join(`
`),rawValue:k});return L===void 0?void 0:(jo(L.kind===v.kind),{location:C,value:L})}}}const n=h.columns,i=h.rows,s=((u=te.current)==null?void 0:u.contains(document.activeElement))===!0||((c=b.current)==null?void 0:c.contains(document.activeElement))===!0;let f;if(h.current!==void 0?f=[h.current.range.x,h.current.range.y]:n.length===1?f=[n.first()??0,0]:i.length===1&&(f=[d,i.first()??0]),s&&f!==void 0){let v,C;const k="text/plain",x="text/html";if(navigator.clipboard.read!==void 0){const E=await navigator.clipboard.read();for(const z of E){if(z.types.includes(x)){const $=await(await z.getType(x)).text(),T=Ml($);if(T!==void 0){v=T;break}}z.types.includes(k)&&(C=await(await z.getType(k)).text())}}else if(navigator.clipboard.readText!==void 0)C=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(x)){const E=e.clipboardData.getData(x);v=Ml(E)}v===void 0&&e.clipboardData.types.includes(k)&&(C=e.clipboardData.getData(k))}else return;const[N,F]=f,O=[];do{if(Rt===void 0){const E=ue(f),z=C??(v==null?void 0:v.map($=>$.map(T=>T.rawValue).join("	")).join("	"))??"",L=o(E,f,z,void 0);L!==void 0&&O.push(L);break}if(v===void 0){if(C===void 0)return;v=Fi(C)}if(Rt===!1||typeof Rt=="function"&&(Rt==null?void 0:Rt([f[0]-d,f[1]],v.map(E=>E.map(z=>{var L;return((L=z.rawValue)==null?void 0:L.toString())??""}))))!==!0)return;for(const[E,z]of v.entries()){if(E+F>=K)break;for(const[L,$]of z.entries()){const T=[L+N,E+F],[j,ze]=T;if(j>=J.length||ze>=ke)continue;const Ie=ue(T),Ve=o(Ie,T,$.rawValue,$.formatted);Ve!==void 0&&O.push(Ve)}}}while(!1);Te(O),(m=ae.current)==null||m.damage(O.map(E=>({cell:E.location})))}},[Le,Me,ue,h,dt.paste,te,J.length,Te,ke,Rt,d,K]);Dn("paste",Tn,de,!1,!0);const ho=r.useCallback(async(e,o)=>{var u,c;if(!dt.copy)return;const n=o===!0||((u=te.current)==null?void 0:u.contains(document.activeElement))===!0||((c=b.current)==null?void 0:c.contains(document.activeElement))===!0,i=h.columns,s=h.rows,f=(m,v)=>{if(!Gn)Sl(m,v,e);else{const C=v.map(k=>({kind:V.Text,data:q[k].title,displayData:q[k].title,allowOverlay:!1}));Sl([C,...m],v,e)}};if(n&&pe!==void 0){if(h.current!==void 0){let m=pe(h.current.range,Ke.current.signal);typeof m!="object"&&(m=await m()),f(m,Yt(h.current.range.x-d,h.current.range.x+h.current.range.width-d))}else if(s!==void 0&&s.length>0){const v=[...s].map(C=>{const k=pe({x:d,y:C,width:q.length,height:1},Ke.current.signal);return typeof k=="object"?k[0]:k().then(x=>x[0])});if(v.some(C=>C instanceof Promise)){const C=await Promise.all(v);f(C,Yt(q.length))}else f(v,Yt(q.length))}else if(i.length>0){const m=[],v=[];for(const C of i){let k=pe({x:C,y:0,width:1,height:K},Ke.current.signal);typeof k!="object"&&(k=await k()),m.push(k),v.push(C-d)}if(m.length===1)f(m[0],v);else{const C=m.reduce((k,x)=>k.map((N,F)=>[...N,...x[F]]));f(C,v)}}}},[q,pe,h,dt.copy,d,te,K,Gn]);Dn("copy",ho,de,!1,!1);const li=r.useCallback(async e=>{var n,i;if(!(!dt.cut||!(((n=te.current)==null?void 0:n.contains(document.activeElement))===!0||((i=b.current)==null?void 0:i.contains(document.activeElement))===!0))&&(await ho(e),h.current!==void 0)){let s={current:{cell:h.current.cell,range:h.current.range,rangeStack:[]},rows:ne.empty(),columns:ne.empty()};const f=ft==null?void 0:ft(s);if(f===!1||(s=f===!0?s:f,s.current===void 0))return;Lt(s.current.range)}},[Lt,h,dt.cut,ho,te,ft]);Dn("cut",li,de,!1,!1);const ri=r.useCallback((e,o)=>{if(je!==void 0){d!==0&&(e=e.map(s=>[s[0]-d,s[1]])),je(e,o);return}if(e.length===0||o===-1)return;const[n,i]=e[o];p.current!==void 0&&p.current[0]===n&&p.current[1]===i||(p.current=[n,i],mt(n,i,!1,!1))},[je,d,mt]),[Oo,_o]=((wl=Mt==null?void 0:Mt.current)==null?void 0:wl.cell)??[],Xo=r.useRef(ie);Xo.current=ie,r.useLayoutEffect(()=>{var e,o,n,i;En.current&&!Ao.current&&Oo!==void 0&&_o!==void 0&&(Oo!==((o=(e=$o.current)==null?void 0:e.current)==null?void 0:o.cell[0])||_o!==((i=(n=$o.current)==null?void 0:n.current)==null?void 0:i.cell[1]))&&Xo.current(Oo,_o),Ao.current=!1},[Oo,_o]);const hl=h.current!==void 0&&(h.current.cell[0]>=J.length||h.current.cell[1]>=ke);r.useLayoutEffect(()=>{hl&&Pe(Hn,!1)},[hl,Pe]);const ii=r.useMemo(()=>ce===!0&&(ee==null?void 0:ee.tint)===!0?ne.fromSingleSelection(ke-1):ne.empty(),[ke,ce,ee==null?void 0:ee.tint]),si=r.useCallback(e=>typeof Kt=="boolean"?Kt:(Kt==null?void 0:Kt(e-d))??!0,[d,Kt]),ci=r.useMemo(()=>{if(bn===void 0||b.current===null)return null;const{bounds:e,group:o}=bn,n=b.current.getBoundingClientRect();return r.createElement(Is,{bounds:e,group:o,canvasBounds:n,onClose:()=>xn(void 0),onFinish:i=>{xn(void 0),Qe==null||Qe(o,i)}})},[Qe,bn]),ai=Math.min(J.length,et+d);r.useImperativeHandle(l,()=>({appendRow:(e,o)=>ht(e+d,o),appendColumn:(e,o)=>Vo(e,o),updateCells:e=>{var o;return d!==0&&(e=e.map(n=>({cell:[n.cell[0]+d,n.cell[1]]}))),(o=ae.current)==null?void 0:o.damage(e)},getBounds:(e,o)=>{var n;if(!((b==null?void 0:b.current)===null||(te==null?void 0:te.current)===null)){if(e===void 0&&o===void 0){const i=b.current.getBoundingClientRect(),s=i.width/te.current.clientWidth;return{x:i.x-te.current.scrollLeft*s,y:i.y-te.current.scrollTop*s,width:te.current.scrollWidth*s,height:te.current.scrollHeight*s}}return(n=ae.current)==null?void 0:n.getBounds((e??0)+d,o)}},focus:()=>{var e;return(e=ae.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":Dt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Dt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Dt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await ho(void 0,!0);break;case"paste":await Tn();break}},scrollTo:ie,remeasureColumns:e=>{for(const o of e)Bo(o+d)},getMouseArgsForPosition:(e,o,n)=>{if((ae==null?void 0:ae.current)===null)return;const i=ae.current.getMouseArgsForPosition(e,o,n);if(i!==void 0)return{...i,location:[i.location[0]-d,i.location[1]]}}}),[ht,Vo,Bo,te,ho,Dt,Tn,d,ie]);const[gl,ml]=Ze??[],ui=r.useCallback(e=>{const[o,n]=e;if(n===-1){Fe!=="none"&&(ge(ne.fromSingleSelection(o),void 0,!1),xe());return}gl===o&&ml===n||(Ce({cell:e,range:{x:o,y:n,width:1,height:1}},!0,!1,"keyboard-nav"),ie(o,n))},[Fe,xe,ie,gl,ml,Ce,ge]),[di,zn]=r.useState(!1),vl=r.useRef(Vi(e=>{zn(e)},5)),fi=r.useCallback(()=>{vl.current(!0),h.current===void 0&&h.columns.length===0&&h.rows.length===0&&M===void 0&&Ce({cell:[d,Go],range:{x:d,y:Go,width:1,height:1}},!0,!1,"keyboard-select")},[Go,h,M,d,Ce]),hi=r.useCallback(()=>{vl.current(!1)},[]),[gi,mi]=r.useMemo(()=>{let e;const o=(he==null?void 0:he.scrollbarWidthOverride)??$i(),n=K+(ce?1:0);if(typeof ut=="number")e=io+n*ut;else{let s=0;const f=Math.min(n,10);for(let u=0;u<f;u++)s+=ut(u);s=Math.floor(s/f),e=io+n*s}e+=o;const i=J.reduce((s,f)=>f.width+s,0)+o;return[`${Math.min(1e5,i)}px`,`${Math.min(1e5,e)}px`]},[J,he==null?void 0:he.scrollbarWidthOverride,ut,K,ce,io]),vi=r.useMemo(()=>Ai(be),[be]);return r.createElement(Gi.Provider,{value:be},r.createElement(Ps,{style:vi,className:we,inWidth:Q??gi,inHeight:fe??mi},r.createElement(Es,{fillHandle:Yl,drawFocusRing:Bn,experimental:he,fixedShadowX:ql,fixedShadowY:Zl,getRowThemeOverride:nt,headerIcons:Jl,imageWindowLoader:Ql,initialSize:jl,isDraggable:er,onDragLeave:tr,onRowMoved:to,overscrollX:xr,overscrollY:kr,preventDiagonalScrolling:lr,rightElement:rr,rightElementProps:ir,smoothScrollX:sr,smoothScrollY:cr,className:we,enableGroups:jn,onCanvasFocused:fi,onCanvasBlur:hi,canvasRef:b,onContextMenu:ni,theme:be,cellXOffset:$r,cellYOffset:Go,accessibilityHeight:Et.height,onDragEnd:Xr,columns:J,nonGrowWidth:Qn,drawHeader:Lr,onColumnProposeMove:Ur,drawCell:Dr,disabledRows:ii,freezeColumns:ai,lockColumns:d,firstColAccessible:d===0,getCellContent:ue,minColumnWidth:Nt,maxColumnWidth:Fo,searchInputRef:D,showSearch:Mr,onSearchClose:Sr,highlightRegions:Ar,getCellsForSelection:pe,getGroupDetails:pn,headerHeight:Yn,isFocused:di,groupHeaderHeight:jn?gn:0,groupLevels:ro,groupHeaderHeights:el,freezeTrailingRows:tt+(ce&&(ee==null?void 0:ee.sticky)===!0?1:0),hasAppendRow:ce,onColumnResize:Wt,onColumnResizeEnd:zr,onColumnResizeStart:Ir,onCellFocused:ui,onColumnMoved:Or,onDragStart:_r,onHeaderMenuClick:Wr,onHeaderIndicatorClick:Vr,onItemHovered:Sn,isFilling:(M==null?void 0:M.fillHandle)===!0,onMouseMove:Nr,onKeyDown:Dt,onKeyUp:bt,onMouseDown:Gr,onMouseUp:Pr,onDragOverCell:_l,onDrop:Xl,onSearchResultsChanged:ri,onVisibleRegionChanged:Br,clientSize:mn,rowHeight:ut,searchResults:vo,searchValue:po,onSearchValueChange:on,rows:ke,scrollRef:te,selection:h,translateX:Et.tx,translateY:Et.ty,verticalBorder:si,gridRef:ae,getCellRenderer:Me,resizeIndicator:gr}),ci,w!==void 0&&r.createElement(r.Suspense,{fallback:null},r.createElement(js,{...w,validateCell:Tr,bloom:Gt,id:qr,getCellRenderer:Me,className:(he==null?void 0:he.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Bl,imageEditorOverride:ve,portalElementRef:Eo,onFinishEditing:uo,markdownDivCreateNode:I,isOutsideClick:hr,customEventTarget:he==null?void 0:he.eventTarget,isGhostMode:S}))),(()=>{const e=(Eo==null?void 0:Eo.current)??document.getElementById("portal");return e===null?null:Ci.createPortal(r.createElement(Qs,{ref:y,onInput:Zr,onCompositionStart:Jr,onCompositionEnd:Qr,onKeyDown:jr,onKeyUp:ei,onFocus:ti,onBlur:oi}),e)})())},nc=r.forwardRef(oc),lc=(t,l)=>{const a=r.useMemo(()=>({...bs,...t.headerIcons}),[t.headerIcons]),g=r.useMemo(()=>t.renderers??Ni,[t.renderers]),w=r.useMemo(()=>t.imageWindowLoader??new Wi,[t.imageWindowLoader]);return r.createElement(nc,{...t,renderers:g,headerIcons:a,ref:l,imageWindowLoader:w})},gc=r.forwardRef(lc);export{gc as D,vt as k,Xs as u};
