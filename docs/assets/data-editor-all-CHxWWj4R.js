const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-D_0tbC1M.js","./iframe-WMPUn1pL.js","./preload-helper-C1FmrZbK.js","./marked.esm-09Xzqy-J.js","./react-number-format.es-DEK8veQW.js","./index-VmO6qoem.js","./throttle-Bd7MXYl9.js","./flatten-CfNc2yDy.js"])))=>i.map(i=>d[i]);
var Ia=Object.defineProperty;var Ha=(e,t,n)=>t in e?Ia(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var _e=(e,t,n)=>Ha(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as Rt}from"./iframe-WMPUn1pL.js";import{_ as rs}from"./preload-helper-C1FmrZbK.js";import{r as is}from"./index-VmO6qoem.js";import{h as Da,g as ls,j as Fa,k as Ta,v as Aa,l as Pa,m as kn,r as xo,t as za}from"./throttle-Bd7MXYl9.js";import{u as La,f as Dl}from"./flatten-CfNc2yDy.js";import{s as en,a as Ba}from"./marked.esm-09Xzqy-J.js";function ss(e="This should not happen"){throw new Error(e)}function un(e,t="Assertion failed"){if(!e)return ss(t)}function Cr(e,t){return ss(t??"Hell froze over")}function Wa(e,t){try{return e()}catch{return t}}const Fl=Object.prototype.hasOwnProperty;function jo(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&jo(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Fl.call(e,n)&&++o&&!Fl.call(t,n)||!(n in t)||!jo(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const ei=null,qi=void 0;var te;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(te||(te={}));var Tl;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(Tl||(Tl={}));var ti;(function(e){e.Triangle="triangle",e.Dots="dots"})(ti||(ti={}));function qr(e){return"width"in e&&typeof e.width=="number"}async function Al(e){return typeof e=="object"?e:await e()}function Dn(e){return!(e.kind===te.Loading||e.kind===te.Bubble||e.kind===te.RowID||e.kind===te.Protected||e.kind===te.Drilldown)}function Pf(e){return!(e.kind===te.Loading||e.kind===te.Bubble||e.kind===te.RowID||e.kind===te.Protected||e.kind===te.Drilldown||e.kind===te.Boolean||e.kind===te.Image||e.kind===te.Custom)}function So(e){return e.kind===Wt.Marker||e.kind===Wt.NewRow||e.kind===Wt.RowStatus}function ro(e){if(!Dn(e)||e.kind===te.Image)return!1;switch(e.kind){case te.Text:case te.Number:case te.Markdown:case te.Uri:case te.Custom:case te.Boolean:return e.readonly!==!0;default:Cr(e,"A cell was passed with an invalid kind")}}function as(e){return Da(e,"editor")}function ji(e){return!(e.readonly??!1)}var Wt;(function(e){e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id"})(Wt||(Wt={}));const ni={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Ai(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let Pl;const ln=class ln{constructor(t){_e(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new ln(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Ai([...this.items,n]);return new ln(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,c]of n.entries()){const[l,d]=c;if(l<=r&&o<=d){const f=[];l<o&&f.push([l,o]),r<d&&f.push([r,d]),n.splice(i,1,...f)}}return new ln(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};_e(ln,"create",t=>new ln(Ai(t))),_e(ln,"empty",()=>Pl??(Pl=new ln([]))),_e(ln,"fromSingleSelection",t=>ln.empty().add(t)),_e(ln,"fromArray",t=>{if(t.length===0)return ln.empty();const n=t.map(r=>[r,r+1]),o=Ai(n);return new ln(o)});let st=ln;const Oa=en("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Qt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const c=n,l=d=>{var f;(f=i.current)==null||f.call(c,d)};return c.addEventListener(e,l,{passive:o,capture:r}),()=>{c.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function io(e,t){return e===void 0?void 0:t}const $a=Math.PI;function zl(e){return e*$a/180}const cs=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ds=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},us=(e,t,n)=>Math.min(e,t-n*2),fs=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Zi=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Na=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Ga(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const c=s.useRef(ls(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&c.current(()=>e())},t),o}const Xa="֑-߿יִ-﷽ﹰ-ﻼ",Ya="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",Ka=new RegExp("^[^"+Ya+"]*["+Xa+"]");function Ji(e){return Ka.test(e)?"rtl":"not-rtl"}let jr;function Gi(){if(typeof document>"u")return 0;if(jr!==void 0)return jr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),jr=n-o,jr}const ko=Symbol();function _a(e){const t=s.useRef([ko,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const d=t.current[0];d!==ko&&(l=typeof l=="function"?l(d):l,l===d)||(d!==ko&&r({}),o(f=>typeof l=="function"?l(d===ko?f:d):l),t.current[0]=ko)},[]),c=s.useCallback(()=>{t.current[0]=ko,r({})},[]);return[t.current[0]===ko?n:t.current[0],i,c]}function hs(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Va(e){const t=s.useRef(e);return jo(e,t.current)||(t.current=e),t.current}const Ua=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const c=i.length>1;return s.createElement(Oa,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(Fa.Carousel,{showArrows:c,showThumbs:!1,swipeable:c,emulateTouch:c,infiniteLoop:c},i.map(l=>{const d=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},d)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Zi,null)))},qa=en("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class ja extends Rt.PureComponent{constructor(){super(...arguments);_e(this,"targetElement",null);_e(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,c=Ba(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let d=i==null?void 0:i(c);if(d===void 0){const u=document.createElement("template");u.innerHTML=c,d=u.content}n.append(d);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Rt.createElement(qa,{ref:this.containerRefHook})}}const Za=en("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Ja=en("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),Qa=en("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});class gs extends s.PureComponent{constructor(){super(...arguments);_e(this,"wrapperRef",s.createRef());_e(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const Pi={};let to=null;function ec(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Zo(e){const t=e.toLowerCase().trim();if(Pi[t]!==void 0)return Pi[t];to=to||ec(),to.style.color="#000",to.style.color=t;const n=getComputedStyle(to).color;to.style.color="#fff",to.style.color=t;const o=getComputedStyle(to).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),Pi[t]=r,r}function ao(e,t){const[n,o,r]=Zo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const Ll=new Map;function Bl(e,t){const n=`${e}-${t}`,o=Ll.get(n);if(o!==void 0)return o;const r=fn(e,t);return Ll.set(n,r),r}function fn(e,t){if(t===void 0)return e;const[n,o,r,i]=Zo(e);if(i===1)return e;const[c,l,d,f]=Zo(t),u=i+f*(1-i),m=(i*n+f*c*(1-i))/u,g=(i*o+f*l*(1-i))/u,w=(i*r+f*d*(1-i))/u;return`rgba(${m}, ${g}, ${w}, ${u})`}function zf(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,c]=Zo(e),[l,d,f,u]=Zo(t),m=o*c,g=r*c,w=i*c,h=l*u,p=d*u,C=f*u,x=n,y=1-n,k=c*y+u*x;if(k===0)return"rgba(0, 0, 0, 0)";const I=Math.floor((m*y+h*x)/k),G=Math.floor((g*y+p*x)/k),F=Math.floor((w*y+C*x)/k);return`rgba(${I}, ${G}, ${F}, ${k})`}function Lf(e){if(e==="transparent")return 0;function t(i){const c=i/255;return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const[n,o,r]=Zo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function ms(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ws={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function ps(){return ws}const Qi=Rt.createContext(ws);function Bf(){return Rt.useContext(Qi)}function Bn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=fn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const tc=()=>e=>e.targetX,nc=()=>e=>e.targetY,oc=()=>e=>e.targetWidth,rc=()=>e=>e.targetHeight,ic=()=>e=>e.targetY+10,lc=()=>e=>Math.max(0,(e.targetHeight-28)/2),sc=en("div")({name:"DataGridOverlayEditorStyle",class:"gdg-d19meir1",propsAsIs:!1,vars:{"d19meir1-0":[nc(),"px"],"d19meir1-1":[tc(),"px"],"d19meir1-2":[oc(),"px"],"d19meir1-3":[rc(),"px"],"d19meir1-4":[ic(),"px"],"d19meir1-5":[lc(),"px"]}});function ac(){const[e,t]=s.useState();return[e??void 0,t]}function cc(){const[e,t]=ac(),[n,o]=s.useState(0),[r,i]=s.useState(!0);s.useLayoutEffect(()=>{if(e===void 0||!("IntersectionObserver"in window))return;const l=new IntersectionObserver(d=>{d.length!==0&&i(d[0].isIntersecting)},{threshold:1});return l.observe(e),()=>l.disconnect()},[e]),s.useEffect(()=>{if(r||e===void 0)return;let l;const d=()=>{const{right:f}=e.getBoundingClientRect();o(u=>Math.min(u+window.innerWidth-f-10,0)),l=requestAnimationFrame(d)};return l=requestAnimationFrame(d),()=>{l!==void 0&&cancelAnimationFrame(l)}},[e,r]);const c=s.useMemo(()=>({transform:`translateX(${n}px)`}),[n]);return{ref:t,style:c}}const Qo=s.createContext({isGhostMode:!1,ghostValue:""}),dc=e=>{const{target:t,content:n,onFinishEditing:o,forceEditMode:r,initialValue:i,imageEditorOverride:c,markdownDivCreateNode:l,highlight:d,className:f,theme:u,id:m,cell:g,bloom:w,portalElementRef:h,validateCell:p,getCellRenderer:C,provideEditor:x,isOutsideClick:y,customEventTarget:k,activation:I,ghostValue:G,isGhostMode:F}=e,[H,D]=s.useState(r?n:void 0),E=s.useRef(H??n);E.current=H??n;const[O,$]=s.useState(()=>p===void 0?!0:!(Dn(n)&&(p==null?void 0:p(g,n,E.current))===!1)),T=s.useCallback((ie,Me)=>{o(O?ie:void 0,Me)},[O,o]),W=s.useCallback(ie=>{if(p!==void 0&&ie!==void 0&&Dn(ie)){const Me=p(g,ie,E.current);Me===!1?$(!1):(typeof Me=="object"&&(ie=Me),$(!0))}D(ie)},[g,p]),B=s.useRef(!1),J=s.useRef(void 0),Q=s.useCallback(()=>{T(H,[0,0]),B.current=!0},[H,T]),pe=s.useCallback((ie,Me)=>{T(ie,Me??J.current??[0,0]),B.current=!0},[T]),be=s.useCallback(async ie=>{if(ie.nativeEvent.isComposing)return;let Me=!1;ie.key==="Escape"?(ie.stopPropagation(),ie.preventDefault(),J.current=[0,0]):ie.key==="Enter"&&!ie.shiftKey?(ie.stopPropagation(),ie.preventDefault(),J.current=[0,1],Me=!0):ie.key==="Tab"&&(ie.stopPropagation(),ie.preventDefault(),J.current=[ie.shiftKey?-1:1,0],Me=!0),window.setTimeout(()=>{!B.current&&J.current!==void 0&&(T(Me?H:void 0,J.current),B.current=!0)},0)},[T,H]),ye=H??n,[Z,q]=s.useMemo(()=>{var Qe,ft;if(So(n))return[];const ie={...n,location:g,activation:I},Me=x==null?void 0:x(ie);return Me!==void 0?[Me,!1]:[(ft=(Qe=C(n))==null?void 0:Qe.provideEditor)==null?void 0:ft.call(Qe,ie),!1]},[g,n,C,x,I]),{ref:ae,style:ve}=cc();let we=!0,ce,fe=!0,re;if(Z!==void 0){we=Z.disablePadding!==!0,fe=Z.disableStyling!==!0;const ie=as(Z);ie&&(re=Z.styleOverride);const Me=ie?Z.editor:Z;ce=s.createElement(Me,{portalElementRef:h,isHighlighted:d,activation:I,onChange:W,value:ye,initialValue:i,onFinishedEditing:pe,validatedSelection:Dn(ye)?ye.selectionRange:void 0,forceEditMode:r,target:t,imageEditorOverride:c,markdownDivCreateNode:l,isValid:O,theme:u})}re={...re,...ve};const U=(h==null?void 0:h.current)??document.getElementById("portal");if(U===null)return console.error('Cannot open Data Grid overlay editor, because portal not found. Please, either provide a portalElementRef or add `<div id="portal" />` as the last child of your `<body>`.'),null;let ke=fe?"gdg-style":"gdg-unstyle";O||(ke+=" gdg-invalid"),we&&(ke+=" gdg-pad");const ue=(w==null?void 0:w[0])??1,Be=(w==null?void 0:w[1])??1,Ge=s.useMemo(()=>({isGhostMode:F??!1,ghostValue:G??""}),[F,G]);return is.createPortal(s.createElement(Qi.Provider,{value:u},s.createElement(Qo.Provider,{value:Ge},s.createElement(gs,{style:ms(u),className:f,onClickOutside:Q,isOutsideClick:y,customEventTarget:k},s.createElement(sc,{ref:ae,id:m,className:ke,style:F?{...re,visibility:"hidden"}:re,as:q===!0?"label":void 0,targetX:t.x-ue,targetY:t.y-Be,targetWidth:t.width+ue*2,targetHeight:t.height+Be*2},s.createElement("div",{className:"gdg-clip-region",onKeyDown:be},ce))))),U)},uc=Object.freeze(Object.defineProperty({__proto__:null,GhostModeContext:Qo,default:dc},Symbol.toStringTag,{value:"Module"}));let Wl=0;const el=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:c,autoFocus:l,...d}=e,{onChange:f,className:u}=d,m=s.useRef(null),{isGhostMode:g,ghostValue:w}=s.useContext(Qo),h=g&&w?w:n??"";un(f!==void 0,"GrowingEntry must be a controlled input area");const[p]=s.useState(()=>"input-box-"+(Wl=(Wl+1)%1e7));s.useEffect(()=>{if(g)return;const y=m.current;if(y===null||y.disabled)return;const k=h.toString().length;y.focus(),y.setSelectionRange(r?0:k,k)},[g]),s.useLayoutEffect(()=>{var y;if(c!==void 0){const k=typeof c=="number"?[c,null]:c;(y=m.current)==null||y.setSelectionRange(k[0],k[1])}},[c]);const C=s.useCallback(y=>{y.key==="Enter"&&y.shiftKey&&i===!0||o==null||o(y)},[i,o]),x=g?{visibility:"hidden"}:void 0;return s.createElement(Qa,{className:"gdg-growing-entry"},s.createElement(Ja,{className:u},h+`
`),s.createElement(Za,{...d,className:(u??"")+" gdg-input",id:p,ref:m,onKeyDown:C,value:h,placeholder:t,dir:"auto",style:x}))};function fc(e,t){return Rt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function hc(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(yr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function Mo(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Xi(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function bs(e,t){const n=Mo(e),o=Mo(t);return n===o}function oi(e,t,n,o){for(let r=0;r<=n;r++){const i=Xi(e,r,o)??"",c=Xi(t,r,o)??"";if(i!==c)return!1}return!0}function gc(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function ys(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function yr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function vs(e){return[e.x+e.width-1,e.y+e.height-1]}function Ol(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,c=n.y+n.height-1,[l,d]=e;if(d<i||d>c)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function mc(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&Ol(e,t,i)&&r++;for(const c of n.current.rangeStack)Ol(e,t,c)&&r++;return r}function Cs(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,c)=>({...i,sticky:e[c].sticky})),n=o}return n}function Jo(e,t){let n=0;const o=Cs(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function Eo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Yi(e,t,n,o,r){const i=Cs(e,o),c=[];for(const f of i)if(f.sticky)c.push(f);else break;if(c.length>0)for(const f of c)n-=f.width;let l=t,d=r??0;for(;d<=n&&l<i.length;)d+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||c.push(u)}return c}function wc(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function pc(e,t,n,o,r,i,c,l,d,f,u,m){const g=u??(n?1:0),w=m??(n?[r]:[]),h=w.reduce((k,I)=>k+I,0),p=o+h;if(n&&g>0){let k=0;for(let I=0;I<g;I++)if(k+=w[I]??0,e<=k)return-(I+2)}if(e<=p)return-1;let C=t;for(let k=0;k<f;k++){const I=i-1-k,G=typeof c=="number"?c:c(I);if(C-=G,e>=C)return I}const x=i-f,y=e-(d??0);if(typeof c=="number"){const k=Math.floor((y-p)/c)+l;return k>=x?void 0:k}else{let k=p;for(let I=l;I<x;I++){const G=c(I);if(y<=k+G)return I;k+=G}return}}let Qr=0,vr={};const bc=typeof window>"u";async function yc(){var e;bc||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Qr=0,vr={},Aa())}yc();function ks(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Ro(e,t,n,o="middle"){const r=ks(e,t,o,n);let i=vr[r];return i===void 0&&(i=t.measureText(e),vr[r]=i,Qr++),Qr>1e4&&(vr={},Qr=0),i}function xs(e,t){const n=ks(e,void 0,"middle",t);return vr[n]}function hn(e,t){return typeof t!="string"&&(t=t.baseFontFull),vc(e,t)}function $l(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Nl=[];function vc(e,t){for(const i of Nl)if(i.key===t)return i.val;const n=$l(e,"alphabetic"),r=-($l(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Nl.push({key:t,val:r}),r}function Cc(e,t,n,o,r,i){const{ctx:c,rect:l,theme:d}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const m=1-f/u;c.globalAlpha=m,c.fillStyle=d.bgSearchResult,c.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),c.globalAlpha=1,o!==void 0&&(o.fillStyle=d.bgSearchResult)}return f<u}function ai(e,t,n){const{ctx:o,theme:r}=e,i=t??{},c=n??r.textDark;return c!==i.fillStyle&&(o.fillStyle=c,i.fillStyle=c),i}function Wf(e,t,n,o,r){const{rect:i,ctx:c,theme:l}=e;c.fillStyle=l.textDark,Kn({ctx:c,rect:i,theme:l},t,n,o,r)}function Ss(e,t,n,o,r,i,c,l,d){d==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+c):d==="center"?e.fillText(t,n+r/2,o+i/2+c):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+c)}function Ms(e,t){const n=Ro("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function kc(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function xc(e,t,n,o,r,i,c,l,d,f){const u=l.baseFontFull,m=Ta(e,t,u,r-l.cellHorizontalPadding*2,f??!1),g=Ms(e,u),w=l.lineHeight*g,h=g+w*(m.length-1),p=h+l.cellVerticalPadding>i;p&&(e.save(),e.rect(n,o,r,i),e.clip());const C=o+i/2-h/2;let x=Math.max(o+l.cellVerticalPadding,C);for(const y of m)if(Ss(e,y,n,x,r,g,c,l,d),x+=w,x>o+i)break;p&&e.restore()}function Kn(e,t,n,o,r){const{ctx:i,rect:c,theme:l}=e,{x:d,y:f,width:u,height:m}=c;o=o??!1,o||(t=kc(t,u));const g=hn(i,l),w=Ji(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?xc(i,t,d,f,u,m,g,l,n,r):Ss(i,t,d,f,u,m,g,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function Wn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Sc(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Mc(e,t,n){const o=function(l,d){const f=d.x-l.x,u=d.y-l.y,m=Math.sqrt(f*f+u*u),g=f/m,w=u/m;return{x:f,y:d.y-l.y,len:m,nx:g,ny:w,ang:Math.atan2(w,g)}};let r;const i=t.length;let c=t[i-1];for(let l=0;l<i;l++){let d=t[l%i];const f=t[(l+1)%i],u=o(d,c),m=o(d,f),g=u.nx*m.ny-u.ny*m.nx,w=u.nx*m.nx-u.ny*-m.ny;let h=Math.asin(g<-1?-1:g>1?1:g),p=1,C=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,p=-1,C=!0):h>0&&(p=-1,C=!0),r=d.radius!==void 0?d.radius:n;const x=h/2;let y=Math.abs(Math.cos(x)*r/Math.sin(x)),k;y>Math.min(u.len/2,m.len/2)?(y=Math.min(u.len/2,m.len/2),k=Math.abs(y*Math.sin(x)/Math.cos(x))):k=r;let I=d.x+m.nx*y,G=d.y+m.ny*y;I+=-m.ny*k*p,G+=m.nx*k*p,e.arc(I,G,k,u.ang+Math.PI/2*p,m.ang-Math.PI/2*p,C),c=d,d=f}e.closePath()}function Ki(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,C){const x={x:0,y:i+f,width:0,height:0},y=p??(r>0?1:0),k=-(y+1);if(e>=w.length||t>=u||t<k||e<0)return x;const I=C??(r>0?[r]:[]),G=I.reduce((H,D)=>H+D,0),F=i-G;if(e>=m){const H=c>e?-1:1,D=Jo(w);x.x+=D+d;for(let E=c;E!==e;E+=H)x.x+=w[H===1?E:E-1].width*H}else for(let H=0;H<e;H++)x.x+=w[H].width;if(x.width=w[e].width+1,t===-1)x.y=G,x.height=F;else if(t<=-2){const H=-(t+2);let D=0;for(let W=0;W<H;W++)D+=I[W]??0;x.y=D,x.height=I[H]??r;let E=e;const O=w[e].group,$=w[e].sticky;for(;E>0&&oi(w[E-1].group,O,H,y)&&w[E-1].sticky===$;){const W=w[E-1];x.x-=W.width,x.width+=W.width,E--}let T=e;for(;T+1<w.length&&oi(w[T+1].group,O,H,y)&&w[T+1].sticky===$;){const W=w[T+1];x.width+=W.width,T++}if(!$){const W=Jo(w),B=x.x-W;B<0&&(x.x-=B,x.width+=B),x.x+x.width>n&&(x.width=n-x.x)}}else if(t>=u-g){let H=u-t;for(x.y=o;H>0;){const D=t+H-1;x.height=typeof h=="number"?h:h(D),x.y-=x.height,H--}x.height+=1}else{const H=l>t?-1:1;if(typeof h=="number"){const D=t-l;x.y+=D*h}else for(let D=l;D!==t;D+=H)x.y+=h(D)*H;x.height=(typeof h=="number"?h:h(t))+1}return x}const tl=1<<21;function Tn(e,t){return(t+2)*tl+e}function Es(e){return e%tl}function nl(e){return Math.floor(e/tl)-2}function ol(e){const t=Es(e),n=nl(e);return[t,n]}class Rs{constructor(){_e(this,"visibleWindow",{x:0,y:0,width:0,height:0});_e(this,"freezeCols",0);_e(this,"freezeRows",[]);_e(this,"isInWindow",t=>{const n=Es(t),o=nl(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,c=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&c})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&jo(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Ec extends Rs{constructor(){super(...arguments);_e(this,"cache",new Map);_e(this,"setValue",(n,o)=>{this.cache.set(Tn(n[0],n[1]),o)});_e(this,"getValue",n=>this.cache.get(Tn(n[0],n[1])));_e(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class qo{constructor(t=[]){_e(this,"cells");this.cells=new Set(t.map(n=>Tn(n[0],n[1])))}add(t){this.cells.add(Tn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(Tn(t[0],t[1]))}remove(t){this.cells.delete(Tn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(nl(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(Tn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield ol(t)}}const _i=150;function Rc(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??_i}function Is(e,t,n,o,r,i,c,l,d){let f=0;const u=r===void 0?[]:r.map(w=>{const h=Rc(e,w[o],t,d);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let w=0;for(const p of u)w+=p;const h=w/u.length;for(let p=0;p<u.length;p++)u[p]>=h*2?u[p]=0:f=Math.max(f,u[p])}const m=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=m;const g=Math.max(Math.ceil(i),Math.min(Math.floor(c),Math.ceil(f)));return{...n,width:g}}function Ic(e,t,n,o,r,i,c,l,d){const f=s.useRef(t),u=s.useRef(n),m=s.useRef(c);f.current=t,u.current=n,m.current=c;const[g,w]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const y=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",[y,y.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(g&&document.documentElement.append(g),()=>{g==null||g.remove()}),[g]);const h=s.useRef({}),p=s.useRef(),[C,x]=s.useState();return s.useLayoutEffect(()=>{const y=u.current;if(y===void 0||e.every(qr))return;let k=Math.max(1,10-Math.floor(e.length/1e4)),I=0;k<f.current&&k>1&&(k--,I=1);const G={x:0,y:0,width:e.length,height:Math.min(f.current,k)},F={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const D=y(G,d.signal),E=I>0?y(F,d.signal):void 0;let O;typeof D=="object"?O=D:O=await Al(D),E!==void 0&&(typeof E=="object"?O=[...O,...E]:O=[...O,...await Al(E)]),p.current=e,x(O)})()},[d.signal,e]),s.useMemo(()=>{let k=e.every(qr)?e:w===null?e.map(H=>qr(H)?H:{...H,width:_i}):(w.font=m.current.baseFontFull,e.map((H,D)=>{if(qr(H))return H;if(h.current[H.id]!==void 0)return{...H,width:h.current[H.id]};if(C===void 0||p.current!==e||H.id===void 0)return{...H,width:_i};const E=Is(w,c,H,D,C,r,i,!0,l);return h.current[H.id]=E.width,E})),I=0,G=0;const F=[];for(const[H,D]of k.entries())I+=D.width,D.grow!==void 0&&D.grow>0&&(G+=D.grow,F.push(H));if(I<o&&F.length>0){const H=[...k],D=o-I;let E=D;for(let O=0;O<F.length;O++){const $=F[O],T=(k[$].grow??0)/G,W=O===F.length-1?E:Math.min(E,Math.floor(D*T));H[$]={...k[$],growOffset:W,width:k[$].width+W},E-=W}k=H}return{sizedColumns:k,nonGrowWidth:I}},[o,e,w,C,c,r,i,l])}const Ct='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Hc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Dc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Fc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Tc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ac=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Hs=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Pc=e=>{const t=e.bgColor;return`${Ct}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},zc=Hs,Lc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Bc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Wc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Oc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},$c=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Nc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Gc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Xc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Yc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},Kc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},_c=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Vc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},Uc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},qc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},jc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Zc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},Jc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},Qc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},ed=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},td=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},nd=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},od=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),rd=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),id={headerRowID:Hc,headerNumber:Fc,headerCode:Dc,headerString:Tc,headerBoolean:Ac,headerAudioUri:zc,headerVideoUri:Lc,headerEmoji:Bc,headerImage:Wc,headerUri:Hs,headerPhone:Oc,headerMarkdown:$c,headerDate:Nc,headerTime:Gc,headerEmail:Xc,headerReference:Yc,headerIfThenElse:Kc,headerSingleValue:_c,headerLookup:Vc,headerTextTemplate:Uc,headerMath:qc,headerRollup:jc,headerJoinStrings:Zc,headerSplitString:Jc,headerGeoDistance:Qc,headerArray:ed,rowOwnerOverlay:td,protectedColumnOverlay:nd,renameIcon:Pc,headerArrowDown:od,headerArrowUp:rd};function ld(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class sd{constructor(t,n){_e(this,"onSettled");_e(this,"spriteMap",new Map);_e(this,"headerIcons");_e(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,c,l,d=1){const[f,u]=ld(n,l),m=c*Math.ceil(window.devicePixelRatio),g=`${f}_${u}_${m}_${t}`;let w=this.spriteMap.get(g);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const p=w.getContext("2d");if(p===null)return;const C=new Image;C.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(g,w);const x=C.decode();if(x===void 0)return;this.inFlight++,x.then(()=>{p.drawImage(C,0,0,m,m)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else d<1&&(o.globalAlpha=d),o.drawImage(w,0,0,m,m,r,i,c,c),d<1&&(o.globalAlpha=1)}}function Ds(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function ci(e,t,n,o,r,i,c,l,d){l=l??t;let f=t,u=e;const m=o-i;let g=!1;for(;f<n&&u<m;){const w=r(u);if(f+w>l&&d(f,u,w,!1,c&&u===o-1)===!0){g=!0;break}f+=w,u++}if(!g){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,d(f,u,h,!0,c&&u===o-1)}}}function co(e,t,n,o,r,i){let c=0,l=0;const d=r+o;for(const f of e){const u=f.sticky?l:c+n;if(i(f,u,d,f.sticky?0:l,t)===!0)break;c+=f.width,l+=f.sticky?f.width:0}}function ad(e,t,n,o,r){let i=0,c=0;for(let l=0;l<e.length;l++){const d=e[l];let f=l+1,u=d.width;for(d.sticky&&(c+=u);f<e.length&&bs(e[f].group,d.group)&&e[f].sticky===e[l].sticky;){const p=e[f];u+=p.width,f++,l++,p.sticky&&(c+=p.width)}const m=d.sticky?0:n,g=i+m,w=d.sticky?0:Math.max(0,c-g),h=Math.min(u-w,t-(g+w));r([d.sourceIndex,e[f-1].sourceIndex],Mo(d.group),g+w,0,h,o),i+=u}}function cd(e,t,n,o,r,i){if(r===0)return;const c=[];let l=0;for(let u=0;u<r;u++)c.push(l),l+=o[u]??0;const d=[];let f=0;for(const u of e)d.push(f),f+=u.width;for(let u=0;u<r;u++){const m=c[u],g=o[u]??0;let w=0,h=0;for(;h<e.length;){const p=e[h],C=Xi(p.group,u,r);if(C===void 0){p.sticky&&(w+=p.width),h++;continue}const x=d[h];let y=h+1,k=p.width;for(p.sticky&&(w+=p.width);y<e.length;){const D=e[y],E=oi(D.group,p.group,u,r),O=D.sticky===p.sticky;if(!E||!O)break;k+=D.width,D.sticky&&(w+=D.width),y++}const I=p.sticky?0:n,G=x+I,F=p.sticky?0:Math.max(0,w-G),H=Math.min(k-F,t-(G+F));H>0&&i([p.sourceIndex,e[y-1].sourceIndex],C,G+F,m,H,g,u),h=y}}}function Fs(e,t,n,o,r,i,c){var g;const[l,d]=e;let f,u;const m=((g=c.find(w=>!w.sticky))==null?void 0:g.sourceIndex)??0;if(d>m){const w=Math.max(l,m);let h=t,p=o;for(let C=i.sourceIndex-1;C>=w;C--)h-=c[C].width,p+=c[C].width;for(let C=i.sourceIndex+1;C<=d;C++)p+=c[C].width;u={x:h,y:n,width:p,height:r}}if(m>l){const w=Math.min(d,m-1);let h=t,p=o;for(let C=i.sourceIndex-1;C>=l;C--)h-=c[C].width,p+=c[C].width;for(let C=i.sourceIndex+1;C<=w;C++)p+=c[C].width;f={x:h,y:n,width:p,height:r}}return[f,u]}function dd(e,t,n,o){if(o==="any")return Ts(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),ys([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,c=n-e.y+1,l=e.y+e.height-n,d=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:c,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return d===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:d===c?{x:e.x,y:n,width:e.width,height:e.y-n}:d===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function kr(e,t,n,o,r,i,c,l){return e<=r+c&&r<=e+n&&t<=i+l&&i<=t+o}function so(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Ts(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function ud(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function fd(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,c=t+4,l=n+4,d=r-e.x,f=e.x+e.width-c,u=i-e.y,m=e.y+e.height-l,g=d>0?e.x+Math.floor(d/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,p=m>0?e.y+e.height-Math.floor(m/o)*o:e.y+e.height;return{x:g,y:h,width:w-g,height:p-h}}function hd(e,t,n,o,r){const[i,c,l,d]=t,[f,u,m,g]=r,{x:w,y:h,width:p,height:C}=e,x=[];if(p<=0||C<=0)return x;const y=w+p,k=h+C,I=w<i,G=h<c,F=w+p>l,H=h+C>d,D=w>=i&&w<l||y>i&&y<=l||w<i&&y>l,E=h>=c&&h<d||k>c&&k<=d||h<c&&k>d;if(D&&E){const $=Math.max(w,i),T=Math.max(h,c),W=Math.min(y,l),B=Math.min(k,d);x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:f,y:u,width:m-f+1,height:g-u+1}})}if(I&&G){const $=w,T=h,W=Math.min(y,i),B=Math.min(k,c);x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:0,y:0,width:f+1,height:u+1}})}if(G&&D){const $=Math.max(w,i),T=h,W=Math.min(y,l),B=Math.min(k,c);x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:f,y:0,width:m-f+1,height:u+1}})}if(G&&F){const $=Math.max(w,l),T=h,W=y,B=Math.min(k,c);x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:m,y:0,width:n-m+1,height:u+1}})}if(I&&E){const $=w,T=Math.max(h,c),W=Math.min(y,i),B=Math.min(k,d);x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:0,y:u,width:f+1,height:g-u+1}})}if(F&&E){const $=Math.max(w,l),T=Math.max(h,c),W=y,B=Math.min(k,d);x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:m,y:u,width:n-m+1,height:g-u+1}})}if(I&&H){const $=w,T=Math.max(h,d),W=Math.min(y,i),B=k;x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:0,y:g,width:f+1,height:o-g+1}})}if(H&&D){const $=Math.max(w,i),T=Math.max(h,d),W=Math.min(y,l),B=k;x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:f,y:g,width:m-f+1,height:o-g+1}})}if(F&&H){const $=Math.max(w,l),T=Math.max(h,d),W=y,B=k;x.push({rect:{x:$,y:T,width:W-$,height:B-T},clip:{x:m,y:g,width:n-m+1,height:o-g+1}})}return x}const gd={kind:te.Loading,allowOverlay:!1};function Gl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,C,x,y,k,I,G,F,H,D,E,O,$,T,W,B,J,Q,pe,be){let ye=(k==null?void 0:k.size)??Number.MAX_SAFE_INTEGER;const Z=performance.now();let q=W.baseFontFull;e.font=q;const ae={ctx:e},ve=[0,0],we=C>0?Eo(d,C,f):0;let ce,fe;const re=new qo,U=new Set,ke=Ds(y);if(co(t,l,i,c,r,(ue,Be,Ge,ie,Me)=>{const Qe=Math.max(0,ie-Be),ft=Be+Qe,We=r+1,It=ue.width-Qe,xe=o-r-1;if(y.length>0){let Ye=!1;for(let tt=0;tt<y.length;tt++){const at=y[tt];if(kr(ft,We,It,xe,at.x,at.y,at.width,at.height)){Ye=!0;break}}if(!Ye)return}const He=()=>{e.save(),e.beginPath(),e.rect(ft,We,It,xe),e.clip()},he=I.columns.hasIndex(ue.sourceIndex),Fe=m(Mo(ue.group)).overrideTheme,ze=ue.themeOverride===void 0&&Fe===void 0?W:Bn(W,Fe,ue.themeOverride),Xe=ze.baseFontFull;Xe!==q&&(q=Xe,e.font=Xe),He();let $e;return ci(Me,Ge,o,d,f,C,x,ke,(Ye,tt,at,Yt,_)=>{var an,Ke,Gt;if(tt<0)return;if(ve[0]=ue.sourceIndex,ve[1]=tt,re.has(ve)){ye--;return}if(k!==void 0&&!k.has(ve))return;if(y.length>0){let Te=!1;for(let ct=0;ct<y.length;ct++){const dt=y[ct];if(kr(Be,Ye,ue.width,at,dt.x,dt.y,dt.width,dt.height)){Te=!0;break}}if(!Te)return}const mt=I.rows.hasIndex(tt),nt=w.hasIndex(tt),me=tt<d?u(ve):gd;let ot=Be,ht=ue.width,Ze=Ye,qe=at,kt=!1,Nt=!1;if(me.rowspan!==void 0){const[Te,ct]=me.rowspan,dt=`${ue.sourceIndex}|${Te}`;if(U.has(dt)){ye--;return}else{let At=Ye;for(let Oe=Te;Oe<tt;Oe++)At-=f(Oe);let qt=0;for(let Oe=Te;Oe<ct;Oe++)qt+=f(Oe);if(At<We+xe&&At+qt>We){Ze=At,qe=qt,U.add(dt);for(let Oe=Te;Oe<ct;Oe++)Oe!==tt&&re.add([ue.sourceIndex,Oe]);kt=!0}else{U.add(dt);for(let Oe=Te;Oe<ct;Oe++)re.add([ue.sourceIndex,Oe]);ye--;return}}}if(me.span!==void 0){const[Te,ct]=me.span,dt=`${tt},${Te},${ct},${ue.sticky}`;if(fe===void 0&&(fe=new Set),fe.has(dt)){ye--;return}else{const At=Fs(me.span,Be,Ye,ue.width,at,ue,n),qt=ue.sticky?At[0]:At[1];!ue.sticky&&At[0]!==void 0&&(Nt=!0),qt!==void 0&&(ot=qt.x,ht=qt.width,fe.add(dt),kt=!0)}}if(kt){e.restore(),$e=void 0,e.save(),e.beginPath();const Te=Math.max(0,ie-ot);e.rect(ot+Te,Ze,ht-Te,qe),ce===void 0&&(ce=[]),ce.push({x:ot+Te,y:Ze,width:ht-Te,height:qe}),e.clip()}const Ot=g==null?void 0:g(tt),Bt=_&&((an=ue.trailingRowOptions)==null?void 0:an.themeOverride)!==void 0?(Ke=ue.trailingRowOptions)==null?void 0:Ke.themeOverride:void 0,Dt=me.themeOverride===void 0&&Ot===void 0&&Bt===void 0?ze:Bn(ze,Ot,Bt,me.themeOverride);e.beginPath();const Vt=gc(ve,me,I);let Ht=mc(ve,me,I,p);const On=me.span!==void 0&&I.columns.some(Te=>me.span!==void 0&&Te>=me.span[0]&&Te<=me.span[1]);Vt&&!h&&p?Ht=0:Vt&&p&&(Ht=Math.max(Ht,1)),On&&Ht++,Vt||(mt&&Ht++,he&&!_&&Ht++);const gn=me.kind===te.Protected?Dt.bgCellMedium:Dt.bgCell;let rt;if((Yt||gn!==W.bgCell)&&(rt=fn(gn,rt)),Ht>0||nt){nt&&(rt=fn(Dt.bgHeader,rt));for(let Te=0;Te<Ht;Te++)rt=fn(Dt.accentLight,rt)}else if(G!==void 0){for(const Te of G)if(Te[0]===ue.sourceIndex&&Te[1]===tt){rt=fn(Dt.bgSearchResult,rt);break}}if(F!==void 0)for(let Te=0;Te<F.length;Te++){const ct=F[Te],dt=ct.range;ct.style!=="solid-outline"&&dt.x<=ue.sourceIndex&&ue.sourceIndex<dt.x+dt.width&&dt.y<=tt&&tt<dt.y+dt.height&&(rt=fn(ct.color,rt))}let xn=!1;if(k!==void 0){const Te=Ye+1,dt=(Yt?Te+at-1:Math.min(Te+at-1,o-we))-Te;(dt!==at-1||ot+1<=ie)&&(xn=!0,e.save(),e.beginPath(),e.rect(ot+1,Te,ht-1,dt),e.clip()),rt=rt===void 0?Dt.bgCell:fn(rt,Dt.bgCell)}const gt=ue.sourceIndex===n.length-1,Ut=tt===d-1;rt!==void 0&&(e.fillStyle=rt,$e!==void 0&&($e.fillStyle=rt),k!==void 0?e.fillRect(ot+1,Ze+1,ht-(gt?2:1),qe-(Ut?2:1)):e.fillRect(ot,Ze,ht,qe)),me.style==="faded"&&(e.globalAlpha=.6);let sn;for(let Te=0;Te<E.length;Te++){const ct=E[Te];if(ct.item[0]===ue.sourceIndex&&ct.item[1]===tt){sn=ct;break}}if(ht>be&&!Nt){const Te=Dt.baseFontFull;Te!==q&&(e.font=Te,q=Te);let ct=0;if(me.rowspan!==void 0){const dt=me.rowSpanPosition??"top";if(dt==="top")ct=at/2-qe/2;else if(dt==="bottom"){const[At,qt]=me.rowspan,Oe=f(qt-1);ct=qe/2-Oe/2}}$e=As(e,me,ue.sourceIndex,tt,gt,Ut,ot,Ze,ht,qe,Ht>0,Dt,rt??Dt.bgCell,H,D,(sn==null?void 0:sn.hoverAmount)??0,O,T,Z,$,$e,B,J,Q,pe,ct)}return xn&&e.restore(),me.style==="faded"&&(e.globalAlpha=1),ye--,kt&&(e.restore(),(Gt=$e==null?void 0:$e.deprep)==null||Gt.call($e,ae),$e=void 0,He(),q=Xe,e.font=Xe),ye<=0}),e.restore(),ye<=0}),ce!==void 0)return ce}const mr=[0,0],wr={x:0,y:0,width:0,height:0},zi=[void 0,()=>{}];let Vi=!1;function md(){Vi=!0}function As(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,C,x,y,k,I,G,F,H,D,E){var Q,pe;let O,$;C!==void 0&&C[0][0]===n&&C[0][1]===o&&(O=C[1][0],$=C[1][1]);let T;mr[0]=n,mr[1]=o,wr.x=c,wr.y=l,wr.width=d,wr.height=f,zi[0]=F.getValue(mr),zi[1]=be=>F.setValue(mr,be),Vi=!1;const W={ctx:e,theme:m,col:n,row:o,cell:t,rect:wr,highlighted:u,cellFillColor:g,hoverAmount:p,frameTime:y,hoverX:O,drawState:zi,hoverY:$,imageLoader:w,spriteManager:h,hyperWrapping:x,overrideCursor:O!==void 0?D:void 0,requestAnimationFrame:md},B=Cc(W,t.lastUpdated,y,I,r,i),J=H(t);if(J!==void 0){(I==null?void 0:I.renderer)!==J&&((Q=I==null?void 0:I.deprep)==null||Q.call(I,W),I=void 0);const be=(pe=J.drawPrep)==null?void 0:pe.call(J,W,I);e.save(),e.translate(0,E),k!==void 0&&!So(W.cell)?k(W,()=>J.draw(W,t)):J.draw(W,t),e.restore(),T=be===void 0?void 0:{deprep:be==null?void 0:be.deprep,fillStyle:be==null?void 0:be.fillStyle,font:be==null?void 0:be.font,renderer:J}}return(B||Vi)&&(G==null||G(mr)),T}function ri(e,t,n,o,r,i,c,l,d=-20,f=-20,u=void 0,m="center",g="square",w=!1){const h=Math.floor(r+c/2),p=g==="circle"?1e4:t.roundingRadius??4;let C=us(u??t.checkboxMaxSize,c,t.cellVerticalPadding),x=C/2;const y=ds(m,o,i,t.cellHorizontalPadding,C),k=cs(y,h,C),I=fs(o+d,r+f,k);switch(n){case!0:{e.beginPath(),Wn(e,y-C/2,h-C/2,C,C,p),g==="circle"&&(x*=.8,C*=.8),e.fillStyle=w?t.bgCellMedium:l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(y-x+C/4.23,h-x+C/1.97),e.lineTo(y-x+C/2.42,h-x+C/1.44),e.lineTo(y-x+C/1.29,h-x+C/3.25),e.strokeStyle=w?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case ei:case!1:{e.beginPath(),Wn(e,y-C/2+.5,h-C/2+.5,C-1,C-1,p),e.lineWidth=1,e.strokeStyle=w?t.textLight:I?t.textDark:t.textMedium,e.stroke();break}case qi:{e.beginPath(),Wn(e,y-C/2,h-C/2,C,C,p),e.fillStyle=w?t.bgCellMedium:I?t.textMedium:t.textLight,e.fill(),g==="circle"&&(x*=.8,C*=.8),e.beginPath(),e.moveTo(y-C/3,h),e.lineTo(y+C/3,h),e.strokeStyle=w?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Cr()}}function wd(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,C,x,y,k,I,G){var J,Q,pe,be;const F=I??(o?1:0),H=G??(o?[d]:[]),D=H.reduce((ye,Z)=>ye+Z,0),E=l+D;if(E<=0)return;e.fillStyle=g.bgHeader,x!==void 0&&o&&(I??1)>1?e.fillRect(0,D,i,l):e.fillRect(0,0,i,E);const O=(J=r==null?void 0:r[0])==null?void 0:J[0],$=(Q=r==null?void 0:r[0])==null?void 0:Q[1],T=(pe=r==null?void 0:r[1])==null?void 0:pe[0],W=(be=r==null?void 0:r[1])==null?void 0:be[1],B=g.headerFontFull;e.font=B,co(t,0,c,0,E,(ye,Z,q,ae)=>{var Me;if(x!==void 0&&!x.has([ye.sourceIndex,-1]))return;const ve=Math.max(0,ae-Z);e.save(),e.beginPath(),e.rect(Z+ve,D,ye.width-ve,l),e.clip();const we=C(Mo(ye.group)).overrideTheme,ce=ye.themeOverride===void 0&&we===void 0?g:Bn(g,we,ye.themeOverride);ce.bgHeader!==g.bgHeader&&(e.fillStyle=ce.bgHeader,e.fill()),ce!==g&&(e.font=ce.headerFontFull);const fe=m.columns.hasIndex(ye.sourceIndex),re=f!==void 0||u||ye.headerRowMarkerDisabled===!0,U=!re&&$===-1&&O===ye.sourceIndex,ke=re?0:((Me=h.find(Qe=>Qe.item[0]===ye.sourceIndex&&Qe.item[1]===-1))==null?void 0:Me.hoverAmount)??0,ue=(m==null?void 0:m.current)!==void 0&&m.current.cell[0]===ye.sourceIndex,Be=fe?ce.accentColor:ue?ce.bgHeaderHasFocus:ce.bgHeader,Ge=o?D:0,ie=ye.sourceIndex===0?0:1;fe?(e.fillStyle=Be,e.fillRect(Z+ie,Ge,ye.width-ie,l)):(ue||ke>0)&&(e.beginPath(),e.rect(Z+ie,Ge,ye.width-ie,l),ue&&(e.fillStyle=ce.bgHeaderHasFocus,e.fill()),ke>0&&(e.globalAlpha=ke,e.fillStyle=ce.bgHeaderHovered,e.fill(),e.globalAlpha=1)),zs(e,Z,Ge,ye.width,l,ye,fe,ce,U,U?T:void 0,U?W:void 0,ue,ke,w,y,k),e.restore()}),o&&(F>1?bd(e,t,i,c,H,F,r,g,w,h,p,C,x):pd(e,t,i,c,d,r,g,w,h,p,C,x)),o&&(I??1)>1&&(e.beginPath(),e.moveTo(0,D+.5),e.lineTo(i,D+.5),e.strokeStyle=g.borderColor,e.lineWidth=1,e.stroke())}function pd(e,t,n,o,r,i,c,l,d,f,u,m){const[w,h]=(i==null?void 0:i[0])??[];let p=0;ad(t,n,o,r,(C,x,y,k,I,G)=>{if(m!==void 0&&!m.hasItemInRectangle({x:C[0],y:-2,width:C[1]-C[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,k,I,G),e.clip();const F=u(x),H=(F==null?void 0:F.overrideTheme)===void 0?c:Bn(c,F.overrideTheme),D=h===-2&&w!==void 0&&w>=C[0]&&w<=C[1],E=D?H.bgGroupHeaderHovered??H.bgHeaderHovered:H.bgGroupHeader??H.bgHeader;if(E!==c.bgHeader&&(e.fillStyle=E,e.fill()),e.fillStyle=H.textGroupHeader??H.textHeader,F!==void 0){let O=y;if(F.icon!==void 0&&(l.drawSprite(F.icon,"normal",e,O+8,(r-20)/2,20,H),O+=26),e.fillText(F.name,O+8,r/2+hn(e,c.headerFontFull)),F.actions!==void 0&&D){const $=rl({x:y,y:k,width:I,height:G},F.actions);e.beginPath();const T=$[0].x-10,W=y+I-T;e.rect(T,0,W,r);const B=e.createLinearGradient(T,0,T+W,0),J=ao(E,0);B.addColorStop(0,J),B.addColorStop(10/W,E),B.addColorStop(1,E),e.fillStyle=B,e.fill(),e.globalAlpha=.6;const[Q,pe]=(i==null?void 0:i[1])??[-1,-1];for(let be=0;be<F.actions.length;be++){const ye=F.actions[be],Z=$[be],q=so(Z,Q+y,pe);q&&(e.globalAlpha=1),l.drawSprite(ye.icon,"normal",e,Z.x+Z.width/2-10,Z.y+Z.height/2-10,20,H),q&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&f(C[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.strokeStyle=c.borderColor,e.lineWidth=1,e.stroke()),e.restore(),p=y+I}),e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=c.borderColor,e.lineWidth=1,e.stroke()}function bd(e,t,n,o,r,i,c,l,d,f,u,m,g){const[w,h]=(c==null?void 0:c[0])??[];e.font=l.headerFontFull;const p=r.reduce((x,y)=>x+y,0);g===void 0&&(e.fillStyle=l.bgHeader,e.fillRect(0,0,n,p));let C=0;if(cd(t,n,o,r,i,(x,y,k,I,G,F,H)=>{const D=-(H+2);if(g!==void 0&&!g.hasItemInRectangle({x:x[0],y:D,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(k,I,G,F),e.clip();const E=m(y),O=(E==null?void 0:E.overrideTheme)===void 0?l:Bn(l,E.overrideTheme),$=h===D&&w!==void 0&&w>=x[0]&&w<=x[1],T=$?O.bgGroupHeaderHovered??O.bgHeaderHovered:O.bgGroupHeader??O.bgHeader;e.fillStyle=T,e.fillRect(k,I,G,F),e.fillStyle=O.textGroupHeader??O.textHeader;const W=(E==null?void 0:E.name)??y,J=e.measureText(W).width,Q=(E==null?void 0:E.icon)!==void 0?26:0,pe=Q+J,be=k+(G-pe)/2;if((E==null?void 0:E.icon)!==void 0&&d.drawSprite(E.icon,"normal",e,be,I+(F-20)/2,20,O),e.fillText(W,be+Q,I+F/2+hn(e,l.headerFontFull)),E!==void 0&&E.actions!==void 0&&$){const ye=rl({x:k,y:I,width:G,height:F},E.actions);e.beginPath();const Z=ye[0].x-10,q=k+G-Z;e.rect(Z,I,q,F);const ae=e.createLinearGradient(Z,0,Z+q,0),ve=ao(T,0);ae.addColorStop(0,ve),ae.addColorStop(10/q,T),ae.addColorStop(1,T),e.fillStyle=ae,e.fill(),e.globalAlpha=.6;const[we,ce]=(c==null?void 0:c[1])??[-1,-1];for(let fe=0;fe<E.actions.length;fe++){const re=E.actions[fe],U=ye[fe],ke=so(U,we+k,ce);ke&&(e.globalAlpha=1),d.drawSprite(re.icon,"normal",e,U.x+U.width/2-10,U.y+U.height/2-10,20,O),ke&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=l.borderColor,e.lineWidth=1,k!==0&&u(x[0])&&(e.beginPath(),e.moveTo(k+.5,I),e.lineTo(k+.5,I+F),e.stroke()),(H<i-1||g===void 0)&&(e.beginPath(),e.moveTo(k,I+F+.5),e.lineTo(k+G,I+F+.5),e.stroke()),e.restore(),C=Math.max(C,k+G)}),g===void 0){e.beginPath(),e.moveTo(C+.5,0),e.lineTo(C+.5,p);let x=0;for(let y=0;y<i-1;y++)x+=r[y],e.moveTo(0,x+.5),e.lineTo(n,x+.5);e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}}const Zr=30;function yd(e,t,n,o,r){return{x:e+n-Zr,y:Math.max(t,t+o/2-Zr/2),width:Zr,height:Math.min(Zr,o)}}function rl(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,c=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:c,height:i}),o+=26;return n}function pr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Ps(e,t,n,o,r,i,c,l){var H;const d=c.cellHorizontalPadding,f=c.headerIconSize,u=yd(n,o,r,i);let m=n+d;const g=t.icon===void 0?void 0:{x:m,y:o+(i-f)/2,width:f,height:f},w=g===void 0||t.overlayIcon===void 0?void 0:{x:g.x+9,y:g.y+6,width:18,height:18};g!==void 0&&(m+=Math.ceil(f*1.3));const h=e===void 0?((H=xs(t.title,c.headerFontFull))==null?void 0:H.width)??0:Ro(t.title,e,c.headerFontFull).width,p=t.hasMenu===!0?35:0,C=t.indicatorIcon!==void 0?f+d:0,x=h+C,y=r-(g!==void 0?Math.ceil(f*1.3)+d:d)-p-d,k=n+(g!==void 0?Math.ceil(f*1.3)+d:d)+(y-x)/2,I={x:Math.max(m,k),y:o,width:h,height:i};let G;t.indicatorIcon!==void 0&&(G={x:I.x+h+d,y:o+(i-f)/2,width:f,height:f});const F=n+r/2;return{menuBounds:pr(u,F,l),iconBounds:pr(g,F,l),iconOverlayBounds:pr(w,F,l),textBounds:pr(I,F,l),indicatorIconBounds:pr(G,F,l)}}function Xl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const y=i.rowMarkerChecked;y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=m);const k=i.headerRowMarkerTheme!==void 0?Bn(l,i.headerRowMarkerTheme):l;ri(e,k,y,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const C=c?l.textHeaderSelected:l.textHeader,x=i.hasMenu===!0&&(d||w&&c)&&p.menuBounds!==void 0;if(i.icon!==void 0&&p.iconBounds!==void 0){let y=c?"selected":"normal";i.style==="highlight"&&(y=c?"selected":"special"),g.drawSprite(i.icon,y,e,p.iconBounds.x,p.iconBounds.y,p.iconBounds.width,l),i.overlayIcon!==void 0&&p.iconOverlayBounds!==void 0&&g.drawSprite(i.overlayIcon,c?"selected":"special",e,p.iconOverlayBounds.x,p.iconOverlayBounds.y,p.iconOverlayBounds.width,l)}if(x&&o>35){const k=h?35:o-35,I=h?35*.7:o-35*.7,G=k/o,F=I/o,H=e.createLinearGradient(t,0,t+o,0),D=ao(C,0);H.addColorStop(h?1:0,C),H.addColorStop(G,C),H.addColorStop(F,D),H.addColorStop(h?0:1,D),e.fillStyle=H}else e.fillStyle=C;if(h&&(e.textAlign="right"),p.textBounds!==void 0&&e.fillText(i.title,h?p.textBounds.x+p.textBounds.width:p.textBounds.x,n+r/2+hn(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&p.indicatorIconBounds!==void 0&&(!x||!kr(p.menuBounds.x,p.menuBounds.y,p.menuBounds.width,p.menuBounds.height,p.indicatorIconBounds.x,p.indicatorIconBounds.y,p.indicatorIconBounds.width,p.indicatorIconBounds.height))){let y=c?"selected":"normal";i.style==="highlight"&&(y=c?"selected":"special"),g.drawSprite(i.indicatorIcon,y,e,p.indicatorIconBounds.x,p.indicatorIconBounds.y,p.indicatorIconBounds.width,l)}if(x&&p.menuBounds!==void 0){const y=p.menuBounds,k=f!==void 0&&u!==void 0&&so(y,f+t,u+n);if(k||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===ti.Triangle){e.beginPath();const I=y.x+y.width/2-5.5,G=y.y+y.height/2-3;Mc(e,[{x:I,y:G},{x:I+11,y:G},{x:I+5.5,y:G+6}],1),e.fillStyle=C,e.fill()}else if(i.menuIcon===ti.Dots){e.beginPath();const I=y.x+y.width/2,G=y.y+y.height/2;Sc(e,I,G),e.fillStyle=C,e.fill()}else{const I=y.x+(y.width-l.headerIconSize)/2,G=y.y+(y.height-l.headerIconSize)/2;g.drawSprite(i.menuIcon,"normal",e,I,G,l.headerIconSize,l)}k||(e.globalAlpha=1)}}function zs(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p){const C=Ji(i.title)==="rtl",x=Ps(e,i,t,n,o,r,l,C);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:c,hoverAmount:g,isHovered:d,hasSelectedCell:m,spriteManager:w,menuBounds:(x==null?void 0:x.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>Xl(e,t,n,o,r,i,c,l,d,f,u,g,w,p,C,x)):Xl(e,t,n,o,r,i,c,l,d,f,u,g,w,p,C,x)}function vd(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,C,x,y){if(x!==void 0||t[t.length-1]!==n[t.length-1])return;const k=Ds(C);co(t,d,c,l,i,(I,G,F,H,D)=>{if(I!==t[t.length-1])return;G+=I.width;const E=Math.max(G,H);E>o||(e.save(),e.beginPath(),e.rect(E,i+1,1e4,r-i-1),e.clip(),ci(D,F,r,f,u,h,p,k,(O,$,T,W)=>{if(!W&&C.length>0&&!C.some(be=>kr(G,O,1e4,T,be.x,be.y,be.width,be.height)))return;const B=g.hasIndex($),J=w.hasIndex($);e.beginPath();const Q=m==null?void 0:m($),pe=Q===void 0?y:Bn(y,Q);pe.bgCell!==y.bgCell&&(e.fillStyle=pe.bgCell,e.fillRect(G,O,1e4,T)),J&&(e.fillStyle=pe.bgHeader,e.fillRect(G,O,1e4,T)),B&&(e.fillStyle=pe.accentLight,e.fillRect(G,O,1e4,T))}),e.restore())})}function Cd(e,t,n,o,r,i,c,l,d){let f=!1;for(const h of t)if(!h.sticky){f=c(h.sourceIndex);break}const u=d.horizontalBorderColor??d.borderColor,m=d.borderColor,g=f?Jo(t):0;let w;if(g!==0&&(w=Bl(m,d.bgCell),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=m===u&&w!==void 0?w:Bl(u,d.bgCell),p=Eo(i,r,l);e.beginPath(),e.moveTo(0,o-p+.5),e.lineTo(n,o-p+.5),e.strokeStyle=h,e.stroke()}}const Ls=(e,t,n)=>{let o=0,r=t,i=0,c=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),c=Math.max(c,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:c}};function kd(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h){var T;const p=h.bgCell,{minX:C,maxX:x,minY:y,maxY:k}=Ls(l,i,c),I=[],G=c-Eo(w,g,f);let F=d,H=n,D=0;for(;F+r<G;){const W=F+r,B=f(H);if(W>=y&&W<=k-1){const J=u==null?void 0:u(H),Q=J==null?void 0:J.bgCell;Q!==void 0&&Q!==p&&H>=w-g&&I.push({x:C,y:W,w:x-C,h:B,color:Q})}F+=B,H<w-g&&(D=F),H++}let E=0;const O=Math.min(G,k)-D;if(O>0)for(let W=0;W<t.length;W++){const B=t[W];if(B.width===0)continue;const J=B.sticky?E:E+o,Q=(T=B.themeOverride)==null?void 0:T.bgCell;Q!==void 0&&Q!==p&&J>=C&&J<=x&&m(W+1)&&I.push({x:J,y:D,w:B.width,h:O,color:Q}),E+=B.width}if(I.length===0)return;let $;e.beginPath();for(let W=I.length-1;W>=0;W--){const B=I[W];$===void 0?$=B.color:B.color!==$&&(e.fillStyle=$,e.fill(),e.beginPath(),$=B.color),e.rect(B.x,B.y,B.w,B.h)}$!==void 0&&(e.fillStyle=$,e.fill()),e.beginPath()}function Yl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,C,x=!1){if(d!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,c);for(const T of d)e.rect(T.x+1,T.y+1,T.width-1,T.height-1);e.clip("evenodd")}const y=C.horizontalBorderColor??C.borderColor,k=C.borderColor,{minX:I,maxX:G,minY:F,maxY:H}=Ls(l,i,c),D=[];e.beginPath();let E=.5;for(let T=0;T<t.length;T++){const W=t[T];if(W.width===0)continue;E+=W.width;const B=W.sticky?E:E+o;B>=I&&B<=G&&w(T+1)&&D.push({x1:B,y1:Math.max(f,F),x2:B,y2:Math.min(c,H),color:k})}let O=c+.5;for(let T=p-h;T<p;T++){const W=m(T);O-=W,D.push({x1:I,y1:O,x2:G,y2:O,color:y})}if(x!==!0){let T=u+.5,W=n;const B=O;for(;T+r<B;){const J=T+r;if(J>=F&&J<=H-1){const Q=g==null?void 0:g(W);D.push({x1:I,y1:J,x2:G,y2:J,color:(Q==null?void 0:Q.horizontalBorderColor)??(Q==null?void 0:Q.borderColor)??y})}T+=m(W),W++}}const $=Pa(D,T=>T.color);for(const T of Object.keys($)){e.strokeStyle=T;for(const W of $[T])e.moveTo(W.x1,W.y1),e.lineTo(W.x2,W.y2);e.stroke(),e.beginPath()}d!==void 0&&e.restore()}function xd(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,C,x,y){const k=[];e.imageSmoothingEnabled=!1;const I=Math.min(r.cellYOffset,c),G=Math.max(r.cellYOffset,c);let F=0;if(typeof x=="number")F+=(G-I)*x;else for(let B=I;B<G;B++)F+=x(B);c>r.cellYOffset&&(F=-F),F+=d-r.translateY;const H=Math.min(r.cellXOffset,i),D=Math.max(r.cellXOffset,i);let E=0;for(let B=H;B<D;B++)E+=p[B].width;i>r.cellXOffset&&(E=-E),E+=l-r.translateX;const O=Jo(C);if(E!==0&&F!==0)return{regions:[]};const $=f>0?Eo(g,f,x):0,T=u-O-Math.abs(E),W=m-w-$-Math.abs(F)-1;if(T>150&&W>150){const B={sx:0,sy:0,sw:u*h,sh:m*h,dx:0,dy:0,dw:u*h,dh:m*h};if(F>0?(B.sy=(w+1)*h,B.sh=W*h,B.dy=(F+w+1)*h,B.dh=W*h,k.push({x:0,y:w,width:u,height:F+1})):F<0&&(B.sy=(-F+w+1)*h,B.sh=W*h,B.dy=(w+1)*h,B.dh=W*h,k.push({x:0,y:m+F-$,width:u,height:-F+$})),E>0?(B.sx=O*h,B.sw=T*h,B.dx=(E+O)*h,B.dw=T*h,k.push({x:O-1,y:0,width:E+2,height:m})):E<0&&(B.sx=(O-E)*h,B.sw=T*h,B.dx=O*h,B.dw=T*h,k.push({x:u+E,y:0,width:-E,height:m})),e.setTransform(1,0,0,1,0,0),y){if(O>0&&E!==0&&F===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const J=O*h,Q=m*h;e.drawImage(t,0,0,J,Q,0,0,J,Q)}if($>0&&E===0&&F!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const J=(m-$)*h,Q=u*h,pe=$*h;e.drawImage(t,0,J,Q,pe,0,J,Q,pe)}}e.drawImage(t,B.sx,B.sy,B.sw,B.sh,B.dx,B.dy,B.dw,B.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:k}}function Sd(e,t,n,o,r,i,c,l,d,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||co(d,n,o,r,l,(m,g,w,h)=>{if(m.sourceIndex===f){const p=Math.max(g,h)+1;return u.push({x:p,y:0,width:i-p,height:c}),!0}}),u}function Md(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(jo(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:c,...l}=r,{width:d,...f}=i;if(!jo(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function Kl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p){const C=h==null?void 0:h.filter(H=>H.style!=="no-outline");if(C===void 0||C.length===0)return;const x=Jo(l),y=Eo(w,g,m),k=[d,0,l.length,w-g],I=[x,0,t,n-y],G=C.map(H=>{const D=H.range,E=H.style??"dashed";return hd(D,k,t,n,I).map(O=>{const $=O.rect,T=Ki($.x,$.y,t,n,u,f+u,o,r,i,c,w,d,g,l,m),W=$.width===1&&$.height===1?T:Ki($.x+$.width-1,$.y+$.height-1,t,n,u,f+u,o,r,i,c,w,d,g,l,m);return $.x+$.width>=l.length&&(W.width-=1),$.y+$.height>=w&&(W.height-=1),{color:H.color,style:E,clip:O.clip,rect:fd({x:T.x,y:T.y,width:W.x+W.width-T.x,height:W.y+W.height-T.y},t,n,8)}})}),F=()=>{e.lineWidth=1;let H=!1;for(const D of G)for(const E of D)if((E==null?void 0:E.rect)!==void 0&&kr(0,0,t,n,E.rect.x,E.rect.y,E.rect.width,E.rect.height)){const O=H,$=!ud(E.clip,E.rect);e.beginPath(),$&&(e.save(),e.rect(E.clip.x,E.clip.y,E.clip.width,E.clip.height),e.clip()),E.style==="dashed"&&!H?(e.setLineDash([5,3]),H=!0):(E.style==="solid"||E.style==="solid-outline")&&H&&(e.setLineDash([]),H=!1),e.strokeStyle=E.style==="solid-outline"?fn(fn(E.color,p.borderColor),p.bgCell):ao(E.color,1),e.closePath(),e.strokeRect(E.rect.x+.5,E.rect.y+.5,E.rect.width-1,E.rect.height-1),$&&(e.restore(),H=O)}H&&e.setLineDash([])};return F(),F}function _l(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Li(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,p,C){if(u.current===void 0)return;const x=p!==!1&&p!==void 0;if(!x)return;const y=typeof p=="object"?{...ni,...p}:ni,k=u.current.range,I=u.current.cell,G=[k.x+k.width-1,k.y+k.height-1];if(I[1]>=C&&G[1]>=C||!c.some(Q=>Q.sourceIndex===I[0]||Q.sourceIndex===G[0]))return;const[H,D]=u.current.cell,E=g(u.current.cell),O=E.span??[H,H],$=D>=C-w,T=w>0&&!$?Eo(C,w,m)-1:0,W=G[1];let B;if(co(c,o,r,i,f,(Q,pe,be,ye,Z)=>{if(Q.sticky&&H>Q.sourceIndex)return;const q=Q.sourceIndex<O[0],ae=Q.sourceIndex>O[1],ve=Q.sourceIndex===G[0];if(!(!ve&&(q||ae)))return ci(Z,be,n,C,m,w,h,void 0,(we,ce,fe)=>{if(ce!==D&&ce!==W)return;let re=pe,U=Q.width;if(E.span!==void 0){const ue=Fs(E.span,pe,we,Q.width,fe,Q,l),Be=Q.sticky?ue[0]:ue[1];Be!==void 0&&(re=Be.x,U=Be.width)}return ce===W&&ve&&x&&(B=()=>{var Me;ye>re&&!Q.sticky&&(e.beginPath(),e.rect(ye,0,t-ye,n),e.clip());const ue=y.size,Be=ue/2,Ge=re+U+y.offsetX-Be+.5,ie=we+fe+y.offsetY-Be+.5;e.beginPath(),y.shape==="circle"?e.arc(Ge+Be,ie+Be,Be,0,Math.PI*2):e.rect(Ge,ie,ue,ue),e.fillStyle=((Me=Q.themeOverride)==null?void 0:Me.accentColor)??d.accentColor,e.fill(),y.outline>0&&(e.lineWidth=y.outline,e.strokeStyle=d.bgCell,y.shape==="circle"?(e.beginPath(),e.arc(Ge+Be,ie+Be,Be+y.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(Ge-y.outline/2,ie-y.outline/2,ue+y.outline,ue+y.outline))}),B!==void 0}),B!==void 0}),B===void 0)return;const J=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-T),e.clip(),B==null||B(),e.restore()};return J(),J}function Ed(e,t,n,o,r,i,c,l,d){d===void 0||d.size===0||(e.beginPath(),co(t,l,i,c,r,(f,u,m,g)=>{const w=Math.max(0,g-u),h=u+w+1,p=f.width-w-1;d.has([f.sourceIndex,-1])&&e.rect(h,o,p,r-o)}),e.clip())}function Rd(e,t,n,o,r,i,c,l,d,f){let u=0;return co(e,i,o,r,n,(m,g,w,h,p)=>(ci(p,w,t,c,l,d,f,void 0,(C,x,y,k)=>{k||(u=Math.max(x,u))}),!0)),u}function Vl(e,t){var xn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:c,cellYOffset:l,translateX:d,translateY:f,mappedColumns:u,enableGroups:m,freezeColumns:g,dragAndDropState:w,theme:h,drawFocus:p,headerHeight:C,groupHeaderHeight:x,groupLevels:y,groupHeaderHeights:k,disabledRows:I,rowHeight:G,verticalBorder:F,overrideCursor:H,isResizing:D,selection:E,fillHandle:O,freezeTrailingRows:$,rows:T,getCellContent:W,getGroupDetails:B,getRowThemeOverride:J,isFocused:Q,drawHeaderCallback:pe,prelightCells:be,drawCellCallback:ye,highlightRegions:Z,resizeCol:q,imageLoader:ae,lastBlitData:ve,hoverValues:we,hyperWrapping:ce,hoverInfo:fe,spriteManager:re,maxScaleFactor:U,hasAppendRow:ke,touchMode:ue,enqueue:Be,renderStateProvider:Ge,getCellRenderer:ie,renderStrategy:Me,bufferACtx:Qe,bufferBCtx:ft,damage:We,minimumCellWidth:It,resizeIndicator:xe}=e;if(r===0||i===0)return;const He=Me==="double-buffer",he=Math.min(U,Math.ceil(window.devicePixelRatio??1)),Fe=Me!=="direct"&&Md(e,t),ze=n.canvas;(ze.width!==r*he||ze.height!==i*he)&&(ze.width=r*he,ze.height=i*he,ze.style.width=r+"px",ze.style.height=i+"px");const Xe=o.canvas,$e=k.reduce((gt,Ut)=>gt+Ut,0),Ye=C+$e,tt=Ye+1;(Xe.width!==r*he||Xe.height!==tt*he)&&(Xe.width=r*he,Xe.height=tt*he,Xe.style.width=r+"px",Xe.style.height=tt+"px");const at=Qe.canvas,Yt=ft.canvas;He&&(at.width!==r*he||at.height!==i*he)&&(at.width=r*he,at.height=i*he,ve.current!==void 0&&(ve.current.aBufferScroll=void 0)),He&&(Yt.width!==r*he||Yt.height!==i*he)&&(Yt.width=r*he,Yt.height=i*he,ve.current!==void 0&&(ve.current.bBufferScroll=void 0));const _=ve.current;if(Fe===!0&&c===(_==null?void 0:_.cellXOffset)&&l===(_==null?void 0:_.cellYOffset)&&d===(_==null?void 0:_.translateX)&&f===(_==null?void 0:_.translateY))return;let mt=null;He&&(mt=n);const nt=o;let me;He?We!==void 0?me=(_==null?void 0:_.lastBuffer)==="b"?ft:Qe:me=(_==null?void 0:_.lastBuffer)==="b"?Qe:ft:me=n;const ot=me.canvas,ht=He?ot===at?Yt:at:ze,Ze=typeof G=="number"?()=>G:G;nt.save(),me.save(),nt.beginPath(),me.beginPath(),nt.textBaseline="middle",me.textBaseline="middle",he!==1&&(nt.scale(he,he),me.scale(he,he));const qe=Yi(u,c,r,w,d);let kt=[];const Nt=p&&((xn=E.current)==null?void 0:xn.cell[1])===l&&f===0;let Ot=!1;if(Z!==void 0){for(const gt of Z)if(gt.style!=="no-outline"&&gt.range.y===l&&f===0){Ot=!0;break}}const Bt=()=>{nt.fillStyle=h.bgHeader,nt.fillRect(0,0,r,Ye+1),wd(nt,qe,u,m,fe,r,d,C,x,w,D,E,h,re,we,F,B,We,pe,ue,y,k),Yl(nt,qe,l,d,f,r,i,void 0,void 0,$e,Ye,Ze,J,F,$,T,h,!0),nt.beginPath(),nt.moveTo(0,tt-.5),nt.lineTo(r,tt-.5),nt.strokeStyle=fn(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),nt.stroke(),Ot&&Kl(nt,r,i,c,l,d,f,u,g,C,$e,G,$,T,Z,h),Nt&&Li(nt,r,i,l,d,f,qe,u,h,Ye,E,Ze,W,$,ke,O,T)};if(We!==void 0){const gt=qe[qe.length-1].sourceIndex+1,Ut=We.hasItemInRegion([{x:c,y:-2,width:gt,height:2},{x:c,y:l,width:gt,height:300},{x:0,y:l,width:g,height:300},{x:0,y:-2,width:g,height:2},{x:c,y:T-$,width:gt,height:$,when:$>0}]),sn=an=>{Gl(an,qe,u,i,Ye,d,f,l,T,Ze,W,B,J,I,Q,p,$,ke,kt,We,E,be,Z,ae,re,we,fe,ye,ce,h,Be,Ge,ie,H,It);const Ke=E.current;O!==!1&&O!==void 0&&p&&Ke!==void 0&&We.has(vs(Ke.range))&&Li(an,r,i,l,d,f,qe,u,h,Ye,E,Ze,W,$,ke,O,T)};Ut&&(sn(me),mt!==null&&(mt.save(),mt.scale(he,he),mt.textBaseline="middle",sn(mt),mt.restore()),We.hasHeader()&&(Ed(nt,qe,r,$e,Ye,d,f,l,We),Bt())),me.restore(),nt.restore();return}if((Fe!==!0||c!==(_==null?void 0:_.cellXOffset)||l!==(_==null?void 0:_.cellYOffset)||d!==(_==null?void 0:_.translateX)||f!==(_==null?void 0:_.translateY)||Nt!==(_==null?void 0:_.mustDrawFocusOnHeader)||Ot!==(_==null?void 0:_.mustDrawHighlightRingsOnHeader))&&Bt(),Fe===!0){un(ht!==void 0&&_!==void 0);const{regions:gt}=xd(me,ht,ht===at?_.aBufferScroll:_.bBufferScroll,ht===at?_.bBufferScroll:_.aBufferScroll,_,c,l,d,f,$,r,i,T,Ye,he,u,qe,G,He);kt=gt}else Fe!==!1&&(un(_!==void 0),kt=Sd(_,c,l,d,f,r,i,Ye,qe,Fe));Cd(me,qe,r,i,$,T,F,Ze,h);const Dt=Kl(me,r,i,c,l,d,f,u,g,C,$e,G,$,T,Z,h),Vt=p?Li(me,r,i,l,d,f,qe,u,h,Ye,E,Ze,W,$,ke,O,T):void 0;if(me.fillStyle=h.bgCell,kt.length>0){me.beginPath();for(const gt of kt)me.rect(gt.x,gt.y,gt.width,gt.height);me.clip(),me.fill(),me.beginPath()}else me.fillRect(0,0,r,i);const Ht=Gl(me,qe,u,i,Ye,d,f,l,T,Ze,W,B,J,I,Q,p,$,ke,kt,We,E,be,Z,ae,re,we,fe,ye,ce,h,Be,Ge,ie,H,It);vd(me,qe,u,r,i,Ye,d,f,l,T,Ze,J,E.rows,I,$,ke,kt,We,h),kd(me,qe,l,d,f,r,i,kt,Ye,Ze,J,F,$,T,h),Yl(me,qe,l,d,f,r,i,kt,Ht,$e,Ye,Ze,J,F,$,T,h),Dt==null||Dt(),Vt==null||Vt(),D&&xe!=="none"&&co(qe,0,d,0,Ye,(gt,Ut)=>gt.sourceIndex===q?(_l(nt,Ut+gt.width,0,Ye+1,fn(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),xe==="full"&&_l(me,Ut+gt.width,Ye,i,fn(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),mt!==null&&(mt.fillStyle=h.bgCell,mt.fillRect(0,0,r,i),mt.drawImage(me.canvas,0,0));const On=Rd(qe,i,Ye,d,f,l,T,Ze,$,ke);ae==null||ae.setWindow({x:c,y:l,width:qe.length,height:On-l},g,Array.from({length:$},(gt,Ut)=>T-1-Ut));const gn=_!==void 0&&(c!==_.cellXOffset||d!==_.translateX),rt=_!==void 0&&(l!==_.cellYOffset||f!==_.translateY);ve.current={cellXOffset:c,cellYOffset:l,translateX:d,translateY:f,mustDrawFocusOnHeader:Nt,mustDrawHighlightRingsOnHeader:Ot,lastBuffer:He?ot===at?"a":"b":void 0,aBufferScroll:ot===at?[gn,rt]:_==null?void 0:_.aBufferScroll,bBufferScroll:ot===Yt?[gn,rt]:_==null?void 0:_.bBufferScroll},me.restore(),nt.restore()}const Id=80;function Hd(e){const t=e-1;return t*t*t+1}class Dd{constructor(t){_e(this,"callback");_e(this,"currentHoveredItem");_e(this,"leavingItems",[]);_e(this,"lastAnimationTime");_e(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>yr(o.item,t.item))||this.leavingItems.push(t)});_e(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>yr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});_e(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});_e(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});_e(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Hd(t.hoverAmount)})));_e(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Id;for(const i of this.leavingItems)i.hoverAmount=kn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=kn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});_e(this,"setHovered",t=>{var n;if(!yr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Fd{constructor(t){_e(this,"fn");_e(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function il(e){return new Fd(e)}const Td=il(()=>window.navigator.userAgent.includes("Firefox")),ii=il(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),li=il(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Ad(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(c),c=()=>{const l=t.current.map(ol);t.current=[],o.current(new qo(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:c)},[]);return s.useCallback(i=>{t.current.length===0&&r();const c=Tn(i[0],i[1]);t.current.includes(c)||t.current.push(c)},[r])}const lo="header",Fn="group-header",si="out-of-bounds";var Uo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Uo||(Uo={}));function Bs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Pd=(e,t)=>{if(e.kind===te.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},zd=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:c,cellYOffset:l,headerHeight:d,fillHandle:f=!1,groupHeaderHeight:u,groupLevels:m,groupHeaderHeights:g,rowHeight:w,rows:h,getCellContent:p,getRowThemeOverride:C,onHeaderMenuClick:x,onHeaderIndicatorClick:y,enableGroups:k,isFilling:I,onCanvasFocused:G,onCanvasBlur:F,isFocused:H,selection:D,freezeColumns:E,onContextMenu:O,freezeTrailingRows:$,fixedShadowX:T=!0,fixedShadowY:W=!0,drawFocusRing:B,onMouseDown:J,onMouseUp:Q,onMouseMoveRaw:pe,onMouseMove:be,onItemHovered:ye,dragAndDropState:Z,firstColAccessible:q,onKeyDown:ae,onKeyUp:ve,highlightRegions:we,canvasRef:ce,onDragStart:fe,onDragEnd:re,eventTargetRef:U,isResizing:ke,resizeColumn:ue,isDragging:Be,isDraggable:Ge=!1,allowResize:ie,disabledRows:Me,hasAppendRow:Qe,getGroupDetails:ft,theme:We,prelightCells:It,headerIcons:xe,verticalBorder:He,drawCell:he,drawHeader:Fe,onCellFocused:ze,onDragOverCell:Xe,onDrop:$e,onDragLeave:Ye,imageWindowLoader:tt,smoothScrollX:at=!1,smoothScrollY:Yt=!1,experimental:_,getCellRenderer:mt,resizeIndicator:nt="full"}=e,me=e.translateX??0,ot=e.translateY??0,ht=Math.max(E,Math.min(i.length-1,c)),Ze=s.useRef(null),qe=s.useRef((_==null?void 0:_.eventTarget)??window),kt=qe.current,Nt=tt,Ot=s.useRef(),[Bt,Dt]=s.useState(!1),Vt=s.useRef([]),Ht=s.useRef(),[On,gn]=s.useState(),[rt,xn]=s.useState(),gt=s.useRef(null),[Ut,sn]=s.useState(),[an,Ke]=s.useState(!1),Gt=s.useRef(an);Gt.current=an;const Te=s.useMemo(()=>new sd(xe,()=>{Ho.current=void 0,uo.current()}),[xe]),ct=k?u+d:d,dt=s.useRef(-1),At=((_==null?void 0:_.enableFirefoxRescaling)??!1)&&Td.value,qt=((_==null?void 0:_.enableSafariRescaling)??!1)&&ii.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!At&&!qt||(dt.current!==-1&&Dt(!0),window.clearTimeout(dt.current),dt.current=window.setTimeout(()=>{Dt(!1),dt.current=-1},200))},[l,ht,me,ot,At,qt]);const Oe=fc(i,E),$n=s.useMemo(()=>T?Jo(Oe,Z):0,[Oe,Z,T]),xt=s.useCallback((z,V,le)=>{const de=z.getBoundingClientRect();if(V>=Oe.length||le>=h)return;const ee=de.width/n,se=Ki(V,le,n,o,u,ct,ht,l,me,ot,h,E,$,Oe,w,m,g);return ee!==1&&(se.x*=ee,se.y*=ee,se.width*=ee,se.height*=ee),se.x+=de.x,se.y+=de.y,se},[n,o,u,ct,ht,l,me,ot,h,E,$,Oe,w,m,g]),St=s.useCallback((z,V,le,de)=>{const ee=z.getBoundingClientRect(),se=ee.width/n,Ae=(V-ee.left)/se,R=(le-ee.top)/se,oe=5,Mt=Yi(Oe,ht,n,void 0,me);let Ee=0,it=0;const pt=typeof PointerEvent<"u"&&de instanceof PointerEvent&&de.pointerType==="mouse"||typeof MouseEvent<"u"&&de instanceof MouseEvent,wt=typeof PointerEvent<"u"&&de instanceof PointerEvent&&de.pointerType==="touch"||typeof TouchEvent<"u"&&de instanceof TouchEvent;pt&&(Ee=de.button,it=de.buttons);const vt=wc(Ae,Mt,me),A=pc(R,o,k,d,u,h,w,l,ot,$,m,g),lt=(de==null?void 0:de.shiftKey)===!0,bt=(de==null?void 0:de.ctrlKey)===!0,zn=(de==null?void 0:de.metaKey)===!0,pn=[Ae<0?-1:n<Ae?1:0,R<ct?-1:o<R?1:0];let cn;if(vt===-1||R<0||Ae<0||A===void 0||Ae>n||R>o){const je=Ae>n?1:Ae<0?-1:0,jt=R>o?1:R<0?-1:0;let En=je*2,Zn=jt*2;je===0&&(En=vt===-1?Uo.EndPadding:Uo.Center),jt===0&&(Zn=A===void 0?Uo.EndPadding:Uo.Center);let dn=!1;if(vt===-1&&A===-1){const Zt=xt(z,Oe.length-1,-1);un(Zt!==void 0),dn=V<Zt.x+Zt.width+oe}const mo=Ae>n&&Ae<n+Gi()||R>o&&R<o+Gi();cn={kind:si,location:[vt!==-1?vt:Ae<0?0:Oe.length-1,A??h-1],region:[En,Zn],shiftKey:lt,ctrlKey:bt,metaKey:zn,isEdge:dn,isTouch:wt,button:Ee,buttons:it,scrollEdge:pn,isMaybeScrollbar:mo}}else if(A<=-1){let je=xt(z,vt,A);un(je!==void 0);let jt=je!==void 0&&je.x+je.width-V<=oe;const En=k&&A<=-2,Zn=En?-(A+2):void 0,dn=vt-1;V-je.x<=oe&&dn>=0?(jt=!0,je=xt(z,dn,A),un(je!==void 0),cn={kind:En?Fn:lo,location:[dn,A],bounds:je,group:Mo(Oe[dn].group,Zn),isEdge:jt,shiftKey:lt,ctrlKey:bt,metaKey:zn,isTouch:wt,localEventX:V-je.x,localEventY:le-je.y,button:Ee,buttons:it,scrollEdge:pn}):cn={kind:En?Fn:lo,group:Mo(Oe[vt].group,Zn),location:[vt,A],bounds:je,isEdge:jt,shiftKey:lt,ctrlKey:bt,metaKey:zn,isTouch:wt,localEventX:V-je.x,localEventY:le-je.y,button:Ee,buttons:it,scrollEdge:pn}}else{const je=xt(z,vt,A);un(je!==void 0);const jt=je!==void 0&&je.x+je.width-V<oe;let En=!1;if(f!==!1&&f!==void 0&&D.current!==void 0){const dn=typeof f=="object"?{...ni,...f}:ni,mo=dn.size,Zt=mo/2,Pt=vs(D.current.range),Ft=xt(z,Pt[0],Pt[1]);if(Ft!==void 0){const Tt=Ft.x+Ft.width+dn.offsetX-Zt+.5,$t=Ft.y+Ft.height+dn.offsetY-Zt+.5;En=Math.abs(Tt-V)<mo&&Math.abs($t-le)<mo}}cn={kind:"cell",location:[vt,A],bounds:je,isEdge:jt,shiftKey:lt,ctrlKey:bt,isFillHandle:En,metaKey:zn,isTouch:wt,localEventX:V-je.x,localEventY:le-je.y,button:Ee,buttons:it,scrollEdge:pn}}return cn},[n,Oe,ht,me,o,k,d,u,h,w,l,ot,$,xt,f,D,ct]),[mn]=On??[],xr=s.useRef(()=>{}),yt=s.useRef(On);yt.current=On;const[Nn,Gn]=s.useMemo(()=>{const z=document.createElement("canvas"),V=document.createElement("canvas");return z.style.display="none",z.style.opacity="0",z.style.position="fixed",V.style.display="none",V.style.opacity="0",V.style.position="fixed",[z.getContext("2d",{alpha:!1}),V.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Nn===null||Gn===null))return document.documentElement.append(Nn.canvas),document.documentElement.append(Gn.canvas),()=>{Nn.canvas.remove(),Gn.canvas.remove()}},[Nn,Gn]);const Io=s.useMemo(()=>new Ec,[]),Sr=At&&Bt?1:qt&&Bt?2:5,Mr=(_==null?void 0:_.disableMinimumCellWidth)===!0?1:10,Ho=s.useRef(),Do=s.useRef(null),An=s.useRef(null),Fo=s.useCallback(()=>{var Ae;const z=Ze.current,V=gt.current;if(z===null||V===null||(Do.current===null&&(Do.current=z.getContext("2d",{alpha:!1}),z.width=0,z.height=0),An.current===null&&(An.current=V.getContext("2d",{alpha:!1}),V.width=0,V.height=0),Do.current===null||An.current===null||Nn===null||Gn===null))return;let le=!1;const de=R=>{le=!0,sn(R)},ee=Ho.current,se={headerCanvasCtx:An.current,canvasCtx:Do.current,bufferACtx:Nn,bufferBCtx:Gn,width:n,height:o,cellXOffset:ht,cellYOffset:l,translateX:Math.round(me),translateY:Math.round(ot),mappedColumns:Oe,enableGroups:k,freezeColumns:E,dragAndDropState:Z,theme:We,headerHeight:d,groupHeaderHeight:u,groupLevels:m,groupHeaderHeights:g,disabledRows:Me??st.empty(),rowHeight:w,verticalBorder:He,isResizing:ke,resizeCol:ue,isFocused:H,selection:D,fillHandle:f,drawCellCallback:he,hasAppendRow:Qe,overrideCursor:de,maxScaleFactor:Sr,freezeTrailingRows:$,rows:h,drawFocus:B,getCellContent:p,getGroupDetails:ft??(R=>({name:R})),getRowThemeOverride:C,drawHeaderCallback:Fe,prelightCells:It,highlightRegions:we,imageLoader:Nt,lastBlitData:Ht,damage:Ot.current,hoverValues:Vt.current,hoverInfo:yt.current,spriteManager:Te,scrolling:Bt,hyperWrapping:(_==null?void 0:_.hyperWrapping)??!1,touchMode:an,enqueue:xr.current,renderStateProvider:Io,renderStrategy:(_==null?void 0:_.renderStrategy)??(ii.value?"double-buffer":"single-buffer"),getCellRenderer:mt,minimumCellWidth:Mr,resizeIndicator:nt};se.damage===void 0?(Ho.current=se,Vl(se,ee)):Vl(se,void 0),!le&&(se.damage===void 0||se.damage.has((Ae=yt==null?void 0:yt.current)==null?void 0:Ae[0]))&&sn(void 0)},[Nn,Gn,n,o,ht,l,me,ot,Oe,k,E,Z,We,d,u,m,g,Me,w,He,ke,Qe,ue,H,D,f,$,h,B,Sr,p,ft,C,he,Fe,It,we,Nt,Te,Bt,_==null?void 0:_.hyperWrapping,_==null?void 0:_.renderStrategy,an,Io,mt,Mr,nt]),uo=s.useRef(Fo);s.useLayoutEffect(()=>{Fo(),uo.current=Fo},[Fo]),s.useLayoutEffect(()=>{(async()=>{var V;((V=document==null?void 0:document.fonts)==null?void 0:V.ready)!==void 0&&(await document.fonts.ready,Ho.current=void 0,uo.current())})()},[]);const _n=s.useCallback(z=>{Ot.current=z,uo.current(),Ot.current=void 0},[]),di=Ad(_n);xr.current=di;const Er=s.useCallback(z=>{_n(new qo(z.map(V=>V.cell)))},[_n]);Nt.setCallback(_n);const[Rr,ui]=s.useState(!1),[Xn,Vn]=mn??[],fi=Xn!==void 0&&Vn===-1&&Xn>=0&&Xn<Oe.length&&Oe[Xn].headerRowMarkerDisabled!==!0,Ir=Xn!==void 0&&Vn===-2;let Hr=!1,Dr=!1,To=Ut;if(To===void 0&&Xn!==void 0&&Vn!==void 0&&Vn>-1&&Vn<h){const z=p([Xn,Vn],!0);Hr=z.kind===Wt.NewRow||z.kind===Wt.Marker&&z.markerKind!=="number",Dr=z.kind===te.Boolean&&ji(z),To=z.cursor}const Tr=Be?"grabbing":(rt??!1)||ke?"col-resize":Rr||I?"crosshair":To!==void 0?To:fi||Hr||Dr||Ir?"pointer":"default",Ao=s.useMemo(()=>({contain:"strict",display:"block",cursor:Tr}),[Tr]),er=s.useRef("default"),Un=U==null?void 0:U.current;Un!=null&&er.current!==Ao.cursor&&(Un.style.cursor=er.current=Ao.cursor);const Yn=s.useCallback((z,V,le,de)=>{if(ft===void 0)return;const ee=ft(z);if(ee.actions!==void 0){const se=rl(V,ee.actions);for(const[Ae,R]of se.entries())if(so(R,le+V.x,de+R.y))return ee.actions[Ae]}},[ft]),Sn=s.useCallback((z,V,le,de)=>{const ee=Oe[V];if(!Be&&!ke&&!(rt??!1)){const se=xt(z,V,-1);un(se!==void 0);const Ae=Ps(void 0,ee,se.x,se.y,se.width,se.height,We,Ji(ee.title)==="rtl");if(ee.hasMenu===!0&&Ae.menuBounds!==void 0&&so(Ae.menuBounds,le,de))return{area:"menu",bounds:Ae.menuBounds};if(ee.indicatorIcon!==void 0&&Ae.indicatorIconBounds!==void 0&&so(Ae.indicatorIconBounds,le,de))return{area:"indicator",bounds:Ae.indicatorIconBounds}}},[Oe,xt,rt,Be,ke,We]),Po=s.useRef(0),De=s.useRef(),tr=s.useRef(!1),zo=s.useCallback(z=>{const V=Ze.current,le=U==null?void 0:U.current;if(V===null||z.target!==V&&z.target!==le)return;tr.current=!0;const de=z.clientX,ee=z.clientY;if(z.target===le&&le!==null){const Ae=le.getBoundingClientRect();if(de>Ae.right||ee>Ae.bottom)return}const se=St(V,de,ee,z);De.current=se.location,se.isTouch&&(Po.current=Date.now()),Gt.current!==se.isTouch&&Ke(se.isTouch),!(se.kind===lo&&Sn(V,se.location[0],de,ee)!==void 0)&&(se.kind===Fn&&Yn(se.group,se.bounds,se.localEventX,se.localEventY)!==void 0||(J==null||J(se),!se.isTouch&&Ge!==!0&&Ge!==se.kind&&se.button<3&&se.button!==1&&z.preventDefault()))},[U,Ge,St,Yn,Sn,J]);Qt("pointerdown",zo,kt,!1);const wn=s.useRef(0),tn=s.useCallback(z=>{var it,pt;const V=wn.current;wn.current=Date.now();const le=Ze.current;if(tr.current=!1,Q===void 0||le===null)return;const de=U==null?void 0:U.current,ee=z.target!==le&&z.target!==de,se=z.clientX,Ae=z.clientY,R=z.pointerType==="mouse"?z.button<3:!0;let oe=St(le,se,Ae,z);oe.isTouch&&Po.current!==0&&Date.now()-Po.current>500&&(oe={...oe,isLongTouch:!0}),V!==0&&Date.now()-V<(oe.isTouch?1e3:500)&&(oe={...oe,isDoubleClick:!0}),Gt.current!==oe.isTouch&&Ke(oe.isTouch),!ee&&z.cancelable&&R&&z.preventDefault();const[Mt]=oe.location,Ee=Sn(le,Mt,se,Ae);if(oe.kind===lo&&Ee!==void 0){(oe.button!==0||((it=De.current)==null?void 0:it[0])!==Mt||((pt=De.current)==null?void 0:pt[1])!==-1)&&Q(oe,!0);return}else if(oe.kind===Fn){const wt=Yn(oe.group,oe.bounds,oe.localEventX,oe.localEventY);if(wt!==void 0){oe.button===0&&wt.onClick(oe);return}}Q(oe,ee)},[Q,U,St,Sn,Yn]);Qt("pointerup",tn,kt,!1);const hi=s.useCallback(z=>{var Mt,Ee;const V=Ze.current;if(V===null)return;const le=U==null?void 0:U.current,de=z.target!==V&&z.target!==le;let ee,se,Ae=!0;z instanceof MouseEvent?(ee=z.clientX,se=z.clientY,Ae=z.button<3):(ee=z.changedTouches[0].clientX,se=z.changedTouches[0].clientY);const R=St(V,ee,se,z);Gt.current!==R.isTouch&&Ke(R.isTouch),!de&&z.cancelable&&Ae&&z.preventDefault();const[oe]=R.location;if(R.kind===lo){const it=Sn(V,oe,ee,se);it!==void 0&&R.button===0&&((Mt=De.current)==null?void 0:Mt[0])===oe&&((Ee=De.current)==null?void 0:Ee[1])===-1&&(it.area==="menu"?x==null||x(oe,it.bounds):it.area==="indicator"&&(y==null||y(oe,it.bounds)))}},[U,St,Sn,x,y]);Qt("click",hi,kt,!1);const nr=s.useCallback(z=>{const V=Ze.current,le=U==null?void 0:U.current;if(V===null||z.target!==V&&z.target!==le||O===void 0)return;const de=St(V,z.clientX,z.clientY,z);O(de,()=>{z.cancelable&&z.preventDefault()})},[U,St,O]);Qt("contextmenu",nr,(U==null?void 0:U.current)??null,!1);const Lo=s.useCallback(z=>{Ot.current=new qo(z.map(V=>V.item)),Vt.current=z,uo.current(),Ot.current=void 0},[]),Bo=s.useMemo(()=>new Dd(Lo),[Lo]),or=s.useRef(Bo);or.current=Bo,s.useLayoutEffect(()=>{const z=or.current;if(mn===void 0||mn[1]<0){z.setHovered(mn);return}const V=p(mn,!0),le=mt(V),de=le===void 0&&V.kind===te.Custom||(le==null?void 0:le.needsHover)!==void 0&&(typeof le.needsHover=="boolean"?le.needsHover:le.needsHover(V));z.setHovered(de?mn:void 0)},[p,mt,mn]);const fo=s.useRef(),qn=s.useCallback(z=>{var R;const V=Ze.current;if(V===null)return;const le=U==null?void 0:U.current,de=z.target!==V&&z.target!==le,ee=St(V,z.clientX,z.clientY,z);if(ee.kind!=="out-of-bounds"&&de&&!tr.current&&!ee.isTouch)return;const se=(oe,Mt)=>{gn(Ee=>Ee===oe||(Ee==null?void 0:Ee[0][0])===(oe==null?void 0:oe[0][0])&&(Ee==null?void 0:Ee[0][1])===(oe==null?void 0:oe[0][1])&&((Ee==null?void 0:Ee[1][0])===(oe==null?void 0:oe[1][0])&&(Ee==null?void 0:Ee[1][1])===(oe==null?void 0:oe[1][1])||!Mt)?Ee:oe)};if(!Bs(ee,fo.current))sn(void 0),ye==null||ye(ee),se(ee.kind===si?void 0:[ee.location,[ee.localEventX,ee.localEventY]],!0),fo.current=ee;else if(ee.kind==="cell"||ee.kind===lo||ee.kind===Fn){let oe=!1,Mt=!0;if(ee.kind==="cell"){const it=p(ee.location);Mt=((R=mt(it))==null?void 0:R.needsHoverPosition)??it.kind===te.Custom,oe=Mt}else oe=!0;const Ee=[ee.location,[ee.localEventX,ee.localEventY]];se(Ee,Mt),yt.current=Ee,oe&&_n(new qo([ee.location]))}const Ae=ee.location[0]>=(q?0:1);xn(ee.kind===lo&&ee.isEdge&&Ae&&ie===!0),ui(ee.kind==="cell"&&ee.isFillHandle),pe==null||pe(z),be(ee)},[U,St,q,ie,pe,be,ye,p,mt,_n]);Qt("pointermove",qn,kt,!0);const gi=s.useCallback(z=>{const V=Ze.current;if(V===null)return;let le,de;D.current!==void 0&&(le=xt(V,D.current.cell[0],D.current.cell[1]),de=D.current.cell),ae==null||ae({bounds:le,stopPropagation:()=>z.stopPropagation(),preventDefault:()=>z.preventDefault(),cancel:()=>{},ctrlKey:z.ctrlKey,metaKey:z.metaKey,shiftKey:z.shiftKey,altKey:z.altKey,key:z.key,keyCode:z.keyCode,rawEvent:z,location:de})},[ae,D,xt]),Ar=s.useCallback(z=>{const V=Ze.current;if(V===null)return;let le,de;D.current!==void 0&&(le=xt(V,D.current.cell[0],D.current.cell[1]),de=D.current.cell),ve==null||ve({bounds:le,stopPropagation:()=>z.stopPropagation(),preventDefault:()=>z.preventDefault(),cancel:()=>{},ctrlKey:z.ctrlKey,metaKey:z.metaKey,shiftKey:z.shiftKey,altKey:z.altKey,key:z.key,keyCode:z.keyCode,rawEvent:z,location:de})},[ve,D,xt]),Wo=s.useCallback(z=>{if(Ze.current=z,ce!==void 0&&(ce.current=z),_!=null&&_.eventTarget)qe.current=_.eventTarget;else if(z===null)qe.current=window;else{const V=z.getRootNode();V===document&&(qe.current=window),qe.current=V}},[ce,_==null?void 0:_.eventTarget]),mi=s.useCallback(z=>{const V=Ze.current;if(V===null||Ge===!1||ke){z.preventDefault();return}let le,de;const ee=St(V,z.clientX,z.clientY);if(Ge!==!0&&ee.kind!==Ge){z.preventDefault();return}const se=(it,pt)=>{le=it,de=pt};let Ae,R,oe;const Mt=(it,pt,wt)=>{Ae=it,R=pt,oe=wt};let Ee=!1;if(fe==null||fe({...ee,setData:se,setDragImage:Mt,preventDefault:()=>Ee=!0,defaultPrevented:()=>Ee}),!Ee&&le!==void 0&&de!==void 0&&z.dataTransfer!==null)if(z.dataTransfer.setData(le,de),z.dataTransfer.effectAllowed="copyLink",Ae!==void 0&&R!==void 0&&oe!==void 0)z.dataTransfer.setDragImage(Ae,R,oe);else{const[it,pt]=ee.location;if(pt!==void 0){const wt=document.createElement("canvas"),vt=xt(V,it,pt);un(vt!==void 0);const A=Math.ceil(window.devicePixelRatio??1);wt.width=vt.width*A,wt.height=vt.height*A;const lt=wt.getContext("2d");lt!==null&&(lt.scale(A,A),lt.textBaseline="middle",pt===-1?(lt.font=We.headerFontFull,lt.fillStyle=We.bgHeader,lt.fillRect(0,0,wt.width,wt.height),zs(lt,0,0,vt.width,vt.height,Oe[it],!1,We,!1,void 0,void 0,!1,0,Te,Fe,!1)):(lt.font=We.baseFontFull,lt.fillStyle=We.bgCell,lt.fillRect(0,0,wt.width,wt.height),As(lt,p([it,pt]),0,pt,!1,!1,0,0,vt.width,vt.height,!1,We,We.bgCell,Nt,Te,1,void 0,!1,0,void 0,void 0,void 0,Io,mt,()=>{},0))),wt.style.left="-100%",wt.style.position="absolute",wt.style.width=`${vt.width}px`,wt.style.height=`${vt.height}px`,document.body.append(wt),z.dataTransfer.setDragImage(wt,vt.width/2,vt.height/2),window.setTimeout(()=>{wt.remove()},0)}}else z.preventDefault()},[Ge,ke,St,fe,xt,We,Oe,Te,Fe,p,Nt,Io,mt]);Qt("dragstart",mi,(U==null?void 0:U.current)??null,!1,!1);const Oo=s.useRef(),$o=s.useCallback(z=>{const V=Ze.current;if($e!==void 0&&z.preventDefault(),V===null||Xe===void 0)return;const le=St(V,z.clientX,z.clientY),[de,ee]=le.location,se=de-(q?0:1),[Ae,R]=Oo.current??[];(Ae!==se||R!==ee)&&(Oo.current=[se,ee],Xe([se,ee],z.dataTransfer))},[q,St,Xe,$e]);Qt("dragover",$o,(U==null?void 0:U.current)??null,!1,!1);const jn=s.useCallback(()=>{Oo.current=void 0,re==null||re()},[re]);Qt("dragend",jn,(U==null?void 0:U.current)??null,!1,!1);const No=s.useCallback(z=>{const V=Ze.current;if(V===null||$e===void 0)return;z.preventDefault();const le=St(V,z.clientX,z.clientY),[de,ee]=le.location,se=de-(q?0:1);$e([se,ee],z.dataTransfer)},[q,St,$e]);Qt("drop",No,(U==null?void 0:U.current)??null,!1,!1);const wi=s.useCallback(()=>{Ye==null||Ye()},[Ye]);Qt("dragleave",wi,(U==null?void 0:U.current)??null,!1,!1);const rr=s.useRef(D);rr.current=D;const Re=s.useRef(null),ho=s.useCallback(z=>{var V;Ze.current===null||!Ze.current.contains(document.activeElement)||(z===null&&rr.current.current!==void 0?(V=ce==null?void 0:ce.current)==null||V.focus({preventScroll:!0}):z!==null&&z.focus({preventScroll:!0}),Re.current=z)},[ce]);s.useImperativeHandle(t,()=>({focus:()=>{var V;const z=Re.current;z===null||!document.contains(z)?(V=ce==null?void 0:ce.current)==null||V.focus({preventScroll:!0}):z.focus({preventScroll:!0})},getBounds:(z,V)=>{if(!(ce===void 0||ce.current===null))return xt(ce.current,z??0,V??-1)},damage:Er,getMouseArgsForPosition:(z,V,le)=>{if(!(ce===void 0||ce.current===null))return St(ce.current,z,V,le)}}),[ce,Er,xt,St]);const ir=s.useRef(),Mn=Ga(()=>{var R,oe,Mt;if(n<50||(_==null?void 0:_.disableAccessibilityTree)===!0)return null;let z=Yi(Oe,ht,n,Z,me);const V=q?0:-1;!q&&((R=z[0])==null?void 0:R.sourceIndex)===0&&(z=z.slice(1));const[le,de]=((oe=D.current)==null?void 0:oe.cell)??[],ee=(Mt=D.current)==null?void 0:Mt.range,se=z.map(Ee=>Ee.sourceIndex),Ae=xo(l,Math.min(h,l+r));return le!==void 0&&de!==void 0&&!(se.includes(le)&&Ae.includes(de))&&ho(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":h+1,"aria-multiselectable":"true","aria-colcount":Oe.length+V},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},z.map(Ee=>s.createElement("th",{role:"columnheader","aria-selected":D.columns.hasIndex(Ee.sourceIndex),"aria-colindex":Ee.sourceIndex+1+V,tabIndex:-1,onFocus:it=>{if(it.target!==Re.current)return ze==null?void 0:ze([Ee.sourceIndex,-1])},key:Ee.sourceIndex},Ee.title)))),s.createElement("tbody",{role:"rowgroup"},Ae.map(Ee=>s.createElement("tr",{role:"row","aria-selected":D.rows.hasIndex(Ee),key:Ee,"aria-rowindex":Ee+2},z.map(it=>{const pt=it.sourceIndex,wt=Tn(pt,Ee),vt=le===pt&&de===Ee,A=ee!==void 0&&pt>=ee.x&&pt<ee.x+ee.width&&Ee>=ee.y&&Ee<ee.y+ee.height,lt=`glide-cell-${pt}-${Ee}`,bt=[pt,Ee],zn=p(bt,!0);return s.createElement("td",{key:wt,role:"gridcell","aria-colindex":pt+1+V,"aria-selected":A,"aria-readonly":So(zn)||!ro(zn),id:lt,"data-testid":lt,onClick:()=>{const pn=ce==null?void 0:ce.current;if(pn!=null)return ae==null?void 0:ae({bounds:xt(pn,pt,Ee),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:bt})},onFocusCapture:pn=>{var cn,je;if(!(pn.target===Re.current||((cn=ir.current)==null?void 0:cn[0])===pt&&((je=ir.current)==null?void 0:je[1])===Ee))return ir.current=bt,ze==null?void 0:ze(bt)},ref:vt?ho:void 0,tabIndex:-1},Pd(zn,mt))})))))},[n,Oe,ht,Z,me,h,l,r,D,ho,p,ce,ae,xt,ze],200),Go=E===0||!T?0:ht>E?1:kn(-me/100,0,1),Pn=-l*32+ot,go=W?kn(-Pn/100,0,1):0,lr=s.useMemo(()=>{if(!Go&&!go)return null;const z={position:"absolute",top:0,left:$n,width:n-$n,height:o,opacity:Go,pointerEvents:"none",transition:at?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},V={position:"absolute",top:ct,left:0,width:n,height:o,opacity:go,pointerEvents:"none",transition:Yt?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,Go>0&&s.createElement("div",{id:"shadow-x",style:z}),go>0&&s.createElement("div",{id:"shadow-y",style:V}))},[Go,go,$n,n,at,ct,o,Yt]),Pr=s.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:-1,onKeyDown:gi,onKeyUp:Ar,onFocus:G,onBlur:F,ref:Wo,style:Ao},Mn),s.createElement("canvas",{ref:gt,style:Pr}),lr)},Ld=s.memo(s.forwardRef(zd));function br(e,t,n,o){return kn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Bd=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,c]=s.useState(),[l,d]=s.useState(),[f,u]=s.useState(!1),[m,g]=s.useState(),[w,h]=s.useState(),[p,C]=s.useState(),[x,y]=s.useState(!1),[k,I]=s.useState(),{onHeaderMenuClick:G,onHeaderIndicatorClick:F,getCellContent:H,onColumnMoved:D,onColumnResize:E,onColumnResizeStart:O,onColumnResizeEnd:$,gridRef:T,maxColumnWidth:W,minColumnWidth:B,onRowMoved:J,lockColumns:Q,onColumnProposeMove:pe,onMouseDown:be,onMouseUp:ye,onItemHovered:Z,onDragStart:q,canvasRef:ae}=e,ve=(E??$??O)!==void 0,{columns:we,selection:ce}=e,fe=ce.columns,re=s.useCallback(xe=>{const[He,he]=xe.location;i!==void 0&&l!==He&&He>=Q?(u(!0),d(He)):w!==void 0&&he!==void 0?(y(!0),C(Math.max(0,he))):o===void 0&&!f&&!x&&(Z==null||Z(xe))},[i,w,l,Z,Q,o,f,x]),U=D!==void 0,ke=s.useCallback(xe=>{var He;if(xe.button===0){const[he,Fe]=xe.location;if(xe.kind==="out-of-bounds"&&xe.isEdge&&ve){const ze=(He=T==null?void 0:T.current)==null?void 0:He.getBounds(we.length-1,-1);ze!==void 0&&(n(ze.x),r(we.length-1))}else if(xe.kind==="header"&&he>=Q){const ze=ae==null?void 0:ae.current;if(xe.isEdge&&ve&&ze){n(xe.bounds.x),r(he);const $e=ze.getBoundingClientRect().width/ze.offsetWidth,Ye=xe.bounds.width/$e;O==null||O(we[he],Ye,he,Ye+(we[he].growOffset??0))}else xe.kind==="header"&&U&&(g(xe.bounds.x),c(he))}else xe.kind==="cell"&&Q>0&&he===0&&Fe!==void 0&&J!==void 0&&(I(xe.bounds.y),h(Fe))}be==null||be(xe)},[be,ve,Q,J,T,we,U,O,ae]),ue=s.useCallback((xe,He)=>{f||x||G==null||G(xe,He)},[f,x,G]),Be=s.useCallback((xe,He)=>{f||x||F==null||F(xe,He)},[f,x,F]),Ge=s.useRef(-1),ie=s.useCallback(()=>{Ge.current=-1,h(void 0),C(void 0),I(void 0),y(!1),c(void 0),d(void 0),g(void 0),u(!1),r(void 0),n(void 0)},[]),Me=s.useCallback((xe,He)=>{if(xe.button===0){if(o!==void 0){if((fe==null?void 0:fe.hasIndex(o))===!0)for(const Fe of fe){if(Fe===o)continue;const ze=we[Fe],Xe=br(ze,Ge.current,B,W);E==null||E(ze,Xe,Fe,Xe+(ze.growOffset??0))}const he=br(we[o],Ge.current,B,W);if($==null||$(we[o],he,o,he+(we[o].growOffset??0)),fe.hasIndex(o))for(const Fe of fe){if(Fe===o)continue;const ze=we[Fe],Xe=br(ze,Ge.current,B,W);$==null||$(ze,Xe,Fe,Xe+(ze.growOffset??0))}}ie(),i!==void 0&&l!==void 0&&(pe==null?void 0:pe(i,l))!==!1&&(D==null||D(i,l)),w!==void 0&&p!==void 0&&(J==null||J(w,p))}ye==null||ye(xe,He)},[ye,o,i,l,w,p,fe,$,we,B,W,E,D,J,ie,pe]),Qe=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(pe==null?void 0:pe(i,l))!==!1)return{src:i,dest:l}},[i,l,pe]),ft=s.useCallback(xe=>{const He=ae==null?void 0:ae.current;if(i!==void 0&&m!==void 0)Math.abs(xe.clientX-m)>20&&u(!0);else if(w!==void 0&&k!==void 0)Math.abs(xe.clientY-k)>20&&y(!0);else if(o!==void 0&&t!==void 0&&He){const Fe=He.getBoundingClientRect().width/He.offsetWidth,ze=(xe.clientX-t)/Fe,Xe=we[o],$e=br(Xe,ze,B,W);if(E==null||E(Xe,$e,o,$e+(Xe.growOffset??0)),Ge.current=ze,(fe==null?void 0:fe.first())===o)for(const Ye of fe){if(Ye===o)continue;const tt=we[Ye],at=br(tt,Ge.current,B,W);E==null||E(tt,at,Ye,at+(tt.growOffset??0))}}},[i,m,w,k,o,t,we,B,W,E,fe,ae]),We=s.useCallback((xe,He)=>{if(w===void 0||p===void 0)return H(xe,He);let[he,Fe]=xe;return Fe===p?Fe=w:(Fe>p&&(Fe-=1),Fe>=w&&(Fe+=1)),H([he,Fe],He)},[w,p,H]),It=s.useCallback(xe=>{q==null||q(xe),xe.defaultPrevented()||ie()},[ie,q]);return s.createElement(Ld,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:We,isResizing:o!==void 0,onHeaderMenuClick:ue,onHeaderIndicatorClick:Be,isDragging:f,onItemHovered:re,onDragStart:It,onMouseDown:ke,allowResize:ve,onMouseUp:Me,dragAndDropState:Qe,onMouseMoveRaw:ft,ref:T})};function Wd(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=c=>{for(const l of c){const{width:d,height:f}=l&&l.contentRect||{};o(u=>u.width===d&&u.height===f?u:{width:d,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Od=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),c=s.useRef(0),l=s.useRef(t);l.current=t;const d=n.current;s.useEffect(()=>{const f=()=>{var g,w;if(r.current===!1&&d!==null){const h=[d.scrollLeft,d.scrollTop];if(((g=i.current)==null?void 0:g[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(c.current>10){i.current=null,r.current=null;return}else c.current++;else c.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},m=g=>{g.touches.length===0&&(r.current=!1,c.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&d!==null){const g=d;return g.addEventListener("touchstart",u),g.addEventListener("touchend",m),()=>{g.removeEventListener("touchstart",u),g.removeEventListener("touchend",m),o.current!==null&&window.clearTimeout(o.current)}}},[e,d])},$d=()=>e=>e.isSafari?"scroll":"auto",Nd=en("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[$d()]}}),Gd=33554400,Xd=5e6;function Yd(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Qt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Qt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Kd=e=>{var ce,fe;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:c,className:l,preventDiagonalScrolling:d=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:m,rightElementProps:g,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:p}=e,C=[],x=(g==null?void 0:g.sticky)??!1,y=(g==null?void 0:g.fill)??!1,k=s.useRef(0),I=s.useRef(0),G=s.useRef(null),F=typeof window>"u"?1:window.devicePixelRatio,H=s.useRef(F);s.useEffect(()=>{if(H.current!==F){k.current=0,I.current=0,H.current=F;const re=G.current;re!==null&&J.current(re.scrollLeft,re.scrollTop)}},[F]);const D=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),E=s.useRef(null),O=Yd(200),[$,T]=s.useState(!0),W=s.useRef(0);s.useLayoutEffect(()=>{if(!$||O||D.current.lockDirection===void 0)return;const re=G.current;if(re===null)return;const[U,ke]=D.current.lockDirection;U!==void 0?re.scrollLeft=U:ke!==void 0&&(re.scrollTop=ke),D.current.lockDirection=void 0},[O,$]);const B=s.useCallback((re,U)=>{var he;const ke=G.current;if(ke===null)return;U=U??ke.scrollTop,re=re??ke.scrollLeft;const ue=D.current.scrollTop,Be=D.current.scrollLeft,Ge=re-Be,ie=U-ue;O&&Ge!==0&&ie!==0&&(Math.abs(Ge)>3||Math.abs(ie)>3)&&d&&D.current.lockDirection===void 0&&(D.current.lockDirection=Math.abs(Ge)<Math.abs(ie)?[Be,void 0]:[void 0,ue]);const Me=D.current.lockDirection;re=(Me==null?void 0:Me[0])??re,U=(Me==null?void 0:Me[1])??U,D.current.scrollLeft=re,D.current.scrollTop=U;const Qe=ke.clientWidth,ft=ke.clientHeight,We=U,It=I.current-We,xe=ke.scrollHeight-ft;I.current=We;let He;if(xe>0&&o>ke.scrollHeight+5)if(Math.abs(It)>2e3||We===0||We===xe){const Fe=Math.max(0,Math.min(1,We/xe)),ze=o-ft;He=Fe*ze,k.current=He}else k.current-=It,He=k.current;else He=We,k.current=He;He=Math.max(0,Math.min(He,o-ft)),k.current=He,Me!==void 0&&(window.clearTimeout(W.current),T(!1),W.current=window.setTimeout(()=>T(!0),200)),i({x:re,y:He,width:Qe-u,height:ft-f,paddingRight:((he=E.current)==null?void 0:he.clientWidth)??0})},[f,u,o,i,d,O]);Od(w&&ii.value,B,G);const J=s.useRef(B);J.current=B;const Q=s.useRef(),pe=s.useRef(!1);s.useLayoutEffect(()=>{pe.current?B():pe.current=!0},[B,f,u]);const be=s.useCallback(re=>{G.current=re,h!==void 0&&(h.current=re)},[h]);let ye=0,Z=0;const q=Math.min(o,Gd);for(C.push(s.createElement("div",{key:ye++,style:{width:r,height:0}}));Z<q;){const re=Math.min(Xd,q-Z);C.push(s.createElement("div",{key:ye++,style:{width:0,height:re}})),Z+=re}const{ref:ae,width:ve,height:we}=Wd(p);return typeof window<"u"&&(((ce=Q.current)==null?void 0:ce.height)!==we||((fe=Q.current)==null?void 0:fe.width)!==ve)&&(window.setTimeout(()=>J.current(),0),Q.current={width:ve,height:we}),(ve??0)===0||(we??0)===0?s.createElement("div",{ref:ae}):s.createElement("div",{ref:ae},s.createElement(Nd,{isSafari:ii.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:be,style:Q.current,draggable:c,onDragStart:re=>{c||(re.stopPropagation(),re.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>B()},s.createElement("div",{className:"dvn-scroll-inner"+(m===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},C),m!==void 0&&s.createElement(s.Fragment,null,!y&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:E,style:{height:we,maxHeight:n-Math.ceil(F%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:y?1:void 0,right:x?u??0:void 0,pointerEvents:"auto"}},m))))))},_d=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:c,freezeColumns:l,experimental:d,nonGrowWidth:f,clientSize:u,className:m,onVisibleRegionChanged:g,scrollRef:w,preventDiagonalScrolling:h,rightElement:p,rightElementProps:C,overscrollX:x,overscrollY:y,initialSize:k,smoothScrollX:I=!1,smoothScrollY:G=!1,isDraggable:F}=e,{paddingRight:H,paddingBottom:D}=d??{},[E,O]=u,$=s.useRef(),T=s.useRef(),W=s.useRef(),B=s.useRef(),J=f+Math.max(0,x??0);let Q=c?r+i:r;if(typeof o=="number")Q+=n*o;else for(let Z=0;Z<n;Z++)Q+=o(Z);y!==void 0&&(Q+=y);const pe=s.useRef(),be=s.useCallback(()=>{var Be,Ge;if(pe.current===void 0)return;const Z={...pe.current};let q=0,ae=Z.x<0?-Z.x:0,ve=0,we=0;Z.x=Z.x<0?0:Z.x;let ce=0;for(let ie=0;ie<l;ie++)ce+=t[ie].width;for(const ie of t){const Me=q-ce;if(Z.x>=Me+ie.width)q+=ie.width,we++,ve++;else if(Z.x>Me)q+=ie.width,I?ae+=Me-Z.x:we++,ve++;else if(Z.x+Z.width>Me)q+=ie.width,ve++;else break}let fe=0,re=0,U=0;if(typeof o=="number")G?(re=Math.floor(Z.y/o),fe=re*o-Z.y):re=Math.ceil(Z.y/o),U=Math.ceil(Z.height/o)+re,fe<0&&U++;else{let ie=0;for(let Me=0;Me<n;Me++){const Qe=o(Me),ft=ie+(G?0:Qe/2);if(Z.y>=ie+Qe)ie+=Qe,re++,U++;else if(Z.y>ft)ie+=Qe,G?fe+=ft-Z.y:re++,U++;else if(Z.y+Z.height>Qe/2+ie)ie+=Qe,U++;else break}}re=Math.max(0,Math.min(re,n-1)),U=Math.max(re,Math.min(U,n));const ke={x:we,y:re,width:ve-we,height:U-re},ue=$.current;(ue===void 0||ue.y!==ke.y||ue.x!==ke.x||ue.height!==ke.height||ue.width!==ke.width||T.current!==ae||W.current!==fe||Z.width!==((Be=B.current)==null?void 0:Be[0])||Z.height!==((Ge=B.current)==null?void 0:Ge[1]))&&(g==null||g({x:we,y:re,width:ve-we,height:U-re},Z.width,Z.height,Z.paddingRight??0,ae,fe),$.current=ke,T.current=ae,W.current=fe,B.current=[Z.width,Z.height])},[t,o,n,g,l,I,G]),ye=s.useCallback(Z=>{pe.current=Z,be()},[be]);return s.useEffect(()=>{be()},[be]),s.createElement(Kd,{scrollRef:w,className:m,kineticScrollPerfHack:d==null?void 0:d.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:F===!0||typeof F=="string",scrollWidth:J+(H??0),scrollHeight:Q+(D??0),clientHeight:O,rightElement:p,paddingBottom:D,paddingRight:H,rightElementProps:C,update:ye,initialSize:k},s.createElement(Bd,{eventTargetRef:w,width:E,height:O,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Vd=en("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Ud=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),qd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),jd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Zd=10,Jd=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:c,searchResults:l,onSearchValueChange:d,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:m=!1,onSearchClose:g}=e,[w]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,p]=s.useState(""),C=c??h,x=s.useCallback(q=>{p(q),d==null||d(q)},[d]),[y,k]=s.useState(),I=s.useRef(y);I.current=y,s.useEffect(()=>{l!==void 0&&(l.length>0?k(q=>({rowsSearched:o,results:l.length,selectedIndex:(q==null?void 0:q.selectedIndex)??-1})):k(void 0))},[o,l]);const G=s.useRef();G.current===void 0&&(G.current=new AbortController);const F=s.useRef(),[H,D]=s.useState([]),E=l??H,O=s.useCallback(()=>{F.current!==void 0&&(window.cancelAnimationFrame(F.current),F.current=void 0),G.current!==void 0&&G.current.abort(),G.current=new AbortController},[]),$=s.useRef(n);$.current=n;const T=s.useCallback(q=>{const ae=new RegExp(q.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ve=$.current,we=Math.min(10,o),ce=0;k(void 0),D([]);const fe=[],re=async()=>{var We;if(f===void 0)return;const U=performance.now(),ke=o-ce;let ue=f({x:0,y:ve,width:r.length,height:Math.min(we,ke,o-ve)},G.current.signal);typeof ue=="function"&&(ue=await ue());let Be=!1;for(const[It,xe]of ue.entries())for(const[He,he]of xe.entries()){let Fe;switch(he.kind){case te.Text:case te.Number:Fe=he.displayData;break;case te.Uri:case te.Markdown:Fe=he.data;break;case te.Boolean:Fe=typeof he.data=="boolean"?he.data.toString():void 0;break;case te.Image:case te.Bubble:Fe=he.data.join("🐳");break;case te.Custom:Fe=he.copyData;break}Fe!==void 0&&ae.test(Fe)&&(fe.push([He,It+ve]),Be=!0)}const Ge=performance.now();Be&&D([...fe]),ce+=ue.length,un(ce<=o);const ie=((We=I.current)==null?void 0:We.selectedIndex)??-1;k({results:fe.length,rowsSearched:ce,selectedIndex:ie}),u==null||u(fe,ie),ve+we>=o?ve=0:ve+=we;const Me=Ge-U,Qe=Math.max(Me,1),ft=Zd/Qe;we=Math.ceil(we*ft),ce<o&&fe.length<1e3&&(F.current=window.requestAnimationFrame(re))};O(),F.current=window.requestAnimationFrame(re)},[O,r.length,f,u,o]),W=s.useCallback(()=>{var q;g==null||g(),k(void 0),D([]),u==null||u([],-1),O(),(q=t==null?void 0:t.current)==null||q.focus()},[O,t,g,u]),B=s.useCallback(q=>{x(q.target.value),l===void 0&&(q.target.value===""?(k(void 0),D([]),O()):T(q.target.value))},[T,O,x,l]);s.useEffect(()=>{i.current!==null&&(x(""),k(void 0),H.length>0&&(D([]),u==null||u([],-1)),m?i.current.focus({preventScroll:!0}):O())},[m,i]);const J=s.useCallback(q=>{var ve;if((ve=q==null?void 0:q.stopPropagation)==null||ve.call(q),y===void 0||y.results===0)return;const ae=(y.selectedIndex+1)%y.results;k({...y,selectedIndex:ae}),u==null||u(E,ae)},[y,u,E]),Q=s.useCallback(q=>{var ve;if((ve=q==null?void 0:q.stopPropagation)==null||ve.call(q),y===void 0||y.results===0)return;let ae=(y.selectedIndex-1)%y.results;ae<0&&(ae+=y.results),k({...y,selectedIndex:ae}),u==null||u(E,ae)},[u,E,y]),pe=s.useCallback(q=>{(q.ctrlKey||q.metaKey)&&q.nativeEvent.code==="KeyF"||q.key==="Escape"?(W(),q.stopPropagation(),q.preventDefault()):q.key==="Enter"&&(q.shiftKey?Q():J())},[W,J,Q]);s.useEffect(()=>()=>{O()},[O]);const[be,ye]=s.useState(!1);s.useEffect(()=>{if(m)ye(!0);else{const q=setTimeout(()=>ye(!1),150);return()=>clearTimeout(q)}},[m]);const Z=s.useMemo(()=>{if(!m&&!be)return null;let q;y!==void 0&&(q=y.results>=1e3?"over 1000":`${y.results} result${y.results!==1?"s":""}`,y.selectedIndex>=0&&(q=`${y.selectedIndex+1} of ${q}`));const ae=ce=>{ce.stopPropagation()},we={width:`${o>0?Math.floor(((y==null?void 0:y.rowsSearched)??0)/o*100):0}%`};return s.createElement(Vd,{className:"gdg-search-bar"+(m?"":" out"),onMouseDown:ae,onMouseMove:ae,onMouseUp:ae,onClick:ae},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:w,"aria-hidden":!m,"data-testid":"search-input",ref:i,onChange:B,value:C,tabIndex:m?void 0:-1,onKeyDownCapture:pe}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:Q,disabled:((y==null?void 0:y.results)??0)===0},Ud),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:J,disabled:((y==null?void 0:y.results)??0)===0},qd),g!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!m,"data-testid":"search-close-button",tabIndex:m?void 0:-1,onClick:W},jd)),y!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},q)),s.createElement("div",{className:"gdg-search-progress",style:we})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:w},"Type to search")))},[m,be,y,o,w,i,B,C,pe,Q,J,g,W]);return s.createElement(s.Fragment,null,s.createElement(_d,{prelightCells:E,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Z)},Qd=()=>e=>Math.max(16,e.targetHeight-10),eu=en("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[Qd(),"px"]}}),tu=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[c,l]=Rt.useState(n);return Rt.createElement(gs,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Rt.createElement(eu,{targetHeight:t.height,"data-testid":"group-rename-input",value:c,onBlur:o,onFocus:d=>d.target.setSelectionRange(0,c.length),onChange:d=>l(d.target.value),onKeyDown:d=>{d.key==="Enter"?i(c):d.key==="Escape"&&o()},autoFocus:!0}))};function nu(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Ve(e,t,n){const o=Ws(e,t);return o&&(n.didMatch=!0),o}function Ws(e,t){if(e.length===0)return!1;if(e.includes("|")){const d=e.split("|");for(const f of d)if(Ws(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const c=e.split("+"),l=c.pop();if(!nu(l,t))return!1;if(c[0]==="any")return!0;for(const d of c)switch(d){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":li.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function ou(e,t,n,o,r,i,c){const l=Rt.useCallback((u,m,g,w)=>{var k;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!c&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(g||w==="drag")||n==="additive",p=(o==="mixed"||o==="additive")&&h,C=g||(r==="mixed"||r==="additive")&&h;let x={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((k=e.current)==null?void 0:k.rangeStack)??[]:[]},columns:p?e.columns:st.empty(),rows:C?e.rows:st.empty()};g&&(i==="multi-rect"||i==="multi-cell")&&x.current!==void 0&&e.current!==void 0&&(x={...x,current:{...x.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(x,m)},[o,e,n,i,c,r,t]),d=Rt.useCallback((u,m,g)=>{u=u??e.rows,m!==void 0&&(u=u.add(m));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:st.empty(),rows:u};else{const h=g&&n==="mixed"||n==="additive",p=g&&o==="mixed"||o==="additive";w={current:h?e.current:void 0,columns:p?e.columns:st.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=Rt.useCallback((u,m,g)=>{u=u??e.columns,m!==void 0&&(u=u.add(m));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:st.empty(),columns:u};else{const h=g&&n==="mixed"||n==="additive",p=g&&r==="mixed"||r==="additive";w={current:h?e.current:void 0,rows:p?e.rows:st.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,d,f]}function ru(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let m=f.y;m<f.y+f.height;m++){const g=[];for(let w=f.x;w<f.x+f.width;w++)w<0||m>=r?g.push({kind:te.Loading,allowOverlay:!1}):g.push(t([w,m]));u.push(g)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),c=e!==void 0?i:void 0,l=s.useCallback(f=>{if(c===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const m=c(u,o.signal);return typeof m=="function"?async()=>(await m()).map(g=>[{kind:te.Loading,allowOverlay:!1},...g]):m.map(g=>[{kind:te.Loading,allowOverlay:!1},...g])}return c(u,o.signal)},[o.signal,c,n]);return[e!==void 0?l:void 0,c]}function iu(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case te.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===qi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case te.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case te.Image:case te.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case te.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case te.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case te.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case te.Markdown:case te.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case te.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case te.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case te.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Cr()}}function lu(e,t){return e.map((o,r)=>{const i=t[r];return o.map(c=>c.span!==void 0&&c.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:iu(c))})}function Ul(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function su(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(c=>Ul(c,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:Ul(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Bi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function ql(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function au(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function cu(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Bi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((c,l)=>`<li gdg-raw-value=${ql(r.rawValue[l])}>`+Bi(c)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${ql(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Bi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function du(e,t){const n=lu(e,t),o=su(n),r=cu(n);return{textPlain:o,textHtml:r}}function jl(e){var c;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const d=l.cloneNode(!0),u=d.children.length===1&&d.children[0].nodeName==="P"?d.children[0]:null,m=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",g=d.querySelectorAll("br");for(const p of g)p.replaceWith(`
`);const w=d.getAttribute("gdg-raw-value"),h=d.getAttribute("gdg-format")??"string";if(d.querySelector("a")!==null)i==null||i.push({rawValue:((c=d.querySelector("a"))==null?void 0:c.getAttribute("href"))??"",formatted:d.textContent??"",format:h});else if(d.querySelector("ol")!==null){const p=d.querySelectorAll("li");i==null||i.push({rawValue:[...p].map(C=>C.getAttribute("gdg-raw-value")??""),formatted:[...p].map(C=>C.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:au(w),formatted:d.textContent??"",format:h});else{let p=d.textContent??"";m&&(p=p.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:p??"",formatted:p??"",format:h})}}}return i!==void 0&&r.push(i),r}function uu(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let c=!1;do{if((e==null?void 0:e.current)===void 0)break;const d=(l=e.current)==null?void 0:l.range,f=[];if(d.width>2){const g=t({x:d.x,y:d.y,width:1,height:d.height},r.signal);if(typeof g=="function")return i;f.push(...g);const w=t({x:d.x+d.width-1,y:d.y,width:1,height:d.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const g=t({x:d.x,y:d.y,width:d.width,height:d.height},r.signal);if(typeof g=="function")return i;f.push(...g)}let u=d.x-n,m=d.x+d.width-1-n;for(const g of f)for(const w of g)w.span!==void 0&&(u=Math.min(w.span[0],u),m=Math.max(w.span[1],m));u===d.x-n&&m===d.x+d.width-1-n?c=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:d.y,width:m-u+1,height:d.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!c);return e}function Zl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function fu(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let c=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,c)),r=c+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Zl(e.slice(r,c))),r=c+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}c++}return r<e.length&&o.push(Zl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(d=>({rawValue:d,formatted:d,format:"string"})))}function Jl(e,t,n){var l;const o=du(e,t),r=d=>{var f;(f=window.navigator.clipboard)==null||f.writeText(d)},i=(d,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([d],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},c=(d,f)=>{var u,m;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",d),(m=n==null?void 0:n.clipboardData)==null||m.setData("text/html",f)}catch{i(d,f)||r(d)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?c(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function Os(e){return e!==!0}function Ql(e){return typeof e=="string"?e:`${e}px`}const hu=()=>e=>e.innerWidth,gu=()=>e=>e.innerHeight,mu=en("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[hu()],"wmyidgi-1":[gu()]}}),wu=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(mu,{innerHeight:Ql(n),innerWidth:Ql(t),...r},o)},pu=2,bu=1300;function yu(e,t,n){const o=Rt.useRef(0),[r,i]=e??[0,0];Rt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let c=!1,l=0;const d=f=>{var u;if(!c){if(l===0)l=f;else{const m=f-l;o.current=Math.min(1,o.current+m/bu);const g=o.current**1.618*m*pu;(u=t.current)==null||u.scrollBy(r*g,i*g),l=f,n==null||n()}window.requestAnimationFrame(d)}};return window.requestAnimationFrame(d),()=>{c=!0}},[t,r,i,n])}function vu({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:c,remSize:l}){const[d,f,u,m,g,w]=Rt.useMemo(()=>{if(!c||l===16)return[e,t,n,o,r,i];const h=l/16,p=e,C=ps();return[typeof p=="number"?p*h:x=>Math.ceil(p(x)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??C.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??C.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??C.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,c,o]);return{rowHeight:d,headerHeight:f,groupHeaderHeight:u,theme:m,overscrollX:g,overscrollY:w}}const no={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Ue(e,t){return e===!0?t:e===!1?"":e}function es(e){const t=li.value;return{activateCell:Ue(e.activateCell," |Enter|shift+Enter"),clear:Ue(e.clear,"any+Escape"),closeOverlay:Ue(e.closeOverlay,"any+Escape"),acceptOverlayDown:Ue(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Ue(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Ue(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Ue(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Ue(e.delete,t?"Backspace|Delete":"Delete"),downFill:Ue(e.downFill,"primary+_68"),scrollToSelectedCell:Ue(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Ue(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Ue(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Ue(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Ue(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Ue(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Ue(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Ue(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Ue(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Ue(e.goToFirstCell,"primary+Home"),goToFirstColumn:Ue(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Ue(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Ue(e.goToLastCell,"primary+End"),goToLastColumn:Ue(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Ue(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Ue(e.goToNextPage,"PageDown"),goToPreviousPage:Ue(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Ue(e.rightFill,"primary+_82"),search:Ue(e.search,"primary+f"),selectAll:Ue(e.selectAll,"primary+a"),selectColumn:Ue(e.selectColumn,"ctrl+ "),selectGrowDown:Ue(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Ue(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Ue(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Ue(e.selectGrowUp,"shift+ArrowUp"),selectRow:Ue(e.selectRow,"shift+ "),selectToFirstCell:Ue(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Ue(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Ue(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Ue(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Ue(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Ue(e.selectToLastRow,"primary+shift+ArrowDown")}}function Cu(e){const t=Va(e);return Rt.useMemo(()=>{if(t===void 0)return es(no);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??no.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??no.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??no.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??no.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??no.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??no.selectToLastCell};return es({...no,...n})},[t])}function ku(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const c={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(c.subGroups=o.subGroups.map((l,d)=>t(l,r+1,[...i,d])).sort((l,d)=>l.headerIndex-d.headerIndex)),c}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function ll(e,t){const n=[];function o(l,d,f=!1){let u=d!==null?d-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let m=0;m<l.subGroups.length;m++){const g=m<l.subGroups.length-1?l.subGroups[m+1].headerIndex:d;o(l.subGroups[m],g,f||l.isCollapsed)}}const r=ku(e.groups);for(let l=0;l<r.length;l++){const d=l<r.length-1?r[l+1].headerIndex:null;o(r[l],d)}let i=0,c=0;for(const l of n)l.contentIndex=c,c+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:d,...f}=l;return f})}function Ui(e,t){if(t===void 0||ll.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function xu(e,t,n,o){const r=Rt.useMemo(()=>e===void 0?void 0:ll(e,t),[e,t]),i=Rt.useMemo(()=>r==null?void 0:r.reduce((u,m)=>(u[m.rowIndex]=m,u),{}),[r]),c=Rt.useMemo(()=>r===void 0?t:r.reduce((u,m)=>u+(m.isCollapsed?1:m.rows+1),0),[r,t]),l=Rt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),d=Rt.useCallback(u=>{if(r===void 0)return u;let m=u;for(const g of r){if(m===0)return;if(m--,!g.isCollapsed){if(m<g.rows)return g.contentIndex+m;m-=g.rows}}return u},[r]),f=io(o??(e==null?void 0:e.themeOverride),Rt.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:m,contentIndex:g,groupIndex:w}=Ui(u,r);return m?e.themeOverride:o==null?void 0:o(u,w,g)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:d,getRowThemeOverride:f}:{rowHeight:l,rows:c,rowNumberMapper:d,getRowThemeOverride:f}}function Su(e,t){const n=Rt.useMemo(()=>e===void 0?void 0:ll(e,t),[e,t]);return{getRowGroupingForPath:Ns,updateRowGroupingByPath:$s,mapper:Rt.useCallback(o=>{if(typeof o=="number")return Ui(o,n);const r=Ui(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function $s(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,c)=>c===o?{...i,...n}:i):e.map((i,c)=>c===o?{...i,subGroups:$s(i.subGroups??[],r,n)}:i)}function Ns(e,t){const[n,...o]=t;return o[0]===-1?e[n]:Ns(e[n].subGroups??[],o)}function Mu(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Eu(e,t,n,o,r){const[i,c]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:c}),[o,c,i]),[d,f,u]=_a(l),m=s.useRef(r);m.current=r;const g=Mu(null,p=>{p!==null&&t!==void 0?p.scrollTop=t:p!==null&&e!==void 0&&(p.scrollLeft=e)}),w=(d.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&g.current!==null&&w){if(g.current.scrollTop===t)return;g.current.scrollTop=t,g.current.scrollTop!==t&&u(),m.current()}},[t,w,u,g]);const h=(d.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&g.current!==null&&h){if(g.current.scrollLeft===e)return;g.current.scrollLeft=e,g.current.scrollLeft!==e&&u(),m.current()}},[e,h,u,g]),{visibleRegion:d,setVisibleRegion:f,scrollRef:g}}const Ru=en("textarea")({name:"GhostInputBox",class:"gdg-g1wsindo",propsAsIs:!1}),Iu=(e,t)=>{const{onInput:n,onCompositionStart:o,onCompositionEnd:r,onKeyDown:i,onKeyUp:c,onFocus:l,onBlur:d,disabled:f=!1}=e,u=s.useRef(null),m=s.useRef(!1),g=s.useRef({width:0,height:0}),w=s.useCallback(()=>{const k=u.current;if(!k||k.style.opacity==="0")return;const I=g.current.width,G=g.current.height;k.style.width=`${I}px`,k.style.height=`${G}px`;const F=Math.max(I,k.scrollWidth+2),H=Math.max(G,k.scrollHeight+2);k.style.width=`${F}px`,k.style.height=`${H}px`},[]);s.useImperativeHandle(t,()=>({focus:()=>{var k;(k=u.current)==null||k.focus({preventScroll:!0})},blur:()=>{var k;(k=u.current)==null||k.blur()},clear:()=>{u.current&&(u.current.value="",u.current.setSelectionRange(0,0))},getValue:()=>{var k;return((k=u.current)==null?void 0:k.value)??""},setValue:k=>{if(u.current){u.current.value=k;const I=k.length;u.current.setSelectionRange(I,I)}},setPosition:(k,I,G,F)=>{const H=u.current;H&&(g.current={width:G,height:F},H.style.left=`${k}px`,H.style.top=`${I}px`,H.style.width=`${G}px`,H.style.height=`${F}px`)},setVisible:k=>{const I=u.current;I&&(k?(I.style.opacity="1",I.style.pointerEvents="auto",I.style.zIndex="10000"):(I.style.left="-9999px",I.style.top="0",I.style.width="1px",I.style.height="1px",I.style.opacity="0",I.style.pointerEvents="none",I.style.zIndex="0"))}}));const h=s.useCallback(k=>{const I=k.currentTarget;n(I.value,m.current),w()},[n,w]),p=s.useCallback(()=>{m.current=!0,o()},[o]),C=s.useCallback(k=>{m.current=!1,r(k.currentTarget.value)},[r]),x=s.useCallback(k=>{i(k)},[i]),y=s.useCallback(k=>{c==null||c(k)},[c]);return s.createElement(Ru,{ref:u,defaultValue:"",tabIndex:f?-1:0,disabled:f,onInput:h,onCompositionStart:p,onCompositionEnd:C,onKeyDown:x,onKeyUp:y,onFocus:l,onBlur:d,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},Hu=s.memo(s.forwardRef(Iu)),Du=s.lazy(async()=>await rs(()=>Promise.resolve().then(()=>uc),void 0,import.meta.url));let Fu=0;function Tu(e){return La(Dl(Dl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return xo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Jr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const oo={kind:te.Loading,allowOverlay:!1},Wi={columns:st.empty(),rows:st.empty(),current:void 0},Au=(e,t)=>{var Rl,Il,Hl;const[n,o]=s.useState(Wi),[r,i]=s.useState(),c=s.useRef(null),l=s.useRef(null),[d,f]=s.useState(),u=s.useRef(void 0),m=s.useRef(null),[g,w]=s.useState(!1),h=s.useRef(g);h.current=g;const p=s.useRef(r);p.current=r;const C=typeof window>"u"?null:window,{imageEditorOverride:x,getRowThemeOverride:y,markdownDivCreateNode:k,width:I,height:G,columns:F,rows:H,getCellContent:D,onCellClicked:E,onCellActivated:O,onFillPattern:$,onFinishedEditing:T,coercePasteValue:W,drawHeader:B,drawCell:J,editorBloom:Q,onHeaderClicked:pe,onColumnProposeMove:be,rangeSelectionColumnSpanning:ye=!0,spanRangeBehavior:Z="default",onGroupHeaderClicked:q,onCellContextMenu:ae,className:ve,onHeaderContextMenu:we,getCellsForSelection:ce,onGroupHeaderContextMenu:fe,onGroupHeaderRenamed:re,onCellEdited:U,onCellsEdited:ke,onSearchResultsChanged:ue,searchResults:Be,onSearchValueChange:Ge,searchValue:ie,onKeyDown:Me,onKeyUp:Qe,keybindings:ft,editOnType:We=!0,onRowAppended:It,onColumnAppended:xe,onColumnMoved:He,validateCell:he,highlightRegions:Fe,rangeSelect:ze="rect",columnSelect:Xe="multi",rowSelect:$e="multi",rangeSelectionBlending:Ye="exclusive",columnSelectionBlending:tt="exclusive",rowSelectionBlending:at="exclusive",onDelete:Yt,onDragStart:_,onMouseMove:mt,onPaste:nt,copyHeaders:me=!1,freezeColumns:ot=0,cellActivationBehavior:ht="second-click",rowSelectionMode:Ze="auto",columnSelectionMode:qe="auto",onHeaderMenuClick:kt,onHeaderIndicatorClick:Nt,getGroupDetails:Ot,rowGrouping:Bt,onSearchClose:Dt,onItemHovered:Vt,onSelectionCleared:Ht,showSearch:On,onVisibleRegionChanged:gn,gridSelection:rt,onGridSelectionChange:xn,minColumnWidth:gt=50,maxColumnWidth:Ut=500,maxColumnAutoWidth:sn,provideEditor:an,trailingRowOptions:Ke,freezeTrailingRows:Gt=0,allowedFillDirections:Te="orthogonal",scrollOffsetX:ct,scrollOffsetY:dt,verticalBorder:At,onDragOverCell:qt,onDrop:Oe,onColumnResize:$n,onColumnResizeEnd:xt,onColumnResizeStart:St,customRenderers:mn,fillHandle:xr,experimental:yt,fixedShadowX:Nn,fixedShadowY:Gn,headerIcons:Io,imageWindowLoader:Sr,initialSize:Mr,isDraggable:Ho,onDragLeave:Do,onRowMoved:An,overscrollX:Fo,overscrollY:uo,preventDiagonalScrolling:_n,rightElement:di,rightElementProps:Er,trapFocus:Rr=!1,smoothScrollX:ui,smoothScrollY:Xn,scaleToRem:Vn=!1,rowHeight:fi=34,headerHeight:Ir=36,groupHeaderHeight:Hr=Ir,theme:Dr,isOutsideClick:To,renderers:Fr,resizeIndicator:Tr,scrollToActiveCell:Ao=!0,drawFocusRing:er=!0,portalElementRef:Un,onRowStatus:Yn,onRowId:Sn}=e,Po=er==="no-editor"?r===void 0:er,De=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,tr=(De==null?void 0:De.rowNumber)??!1;let zo=(De==null?void 0:De.kind)??e.rowMarkers??"none",wn=tr;(zo==="both"||zo==="checkbox-and-number")&&(zo="checkbox",wn=!0);const tn=zo,hi=(De==null?void 0:De.width)??e.rowMarkerWidth,nr=(De==null?void 0:De.startIndex)??e.rowMarkerStartIndex??1,Lo=(De==null?void 0:De.theme)??e.rowMarkerTheme,Bo=De==null?void 0:De.headerTheme,or=De==null?void 0:De.headerAlwaysVisible,fo=$e!=="multi"||(De==null?void 0:De.headerDisabled)===!0,qn=(De==null?void 0:De.checkboxStyle)??"square",gi=(De==null?void 0:De.rowStatus)??!1,Ar=(De==null?void 0:De.rowStatusWidth)??40,Wo=De==null?void 0:De.rowStatusTheme,mi=(De==null?void 0:De.rowId)??!1,Oo=(De==null?void 0:De.rowIdWidth)??80,$o=De==null?void 0:De.rowIdTheme,jn=Math.max(gt,20),No=Math.max(Ut,jn),wi=Math.max(sn??No,jn),rr=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Re,rowNumberMapper:ho,rowHeight:ir,getRowThemeOverride:Mn}=xu(Bt,H,fi,y),Go=s.useMemo(()=>Number.parseFloat(rr.fontSize),[rr]),{rowHeight:Pn,headerHeight:go,groupHeaderHeight:lr,theme:Pr,overscrollX:z,overscrollY:V}=vu({groupHeaderHeight:Hr,headerHeight:Ir,overscrollX:Fo,overscrollY:uo,remSize:Go,rowHeight:ir,scaleToRem:Vn,theme:Dr}),le=Cu(ft),de=hi??(H>1e4?48:H>1e3?44:H>100?36:32),ee=tn!=="none",se=gi===!0,Ae=mi===!0,R=(ee?wn?2:1:0)+(se?1:0)+(Ae?1:0),oe=Ke!==void 0,Mt=(Ke==null?void 0:Ke.sticky)===!0,[Ee,it]=s.useState(!1),pt=On??Ee,wt=s.useCallback(()=>{Dt!==void 0?Dt():it(!1)},[Dt]),A=s.useMemo(()=>rt===void 0?void 0:Jr(rt,R),[rt,R])??n,lt=s.useRef(new AbortController);s.useEffect(()=>()=>lt==null?void 0:lt.current.abort(),[]);const[bt,zn]=ru(ce,D,R,lt.current,Re),pn=s.useCallback((a,b,v)=>{if(he===void 0)return!0;const S=[a[0]-R,a[1]];return he==null?void 0:he(S,b,v)},[R,he]),cn=s.useRef(rt),je=s.useCallback((a,b)=>{b&&(a=uu(a,bt,R,Z,lt.current)),xn!==void 0?(cn.current=Jr(a,-R),xn(cn.current)):o(a)},[xn,bt,R,Z]),jt=io($n,s.useCallback((a,b,v,S)=>{$n==null||$n(F[v-R],b,v-R,S)},[$n,R,F])),En=io(xt,s.useCallback((a,b,v,S)=>{xt==null||xt(F[v-R],b,v-R,S)},[xt,R,F])),Zn=io(St,s.useCallback((a,b,v,S)=>{St==null||St(F[v-R],b,v-R,S)},[St,R,F])),dn=io(B,s.useCallback((a,b)=>(B==null?void 0:B({...a,columnIndex:a.columnIndex-R},b))??!1,[B,R])),mo=io(J,s.useCallback((a,b)=>(J==null?void 0:J({...a,col:a.col-R},b))??!1,[J,R])),Zt=s.useCallback(a=>{if(Yt!==void 0){const b=Yt(Jr(a,-R));return typeof b=="boolean"?b:Jr(b,R)}return!0},[Yt,R]),[Pt,Ft,Tt]=ou(A,je,Ye,tt,at,ze,ye),$t=s.useMemo(()=>Bn(ps(),Pr),[Pr]),[pi,Ys]=s.useState([0,0,0]),sl=s.useMemo(()=>{if(Fr===void 0)return{};const a={};for(const b of Fr)a[b.kind]=b;return a},[Fr]),Jt=s.useCallback(a=>a.kind!==te.Custom?sl[a.kind]:mn==null?void 0:mn.find(b=>b.isMatch(a)),[mn,sl]);let{sizedColumns:bn,nonGrowWidth:al}=Ic(F,Re,zn,pi[0]-(R===0?0:de)-pi[2],jn,wi,$t,Jt,lt.current);tn!=="none"&&(al+=de);const sr=s.useMemo(()=>{let a=0;for(const b of bn)b.group!==void 0&&(typeof b.group=="string"?a=Math.max(a,1):a=Math.max(a,b.group.length));return a},[bn]),cl=sr>0,dl=s.useMemo(()=>sr===0?[]:Array(sr).fill(lr),[sr,lr]),Ks=dl.reduce((a,b)=>a+b,0),ar=go+Ks,ul=A.rows.length,fl=tn==="none"?void 0:ul===0?!1:ul===Re?!0:void 0,et=s.useMemo(()=>{const a=[];return tn!=="none"&&(wn&&a.push({title:"",width:de,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Lo,rowMarker:qn,rowMarkerChecked:!1,headerRowMarkerTheme:Bo,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),a.push({title:"",width:de,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Lo,rowMarker:qn,rowMarkerChecked:fl,headerRowMarkerTheme:Bo,headerRowMarkerAlwaysVisible:or,headerRowMarkerDisabled:fo})),se&&a.push({title:"",width:Ar,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Wo}),Ae&&a.push({title:"ID",width:Oo,icon:void 0,hasMenu:!1,style:"normal",themeOverride:$o}),[...a,...bn]},[se,Ar,Wo,Ae,Oo,$o,tn,bn,de,Lo,qn,fl,Bo,or,fo,wn]),nn=s.useRef({height:1,width:1,x:0,y:0}),zr=s.useRef(!1),{setVisibleRegion:hl,visibleRegion:wo,scrollRef:ut}=Eu(ct,dt,Pn,nn,()=>zr.current=!0);nn.current=wo;const _s=wo.x+R,Lr=wo.y,zt=s.useRef(null),Kt=s.useCallback(a=>{var b;a===!0?(b=m.current)==null||b.focus():window.requestAnimationFrame(()=>{var v;(v=m.current)==null||v.focus()})},[]),_t=oe?Re+1:Re,yn=s.useCallback(a=>{console.log("[mangledOnCellsEdited] items:",a),console.log("[mangledOnCellsEdited] rowMarkerOffset:",R);const b=R===0?a:a.map(S=>({...S,location:[S.location[0]-R,S.location[1]]}));console.log("[mangledOnCellsEdited] mangledItems:",b),console.log("[mangledOnCellsEdited] onCellsEdited:",ke);const v=ke==null?void 0:ke(b);if(console.log("[mangledOnCellsEdited] onCellsEdited result:",v),v!==!0){console.log("[mangledOnCellsEdited] calling onCellEdited for each item, onCellEdited:",U);for(const S of b)console.log("[mangledOnCellsEdited] calling onCellEdited with:",S.location,S.value),U==null||U(S.location,S.value)}return v},[U,ke,R]),[po,bi]=s.useState(),Br=A.current!==void 0&&A.current.range.width*A.current.range.height>1?A.current.range:void 0,Xo=Po?(Rl=A.current)==null?void 0:Rl.cell:void 0,Wr=Xo==null?void 0:Xo[0],Or=Xo==null?void 0:Xo[1],Vs=s.useMemo(()=>{if((Fe===void 0||Fe.length===0)&&(Br??Wr??Or??po)===void 0)return;const a=[];if(Fe!==void 0)for(const b of Fe){const v=et.length-b.range.x-R;v>0&&a.push({color:b.color,range:{...b.range,x:b.range.x+R,width:Math.min(v,b.range.width)},style:b.style})}return po!==void 0&&a.push({color:ao($t.accentColor,0),range:po,style:"dashed"}),Br!==void 0&&a.push({color:ao($t.accentColor,.5),range:Br,style:"solid-outline"}),Wr!==void 0&&Or!==void 0&&a.push({color:$t.accentColor,range:{x:Wr,y:Or,width:1,height:1},style:"solid-outline"}),a.length>0?a:void 0},[po,Br,Wr,Or,Fe,et.length,$t.accentColor,R]),gl=s.useRef(et);gl.current=et;const Xt=s.useCallback(([a,b],v=!1)=>{var Y,j,ne,K,Ne,Se,Le,Pe,Ce;const S=oe&&b===_t-1;let M=0,N=-1,P=-1,L=-1,X=-1;if(ee&&wn&&(N=M++),ee&&(P=M++),se&&(L=M++),Ae&&(X=M++),a===N){if(S)return oo;const ge=ho(b);return ge===void 0?oo:{kind:Wt.Marker,allowOverlay:!1,checkboxStyle:qn,checked:!1,markerKind:"number",row:nr+ge,drawHandle:!1,cursor:void 0,disabled:((Y=e.disabledRows)==null?void 0:Y.call(e,b))===!0}}if(a===P){if(S)return oo;const ge=ho(b);if(ge===void 0)return oo;let Je;return wn?Je=tn==="checkbox-visible"?"checkbox-visible":"checkbox":tn==="clickable-number"?Je="number":Je=tn,{kind:Wt.Marker,allowOverlay:!1,checkboxStyle:qn,checked:(A==null?void 0:A.rows.hasIndex(b))===!0,markerKind:Je,row:nr+ge,drawHandle:An!==void 0,cursor:wn?void 0:tn==="clickable-number"?"pointer":void 0,disabled:((j=e.disabledRows)==null?void 0:j.call(e,b))===!0}}if(a===L){if(S)return oo;const ge=Yn==null?void 0:Yn(b);return{kind:Wt.RowStatus,allowOverlay:!1,status:ge,themeOverride:Wo}}if(a===X){if(S)return oo;const ge=Sn==null?void 0:Sn(b);return{kind:Wt.RowId,allowOverlay:!1,rowId:ge,themeOverride:$o}}if(S){const Je=a===R?(Ke==null?void 0:Ke.hint)??"":"",Ie=gl.current[a];if(((ne=Ie==null?void 0:Ie.trailingRowOptions)==null?void 0:ne.disabled)===!0)return oo;{const Lt=((K=Ie==null?void 0:Ie.trailingRowOptions)==null?void 0:K.hint)??Je,on=((Ne=Ie==null?void 0:Ie.trailingRowOptions)==null?void 0:Ne.addIcon)??(Ke==null?void 0:Ke.addIcon);return{kind:Wt.NewRow,hint:Lt,allowOverlay:!1,icon:on}}}else{const ge=a-R;if(v||(yt==null?void 0:yt.strict)===!0){const Ie=nn.current,Lt=Ie.x>ge||ge>Ie.x+Ie.width||Ie.y>b||b>Ie.y+Ie.height||b>=ki.current,on=ge===((Le=(Se=Ie.extras)==null?void 0:Se.selected)==null?void 0:Le[0])&&b===((Pe=Ie.extras)==null?void 0:Pe.selected[1]);let rn=!1;if(((Ce=Ie.extras)==null?void 0:Ce.freezeRegions)!==void 0){for(const Cn of Ie.extras.freezeRegions)if(so(Cn,ge,b)){rn=!0;break}}if(Lt&&!on&&!rn)return oo}let Je=D([ge,b]);return R!==0&&Je.span!==void 0&&(Je={...Je,span:[Je.span[0]+R,Je.span[1]+R]}),Je}},[oe,_t,se,Yn,Wo,Ae,Sn,$o,ee,ho,qn,A==null?void 0:A.rows,tn,nr,An,R,Ke==null?void 0:Ke.hint,Ke==null?void 0:Ke.addIcon,yt==null?void 0:yt.strict,D,wn]),yi=s.useCallback(a=>{let b=(Ot==null?void 0:Ot(a))??{name:a};return re!==void 0&&a!==""&&(b={icon:b.icon,name:b.name,overrideTheme:b.overrideTheme,actions:[...b.actions??[],{title:"Rename",icon:"renameIcon",onClick:v=>Si({group:b.name,bounds:v.bounds})}]}),b},[Ot,re]),$r=s.useCallback(a=>{var L;const[b,v]=a.cell,S=et[b],M=(S==null?void 0:S.group)!==void 0?(L=yi(S.group))==null?void 0:L.overrideTheme:void 0,N=S==null?void 0:S.themeOverride,P=Mn==null?void 0:Mn(v);i({...a,theme:Bn($t,M,N,P,a.content.themeOverride)})},[Mn,et,yi,$t]),Rn=s.useCallback((a,b,v)=>{var P,L,X,Y;if(A.current===void 0)return;const[S,M]=A.current.cell,N=Xt([S,M]);if(N.kind!==te.Boolean&&N.allowOverlay){let j=N;if(v!==void 0)switch(j.kind){case te.Number:{const K=Wa(()=>v==="-"?-0:Number.parseFloat(v),0);j={...j,data:Number.isNaN(K)?0:K};break}case te.Text:case te.Markdown:case te.Uri:j={...j,data:v};break}$r({target:a,content:j,initialValue:v,cell:[S,M],highlight:v===void 0,forceEditMode:v!==void 0,activation:b}),v!==void 0&&((P=m.current)==null||P.setPosition(a.x,a.y,a.width,a.height),v.length>0&&((L=m.current)==null||L.setValue(v)),(X=m.current)==null||X.setVisible(!0),w(!0))}else N.kind===te.Boolean&&b.inputType==="keyboard"&&N.readonly!==!0&&(yn([{location:A.current.cell,value:{...N,data:Os(N.data)}}]),(Y=zt.current)==null||Y.damage([{cell:A.current.cell}]))},[Xt,A,yn,$r]),ml=s.useCallback((a,b)=>{var M;const v=(M=zt.current)==null?void 0:M.getBounds(a,b);if(v===void 0||ut.current===null)return;const S=Xt([a,b]);S.allowOverlay&&$r({target:v,content:S,initialValue:void 0,highlight:!0,cell:[a,b],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Xt,ut,$r]),Et=s.useCallback((a,b,v="both",S=0,M=0,N=void 0)=>{if(ut.current!==null){const P=zt.current,L=l.current,X=typeof a!="number"?a.unit==="cell"?a.amount:void 0:a,Y=typeof b!="number"?b.unit==="cell"?b.amount:void 0:b,j=typeof a!="number"&&a.unit==="px"?a.amount:void 0,ne=typeof b!="number"&&b.unit==="px"?b.amount:void 0;if(P!==null&&L!==null){let K={x:0,y:0,width:0,height:0},Ne=0,Se=0;if((X!==void 0||Y!==void 0)&&(K=P.getBounds((X??0)+R,Y??0)??K,K.width===0||K.height===0))return;const Le=L.getBoundingClientRect(),Pe=Le.width/L.offsetWidth;if(j!==void 0&&(K={...K,x:j-Le.left-ut.current.scrollLeft,width:1}),ne!==void 0&&(K={...K,y:ne+Le.top-ut.current.scrollTop,height:1}),K!==void 0){const Ce={x:K.x-S,y:K.y-M,width:K.width+2*S,height:K.height+2*M};let ge=0;for(let Ti=0;Ti<ot;Ti++)ge+=bn[Ti].width;let Je=0;const Ie=Gt+(Mt?1:0);Ie>0&&(Je=Eo(_t,Ie,Pn));let Lt=ge*Pe+Le.left+R*de*Pe,on=Le.right,rn=Le.top+ar*Pe,Cn=Le.bottom-Je*Pe;const Vr=K.width+S*2;switch(N==null?void 0:N.hAlign){case"start":on=Lt+Vr;break;case"end":Lt=on-Vr;break;case"center":Lt=Math.floor((Lt+on)/2)-Vr/2,on=Lt+Vr;break}const Ur=K.height+M*2;switch(N==null?void 0:N.vAlign){case"start":Cn=rn+Ur;break;case"end":rn=Cn-Ur;break;case"center":rn=Math.floor((rn+Cn)/2)-Ur/2,Cn=rn+Ur;break}Lt>Ce.x?Ne=Ce.x-Lt:on<Ce.x+Ce.width&&(Ne=Ce.x+Ce.width-on),rn>Ce.y?Se=Ce.y-rn:Cn<Ce.y+Ce.height&&(Se=Ce.y+Ce.height-Cn),v==="vertical"||typeof a=="number"&&a<ot?Ne=0:(v==="horizontal"||typeof b=="number"&&b>=_t-Ie)&&(Se=0),(Ne!==0||Se!==0)&&(Pe!==1&&(Ne/=Pe,Se/=Pe),ut.current.scrollTo({left:Ne+ut.current.scrollLeft,top:Se+ut.current.scrollTop,behavior:(N==null?void 0:N.behavior)??"auto"}))}}}},[R,Gt,de,ut,ar,ot,bn,_t,Mt,Pn]),vi=s.useRef(ml),Ci=s.useRef(D);vi.current=ml,Ci.current=D;const ki=s.useRef(Re);ki.current=Re;const wl=s.useRef(et.length);wl.current=et.length;const Jn=s.useCallback(async(a,b=!0,v)=>{var Y;const S=et[a];if(((Y=S==null?void 0:S.trailingRowOptions)==null?void 0:Y.disabled)===!0)return;const M=It==null?void 0:It();let N,P=!0;M!==void 0&&(N=await M,N==="top"&&(P=!1),typeof N=="number"&&(P=!1));let L=0;const X=()=>{if(ki.current<=Re){L<500&&window.setTimeout(X,L),L=50+L*2;return}const j=typeof N=="number"?N:P?Re:0;_r.current(a-R,j,"both",0,20,v?{behavior:v}:void 0),Pt({cell:[a,j],range:{x:a,y:j,width:1,height:1}},!1,!1,"edit");const ne=Ci.current([a-R,j]);ne.allowOverlay&&ro(ne)&&ne.readonly!==!0&&b&&window.setTimeout(()=>{vi.current(a,j)},0)};X()},[et,It,R,Re,Pt]),Nr=s.useCallback(async(a,b=!0)=>{const v=xe==null?void 0:xe();let S,M=!0;v!==void 0&&(S=await v,S==="left"&&(M=!1),typeof S=="number"&&(M=!1));let N=0;const P=()=>{if(wl.current<=et.length){N<500&&window.setTimeout(P,N),N=50+N*2;return}const L=typeof S=="number"?S:M?et.length:0;Et(L-R,a),Pt({cell:[L,a],range:{x:L,y:a,width:1,height:1}},!1,!1,"edit");const X=Ci.current([L-R,a]);X.allowOverlay&&ro(X)&&X.readonly!==!0&&b&&window.setTimeout(()=>{vi.current(L,a)},0)};P()},[et,xe,R,Et,Pt]),Yo=s.useCallback(a=>{var v,S;const b=((S=(v=bn[a])==null?void 0:v.trailingRowOptions)==null?void 0:S.targetColumn)??(Ke==null?void 0:Ke.targetColumn);if(typeof b=="number")return b+(ee?1:0);if(typeof b=="object"){const M=F.indexOf(b);if(M>=0)return M+(ee?1:0)}},[bn,F,ee,Ke==null?void 0:Ke.targetColumn]),Qn=s.useRef(void 0),Ko=s.useRef(void 0),cr=s.useCallback((a,b)=>{var M;const[v,S]=b;return Bn($t,(M=et[v])==null?void 0:M.themeOverride,Mn==null?void 0:Mn(S),a.themeOverride)},[Mn,et,$t]),{mapper:bo}=Su(Bt,H),In=Bt==null?void 0:Bt.navigationBehavior,dr=s.useCallback(a=>{var Y,j,ne;const b=li.value?a.metaKey:a.ctrlKey,v=b&&$e==="multi",[S,M]=a.location,N=A.columns,P=A.rows,[L,X]=((Y=A.current)==null?void 0:Y.cell)??[];if(a.kind==="cell"){if(Ko.current=void 0,yo.current=[S,M],S===(wn?1:0)&&ee){if(oe===!0&&M===Re||tn==="number"||$e==="none")return;const Se=Xt(a.location);if(Se.kind!==Wt.Marker||Se.disabled===!0)return;if(An!==void 0){const Ce=Jt(Se);un((Ce==null?void 0:Ce.kind)===Wt.Marker);const ge=(j=Ce==null?void 0:Ce.onClick)==null?void 0:j.call(Ce,{...a,cell:Se,posX:a.localEventX,posY:a.localEventY,bounds:a.bounds,theme:cr(Se,a.location),preventDefault:()=>{}});if(ge===void 0||ge.checked===Se.checked)return}i(void 0),Kt();const Le=P.hasIndex(M),Pe=Qn.current;if($e==="multi"&&(a.shiftKey||a.isLongTouch===!0)&&Pe!==void 0&&P.hasIndex(Pe)){const Ce=[Math.min(Pe,M),Math.max(Pe,M)+1];v||Ze==="multi"?Ft(void 0,Ce,!0):Ft(st.fromSingleSelection(Ce),void 0,v)}else $e==="multi"&&(v||a.isTouch||Ze==="multi")?Le?Ft(P.remove(M),void 0,!0):(Ft(void 0,M,!0),Qn.current=M):Le&&P.length===1?Ft(st.empty(),void 0,b):(Ft(st.fromSingleSelection(M),void 0,b),Qn.current=M)}else if(S>=R&&oe&&M===Re){const Se=Yo(S);Jn(Se??S)}else if(L!==S||X!==M){const Se=Xt(a.location),Le=Jt(Se);if((Le==null?void 0:Le.onSelect)!==void 0){let ge=!1;if(Le.onSelect({...a,cell:Se,posX:a.localEventX,posY:a.localEventY,bounds:a.bounds,preventDefault:()=>ge=!0,theme:cr(Se,a.location)}),ge)return}if(In==="block"&&bo(M).isGroupHeader)return;const Pe=Mt&&M===Re,Ce=Mt&&A!==void 0&&((ne=A.current)==null?void 0:ne.cell[1])===Re;if((a.shiftKey||a.isLongTouch===!0)&&L!==void 0&&X!==void 0&&A.current!==void 0&&!Ce){if(Pe)return;const ge=Math.min(S,L),Je=Math.max(S,L),Ie=Math.min(M,X),Lt=Math.max(M,X);Pt({...A.current,range:{x:ge,y:Ie,width:Je-ge+1,height:Lt-Ie+1}},!0,b,"click"),Qn.current=void 0,Kt()}else{const ge=A.rows.length>0;Pt({cell:[S,M],range:{x:S,y:M,width:1,height:1}},!0,b||ge,"click"),Qn.current=void 0,i(void 0),Kt()}}}else if(a.kind==="header")if(yo.current=[S,M],i(void 0),ee&&S===0)Qn.current=void 0,Ko.current=void 0,!fo&&$e==="multi"&&(P.length!==Re?Ft(st.fromSingleSelection([0,Re]),void 0,b):Ft(st.empty(),void 0,b),Kt());else{const K=Ko.current;if(Xe==="multi"&&(a.shiftKey||a.isLongTouch===!0)&&K!==void 0&&N.hasIndex(K)){const Ne=[Math.min(K,S),Math.max(K,S)+1];b||a.isTouch||qe==="multi"?Tt(void 0,Ne,b):Tt(st.fromSingleSelection(Ne),void 0,b)}else Xe==="multi"&&(b||a.isTouch||qe==="multi")?(N.hasIndex(S)?Tt(N.remove(S),void 0,b):Tt(void 0,S,b),Ko.current=S):Xe!=="none"&&(N.hasIndex(S)?Tt(N.remove(S),void 0,b):Tt(st.fromSingleSelection(S),void 0,b),Ko.current=S);Qn.current=void 0,Kt()}else a.kind===Fn?yo.current=[S,M]:a.kind===si&&!a.isMaybeScrollbar&&(je(Wi,!1),i(void 0),Kt(),Ht==null||Ht(),Qn.current=void 0,Ko.current=void 0)},[$e,Xe,A,ee,R,oe,Re,tn,Xt,An,Kt,Ze,qe,Jt,cr,Ft,Yo,Jn,In,bo,Mt,Pt,fo,Tt,je,Ht]),ur=s.useRef(!1),yo=s.useRef(void 0),pl=s.useRef(wo),vn=s.useRef(void 0),Us=s.useCallback(a=>{if(_o.current=!1,pl.current=nn.current,a.button!==0&&a.button!==1){vn.current=void 0;return}const b=performance.now();vn.current={button:a.button,time:b,location:a.location},(a==null?void 0:a.kind)==="header"&&(ur.current=!0);const v=a.kind==="cell"&&a.isFillHandle;!v&&a.kind!=="cell"&&a.isEdge||(f({previousSelection:A,fillHandle:v}),yo.current=void 0,!a.isTouch&&a.button===0&&!v?dr(a):!a.isTouch&&a.button===1&&(yo.current=a.location))},[A,dr]),[xi,Si]=s.useState(),bl=s.useCallback(a=>{if(a.kind!==Fn||Xe!=="multi")return;const b=li.value?a.metaKey:a.ctrlKey,[v,S]=a.location,M=A.columns;if(v<R)return;const N=et[v];let P=v,L=v;const X=S<=-2?-(S+2):0,Y=Array.isArray(N.group)?N.group.length:1,j=(ne,K)=>Y>1?oi(ne,K,X,Y):bs(ne,K);for(let ne=v-1;ne>=R&&j(N.group,et[ne].group);ne--)P--;for(let ne=v+1;ne<et.length&&j(N.group,et[ne].group);ne++)L++;if(Kt(),b||a.isTouch||qe==="multi")if(M.hasAll([P,L+1])){let ne=M;for(let K=P;K<=L;K++)ne=ne.remove(K);Tt(ne,void 0,b)}else Tt(void 0,[P,L+1],b);else Tt(st.fromSingleSelection([P,L+1]),void 0,b)},[Xe,Kt,A.columns,et,R,Tt,qe]),_o=s.useRef(!1),Gr=s.useCallback(async a=>{if(bt!==void 0&&jt!==void 0){const b=nn.current.y,v=nn.current.height;let S=bt({x:a,y:b,width:1,height:Math.min(v,Re-b)},lt.current.signal);typeof S!="object"&&(S=await S());const M=bn[a-R],P=document.createElement("canvas").getContext("2d",{alpha:!1});if(P!==null){P.font=$t.baseFontFull;const L=Is(P,$t,M,0,S,jn,No,!1,Jt);jt==null||jt(M,L.width,a,L.width)}}},[bn,bt,No,$t,jn,jt,R,Re,Jt]),[qs,Mi]=s.useState(),Vo=s.useCallback(async(a,b)=>{var L,X;const v=(L=a.current)==null?void 0:L.range;if(v===void 0||bt===void 0||b.current===void 0)return;const S=b.current.range;if($!==void 0){let Y=!1;if($({fillDestination:{...S,x:S.x-R},patternSource:{...v,x:v.x-R},preventDefault:()=>Y=!0}),Y)return}let M=bt(v,lt.current.signal);typeof M!="object"&&(M=await M());const N=M,P=[];for(let Y=0;Y<S.width;Y++)for(let j=0;j<S.height;j++){const ne=[S.x+Y,S.y+j];if(ys(ne,v))continue;const K=N[j%v.height][Y%v.width];So(K)||!ro(K)||P.push({location:ne,value:{...K}})}yn(P),(X=zt.current)==null||X.damage(P.map(Y=>({cell:Y.location})))},[bt,yn,$,R]),yl=s.useCallback(()=>{if(A.current===void 0||A.current.range.width<=1)return;const a={...A,current:{...A.current,range:{...A.current.range,width:1}}};Vo(a,A)},[Vo,A]),vl=s.useCallback(()=>{if(A.current===void 0||A.current.range.height<=1)return;const a={...A,current:{...A.current,range:{...A.current.range,height:1}}};Vo(a,A)},[Vo,A]),js=s.useCallback((a,b)=>{var j,ne;const v=d;if(f(void 0),bi(void 0),Mi(void 0),ur.current=!1,b)return;if((v==null?void 0:v.fillHandle)===!0&&A.current!==void 0&&((j=v.previousSelection)==null?void 0:j.current)!==void 0){if(po===void 0)return;const K={...A,current:{...A.current,range:Ts(v.previousSelection.current.range,po)}};Vo(v.previousSelection,K),je(K,!0);return}const[S,M]=a.location,[N,P]=yo.current??[],L=()=>{_o.current=!0},X=K=>{var Se,Le,Pe;const Ne=K.isTouch||N===S&&P===M;if(Ne&&(E==null||E([S-R,M],{...K,preventDefault:L})),K.button===1)return!_o.current;if(!_o.current){const Ce=Xt(a.location),ge=Jt(Ce);if(ge!==void 0&&ge.onClick!==void 0&&Ne){const Ie=ge.onClick({...K,cell:Ce,posX:K.localEventX,posY:K.localEventY,bounds:K.bounds,theme:cr(Ce,a.location),preventDefault:L});Ie!==void 0&&!So(Ie)&&Dn(Ie)&&(yn([{location:K.location,value:Ie}]),(Se=zt.current)==null||Se.damage([{cell:K.location}]))}if(_o.current||A.current===void 0)return!1;let Je=!1;switch(Ce.activationBehaviorOverride??ht){case"double-click":case"second-click":{if(((Pe=(Le=v==null?void 0:v.previousSelection)==null?void 0:Le.current)==null?void 0:Pe.cell)===void 0)break;const[Ie,Lt]=A.current.cell,[on,rn]=v.previousSelection.current.cell;Je=S===Ie&&S===on&&M===Lt&&M===rn&&(K.isDoubleClick===!0||ht==="second-click");break}case"single-click":{Je=!0;break}}if(Je){const Lt={inputType:"pointer",pointerActivation:K.isDoubleClick===!0?"double-click":Ce.activationBehaviorOverride??ht,pointerType:K.isTouch?"touch":"mouse"};return O==null||O([S-R,M],Lt),Rn(K.bounds,Lt),!0}}return!1},Y=a.location[0]-R;if(a.isTouch){const K=nn.current,Ne=pl.current;if(K.x!==Ne.x||K.y!==Ne.y)return;if(a.isLongTouch===!0){if(a.kind==="cell"&&yr((ne=A.current)==null?void 0:ne.cell,a.location)){ae==null||ae([Y,a.location[1]],{...a,preventDefault:L});return}else if(a.kind==="header"&&A.columns.hasIndex(S)){we==null||we(Y,{...a,preventDefault:L});return}else if(a.kind===Fn){if(Y<0)return;fe==null||fe(Y,{...a,preventDefault:L});return}}a.kind==="cell"?X(a)||dr(a):a.kind===Fn?q==null||q(Y,{...a,preventDefault:L}):(a.kind===lo&&(pe==null||pe(Y,{...a,preventDefault:L})),dr(a));return}if(a.kind==="header"){if(Y<0)return;a.isEdge?a.isDoubleClick===!0&&Gr(S):a.button===0&&S===N&&M===P&&(pe==null||pe(Y,{...a,preventDefault:L}))}if(a.kind===Fn){if(Y<0)return;a.button===0&&S===N&&M===P&&(q==null||q(Y,{...a,preventDefault:L}),_o.current||bl(a))}a.kind==="cell"&&(a.button===0||a.button===1)&&X(a),yo.current=void 0},[d,A,R,po,Vo,je,E,Xt,Jt,ht,cr,yn,O,Rn,ae,we,fe,dr,q,pe,Gr,bl]),Zs=s.useCallback(a=>{const b={...a,location:[a.location[0]-R,a.location[1]]};mt==null||mt(b),d!==void 0&&a.buttons===0&&(f(void 0),bi(void 0),Mi(void 0),ur.current=!1),Mi(v=>{var S;return ur.current?[a.scrollEdge[0],0]:a.scrollEdge[0]===(v==null?void 0:v[0])&&a.scrollEdge[1]===v[1]?v:d===void 0||(((S=vn.current)==null?void 0:S.location[0])??0)<R?void 0:a.scrollEdge})},[d,mt,R]),Js=s.useCallback((a,b)=>{kt==null||kt(a-R,b)},[kt,R]),Qs=s.useCallback((a,b)=>{Nt==null||Nt(a-R,b)},[Nt,R]);s.useEffect(()=>{if(r===void 0)return;const a=S=>{const M=[];let N=S.parentElement;for(;N&&N!==document.documentElement;){const P=window.getComputedStyle(N),L=P.overflow+P.overflowY+P.overflowX;(L.includes("scroll")||L.includes("auto"))&&M.push(N),N=N.parentElement}return M},b=S=>{const M=S.target;ut.current&&!ut.current.contains(M)&&i(void 0)},v=[];if(ut.current){const S=a(ut.current);v.push(...S)}return v.forEach(S=>{S.addEventListener("scroll",b)}),window.addEventListener("scroll",b),document.addEventListener("scroll",b,!0),()=>{v.forEach(S=>{S.removeEventListener("scroll",b)}),window.removeEventListener("scroll",b),document.removeEventListener("scroll",b,!0)}},[r,i,ut]);const Ln=(Il=A==null?void 0:A.current)==null?void 0:Il.cell,ea=s.useCallback((a,b,v,S,M,N)=>{if(zr.current=!1,r!==void 0){const j=nn.current;(j.x!==a.x||j.y!==a.y)&&i(void 0)}let P=Ln;P!==void 0&&(P=[P[0]-R,P[1]]);const L=ot===0?void 0:{x:0,y:a.y,width:ot,height:a.height},X=[];L!==void 0&&X.push(L),Gt>0&&(X.push({x:a.x-R,y:Re-Gt,width:a.width,height:Gt}),ot>0&&X.push({x:0,y:Re-Gt,width:ot,height:Gt}));const Y={x:a.x-R,y:a.y,width:a.width,height:oe&&a.y+a.height>=Re?a.height-1:a.height,tx:M,ty:N,extras:{selected:P,freezeRegion:L,freezeRegions:X}};nn.current=Y,hl(Y),Ys([b,v,S]),gn==null||gn(Y,Y.tx,Y.ty,Y.extras)},[Ln,r,R,oe,Re,ot,Gt,i,hl,gn]),ta=io(be,s.useCallback((a,b)=>(be==null?void 0:be(a-R,b-R))!==!1,[be,R])),na=io(He,s.useCallback((a,b)=>{He==null||He(a-R,b-R),Xe!=="none"&&Tt(st.fromSingleSelection(b),void 0,!0)},[Xe,He,R,Tt])),Ei=s.useRef(!1),oa=s.useCallback(a=>{if(a.location[0]===0&&R>0){a.preventDefault();return}_==null||_({...a,location:[a.location[0]-R,a.location[1]]}),a.defaultPrevented()||(Ei.current=!0),f(void 0)},[_,R]),ra=s.useCallback(()=>{Ei.current=!1},[]),Cl=Bt==null?void 0:Bt.selectionBehavior,Xr=s.useCallback(a=>{if(Cl!=="block-spanning")return;const{isGroupHeader:b,path:v,groupRows:S}=bo(a);if(b)return[a,a];const M=v[v.length-1],N=a-M,P=a+S-M-1;return[N,P]},[bo,Cl]),Ri=s.useRef(void 0),Ii=s.useCallback(a=>{var b,v,S;if(!Bs(a,Ri.current)&&(Ri.current=a,!(((b=vn==null?void 0:vn.current)==null?void 0:b.button)!==void 0&&vn.current.button>=1))){if(a.buttons!==0&&d!==void 0&&((v=vn.current)==null?void 0:v.location[0])===0&&R===1&&$e==="multi"&&d.previousSelection&&!d.previousSelection.rows.hasIndex(vn.current.location[1])&&A.rows.hasIndex(vn.current.location[1])){const M=Math.min(vn.current.location[1],a.location[1]),N=Math.max(vn.current.location[1],a.location[1])+1;Ft(st.fromSingleSelection([M,N]),void 0,!1)}else if(a.buttons!==0&&d!==void 0&&A.current!==void 0&&!Ei.current&&!ur.current&&(ze==="rect"||ze==="multi-rect")){const[M,N]=A.current.cell;let[P,L]=a.location;if(L<0&&(L=nn.current.y),d.fillHandle===!0&&((S=d.previousSelection)==null?void 0:S.current)!==void 0){const X=d.previousSelection.current.range;L=Math.min(L,oe?Re-1:Re);const Y=dd(X,P,L,Te);bi(Y)}else{if(oe&&N===Re)return;if(oe&&L===Re)if(a.kind===si)L--;else return;P=Math.max(P,R);const j=Xr(N);L=j===void 0?L:kn(L,j[0],j[1]);const ne=P-M,K=L-N,Ne={x:ne>=0?M:P,y:K>=0?N:L,width:Math.abs(ne)+1,height:Math.abs(K)+1};Pt({...A.current,range:Ne},!0,!1,"drag")}}Vt==null||Vt({...a,location:[a.location[0]-R,a.location[1]]})}},[d,R,$e,A,ze,Vt,Ft,oe,Re,Te,Xr,Pt]),ia=s.useCallback(()=>{var P,L;const a=Ri.current;if(a===void 0)return;const[b,v]=a.scrollEdge;let[S,M]=a.location;const N=nn.current;b===-1?S=((L=(P=N.extras)==null?void 0:P.freezeRegion)==null?void 0:L.x)??N.x:b===1&&(S=N.x+N.width),v===-1?M=Math.max(0,N.y):v===1&&(M=Math.min(Re-1,N.y+N.height)),S=kn(S,0,et.length-1),M=kn(M,0,Re-1),Ii({...a,location:[S,M]})},[et.length,Ii,Re]);yu(qs,ut,ia);const Hn=s.useCallback(a=>{if(A.current===void 0)return;const[b,v]=a,[S,M]=A.current.cell,N=A.current.range;let P=N.x,L=N.x+N.width,X=N.y,Y=N.y+N.height;const[j,ne]=Xr(M)??[0,Re-1],K=ne+1;if(v!==0)switch(v){case 2:{Y=K,X=M,Et(0,Y,"vertical");break}case-2:{X=j,Y=M+1,Et(0,X,"vertical");break}case 1:{X<M?(X++,Et(0,X,"vertical")):(Y=Math.min(K,Y+1),Et(0,Y,"vertical"));break}case-1:{Y>M+1?(Y--,Et(0,Y,"vertical")):(X=Math.max(j,X-1),Et(0,X,"vertical"));break}default:Cr()}if(b!==0)if(b===2)L=et.length,P=S,Et(L-1-R,0,"horizontal");else if(b===-2)P=R,L=S+1,Et(P-R,0,"horizontal");else{let Ne=[];if(bt!==void 0){const Se=bt({x:P,y:X,width:L-P-R,height:Y-X},lt.current.signal);typeof Se=="object"&&(Ne=Tu(Se))}if(b===1){let Se=!1;if(P<S){if(Ne.length>0){const Le=xo(P+1,S+1).find(Pe=>!Ne.includes(Pe-R));Le!==void 0&&(P=Le,Se=!0)}else P++,Se=!0;Se&&Et(P,0,"horizontal")}Se||(L=Math.min(et.length,L+1),Et(L-1-R,0,"horizontal"))}else if(b===-1){let Se=!1;if(L>S+1){if(Ne.length>0){const Le=xo(L-1,S,-1).find(Pe=>!Ne.includes(Pe-R));Le!==void 0&&(L=Le,Se=!0)}else L--,Se=!0;Se&&Et(L-R,0,"horizontal")}Se||(P=Math.max(R,P-1),Et(P-R,0,"horizontal"))}else Cr()}Pt({cell:A.current.cell,range:{x:P,y:X,width:L-P,height:Y-X}},!0,!1,"keyboard-select")},[bt,Xr,A,et.length,R,Re,Et,Pt]),Hi=s.useRef(Ao);Hi.current=Ao;const eo=s.useCallback((a,b,v,S)=>{const M=_t-(v?0:1);a=kn(a,R,bn.length-1+R),b=kn(b,0,M);const N=Ln==null?void 0:Ln[0],P=Ln==null?void 0:Ln[1];if(a===N&&b===P)return!1;if(S&&A.current!==void 0){const L=[...A.current.rangeStack];(A.current.range.width>1||A.current.range.height>1)&&L.push(A.current.range),je({...A,current:{cell:[a,b],range:{x:a,y:b,width:1,height:1},rangeStack:L}},!0)}else Pt({cell:[a,b],range:{x:a,y:b,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===a&&u.current[1]===b&&(u.current=void 0),Hi.current&&Et(a-R,b,"both",0,20),!0},[_t,R,bn.length,Ln,A,Et,je,Pt]),fr=s.useCallback((a,b)=>{var X,Y,j,ne;const v=p.current,S=h.current;console.log("[onFinishEditing] isGhostMode:",S),console.log("[onFinishEditing] currentOverlay:",v),console.log("[onFinishEditing] ghostInputRef.current:",m.current),console.log("[onFinishEditing] ghostText:",(X=m.current)==null?void 0:X.getValue());let M=a;const N=((Y=m.current)==null?void 0:Y.getValue())??"";if(console.log("[onFinishEditing] ghostText from GhostInput:",N),(v==null?void 0:v.cell)!==void 0&&N.length>0&&v.content!==void 0){console.log("[onFinishEditing] Using ghostText from GhostInput");const K=v.content;if(console.log("[onFinishEditing] cellContent.kind:",K.kind),K.kind===te.Text)M={...K,data:N,displayData:N};else if(K.kind===te.Number){const Ne=Number.parseFloat(N),Se=Number.isNaN(Ne)?0:Ne;M={...K,data:Se,displayData:Se.toLocaleString()}}else K.kind===te.Uri?M={...K,data:N,displayData:N}:K.kind===te.Markdown&&(M={...K,data:N})}if(M!==void 0&&N.length===0)if(M.kind===te.Text&&M.data!==M.displayData)M={...M,displayData:M.data};else if(M.kind===te.Number){const K=M.data!==void 0?M.data.toLocaleString():"0";M.displayData!==K&&(M={...M,displayData:K})}else M.kind===te.Uri&&M.data!==M.displayData&&(M={...M,displayData:M.data});console.log("[onFinishEditing] finalValue:",M),console.log("[onFinishEditing] isEditableGridCell:",M!==void 0?Dn(M):"N/A"),console.log("[onFinishEditing] condition check - cell:",v==null?void 0:v.cell,"finalValue:",M!==void 0,"isEditable:",M!==void 0&&Dn(M)),(v==null?void 0:v.cell)!==void 0&&M!==void 0&&Dn(M)&&(console.log("[onFinishEditing] CALLING mangledOnCellsEdited with:",{location:v.cell,value:M}),yn([{location:v.cell,value:M}]),window.requestAnimationFrame(()=>{var K;(K=zt.current)==null||K.damage([{cell:v.cell}])})),(j=m.current)==null||j.clear(),(ne=m.current)==null||ne.setVisible(!1),w(!1),Kt(!0),p.current=void 0,i(void 0);const[P,L]=b;if(A.current!==void 0&&(P!==0||L!==0)){const K=A.current.cell[1]===_t-1;if(K&&L===1){T==null||T(a,[0,0]);return}const Ne=A.current.cell[0]===et.length-1&&a!==void 0;let Se=!0;if(K&&L===1&&It!==void 0){Se=!1;const Le=A.current.cell[0]+P,Pe=Yo(Le);Jn(Pe??Le,!1)}if(Ne&&P===1&&xe!==void 0){Se=!1;const Le=A.current.cell[1]+L;Nr(Le,!1)}if(Se){const Le=kn(A.current.cell[0]+P,R,et.length-1),Pe=kn(A.current.cell[1]+L,0,_t-1);eo(Le,Pe,K,!1),window.requestAnimationFrame(()=>{var Ce;(Ce=m.current)==null||Ce.focus()})}}T==null||T(a,b)},[Kt,A,T,yn,_t,eo,et.length,Jn,Nr,It,xe,Yo,R]),la=s.useMemo(()=>`gdg-overlay-${Fu++}`,[]),vo=s.useCallback(a=>{var v,S,M,N;Kt();const b=[];for(let P=a.x;P<a.x+a.width;P++)for(let L=a.y;L<a.y+a.height;L++){const X=D([P-R,L]);if(!X.allowOverlay&&X.kind!==te.Boolean)continue;let Y;if(X.kind===te.Custom){const j=Jt(X),ne=(v=j==null?void 0:j.provideEditor)==null?void 0:v.call(j,{...X,location:[P-R,L]});(j==null?void 0:j.onDelete)!==void 0?Y=j.onDelete(X):as(ne)&&(Y=(S=ne==null?void 0:ne.deletedValue)==null?void 0:S.call(ne,X))}else if(Dn(X)&&X.allowOverlay||X.kind===te.Boolean){const j=Jt(X);Y=(M=j==null?void 0:j.onDelete)==null?void 0:M.call(j,X)}Y!==void 0&&!So(Y)&&Dn(Y)&&b.push({location:[P,L],value:Y})}yn(b),(N=zt.current)==null||N.damage(b.map(P=>({cell:P.location})))},[Kt,D,Jt,yn,R]),hr=r!==void 0,kl=s.useCallback(a=>{var Le,Pe,Ce;const b=()=>{a.stopPropagation(),a.preventDefault()},v={didMatch:!1},{bounds:S}=a,M=A.columns,N=A.rows,P=le;if(!hr&&Ve(P.clear,a,v)){const ge=((Le=A.current)==null?void 0:Le.cell)??[R,0];je({columns:st.empty(),rows:st.empty(),current:{cell:ge,range:{x:ge[0],y:ge[1],width:1,height:1},rangeStack:[]}},!1),Ht==null||Ht(),Kt()}else if(!hr&&Ve(P.selectAll,a,v))je({columns:st.empty(),rows:st.empty(),current:{cell:((Pe=A.current)==null?void 0:Pe.cell)??[R,0],range:{x:R,y:0,width:F.length,height:Re},rangeStack:[]}},!1);else if(Ve(P.search,a,v))(Ce=c==null?void 0:c.current)==null||Ce.focus({preventScroll:!0}),it(!0);else if(Ve(P.delete,a,v)){const ge=(Zt==null?void 0:Zt(A))??!0;if(ge!==!1){const Je=ge===!0?A:ge;if(Je.current!==void 0){vo(Je.current.range);for(const Ie of Je.current.rangeStack)vo(Ie)}for(const Ie of Je.rows)vo({x:R,y:Ie,width:F.length,height:1});for(const Ie of Je.columns)vo({x:Ie,y:0,width:1,height:Re})}}if(v.didMatch)return b(),!0;if(A.current===void 0)return!1;let[L,X]=A.current.cell;const[,Y]=A.current.cell;let j=!1,ne=!1;if(Ve(P.scrollToSelectedCell,a,v))_r.current(L-R,X);else if(Xe!=="none"&&Ve(P.selectColumn,a,v))M.hasIndex(L)?Tt(M.remove(L),void 0,!0):Xe==="single"?Tt(st.fromSingleSelection(L),void 0,!0):Tt(void 0,L,!0);else if($e!=="none"&&Ve(P.selectRow,a,v))N.hasIndex(X)?Ft(N.remove(X),void 0,!0):$e==="single"?Ft(st.fromSingleSelection(X),void 0,!0):Ft(void 0,X,!0);else if(!hr&&S!==void 0&&Ve(P.activateCell,a,v))if(X===Re&&oe)window.setTimeout(()=>{const ge=Yo(L);Jn(ge??L)},0);else{const ge={inputType:"keyboard",key:a.key};O==null||O([L-R,X],ge),Rn(S,ge)}else A.current.range.height>1&&Ve(P.downFill,a,v)?vl():A.current.range.width>1&&Ve(P.rightFill,a,v)?yl():Ve(P.goToNextPage,a,v)?X+=Math.max(1,nn.current.height-4):Ve(P.goToPreviousPage,a,v)?X-=Math.max(1,nn.current.height-4):Ve(P.goToFirstCell,a,v)?(i(void 0),X=0,L=0):Ve(P.goToLastCell,a,v)?(i(void 0),X=Number.MAX_SAFE_INTEGER,L=Number.MAX_SAFE_INTEGER):Ve(P.selectToFirstCell,a,v)?(i(void 0),Hn([-2,-2])):Ve(P.selectToLastCell,a,v)?(i(void 0),Hn([2,2])):hr?(Ve(P.closeOverlay,a,v)&&i(void 0),Ve(P.acceptOverlayDown,a,v)&&(i(void 0),X++),Ve(P.acceptOverlayUp,a,v)&&(i(void 0),X--),Ve(P.acceptOverlayLeft,a,v)&&(i(void 0),L--),Ve(P.acceptOverlayRight,a,v)&&(i(void 0),L++)):(Ve(P.goDownCell,a,v)?X+=1:Ve(P.goUpCell,a,v)?X-=1:Ve(P.goRightCell,a,v)?L+=1:Ve(P.goLeftCell,a,v)?L-=1:Ve(P.goDownCellRetainSelection,a,v)?(X+=1,j=!0):Ve(P.goUpCellRetainSelection,a,v)?(X-=1,j=!0):Ve(P.goRightCellRetainSelection,a,v)?(L+=1,j=!0):Ve(P.goLeftCellRetainSelection,a,v)?(L-=1,j=!0):Ve(P.goToLastRow,a,v)?X=Re-1:Ve(P.goToFirstRow,a,v)?X=Number.MIN_SAFE_INTEGER:Ve(P.goToLastColumn,a,v)?L=Number.MAX_SAFE_INTEGER:Ve(P.goToFirstColumn,a,v)?L=Number.MIN_SAFE_INTEGER:(ze==="rect"||ze==="multi-rect")&&(Ve(P.selectGrowDown,a,v)?Hn([0,1]):Ve(P.selectGrowUp,a,v)?Hn([0,-1]):Ve(P.selectGrowRight,a,v)?Hn([1,0]):Ve(P.selectGrowLeft,a,v)?Hn([-1,0]):Ve(P.selectToLastRow,a,v)?Hn([0,2]):Ve(P.selectToFirstRow,a,v)?Hn([0,-2]):Ve(P.selectToLastColumn,a,v)?Hn([2,0]):Ve(P.selectToFirstColumn,a,v)&&Hn([-2,0])),ne=v.didMatch);if(In!==void 0&&In!=="normal"&&X!==Y){const ge=In==="skip-up"||In==="skip"||In==="block",Je=In==="skip-down"||In==="skip"||In==="block",Ie=X<Y;if(Ie&&ge){for(;X>=0&&bo(X).isGroupHeader;)X--;X<0&&(X=Y)}else if(!Ie&&Je){for(;X<Re&&bo(X).isGroupHeader;)X++;X>=Re&&(X=Y)}}const Ne=eo(L,X,!1,j),Se=v.didMatch;return Se&&(Ne||!ne||Rr)&&b(),Se},[In,hr,A,le,Xe,$e,ze,R,bo,Re,eo,je,Ht,F.length,Zt,Rr,vo,Tt,Ft,oe,Yo,Jn,O,Rn,vl,yl,Hn]),Co=s.useCallback(a=>{let b=!1;if(Me!==void 0&&Me({...a,...a.location&&{location:[a.location[0]-R,a.location[1]]},cancel:()=>{b=!0}}),b||kl(a)||A.current===void 0)return;const[v,S]=A.current.cell,M=nn.current,N=a.keyCode===229,P=We&&!a.metaKey&&!a.ctrlKey&&a.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(a.key);if((N||P)&&a.bounds!==void 0&&ro(D([v-R,Math.max(0,Math.min(S,Re-1))]))){if((!oe||S!==Re)&&(M.y>S||S>M.y+M.height||M.x>v||v>M.x+M.width))return;if(a.stopPropagation(),a.preventDefault(),N){const L={inputType:"keyboard",key:""};O==null||O([v-R,S],L),Rn(a.bounds,L,"")}else{const L={inputType:"keyboard",key:a.key};O==null||O([v-R,S],L),Rn(a.bounds,L,a.key)}}},[We,Me,kl,A,D,R,Re,oe,O,Rn]),sa=s.useCallback((a,b)=>{var v;if(console.log("[onGhostInput] value:",a,"composing:",b,"overlay:",p.current!==void 0),p.current!==void 0){console.log("[onGhostInput] overlay already open, returning");return}if(!b&&a.length>0&&A.current!==void 0){const[S,M]=A.current.cell,N=Xt([S,M]);if(N.allowOverlay&&ro(N)&&N.readonly!==!0){const P=(v=zt.current)==null?void 0:v.getBounds(S,M);if(P!==void 0){const L={inputType:"keyboard",key:a};O==null||O([S-R,M],L),Rn(P,L,a)}}}},[A,Xt,R,O,Rn]),aa=s.useCallback(()=>{var S,M,N,P,L;if(console.log("[onGhostCompositionStart] called"),console.log("[onGhostCompositionStart] gridSelection.current:",A.current),console.log("[onGhostCompositionStart] overlayRef.current:",p.current),A.current===void 0)return;const[a,b]=A.current.cell,v=(S=p.current)==null?void 0:S.cell;if(v!==void 0&&(v[0]!==a||v[1]!==b)&&(console.log("[onGhostCompositionStart] Different cell detected, closing previous overlay"),(M=m.current)==null||M.clear(),(N=m.current)==null||N.setVisible(!1),w(!1),p.current=void 0,i(void 0)),p.current===void 0){const X=Xt([a,b]);if(X.allowOverlay&&ro(X)&&X.readonly!==!0){const Y=(P=zt.current)==null?void 0:P.getBounds(a,b);if(Y!==void 0){(L=m.current)==null||L.clear();const j={inputType:"keyboard",key:""};O==null||O([a-R,b],j),Rn(Y,j,"")}}}},[A,Xt,R,O,Rn]),ca=s.useCallback(a=>{},[]),da=s.useCallback(a=>{var N,P;if(console.log("[onGhostKeyDown] key:",a.key,"isComposing:",a.nativeEvent.isComposing),a.nativeEvent.isComposing){console.log("[onGhostKeyDown] IGNORED due to isComposing");return}if(p.current!==void 0&&h.current){const L=a.key;if(L==="Escape"){a.preventDefault(),a.stopPropagation(),fr(void 0,[0,0]);return}if(L==="Enter"&&!a.shiftKey){a.preventDefault(),a.stopPropagation(),fr(void 0,[0,1]);return}if(L==="Tab"){a.preventDefault(),a.stopPropagation(),fr(void 0,a.shiftKey?[-1,0]:[1,0]);return}}if(a.key.length===1&&!a.ctrlKey&&!a.metaKey&&!a.altKey)return;if(p.current!==void 0&&h.current){const L=a.key;if(L==="Backspace"||L==="Delete"||(L==="ArrowLeft"||L==="ArrowRight"||L==="ArrowUp"||L==="ArrowDown"||L==="Home"||L==="End"))return}const b=(N=A.current)==null?void 0:N.cell,v=b!==void 0?(P=zt.current)==null?void 0:P.getBounds(b[0],b[1]):void 0;let S=!1;const M={bounds:v,cancel:()=>{S=!0},stopPropagation:()=>a.stopPropagation(),preventDefault:()=>a.preventDefault(),ctrlKey:a.ctrlKey,metaKey:a.metaKey,shiftKey:a.shiftKey,altKey:a.altKey,key:a.key,keyCode:a.keyCode,rawEvent:a,location:b};Co(M),S&&(a.preventDefault(),a.stopPropagation())},[A,Co,fr]),ua=s.useCallback(a=>{var M,N;const b=(M=A.current)==null?void 0:M.cell,S={bounds:b!==void 0?(N=zt.current)==null?void 0:N.getBounds(b[0],b[1]):void 0,cancel:()=>{},stopPropagation:()=>a.stopPropagation(),preventDefault:()=>a.preventDefault(),ctrlKey:a.ctrlKey,metaKey:a.metaKey,shiftKey:a.shiftKey,altKey:a.altKey,key:a.key,keyCode:a.keyCode,rawEvent:a,location:b};Qe==null||Qe(S)},[A,Qe]),fa=s.useCallback(()=>{Fi(!0)},[]),ha=s.useCallback(()=>{Fi(!1)},[]),ga=s.useCallback((a,b)=>{const v=a.location[0]-R;if(a.kind==="header"&&(we==null||we(v,{...a,preventDefault:b})),a.kind===Fn){if(v<0)return;fe==null||fe(v,{...a,preventDefault:b})}if(a.kind==="cell"){const[S,M]=a.location;ae==null||ae([v,M],{...a,preventDefault:b}),hc(A,a.location)||eo(S,M,!1,!1)}},[A,ae,fe,we,R,eo]),Di=s.useCallback(async a=>{var P,L,X;if(!le.paste)return;function b(Y,j,ne,K){var Se,Le;const Ne=typeof ne=="object"?(ne==null?void 0:ne.join(`
`))??"":(ne==null?void 0:ne.toString())??"";if(!So(Y)&&ro(Y)&&Y.readonly!==!0){const Pe=W==null?void 0:W(Ne,Y);if(Pe!==void 0&&Dn(Pe))return{location:j,value:Pe};const Ce=Jt(Y);if(Ce===void 0)return;if(Ce.kind===te.Custom){un(Y.kind===te.Custom);const ge=(Se=Ce.onPaste)==null?void 0:Se.call(Ce,Ne,Y.data);return ge===void 0?void 0:{location:j,value:{...Y,data:ge}}}else{const ge=(Le=Ce.onPaste)==null?void 0:Le.call(Ce,Ne,Y,{formatted:K,formattedString:typeof K=="string"?K:K==null?void 0:K.join(`
`),rawValue:ne});return ge===void 0?void 0:(un(ge.kind===Y.kind),{location:j,value:ge})}}}const v=A.columns,S=A.rows,M=((P=ut.current)==null?void 0:P.contains(document.activeElement))===!0||((L=l.current)==null?void 0:L.contains(document.activeElement))===!0;let N;if(A.current!==void 0?N=[A.current.range.x,A.current.range.y]:v.length===1?N=[v.first()??0,0]:S.length===1&&(N=[R,S.first()??0]),M&&N!==void 0){let Y,j;const ne="text/plain",K="text/html";if(navigator.clipboard.read!==void 0){const Pe=await navigator.clipboard.read();for(const Ce of Pe){if(Ce.types.includes(K)){const Je=await(await Ce.getType(K)).text(),Ie=jl(Je);if(Ie!==void 0){Y=Ie;break}}Ce.types.includes(ne)&&(j=await(await Ce.getType(ne)).text())}}else if(navigator.clipboard.readText!==void 0)j=await navigator.clipboard.readText();else if(a!==void 0&&(a==null?void 0:a.clipboardData)!==null){if(a.clipboardData.types.includes(K)){const Pe=a.clipboardData.getData(K);Y=jl(Pe)}Y===void 0&&a.clipboardData.types.includes(ne)&&(j=a.clipboardData.getData(ne))}else return;const[Ne,Se]=N,Le=[];do{if(nt===void 0){const Pe=Xt(N),Ce=j??(Y==null?void 0:Y.map(Je=>Je.map(Ie=>Ie.rawValue).join("	")).join("	"))??"",ge=b(Pe,N,Ce,void 0);ge!==void 0&&Le.push(ge);break}if(Y===void 0){if(j===void 0)return;Y=fu(j)}if(nt===!1||typeof nt=="function"&&(nt==null?void 0:nt([N[0]-R,N[1]],Y.map(Pe=>Pe.map(Ce=>{var ge;return((ge=Ce.rawValue)==null?void 0:ge.toString())??""}))))!==!0)return;for(const[Pe,Ce]of Y.entries()){if(Pe+Se>=Re)break;for(const[ge,Je]of Ce.entries()){const Ie=[ge+Ne,Pe+Se],[Lt,on]=Ie;if(Lt>=et.length||on>=_t)continue;const rn=Xt(Ie),Cn=b(rn,Ie,Je.rawValue,Je.formatted);Cn!==void 0&&Le.push(Cn)}}}while(!1);yn(Le),(X=zt.current)==null||X.damage(Le.map(Pe=>({cell:Pe.location})))}},[W,Jt,Xt,A,le.paste,ut,et.length,yn,_t,nt,R,Re]);Qt("paste",Di,C,!1,!0);const gr=s.useCallback(async(a,b)=>{var P,L;if(!le.copy)return;const v=b===!0||((P=ut.current)==null?void 0:P.contains(document.activeElement))===!0||((L=l.current)==null?void 0:L.contains(document.activeElement))===!0,S=A.columns,M=A.rows,N=(X,Y)=>{if(!me)Jl(X,Y,a);else{const j=Y.map(ne=>({kind:te.Text,data:F[ne].title,displayData:F[ne].title,allowOverlay:!1}));Jl([j,...X],Y,a)}};if(v&&bt!==void 0){if(A.current!==void 0){let X=bt(A.current.range,lt.current.signal);typeof X!="object"&&(X=await X()),N(X,xo(A.current.range.x-R,A.current.range.x+A.current.range.width-R))}else if(M!==void 0&&M.length>0){const Y=[...M].map(j=>{const ne=bt({x:R,y:j,width:F.length,height:1},lt.current.signal);return typeof ne=="object"?ne[0]:ne().then(K=>K[0])});if(Y.some(j=>j instanceof Promise)){const j=await Promise.all(Y);N(j,xo(F.length))}else N(Y,xo(F.length))}else if(S.length>0){const X=[],Y=[];for(const j of S){let ne=bt({x:j,y:0,width:1,height:Re},lt.current.signal);typeof ne!="object"&&(ne=await ne()),X.push(ne),Y.push(j-R)}if(X.length===1)N(X[0],Y);else{const j=X.reduce((ne,K)=>ne.map((Ne,Se)=>[...Ne,...K[Se]]));N(j,Y)}}}},[F,bt,A,le.copy,R,ut,Re,me]);Qt("copy",gr,C,!1,!1);const ma=s.useCallback(async a=>{var v,S;if(!(!le.cut||!(((v=ut.current)==null?void 0:v.contains(document.activeElement))===!0||((S=l.current)==null?void 0:S.contains(document.activeElement))===!0))&&(await gr(a),A.current!==void 0)){let M={current:{cell:A.current.cell,range:A.current.range,rangeStack:[]},rows:st.empty(),columns:st.empty()};const N=Zt==null?void 0:Zt(M);if(N===!1||(M=N===!0?M:N,M.current===void 0))return;vo(M.current.range)}},[vo,A,le.cut,gr,ut,Zt]);Qt("cut",ma,C,!1,!1);const wa=s.useCallback((a,b)=>{if(ue!==void 0){R!==0&&(a=a.map(M=>[M[0]-R,M[1]])),ue(a,b);return}if(a.length===0||b===-1)return;const[v,S]=a[b];u.current!==void 0&&u.current[0]===v&&u.current[1]===S||(u.current=[v,S],eo(v,S,!1,!1))},[ue,R,eo]),[Yr,Kr]=((Hl=rt==null?void 0:rt.current)==null?void 0:Hl.cell)??[],_r=s.useRef(Et);_r.current=Et,s.useLayoutEffect(()=>{var a,b,v,S;Hi.current&&!zr.current&&Yr!==void 0&&Kr!==void 0&&(Yr!==((b=(a=cn.current)==null?void 0:a.current)==null?void 0:b.cell[0])||Kr!==((S=(v=cn.current)==null?void 0:v.current)==null?void 0:S.cell[1]))&&_r.current(Yr,Kr),zr.current=!1},[Yr,Kr]);const xl=A.current!==void 0&&(A.current.cell[0]>=et.length||A.current.cell[1]>=_t);s.useLayoutEffect(()=>{xl&&je(Wi,!1)},[xl,je]);const pa=s.useMemo(()=>oe===!0&&(Ke==null?void 0:Ke.tint)===!0?st.fromSingleSelection(_t-1):st.empty(),[_t,oe,Ke==null?void 0:Ke.tint]),ba=s.useCallback(a=>typeof At=="boolean"?At:(At==null?void 0:At(a-R))??!0,[R,At]),ya=s.useMemo(()=>{if(xi===void 0||l.current===null)return null;const{bounds:a,group:b}=xi,v=l.current.getBoundingClientRect();return s.createElement(tu,{bounds:a,group:b,canvasBounds:v,onClose:()=>Si(void 0),onFinish:S=>{Si(void 0),re==null||re(b,S)}})},[re,xi]),va=Math.min(et.length,ot+R);s.useImperativeHandle(t,()=>({appendRow:(a,b)=>Jn(a+R,b),appendColumn:(a,b)=>Nr(a,b),updateCells:a=>{var b;return R!==0&&(a=a.map(v=>({cell:[v.cell[0]+R,v.cell[1]]}))),(b=zt.current)==null?void 0:b.damage(a)},getBounds:(a,b)=>{var v;if(!((l==null?void 0:l.current)===null||(ut==null?void 0:ut.current)===null)){if(a===void 0&&b===void 0){const S=l.current.getBoundingClientRect(),M=S.width/ut.current.clientWidth;return{x:S.x-ut.current.scrollLeft*M,y:S.y-ut.current.scrollTop*M,width:ut.current.scrollWidth*M,height:ut.current.scrollHeight*M}}return(v=zt.current)==null?void 0:v.getBounds((a??0)+R,b)}},focus:()=>{var a;return(a=zt.current)==null?void 0:a.focus()},emit:async a=>{switch(a){case"delete":Co({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Co({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Co({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await gr(void 0,!0);break;case"paste":await Di();break}},scrollTo:Et,remeasureColumns:a=>{for(const b of a)Gr(b+R)},getMouseArgsForPosition:(a,b,v)=>{if((zt==null?void 0:zt.current)===null)return;const S=zt.current.getMouseArgsForPosition(a,b,v);if(S!==void 0)return{...S,location:[S.location[0]-R,S.location[1]]}}}),[Jn,Nr,Gr,ut,gr,Co,Di,R,Et]);const[Sl,Ml]=Ln??[],Ca=s.useCallback(a=>{const[b,v]=a;if(v===-1){Xe!=="none"&&(Tt(st.fromSingleSelection(b),void 0,!1),Kt());return}Sl===b&&Ml===v||(Pt({cell:a,range:{x:b,y:v,width:1,height:1}},!0,!1,"keyboard-nav"),Et(b,v))},[Xe,Kt,Et,Sl,Ml,Pt,Tt]),[ka,Fi]=s.useState(!1),El=s.useRef(ls(a=>{Fi(a)},5)),xa=s.useCallback(()=>{El.current(!0),A.current===void 0&&A.columns.length===0&&A.rows.length===0&&d===void 0&&Pt({cell:[R,Lr],range:{x:R,y:Lr,width:1,height:1}},!0,!1,"keyboard-select")},[Lr,A,d,R,Pt]),Sa=s.useCallback(()=>{El.current(!1)},[]),[Ma,Ea]=s.useMemo(()=>{let a;const b=(yt==null?void 0:yt.scrollbarWidthOverride)??Gi(),v=Re+(oe?1:0);if(typeof Pn=="number")a=ar+v*Pn;else{let M=0;const N=Math.min(v,10);for(let P=0;P<N;P++)M+=Pn(P);M=Math.floor(M/N),a=ar+v*M}a+=b;const S=et.reduce((M,N)=>N.width+M,0)+b;return[`${Math.min(1e5,S)}px`,`${Math.min(1e5,a)}px`]},[et,yt==null?void 0:yt.scrollbarWidthOverride,Pn,Re,oe,ar]),Ra=s.useMemo(()=>ms($t),[$t]);return s.createElement(Qi.Provider,{value:$t},s.createElement(wu,{style:Ra,className:ve,inWidth:I??Ma,inHeight:G??Ea},s.createElement(Jd,{fillHandle:xr,drawFocusRing:Po,experimental:yt,fixedShadowX:Nn,fixedShadowY:Gn,getRowThemeOverride:Mn,headerIcons:Io,imageWindowLoader:Sr,initialSize:Mr,isDraggable:Ho,onDragLeave:Do,onRowMoved:An,overscrollX:z,overscrollY:V,preventDiagonalScrolling:_n,rightElement:di,rightElementProps:Er,smoothScrollX:ui,smoothScrollY:Xn,className:ve,enableGroups:cl,onCanvasFocused:xa,onCanvasBlur:Sa,canvasRef:l,onContextMenu:ga,theme:$t,cellXOffset:_s,cellYOffset:Lr,accessibilityHeight:wo.height,onDragEnd:ra,columns:et,nonGrowWidth:al,drawHeader:dn,onColumnProposeMove:ta,drawCell:mo,disabledRows:pa,freezeColumns:va,lockColumns:R,firstColAccessible:R===0,getCellContent:Xt,minColumnWidth:jn,maxColumnWidth:No,searchInputRef:c,showSearch:pt,onSearchClose:wt,highlightRegions:Vs,getCellsForSelection:bt,getGroupDetails:yi,headerHeight:go,isFocused:ka,groupHeaderHeight:cl?lr:0,groupLevels:sr,groupHeaderHeights:dl,freezeTrailingRows:Gt+(oe&&(Ke==null?void 0:Ke.sticky)===!0?1:0),hasAppendRow:oe,onColumnResize:jt,onColumnResizeEnd:En,onColumnResizeStart:Zn,onCellFocused:Ca,onColumnMoved:na,onDragStart:oa,onHeaderMenuClick:Js,onHeaderIndicatorClick:Qs,onItemHovered:Ii,isFilling:(d==null?void 0:d.fillHandle)===!0,onMouseMove:Zs,onKeyDown:Co,onKeyUp:Qe,onMouseDown:Us,onMouseUp:js,onDragOverCell:qt,onDrop:Oe,onSearchResultsChanged:wa,onVisibleRegionChanged:ea,clientSize:pi,rowHeight:Pn,searchResults:Be,searchValue:ie,onSearchValueChange:Ge,rows:_t,scrollRef:ut,selection:A,translateX:wo.tx,translateY:wo.ty,verticalBorder:ba,gridRef:zt,getCellRenderer:Jt,resizeIndicator:Tr}),ya,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Du,{...r,validateCell:pn,bloom:Q,id:la,getCellRenderer:Jt,className:(yt==null?void 0:yt.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:an,imageEditorOverride:x,portalElementRef:Un,onFinishEditing:fr,markdownDivCreateNode:k,isOutsideClick:To,customEventTarget:yt==null?void 0:yt.eventTarget,isGhostMode:g}))),(()=>{const a=(Un==null?void 0:Un.current)??document.getElementById("portal");return a===null?null:is.createPortal(s.createElement(Hu,{ref:m,onInput:sa,onCompositionStart:aa,onCompositionEnd:ca,onKeyDown:da,onKeyUp:ua,onFocus:fa,onBlur:ha}),a)})())},Pu=s.forwardRef(Au);function ts(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:c,height:l,x:d,y:f}=r,u=t.maxSize??i.checkboxMaxSize,m=Math.floor(r.y+l/2),g=us(u,l,i.cellVerticalPadding),w=ds(t.contentAlign??"center",d,c,i.cellHorizontalPadding,g),h=cs(w,m,g),p=fs(d+n,f+o,h);return ji(t)&&p}const zu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:te.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Lu(e,e.cell.data,ji(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{ts(e)&&e.preventDefault()},onClick:e=>{if(ts(e))return{...e.cell,data:Os(e.cell.data)}},onPaste:(e,t)=>{let n=ei;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=qi),n===t.data?void 0:{...t,data:n}}};function Lu(e,t,n,o,r){if(!n&&t===ei)return;const{ctx:i,hoverAmount:c,theme:l,rect:d,highlighted:f,hoverX:u,hoverY:m,cell:{contentAlign:g}}=e,{x:w,y:h,width:p,height:C}=d;let x=!1;if(r>0){let y=n?1-r+r*c:.4;if(t===ei&&(y*=c),y===0)return;y<1&&(x=!0,i.globalAlpha=y)}ri(i,l,t,w,h,p,C,f,u,m,o,g),x&&(i.globalAlpha=1)}const Bu=en("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Wu=e=>{const{bubbles:t}=e,{isGhostMode:n}=s.useContext(Qo);return s.createElement(Bu,null,t.map((o,r)=>s.createElement("div",{key:r,className:"boe-bubble"},o)),s.createElement("textarea",{className:"gdg-input",autoFocus:!n}))},Ou={getAccessibilityString:e=>hs(e.data),kind:te.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>$u(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Wu,{bubbles:t.data})},onPaste:()=>{}};function $u(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:c,y:l,width:d,height:f}=n;let u=c+o.cellHorizontalPadding;const m=[];for(const g of t){if(u>c+d)break;const w=Ro(g,r,o.baseFontFull).width;m.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const g of m)Wn(r,g.x,l+(f-o.bubbleHeight)/2,g.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[g,w]of m.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[g],w.x+o.bubblePadding,l+f/2+hn(r,o))}const Nu=en("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Gu=e=>{const{drilldowns:t}=e;return s.createElement(Nu,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},Xu={getAccessibilityString:e=>hs(e.data.map(t=>t.text)),kind:te.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Ku(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Gu,{drilldowns:t.data})},onPaste:()=>{}},Oi={};function Yu(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,c=n-i*2,l=4,d=n*r,f=o+i,u=o*3,m=(u+i*2)*r,g=`${e},${t},${r},${n}`;if(Oi[g]!==void 0)return{el:Oi[g],height:d,width:m,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=m,w.height=d,h.scale(r,r),Oi[g]=w,h.beginPath(),Wn(h,i,i,u,c,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Wn(h,i+.5,i+.5,u,c,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:d,width:m,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Ku(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:c,row:l}=e,{x:d,width:f}=n,u=o.baseFontFull,m=Ms(r,u),g=Math.min(n.height,Math.max(16,Math.ceil(m*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-g)/2),h=g-10,p=o.bubblePadding,C=o.bubbleMargin;let x=d+o.cellHorizontalPadding;const y=o.roundingRadius??6,k=Yu(o.bgCell,o.drilldownBorder,g,y),I=[];for(const G of t){if(x>d+f)break;const H=Ro(G.text,r,u).width;let D=0;G.img!==void 0&&i.loadOrGetImage(G.img,c,l)!==void 0&&(D=h-8+4);const E=H+D+p*2;I.push({x,width:E}),x+=E+C}if(k!==null){const{el:G,height:F,middleWidth:H,sideWidth:D,width:E,dpr:O,padding:$}=k,T=D/O,W=$/O;for(const B of I){const J=Math.floor(B.x),Q=Math.floor(B.width),pe=Q-(T-W)*2;r.imageSmoothingEnabled=!1,r.drawImage(G,0,0,D,F,J-W,w,T,g),pe>0&&r.drawImage(G,D,0,H,F,J+(T-W),w,pe,g),r.drawImage(G,E-D,0,D,F,J+Q-(T-W),w,T,g),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[G,F]of I.entries()){const H=t[G];let D=F.x+p;if(H.img!==void 0){const E=i.loadOrGetImage(H.img,c,l);if(E!==void 0){const O=h-8;let $=0,T=0,W=E.width,B=E.height;W>B?($+=(W-B)/2,W=B):B>W&&(T+=(B-W)/2,B=W),r.beginPath(),Wn(r,D,w+g/2-O/2,O,O,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(E,$,T,W,B,D,w+g/2-O/2,O,O),r.restore(),D+=O+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(H.text,D,w+g/2+hn(r,o))}}const _u={getAccessibilityString:e=>e.data.join(", "),kind:te.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Vu(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??Ua;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},$i=4;function Vu(e,t,n,o){const{rect:r,col:i,row:c,theme:l,ctx:d,imageLoader:f}=e,{x:u,y:m,height:g,width:w}=r,h=g-l.cellVerticalPadding*2,p=[];let C=0;for(let y=0;y<t.length;y++){const k=t[y];if(k.length===0)continue;const I=f.loadOrGetImage(k,i,c);if(I!==void 0){p[y]=I;const G=I.width*(h/I.height);C+=G+$i}}if(C===0)return;C-=$i;let x=u+l.cellHorizontalPadding;o==="right"?x=Math.floor(u+w-l.cellHorizontalPadding-C):o==="center"&&(x=Math.floor(u+w/2-C/2));for(const y of p){if(y===void 0)continue;const k=y.width*(h/y.height);n>0&&(d.beginPath(),Wn(d,x,m+l.cellVerticalPadding,k,h,n),d.save(),d.clip()),d.drawImage(y,x,m+l.cellVerticalPadding,k,h),n>0&&d.restore(),x+=k+$i}}function Uu(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const qu={getAccessibilityString:()=>"",kind:te.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:c}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(Uu(n,o)*t.skeletonWidthVariability));const d=c.cellHorizontalPadding;l+d*2>=i.width&&(l=i.width-d*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*c.cellVerticalPadding);Wn(r,i.x+d,i.y+(i.height-f)/2,l,f,c.roundingRadius??3),r.fillStyle=ao(c.textDark,.1),r.fill()},onPaste:()=>{}},ju=()=>e=>e.targetWidth,ns=en("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[ju(),"px"]}}),Zu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:c,validatedSelection:l}=e,{isGhostMode:d}=s.useContext(Qo),f=t.data,u=t.readonly===!0,[m,g]=s.useState(f===""||o),w=s.useCallback(()=>{g(p=>!p)},[]),h=f?"gdg-ml-6":"";return m?s.createElement(ns,{targetWidth:i.width-20},s.createElement(el,{autoFocus:!d,highlight:!1,validatedSelection:l,value:f,onKeyDown:p=>{p.key==="Enter"&&p.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${h}`,onClick:()=>c(t)},s.createElement(Na,null))):s.createElement(ns,{targetWidth:i.width},s.createElement(ja,{contents:f,createNode:r}),!u&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${h}`,onClick:w},s.createElement(Zi,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!d}))},Ju={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:te.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:ai,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Kn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:c,validatedSelection:l}=e;return s.createElement(Zu,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:d=>t({...n,data:d.target.value}),forceEditMode:c,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Qu={getAccessibilityString:e=>e.row.toString(),kind:Wt.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:ef,measure:()=>44,draw:e=>nf(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e;if(n.disabled===!0)return;const{width:i,height:c}=t,l=n.drawHandle?7+(i-7)/2:i/2,d=c/2;if(Math.abs(o-l)<=10&&Math.abs(r-d)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function ef(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=tf,n.textAlign="center",i}function tf(e){const{ctx:t}=e;t.textAlign="start"}function nf(e,t,n,o,r,i,c){if(c){const{ctx:C,rect:x,theme:y}=e,{x:k,y:I,width:G,height:F}=x,H=o==="checkbox"?"checkbox-visible":o;if(H!=="number"&&(C.globalAlpha=n?1:.4,ri(C,y,n,r?k+7:k,I,r?G-7:G,F,!1,-20,-20,y.checkboxMaxSize,"center",i,!0),C.globalAlpha=1),H==="number"||H==="both"&&!n){const D=t.toString(),E=y.markerFontFull,O=k+G/2;C.fillStyle="#cccccc",C.font=E,C.fillText(D,O,I+F/2+hn(C,E))}if(r){C.globalAlpha=.4,C.beginPath();for(const D of[3,6])for(const E of[-5,-1,3])C.rect(k+D,I+F/2+E,2,2);C.fillStyle="#cccccc",C.fill(),C.beginPath(),C.globalAlpha=1}return}const{ctx:l,rect:d,hoverAmount:f,theme:u}=e,{x:m,y:g,width:w,height:h}=d,p=n?1:o==="checkbox-visible"?.6+.4*f:f;if(o!=="number"&&p>0){l.globalAlpha=p;const C=7*(n?f:1);if(ri(l,u,n,r?m+C:m,g,r?w-C:w,h,!0,void 0,void 0,u.checkboxMaxSize,"center",i,c),r){l.globalAlpha=f,l.beginPath();for(const x of[3,6])for(const y of[-5,-1,3])l.rect(m+x,g+h/2+y,2,2);l.fillStyle=u.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const C=t.toString(),x=u.markerFontFull,y=m+w/2;o==="both"&&f!==0&&(l.globalAlpha=1-f),l.fillStyle=u.textLight,l.font=x,l.fillText(C,y,g+h/2+hn(l,x)),f!==0&&(l.globalAlpha=1)}}const of={getAccessibilityString:()=>"",kind:Wt.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>rf(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function rf(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:c,spriteManager:l}=e,{x:d,y:f,width:u,height:m}=r;o.beginPath(),o.globalAlpha=i,o.rect(d+1,f+1,u,m-2),o.fillStyle=c.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let w=0;if(n!==void 0){const p=m-8,C=d+8/2,x=f+8/2;l.drawSprite(n,"normal",o,C,x,p,c,g?1:i),w=p}else{w=24;const h=12,p=g?h:i*h,C=g?0:(1-i)*h*.5,x=c.cellHorizontalPadding+4;p>0&&(o.moveTo(d+x+C,f+m/2),o.lineTo(d+x+C+p,f+m/2),o.moveTo(d+x+C+p*.5,f+m/2-p*.5),o.lineTo(d+x+C+p*.5,f+m/2+p*.5),o.lineWidth=2,o.strokeStyle=c.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=c.textMedium,o.fillText(t,w+d+c.cellHorizontalPadding+.5,f+m/2+hn(o,c)),o.beginPath()}function Gs(e,t,n,o,r,i,c){e.textBaseline="alphabetic";const l=lf(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Wn(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??ao(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",c==null||c("text")}function lf(e,t,n,o,r){const i=o.cellHorizontalPadding,c=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+c/2+1,width:t.width-i,height:t.height-c-1};const l=Ro(n,e,o.baseFontFull,"alphabetic"),d=t.height-c,f=Math.min(d,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const sf=s.lazy(async()=>await rs(()=>import("./number-overlay-editor-D_0tbC1M.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),af={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:te.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:ai,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:c}=e,{hoverEffect:l,displayData:d,hoverEffectTheme:f}=n;l===!0&&t>0&&Gs(o,r,f,d,i,t,c),Kn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(sf,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},cf={getAccessibilityString:()=>"",measure:()=>108,kind:te.Protected,needsHover:!1,needsHoverPosition:!1,draw:df,onPaste:()=>{}};function df(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:c}=o;t.beginPath();const l=2.5;let d=r+n.cellHorizontalPadding+l;const f=i+c/2,u=Math.cos(zl(30))*l,m=Math.sin(zl(30))*l;for(let g=0;g<12;g++)t.moveTo(d,f-l),t.lineTo(d,f+l),t.moveTo(d+u,f-m),t.lineTo(d-u,f+m),t.moveTo(d-u,f-m),t.lineTo(d+u,f+m),d+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const uf={getAccessibilityString:e=>e.rowId??"",kind:Wt.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>Ro(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:r}=e,i=o.rowId;if(!i)return;t.fillStyle=r.textDark,t.font=r.baseFontStyle,t.textAlign="left";const c=n.x+r.cellHorizontalPadding,l=n.y+n.height/2;t.fillText(i,c,l+hn(t,r))},onClick:()=>{},onPaste:()=>{}},ff={getAccessibilityString:e=>e.rowId??"",kind:Wt.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:hf,measure:()=>80,draw:e=>mf(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function hf(e,t){const{ctx:n}=e,o="12px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=gf,n.textAlign="left",r}function gf(e){const{ctx:t}=e;t.textAlign="start"}function mf(e,t){if(!t)return;const{ctx:n,rect:o,theme:r}=e,{x:i,y:c,height:l}=o;n.fillStyle=r.textDark,n.font="12px sans-serif";const d=i+8,f=c+l/2;n.fillText(t,d,f+hn(n,n.font))}const wf={getAccessibilityString:e=>e.status??"",kind:Wt.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:pf,measure:()=>40,draw:e=>yf(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function pf(e,t){const{ctx:n}=e,o="bold 14px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=bf,n.textAlign="center",r}function bf(e){const{ctx:t}=e;t.textAlign="start"}function yf(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:r,y:i,width:c,height:l}=o,d={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=d[t],n.font="bold 14px sans-serif";const f=r+c/2,u=i+l/2;n.fillText(t,f,u+hn(n,n.font))}const vf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:te.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:ai,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:c,overrideCursor:l}=e,{displayData:d,contentAlign:f,hoverEffect:u,allowWrapping:m,hoverEffectTheme:g}=t;u===!0&&n>0&&Gs(r,c,g,d,i,n,l),Kn(e,d,f,m,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(el,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:c=>o({...r,data:c.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Cf=en("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),kf=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:c}=e,{isGhostMode:l}=s.useContext(Qo),[d,f]=s.useState(!r&&(t===""||o)),u=s.useCallback(()=>{f(!0)},[]);return d?s.createElement(el,{validatedSelection:i,highlight:!0,autoFocus:!l,value:t,onChange:n}):s.createElement(Cf,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},c),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:u},s.createElement(Zi,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!l}))};function Xs(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,c=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-c-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-c/2),{x:r,y:i,width:c,height:l}}function os(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,c=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=xs(c,i.baseFontFull);if(l===void 0)return!1;const d=Xs(l,n,i,t.contentAlign);return so({x:d.x-4,y:d.y-4,width:d.width+8,height:d.height+8},o,r)}const xf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:te.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:ai,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:c,ctx:l}=e,d=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Ro(d,l,n.baseFontFull),m=Xs(u,c,n,t.contentAlign),{x:g,y:w,width:h,height:p}=m;if(r>=g-4&&r<=g-4+h+8&&i>=w-4&&i<=w-4+p+8){const C=hn(l,n.baseFontFull);o("pointer");const x=5,y=w-C;l.beginPath(),l.moveTo(c.x+g,Math.floor(c.y+y+p+x)+.5),l.lineTo(c.x+g+h,Math.floor(c.y+y+p+x)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Kn({...e,rect:{...c,x:c.x-1}},d,t.contentAlign),Kn({...e,rect:{...c,x:c.x-2}},d,t.contentAlign),Kn({...e,rect:{...c,x:c.x+1}},d,t.contentAlign),Kn({...e,rect:{...c,x:c.x+2}},d,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Kn(e,d,t.contentAlign)},onSelect:e=>{os(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;os(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(kf,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:c=>n({...o,data:c.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Sf=[Qu,of,wf,ff,zu,Ou,Xu,_u,qu,Ju,af,cf,uf,vf,xf],Ni=[];class Mf extends Rs{constructor(){super(...arguments);_e(this,"imageLoaded",()=>{});_e(this,"loadedLocations",[]);_e(this,"cache",{});_e(this,"sendLoaded",za(()=>{this.imageLoaded(new qo(this.loadedLocations)),this.loadedLocations=[]},20));_e(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let c=0;c<r.cells.length;c++){const l=r.cells[c];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let c=!1;const l=Ni.pop()??new Image;let d=!1;const f={img:void 0,cells:[Tn(o,r)],url:n,cancel:()=>{d||(d=!0,Ni.length<12?Ni.unshift(l):c||(l.src=""))}},u=new Promise(m=>l.addEventListener("load",()=>m(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const m=this.cache[i];if(m!==void 0&&!d){m.img=l;for(const g of m.cells)this.loadedLocations.push(ol(g));c=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,c=this.cache[i];if(c!==void 0){const l=Tn(o,r);return c.cells.includes(l)||c.cells.push(l),c.img}else this.loadImage(n,o,r,i)}}const Ef=(e,t)=>{const n=s.useMemo(()=>({...id,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??Sf,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new Mf,[e.imageWindowLoader]);return s.createElement(Pu,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Of=s.forwardRef(Ef);export{Of as D,te as G,el as a,Ms as b,fn as c,Wf as d,Lf as e,Pf as f,hn as g,Dn as h,zf as i,Tl as j,Qo as k,Ro as m,Zo as p,Wn as r,Bf as u};
