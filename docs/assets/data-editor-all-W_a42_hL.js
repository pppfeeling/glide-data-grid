const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./image-window-loader-DnW574Gd.js","./iframe-DelEik1u.js","./preload-helper-C1FmrZbK.js","./throttle-B8GU50-r.js","./marked.esm-RnuSlOMI.js","./index-DDKwlnpI.js","./image-window-loader-Bm61kU6i.css"])))=>i.map(i=>d[i]);
import{r as n,R as _e}from"./iframe-DelEik1u.js";import{_ as hi}from"./preload-helper-C1FmrZbK.js";import{r as gi}from"./index-DDKwlnpI.js";import{G as ee,d as Yo,e as mi,f as _o,r as hr,h as Zo,C as ze,t as xr,j as At,k as gr,l as vi,b as kn,n as qo,i as mo,o as mr,g as kr,p as pi,w as Dt,q as Ci,s as eo,v as wi,x as yi,y as bi,z as xi,B as ki,D as Ri,E as Mi,F as Rn,H as vr,I as Vt,J as Si,K as Ti,L as Ei,M as pr,N as Ii,O as zi,P as Cr,Q as Li,R as Di,S as Hi,T as Fi,U as $i,A as Gi,V as Ki}from"./image-window-loader-DnW574Gd.js";import{r as to,m as Bt,g as Pi}from"./throttle-B8GU50-r.js";import{u as Ni,f as wr}from"./flatten-C5fNT6Z1.js";import{G as Wi}from"./scrolling-data-grid-CGxIGIry.js";import{s as Jo}from"./marked.esm-RnuSlOMI.js";const Ge='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Vi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}<rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},Bi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}<rect x="2" y="2" width="16" height="16" rx="4" fill="${l}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},Ai=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},Ui=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},Oi=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${l}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},Rr=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},_i=e=>{const o=e.bgColor;return`${Ge}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Xi=Rr,Yi=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},qi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},Zi=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Ji=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${l}"/>
  </svg>`},Qi=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},ji=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},es=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},ts=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},os=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${l}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${l}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},ns=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${l}"/>
</svg>`},rs=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},ls=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},is=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},ss=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},cs=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${l}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},as=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},us=e=>{const o=e.fgColor,l=e.bgColor;return`
    ${Ge}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},ds=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${l}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},fs=e=>{const o=e.fgColor,l=e.bgColor;return`${Ge}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${l}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},hs=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},gs=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},ms=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),vs=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),ps={headerRowID:Vi,headerNumber:Ai,headerCode:Bi,headerString:Ui,headerBoolean:Oi,headerAudioUri:Xi,headerVideoUri:Yi,headerEmoji:qi,headerImage:Zi,headerUri:Rr,headerPhone:Ji,headerMarkdown:Qi,headerDate:ji,headerTime:es,headerEmail:ts,headerReference:os,headerIfThenElse:ns,headerSingleValue:rs,headerLookup:ls,headerTextTemplate:is,headerMath:ss,headerRollup:cs,headerJoinStrings:as,headerSplitString:us,headerGeoDistance:ds,headerArray:fs,rowOwnerOverlay:hs,protectedColumnOverlay:gs,renameIcon:_i,headerArrowDown:ms,headerArrowUp:vs},Cs=Jo("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),ws=n.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},n.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),ys=n.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},n.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),bs=n.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},n.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),xs=10,ks=e=>{const{canvasRef:o,cellYOffset:l,rows:s,columns:u,searchInputRef:m,searchValue:E,searchResults:f,onSearchValueChange:y,getCellsForSelection:T,onSearchResultsChanged:c,showSearch:d=!1,onSearchClose:p}=e,[R]=n.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[$,D]=n.useState(""),te=E??$,ye=n.useCallback(k=>{D(k),y==null||y(k)},[y]),[H,S]=n.useState(),Y=n.useRef(H);Y.current=H,n.useEffect(()=>{f!==void 0&&(f.length>0?S(k=>({rowsSearched:s,results:f.length,selectedIndex:(k==null?void 0:k.selectedIndex)??-1})):S(void 0))},[s,f]);const be=n.useRef();be.current===void 0&&(be.current=new AbortController);const C=n.useRef(),[P,W]=n.useState([]),Q=f??P,F=n.useCallback(()=>{C.current!==void 0&&(window.cancelAnimationFrame(C.current),C.current=void 0),be.current!==void 0&&be.current.abort(),be.current=new AbortController},[]),re=n.useRef(l);re.current=l;const se=n.useCallback(k=>{const _=new RegExp(k.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let xe=re.current,Ee=Math.min(10,s),Ke=0;S(void 0),W([]);const we=[],v=async()=>{var et;if(T===void 0)return;const de=performance.now(),I=s-Ke;let he=T({x:0,y:xe,width:u.length,height:Math.min(Ee,I,s-xe)},be.current.signal);typeof he=="function"&&(he=await he());let Fe=!1;for(const[bt,Ut]of he.entries())for(const[w,ge]of Ut.entries()){let B;switch(ge.kind){case ee.Text:case ee.Number:B=ge.displayData;break;case ee.Uri:case ee.Markdown:B=ge.data;break;case ee.Boolean:B=typeof ge.data=="boolean"?ge.data.toString():void 0;break;case ee.Image:case ee.Bubble:B=ge.data.join("üê≥");break;case ee.Custom:B=ge.copyData;break}B!==void 0&&_.test(B)&&(we.push([w,bt+xe]),Fe=!0)}const qe=performance.now();Fe&&W([...we]),Ke+=he.length,Yo(Ke<=s);const V=((et=Y.current)==null?void 0:et.selectedIndex)??-1;S({results:we.length,rowsSearched:Ke,selectedIndex:V}),c==null||c(we,V),xe+Ee>=s?xe=0:xe+=Ee;const ie=qe-de,X=Math.max(ie,1),ut=xs/X;Ee=Math.ceil(Ee*ut),Ke<s&&we.length<1e3&&(C.current=window.requestAnimationFrame(v))};F(),C.current=window.requestAnimationFrame(v)},[F,u.length,T,c,s]),A=n.useCallback(()=>{var k;p==null||p(),S(void 0),W([]),c==null||c([],-1),F(),(k=o==null?void 0:o.current)==null||k.focus()},[F,o,p,c]),U=n.useCallback(k=>{ye(k.target.value),f===void 0&&(k.target.value===""?(S(void 0),W([]),F()):se(k.target.value))},[se,F,ye,f]);n.useEffect(()=>{m.current!==null&&(ye(""),S(void 0),P.length>0&&(W([]),c==null||c([],-1)),d?m.current.focus({preventScroll:!0}):F())},[d,m]);const z=n.useCallback(k=>{var xe;if((xe=k==null?void 0:k.stopPropagation)==null||xe.call(k),H===void 0||H.results===0)return;const _=(H.selectedIndex+1)%H.results;S({...H,selectedIndex:_}),c==null||c(Q,_)},[H,c,Q]),fe=n.useCallback(k=>{var xe;if((xe=k==null?void 0:k.stopPropagation)==null||xe.call(k),H===void 0||H.results===0)return;let _=(H.selectedIndex-1)%H.results;_<0&&(_+=H.results),S({...H,selectedIndex:_}),c==null||c(Q,_)},[c,Q,H]),Ce=n.useCallback(k=>{(k.ctrlKey||k.metaKey)&&k.nativeEvent.code==="KeyF"||k.key==="Escape"?(A(),k.stopPropagation(),k.preventDefault()):k.key==="Enter"&&(k.shiftKey?fe():z())},[A,z,fe]);n.useEffect(()=>()=>{F()},[F]);const[ue,N]=n.useState(!1);n.useEffect(()=>{if(d)N(!0);else{const k=setTimeout(()=>N(!1),150);return()=>clearTimeout(k)}},[d]);const le=n.useMemo(()=>{if(!d&&!ue)return null;let k;H!==void 0&&(k=H.results>=1e3?"over 1000":`${H.results} result${H.results!==1?"s":""}`,H.selectedIndex>=0&&(k=`${H.selectedIndex+1} of ${k}`));const _=Ke=>{Ke.stopPropagation()},Ee={width:`${s>0?Math.floor(((H==null?void 0:H.rowsSearched)??0)/s*100):0}%`};return n.createElement(Cs,{className:"gdg-search-bar"+(d?"":" out"),onMouseDown:_,onMouseMove:_,onMouseUp:_,onClick:_},n.createElement("div",{className:"gdg-search-bar-inner"},n.createElement("input",{id:R,"aria-hidden":!d,"data-testid":"search-input",ref:m,onChange:U,value:te,tabIndex:d?void 0:-1,onKeyDownCapture:Ce}),n.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!d,tabIndex:d?void 0:-1,onClick:fe,disabled:((H==null?void 0:H.results)??0)===0},ws),n.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!d,tabIndex:d?void 0:-1,onClick:z,disabled:((H==null?void 0:H.results)??0)===0},ys),p!==void 0&&n.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!d,"data-testid":"search-close-button",tabIndex:d?void 0:-1,onClick:A},bs)),H!==void 0?n.createElement(n.Fragment,null,n.createElement("div",{className:"gdg-search-status"},n.createElement("div",{"data-testid":"search-result-area"},k)),n.createElement("div",{className:"gdg-search-progress",style:Ee})):n.createElement("div",{className:"gdg-search-status"},n.createElement("label",{htmlFor:R},"Type to search")))},[d,ue,H,s,R,m,U,te,Ce,fe,z,p,A]);return n.createElement(n.Fragment,null,n.createElement(Wi,{prelightCells:Q,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),le)},Rs=()=>e=>Math.max(16,e.targetHeight-10),Ms=Jo("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Rs(),"px"]}}),Ss=e=>{const{bounds:o,group:l,onClose:s,canvasBounds:u,onFinish:m}=e,[E,f]=_e.useState(l);return _e.createElement(mi,{style:{position:"absolute",left:o.x-u.left+1,top:o.y-u.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:s},_e.createElement(Ms,{targetHeight:o.height,"data-testid":"group-rename-input",value:E,onBlur:s,onFocus:y=>y.target.setSelectionRange(0,E.length),onChange:y=>f(y.target.value),onKeyDown:y=>{y.key==="Enter"?m(E):y.key==="Escape"&&s()},autoFocus:!0}))},Sn=150;function Ts(e,o,l,s){var m;const u=s(o);return((m=u==null?void 0:u.measure)==null?void 0:m.call(u,e,o,l))??Sn}function Mr(e,o,l,s,u,m,E,f,y){let T=0;const c=u===void 0?[]:u.map(R=>{const $=Ts(e,R[s],o,y);return T=Math.max(T,$),$});if(c.length>5&&f){T=0;let R=0;for(const D of c)R+=D;const $=R/c.length;for(let D=0;D<c.length;D++)c[D]>=$*2?c[D]=0:T=Math.max(T,c[D])}const d=e.font;e.font=o.headerFontFull,T=Math.max(T,e.measureText(l.title).width+o.cellHorizontalPadding*2+(l.icon===void 0?0:28)),e.font=d;const p=Math.max(Math.ceil(m),Math.min(Math.floor(E),Math.ceil(T)));return{...l,width:p}}function Es(e,o,l,s,u,m,E,f,y){const T=n.useRef(o),c=n.useRef(l),d=n.useRef(E);T.current=o,c.current=l,d.current=E;const[p,R]=n.useMemo(()=>{if(typeof window>"u")return[null,null];const H=document.createElement("canvas");return H.style.display="none",H.style.opacity="0",H.style.position="fixed",[H,H.getContext("2d",{alpha:!1})]},[]);n.useLayoutEffect(()=>(p&&document.documentElement.append(p),()=>{p==null||p.remove()}),[p]);const $=n.useRef({}),D=n.useRef(),[te,ye]=n.useState();return n.useLayoutEffect(()=>{const H=c.current;if(H===void 0||e.every(_o))return;let S=Math.max(1,10-Math.floor(e.length/1e4)),Y=0;S<T.current&&S>1&&(S--,Y=1);const be={x:0,y:0,width:e.length,height:Math.min(T.current,S)},C={x:0,y:T.current-1,width:e.length,height:1};(async()=>{const W=H(be,y.signal),Q=Y>0?H(C,y.signal):void 0;let F;typeof W=="object"?F=W:F=await hr(W),Q!==void 0&&(typeof Q=="object"?F=[...F,...Q]:F=[...F,...await hr(Q)]),D.current=e,ye(F)})()},[y.signal,e]),n.useMemo(()=>{let S=e.every(_o)?e:R===null?e.map(P=>_o(P)?P:{...P,width:Sn}):(R.font=d.current.baseFontFull,e.map((P,W)=>{if(_o(P))return P;if($.current[P.id]!==void 0)return{...P,width:$.current[P.id]};if(te===void 0||D.current!==e||P.id===void 0)return{...P,width:Sn};const Q=Mr(R,E,P,W,te,u,m,!0,f);return $.current[P.id]=Q.width,Q})),Y=0,be=0;const C=[];for(const[P,W]of S.entries())Y+=W.width,W.grow!==void 0&&W.grow>0&&(be+=W.grow,C.push(P));if(Y<s&&C.length>0){const P=[...S],W=s-Y;let Q=W;for(let F=0;F<C.length;F++){const re=C[F],se=(S[re].grow??0)/be,A=F===C.length-1?Q:Math.min(Q,Math.floor(W*se));P[re]={...S[re],growOffset:A,width:S[re].width+A},Q-=A}S=P}return{sizedColumns:S,nonGrowWidth:Y}},[s,e,R,te,E,u,m,f])}function Is(e,o){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===o.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===o.keyCode:e===o.key}function oe(e,o,l){const s=Sr(e,o);return s&&(l.didMatch=!0),s}function Sr(e,o){if(e.length===0)return!1;if(e.includes("|")){const y=e.split("|");for(const T of y)if(Sr(T,o))return!0;return!1}let l=!1,s=!1,u=!1,m=!1;const E=e.split("+"),f=E.pop();if(!Is(f,o))return!1;if(E[0]==="any")return!0;for(const y of E)switch(y){case"ctrl":l=!0;break;case"shift":s=!0;break;case"alt":u=!0;break;case"meta":m=!0;break;case"primary":Zo.value?m=!0:l=!0;break}return o.altKey===u&&o.ctrlKey===l&&o.shiftKey===s&&o.metaKey===m}function zs(e){const{state:o,keybindings:l,overlayOpen:s,columnSelect:u,rowSelect:m,rangeSelect:E,editOnType:f,trapFocus:y,showTrailingBlankRow:T,columnsInLength:c,rowGroupingNavBehavior:d,mapper:p,onKeyDownIn:R,onSelectionCleared:$,onCellActivated:D,onDelete:te,getCellContent:ye,setSelectedColumns:H,setSelectedRows:S,setShowSearchInner:Y,searchInputRef:be,adjustSelection:C,updateSelectedCell:P,deleteRange:W,fillDown:Q,fillRight:F,appendRow:re,getCustomNewRowTargetColumn:se,scrollToRef:A}=e,{gridSelection:U,gridRef:z,visibleRegionRef:fe,rowMarkerOffset:Ce,rows:ue,setGridSelection:N,getMangledCellContent:le,mangledOnCellsEdited:k,setOverlay:_,reselect:xe,focus:Ee}=o,Ke=n.useCallback(v=>{var B,ce,De,Ue;const de=()=>{v.stopPropagation(),v.preventDefault()},I={didMatch:!1},{bounds:he}=v,Fe=U.columns,qe=U.rows,V=l;if(!s&&oe(V.clear,v,I)){const j=((B=U.current)==null?void 0:B.cell)??[Ce,0];N({columns:ze.empty(),rows:ze.empty(),current:{cell:j,range:{x:j[0],y:j[1],width:1,height:1},rangeStack:[]}},!1),$==null||$(),Ee()}else if(!s&&oe(V.selectAll,v,I))N({columns:ze.empty(),rows:ze.empty(),current:{cell:((ce=U.current)==null?void 0:ce.cell)??[Ce,0],range:{x:Ce,y:0,width:c,height:ue},rangeStack:[]}},!1);else if(oe(V.search,v,I))(De=be==null?void 0:be.current)==null||De.focus({preventScroll:!0}),Y(!0);else if(oe(V.delete,v,I)){const j=(te==null?void 0:te(U))??!0;if(j!==!1){const Z=j===!0?U:j;if(Z.current!==void 0){W(Z.current.range);for(const Oe of Z.current.rangeStack)W(Oe)}for(const Oe of Z.rows)W({x:Ce,y:Oe,width:c,height:1});for(const Oe of Z.columns)W({x:Oe,y:0,width:1,height:ue})}}if(I.didMatch)return de(),!0;if(U.current===void 0)return!1;let[ie,X]=U.current.cell;const[,ut]=U.current.cell;let et=!1,bt=!1;if(oe(V.scrollToSelectedCell,v,I))A.current(ie-Ce,X);else if(u!=="none"&&oe(V.selectColumn,v,I))Fe.hasIndex(ie)?H(Fe.remove(ie),void 0,!0):u==="single"?H(ze.fromSingleSelection(ie),void 0,!0):H(void 0,ie,!0);else if(m!=="none"&&oe(V.selectRow,v,I))qe.hasIndex(X)?S(qe.remove(X),void 0,!0):m==="single"?S(ze.fromSingleSelection(X),void 0,!0):S(void 0,X,!0);else if(!s&&he!==void 0&&oe(V.activateCell,v,I))if(X===ue&&T)window.setTimeout(()=>{const j=se(ie);re(j??ie)},0);else{const j={inputType:"keyboard",key:v.key},Z=le([ie,X]);Z.kind===ee.Boolean&&Z.readonly!==!0?(D==null||D([ie-Ce,X],j),k([{location:[ie,X],value:{...Z,data:xr(Z.data)}}]),(Ue=z.current)==null||Ue.damage([{cell:[ie,X]}])):(D==null||D([ie-Ce,X],j),xe(he,j))}else U.current.range.height>1&&oe(V.downFill,v,I)?Q():U.current.range.width>1&&oe(V.rightFill,v,I)?F():oe(V.goToNextPage,v,I)?X+=Math.max(1,fe.current.height-4):oe(V.goToPreviousPage,v,I)?X-=Math.max(1,fe.current.height-4):oe(V.goToFirstCell,v,I)?(_(void 0),X=0,ie=0):oe(V.goToLastCell,v,I)?(_(void 0),X=Number.MAX_SAFE_INTEGER,ie=Number.MAX_SAFE_INTEGER):oe(V.selectToFirstCell,v,I)?(_(void 0),C([-2,-2])):oe(V.selectToLastCell,v,I)?(_(void 0),C([2,2])):s?(oe(V.closeOverlay,v,I)&&_(void 0),oe(V.acceptOverlayDown,v,I)&&(_(void 0),X++),oe(V.acceptOverlayUp,v,I)&&(_(void 0),X--),oe(V.acceptOverlayLeft,v,I)&&(_(void 0),ie--),oe(V.acceptOverlayRight,v,I)&&(_(void 0),ie++)):(oe(V.goDownCell,v,I)?X+=1:oe(V.goUpCell,v,I)?X-=1:oe(V.goRightCell,v,I)?ie+=1:oe(V.goLeftCell,v,I)?ie-=1:oe(V.goDownCellRetainSelection,v,I)?(X+=1,et=!0):oe(V.goUpCellRetainSelection,v,I)?(X-=1,et=!0):oe(V.goRightCellRetainSelection,v,I)?(ie+=1,et=!0):oe(V.goLeftCellRetainSelection,v,I)?(ie-=1,et=!0):oe(V.goToLastRow,v,I)?X=ue-1:oe(V.goToFirstRow,v,I)?X=Number.MIN_SAFE_INTEGER:oe(V.goToLastColumn,v,I)?ie=Number.MAX_SAFE_INTEGER:oe(V.goToFirstColumn,v,I)?ie=Number.MIN_SAFE_INTEGER:(E==="rect"||E==="multi-rect")&&(oe(V.selectGrowDown,v,I)?C([0,1]):oe(V.selectGrowUp,v,I)?C([0,-1]):oe(V.selectGrowRight,v,I)?C([1,0]):oe(V.selectGrowLeft,v,I)?C([-1,0]):oe(V.selectToLastRow,v,I)?C([0,2]):oe(V.selectToFirstRow,v,I)?C([0,-2]):oe(V.selectToLastColumn,v,I)?C([2,0]):oe(V.selectToFirstColumn,v,I)&&C([-2,0])),bt=I.didMatch);if(d!==void 0&&d!=="normal"&&X!==ut){const j=d==="skip-up"||d==="skip"||d==="block",Z=d==="skip-down"||d==="skip"||d==="block",Oe=X<ut;if(Oe&&j){for(;X>=0&&p(X).isGroupHeader;)X--;X<0&&(X=ut)}else if(!Oe&&Z){for(;X<ue&&p(X).isGroupHeader;)X++;X>=ue&&(X=ut)}}const w=P(ie,X,!1,et),ge=I.didMatch;return ge&&(w||!bt||y)&&de(),ge},[d,s,U,l,u,m,E,Ce,p,ue,P,N,$,c,te,y,W,H,S,T,se,re,D,xe,Q,F,C,le,k,z,_,Ee,fe,be,Y,A]),we=n.useCallback(v=>{let de=!1;if(R!==void 0&&R({...v,...v.location&&{location:[v.location[0]-Ce,v.location[1]]},cancel:()=>{de=!0}}),de||Ke(v)||U.current===void 0)return;const[I,he]=U.current.cell,Fe=fe.current,qe=v.keyCode===229,V=f&&!v.metaKey&&!v.ctrlKey&&v.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(v.key);if((qe||V)&&v.bounds!==void 0&&At(ye([I-Ce,Math.max(0,Math.min(he,ue-1))]))){if((!T||he!==ue)&&(Fe.y>he||he>Fe.y+Fe.height||Fe.x>I||I>Fe.x+Fe.width))return;if(v.stopPropagation(),v.preventDefault(),qe){const ie={inputType:"keyboard",key:""};D==null||D([I-Ce,he],ie),xe(v.bounds,ie,"")}else{const ie={inputType:"keyboard",key:v.key};D==null||D([I-Ce,he],ie),xe(v.bounds,ie,v.key)}}},[f,R,Ke,U,ye,Ce,ue,T,D,xe,fe]);return{handleFixedKeybindings:Ke,onKeyDown:we}}function Ls(e,o,l,s,u,m,E){const f=_e.useCallback((c,d,p,R)=>{var S;(m==="cell"||m==="multi-cell")&&c!==void 0&&(c={...c,range:{x:c.cell[0],y:c.cell[1],width:1,height:1}}),!E&&c!==void 0&&c.range.width>1&&(c={...c,range:{...c.range,width:1,x:c.cell[0]}});const $=l==="mixed"&&(p||R==="drag")||l==="additive",D=(s==="mixed"||s==="additive")&&$,te=p||(u==="mixed"||u==="additive")&&$;let ye={current:c===void 0?void 0:{...c,rangeStack:R==="drag"?((S=e.current)==null?void 0:S.rangeStack)??[]:[]},columns:D?e.columns:ze.empty(),rows:te?e.rows:ze.empty()};p&&(m==="multi-rect"||m==="multi-cell")&&ye.current!==void 0&&e.current!==void 0&&(ye={...ye,current:{...ye.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),o(ye,d)},[s,e,l,m,E,u,o]),y=_e.useCallback((c,d,p)=>{c=c??e.rows,d!==void 0&&(c=c.add(d));let R;if(u==="exclusive"&&c.length>0)R={current:void 0,columns:ze.empty(),rows:c};else{const $=p&&l==="mixed"||l==="additive",D=p&&s==="mixed"||s==="additive";R={current:$?e.current:void 0,columns:D?e.columns:ze.empty(),rows:c}}o(R,!1)},[s,e,l,u,o]),T=_e.useCallback((c,d,p)=>{c=c??e.columns,d!==void 0&&(c=c.add(d));let R;if(s==="exclusive"&&c.length>0)R={current:void 0,rows:ze.empty(),columns:c};else{const $=p&&l==="mixed"||l==="additive",D=p&&u==="mixed"||u==="additive";R={current:$?e.current:void 0,rows:D?e.rows:ze.empty(),columns:c}}o(R,!1)},[s,e,l,u,o]);return[f,y,T]}function Ds(e,o,l,s,u){const m=n.useCallback(T=>{if(e===!0){const c=[];for(let d=T.y;d<T.y+T.height;d++){const p=[];for(let R=T.x;R<T.x+T.width;R++)R<0||d>=u?p.push({kind:ee.Loading,allowOverlay:!1}):p.push(o([R,d]));c.push(p)}return c}return(e==null?void 0:e(T,s.signal))??[]},[s.signal,o,e,u]),E=e!==void 0?m:void 0,f=n.useCallback(T=>{if(E===void 0)return[];const c={...T,x:T.x-l};if(c.x<0){c.x=0,c.width--;const d=E(c,s.signal);return typeof d=="function"?async()=>(await d()).map(p=>[{kind:ee.Loading,allowOverlay:!1},...p]):d.map(p=>[{kind:ee.Loading,allowOverlay:!1},...p])}return E(c,s.signal)},[s.signal,E,l]);return[e!==void 0?f:void 0,E]}function yr(e){return typeof e=="string"?e:`${e}px`}const Hs=()=>e=>e.innerWidth,Fs=()=>e=>e.innerHeight,$s=Jo("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[Hs()],"w2q57ts-1":[Fs()]}}),Gs=e=>{const{inWidth:o,inHeight:l,children:s,...u}=e;return n.createElement($s,{innerHeight:yr(l),innerWidth:yr(o),...u},s)},Ks=2,Ps=1300;function Ns(e,o,l){const s=_e.useRef(0),[u,m]=e??[0,0];_e.useEffect(()=>{if(u===0&&m===0){s.current=0;return}let E=!1,f=0;const y=T=>{var c;if(!E){if(f===0)f=T;else{const d=T-f;s.current=Math.min(1,s.current+d/Ps);const p=s.current**1.618*d*Ks;(c=o.current)==null||c.scrollBy(u*p,m*p),f=T,l==null||l()}window.requestAnimationFrame(y)}};return window.requestAnimationFrame(y),()=>{E=!0}},[o,u,m,l])}function Ws(e){const{state:o,keybindings:l,getCellsForSelection:s,coercePasteValue:u,onPaste:m,copyHeaders:E,columnsIn:f,onDelete:y,deleteRange:T,safeWindow:c}=e,{gridSelection:d,gridRef:p,scrollRef:R,canvasRef:$,abortControllerRef:D,rowMarkerOffset:te,mangledCols:ye,mangledRows:H,rows:S,getMangledCellContent:Y,mangledOnCellsEdited:be,getCellRenderer:C}=o,P=n.useCallback(async F=>{var fe,Ce,ue;if(!l.paste)return;function re(N,le,k,_){var Ee,Ke;const xe=typeof k=="object"?(k==null?void 0:k.join(`
`))??"":(k==null?void 0:k.toString())??"";if(!qo(N)&&At(N)&&N.readonly!==!0){const we=u==null?void 0:u(xe,N);if(we!==void 0&&mo(we))return{location:le,value:we};const v=C(N);if(v===void 0)return;if(v.kind===ee.Custom){Yo(N.kind===ee.Custom);const de=(Ee=v.onPaste)==null?void 0:Ee.call(v,xe,N.data);return de===void 0?void 0:{location:le,value:{...N,data:de}}}else{const de=(Ke=v.onPaste)==null?void 0:Ke.call(v,xe,N,{formatted:_,formattedString:typeof _=="string"?_:_==null?void 0:_.join(`
`),rawValue:k});return de===void 0?void 0:(Yo(de.kind===N.kind),{location:le,value:de})}}}const se=d.columns,A=d.rows,U=((fe=R.current)==null?void 0:fe.contains(document.activeElement))===!0||((Ce=$.current)==null?void 0:Ce.contains(document.activeElement))===!0;let z;if(d.current!==void 0?z=[d.current.range.x,d.current.range.y]:se.length===1?z=[se.first()??0,0]:A.length===1&&(z=[te,A.first()??0]),U&&z!==void 0){let N,le;const k="text/plain",_="text/html";if(navigator.clipboard.read!==void 0){const we=await navigator.clipboard.read();for(const v of we){if(v.types.includes(_)){const I=await(await v.getType(_)).text(),he=gr(I);if(he!==void 0){N=he;break}}v.types.includes(k)&&(le=await(await v.getType(k)).text())}}else if(navigator.clipboard.readText!==void 0)le=await navigator.clipboard.readText();else if(F!==void 0&&(F==null?void 0:F.clipboardData)!==null){if(F.clipboardData.types.includes(_)){const we=F.clipboardData.getData(_);N=gr(we)}N===void 0&&F.clipboardData.types.includes(k)&&(le=F.clipboardData.getData(k))}else return;const[xe,Ee]=z,Ke=[];do{if(m===void 0){const we=Y(z),v=le??(N==null?void 0:N.map(I=>I.map(he=>he.rawValue).join("	")).join("	"))??"",de=re(we,z,v,void 0);de!==void 0&&Ke.push(de);break}if(N===void 0){if(le===void 0)return;N=vi(le)}if(m===!1||typeof m=="function"&&(m==null?void 0:m([z[0]-te,z[1]],N.map(we=>we.map(v=>{var de;return((de=v.rawValue)==null?void 0:de.toString())??""}))))!==!0)return;for(const[we,v]of N.entries()){if(we+Ee>=S)break;for(const[de,I]of v.entries()){const he=[de+xe,we+Ee],[Fe,qe]=he;if(Fe>=ye.length||qe>=H)continue;const V=Y(he),ie=re(V,he,I.rawValue,I.formatted);ie!==void 0&&Ke.push(ie)}}}while(!1);be(Ke),(ue=p.current)==null||ue.damage(Ke.map(we=>({cell:we.location})))}},[u,C,Y,d,l.paste,R,$,ye.length,be,H,m,te,S,p]);kn("paste",P,c,!1,!0);const W=n.useCallback(async(F,re)=>{var fe,Ce;if(!l.copy)return;const se=re===!0||((fe=R.current)==null?void 0:fe.contains(document.activeElement))===!0||((Ce=$.current)==null?void 0:Ce.contains(document.activeElement))===!0,A=d.columns,U=d.rows,z=(ue,N)=>{if(!E)mr(ue,N,F);else{const le=N.map(k=>({kind:ee.Text,data:f[k].title,displayData:f[k].title,allowOverlay:!1}));mr([le,...ue],N,F)}};if(se&&s!==void 0){if(d.current!==void 0){let ue=s(d.current.range,D.current.signal);typeof ue!="object"&&(ue=await ue()),z(ue,to(d.current.range.x-te,d.current.range.x+d.current.range.width-te))}else if(U!==void 0&&U.length>0){const N=[...U].map(le=>{const k=s({x:te,y:le,width:f.length,height:1},D.current.signal);return typeof k=="object"?k[0]:k().then(_=>_[0])});if(N.some(le=>le instanceof Promise)){const le=await Promise.all(N);z(le,to(f.length))}else z(N,to(f.length))}else if(A.length>0){const ue=[],N=[];for(const le of A){let k=s({x:le,y:0,width:1,height:S},D.current.signal);typeof k!="object"&&(k=await k()),ue.push(k),N.push(le-te)}if(ue.length===1)z(ue[0],N);else{const le=ue.reduce((k,_)=>k.map((xe,Ee)=>[...xe,..._[Ee]]));z(le,N)}}}},[f,s,d,l.copy,te,R,$,D,S,E]);kn("copy",W,c,!1,!1);const Q=n.useCallback(async F=>{var se,A;if(!(!l.cut||!(((se=R.current)==null?void 0:se.contains(document.activeElement))===!0||((A=$.current)==null?void 0:A.contains(document.activeElement))===!0))&&(await W(F),d.current!==void 0)){let U={current:{cell:d.current.cell,range:d.current.range,rangeStack:[]},rows:ze.empty(),columns:ze.empty()};const z=y==null?void 0:y(U);if(z===!1||(U=z===void 0||z===!0?U:z,U.current===void 0))return;T(U.current.range)}},[T,d,l.cut,W,R,$,y]);return kn("cut",Q,c,!1,!1),{onCopy:W,onCut:Q,onPasteInternal:P}}function Vs({rowHeight:e,headerHeight:o,groupHeaderHeight:l,theme:s,overscrollX:u,overscrollY:m,scaleToRem:E,remSize:f}){const[y,T,c,d,p,R]=_e.useMemo(()=>{if(!E||f===16)return[e,o,l,s,u,m];const $=f/16,D=e,te=kr();return[typeof D=="number"?D*$:ye=>Math.ceil(D(ye)*$),Math.ceil(o*$),Math.ceil(l*$),{...s,headerIconSize:((s==null?void 0:s.headerIconSize)??te.headerIconSize)*$,cellHorizontalPadding:((s==null?void 0:s.cellHorizontalPadding)??te.cellHorizontalPadding)*$,cellVerticalPadding:((s==null?void 0:s.cellVerticalPadding)??te.cellVerticalPadding)*$},Math.ceil((u??0)*$),Math.ceil((m??0)*$)]},[l,o,u,m,f,e,E,s]);return{rowHeight:y,headerHeight:T,groupHeaderHeight:c,theme:d,overscrollX:p,overscrollY:R}}const zt={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function ne(e,o){return e===!0?o:e===!1?"":e}function br(e){const o=Zo.value;return{activateCell:ne(e.activateCell," |Enter|shift+Enter"),clear:ne(e.clear,"any+Escape"),closeOverlay:ne(e.closeOverlay,"any+Escape"),acceptOverlayDown:ne(e.acceptOverlayDown,"Enter"),acceptOverlayUp:ne(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:ne(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:ne(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:ne(e.delete,o?"Backspace|Delete":"Delete"),downFill:ne(e.downFill,"primary+_68"),scrollToSelectedCell:ne(e.scrollToSelectedCell,"primary+Enter"),goDownCell:ne(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:ne(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:ne(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:ne(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:ne(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:ne(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:ne(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:ne(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:ne(e.goToFirstCell,"primary+Home"),goToFirstColumn:ne(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:ne(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:ne(e.goToLastCell,"primary+End"),goToLastColumn:ne(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:ne(e.goToLastRow,"primary+ArrowDown"),goToNextPage:ne(e.goToNextPage,"PageDown"),goToPreviousPage:ne(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:ne(e.rightFill,"primary+_82"),search:ne(e.search,"primary+f"),selectAll:ne(e.selectAll,"primary+a"),selectColumn:ne(e.selectColumn,"ctrl+ "),selectGrowDown:ne(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:ne(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:ne(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:ne(e.selectGrowUp,"shift+ArrowUp"),selectRow:ne(e.selectRow,"shift+ "),selectToFirstCell:ne(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:ne(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:ne(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:ne(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:ne(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:ne(e.selectToLastRow,"primary+shift+ArrowDown")}}function Bs(e){const o=pi(e);return _e.useMemo(()=>{if(o===void 0)return br(zt);const l={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??zt.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??zt.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??zt.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??zt.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??zt.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??zt.selectToLastCell};return br({...zt,...l})},[o])}function As(e){function o(s,u,m){if(typeof s=="number")return{headerIndex:s,isCollapsed:!1,depth:u,path:m};const E={headerIndex:s.headerIndex,isCollapsed:s.isCollapsed,depth:u,path:m};return s.subGroups!==void 0&&(E.subGroups=s.subGroups.map((f,y)=>o(f,u+1,[...m,y])).sort((f,y)=>f.headerIndex-y.headerIndex)),E}return e.map((s,u)=>o(s,0,[u])).sort((s,u)=>s.headerIndex-u.headerIndex)}function En(e,o){const l=[];function s(f,y,T=!1){let c=y!==null?y-f.headerIndex:o-f.headerIndex;if(f.subGroups!==void 0&&(c=f.subGroups[0].headerIndex-f.headerIndex),c--,l.push({rowIndex:-1,headerIndex:f.headerIndex,contentIndex:-1,skip:T,isCollapsed:f.isCollapsed,depth:f.depth,path:f.path,rows:c}),f.subGroups)for(let d=0;d<f.subGroups.length;d++){const p=d<f.subGroups.length-1?f.subGroups[d+1].headerIndex:y;s(f.subGroups[d],p,T||f.isCollapsed)}}const u=As(e.groups);for(let f=0;f<u.length;f++){const y=f<u.length-1?u[f+1].headerIndex:null;s(u[f],y)}let m=0,E=0;for(const f of l)f.contentIndex=E,E+=f.rows,f.rowIndex=m,m+=f.isCollapsed?1:f.rows+1;return l.filter(f=>f.skip===!1).map(f=>{const{skip:y,...T}=f;return T})}function Tn(e,o){if(o===void 0||En.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let l=e;for(const s of o){if(l===0)return{path:[...s.path,-1],originalIndex:s.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:s.rows};if(s.isCollapsed)l--;else{if(l<=s.rows)return{path:[...s.path,l-1],originalIndex:s.headerIndex+l,isGroupHeader:!1,groupIndex:l-1,contentIndex:s.contentIndex+l-1,groupRows:s.rows};l=l-s.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Us(e,o,l,s){const u=_e.useMemo(()=>e===void 0?void 0:En(e,o),[e,o]),m=_e.useMemo(()=>u==null?void 0:u.reduce((c,d)=>(c[d.rowIndex]=d,c),{}),[u]),E=_e.useMemo(()=>u===void 0?o:u.reduce((c,d)=>c+(d.isCollapsed?1:d.rows+1),0),[u,o]),f=_e.useMemo(()=>e===void 0||typeof l=="number"&&e.height===l?l:c=>m!=null&&m[c]?e.height:typeof l=="number"?l:l(c),[m,e,l]),y=_e.useCallback(c=>{if(u===void 0)return c;let d=c;for(const p of u){if(d===0)return;if(d--,!p.isCollapsed){if(d<p.rows)return p.contentIndex+d;d-=p.rows}}return c},[u]),T=Dt(s??(e==null?void 0:e.themeOverride),_e.useCallback(c=>{if(e===void 0)return s==null?void 0:s(c,c,c);if(s===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:d,contentIndex:p,groupIndex:R}=Tn(c,u);return d?e.themeOverride:s==null?void 0:s(c,R,p)},[u,s,e]));return e===void 0?{rowHeight:f,rows:o,rowNumberMapper:y,getRowThemeOverride:T}:{rowHeight:f,rows:E,rowNumberMapper:y,getRowThemeOverride:T}}function Os(e,o){const l=_e.useMemo(()=>e===void 0?void 0:En(e,o),[e,o]);return{getRowGroupingForPath:Er,updateRowGroupingByPath:Tr,mapper:_e.useCallback(s=>{if(typeof s=="number")return Tn(s,l);const u=Tn(s[1],l);return{...u,originalIndex:[s[0],u.originalIndex]}},[l])}}function Tr(e,o,l){const[s,...u]=o;return u[0]===-1?e.map((m,E)=>E===s?{...m,...l}:m):e.map((m,E)=>E===s?{...m,subGroups:Tr(m.subGroups??[],u,l)}:m)}function Er(e,o){const[l,...s]=o;return s[0]===-1?e[l]:Er(e[l].subGroups??[],s)}function _s(e,o){const[l]=n.useState(()=>({value:e,callback:o,facade:{get current(){return l.value},set current(s){const u=l.value;u!==s&&(l.value=s,l.callback(s,u))}}}));return l.callback=o,l.facade}function Xs(e,o,l,s,u){const[m,E]=n.useMemo(()=>[o!==void 0&&typeof l=="number"?Math.floor(o/l):0,o!==void 0&&typeof l=="number"?-(o%l):0],[o,l]),f=n.useMemo(()=>({x:s.current.x,y:m,width:s.current.width??1,height:s.current.height??1,ty:E}),[s,E,m]),[y,T,c]=Ci(f),d=n.useRef(u);d.current=u;const p=_s(null,D=>{D!==null&&o!==void 0?D.scrollTop=o:D!==null&&e!==void 0&&(D.scrollLeft=e)}),R=(y.height??1)>1;n.useLayoutEffect(()=>{if(o!==void 0&&p.current!==null&&R){if(p.current.scrollTop===o)return;p.current.scrollTop=o,p.current.scrollTop!==o&&c(),d.current()}},[o,R,c,p]);const $=(y.width??1)>1;return n.useLayoutEffect(()=>{if(e!==void 0&&p.current!==null&&$){if(p.current.scrollLeft===e)return;p.current.scrollLeft=e,p.current.scrollLeft!==e&&c(),d.current()}},[e,$,c,p]),{visibleRegion:y,setVisibleRegion:T,scrollRef:p}}const Ys=Jo("textarea")({name:"GhostInputBox",class:"gxeqqyx",propsAsIs:!1}),qs=(e,o)=>{const{onInput:l,onCompositionStart:s,onCompositionEnd:u,onKeyDown:m,onKeyUp:E,onFocus:f,onBlur:y,disabled:T=!1}=e,c=n.useRef(null),d=n.useRef(!1),p=n.useRef({width:0,height:0}),R=n.useCallback(()=>{const S=c.current;if(!S||S.style.opacity==="0")return;const Y=p.current.width,be=p.current.height;S.style.width=`${Y}px`,S.style.height=`${be}px`;const C=Math.max(Y,S.scrollWidth+2),P=Math.max(be,S.scrollHeight+2);S.style.width=`${C}px`,S.style.height=`${P}px`},[]);n.useImperativeHandle(o,()=>({focus:()=>{var S;(S=c.current)==null||S.focus({preventScroll:!0})},blur:()=>{var S;(S=c.current)==null||S.blur()},clear:()=>{c.current&&(c.current.value="",c.current.setSelectionRange(0,0))},getValue:()=>{var S;return((S=c.current)==null?void 0:S.value)??""},setValue:S=>{if(c.current){c.current.value=S;const Y=S.length;c.current.setSelectionRange(Y,Y)}},setPosition:(S,Y,be,C)=>{const P=c.current;P&&(p.current={width:be,height:C},P.style.left=`${S}px`,P.style.top=`${Y}px`,P.style.width=`${be}px`,P.style.height=`${C}px`)},setVisible:S=>{const Y=c.current;Y&&(S?(Y.style.opacity="1",Y.style.pointerEvents="auto",Y.style.zIndex="10000"):(Y.style.left="-9999px",Y.style.top="0",Y.style.width="1px",Y.style.height="1px",Y.style.opacity="0",Y.style.pointerEvents="none",Y.style.zIndex="0"))}}));const $=n.useCallback(S=>{const Y=S.currentTarget;l(Y.value,d.current),R()},[l,R]),D=n.useCallback(()=>{d.current=!0,s()},[s]),te=n.useCallback(S=>{d.current=!1,u(S.currentTarget.value)},[u]),ye=n.useCallback(S=>{m(S)},[m]),H=n.useCallback(S=>{E==null||E(S)},[E]);return n.createElement(Ys,{ref:c,defaultValue:"",tabIndex:T?-1:0,disabled:T,onInput:$,onCompositionStart:D,onCompositionEnd:te,onKeyDown:ye,onKeyUp:H,onFocus:f,onBlur:y,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},Zs=n.memo(n.forwardRef(qs));function Js(e){const{state:o,onKeyDown:l,onFinishEditing:s,onKeyUpIn:u,onCellActivated:m,setIsFocused:E}=e,{gridSelection:f,overlayRef:y,ghostInputRef:T,ghostInputVisibleRef:c,gridRef:d,rowMarkerOffset:p,getMangledCellContent:R,reselect:$}=o,D=n.useCallback((C,P)=>{var W;if(y.current===void 0&&!P&&C.length>0&&C.trim().length>0&&f.current!==void 0){const[Q,F]=f.current.cell,re=R([Q,F]);if(re.kind===ee.Custom){const se=re.data,A=se==null?void 0:se.kind;if(A!=="number-cell"&&A!=="date-picker-cell")return}if(re.allowOverlay&&At(re)&&re.readonly!==!0){const se=(W=d.current)==null?void 0:W.getBounds(Q,F);if(se!==void 0){const A={inputType:"keyboard",key:C};m==null||m([Q-p,F],A),$(se,A,C)}}}},[f,R,p,m,$,d,y]),te=n.useCallback(()=>{var Q,F,re,se,A;if(f.current===void 0)return;const[C,P]=f.current.cell,W=(Q=y.current)==null?void 0:Q.cell;if(W!==void 0&&(W[0]!==C||W[1]!==P)&&((F=T.current)==null||F.clear(),(re=T.current)==null||re.setVisible(!1),o.setGhostInputVisible(!1),y.current=void 0,o.setOverlay(void 0)),y.current===void 0){const U=R([C,P]);if(U.kind===ee.Custom){const z=U.data,fe=z==null?void 0:z.kind;if(fe!=="number-cell"&&fe!=="date-picker-cell")return}if(U.allowOverlay&&At(U)&&U.readonly!==!0){const z=(se=d.current)==null?void 0:se.getBounds(C,P);if(z!==void 0){(A=T.current)==null||A.clear();const fe={inputType:"keyboard",key:""};m==null||m([C-p,P],fe),$(z,fe,"")}}}},[f,R,p,m,$,T,d,y,o]),ye=n.useCallback(C=>{},[]),H=n.useCallback(C=>{var re,se;if(C.nativeEvent.isComposing)return;if(y.current!==void 0&&c.current){const A=C.key;if(y.current.content.kind===ee.Custom){(A==="Enter"||A==="Tab"||A==="Escape")&&(C.preventDefault(),C.stopPropagation());return}if(A==="Escape"){C.preventDefault(),C.stopPropagation(),s(void 0,[0,0]);return}if(A==="Enter"&&!C.shiftKey){C.preventDefault(),C.stopPropagation(),s(void 0,[0,1]);return}if(A==="Tab"){C.preventDefault(),C.stopPropagation(),s(void 0,C.shiftKey?[-1,0]:[1,0]);return}}{const A=C.key;if(A.length===1&&!C.ctrlKey&&!C.metaKey&&!C.altKey)if(A===" "&&f.current!==void 0){const z=f.current.cell,fe=R(z);if(!(fe.kind===ee.Boolean&&fe.readonly!==!0))return}else return}if(y.current!==void 0&&c.current){const A=C.key;if(A==="Backspace"||A==="Delete"||(A==="ArrowLeft"||A==="ArrowRight"||A==="ArrowUp"||A==="ArrowDown"||A==="Home"||A==="End"))return}const P=(re=f.current)==null?void 0:re.cell,W=P!==void 0?(se=d.current)==null?void 0:se.getBounds(P[0],P[1]):void 0;let Q=!1;const F={bounds:W,cancel:()=>{Q=!0},stopPropagation:()=>C.stopPropagation(),preventDefault:()=>C.preventDefault(),ctrlKey:C.ctrlKey,metaKey:C.metaKey,shiftKey:C.shiftKey,altKey:C.altKey,key:C.key,keyCode:C.keyCode,rawEvent:C,location:P};l(F),Q&&(C.preventDefault(),C.stopPropagation())},[f,l,s,R,y,c,d]),S=n.useCallback(C=>{var F,re;const P=(F=f.current)==null?void 0:F.cell,Q={bounds:P!==void 0?(re=d.current)==null?void 0:re.getBounds(P[0],P[1]):void 0,cancel:()=>{},stopPropagation:()=>C.stopPropagation(),preventDefault:()=>C.preventDefault(),ctrlKey:C.ctrlKey,metaKey:C.metaKey,shiftKey:C.shiftKey,altKey:C.altKey,key:C.key,keyCode:C.keyCode,rawEvent:C,location:P};u==null||u(Q)},[f,u,d]),Y=n.useCallback(()=>{E(!0)},[E]),be=n.useCallback(()=>{E(!1)},[E]);return{onGhostInput:D,onGhostCompositionStart:te,onGhostCompositionEnd:ye,onGhostKeyDown:H,onGhostKeyUp:S,onGhostFocus:Y,onGhostBlur:be}}function Qs(e){const{state:o,mouseState:l,setMouseState:s,fillHighlightRegion:u,setFillHighlightRegion:m,setScrollDir:E,handleSelect:f,onMouseMove:y,onCellClicked:T,onCellActivated:c,onCellContextMenu:d,onHeaderContextMenu:p,onGroupHeaderContextMenu:R,onHeaderClicked:$,onGroupHeaderClicked:D,onColumnResize:te,onFillPattern:ye,cellActivationBehavior:H,columnSelect:S,columnSelectionMode:Y,columns:be,groupLevels:C,mergedTheme:P,minColumnWidth:W,maxColumnWidth:Q,themeForCell:F,getCellsForSelection:re,setSelectedColumns:se,visibleRegion:A,lastMouseSelectLocation:U}=e,{gridSelection:z,gridRef:fe,visibleRegionRef:Ce,abortControllerRef:ue,rowMarkerOffset:N,mangledCols:le,rows:k,setGridSelection:_,getMangledCellContent:xe,mangledOnCellsEdited:Ee,reselect:Ke,focus:we,getCellRenderer:v}=o,de=n.useRef(!1),I=n.useRef(A),he=n.useRef(void 0),Fe=n.useRef(!1),qe=n.useCallback(w=>{if(Fe.current=!1,I.current=Ce.current,w.button!==0&&w.button!==1){he.current=void 0;return}const ge=performance.now();he.current={button:w.button,time:ge,location:w.location},(w==null?void 0:w.kind)==="header"&&(de.current=!0);const B=w.kind==="cell"&&w.isFillHandle;!B&&w.kind!=="cell"&&w.isEdge||(s({previousSelection:z,fillHandle:B}),U.current=void 0,!w.isTouch&&w.button===0&&!B?f(w):!w.isTouch&&w.button===1&&(U.current=w.location))},[z,f]),V=n.useCallback(w=>{if(w.kind!==eo||S!=="multi")return;const ge=Zo.value?w.metaKey:w.ctrlKey,[B,ce]=w.location,De=z.columns;if(B<N)return;const Ue=le[B];let j=B,Z=B;const Oe=ce<=-2?-(ce+2):0,Pe=(Ne,Ye)=>C>1?ki(Ne,Ye,Oe,C):Ri(Ne,Ye);for(let Ne=B-1;Ne>=N&&Pe(Ue.group,le[Ne].group);Ne--)j--;for(let Ne=B+1;Ne<le.length&&Pe(Ue.group,le[Ne].group);Ne++)Z++;if(we(),ge||w.isTouch||Y==="multi")if(De.hasAll([j,Z+1])){let Ne=De;for(let Ye=j;Ye<=Z;Ye++)Ne=Ne.remove(Ye);se(Ne,void 0,ge)}else se(void 0,[j,Z+1],ge);else se(ze.fromSingleSelection([j,Z+1]),void 0,ge)},[S,we,z.columns,le,N,se,Y,C]),ie=n.useCallback(async w=>{if(re!==void 0&&te!==void 0){const ge=Ce.current.y,B=Ce.current.height;let ce=re({x:w,y:ge,width:1,height:Math.min(B,k-ge)},ue.current.signal);typeof ce!="object"&&(ce=await ce());const De=be[w-N],j=document.createElement("canvas").getContext("2d",{alpha:!1});if(j!==null){j.font=P.baseFontFull;const Z=Mr(j,P,De,0,ce,W,Q,!1,v);te==null||te(De,Z.width,w,Z.width)}}},[be,re,Q,P,W,te,N,k,v]),X=n.useCallback(async(w,ge)=>{var Z,Oe;const B=(Z=w.current)==null?void 0:Z.range;if(B===void 0||re===void 0||ge.current===void 0)return;const ce=ge.current.range;if(ye!==void 0){let Pe=!1;if(ye({fillDestination:{...ce,x:ce.x-N},patternSource:{...B,x:B.x-N},preventDefault:()=>Pe=!0}),Pe)return}let De=re(B,ue.current.signal);typeof De!="object"&&(De=await De());const Ue=De,j=[];for(let Pe=0;Pe<ce.width;Pe++)for(let Ne=0;Ne<ce.height;Ne++){const Ye=[ce.x+Pe,ce.y+Ne];if(wi(Ye,B))continue;const Le=Ue[Ne%B.height][Pe%B.width];qo(Le)||!At(Le)||j.push({location:Ye,value:{...Le}})}Ee(j),(Oe=fe.current)==null||Oe.damage(j.map(Pe=>({cell:Pe.location})))},[re,Ee,ye,N]),ut=n.useCallback(()=>{if(z.current===void 0||z.current.range.width<=1)return;const w={...z,current:{...z.current,range:{...z.current.range,width:1}}};X(w,z)},[X,z]),et=n.useCallback(()=>{if(z.current===void 0||z.current.range.height<=1)return;const w={...z,current:{...z.current,range:{...z.current.range,height:1}}};X(w,z)},[X,z]),bt=n.useCallback((w,ge)=>{var Ne,Ye;const B=l;if(s(void 0),m(void 0),E(void 0),de.current=!1,ge)return;if((B==null?void 0:B.fillHandle)===!0&&z.current!==void 0&&((Ne=B.previousSelection)==null?void 0:Ne.current)!==void 0){if(u===void 0)return;const Le={...z,current:{...z.current,range:yi(B.previousSelection.current.range,u)}};X(B.previousSelection,Le),_(Le,!0);return}const[ce,De]=w.location,[Ue,j]=U.current??[],Z=()=>{Fe.current=!0},Oe=Le=>{var vo,po,nt;const Ht=Le.isTouch||Ue===ce&&j===De;if(Ht&&(T==null||T([ce-N,De],{...Le,preventDefault:Z})),Le.button===1)return!Fe.current;if(!Fe.current){const Ft=xe(w.location),$t=v(Ft);if($t!==void 0&&$t.onClick!==void 0&&Ht){const rt=$t.onClick({...Le,cell:Ft,posX:Le.localEventX,posY:Le.localEventY,bounds:Le.bounds,theme:F(Ft,w.location),preventDefault:Z});rt!==void 0&&!qo(rt)&&mo(rt)&&(Ee([{location:Le.location,value:rt}]),(vo=fe.current)==null||vo.damage([{cell:Le.location}]))}if(Fe.current||z.current===void 0)return!1;let xt=!1;switch(Ft.activationBehaviorOverride??H){case"double-click":case"second-click":{if(((nt=(po=B==null?void 0:B.previousSelection)==null?void 0:po.current)==null?void 0:nt.cell)===void 0)break;const[rt,vt]=z.current.cell,[Ot,dt]=B.previousSelection.current.cell;xt=ce===rt&&ce===Ot&&De===vt&&De===dt&&(Le.isDoubleClick===!0||H==="second-click");break}case"single-click":{xt=!0;break}}if(xt){const vt={inputType:"pointer",pointerActivation:Le.isDoubleClick===!0?"double-click":Ft.activationBehaviorOverride??H,pointerType:Le.isTouch?"touch":"mouse"};return c==null||c([ce-N,De],vt),Ke(Le.bounds,vt),!0}}return!1},Pe=w.location[0]-N;if(w.isTouch){const Le=Ce.current,Ht=I.current;if(Le.x!==Ht.x||Le.y!==Ht.y)return;if(w.isLongTouch===!0){if(w.kind==="cell"&&bi((Ye=z.current)==null?void 0:Ye.cell,w.location)){d==null||d([Pe,w.location[1]],{...w,preventDefault:Z});return}else if(w.kind==="header"&&z.columns.hasIndex(ce)){p==null||p(Pe,{...w,preventDefault:Z});return}else if(w.kind===eo){if(Pe<0)return;R==null||R(Pe,{...w,preventDefault:Z});return}}w.kind==="cell"?Oe(w)||f(w):w.kind===eo?D==null||D(Pe,{...w,preventDefault:Z}):(w.kind===xi&&($==null||$(Pe,{...w,preventDefault:Z})),f(w));return}if(w.kind==="header"){if(Pe<0)return;w.isEdge?w.isDoubleClick===!0&&ie(ce):w.button===0&&ce===Ue&&De===j&&($==null||$(Pe,{...w,preventDefault:Z}))}if(w.kind===eo){if(Pe<0)return;w.button===0&&ce===Ue&&De===j&&(D==null||D(Pe,{...w,preventDefault:Z}),Fe.current||V(w))}w.kind==="cell"&&(w.button===0||w.button===1)&&Oe(w),U.current=void 0},[l,z,N,u,X,_,T,xe,v,H,F,Ee,c,Ke,d,p,R,f,D,$,ie,V]),Ut=n.useCallback(w=>{const ge={...w,location:[w.location[0]-N,w.location[1]]};y==null||y(ge),l!==void 0&&w.buttons===0&&(s(void 0),m(void 0),E(void 0),de.current=!1),E(B=>{var ce;return de.current?[w.scrollEdge[0],0]:w.scrollEdge[0]===(B==null?void 0:B[0])&&w.scrollEdge[1]===B[1]?B:l===void 0||(((ce=he.current)==null?void 0:ce.location[0])??0)<N?void 0:w.scrollEdge})},[l,y,N]);return{onMouseDown:qe,onMouseUp:bt,onMouseMoveImpl:Ut,handleGroupHeaderSelection:V,normalSizeColumn:ie,fillDown:et,fillRight:ut,mouseDownData:he,isActivelyDraggingHeader:de}}const js=n.lazy(async()=>await hi(()=>import("./image-window-loader-DnW574Gd.js").then(e=>e.$),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let ec=0;function tc(e){return Ni(wr(wr(e).filter(o=>o.span!==void 0).map(o=>{var l,s;return to((((l=o.span)==null?void 0:l[0])??0)+1,(((s=o.span)==null?void 0:s[1])??0)+1)})))}function Xo(e,o){return e===void 0||o===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+o,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+o},rangeStack:e.current.rangeStack.map(l=>({...l,x:l.x+o}))},rows:e.rows,columns:e.columns.offset(o)}}const Lt={kind:ee.Loading,allowOverlay:!1},Mn={columns:ze.empty(),rows:ze.empty(),current:void 0},oc=(e,o)=>{var ur,dr,fr;const[l,s]=n.useState(Mn),[u,m]=n.useState(),E=n.useRef(null),f=n.useRef(null),[y,T]=n.useState(),[c,d]=n.useState(),p=n.useRef(void 0),R=n.useRef(null),[$,D]=n.useState(!1),te=n.useRef($);te.current=$;const ye=n.useRef(u);ye.current=u;const H=typeof window>"u"?null:window,{imageEditorOverride:S,getRowThemeOverride:Y,markdownDivCreateNode:be,width:C,height:P,columns:W,rows:Q,getCellContent:F,onCellClicked:re,onCellActivated:se,onFillPattern:A,onFinishedEditing:U,coercePasteValue:z,drawHeader:fe,drawCell:Ce,editorBloom:ue,onHeaderClicked:N,onColumnProposeMove:le,rangeSelectionColumnSpanning:k=!0,spanRangeBehavior:_="default",onGroupHeaderClicked:xe,onCellContextMenu:Ee,className:Ke,onHeaderContextMenu:we,getCellsForSelection:v,onGroupHeaderContextMenu:de,onGroupHeaderRenamed:I,onCellEdited:he,onCellsEdited:Fe,onSearchResultsChanged:qe,searchResults:V,onSearchValueChange:ie,searchValue:X,onKeyDown:ut,onKeyUp:et,keybindings:bt,editOnType:Ut=!0,onRowAppended:w,onColumnAppended:ge,onColumnMoved:B,validateCell:ce,highlightRegions:De,rangeSelect:Ue="rect",columnSelect:j="multi",rowSelect:Z="multi",rangeSelectionBlending:Oe="exclusive",columnSelectionBlending:Pe="exclusive",rowSelectionBlending:Ne="exclusive",onDelete:Ye,onDragStart:Le,onMouseMove:Ht,onPaste:vo,copyHeaders:po=!1,freezeColumns:nt=0,cellActivationBehavior:Ft="second-click",rowSelectionMode:$t="auto",columnSelectionMode:xt="auto",onHeaderMenuClick:rt,onHeaderIndicatorClick:vt,getGroupDetails:Ot,rowGrouping:dt,onSearchClose:Co,onItemHovered:wo,onSelectionCleared:oo,showSearch:Ir,onVisibleRegionChanged:yo,gridSelection:Gt,onGridSelectionChange:Qo,minColumnWidth:zr=50,maxColumnWidth:Lr=500,maxColumnAutoWidth:Dr,provideEditor:Hr,trailingRowOptions:Re,freezeTrailingRows:pt=0,allowedFillDirections:In="orthogonal",scrollOffsetX:Fr,scrollOffsetY:$r,verticalBorder:_t,onDragOverCell:Gr,onDrop:Kr,onColumnResize:no,onColumnResizeEnd:ro,onColumnResizeStart:lo,customRenderers:bo,fillHandle:Pr,experimental:Be,fixedShadowX:Nr,fixedShadowY:Wr,headerIcons:Vr,imageWindowLoader:Br,initialSize:Ar,isDraggable:Ur,onDragLeave:Or,onRowMoved:io,overscrollX:_r,overscrollY:Xr,preventDiagonalScrolling:Yr,rightElement:qr,rightElementProps:Zr,trapFocus:Jr=!1,smoothScrollX:Qr,smoothScrollY:jr,scaleToRem:el=!1,rowHeight:tl=34,headerHeight:zn=36,groupHeaderHeight:ol=zn,theme:nl,isOutsideClick:rl,renderers:jo,resizeIndicator:ll,scrollToActiveCell:Ln=!0,drawFocusRing:Dn=!0,portalElementRef:xo,onRowStatus:ko,onRowId:Ro}=e,Hn=Dn==="no-editor"?u===void 0:Dn,J=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,il=(J==null?void 0:J.rowNumber)??!1;let Mo=(J==null?void 0:J.kind)??e.rowMarkers??"none",lt=il;(Mo==="both"||Mo==="checkbox-and-number")&&(Mo="checkbox",lt=!0);const st=Mo,sl=(J==null?void 0:J.width)??e.rowMarkerWidth,en=(J==null?void 0:J.startIndex)??e.rowMarkerStartIndex??1,tn=(J==null?void 0:J.theme)??e.rowMarkerTheme,on=J==null?void 0:J.headerTheme,Fn=J==null?void 0:J.headerAlwaysVisible,So=Z!=="multi"||(J==null?void 0:J.headerDisabled)===!0,Xt=(J==null?void 0:J.checkboxStyle)??"square",cl=(J==null?void 0:J.rowStatus)??!1,nn=(J==null?void 0:J.rowStatusWidth)??40,To=J==null?void 0:J.rowStatusTheme,al=(J==null?void 0:J.rowId)??!1,rn=(J==null?void 0:J.rowIdWidth)??80,Eo=J==null?void 0:J.rowIdTheme,so=Math.max(zr,20),ln=Math.max(Lr,so),ul=Math.max(Dr??ln,so),$n=n.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:me,rowNumberMapper:sn,rowHeight:dl,getRowThemeOverride:Ct}=Us(dt,Q,tl,Y),fl=n.useMemo(()=>Number.parseFloat($n.fontSize),[$n]),{rowHeight:kt,headerHeight:Gn,groupHeaderHeight:cn,theme:Kn,overscrollX:hl,overscrollY:gl}=Vs({groupHeaderHeight:ol,headerHeight:zn,overscrollX:_r,overscrollY:Xr,remSize:fl,rowHeight:dl,scaleToRem:el,theme:nl}),Pn=Bs(bt),co=sl??(Q>1e4?48:Q>1e3?44:Q>100?36:32),ct=st!=="none",Yt=cl===!0,qt=al===!0,g=(ct?lt?2:1:0)+(Yt?1:0)+(qt?1:0),an=(ct?(lt?2:1)*co:0)+(Yt?nn:0)+(qt?rn:0),Ae=Re!==void 0,ao=(Re==null?void 0:Re.sticky)===!0,[ml,Nn]=n.useState(!1),vl=Ir??ml,pl=n.useCallback(()=>{Co!==void 0?Co():Nn(!1)},[Co]),L=n.useMemo(()=>Gt===void 0?void 0:Xo(Gt,g),[Gt,g])??l,Rt=n.useRef(new AbortController);n.useEffect(()=>()=>Rt==null?void 0:Rt.current.abort(),[]);const[Mt,Cl]=Ds(v,F,g,Rt.current,me),wl=n.useCallback((t,r,a)=>{if(ce===void 0)return!0;const i=[t[0]-g,t[1]];return ce==null?void 0:ce(i,r,a)},[g,ce]),Io=n.useRef(Gt),St=n.useCallback((t,r)=>{r&&(t=Mi(t,Mt,g,_,Rt.current)),Qo!==void 0?(Io.current=Xo(t,-g),Qo(Io.current)):s(t)},[Qo,Mt,g,_]),Wn=Dt(no,n.useCallback((t,r,a,i)=>{no==null||no(W[a-g],r,a-g,i)},[no,g,W])),yl=Dt(ro,n.useCallback((t,r,a,i)=>{ro==null||ro(W[a-g],r,a-g,i)},[ro,g,W])),bl=Dt(lo,n.useCallback((t,r,a,i)=>{lo==null||lo(W[a-g],r,a-g,i)},[lo,g,W])),xl=Dt(fe,n.useCallback((t,r)=>(fe==null?void 0:fe({...t,columnIndex:t.columnIndex-g},r))??!1,[fe,g])),kl=Dt(Ce,n.useCallback((t,r)=>(Ce==null?void 0:Ce({...t,col:t.col-g},r))??!1,[Ce,g])),Vn=n.useCallback(t=>{if(Ye!==void 0){const r=Ye(Xo(t,-g));return typeof r=="boolean"?r:Xo(r,g)}return!0},[Ye,g]),[Xe,it,tt]=Ls(L,St,Oe,Pe,Ne,Ue,k),Je=n.useMemo(()=>Rn(kr(),Kn),[Kn]),[un,Rl]=n.useState([0,0,0]),Bn=n.useMemo(()=>{if(jo===void 0)return{};const t={};for(const r of jo)t[r.kind]=r;return t},[jo]),ft=n.useCallback(t=>t.kind!==ee.Custom?Bn[t.kind]:bo==null?void 0:bo.find(r=>r.isMatch(t)),[bo,Bn]);let{sizedColumns:at,nonGrowWidth:An}=Es(W,me,Cl,un[0]-an-un[2],so,ul,Je,ft,Rt.current);An+=an;const Zt=n.useMemo(()=>{let t=0;for(const r of at)r.group!==void 0&&(typeof r.group=="string"?t=Math.max(t,1):t=Math.max(t,r.group.length));return t},[at]),Un=Zt>0,On=n.useMemo(()=>Zt===0?[]:Array(Zt).fill(cn),[Zt,cn]),Ml=On.reduce((t,r)=>t+r,0),uo=Gn+Ml,_n=L.rows.length,Xn=st==="none"?void 0:_n===0?!1:_n===me?!0:void 0,Ie=n.useMemo(()=>{const t=[];return st!=="none"&&(lt&&t.push({title:"",width:co,icon:void 0,hasMenu:!1,style:"normal",themeOverride:tn,rowMarker:Xt,rowMarkerChecked:!1,headerRowMarkerTheme:on,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),t.push({title:"",width:co,icon:void 0,hasMenu:!1,style:"normal",themeOverride:tn,rowMarker:Xt,rowMarkerChecked:Xn,headerRowMarkerTheme:on,headerRowMarkerAlwaysVisible:Fn,headerRowMarkerDisabled:So})),Yt&&t.push({title:"",width:nn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:To}),qt&&t.push({title:"ID",width:rn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Eo}),[...t,...at]},[Yt,nn,To,qt,rn,Eo,st,at,co,tn,Xt,Xn,on,Fn,So,lt]),Tt=n.useRef({height:1,width:1,x:0,y:0}),zo=n.useRef(!1),{setVisibleRegion:Yn,visibleRegion:Kt,scrollRef:$e}=Xs(Fr,$r,kt,Tt,()=>zo.current=!0);Tt.current=Kt;const Sl=Kt.x+g,Lo=Kt.y,Qe=n.useRef(null),je=n.useCallback(t=>{var r;t===!0?(r=R.current)==null||r.focus():window.requestAnimationFrame(()=>{var a;(a=R.current)==null||a.focus()})},[]),Ze=Ae?me+1:me,Pt=n.useCallback(t=>{const r=g===0?t:t.map(i=>({...i,location:[i.location[0]-g,i.location[1]]})),a=Fe==null?void 0:Fe(r);if(a!==!0)for(const i of r)he==null||he(i.location,i.value);return a},[he,Fe,g]),[fo,qn]=n.useState(),Do=L.current!==void 0&&L.current.range.width*L.current.range.height>1?L.current.range:void 0,Jt=Hn?(ur=L.current)==null?void 0:ur.cell:void 0,Ho=Jt==null?void 0:Jt[0],Fo=Jt==null?void 0:Jt[1],Tl=n.useMemo(()=>{if((De===void 0||De.length===0)&&(Do??Ho??Fo??fo)===void 0)return;const t=[];if(De!==void 0)for(const r of De){const a=Ie.length-r.range.x-g;a>0&&t.push({color:r.color,range:{...r.range,x:r.range.x+g,width:Math.min(a,r.range.width)},style:r.style})}return fo!==void 0&&t.push({color:vr(Je.accentColor,0),range:fo,style:"dashed"}),Do!==void 0&&t.push({color:vr(Je.accentColor,.5),range:Do,style:"solid-outline"}),Ho!==void 0&&Fo!==void 0&&t.push({color:Je.accentColor,range:{x:Ho,y:Fo,width:1,height:1},style:"solid-outline"}),t.length>0?t:void 0},[fo,Do,Ho,Fo,De,Ie.length,Je.accentColor,g]),Zn=n.useRef(Ie);Zn.current=Ie;const wt=n.useCallback(([t,r],a=!1)=>{var O,q,Me,ke,ve,K,Te,Se,ae;const i=Ae&&r===Ze-1;let h=0,b=-1,x=-1,M=-1,G=-1;if(ct&&lt&&(b=h++),ct&&(x=h++),Yt&&(M=h++),qt&&(G=h++),t===b){if(i)return Lt;const pe=sn(r);return pe===void 0?Lt:{kind:Vt.Marker,allowOverlay:!1,checkboxStyle:Xt,checked:!1,markerKind:"number",row:en+pe,drawHandle:!1,cursor:void 0,disabled:((O=e.disabledRows)==null?void 0:O.call(e,r))===!0}}if(t===x){if(i)return Lt;const pe=sn(r);if(pe===void 0)return Lt;let Ve;return lt?Ve=st==="checkbox-visible"?"checkbox-visible":"checkbox":st==="clickable-number"?Ve="number":Ve=st,{kind:Vt.Marker,allowOverlay:!1,checkboxStyle:Xt,checked:(L==null?void 0:L.rows.hasIndex(r))===!0,markerKind:Ve,row:en+pe,drawHandle:io!==void 0,cursor:lt?void 0:st==="clickable-number"?"pointer":void 0,disabled:((q=e.disabledRows)==null?void 0:q.call(e,r))===!0}}if(t===M){if(i)return Lt;const pe=ko==null?void 0:ko(r);return{kind:Vt.RowStatus,allowOverlay:!1,status:pe,themeOverride:To}}if(t===G){if(i)return Lt;const pe=Ro==null?void 0:Ro(r);return{kind:Vt.RowId,allowOverlay:!1,rowId:pe,themeOverride:Eo}}if(i){const Ve=t===g?(Re==null?void 0:Re.hint)??"":"",He=Zn.current[t];if(((Me=He==null?void 0:He.trailingRowOptions)==null?void 0:Me.disabled)===!0)return Lt;{const ot=((ke=He==null?void 0:He.trailingRowOptions)==null?void 0:ke.hint)??Ve,gt=((ve=He==null?void 0:He.trailingRowOptions)==null?void 0:ve.addIcon)??(Re==null?void 0:Re.addIcon);return{kind:Vt.NewRow,hint:ot,allowOverlay:!1,icon:gt}}}else{const pe=t-g;if(a||(Be==null?void 0:Be.strict)===!0){const He=Tt.current,ot=He.x>pe||pe>He.x+He.width||He.y>r||r>He.y+He.height||r>=gn.current,gt=pe===((Te=(K=He.extras)==null?void 0:K.selected)==null?void 0:Te[0])&&r===((Se=He.extras)==null?void 0:Se.selected[1]);let mt=!1;if(((ae=He.extras)==null?void 0:ae.freezeRegions)!==void 0){for(const It of He.extras.freezeRegions)if(Si(It,pe,r)){mt=!0;break}}if(ot&&!gt&&!mt)return Lt}let Ve=F([pe,r]);return g!==0&&Ve.span!==void 0&&(Ve={...Ve,span:[Ve.span[0]+g,Ve.span[1]+g]}),Ve}},[Ae,Ze,Yt,ko,To,qt,Ro,Eo,ct,sn,Xt,L==null?void 0:L.rows,st,en,io,g,Re==null?void 0:Re.hint,Re==null?void 0:Re.addIcon,Be==null?void 0:Be.strict,F,lt]),dn=n.useCallback(t=>{let r=(Ot==null?void 0:Ot(t))??{name:t};return I!==void 0&&t!==""&&(r={icon:r.icon,name:r.name,overrideTheme:r.overrideTheme,actions:[...r.actions??[],{title:"Rename",icon:"renameIcon",onClick:a=>pn({group:r.name,bounds:a.bounds})}]}),r},[Ot,I]),$o=n.useCallback(t=>{var M;const[r,a]=t.cell,i=Ie[r],h=(i==null?void 0:i.group)!==void 0?(M=dn(i.group))==null?void 0:M.overrideTheme:void 0,b=i==null?void 0:i.themeOverride,x=Ct==null?void 0:Ct(a);m({...t,theme:Rn(Je,h,b,x,t.content.themeOverride)})},[Ct,Ie,dn,Je]),El=n.useCallback((t,r,a)=>{var x,M,G,O,q,Me,ke;if(L.current===void 0)return;const[i,h]=L.current.cell,b=wt([i,h]);if(b.kind!==ee.Boolean&&b.allowOverlay){let ve=b;if(a!==void 0)switch(ve.kind){case ee.Number:{const Se=Ti(()=>a==="-"?-0:Number.parseFloat(a),0);ve={...ve,data:Number.isNaN(Se)?0:Se};break}case ee.Text:case ee.Markdown:case ee.Uri:ve={...ve,data:a};break}$o({target:t,content:ve,initialValue:a,cell:[i,h],highlight:a===void 0,forceEditMode:a!==void 0,activation:r});const K=ve.kind===ee.Custom;a!==void 0&&!K?((x=R.current)==null||x.setPosition(t.x,t.y,t.width,t.height),a.length>0&&((M=R.current)==null||M.setValue(a)),(G=R.current)==null||G.setVisible(!0),D(!0)):K&&a!==void 0&&((O=R.current)==null||O.clear(),(q=R.current)==null||q.setVisible(!1),(Me=R.current)==null||Me.blur(),D(!1))}else b.kind===ee.Boolean&&r.inputType==="keyboard"&&b.readonly!==!0&&(Pt([{location:L.current.cell,value:{...b,data:xr(b.data)}}]),(ke=Qe.current)==null||ke.damage([{cell:L.current.cell}]))},[wt,L,Pt,$o]),Jn=n.useCallback((t,r)=>{var h;const a=(h=Qe.current)==null?void 0:h.getBounds(t,r);if(a===void 0||$e.current===null)return;const i=wt([t,r]);i.allowOverlay&&$o({target:a,content:i,initialValue:void 0,highlight:!0,cell:[t,r],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[wt,$e,$o]),We=n.useCallback((t,r,a="both",i=0,h=0,b=void 0)=>{if($e.current!==null){const x=Qe.current,M=f.current,G=typeof t!="number"?t.unit==="cell"?t.amount:void 0:t,O=typeof r!="number"?r.unit==="cell"?r.amount:void 0:r,q=typeof t!="number"&&t.unit==="px"?t.amount:void 0,Me=typeof r!="number"&&r.unit==="px"?r.amount:void 0;if(x!==null&&M!==null){let ke={x:0,y:0,width:0,height:0},ve=0,K=0;if((G!==void 0||O!==void 0)&&(ke=x.getBounds((G??0)+g,O??0)??ke,ke.width===0||ke.height===0))return;const Te=M.getBoundingClientRect(),Se=Te.width/M.offsetWidth;if(q!==void 0&&(ke={...ke,x:q-Te.left-$e.current.scrollLeft,width:1}),Me!==void 0&&(ke={...ke,y:Me+Te.top-$e.current.scrollTop,height:1}),ke!==void 0){const ae={x:ke.x-i,y:ke.y-h,width:ke.width+2*i,height:ke.height+2*h};let pe=0;for(let xn=0;xn<nt;xn++)pe+=at[xn].width;let Ve=0;const He=pt+(ao?1:0);He>0&&(Ve=Ei(Ze,He,kt));let ot=pe*Se+Te.left+an*Se,gt=Te.right,mt=Te.top+uo*Se,It=Te.bottom-Ve*Se;const Uo=ke.width+i*2;switch(b==null?void 0:b.hAlign){case"start":gt=ot+Uo;break;case"end":ot=gt-Uo;break;case"center":ot=Math.floor((ot+gt)/2)-Uo/2,gt=ot+Uo;break}const Oo=ke.height+h*2;switch(b==null?void 0:b.vAlign){case"start":It=mt+Oo;break;case"end":mt=It-Oo;break;case"center":mt=Math.floor((mt+It)/2)-Oo/2,It=mt+Oo;break}ot>ae.x?ve=ae.x-ot:gt<ae.x+ae.width&&(ve=ae.x+ae.width-gt),mt>ae.y?K=ae.y-mt:It<ae.y+ae.height&&(K=ae.y+ae.height-It),a==="vertical"||typeof t=="number"&&t<nt?ve=0:(a==="horizontal"||typeof r=="number"&&r>=Ze-He)&&(K=0),(ve!==0||K!==0)&&(Se!==1&&(ve/=Se,K/=Se),$e.current.scrollTo({left:ve+$e.current.scrollLeft,top:K+$e.current.scrollTop,behavior:(b==null?void 0:b.behavior)??"auto"}))}}}},[g,pt,co,$e,uo,nt,at,Ze,ao,kt]),Go=n.useRef(We);Go.current=We;const fn=n.useRef(Jn),hn=n.useRef(F);fn.current=Jn,hn.current=F;const gn=n.useRef(me);gn.current=me;const Qn=n.useRef(Ie.length);Qn.current=Ie.length;const Nt=n.useCallback(async(t,r=!0,a)=>{var O;const i=Ie[t];if(((O=i==null?void 0:i.trailingRowOptions)==null?void 0:O.disabled)===!0)return;const h=w==null?void 0:w();let b,x=!0;h!==void 0&&(b=await h,b==="top"&&(x=!1),typeof b=="number"&&(x=!1));let M=0;const G=()=>{if(gn.current<=me){M<500&&window.setTimeout(G,M),M=50+M*2;return}const q=typeof b=="number"?b:x?me:0;Go.current(t-g,q,"both",0,20,a?{behavior:a}:void 0),Xe({cell:[t,q],range:{x:t,y:q,width:1,height:1}},!1,!1,"edit");const Me=hn.current([t-g,q]);Me.allowOverlay&&At(Me)&&Me.readonly!==!0&&r&&window.setTimeout(()=>{fn.current(t,q)},0)};G()},[Ie,w,g,me,Xe]),Ko=n.useCallback(async(t,r=!0)=>{const a=ge==null?void 0:ge();let i,h=!0;a!==void 0&&(i=await a,i==="left"&&(h=!1),typeof i=="number"&&(h=!1));let b=0;const x=()=>{if(Qn.current<=Ie.length){b<500&&window.setTimeout(x,b),b=50+b*2;return}const M=typeof i=="number"?i:h?Ie.length:0;We(M-g,t),Xe({cell:[M,t],range:{x:M,y:t,width:1,height:1}},!1,!1,"edit");const G=hn.current([M-g,t]);G.allowOverlay&&At(G)&&G.readonly!==!0&&r&&window.setTimeout(()=>{fn.current(M,t)},0)};x()},[Ie,ge,g,We,Xe]),ho=n.useCallback(t=>{var a,i;const r=((i=(a=at[t])==null?void 0:a.trailingRowOptions)==null?void 0:i.targetColumn)??(Re==null?void 0:Re.targetColumn);if(typeof r=="number")return r+(ct?1:0);if(typeof r=="object"){const h=W.indexOf(r);if(h>=0)return h+(ct?1:0)}},[at,W,ct,Re==null?void 0:Re.targetColumn]),Et=n.useRef(void 0),Qt=n.useRef(void 0),Po=n.useCallback((t,r)=>{var h;const[a,i]=r;return Rn(Je,(h=Ie[a])==null?void 0:h.themeOverride,Ct==null?void 0:Ct(i),t.themeOverride)},[Ct,Ie,Je]),{mapper:go}=Os(dt,Q),mn=dt==null?void 0:dt.navigationBehavior,No=n.useRef(void 0),Il=n.useCallback(t=>{var O,q,Me;const r=Zo.value?t.metaKey:t.ctrlKey,a=r&&Z==="multi",[i,h]=t.location,b=L.columns,x=L.rows,[M,G]=((O=L.current)==null?void 0:O.cell)??[];if(t.kind==="cell"){if(Qt.current=void 0,No.current=[i,h],i===(lt?1:0)&&ct){if(Ae===!0&&h===me||st==="number"||Z==="none")return;const K=wt(t.location);if(K.kind!==Vt.Marker||K.disabled===!0)return;if(io!==void 0){const ae=ft(K);Yo((ae==null?void 0:ae.kind)===Vt.Marker);const pe=(q=ae==null?void 0:ae.onClick)==null?void 0:q.call(ae,{...t,cell:K,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,theme:Po(K,t.location),preventDefault:()=>{}});if(pe===void 0||pe.checked===K.checked)return}m(void 0),je();const Te=x.hasIndex(h),Se=Et.current;if(Z==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&Se!==void 0&&x.hasIndex(Se)){const ae=[Math.min(Se,h),Math.max(Se,h)+1];a||$t==="multi"?it(void 0,ae,!0):it(ze.fromSingleSelection(ae),void 0,a)}else Z==="multi"&&(a||t.isTouch||$t==="multi")?Te?it(x.remove(h),void 0,!0):(it(void 0,h,!0),Et.current=h):Te&&x.length===1?it(ze.empty(),void 0,r):(it(ze.fromSingleSelection(h),void 0,r),Et.current=h)}else if(i>=g&&Ae&&h===me){const K=ho(i);Nt(K??i)}else if(M!==i||G!==h){const K=wt(t.location),Te=ft(K);if((Te==null?void 0:Te.onSelect)!==void 0){let pe=!1;if(Te.onSelect({...t,cell:K,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,preventDefault:()=>pe=!0,theme:Po(K,t.location)}),pe)return}if(mn==="block"&&go(h).isGroupHeader)return;const Se=ao&&h===me,ae=ao&&L!==void 0&&((Me=L.current)==null?void 0:Me.cell[1])===me;if((t.shiftKey||t.isLongTouch===!0)&&M!==void 0&&G!==void 0&&L.current!==void 0&&!ae){if(Se)return;const pe=Math.min(i,M),Ve=Math.max(i,M),He=Math.min(h,G),ot=Math.max(h,G);Xe({...L.current,range:{x:pe,y:He,width:Ve-pe+1,height:ot-He+1}},!0,r,"click"),Et.current=void 0,je()}else{const pe=L.rows.length>0;Xe({cell:[i,h],range:{x:i,y:h,width:1,height:1}},!0,r||pe,"click"),Et.current=void 0,m(void 0),je()}}}else if(t.kind==="header")if(No.current=[i,h],m(void 0),ct&&i===(lt?1:0))Et.current=void 0,Qt.current=void 0,!So&&Z==="multi"&&(x.length!==me?it(ze.fromSingleSelection([0,me]),void 0,r):it(ze.empty(),void 0,r),je());else{const ve=Qt.current;if(j==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&ve!==void 0&&b.hasIndex(ve)){const K=[Math.min(ve,i),Math.max(ve,i)+1];r||t.isTouch||xt==="multi"?tt(void 0,K,r):tt(ze.fromSingleSelection(K),void 0,r)}else j==="multi"&&(r||t.isTouch||xt==="multi")?(b.hasIndex(i)?tt(b.remove(i),void 0,r):tt(void 0,i,r),Qt.current=i):j!=="none"&&(b.hasIndex(i)?tt(b.remove(i),void 0,r):tt(ze.fromSingleSelection(i),void 0,r),Qt.current=i);Et.current=void 0,je()}else t.kind===eo?No.current=[i,h]:t.kind===pr&&!t.isMaybeScrollbar&&(St(Mn,!1),m(void 0),je(),oo==null||oo(),Et.current=void 0,Qt.current=void 0)},[Z,j,L,ct,g,Ae,lt,me,st,wt,io,je,$t,xt,ft,Po,it,ho,Nt,mn,go,ao,Xe,So,tt,St,oo]),Wo={gridSelection:L,overlay:u,gridRef:Qe,ghostInputRef:R,overlayRef:ye,ghostInputVisibleRef:te,scrollRef:$e,canvasRef:f,visibleRegionRef:Tt,abortControllerRef:Rt,rowMarkerOffset:g,mangledCols:Ie,mangledRows:Ze,rows:me,setGridSelection:St,getMangledCellContent:wt,mangledOnCellsEdited:Pt,setOverlay:m,focus:je,setGhostInputVisible:D,reselect:El,getCellRenderer:ft},{onMouseDown:zl,onMouseUp:Ll,onMouseMoveImpl:Dl,normalSizeColumn:jn,fillDown:Hl,fillRight:Fl,mouseDownData:yt,isActivelyDraggingHeader:$l}=Qs({state:Wo,mouseState:y,setMouseState:T,fillHighlightRegion:fo,setFillHighlightRegion:qn,setScrollDir:d,handleSelect:Il,onMouseMove:Ht,onCellClicked:re,onCellActivated:se,onCellContextMenu:Ee,onHeaderContextMenu:we,onGroupHeaderContextMenu:de,onHeaderClicked:N,onGroupHeaderClicked:xe,onColumnResize:Wn,onFillPattern:A,cellActivationBehavior:Ft,columnSelect:j,columnSelectionMode:xt,columns:at,groupLevels:Zt,mergedTheme:Je,minColumnWidth:so,maxColumnWidth:ln,themeForCell:Po,getCellsForSelection:Mt,setSelectedColumns:tt,visibleRegion:Kt,lastMouseSelectLocation:No}),[vn,pn]=n.useState(),Gl=n.useCallback((t,r)=>{rt==null||rt(t-g,r)},[rt,g]),Kl=n.useCallback((t,r)=>{vt==null||vt(t-g,r)},[vt,g]);n.useEffect(()=>{if(u===void 0)return;const t=i=>{const h=[];let b=i.parentElement;for(;b&&b!==document.documentElement;){const x=window.getComputedStyle(b),M=x.overflow+x.overflowY+x.overflowX;(M.includes("scroll")||M.includes("auto"))&&h.push(b),b=b.parentElement}return h},r=i=>{const h=i.target;$e.current&&!$e.current.contains(h)&&m(void 0)},a=[];if($e.current){const i=t($e.current);a.push(...i)}return a.forEach(i=>{i.addEventListener("scroll",r)}),window.addEventListener("scroll",r),document.addEventListener("scroll",r,!0),()=>{a.forEach(i=>{i.removeEventListener("scroll",r)}),window.removeEventListener("scroll",r),document.removeEventListener("scroll",r,!0)}},[u,m,$e]);const ht=(dr=L==null?void 0:L.current)==null?void 0:dr.cell,Pl=n.useCallback((t,r,a,i,h,b)=>{if(zo.current=!1,u!==void 0){const q=Tt.current;(q.x!==t.x||q.y!==t.y)&&m(void 0)}let x=ht;x!==void 0&&(x=[x[0]-g,x[1]]);const M=nt===0?void 0:{x:0,y:t.y,width:nt,height:t.height},G=[];M!==void 0&&G.push(M),pt>0&&(G.push({x:t.x-g,y:me-pt,width:t.width,height:pt}),nt>0&&G.push({x:0,y:me-pt,width:nt,height:pt}));const O={x:t.x-g,y:t.y,width:t.width,height:Ae&&t.y+t.height>=me?t.height-1:t.height,tx:h,ty:b,extras:{selected:x,freezeRegion:M,freezeRegions:G}};Tt.current=O,Yn(O),Rl([r,a,i]),yo==null||yo(O,O.tx,O.ty,O.extras)},[ht,u,g,Ae,me,nt,pt,m,Yn,yo]),Nl=Dt(le,n.useCallback((t,r)=>(le==null?void 0:le(t-g,r-g))!==!1,[le,g])),Wl=Dt(B,n.useCallback((t,r)=>{B==null||B(t-g,r-g),j!=="none"&&tt(ze.fromSingleSelection(r),void 0,!0)},[j,B,g,tt])),Cn=n.useRef(!1),Vl=n.useCallback(t=>{if(t.location[0]===0&&g>0){t.preventDefault();return}Le==null||Le({...t,location:[t.location[0]-g,t.location[1]]}),t.defaultPrevented()||(Cn.current=!0),T(void 0)},[Le,g]),Bl=n.useCallback(()=>{Cn.current=!1},[]),er=dt==null?void 0:dt.selectionBehavior,Vo=n.useCallback(t=>{if(er!=="block-spanning")return;const{isGroupHeader:r,path:a,groupRows:i}=go(t);if(r)return[t,t];const h=a[a.length-1],b=t-h,x=t+i-h-1;return[b,x]},[go,er]),wn=n.useRef(void 0),yn=n.useCallback(t=>{var r,a,i;if(!Ii(t,wn.current)&&(wn.current=t,!(((r=yt==null?void 0:yt.current)==null?void 0:r.button)!==void 0&&yt.current.button>=1))){if(t.buttons!==0&&y!==void 0&&((a=yt.current)==null?void 0:a.location[0])===0&&g===1&&Z==="multi"&&y.previousSelection&&!y.previousSelection.rows.hasIndex(yt.current.location[1])&&L.rows.hasIndex(yt.current.location[1])){const h=Math.min(yt.current.location[1],t.location[1]),b=Math.max(yt.current.location[1],t.location[1])+1;it(ze.fromSingleSelection([h,b]),void 0,!1)}else if(t.buttons!==0&&y!==void 0&&L.current!==void 0&&!Cn.current&&!$l.current&&(Ue==="rect"||Ue==="multi-rect")){const[h,b]=L.current.cell;let[x,M]=t.location;if(M<0&&(M=Tt.current.y),y.fillHandle===!0&&((i=y.previousSelection)==null?void 0:i.current)!==void 0){const G=y.previousSelection.current.range;M=Math.min(M,Ae?me-1:me);const O=zi(G,x,M,In);qn(O)}else{if(Ae&&b===me)return;if(Ae&&M===me)if(t.kind===pr)M--;else return;x=Math.max(x,g);const q=Vo(b);M=q===void 0?M:Bt(M,q[0],q[1]);const Me=x-h,ke=M-b,ve={x:Me>=0?h:x,y:ke>=0?b:M,width:Math.abs(Me)+1,height:Math.abs(ke)+1};Xe({...L.current,range:ve},!0,!1,"drag")}}wo==null||wo({...t,location:[t.location[0]-g,t.location[1]]})}},[y,g,Z,L,Ue,wo,it,Ae,me,In,Vo,Xe]),Al=n.useCallback(()=>{var x,M;const t=wn.current;if(t===void 0)return;const[r,a]=t.scrollEdge;let[i,h]=t.location;const b=Tt.current;r===-1?i=((M=(x=b.extras)==null?void 0:x.freezeRegion)==null?void 0:M.x)??b.x:r===1&&(i=b.x+b.width),a===-1?h=Math.max(0,b.y):a===1&&(h=Math.min(me-1,b.y+b.height)),i=Bt(i,0,Ie.length-1),h=Bt(h,0,me-1),yn({...t,location:[i,h]})},[Ie.length,yn,me]);Ns(c,$e,Al);const Ul=n.useCallback(t=>{if(L.current===void 0)return;const[r,a]=t,[i,h]=L.current.cell,b=L.current.range;let x=b.x,M=b.x+b.width,G=b.y,O=b.y+b.height;const[q,Me]=Vo(h)??[0,me-1],ke=Me+1;if(a!==0)switch(a){case 2:{O=ke,G=h,We(0,O,"vertical");break}case-2:{G=q,O=h+1,We(0,G,"vertical");break}case 1:{G<h?(G++,We(0,G,"vertical")):(O=Math.min(ke,O+1),We(0,O,"vertical"));break}case-1:{O>h+1?(O--,We(0,O,"vertical")):(G=Math.max(q,G-1),We(0,G,"vertical"));break}default:Cr()}if(r!==0)if(r===2)M=Ie.length,x=i,We(M-1-g,0,"horizontal");else if(r===-2)x=g,M=i+1,We(x-g,0,"horizontal");else{let ve=[];if(Mt!==void 0){const K=Mt({x,y:G,width:M-x-g,height:O-G},Rt.current.signal);typeof K=="object"&&(ve=tc(K))}if(r===1){let K=!1;if(x<i){if(ve.length>0){const Te=to(x+1,i+1).find(Se=>!ve.includes(Se-g));Te!==void 0&&(x=Te,K=!0)}else x++,K=!0;K&&We(x,0,"horizontal")}K||(M=Math.min(Ie.length,M+1),We(M-1-g,0,"horizontal"))}else if(r===-1){let K=!1;if(M>i+1){if(ve.length>0){const Te=to(M-1,i,-1).find(Se=>!ve.includes(Se-g));Te!==void 0&&(M=Te,K=!0)}else M--,K=!0;K&&We(M-g,0,"horizontal")}K||(x=Math.max(g,x-1),We(x-g,0,"horizontal"))}else Cr()}Xe({cell:L.current.cell,range:{x,y:G,width:M-x,height:O-G}},!0,!1,"keyboard-select")},[Mt,Vo,L,Ie.length,g,me,We,Xe]),bn=n.useRef(Ln);bn.current=Ln;const Wt=n.useCallback((t,r,a,i)=>{const h=Ze-(a?0:1);t=Bt(t,g,at.length-1+g),r=Bt(r,0,h);const b=ht==null?void 0:ht[0],x=ht==null?void 0:ht[1];if(t===b&&r===x)return!1;if(i&&L.current!==void 0){const M=[...L.current.rangeStack];(L.current.range.width>1||L.current.range.height>1)&&M.push(L.current.range),St({...L,current:{cell:[t,r],range:{x:t,y:r,width:1,height:1},rangeStack:M}},!0)}else Xe({cell:[t,r],range:{x:t,y:r,width:1,height:1}},!0,!1,"keyboard-nav");return p.current!==void 0&&p.current[0]===t&&p.current[1]===r&&(p.current=void 0),bn.current&&We(t-g,r,"both",0,20),!0},[Ze,g,at.length,ht,L,We,St,Xe]),tr=n.useCallback((t,r)=>{var q,Me,ke,ve;const a=ye.current;te.current;let i=t;const h=((q=R.current)==null?void 0:q.getValue())??"",b=((Me=a==null?void 0:a.content)==null?void 0:Me.kind)===ee.Custom;if((a==null?void 0:a.cell)!==void 0&&h.length>0&&a.content!==void 0&&!b){const K=a.content;if(K.kind===ee.Text)i={...K,data:h,displayData:h};else if(K.kind===ee.Number){const Te=Number.parseFloat(h),Se=Number.isNaN(Te)?0:Te;i={...K,data:Se,displayData:Se.toLocaleString()}}else K.kind===ee.Uri?i={...K,data:h,displayData:h}:K.kind===ee.Markdown&&(i={...K,data:h})}else b&&(i=t);if(i!==void 0&&h.length===0)if(i.kind===ee.Text&&i.data!==i.displayData)i={...i,displayData:i.data};else if(i.kind===ee.Number){const K=i.data!==void 0?i.data.toLocaleString():"0";i.displayData!==K&&(i={...i,displayData:K})}else i.kind===ee.Uri&&i.data!==i.displayData&&(i={...i,displayData:i.data});const x=a==null?void 0:a.content,M=()=>{if(i===void 0||x===void 0)return!1;if(i.kind!==x.kind)return!0;switch(i.kind){case ee.Text:case ee.Uri:case ee.Markdown:return i.data!==x.data;case ee.Number:return i.data!==x.data;case ee.Boolean:return i.data!==x.data;default:return!0}};(a==null?void 0:a.cell)!==void 0&&i!==void 0&&mo(i)&&M()&&(Pt([{location:a.cell,value:i}]),window.requestAnimationFrame(()=>{var K;(K=Qe.current)==null||K.damage([{cell:a.cell}])})),(ke=R.current)==null||ke.clear(),(ve=R.current)==null||ve.setVisible(!1),D(!1),je(!0),ye.current=void 0,m(void 0);const[G,O]=r;if(L.current!==void 0&&(G!==0||O!==0)){const K=L.current.cell[1]===Ze-1;if(K&&O===1){U==null||U(t,[0,0]);return}const Te=L.current.cell[0]===Ie.length-1&&t!==void 0;let Se=!0;if(K&&O===1&&w!==void 0){Se=!1;const ae=L.current.cell[0]+G,pe=ho(ae);Nt(pe??ae,!1)}if(Te&&G===1&&ge!==void 0){Se=!1;const ae=L.current.cell[1]+O;Ko(ae,!1)}if(Se){const ae=Bt(L.current.cell[0]+G,g,Ie.length-1),pe=Bt(L.current.cell[1]+O,0,Ze-1);Wt(ae,pe,K,!1),window.requestAnimationFrame(()=>{var Ve;(Ve=R.current)==null||Ve.focus()})}}U==null||U(t,r)},[je,L,U,Pt,Ze,Wt,Ie.length,Nt,Ko,w,ge,ho,g]),Ol=n.useMemo(()=>`gdg-overlay-${ec++}`,[]),or=n.useCallback(t=>{var a,i,h,b;je();const r=[];for(let x=t.x;x<t.x+t.width;x++)for(let M=t.y;M<t.y+t.height;M++){const G=F([x-g,M]);if(!G.allowOverlay&&G.kind!==ee.Boolean)continue;let O;if(G.kind===ee.Custom){const q=ft(G),Me=(a=q==null?void 0:q.provideEditor)==null?void 0:a.call(q,{...G,location:[x-g,M]});(q==null?void 0:q.onDelete)!==void 0?O=q.onDelete(G):Li(Me)&&(O=(i=Me==null?void 0:Me.deletedValue)==null?void 0:i.call(Me,G))}else if(mo(G)&&G.allowOverlay||G.kind===ee.Boolean){const q=ft(G);O=(h=q==null?void 0:q.onDelete)==null?void 0:h.call(q,G)}O!==void 0&&!qo(O)&&mo(O)&&r.push({location:[x,M],value:O})}Pt(r),(b=Qe.current)==null||b.damage(r.map(x=>({cell:x.location})))},[je,F,ft,Pt,g]),_l=u!==void 0,{onKeyDown:jt}=zs({state:Wo,keybindings:Pn,overlayOpen:_l,columnSelect:j,rowSelect:Z,rangeSelect:Ue,editOnType:Ut,trapFocus:Jr,showTrailingBlankRow:Ae,columnsInLength:W.length,rowGroupingNavBehavior:mn,mapper:go,onKeyDownIn:ut,onSelectionCleared:oo,onCellActivated:se,onDelete:Vn,getCellContent:F,setSelectedColumns:tt,setSelectedRows:it,setShowSearchInner:Nn,searchInputRef:E,adjustSelection:Ul,updateSelectedCell:Wt,deleteRange:or,fillDown:Hl,fillRight:Fl,appendRow:Nt,getCustomNewRowTargetColumn:ho,scrollToRef:Go}),[Xl,nr]=n.useState(!1),rr=n.useRef(Pi(t=>{nr(t)},5)),{onGhostInput:Yl,onGhostCompositionStart:ql,onGhostCompositionEnd:Zl,onGhostKeyDown:Jl,onGhostKeyUp:Ql,onGhostFocus:jl,onGhostBlur:ei}=Js({state:Wo,onKeyDown:jt,onFinishEditing:tr,onKeyUpIn:et,onCellActivated:se,setIsFocused:nr}),ti=n.useCallback((t,r)=>{const a=t.location[0]-g;if(t.kind==="header"&&(we==null||we(a,{...t,preventDefault:r})),t.kind===eo){if(a<0)return;de==null||de(a,{...t,preventDefault:r})}if(t.kind==="cell"){const[i,h]=t.location;Ee==null||Ee([a,h],{...t,preventDefault:r}),Di(L,t.location)||Wt(i,h,!1,!1)}},[L,Ee,de,we,g,Wt]),{onCopy:lr,onPasteInternal:ir}=Ws({state:Wo,keybindings:Pn,getCellsForSelection:Mt,coercePasteValue:z,onPaste:vo,copyHeaders:po,columnsIn:W,onDelete:Vn,deleteRange:or,safeWindow:H}),oi=n.useCallback((t,r)=>{if(qe!==void 0){g!==0&&(t=t.map(h=>[h[0]-g,h[1]])),qe(t,r);return}if(t.length===0||r===-1)return;const[a,i]=t[r];p.current!==void 0&&p.current[0]===a&&p.current[1]===i||(p.current=[a,i],Wt(a,i,!1,!1))},[qe,g,Wt]),[Bo,Ao]=((fr=Gt==null?void 0:Gt.current)==null?void 0:fr.cell)??[];n.useLayoutEffect(()=>{var t,r,a,i;bn.current&&!zo.current&&Bo!==void 0&&Ao!==void 0&&(Bo!==((r=(t=Io.current)==null?void 0:t.current)==null?void 0:r.cell[0])||Ao!==((i=(a=Io.current)==null?void 0:a.current)==null?void 0:i.cell[1]))&&Go.current(Bo,Ao),zo.current=!1},[Bo,Ao]);const sr=L.current!==void 0&&(L.current.cell[0]>=Ie.length||L.current.cell[1]>=Ze);n.useLayoutEffect(()=>{sr&&St(Mn,!1)},[sr,St]);const ni=n.useMemo(()=>Ae===!0&&(Re==null?void 0:Re.tint)===!0?ze.fromSingleSelection(Ze-1):ze.empty(),[Ze,Ae,Re==null?void 0:Re.tint]),ri=n.useCallback(t=>typeof _t=="boolean"?_t:(_t==null?void 0:_t(t-g))??!0,[g,_t]),li=n.useMemo(()=>{if(vn===void 0||f.current===null)return null;const{bounds:t,group:r}=vn,a=f.current.getBoundingClientRect();return n.createElement(Ss,{bounds:t,group:r,canvasBounds:a,onClose:()=>pn(void 0),onFinish:i=>{pn(void 0),I==null||I(r,i)}})},[I,vn]),ii=Math.min(Ie.length,nt+g);n.useImperativeHandle(o,()=>({appendRow:(t,r)=>Nt(t+g,r),appendColumn:(t,r)=>Ko(t,r),updateCells:t=>{var r;return g!==0&&(t=t.map(a=>({cell:[a.cell[0]+g,a.cell[1]]}))),(r=Qe.current)==null?void 0:r.damage(t)},getBounds:(t,r)=>{var a;if(!((f==null?void 0:f.current)===null||($e==null?void 0:$e.current)===null)){if(t===void 0&&r===void 0){const i=f.current.getBoundingClientRect(),h=i.width/$e.current.clientWidth;return{x:i.x-$e.current.scrollLeft*h,y:i.y-$e.current.scrollTop*h,width:$e.current.scrollWidth*h,height:$e.current.scrollHeight*h}}return(a=Qe.current)==null?void 0:a.getBounds((t??0)+g,r)}},focus:()=>{var t;return(t=Qe.current)==null?void 0:t.focus()},emit:async t=>{switch(t){case"delete":jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":jt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await lr(void 0,!0);break;case"paste":await ir();break}},scrollTo:We,remeasureColumns:t=>{for(const r of t)jn(r+g)},getMouseArgsForPosition:(t,r,a)=>{if((Qe==null?void 0:Qe.current)===null)return;const i=Qe.current.getMouseArgsForPosition(t,r,a);if(i!==void 0)return{...i,location:[i.location[0]-g,i.location[1]]}}}),[Nt,Ko,jn,$e,lr,jt,ir,g,We]);const[cr,ar]=ht??[],si=n.useCallback(t=>{const[r,a]=t;if(a===-1){j!=="none"&&(tt(ze.fromSingleSelection(r),void 0,!1),je());return}cr===r&&ar===a||(Xe({cell:t,range:{x:r,y:a,width:1,height:1}},!0,!1,"keyboard-nav"),We(r,a))},[j,je,We,cr,ar,Xe,tt]),ci=n.useCallback(()=>{rr.current(!0),L.current===void 0&&L.columns.length===0&&L.rows.length===0&&y===void 0&&Xe({cell:[g,Lo],range:{x:g,y:Lo,width:1,height:1}},!0,!1,"keyboard-select")},[Lo,L,y,g,Xe]),ai=n.useCallback(()=>{rr.current(!1)},[]),[ui,di]=n.useMemo(()=>{let t;const r=(Be==null?void 0:Be.scrollbarWidthOverride)??Hi(),a=me+(Ae?1:0);if(typeof kt=="number")t=uo+a*kt;else{let h=0;const b=Math.min(a,10);for(let x=0;x<b;x++)h+=kt(x);h=Math.floor(h/b),t=uo+a*h}t+=r;const i=Ie.reduce((h,b)=>b.width+h,0)+r;return[`${Math.min(1e5,i)}px`,`${Math.min(1e5,t)}px`]},[Ie,Be==null?void 0:Be.scrollbarWidthOverride,kt,me,Ae,uo]),fi=n.useMemo(()=>Fi(Je),[Je]);return n.createElement($i.Provider,{value:Je},n.createElement(Gs,{style:fi,className:Ke,inWidth:C??ui,inHeight:P??di},n.createElement(ks,{fillHandle:Pr,drawFocusRing:Hn,experimental:Be,fixedShadowX:Nr,fixedShadowY:Wr,getRowThemeOverride:Ct,headerIcons:Vr,imageWindowLoader:Br,initialSize:Ar,isDraggable:Ur,onDragLeave:Or,onRowMoved:io,overscrollX:hl,overscrollY:gl,preventDiagonalScrolling:Yr,rightElement:qr,rightElementProps:Zr,smoothScrollX:Qr,smoothScrollY:jr,className:Ke,enableGroups:Un,onCanvasFocused:ci,onCanvasBlur:ai,canvasRef:f,onContextMenu:ti,theme:Je,cellXOffset:Sl,cellYOffset:Lo,accessibilityHeight:Kt.height,onDragEnd:Bl,columns:Ie,nonGrowWidth:An,drawHeader:xl,onColumnProposeMove:Nl,drawCell:kl,disabledRows:ni,freezeColumns:ii,lockColumns:g,firstColAccessible:g===0,getCellContent:wt,minColumnWidth:so,maxColumnWidth:ln,searchInputRef:E,showSearch:vl,onSearchClose:pl,highlightRegions:Tl,getCellsForSelection:Mt,getGroupDetails:dn,headerHeight:Gn,isFocused:Xl,groupHeaderHeight:Un?cn:0,groupLevels:Zt,groupHeaderHeights:On,freezeTrailingRows:pt+(Ae&&(Re==null?void 0:Re.sticky)===!0?1:0),hasAppendRow:Ae,onColumnResize:Wn,onColumnResizeEnd:yl,onColumnResizeStart:bl,onCellFocused:si,onColumnMoved:Wl,onDragStart:Vl,onHeaderMenuClick:Gl,onHeaderIndicatorClick:Kl,onItemHovered:yn,isFilling:(y==null?void 0:y.fillHandle)===!0,onMouseMove:Dl,onKeyDown:jt,onKeyUp:et,onMouseDown:zl,onMouseUp:Ll,onDragOverCell:Gr,onDrop:Kr,onSearchResultsChanged:oi,onVisibleRegionChanged:Pl,clientSize:un,rowHeight:kt,searchResults:V,searchValue:X,onSearchValueChange:ie,rows:Ze,scrollRef:$e,selection:L,translateX:Kt.tx,translateY:Kt.ty,verticalBorder:ri,gridRef:Qe,getCellRenderer:ft,resizeIndicator:ll}),li,u!==void 0&&n.createElement(n.Suspense,{fallback:null},n.createElement(js,{...u,validateCell:wl,bloom:ue,id:Ol,getCellRenderer:ft,className:(Be==null?void 0:Be.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Hr,imageEditorOverride:S,portalElementRef:xo,onFinishEditing:tr,markdownDivCreateNode:be,isOutsideClick:rl,customEventTarget:Be==null?void 0:Be.eventTarget,isGhostMode:$}))),(()=>{const t=(xo==null?void 0:xo.current)??document.getElementById("portal");return t===null?null:gi.createPortal(n.createElement(Zs,{ref:R,onInput:Yl,onCompositionStart:ql,onCompositionEnd:Zl,onKeyDown:Jl,onKeyUp:Ql,onFocus:jl,onBlur:ei}),t)})())},nc=n.forwardRef(oc),rc=(e,o)=>{const l=n.useMemo(()=>({...ps,...e.headerIcons}),[e.headerIcons]),s=n.useMemo(()=>e.renderers??Gi,[e.renderers]),u=n.useMemo(()=>e.imageWindowLoader??new Ki,[e.imageWindowLoader]);return n.createElement(nc,{...e,renderers:s,headerIcons:l,ref:o,imageWindowLoader:u})},gc=n.forwardRef(rc);export{gc as D,zt as k,Os as u};
