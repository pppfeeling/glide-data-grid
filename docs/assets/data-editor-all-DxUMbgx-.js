const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-CBe8IteY.js","./iframe-BOh-v4G6.js","./preload-helper-C1FmrZbK.js","./index-CkJAB7Hc.js","./marked.esm-DySb2lzn.js","./throttle-C-j8h0WW.js","./flatten-wEpA7NYj.js","./number-overlay-editor-pnQFXKxJ.js","./react-number-format.es-DCWFGTsi.js"])))=>i.map(i=>d[i]);
var sa=Object.defineProperty;var aa=(e,t,n)=>t in e?sa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Le=(e,t,n)=>aa(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as Rt}from"./iframe-BOh-v4G6.js";import{_ as Ul}from"./preload-helper-C1FmrZbK.js";import{h as ca,g as Kl,j as da,k as ua,v as fa,l as ha,m as mn,r as mo,t as ga}from"./throttle-C-j8h0WW.js";import{u as ma,f as yl}from"./flatten-wEpA7NYj.js";import{s as an,a as wa}from"./marked.esm-DySb2lzn.js";function Vl(e="This should not happen"){throw new Error(e)}function ln(e,t="Assertion failed"){if(!e)return Vl(t)}function hr(e,t){return Vl(t??"Hell froze over")}function ba(e,t){try{return e()}catch{return t}}const pl=Object.prototype.hasOwnProperty;function Xo(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Xo(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(pl.call(e,n)&&++o&&!pl.call(t,n)||!(n in t)||!Xo(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const _r=null,Oi=void 0;var Q;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(Q||(Q={}));var vl;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(vl||(vl={}));var Ur;(function(e){e.Triangle="triangle",e.Dots="dots"})(Ur||(Ur={}));function Nr(e){return"width"in e&&typeof e.width=="number"}async function Cl(e){return typeof e=="object"?e:await e()}function Lo(e){return!(e.kind===Q.Loading||e.kind===Q.Bubble||e.kind===Q.RowID||e.kind===Q.Protected||e.kind===Q.Drilldown)}function Zu(e){return!(e.kind===Q.Loading||e.kind===Q.Bubble||e.kind===Q.RowID||e.kind===Q.Protected||e.kind===Q.Drilldown||e.kind===Q.Boolean||e.kind===Q.Image||e.kind===Q.Custom)}function $o(e){return e.kind===$t.Marker||e.kind===$t.NewRow||e.kind===$t.RowStatus}function Wo(e){if(!Lo(e)||e.kind===Q.Image)return!1;switch(e.kind){case Q.Text:case Q.Number:case Q.Markdown:case Q.Uri:case Q.Custom:case Q.Boolean:return e.readonly!==!0;default:hr(e,"A cell was passed with an invalid kind")}}function ya(e){return ca(e,"editor")}function Xi(e){return!(e.readonly??!1)}var $t;(function(e){e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id"})($t||($t={}));const Kr={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Ri(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let xl;const Jt=class Jt{constructor(t){Le(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Jt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Ri([...this.items,n]);return new Jt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,c]of n.entries()){const[l,d]=c;if(l<=r&&o<=d){const f=[];l<o&&f.push([l,o]),r<d&&f.push([r,d]),n.splice(i,1,...f)}}return new Jt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Le(Jt,"create",t=>new Jt(Ri(t))),Le(Jt,"empty",()=>xl??(xl=new Jt([]))),Le(Jt,"fromSingleSelection",t=>Jt.empty().add(t)),Le(Jt,"fromArray",t=>{if(t.length===0)return Jt.empty();const n=t.map(r=>[r,r+1]),o=Ri(n);return new Jt(o)});let rt=Jt;const pa=an("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Vt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const c=n,l=d=>{var f;(f=i.current)==null||f.call(c,d)};return c.addEventListener(e,l,{passive:o,capture:r}),()=>{c.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function Qn(e,t){return e===void 0?void 0:t}const va=Math.PI;function kl(e){return e*va/180}const ql=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),jl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Zl=(e,t,n)=>Math.min(e,t-n*2),Jl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Yi=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Ca=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function xa(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const c=s.useRef(Kl(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&c.current(()=>e())},t),o}const ka="֑-߿יִ-﷽ﹰ-ﻼ",Sa="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",Ma=new RegExp("^[^"+Sa+"]*["+ka+"]");function Gi(e){return Ma.test(e)?"rtl":"not-rtl"}let Or;function Pi(){if(typeof document>"u")return 0;if(Or!==void 0)return Or;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Or=n-o,Or}const go=Symbol();function Ra(e){const t=s.useRef([go,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const d=t.current[0];d!==go&&(l=typeof l=="function"?l(d):l,l===d)||(d!==go&&r({}),o(f=>typeof l=="function"?l(d===go?f:d):l),t.current[0]=go)},[]),c=s.useCallback(()=>{t.current[0]=go,r({})},[]);return[t.current[0]===go?n:t.current[0],i,c]}function Ql(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Ea(e){const t=s.useRef(e);return Xo(e,t.current)||(t.current=e),t.current}const Ia=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const c=i.length>1;return s.createElement(pa,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(da.Carousel,{showArrows:c,showThumbs:!1,swipeable:c,emulateTouch:c,infiniteLoop:c},i.map(l=>{const d=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},d)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Yi,null)))},Da=an("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class Ta extends Rt.PureComponent{constructor(){super(...arguments);Le(this,"targetElement",null);Le(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,c=wa(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let d=i==null?void 0:i(c);if(d===void 0){const u=document.createElement("template");u.innerHTML=c,d=u.content}n.append(d);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Rt.createElement(Da,{ref:this.containerRefHook})}}const Fa=an("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Ha=an("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),Aa=an("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let Sl=0;const _i=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:c,...l}=e,{onChange:d,className:f}=l,u=s.useRef(null),m=n??"";ln(d!==void 0,"GrowingEntry must be a controlled input area");const[g]=s.useState(()=>"input-box-"+(Sl=(Sl+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const b=m.toString().length;h.focus(),h.setSelectionRange(r?0:b,b)},[]),s.useLayoutEffect(()=>{var h;if(c!==void 0){const b=typeof c=="number"?[c,null]:c;(h=u.current)==null||h.setSelectionRange(b[0],b[1])}},[c]);const w=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(Aa,{className:"gdg-growing-entry"},s.createElement(Ha,{className:f},m+`
`),s.createElement(Fa,{...l,className:(f??"")+" gdg-input",id:g,ref:u,onKeyDown:w,value:m,placeholder:t,dir:"auto"}))},Ei={};let jn=null;function za(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Yo(e){const t=e.toLowerCase().trim();if(Ei[t]!==void 0)return Ei[t];jn=jn||za(),jn.style.color="#000",jn.style.color=t;const n=getComputedStyle(jn).color;jn.style.color="#fff",jn.style.color=t;const o=getComputedStyle(jn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),Ei[t]=r,r}function bo(e,t){const[n,o,r]=Yo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const Ml=new Map;function Rl(e,t){const n=`${e}-${t}`,o=Ml.get(n);if(o!==void 0)return o;const r=sn(e,t);return Ml.set(n,r),r}function sn(e,t){if(t===void 0)return e;const[n,o,r,i]=Yo(e);if(i===1)return e;const[c,l,d,f]=Yo(t),u=i+f*(1-i),m=(i*n+f*c*(1-i))/u,g=(i*o+f*l*(1-i))/u,w=(i*r+f*d*(1-i))/u;return`rgba(${m}, ${g}, ${w}, ${u})`}function Ju(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,c]=Yo(e),[l,d,f,u]=Yo(t),m=o*c,g=r*c,w=i*c,h=l*u,b=d*u,x=f*u,k=n,y=1-n,R=c*y+u*k;if(R===0)return"rgba(0, 0, 0, 0)";const $=Math.floor((m*y+h*k)/R),L=Math.floor((g*y+b*k)/R),z=Math.floor((w*y+x*k)/R);return`rgba(${$}, ${L}, ${z}, ${R})`}function Qu(e){if(e==="transparent")return 0;function t(i){const c=i/255;return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const[n,o,r]=Yo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Pa(e,t){return Rt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function Ba(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(ur(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function gr(e,t){return(e??"")===(t??"")}function La(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function es(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function ur(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ts(e){return[e.x+e.width-1,e.y+e.height-1]}function El(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,c=n.y+n.height-1,[l,d]=e;if(d<i||d>c)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Wa(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&El(e,t,i)&&r++;for(const c of n.current.rangeStack)El(e,t,c)&&r++;return r}function ns(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,c)=>({...i,sticky:e[c].sticky})),n=o}return n}function Go(e,t){let n=0;const o=ns(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function yo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Bi(e,t,n,o,r){const i=ns(e,o),c=[];for(const f of i)if(f.sticky)c.push(f);else break;if(c.length>0)for(const f of c)n-=f.width;let l=t,d=r??0;for(;d<=n&&l<i.length;)d+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||c.push(u)}return c}function $a(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Na(e,t,n,o,r,i,c,l,d,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let m=t;for(let h=0;h<f;h++){const b=i-1-h,x=typeof c=="number"?c:c(b);if(m-=x,e>=m)return b}const g=i-f,w=e-(d??0);if(typeof c=="number"){const h=Math.floor((w-u)/c)+l;return h>=g?void 0:h}else{let h=u;for(let b=l;b<g;b++){const x=c(b);if(w<=h+x)return b;h+=x}return}}let Gr=0,fr={};const Oa=typeof window>"u";async function Xa(){var e;Oa||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Gr=0,fr={},fa())}Xa();function os(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function po(e,t,n,o="middle"){const r=os(e,t,o,n);let i=fr[r];return i===void 0&&(i=t.measureText(e),fr[r]=i,Gr++),Gr>1e4&&(fr={},Gr=0),i}function rs(e,t){const n=os(e,void 0,"middle",t);return fr[n]}function wn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Ya(e,t)}function Il(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Dl=[];function Ya(e,t){for(const i of Dl)if(i.key===t)return i.val;const n=Il(e,"alphabetic"),r=-(Il(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Dl.push({key:t,val:r}),r}function Ga(e,t,n,o,r,i){const{ctx:c,rect:l,theme:d}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const m=1-f/u;c.globalAlpha=m,c.fillStyle=d.bgSearchResult,c.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),c.globalAlpha=1,o!==void 0&&(o.fillStyle=d.bgSearchResult)}return f<u}function Jr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},c=n??r.textDark;return c!==i.fillStyle&&(o.fillStyle=c,i.fillStyle=c),i}function ef(e,t,n,o,r){const{rect:i,ctx:c,theme:l}=e;c.fillStyle=l.textDark,Nn({ctx:c,rect:i,theme:l},t,n,o,r)}function is(e,t,n,o,r,i,c,l,d){d==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+c):d==="center"?e.fillText(t,n+r/2,o+i/2+c):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+c)}function ls(e,t){const n=po("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function _a(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ua(e,t,n,o,r,i,c,l,d,f){const u=l.baseFontFull,m=ua(e,t,u,r-l.cellHorizontalPadding*2,f??!1),g=ls(e,u),w=l.lineHeight*g,h=g+w*(m.length-1),b=h+l.cellVerticalPadding>i;b&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let k=Math.max(o+l.cellVerticalPadding,x);for(const y of m)if(is(e,y,n,k,r,g,c,l,d),k+=w,k>o+i)break;b&&e.restore()}function Nn(e,t,n,o,r){const{ctx:i,rect:c,theme:l}=e,{x:d,y:f,width:u,height:m}=c;o=o??!1,o||(t=_a(t,u));const g=wn(i,l),w=Gi(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Ua(i,t,d,f,u,m,g,l,n,r):is(i,t,d,f,u,m,g,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function An(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Ka(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Va(e,t,n){const o=function(l,d){const f=d.x-l.x,u=d.y-l.y,m=Math.sqrt(f*f+u*u),g=f/m,w=u/m;return{x:f,y:d.y-l.y,len:m,nx:g,ny:w,ang:Math.atan2(w,g)}};let r;const i=t.length;let c=t[i-1];for(let l=0;l<i;l++){let d=t[l%i];const f=t[(l+1)%i],u=o(d,c),m=o(d,f),g=u.nx*m.ny-u.ny*m.nx,w=u.nx*m.nx-u.ny*-m.ny;let h=Math.asin(g<-1?-1:g>1?1:g),b=1,x=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,b=-1,x=!0):h>0&&(b=-1,x=!0),r=d.radius!==void 0?d.radius:n;const k=h/2;let y=Math.abs(Math.cos(k)*r/Math.sin(k)),R;y>Math.min(u.len/2,m.len/2)?(y=Math.min(u.len/2,m.len/2),R=Math.abs(y*Math.sin(k)/Math.cos(k))):R=r;let $=d.x+m.nx*y,L=d.y+m.ny*y;$+=-m.ny*R*b,L+=m.nx*R*b,e.arc($,L,R,u.ang+Math.PI/2*b,m.ang-Math.PI/2*b,x),c=d,d=f}e.closePath()}function Li(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h){const b={x:0,y:i+f,width:0,height:0};if(e>=w.length||t>=u||t<-2||e<0)return b;const x=i-r;if(e>=m){const k=c>e?-1:1,y=Go(w);b.x+=y+d;for(let R=c;R!==e;R+=k)b.x+=w[k===1?R:R-1].width*k}else for(let k=0;k<e;k++)b.x+=w[k].width;if(b.width=w[e].width+1,t===-1)b.y=r,b.height=x;else if(t===-2){b.y=0,b.height=r;let k=e;const y=w[e].group,R=w[e].sticky;for(;k>0&&gr(w[k-1].group,y)&&w[k-1].sticky===R;){const L=w[k-1];b.x-=L.width,b.width+=L.width,k--}let $=e;for(;$+1<w.length&&gr(w[$+1].group,y)&&w[$+1].sticky===R;){const L=w[$+1];b.width+=L.width,$++}if(!R){const L=Go(w),z=b.x-L;z<0&&(b.x-=z,b.width+=z),b.x+b.width>n&&(b.width=n-b.x)}}else if(t>=u-g){let k=u-t;for(b.y=o;k>0;){const y=t+k-1;b.height=typeof h=="number"?h:h(y),b.y-=b.height,k--}b.height+=1}else{const k=l>t?-1:1;if(typeof h=="number"){const y=t-l;b.y+=y*h}else for(let y=l;y!==t;y+=k)b.y+=h(y)*k;b.height=(typeof h=="number"?h:h(t))+1}return b}const Ui=1<<21;function kn(e,t){return(t+2)*Ui+e}function ss(e){return e%Ui}function Ki(e){return Math.floor(e/Ui)-2}function Vi(e){const t=ss(e),n=Ki(e);return[t,n]}class as{constructor(){Le(this,"visibleWindow",{x:0,y:0,width:0,height:0});Le(this,"freezeCols",0);Le(this,"freezeRows",[]);Le(this,"isInWindow",t=>{const n=ss(t),o=Ki(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,c=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&c})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Xo(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class qa extends as{constructor(){super(...arguments);Le(this,"cache",new Map);Le(this,"setValue",(n,o)=>{this.cache.set(kn(n[0],n[1]),o)});Le(this,"getValue",n=>this.cache.get(kn(n[0],n[1])));Le(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Oo{constructor(t=[]){Le(this,"cells");this.cells=new Set(t.map(n=>kn(n[0],n[1])))}add(t){this.cells.add(kn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(kn(t[0],t[1]))}remove(t){this.cells.delete(kn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Ki(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(kn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Vi(t)}}function ja(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const cs={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function ds(){return cs}const us=Rt.createContext(cs);function tf(){return Rt.useContext(us)}function On(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=sn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Wi=150;function Za(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Wi}function fs(e,t,n,o,r,i,c,l,d){let f=0;const u=r===void 0?[]:r.map(w=>{const h=Za(e,w[o],t,d);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let w=0;for(const b of u)w+=b;const h=w/u.length;for(let b=0;b<u.length;b++)u[b]>=h*2?u[b]=0:f=Math.max(f,u[b])}const m=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=m;const g=Math.max(Math.ceil(i),Math.min(Math.floor(c),Math.ceil(f)));return{...n,width:g}}function Ja(e,t,n,o,r,i,c,l,d){const f=s.useRef(t),u=s.useRef(n),m=s.useRef(c);f.current=t,u.current=n,m.current=c;const[g,w]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const y=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",[y,y.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(g&&document.documentElement.append(g),()=>{g==null||g.remove()}),[g]);const h=s.useRef({}),b=s.useRef(),[x,k]=s.useState();return s.useLayoutEffect(()=>{const y=u.current;if(y===void 0||e.every(Nr))return;let R=Math.max(1,10-Math.floor(e.length/1e4)),$=0;R<f.current&&R>1&&(R--,$=1);const L={x:0,y:0,width:e.length,height:Math.min(f.current,R)},z={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const Y=y(L,d.signal),E=$>0?y(z,d.signal):void 0;let N;typeof Y=="object"?N=Y:N=await Cl(Y),E!==void 0&&(typeof E=="object"?N=[...N,...E]:N=[...N,...await Cl(E)]),b.current=e,k(N)})()},[d.signal,e]),s.useMemo(()=>{let R=e.every(Nr)?e:w===null?e.map(P=>Nr(P)?P:{...P,width:Wi}):(w.font=m.current.baseFontFull,e.map((P,Y)=>{if(Nr(P))return P;if(h.current[P.id]!==void 0)return{...P,width:h.current[P.id]};if(x===void 0||b.current!==e||P.id===void 0)return{...P,width:Wi};const E=fs(w,c,P,Y,x,r,i,!0,l);return h.current[P.id]=E.width,E})),$=0,L=0;const z=[];for(const[P,Y]of R.entries())$+=Y.width,Y.grow!==void 0&&Y.grow>0&&(L+=Y.grow,z.push(P));if($<o&&z.length>0){const P=[...R],Y=o-$;let E=Y;for(let N=0;N<z.length;N++){const X=z[N],W=(R[X].grow??0)/L,T=N===z.length-1?E:Math.min(E,Math.floor(Y*W));P[X]={...R[X],growOffset:T,width:R[X].width+T},E-=T}R=P}return{sizedColumns:R,nonGrowWidth:$}},[o,e,w,x,c,r,i,l])}const pt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},hs=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},rc=e=>{const t=e.bgColor;return`${pt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},ic=hs,lc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},uc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},fc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},hc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},gc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},mc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},wc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},bc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},yc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},pc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},vc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Cc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},xc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},kc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},Sc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},Mc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},Rc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},Ec=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),Ic=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),Dc={headerRowID:Qa,headerNumber:tc,headerCode:ec,headerString:nc,headerBoolean:oc,headerAudioUri:ic,headerVideoUri:lc,headerEmoji:sc,headerImage:ac,headerUri:hs,headerPhone:cc,headerMarkdown:dc,headerDate:uc,headerTime:fc,headerEmail:hc,headerReference:gc,headerIfThenElse:mc,headerSingleValue:wc,headerLookup:bc,headerTextTemplate:yc,headerMath:pc,headerRollup:vc,headerJoinStrings:Cc,headerSplitString:xc,headerGeoDistance:kc,headerArray:Sc,rowOwnerOverlay:Mc,protectedColumnOverlay:Rc,renameIcon:rc,headerArrowDown:Ec,headerArrowUp:Ic};function Tc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Fc{constructor(t,n){Le(this,"onSettled");Le(this,"spriteMap",new Map);Le(this,"headerIcons");Le(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,c,l,d=1){const[f,u]=Tc(n,l),m=c*Math.ceil(window.devicePixelRatio),g=`${f}_${u}_${m}_${t}`;let w=this.spriteMap.get(g);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const b=w.getContext("2d");if(b===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(g,w);const k=x.decode();if(k===void 0)return;this.inFlight++,k.then(()=>{b.drawImage(x,0,0,m,m)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else d<1&&(o.globalAlpha=d),o.drawImage(w,0,0,m,m,r,i,c,c),d<1&&(o.globalAlpha=1)}}function gs(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Qr(e,t,n,o,r,i,c,l,d){l=l??t;let f=t,u=e;const m=o-i;let g=!1;for(;f<n&&u<m;){const w=r(u);if(f+w>l&&d(f,u,w,!1,c&&u===o-1)===!0){g=!0;break}f+=w,u++}if(!g){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,d(f,u,h,!0,c&&u===o-1)}}}function to(e,t,n,o,r,i){let c=0,l=0;const d=r+o;for(const f of e){const u=f.sticky?l:c+n;if(i(f,u,d,f.sticky?0:l,t)===!0)break;c+=f.width,l+=f.sticky?f.width:0}}function ms(e,t,n,o,r){let i=0,c=0;for(let l=0;l<e.length;l++){const d=e[l];let f=l+1,u=d.width;for(d.sticky&&(c+=u);f<e.length&&gr(e[f].group,d.group)&&e[f].sticky===e[l].sticky;){const b=e[f];u+=b.width,f++,l++,b.sticky&&(c+=b.width)}const m=d.sticky?0:n,g=i+m,w=d.sticky?0:Math.max(0,c-g),h=Math.min(u-w,t-(g+w));r([d.sourceIndex,e[f-1].sourceIndex],d.group??"",g+w,0,h,o),i+=u}}function ws(e,t,n,o,r,i,c){var g;const[l,d]=e;let f,u;const m=((g=c.find(w=>!w.sticky))==null?void 0:g.sourceIndex)??0;if(d>m){const w=Math.max(l,m);let h=t,b=o;for(let x=i.sourceIndex-1;x>=w;x--)h-=c[x].width,b+=c[x].width;for(let x=i.sourceIndex+1;x<=d;x++)b+=c[x].width;u={x:h,y:n,width:b,height:r}}if(m>l){const w=Math.min(d,m-1);let h=t,b=o;for(let x=i.sourceIndex-1;x>=l;x--)h-=c[x].width,b+=c[x].width;for(let x=i.sourceIndex+1;x<=w;x++)b+=c[x].width;f={x:h,y:n,width:b,height:r}}return[f,u]}function Hc(e,t,n,o){if(o==="any")return bs(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),es([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,c=n-e.y+1,l=e.y+e.height-n,d=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:c,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return d===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:d===c?{x:e.x,y:n,width:e.width,height:e.y-n}:d===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function mr(e,t,n,o,r,i,c,l){return e<=r+c&&r<=e+n&&t<=i+l&&i<=t+o}function wo(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function bs(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function Ac(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function zc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,c=t+4,l=n+4,d=r-e.x,f=e.x+e.width-c,u=i-e.y,m=e.y+e.height-l,g=d>0?e.x+Math.floor(d/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,b=m>0?e.y+e.height-Math.floor(m/o)*o:e.y+e.height;return{x:g,y:h,width:w-g,height:b-h}}function Pc(e,t,n,o,r){const[i,c,l,d]=t,[f,u,m,g]=r,{x:w,y:h,width:b,height:x}=e,k=[];if(b<=0||x<=0)return k;const y=w+b,R=h+x,$=w<i,L=h<c,z=w+b>l,P=h+x>d,Y=w>=i&&w<l||y>i&&y<=l||w<i&&y>l,E=h>=c&&h<d||R>c&&R<=d||h<c&&R>d;if(Y&&E){const X=Math.max(w,i),W=Math.max(h,c),T=Math.min(y,l),H=Math.min(R,d);k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:f,y:u,width:m-f+1,height:g-u+1}})}if($&&L){const X=w,W=h,T=Math.min(y,i),H=Math.min(R,c);k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:0,y:0,width:f+1,height:u+1}})}if(L&&Y){const X=Math.max(w,i),W=h,T=Math.min(y,l),H=Math.min(R,c);k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:f,y:0,width:m-f+1,height:u+1}})}if(L&&z){const X=Math.max(w,l),W=h,T=y,H=Math.min(R,c);k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:m,y:0,width:n-m+1,height:u+1}})}if($&&E){const X=w,W=Math.max(h,c),T=Math.min(y,i),H=Math.min(R,d);k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:0,y:u,width:f+1,height:g-u+1}})}if(z&&E){const X=Math.max(w,l),W=Math.max(h,c),T=y,H=Math.min(R,d);k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:m,y:u,width:n-m+1,height:g-u+1}})}if($&&P){const X=w,W=Math.max(h,d),T=Math.min(y,i),H=R;k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:0,y:g,width:f+1,height:o-g+1}})}if(P&&Y){const X=Math.max(w,i),W=Math.max(h,d),T=Math.min(y,l),H=R;k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:f,y:g,width:m-f+1,height:o-g+1}})}if(z&&P){const X=Math.max(w,l),W=Math.max(h,d),T=y,H=R;k.push({rect:{x:X,y:W,width:T-X,height:H-W},clip:{x:m,y:g,width:n-m+1,height:o-g+1}})}return k}const Bc={kind:Q.Loading,allowOverlay:!1};function Tl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b,x,k,y,R,$,L,z,P,Y,E,N,X,W,T,H,ie,V,he,ue){let ye=(R==null?void 0:R.size)??Number.MAX_SAFE_INTEGER;const ee=performance.now();let U=T.baseFontFull;e.font=U;const ve={ctx:e},te=[0,0],ge=x>0?yo(d,x,f):0;let Ne,K;const ne=new Oo,Ae=new Set,Ze=gs(y);if(to(t,l,i,c,r,(de,Je,at,ke,ze)=>{const He=Math.max(0,ke-Je),wt=Je+He,gt=r+1,mt=de.width-He,q=o-r-1;if(y.length>0){let ct=!1;for(let j=0;j<y.length;j++){const se=y[j];if(mr(wt,gt,mt,q,se.x,se.y,se.width,se.height)){ct=!0;break}}if(!ct)return}const me=()=>{e.save(),e.beginPath(),e.rect(wt,gt,mt,q),e.clip()},Se=$.columns.hasIndex(de.sourceIndex),Fe=m(de.group??"").overrideTheme,Me=de.themeOverride===void 0&&Fe===void 0?T:On(T,Fe,de.themeOverride),it=Me.baseFontFull;it!==U&&(U=it,e.font=it),me();let et;return Qr(ze,at,o,d,f,x,k,Ze,(ct,j,se,Oe,Ye)=>{var zn,Gt,yn;if(j<0)return;if(te[0]=de.sourceIndex,te[1]=j,ne.has(te)){ye--;return}if(R!==void 0&&!R.has(te))return;if(y.length>0){let Te=!1;for(let nt=0;nt<y.length;nt++){const tt=y[nt];if(mr(Je,ct,de.width,se,tt.x,tt.y,tt.width,tt.height)){Te=!0;break}}if(!Te)return}const Et=$.rows.hasIndex(j),It=w.hasIndex(j),De=j<d?u(te):Bc;let Re=Je,ut=de.width,vt=ct,Ct=se,Nt=!1,Pt=!1;if(De.rowspan!==void 0){const[Te,nt]=De.rowspan,tt=`${de.sourceIndex}|${Te}`;if(Ae.has(tt)){ye--;return}else{let Ue=ct;for(let _e=Te;_e<j;_e++)Ue-=f(_e);let Ot=0;for(let _e=Te;_e<nt;_e++)Ot+=f(_e);if(Ue<gt+q&&Ue+Ot>gt){vt=Ue,Ct=Ot,Ae.add(tt);for(let _e=Te;_e<nt;_e++)_e!==j&&ne.add([de.sourceIndex,_e]);Nt=!0}else{Ae.add(tt);for(let _e=Te;_e<nt;_e++)ne.add([de.sourceIndex,_e]);ye--;return}}}if(De.span!==void 0){const[Te,nt]=De.span,tt=`${j},${Te},${nt},${de.sticky}`;if(K===void 0&&(K=new Set),K.has(tt)){ye--;return}else{const Ue=ws(De.span,Je,ct,de.width,se,de,n),Ot=de.sticky?Ue[0]:Ue[1];!de.sticky&&Ue[0]!==void 0&&(Pt=!0),Ot!==void 0&&(Re=Ot.x,ut=Ot.width,K.add(tt),Nt=!0)}}if(Nt){e.restore(),et=void 0,e.save(),e.beginPath();const Te=Math.max(0,ke-Re);e.rect(Re+Te,vt,ut-Te,Ct),Ne===void 0&&(Ne=[]),Ne.push({x:Re+Te,y:vt,width:ut-Te,height:Ct}),e.clip()}const bn=g==null?void 0:g(j),cn=Ye&&((zn=de.trailingRowOptions)==null?void 0:zn.themeOverride)!==void 0?(Gt=de.trailingRowOptions)==null?void 0:Gt.themeOverride:void 0,Dt=De.themeOverride===void 0&&bn===void 0&&cn===void 0?Me:On(Me,bn,cn,De.themeOverride);e.beginPath();const qt=La(te,De,$);let Xt=Wa(te,De,$,b);const Sn=De.span!==void 0&&$.columns.some(Te=>De.span!==void 0&&Te>=De.span[0]&&Te<=De.span[1]);qt&&!h&&b?Xt=0:qt&&b&&(Xt=Math.max(Xt,1)),Sn&&Xt++,qt||(Et&&Xt++,Se&&!Ye&&Xt++);const bt=De.kind===Q.Protected?Dt.bgCellMedium:Dt.bgCell;let ft;if((Oe||bt!==T.bgCell)&&(ft=sn(bt,ft)),Xt>0||It){It&&(ft=sn(Dt.bgHeader,ft));for(let Te=0;Te<Xt;Te++)ft=sn(Dt.accentLight,ft)}else if(L!==void 0){for(const Te of L)if(Te[0]===de.sourceIndex&&Te[1]===j){ft=sn(Dt.bgSearchResult,ft);break}}if(z!==void 0)for(let Te=0;Te<z.length;Te++){const nt=z[Te],tt=nt.range;nt.style!=="solid-outline"&&tt.x<=de.sourceIndex&&de.sourceIndex<tt.x+tt.width&&tt.y<=j&&j<tt.y+tt.height&&(ft=sn(nt.color,ft))}let Ge=!1;if(R!==void 0){const Te=ct+1,tt=(Oe?Te+se-1:Math.min(Te+se-1,o-ge))-Te;(tt!==se-1||Re+1<=ke)&&(Ge=!0,e.save(),e.beginPath(),e.rect(Re+1,Te,ut-1,tt),e.clip()),ft=ft===void 0?Dt.bgCell:sn(ft,Dt.bgCell)}const Bt=de.sourceIndex===n.length-1,Qt=j===d-1;ft!==void 0&&(e.fillStyle=ft,et!==void 0&&(et.fillStyle=ft),R!==void 0?e.fillRect(Re+1,vt+1,ut-(Bt?2:1),Ct-(Qt?2:1)):e.fillRect(Re,vt,ut,Ct)),De.style==="faded"&&(e.globalAlpha=.6);let Mn;for(let Te=0;Te<E.length;Te++){const nt=E[Te];if(nt.item[0]===de.sourceIndex&&nt.item[1]===j){Mn=nt;break}}if(ut>ue&&!Pt){const Te=Dt.baseFontFull;Te!==U&&(e.font=Te,U=Te);let nt=0;if(De.rowspan!==void 0){const tt=De.rowSpanPosition??"top";if(tt==="top")nt=se/2-Ct/2;else if(tt==="bottom"){const[Ue,Ot]=De.rowspan,_e=f(Ot-1);nt=Ct/2-_e/2}}et=ys(e,De,de.sourceIndex,j,Bt,Qt,Re,vt,ut,Ct,Xt>0,Dt,ft??Dt.bgCell,P,Y,(Mn==null?void 0:Mn.hoverAmount)??0,N,W,ee,X,et,H,ie,V,he,nt)}return Ge&&e.restore(),De.style==="faded"&&(e.globalAlpha=1),ye--,Nt&&(e.restore(),(yn=et==null?void 0:et.deprep)==null||yn.call(et,ve),et=void 0,me(),U=it,e.font=it),ye<=0}),e.restore(),ye<=0}),Ne!==void 0)return Ne}const sr=[0,0],ar={x:0,y:0,width:0,height:0},Ii=[void 0,()=>{}];let $i=!1;function Lc(){$i=!0}function ys(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b,x,k,y,R,$,L,z,P,Y,E){var V,he;let N,X;x!==void 0&&x[0][0]===n&&x[0][1]===o&&(N=x[1][0],X=x[1][1]);let W;sr[0]=n,sr[1]=o,ar.x=c,ar.y=l,ar.width=d,ar.height=f,Ii[0]=z.getValue(sr),Ii[1]=ue=>z.setValue(sr,ue),$i=!1;const T={ctx:e,theme:m,col:n,row:o,cell:t,rect:ar,highlighted:u,cellFillColor:g,hoverAmount:b,frameTime:y,hoverX:N,drawState:Ii,hoverY:X,imageLoader:w,spriteManager:h,hyperWrapping:k,overrideCursor:N!==void 0?Y:void 0,requestAnimationFrame:Lc},H=Ga(T,t.lastUpdated,y,$,r,i),ie=P(t);if(ie!==void 0){($==null?void 0:$.renderer)!==ie&&((V=$==null?void 0:$.deprep)==null||V.call($,T),$=void 0);const ue=(he=ie.drawPrep)==null?void 0:he.call(ie,T,$);e.save(),e.translate(0,E),R!==void 0&&!$o(T.cell)?R(T,()=>ie.draw(T,t)):ie.draw(T,t),e.restore(),W=ue===void 0?void 0:{deprep:ue==null?void 0:ue.deprep,fillStyle:ue==null?void 0:ue.fillStyle,font:ue==null?void 0:ue.font,renderer:ie}}return(H||$i)&&(L==null||L(sr)),W}function Vr(e,t,n,o,r,i,c,l,d=-20,f=-20,u=void 0,m="center",g="square",w=!1){const h=Math.floor(r+c/2),b=g==="circle"?1e4:t.roundingRadius??4;let x=Zl(u??t.checkboxMaxSize,c,t.cellVerticalPadding),k=x/2;const y=jl(m,o,i,t.cellHorizontalPadding,x),R=ql(y,h,x),$=Jl(o+d,r+f,R);switch(n){case!0:{e.beginPath(),An(e,y-x/2,h-x/2,x,x,b),g==="circle"&&(k*=.8,x*=.8),e.fillStyle=w?t.bgCellMedium:l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(y-k+x/4.23,h-k+x/1.97),e.lineTo(y-k+x/2.42,h-k+x/1.44),e.lineTo(y-k+x/1.29,h-k+x/3.25),e.strokeStyle=w?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case _r:case!1:{e.beginPath(),An(e,y-x/2+.5,h-x/2+.5,x-1,x-1,b),e.lineWidth=1,e.strokeStyle=w?t.textLight:$?t.textDark:t.textMedium,e.stroke();break}case Oi:{e.beginPath(),An(e,y-x/2,h-x/2,x,x,b),e.fillStyle=w?t.bgCellMedium:$?t.textMedium:t.textLight,e.fill(),g==="circle"&&(k*=.8,x*=.8),e.beginPath(),e.moveTo(y-x/3,h),e.lineTo(y+x/3,h),e.strokeStyle=w?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:hr()}}function Wc(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b,x,k,y){var E,N,X,W;const R=c+l;if(R<=0)return;e.fillStyle=m.bgHeader,e.fillRect(0,0,r,R);const $=(E=o==null?void 0:o[0])==null?void 0:E[0],L=(N=o==null?void 0:o[0])==null?void 0:N[1],z=(X=o==null?void 0:o[1])==null?void 0:X[0],P=(W=o==null?void 0:o[1])==null?void 0:W[1],Y=m.headerFontFull;e.font=Y,to(t,0,i,0,R,(T,H,ie,V)=>{var Ae;if(x!==void 0&&!x.has([T.sourceIndex,-1]))return;const he=Math.max(0,V-H);e.save(),e.beginPath(),e.rect(H+he,l,T.width-he,c),e.clip();const ue=b(T.group??"").overrideTheme,ye=T.themeOverride===void 0&&ue===void 0?m:On(m,ue,T.themeOverride);ye.bgHeader!==m.bgHeader&&(e.fillStyle=ye.bgHeader,e.fill()),ye!==m&&(e.font=ye.headerFontFull);const ee=u.columns.hasIndex(T.sourceIndex),U=d!==void 0||f||T.headerRowMarkerDisabled===!0,ve=!U&&L===-1&&$===T.sourceIndex,te=U?0:((Ae=w.find(Ze=>Ze.item[0]===T.sourceIndex&&Ze.item[1]===-1))==null?void 0:Ae.hoverAmount)??0,ge=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===T.sourceIndex,Ne=ee?ye.accentColor:ge?ye.bgHeaderHasFocus:ye.bgHeader,K=n?l:0,ne=T.sourceIndex===0?0:1;ee?(e.fillStyle=Ne,e.fillRect(H+ne,K,T.width-ne,c)):(ge||te>0)&&(e.beginPath(),e.rect(H+ne,K,T.width-ne,c),ge&&(e.fillStyle=ye.bgHeaderHasFocus,e.fill()),te>0&&(e.globalAlpha=te,e.fillStyle=ye.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Cs(e,H,K,T.width,c,T,ee,ye,ve,ve?z:void 0,ve?P:void 0,ge,te,g,k,y),e.restore()}),n&&$c(e,t,r,i,l,o,m,g,w,h,b,x)}function $c(e,t,n,o,r,i,c,l,d,f,u,m){const[w,h]=(i==null?void 0:i[0])??[];let b=0;ms(t,n,o,r,(x,k,y,R,$,L)=>{if(m!==void 0&&!m.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,R,$,L),e.clip();const z=u(k),P=(z==null?void 0:z.overrideTheme)===void 0?c:On(c,z.overrideTheme),Y=h===-2&&w!==void 0&&w>=x[0]&&w<=x[1],E=Y?P.bgGroupHeaderHovered??P.bgHeaderHovered:P.bgGroupHeader??P.bgHeader;if(E!==c.bgHeader&&(e.fillStyle=E,e.fill()),e.fillStyle=P.textGroupHeader??P.textHeader,z!==void 0){let N=y;if(z.icon!==void 0&&(l.drawSprite(z.icon,"normal",e,N+8,(r-20)/2,20,P),N+=26),e.fillText(z.name,N+8,r/2+wn(e,c.headerFontFull)),z.actions!==void 0&&Y){const X=ps({x:y,y:R,width:$,height:L},z.actions);e.beginPath();const W=X[0].x-10,T=y+$-W;e.rect(W,0,T,r);const H=e.createLinearGradient(W,0,W+T,0),ie=bo(E,0);H.addColorStop(0,ie),H.addColorStop(10/T,E),H.addColorStop(1,E),e.fillStyle=H,e.fill(),e.globalAlpha=.6;const[V,he]=(i==null?void 0:i[1])??[-1,-1];for(let ue=0;ue<z.actions.length;ue++){const ye=z.actions[ue],ee=X[ue],U=wo(ee,V+y,he);U&&(e.globalAlpha=1),l.drawSprite(ye.icon,"normal",e,ee.x+ee.width/2-10,ee.y+ee.height/2-10,20,P),U&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&f(x[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.strokeStyle=c.borderColor,e.lineWidth=1,e.stroke()),e.restore(),b=y+$}),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=c.borderColor,e.lineWidth=1,e.stroke()}const Xr=30;function Nc(e,t,n,o,r){return{x:e+n-Xr,y:Math.max(t,t+o/2-Xr/2),width:Xr,height:Math.min(Xr,o)}}function ps(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,c=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:c,height:i}),o+=26;return n}function cr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function vs(e,t,n,o,r,i,c,l){var P;const d=c.cellHorizontalPadding,f=c.headerIconSize,u=Nc(n,o,r,i);let m=n+d;const g=t.icon===void 0?void 0:{x:m,y:o+(i-f)/2,width:f,height:f},w=g===void 0||t.overlayIcon===void 0?void 0:{x:g.x+9,y:g.y+6,width:18,height:18};g!==void 0&&(m+=Math.ceil(f*1.3));const h=e===void 0?((P=rs(t.title,c.headerFontFull))==null?void 0:P.width)??0:po(t.title,e,c.headerFontFull).width,b=t.hasMenu===!0?35:0,x=t.indicatorIcon!==void 0?f+d:0,k=h+x,y=r-(g!==void 0?Math.ceil(f*1.3)+d:d)-b-d,R=n+(g!==void 0?Math.ceil(f*1.3)+d:d)+(y-k)/2,$={x:Math.max(m,R),y:o,width:h,height:i};let L;t.indicatorIcon!==void 0&&(L={x:$.x+h+d,y:o+(i-f)/2,width:f,height:f});const z=n+r/2;return{menuBounds:cr(u,z,l),iconBounds:cr(g,z,l),iconOverlayBounds:cr(w,z,l),textBounds:cr($,z,l),indicatorIconBounds:cr(L,z,l)}}function Fl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const y=i.rowMarkerChecked;y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=m);const R=i.headerRowMarkerTheme!==void 0?On(l,i.headerRowMarkerTheme):l;Vr(e,R,y,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=c?l.textHeaderSelected:l.textHeader,k=i.hasMenu===!0&&(d||w&&c)&&b.menuBounds!==void 0;if(i.icon!==void 0&&b.iconBounds!==void 0){let y=c?"selected":"normal";i.style==="highlight"&&(y=c?"selected":"special"),g.drawSprite(i.icon,y,e,b.iconBounds.x,b.iconBounds.y,b.iconBounds.width,l),i.overlayIcon!==void 0&&b.iconOverlayBounds!==void 0&&g.drawSprite(i.overlayIcon,c?"selected":"special",e,b.iconOverlayBounds.x,b.iconOverlayBounds.y,b.iconOverlayBounds.width,l)}if(k&&o>35){const R=h?35:o-35,$=h?35*.7:o-35*.7,L=R/o,z=$/o,P=e.createLinearGradient(t,0,t+o,0),Y=bo(x,0);P.addColorStop(h?1:0,x),P.addColorStop(L,x),P.addColorStop(z,Y),P.addColorStop(h?0:1,Y),e.fillStyle=P}else e.fillStyle=x;if(h&&(e.textAlign="right"),b.textBounds!==void 0&&e.fillText(i.title,h?b.textBounds.x+b.textBounds.width:b.textBounds.x,n+r/2+wn(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&b.indicatorIconBounds!==void 0&&(!k||!mr(b.menuBounds.x,b.menuBounds.y,b.menuBounds.width,b.menuBounds.height,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,b.indicatorIconBounds.height))){let y=c?"selected":"normal";i.style==="highlight"&&(y=c?"selected":"special"),g.drawSprite(i.indicatorIcon,y,e,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,l)}if(k&&b.menuBounds!==void 0){const y=b.menuBounds,R=f!==void 0&&u!==void 0&&wo(y,f+t,u+n);if(R||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Ur.Triangle){e.beginPath();const $=y.x+y.width/2-5.5,L=y.y+y.height/2-3;Va(e,[{x:$,y:L},{x:$+11,y:L},{x:$+5.5,y:L+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===Ur.Dots){e.beginPath();const $=y.x+y.width/2,L=y.y+y.height/2;Ka(e,$,L),e.fillStyle=x,e.fill()}else{const $=y.x+(y.width-l.headerIconSize)/2,L=y.y+(y.height-l.headerIconSize)/2;g.drawSprite(i.menuIcon,"normal",e,$,L,l.headerIconSize,l)}R||(e.globalAlpha=1)}}function Cs(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b){const x=Gi(i.title)==="rtl",k=vs(e,i,t,n,o,r,l,x);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:c,hoverAmount:g,isHovered:d,hasSelectedCell:m,spriteManager:w,menuBounds:(k==null?void 0:k.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>Fl(e,t,n,o,r,i,c,l,d,f,u,g,w,b,x,k)):Fl(e,t,n,o,r,i,c,l,d,f,u,g,w,b,x,k)}function Oc(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b,x,k,y){if(k!==void 0||t[t.length-1]!==n[t.length-1])return;const R=gs(x);to(t,d,c,l,i,($,L,z,P,Y)=>{if($!==t[t.length-1])return;L+=$.width;const E=Math.max(L,P);E>o||(e.save(),e.beginPath(),e.rect(E,i+1,1e4,r-i-1),e.clip(),Qr(Y,z,r,f,u,h,b,R,(N,X,W,T)=>{if(!T&&x.length>0&&!x.some(ue=>mr(L,N,1e4,W,ue.x,ue.y,ue.width,ue.height)))return;const H=g.hasIndex(X),ie=w.hasIndex(X);e.beginPath();const V=m==null?void 0:m(X),he=V===void 0?y:On(y,V);he.bgCell!==y.bgCell&&(e.fillStyle=he.bgCell,e.fillRect(L,N,1e4,W)),ie&&(e.fillStyle=he.bgHeader,e.fillRect(L,N,1e4,W)),H&&(e.fillStyle=he.accentLight,e.fillRect(L,N,1e4,W))}),e.restore())})}function Xc(e,t,n,o,r,i,c,l,d){let f=!1;for(const h of t)if(!h.sticky){f=c(h.sourceIndex);break}const u=d.horizontalBorderColor??d.borderColor,m=d.borderColor,g=f?Go(t):0;let w;if(g!==0&&(w=Rl(m,d.bgCell),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=m===u&&w!==void 0?w:Rl(u,d.bgCell),b=yo(i,r,l);e.beginPath(),e.moveTo(0,o-b+.5),e.lineTo(n,o-b+.5),e.strokeStyle=h,e.stroke()}}const xs=(e,t,n)=>{let o=0,r=t,i=0,c=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),c=Math.max(c,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:c}};function Yc(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h){var W;const b=h.bgCell,{minX:x,maxX:k,minY:y,maxY:R}=xs(l,i,c),$=[],L=c-yo(w,g,f);let z=d,P=n,Y=0;for(;z+r<L;){const T=z+r,H=f(P);if(T>=y&&T<=R-1){const ie=u==null?void 0:u(P),V=ie==null?void 0:ie.bgCell;V!==void 0&&V!==b&&P>=w-g&&$.push({x,y:T,w:k-x,h:H,color:V})}z+=H,P<w-g&&(Y=z),P++}let E=0;const N=Math.min(L,R)-Y;if(N>0)for(let T=0;T<t.length;T++){const H=t[T];if(H.width===0)continue;const ie=H.sticky?E:E+o,V=(W=H.themeOverride)==null?void 0:W.bgCell;V!==void 0&&V!==b&&ie>=x&&ie<=k&&m(T+1)&&$.push({x:ie,y:Y,w:H.width,h:N,color:V}),E+=H.width}if($.length===0)return;let X;e.beginPath();for(let T=$.length-1;T>=0;T--){const H=$[T];X===void 0?X=H.color:H.color!==X&&(e.fillStyle=X,e.fill(),e.beginPath(),X=H.color),e.rect(H.x,H.y,H.w,H.h)}X!==void 0&&(e.fillStyle=X,e.fill()),e.beginPath()}function Hl(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b,x,k=!1){if(d!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,c);for(const W of d)e.rect(W.x+1,W.y+1,W.width-1,W.height-1);e.clip("evenodd")}const y=x.horizontalBorderColor??x.borderColor,R=x.borderColor,{minX:$,maxX:L,minY:z,maxY:P}=xs(l,i,c),Y=[];e.beginPath();let E=.5;for(let W=0;W<t.length;W++){const T=t[W];if(T.width===0)continue;E+=T.width;const H=T.sticky?E:E+o;H>=$&&H<=L&&w(W+1)&&Y.push({x1:H,y1:Math.max(f,z),x2:H,y2:Math.min(c,P),color:R})}let N=c+.5;for(let W=b-h;W<b;W++){const T=m(W);N-=T,Y.push({x1:$,y1:N,x2:L,y2:N,color:y})}if(k!==!0){let W=u+.5,T=n;const H=N;for(;W+r<H;){const ie=W+r;if(ie>=z&&ie<=P-1){const V=g==null?void 0:g(T);Y.push({x1:$,y1:ie,x2:L,y2:ie,color:(V==null?void 0:V.horizontalBorderColor)??(V==null?void 0:V.borderColor)??y})}W+=m(T),T++}}const X=ha(Y,W=>W.color);for(const W of Object.keys(X)){e.strokeStyle=W;for(const T of X[W])e.moveTo(T.x1,T.y1),e.lineTo(T.x2,T.y2);e.stroke(),e.beginPath()}d!==void 0&&e.restore()}function Gc(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b,x,k,y){const R=[];e.imageSmoothingEnabled=!1;const $=Math.min(r.cellYOffset,c),L=Math.max(r.cellYOffset,c);let z=0;if(typeof k=="number")z+=(L-$)*k;else for(let H=$;H<L;H++)z+=k(H);c>r.cellYOffset&&(z=-z),z+=d-r.translateY;const P=Math.min(r.cellXOffset,i),Y=Math.max(r.cellXOffset,i);let E=0;for(let H=P;H<Y;H++)E+=b[H].width;i>r.cellXOffset&&(E=-E),E+=l-r.translateX;const N=Go(x);if(E!==0&&z!==0)return{regions:[]};const X=f>0?yo(g,f,k):0,W=u-N-Math.abs(E),T=m-w-X-Math.abs(z)-1;if(W>150&&T>150){const H={sx:0,sy:0,sw:u*h,sh:m*h,dx:0,dy:0,dw:u*h,dh:m*h};if(z>0?(H.sy=(w+1)*h,H.sh=T*h,H.dy=(z+w+1)*h,H.dh=T*h,R.push({x:0,y:w,width:u,height:z+1})):z<0&&(H.sy=(-z+w+1)*h,H.sh=T*h,H.dy=(w+1)*h,H.dh=T*h,R.push({x:0,y:m+z-X,width:u,height:-z+X})),E>0?(H.sx=N*h,H.sw=W*h,H.dx=(E+N)*h,H.dw=W*h,R.push({x:N-1,y:0,width:E+2,height:m})):E<0&&(H.sx=(N-E)*h,H.sw=W*h,H.dx=N*h,H.dw=W*h,R.push({x:u+E,y:0,width:-E,height:m})),e.setTransform(1,0,0,1,0,0),y){if(N>0&&E!==0&&z===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ie=N*h,V=m*h;e.drawImage(t,0,0,ie,V,0,0,ie,V)}if(X>0&&E===0&&z!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ie=(m-X)*h,V=u*h,he=X*h;e.drawImage(t,0,ie,V,he,0,ie,V,he)}}e.drawImage(t,H.sx,H.sy,H.sw,H.sh,H.dx,H.dy,H.dw,H.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:R}}function _c(e,t,n,o,r,i,c,l,d,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||to(d,n,o,r,l,(m,g,w,h)=>{if(m.sourceIndex===f){const b=Math.max(g,h)+1;return u.push({x:b,y:0,width:i-b,height:c}),!0}}),u}function Uc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Xo(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:c,...l}=r,{width:d,...f}=i;if(!Xo(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function Al(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b){const x=h==null?void 0:h.filter(P=>P.style!=="no-outline");if(x===void 0||x.length===0)return;const k=Go(l),y=yo(w,g,m),R=[d,0,l.length,w-g],$=[k,0,t,n-y],L=x.map(P=>{const Y=P.range,E=P.style??"dashed";return Pc(Y,R,t,n,$).map(N=>{const X=N.rect,W=Li(X.x,X.y,t,n,u,f+u,o,r,i,c,w,d,g,l,m),T=X.width===1&&X.height===1?W:Li(X.x+X.width-1,X.y+X.height-1,t,n,u,f+u,o,r,i,c,w,d,g,l,m);return X.x+X.width>=l.length&&(T.width-=1),X.y+X.height>=w&&(T.height-=1),{color:P.color,style:E,clip:N.clip,rect:zc({x:W.x,y:W.y,width:T.x+T.width-W.x,height:T.y+T.height-W.y},t,n,8)}})}),z=()=>{e.lineWidth=1;let P=!1;for(const Y of L)for(const E of Y)if((E==null?void 0:E.rect)!==void 0&&mr(0,0,t,n,E.rect.x,E.rect.y,E.rect.width,E.rect.height)){const N=P,X=!Ac(E.clip,E.rect);e.beginPath(),X&&(e.save(),e.rect(E.clip.x,E.clip.y,E.clip.width,E.clip.height),e.clip()),E.style==="dashed"&&!P?(e.setLineDash([5,3]),P=!0):(E.style==="solid"||E.style==="solid-outline")&&P&&(e.setLineDash([]),P=!1),e.strokeStyle=E.style==="solid-outline"?sn(sn(E.color,b.borderColor),b.bgCell):bo(E.color,1),e.closePath(),e.strokeRect(E.rect.x+.5,E.rect.y+.5,E.rect.width-1,E.rect.height-1),X&&(e.restore(),P=N)}P&&e.setLineDash([])};return z(),z}function zl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Di(e,t,n,o,r,i,c,l,d,f,u,m,g,w,h,b,x){if(u.current===void 0)return;const k=b!==!1&&b!==void 0;if(!k)return;const y=typeof b=="object"?{...Kr,...b}:Kr,R=u.current.range,$=u.current.cell,L=[R.x+R.width-1,R.y+R.height-1];if($[1]>=x&&L[1]>=x||!c.some(V=>V.sourceIndex===$[0]||V.sourceIndex===L[0]))return;const[P,Y]=u.current.cell,E=g(u.current.cell),N=E.span??[P,P],X=Y>=x-w,W=w>0&&!X?yo(x,w,m)-1:0,T=L[1];let H;if(to(c,o,r,i,f,(V,he,ue,ye,ee)=>{if(V.sticky&&P>V.sourceIndex)return;const U=V.sourceIndex<N[0],ve=V.sourceIndex>N[1],te=V.sourceIndex===L[0];if(!(!te&&(U||ve)))return Qr(ee,ue,n,x,m,w,h,void 0,(ge,Ne,K)=>{if(Ne!==Y&&Ne!==T)return;let ne=he,Ae=V.width;if(E.span!==void 0){const de=ws(E.span,he,ge,V.width,K,V,l),Je=V.sticky?de[0]:de[1];Je!==void 0&&(ne=Je.x,Ae=Je.width)}return Ne===T&&te&&k&&(H=()=>{var ze;ye>ne&&!V.sticky&&(e.beginPath(),e.rect(ye,0,t-ye,n),e.clip());const de=y.size,Je=de/2,at=ne+Ae+y.offsetX-Je+.5,ke=ge+K+y.offsetY-Je+.5;e.beginPath(),y.shape==="circle"?e.arc(at+Je,ke+Je,Je,0,Math.PI*2):e.rect(at,ke,de,de),e.fillStyle=((ze=V.themeOverride)==null?void 0:ze.accentColor)??d.accentColor,e.fill(),y.outline>0&&(e.lineWidth=y.outline,e.strokeStyle=d.bgCell,y.shape==="circle"?(e.beginPath(),e.arc(at+Je,ke+Je,Je+y.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(at-y.outline/2,ke-y.outline/2,de+y.outline,de+y.outline))}),H!==void 0}),H!==void 0}),H===void 0)return;const ie=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-W),e.clip(),H==null||H(),e.restore()};return ie(),ie}function Kc(e,t,n,o,r,i,c,l,d){d===void 0||d.size===0||(e.beginPath(),ms(t,n,i,o,(f,u,m,g,w,h)=>{d.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(m,g,w,h)}),to(t,l,i,c,r,(f,u,m,g)=>{const w=Math.max(0,g-u),h=u+w+1,b=f.width-w-1;d.has([f.sourceIndex,-1])&&e.rect(h,o,b,r-o)}),e.clip())}function Vc(e,t,n,o,r,i,c,l,d,f){let u=0;return to(e,i,o,r,n,(m,g,w,h,b)=>(Qr(b,w,t,c,l,d,f,void 0,(x,k,y,R)=>{R||(u=Math.max(k,u))}),!0)),u}function Pl(e,t){var Sn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:c,cellYOffset:l,translateX:d,translateY:f,mappedColumns:u,enableGroups:m,freezeColumns:g,dragAndDropState:w,theme:h,drawFocus:b,headerHeight:x,groupHeaderHeight:k,disabledRows:y,rowHeight:R,verticalBorder:$,overrideCursor:L,isResizing:z,selection:P,fillHandle:Y,freezeTrailingRows:E,rows:N,getCellContent:X,getGroupDetails:W,getRowThemeOverride:T,isFocused:H,drawHeaderCallback:ie,prelightCells:V,drawCellCallback:he,highlightRegions:ue,resizeCol:ye,imageLoader:ee,lastBlitData:U,hoverValues:ve,hyperWrapping:te,hoverInfo:ge,spriteManager:Ne,maxScaleFactor:K,hasAppendRow:ne,touchMode:Ae,enqueue:Ze,renderStateProvider:de,getCellRenderer:Je,renderStrategy:at,bufferACtx:ke,bufferBCtx:ze,damage:He,minimumCellWidth:wt,resizeIndicator:gt}=e;if(r===0||i===0)return;const mt=at==="double-buffer",q=Math.min(K,Math.ceil(window.devicePixelRatio??1)),me=at!=="direct"&&Uc(e,t),Se=n.canvas;(Se.width!==r*q||Se.height!==i*q)&&(Se.width=r*q,Se.height=i*q,Se.style.width=r+"px",Se.style.height=i+"px");const Fe=o.canvas,Me=m?k+x:x,it=Me+1;(Fe.width!==r*q||Fe.height!==it*q)&&(Fe.width=r*q,Fe.height=it*q,Fe.style.width=r+"px",Fe.style.height=it+"px");const et=ke.canvas,ct=ze.canvas;mt&&(et.width!==r*q||et.height!==i*q)&&(et.width=r*q,et.height=i*q,U.current!==void 0&&(U.current.aBufferScroll=void 0)),mt&&(ct.width!==r*q||ct.height!==i*q)&&(ct.width=r*q,ct.height=i*q,U.current!==void 0&&(U.current.bBufferScroll=void 0));const j=U.current;if(me===!0&&c===(j==null?void 0:j.cellXOffset)&&l===(j==null?void 0:j.cellYOffset)&&d===(j==null?void 0:j.translateX)&&f===(j==null?void 0:j.translateY))return;let se=null;mt&&(se=n);const Oe=o;let Ye;mt?He!==void 0?Ye=(j==null?void 0:j.lastBuffer)==="b"?ze:ke:Ye=(j==null?void 0:j.lastBuffer)==="b"?ke:ze:Ye=n;const Et=Ye.canvas,It=mt?Et===et?ct:et:Se,De=typeof R=="number"?()=>R:R;Oe.save(),Ye.save(),Oe.beginPath(),Ye.beginPath(),Oe.textBaseline="middle",Ye.textBaseline="middle",q!==1&&(Oe.scale(q,q),Ye.scale(q,q));const Re=Bi(u,c,r,w,d);let ut=[];const vt=b&&((Sn=P.current)==null?void 0:Sn.cell[1])===l&&f===0;let Ct=!1;if(ue!==void 0){for(const bt of ue)if(bt.style!=="no-outline"&&bt.range.y===l&&f===0){Ct=!0;break}}const Nt=()=>{Wc(Oe,Re,m,ge,r,d,x,k,w,z,P,h,Ne,ve,$,W,He,ie,Ae),Hl(Oe,Re,l,d,f,r,i,void 0,void 0,k,Me,De,T,$,E,N,h,!0),Oe.beginPath(),Oe.moveTo(0,it-.5),Oe.lineTo(r,it-.5),Oe.strokeStyle=sn(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),Oe.stroke(),Ct&&Al(Oe,r,i,c,l,d,f,u,g,x,k,R,E,N,ue,h),vt&&Di(Oe,r,i,l,d,f,Re,u,h,Me,P,De,X,E,ne,Y,N)};if(He!==void 0){const bt=Re[Re.length-1].sourceIndex+1,ft=He.hasItemInRegion([{x:c,y:-2,width:bt,height:2},{x:c,y:l,width:bt,height:300},{x:0,y:l,width:g,height:300},{x:0,y:-2,width:g,height:2},{x:c,y:N-E,width:bt,height:E,when:E>0}]),Ge=Bt=>{Tl(Bt,Re,u,i,Me,d,f,l,N,De,X,W,T,y,H,b,E,ne,ut,He,P,V,ue,ee,Ne,ve,ge,he,te,h,Ze,de,Je,L,wt);const Qt=P.current;Y!==!1&&Y!==void 0&&b&&Qt!==void 0&&He.has(ts(Qt.range))&&Di(Bt,r,i,l,d,f,Re,u,h,Me,P,De,X,E,ne,Y,N)};ft&&(Ge(Ye),se!==null&&(se.save(),se.scale(q,q),se.textBaseline="middle",Ge(se),se.restore()),He.hasHeader()&&(Kc(Oe,Re,r,k,Me,d,f,l,He),Nt())),Ye.restore(),Oe.restore();return}if((me!==!0||c!==(j==null?void 0:j.cellXOffset)||d!==(j==null?void 0:j.translateX)||vt!==(j==null?void 0:j.mustDrawFocusOnHeader)||Ct!==(j==null?void 0:j.mustDrawHighlightRingsOnHeader))&&Nt(),me===!0){ln(It!==void 0&&j!==void 0);const{regions:bt}=Gc(Ye,It,It===et?j.aBufferScroll:j.bBufferScroll,It===et?j.bBufferScroll:j.aBufferScroll,j,c,l,d,f,E,r,i,N,Me,q,u,Re,R,mt);ut=bt}else me!==!1&&(ln(j!==void 0),ut=_c(j,c,l,d,f,r,i,Me,Re,me));Xc(Ye,Re,r,i,E,N,$,De,h);const Pt=Al(Ye,r,i,c,l,d,f,u,g,x,k,R,E,N,ue,h),bn=b?Di(Ye,r,i,l,d,f,Re,u,h,Me,P,De,X,E,ne,Y,N):void 0;if(Ye.fillStyle=h.bgCell,ut.length>0){Ye.beginPath();for(const bt of ut)Ye.rect(bt.x,bt.y,bt.width,bt.height);Ye.clip(),Ye.fill(),Ye.beginPath()}else Ye.fillRect(0,0,r,i);const cn=Tl(Ye,Re,u,i,Me,d,f,l,N,De,X,W,T,y,H,b,E,ne,ut,He,P,V,ue,ee,Ne,ve,ge,he,te,h,Ze,de,Je,L,wt);Oc(Ye,Re,u,r,i,Me,d,f,l,N,De,T,P.rows,y,E,ne,ut,He,h),Yc(Ye,Re,l,d,f,r,i,ut,Me,De,T,$,E,N,h),Hl(Ye,Re,l,d,f,r,i,ut,cn,k,Me,De,T,$,E,N,h),Pt==null||Pt(),bn==null||bn(),z&&gt!=="none"&&to(Re,0,d,0,Me,(bt,ft)=>bt.sourceIndex===ye?(zl(Oe,ft+bt.width,0,Me+1,sn(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),gt==="full"&&zl(Ye,ft+bt.width,Me,i,sn(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),se!==null&&(se.fillStyle=h.bgCell,se.fillRect(0,0,r,i),se.drawImage(Ye.canvas,0,0));const Dt=Vc(Re,i,Me,d,f,l,N,De,E,ne);ee==null||ee.setWindow({x:c,y:l,width:Re.length,height:Dt-l},g,Array.from({length:E},(bt,ft)=>N-1-ft));const qt=j!==void 0&&(c!==j.cellXOffset||d!==j.translateX),Xt=j!==void 0&&(l!==j.cellYOffset||f!==j.translateY);U.current={cellXOffset:c,cellYOffset:l,translateX:d,translateY:f,mustDrawFocusOnHeader:vt,mustDrawHighlightRingsOnHeader:Ct,lastBuffer:mt?Et===et?"a":"b":void 0,aBufferScroll:Et===et?[qt,Xt]:j==null?void 0:j.aBufferScroll,bBufferScroll:Et===ct?[qt,Xt]:j==null?void 0:j.bBufferScroll},Ye.restore(),Oe.restore()}const qc=80;function jc(e){const t=e-1;return t*t*t+1}class Zc{constructor(t){Le(this,"callback");Le(this,"currentHoveredItem");Le(this,"leavingItems",[]);Le(this,"lastAnimationTime");Le(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>ur(o.item,t.item))||this.leavingItems.push(t)});Le(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>ur(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Le(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Le(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Le(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:jc(t.hoverAmount)})));Le(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/qc;for(const i of this.leavingItems)i.hoverAmount=mn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=mn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Le(this,"setHovered",t=>{var n;if(!ur((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Jc{constructor(t){Le(this,"fn");Le(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function qi(e){return new Jc(e)}const Qc=qi(()=>window.navigator.userAgent.includes("Firefox")),qr=qi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),jr=qi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function ed(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(c),c=()=>{const l=t.current.map(Vi);t.current=[],o.current(new Oo(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:c)},[]);return s.useCallback(i=>{t.current.length===0&&r();const c=kn(i[0],i[1]);t.current.includes(c)||t.current.push(c)},[r])}const eo="header",xn="group-header",Zr="out-of-bounds";var No;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(No||(No={}));function ks(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const td=(e,t)=>{if(e.kind===Q.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},nd=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:c,cellYOffset:l,headerHeight:d,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:m,rows:g,getCellContent:w,getRowThemeOverride:h,onHeaderMenuClick:b,onHeaderIndicatorClick:x,enableGroups:k,isFilling:y,onCanvasFocused:R,onCanvasBlur:$,isFocused:L,selection:z,freezeColumns:P,onContextMenu:Y,freezeTrailingRows:E,fixedShadowX:N=!0,fixedShadowY:X=!0,drawFocusRing:W,onMouseDown:T,onMouseUp:H,onMouseMoveRaw:ie,onMouseMove:V,onItemHovered:he,dragAndDropState:ue,firstColAccessible:ye,onKeyDown:ee,onKeyUp:U,highlightRegions:ve,canvasRef:te,onDragStart:ge,onDragEnd:Ne,eventTargetRef:K,isResizing:ne,resizeColumn:Ae,isDragging:Ze,isDraggable:de=!1,allowResize:Je,disabledRows:at,hasAppendRow:ke,getGroupDetails:ze,theme:He,prelightCells:wt,headerIcons:gt,verticalBorder:mt,drawCell:q,drawHeader:me,onCellFocused:Se,onDragOverCell:Fe,onDrop:Me,onDragLeave:it,imageWindowLoader:et,smoothScrollX:ct=!1,smoothScrollY:j=!1,experimental:se,getCellRenderer:Oe,resizeIndicator:Ye="full"}=e,Et=e.translateX??0,It=e.translateY??0,De=Math.max(P,Math.min(i.length-1,c)),Re=s.useRef(null),ut=s.useRef((se==null?void 0:se.eventTarget)??window),vt=ut.current,Ct=et,Nt=s.useRef(),[Pt,bn]=s.useState(!1),cn=s.useRef([]),Dt=s.useRef(),[qt,Xt]=s.useState(),[Sn,bt]=s.useState(),ft=s.useRef(null),[Ge,Bt]=s.useState(),[Qt,Mn]=s.useState(!1),zn=s.useRef(Qt);zn.current=Qt;const Gt=s.useMemo(()=>new Fc(gt,()=>{Co.current=void 0,no.current()}),[gt]),yn=k?u+d:d,Te=s.useRef(-1),nt=((se==null?void 0:se.enableFirefoxRescaling)??!1)&&Qc.value,tt=((se==null?void 0:se.enableSafariRescaling)??!1)&&qr.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!nt&&!tt||(Te.current!==-1&&bn(!0),window.clearTimeout(Te.current),Te.current=window.setTimeout(()=>{bn(!1),Te.current=-1},200))},[l,De,Et,It,nt,tt]);const Ue=Pa(i,P),Ot=s.useMemo(()=>N?Go(Ue,ue):0,[Ue,ue,N]),_e=s.useCallback((M,_,re)=>{const le=M.getBoundingClientRect();if(_>=Ue.length||re>=g)return;const J=le.width/n,v=Li(_,re,n,o,u,yn,De,l,Et,It,g,P,E,Ue,m);return J!==1&&(v.x*=J,v.y*=J,v.width*=J,v.height*=J),v.x+=le.x,v.y+=le.y,v},[n,o,u,yn,De,l,Et,It,g,P,E,Ue,m]),Ke=s.useCallback((M,_,re,le)=>{const J=M.getBoundingClientRect(),v=J.width/n,ae=(_-J.left)/v,Pe=(re-J.top)/v,we=5,At=Bi(Ue,De,n,void 0,Et);let pe=0,lt=0;const yt=typeof PointerEvent<"u"&&le instanceof PointerEvent&&le.pointerType==="mouse"||typeof MouseEvent<"u"&&le instanceof MouseEvent,D=typeof PointerEvent<"u"&&le instanceof PointerEvent&&le.pointerType==="touch"||typeof TouchEvent<"u"&&le instanceof TouchEvent;yt&&(pe=le.button,lt=le.buttons);const Ve=$a(ae,At,Et),qe=Na(Pe,o,k,d,u,g,m,l,It,E),zt=(le==null?void 0:le.shiftKey)===!0,pn=(le==null?void 0:le.ctrlKey)===!0,nn=(le==null?void 0:le.metaKey)===!0,xt=[ae<0?-1:n<ae?1:0,Pe<yn?-1:o<Pe?1:0];let _t;if(Ve===-1||Pe<0||ae<0||qe===void 0||ae>n||Pe>o){const ht=ae>n?1:ae<0?-1:0,Fn=Pe>o?1:Pe<0?-1:0;let dn=ht*2,Zo=Fn*2;ht===0&&(dn=Ve===-1?No.EndPadding:No.Center),Fn===0&&(Zo=qe===void 0?No.EndPadding:No.Center);let Ut=!1;if(Ve===-1&&qe===-1){const Tt=_e(M,Ue.length-1,-1);ln(Tt!==void 0),Ut=_<Tt.x+Tt.width+we}const kt=ae>n&&ae<n+Pi()||Pe>o&&Pe<o+Pi();_t={kind:Zr,location:[Ve!==-1?Ve:ae<0?0:Ue.length-1,qe??g-1],region:[dn,Zo],shiftKey:zt,ctrlKey:pn,metaKey:nn,isEdge:Ut,isTouch:D,button:pe,buttons:lt,scrollEdge:xt,isMaybeScrollbar:kt}}else if(qe<=-1){let ht=_e(M,Ve,qe);ln(ht!==void 0);let Fn=ht!==void 0&&ht.x+ht.width-_<=we;const dn=Ve-1;_-ht.x<=we&&dn>=0?(Fn=!0,ht=_e(M,dn,qe),ln(ht!==void 0),_t={kind:k&&qe===-2?xn:eo,location:[dn,qe],bounds:ht,group:Ue[dn].group??"",isEdge:Fn,shiftKey:zt,ctrlKey:pn,metaKey:nn,isTouch:D,localEventX:_-ht.x,localEventY:re-ht.y,button:pe,buttons:lt,scrollEdge:xt}):_t={kind:k&&qe===-2?xn:eo,group:Ue[Ve].group??"",location:[Ve,qe],bounds:ht,isEdge:Fn,shiftKey:zt,ctrlKey:pn,metaKey:nn,isTouch:D,localEventX:_-ht.x,localEventY:re-ht.y,button:pe,buttons:lt,scrollEdge:xt}}else{const ht=_e(M,Ve,qe);ln(ht!==void 0);const Fn=ht!==void 0&&ht.x+ht.width-_<we;let dn=!1;if(f!==!1&&f!==void 0&&z.current!==void 0){const Ut=typeof f=="object"?{...Kr,...f}:Kr,kt=Ut.size,Tt=kt/2,Ft=ts(z.current.range),Ht=_e(M,Ft[0],Ft[1]);if(Ht!==void 0){const Jo=Ht.x+Ht.width+Ut.offsetX-Tt+.5,di=Ht.y+Ht.height+Ut.offsetY-Tt+.5;dn=Math.abs(Jo-_)<kt&&Math.abs(di-re)<kt}}_t={kind:"cell",location:[Ve,qe],bounds:ht,isEdge:Fn,shiftKey:zt,ctrlKey:pn,isFillHandle:dn,metaKey:nn,isTouch:D,localEventX:_-ht.x,localEventY:re-ht.y,button:pe,buttons:lt,scrollEdge:xt}}return _t},[n,Ue,De,Et,o,k,d,u,g,m,l,It,E,_e,f,z,yn]),[Pn]=qt??[],wr=s.useRef(()=>{}),Xn=s.useRef(qt);Xn.current=qt;const[Bn,Ln]=s.useMemo(()=>{const M=document.createElement("canvas"),_=document.createElement("canvas");return M.style.display="none",M.style.opacity="0",M.style.position="fixed",_.style.display="none",_.style.opacity="0",_.style.position="fixed",[M.getContext("2d",{alpha:!1}),_.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Bn===null||Ln===null))return document.documentElement.append(Bn.canvas),document.documentElement.append(Ln.canvas),()=>{Bn.canvas.remove(),Ln.canvas.remove()}},[Bn,Ln]);const vo=s.useMemo(()=>new qa,[]),br=nt&&Pt?1:tt&&Pt?2:5,Yn=(se==null?void 0:se.disableMinimumCellWidth)===!0?1:10,Co=s.useRef(),xo=s.useRef(null),ko=s.useRef(null),So=s.useCallback(()=>{var ae;const M=Re.current,_=ft.current;if(M===null||_===null||(xo.current===null&&(xo.current=M.getContext("2d",{alpha:!1}),M.width=0,M.height=0),ko.current===null&&(ko.current=_.getContext("2d",{alpha:!1}),_.width=0,_.height=0),xo.current===null||ko.current===null||Bn===null||Ln===null))return;let re=!1;const le=Pe=>{re=!0,Bt(Pe)},J=Co.current,v={headerCanvasCtx:ko.current,canvasCtx:xo.current,bufferACtx:Bn,bufferBCtx:Ln,width:n,height:o,cellXOffset:De,cellYOffset:l,translateX:Math.round(Et),translateY:Math.round(It),mappedColumns:Ue,enableGroups:k,freezeColumns:P,dragAndDropState:ue,theme:He,headerHeight:d,groupHeaderHeight:u,disabledRows:at??rt.empty(),rowHeight:m,verticalBorder:mt,isResizing:ne,resizeCol:Ae,isFocused:L,selection:z,fillHandle:f,drawCellCallback:q,hasAppendRow:ke,overrideCursor:le,maxScaleFactor:br,freezeTrailingRows:E,rows:g,drawFocus:W,getCellContent:w,getGroupDetails:ze??(Pe=>({name:Pe})),getRowThemeOverride:h,drawHeaderCallback:me,prelightCells:wt,highlightRegions:ve,imageLoader:Ct,lastBlitData:Dt,damage:Nt.current,hoverValues:cn.current,hoverInfo:Xn.current,spriteManager:Gt,scrolling:Pt,hyperWrapping:(se==null?void 0:se.hyperWrapping)??!1,touchMode:Qt,enqueue:wr.current,renderStateProvider:vo,renderStrategy:(se==null?void 0:se.renderStrategy)??(qr.value?"double-buffer":"single-buffer"),getCellRenderer:Oe,minimumCellWidth:Yn,resizeIndicator:Ye};v.damage===void 0?(Co.current=v,Pl(v,J)):Pl(v,void 0),!re&&(v.damage===void 0||v.damage.has((ae=Xn==null?void 0:Xn.current)==null?void 0:ae[0]))&&Bt(void 0)},[Bn,Ln,n,o,De,l,Et,It,Ue,k,P,ue,He,d,u,at,m,mt,ne,ke,Ae,L,z,f,E,g,W,br,w,ze,h,q,me,wt,ve,Ct,Gt,Pt,se==null?void 0:se.hyperWrapping,se==null?void 0:se.renderStrategy,Qt,vo,Oe,Yn,Ye]),no=s.useRef(So);s.useLayoutEffect(()=>{So(),no.current=So},[So]),s.useLayoutEffect(()=>{(async()=>{var _;((_=document==null?void 0:document.fonts)==null?void 0:_.ready)!==void 0&&(await document.fonts.ready,Co.current=void 0,no.current())})()},[]);const Wn=s.useCallback(M=>{Nt.current=M,no.current(),Nt.current=void 0},[]),ei=ed(Wn);wr.current=ei;const yr=s.useCallback(M=>{Wn(new Oo(M.map(_=>_.cell)))},[Wn]);Ct.setCallback(Wn);const[ti,ni]=s.useState(!1),[Rn,Gn]=Pn??[],oi=Rn!==void 0&&Gn===-1&&Rn>=0&&Rn<Ue.length&&Ue[Rn].headerRowMarkerDisabled!==!0,ri=Rn!==void 0&&Gn===-2;let Mo=!1,pr=!1,oo=Ge;if(oo===void 0&&Rn!==void 0&&Gn!==void 0&&Gn>-1&&Gn<g){const M=w([Rn,Gn],!0);Mo=M.kind===$t.NewRow||M.kind===$t.Marker&&M.markerKind!=="number",pr=M.kind===Q.Boolean&&Xi(M),oo=M.cursor}const vr=Ze?"grabbing":(Sn??!1)||ne?"col-resize":ti||y?"crosshair":oo!==void 0?oo:oi||Mo||pr||ri?"pointer":"default",En=s.useMemo(()=>({contain:"strict",display:"block",cursor:vr}),[vr]),ro=s.useRef("default"),_n=K==null?void 0:K.current;_n!=null&&ro.current!==En.cursor&&(_n.style.cursor=ro.current=En.cursor);const io=s.useCallback((M,_,re,le)=>{if(ze===void 0)return;const J=ze(M);if(J.actions!==void 0){const v=ps(_,J.actions);for(const[ae,Pe]of v.entries())if(wo(Pe,re+_.x,le+Pe.y))return J.actions[ae]}},[ze]),Ce=s.useCallback((M,_,re,le)=>{const J=Ue[_];if(!Ze&&!ne&&!(Sn??!1)){const v=_e(M,_,-1);ln(v!==void 0);const ae=vs(void 0,J,v.x,v.y,v.width,v.height,He,Gi(J.title)==="rtl");if(J.hasMenu===!0&&ae.menuBounds!==void 0&&wo(ae.menuBounds,re,le))return{area:"menu",bounds:ae.menuBounds};if(J.indicatorIcon!==void 0&&ae.indicatorIconBounds!==void 0&&wo(ae.indicatorIconBounds,re,le))return{area:"indicator",bounds:ae.indicatorIconBounds}}},[Ue,_e,Sn,Ze,ne,He]),_o=s.useRef(0),In=s.useRef(),en=s.useRef(!1),jt=s.useCallback(M=>{const _=Re.current,re=K==null?void 0:K.current;if(_===null||M.target!==_&&M.target!==re)return;en.current=!0;const le=M.clientX,J=M.clientY;if(M.target===re&&re!==null){const ae=re.getBoundingClientRect();if(le>ae.right||J>ae.bottom)return}const v=Ke(_,le,J,M);In.current=v.location,v.isTouch&&(_o.current=Date.now()),zn.current!==v.isTouch&&Mn(v.isTouch),!(v.kind===eo&&Ce(_,v.location[0],le,J)!==void 0)&&(v.kind===xn&&io(v.group,v.bounds,v.localEventX,v.localEventY)!==void 0||(T==null||T(v),!v.isTouch&&de!==!0&&de!==v.kind&&v.button<3&&v.button!==1&&M.preventDefault()))},[K,de,Ke,io,Ce,T]);Vt("pointerdown",jt,vt,!1);const Cr=s.useRef(0),Uo=s.useCallback(M=>{var lt,yt;const _=Cr.current;Cr.current=Date.now();const re=Re.current;if(en.current=!1,H===void 0||re===null)return;const le=K==null?void 0:K.current,J=M.target!==re&&M.target!==le,v=M.clientX,ae=M.clientY,Pe=M.pointerType==="mouse"?M.button<3:!0;let we=Ke(re,v,ae,M);we.isTouch&&_o.current!==0&&Date.now()-_o.current>500&&(we={...we,isLongTouch:!0}),_!==0&&Date.now()-_<(we.isTouch?1e3:500)&&(we={...we,isDoubleClick:!0}),zn.current!==we.isTouch&&Mn(we.isTouch),!J&&M.cancelable&&Pe&&M.preventDefault();const[At]=we.location,pe=Ce(re,At,v,ae);if(we.kind===eo&&pe!==void 0){(we.button!==0||((lt=In.current)==null?void 0:lt[0])!==At||((yt=In.current)==null?void 0:yt[1])!==-1)&&H(we,!0);return}else if(we.kind===xn){const D=io(we.group,we.bounds,we.localEventX,we.localEventY);if(D!==void 0){we.button===0&&D.onClick(we);return}}H(we,J)},[H,K,Ke,Ce,io]);Vt("pointerup",Uo,vt,!1);const Ko=s.useCallback(M=>{var At,pe;const _=Re.current;if(_===null)return;const re=K==null?void 0:K.current,le=M.target!==_&&M.target!==re;let J,v,ae=!0;M instanceof MouseEvent?(J=M.clientX,v=M.clientY,ae=M.button<3):(J=M.changedTouches[0].clientX,v=M.changedTouches[0].clientY);const Pe=Ke(_,J,v,M);zn.current!==Pe.isTouch&&Mn(Pe.isTouch),!le&&M.cancelable&&ae&&M.preventDefault();const[we]=Pe.location;if(Pe.kind===eo){const lt=Ce(_,we,J,v);lt!==void 0&&Pe.button===0&&((At=In.current)==null?void 0:At[0])===we&&((pe=In.current)==null?void 0:pe[1])===-1&&(lt.area==="menu"?b==null||b(we,lt.bounds):lt.area==="indicator"&&(x==null||x(we,lt.bounds)))}},[K,Ke,Ce,b,x]);Vt("click",Ko,vt,!1);const Vo=s.useCallback(M=>{const _=Re.current,re=K==null?void 0:K.current;if(_===null||M.target!==_&&M.target!==re||Y===void 0)return;const le=Ke(_,M.clientX,M.clientY,M);Y(le,()=>{M.cancelable&&M.preventDefault()})},[K,Ke,Y]);Vt("contextmenu",Vo,(K==null?void 0:K.current)??null,!1);const qo=s.useCallback(M=>{Nt.current=new Oo(M.map(_=>_.item)),cn.current=M,no.current(),Nt.current=void 0},[]),lo=s.useMemo(()=>new Zc(qo),[qo]),$n=s.useRef(lo);$n.current=lo,s.useLayoutEffect(()=>{const M=$n.current;if(Pn===void 0||Pn[1]<0){M.setHovered(Pn);return}const _=w(Pn,!0),re=Oe(_),le=re===void 0&&_.kind===Q.Custom||(re==null?void 0:re.needsHover)!==void 0&&(typeof re.needsHover=="boolean"?re.needsHover:re.needsHover(_));M.setHovered(le?Pn:void 0)},[w,Oe,Pn]);const xr=s.useRef(),kr=s.useCallback(M=>{var Pe;const _=Re.current;if(_===null)return;const re=K==null?void 0:K.current,le=M.target!==_&&M.target!==re,J=Ke(_,M.clientX,M.clientY,M);if(J.kind!=="out-of-bounds"&&le&&!en.current&&!J.isTouch)return;const v=(we,At)=>{Xt(pe=>pe===we||(pe==null?void 0:pe[0][0])===(we==null?void 0:we[0][0])&&(pe==null?void 0:pe[0][1])===(we==null?void 0:we[0][1])&&((pe==null?void 0:pe[1][0])===(we==null?void 0:we[1][0])&&(pe==null?void 0:pe[1][1])===(we==null?void 0:we[1][1])||!At)?pe:we)};if(!ks(J,xr.current))Bt(void 0),he==null||he(J),v(J.kind===Zr?void 0:[J.location,[J.localEventX,J.localEventY]],!0),xr.current=J;else if(J.kind==="cell"||J.kind===eo||J.kind===xn){let we=!1,At=!0;if(J.kind==="cell"){const lt=w(J.location);At=((Pe=Oe(lt))==null?void 0:Pe.needsHoverPosition)??lt.kind===Q.Custom,we=At}else we=!0;const pe=[J.location,[J.localEventX,J.localEventY]];v(pe,At),Xn.current=pe,we&&Wn(new Oo([J.location]))}const ae=J.location[0]>=(ye?0:1);bt(J.kind===eo&&J.isEdge&&ae&&Je===!0),ni(J.kind==="cell"&&J.isFillHandle),ie==null||ie(M),V(J)},[K,Ke,ye,Je,ie,V,he,w,Oe,Wn]);Vt("pointermove",kr,vt,!0);const Ro=s.useCallback(M=>{const _=Re.current;if(_===null)return;let re,le;z.current!==void 0&&(re=_e(_,z.current.cell[0],z.current.cell[1]),le=z.current.cell),ee==null||ee({bounds:re,stopPropagation:()=>M.stopPropagation(),preventDefault:()=>M.preventDefault(),cancel:()=>{},ctrlKey:M.ctrlKey,metaKey:M.metaKey,shiftKey:M.shiftKey,altKey:M.altKey,key:M.key,keyCode:M.keyCode,rawEvent:M,location:le})},[ee,z,_e]),li=s.useCallback(M=>{const _=Re.current;if(_===null)return;let re,le;z.current!==void 0&&(re=_e(_,z.current.cell[0],z.current.cell[1]),le=z.current.cell),U==null||U({bounds:re,stopPropagation:()=>M.stopPropagation(),preventDefault:()=>M.preventDefault(),cancel:()=>{},ctrlKey:M.ctrlKey,metaKey:M.metaKey,shiftKey:M.shiftKey,altKey:M.altKey,key:M.key,keyCode:M.keyCode,rawEvent:M,location:le})},[U,z,_e]),Sr=s.useCallback(M=>{if(Re.current=M,te!==void 0&&(te.current=M),se!=null&&se.eventTarget)ut.current=se.eventTarget;else if(M===null)ut.current=window;else{const _=M.getRootNode();_===document&&(ut.current=window),ut.current=_}},[te,se==null?void 0:se.eventTarget]),Eo=s.useCallback(M=>{const _=Re.current;if(_===null||de===!1||ne){M.preventDefault();return}let re,le;const J=Ke(_,M.clientX,M.clientY);if(de!==!0&&J.kind!==de){M.preventDefault();return}const v=(lt,yt)=>{re=lt,le=yt};let ae,Pe,we;const At=(lt,yt,D)=>{ae=lt,Pe=yt,we=D};let pe=!1;if(ge==null||ge({...J,setData:v,setDragImage:At,preventDefault:()=>pe=!0,defaultPrevented:()=>pe}),!pe&&re!==void 0&&le!==void 0&&M.dataTransfer!==null)if(M.dataTransfer.setData(re,le),M.dataTransfer.effectAllowed="copyLink",ae!==void 0&&Pe!==void 0&&we!==void 0)M.dataTransfer.setDragImage(ae,Pe,we);else{const[lt,yt]=J.location;if(yt!==void 0){const D=document.createElement("canvas"),Ve=_e(_,lt,yt);ln(Ve!==void 0);const qe=Math.ceil(window.devicePixelRatio??1);D.width=Ve.width*qe,D.height=Ve.height*qe;const zt=D.getContext("2d");zt!==null&&(zt.scale(qe,qe),zt.textBaseline="middle",yt===-1?(zt.font=He.headerFontFull,zt.fillStyle=He.bgHeader,zt.fillRect(0,0,D.width,D.height),Cs(zt,0,0,Ve.width,Ve.height,Ue[lt],!1,He,!1,void 0,void 0,!1,0,Gt,me,!1)):(zt.font=He.baseFontFull,zt.fillStyle=He.bgCell,zt.fillRect(0,0,D.width,D.height),ys(zt,w([lt,yt]),0,yt,!1,!1,0,0,Ve.width,Ve.height,!1,He,He.bgCell,Ct,Gt,1,void 0,!1,0,void 0,void 0,void 0,vo,Oe,()=>{},0))),D.style.left="-100%",D.style.position="absolute",D.style.width=`${Ve.width}px`,D.style.height=`${Ve.height}px`,document.body.append(D),M.dataTransfer.setDragImage(D,Ve.width/2,Ve.height/2),window.setTimeout(()=>{D.remove()},0)}}else M.preventDefault()},[de,ne,Ke,ge,_e,He,Ue,Gt,me,w,Ct,vo,Oe]);Vt("dragstart",Eo,(K==null?void 0:K.current)??null,!1,!1);const Dn=s.useRef(),Io=s.useCallback(M=>{const _=Re.current;if(Me!==void 0&&M.preventDefault(),_===null||Fe===void 0)return;const re=Ke(_,M.clientX,M.clientY),[le,J]=re.location,v=le-(ye?0:1),[ae,Pe]=Dn.current??[];(ae!==v||Pe!==J)&&(Dn.current=[v,J],Fe([v,J],M.dataTransfer))},[ye,Ke,Fe,Me]);Vt("dragover",Io,(K==null?void 0:K.current)??null,!1,!1);const si=s.useCallback(()=>{Dn.current=void 0,Ne==null||Ne()},[Ne]);Vt("dragend",si,(K==null?void 0:K.current)??null,!1,!1);const Mr=s.useCallback(M=>{const _=Re.current;if(_===null||Me===void 0)return;M.preventDefault();const re=Ke(_,M.clientX,M.clientY),[le,J]=re.location,v=le-(ye?0:1);Me([v,J],M.dataTransfer)},[ye,Ke,Me]);Vt("drop",Mr,(K==null?void 0:K.current)??null,!1,!1);const Ee=s.useCallback(()=>{it==null||it()},[it]);Vt("dragleave",Ee,(K==null?void 0:K.current)??null,!1,!1);const Do=s.useRef(z);Do.current=z;const To=s.useRef(null),tn=s.useCallback(M=>{var _;Re.current===null||!Re.current.contains(document.activeElement)||(M===null&&Do.current.current!==void 0?(_=te==null?void 0:te.current)==null||_.focus({preventScroll:!0}):M!==null&&M.focus({preventScroll:!0}),To.current=M)},[te]);s.useImperativeHandle(t,()=>({focus:()=>{var _;const M=To.current;M===null||!document.contains(M)?(_=te==null?void 0:te.current)==null||_.focus({preventScroll:!0}):M.focus({preventScroll:!0})},getBounds:(M,_)=>{if(!(te===void 0||te.current===null))return _e(te.current,M??0,_??-1)},damage:yr,getMouseArgsForPosition:(M,_,re)=>{if(!(te===void 0||te.current===null))return Ke(te.current,M,_,re)}}),[te,yr,_e,Ke]);const jo=s.useRef(),Tn=xa(()=>{var Pe,we,At;if(n<50||(se==null?void 0:se.disableAccessibilityTree)===!0)return null;let M=Bi(Ue,De,n,ue,Et);const _=ye?0:-1;!ye&&((Pe=M[0])==null?void 0:Pe.sourceIndex)===0&&(M=M.slice(1));const[re,le]=((we=z.current)==null?void 0:we.cell)??[],J=(At=z.current)==null?void 0:At.range,v=M.map(pe=>pe.sourceIndex),ae=mo(l,Math.min(g,l+r));return re!==void 0&&le!==void 0&&!(v.includes(re)&&ae.includes(le))&&tn(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":g+1,"aria-multiselectable":"true","aria-colcount":Ue.length+_},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},M.map(pe=>s.createElement("th",{role:"columnheader","aria-selected":z.columns.hasIndex(pe.sourceIndex),"aria-colindex":pe.sourceIndex+1+_,tabIndex:-1,onFocus:lt=>{if(lt.target!==To.current)return Se==null?void 0:Se([pe.sourceIndex,-1])},key:pe.sourceIndex},pe.title)))),s.createElement("tbody",{role:"rowgroup"},ae.map(pe=>s.createElement("tr",{role:"row","aria-selected":z.rows.hasIndex(pe),key:pe,"aria-rowindex":pe+2},M.map(lt=>{const yt=lt.sourceIndex,D=kn(yt,pe),Ve=re===yt&&le===pe,qe=J!==void 0&&yt>=J.x&&yt<J.x+J.width&&pe>=J.y&&pe<J.y+J.height,zt=`glide-cell-${yt}-${pe}`,pn=[yt,pe],nn=w(pn,!0);return s.createElement("td",{key:D,role:"gridcell","aria-colindex":yt+1+_,"aria-selected":qe,"aria-readonly":$o(nn)||!Wo(nn),id:zt,"data-testid":zt,onClick:()=>{const xt=te==null?void 0:te.current;if(xt!=null)return ee==null?void 0:ee({bounds:_e(xt,yt,pe),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:pn})},onFocusCapture:xt=>{var _t,ht;if(!(xt.target===To.current||((_t=jo.current)==null?void 0:_t[0])===yt&&((ht=jo.current)==null?void 0:ht[1])===pe))return jo.current=pn,Se==null?void 0:Se(pn)},ref:Ve?tn:void 0,tabIndex:-1},td(nn,Oe))})))))},[n,Ue,De,ue,Et,g,l,r,z,tn,w,te,ee,_e,Se],200),Un=P===0||!N?0:De>P?1:mn(-Et/100,0,1),Rr=-l*32+It,so=X?mn(-Rr/100,0,1):0,ai=s.useMemo(()=>{if(!Un&&!so)return null;const M={position:"absolute",top:0,left:Ot,width:n-Ot,height:o,opacity:Un,pointerEvents:"none",transition:ct?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},_={position:"absolute",top:yn,left:0,width:n,height:o,opacity:so,pointerEvents:"none",transition:j?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,Un>0&&s.createElement("div",{id:"shadow-x",style:M}),so>0&&s.createElement("div",{id:"shadow-y",style:_}))},[Un,so,Ot,n,ct,yn,o,j]),ci=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Ro,onKeyUp:li,onFocus:R,onBlur:$,ref:Sr,style:En},Tn),s.createElement("canvas",{ref:ft,style:ci}),ai)},od=s.memo(s.forwardRef(nd));function dr(e,t,n,o){return mn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const rd=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,c]=s.useState(),[l,d]=s.useState(),[f,u]=s.useState(!1),[m,g]=s.useState(),[w,h]=s.useState(),[b,x]=s.useState(),[k,y]=s.useState(!1),[R,$]=s.useState(),{onHeaderMenuClick:L,onHeaderIndicatorClick:z,getCellContent:P,onColumnMoved:Y,onColumnResize:E,onColumnResizeStart:N,onColumnResizeEnd:X,gridRef:W,maxColumnWidth:T,minColumnWidth:H,onRowMoved:ie,lockColumns:V,onColumnProposeMove:he,onMouseDown:ue,onMouseUp:ye,onItemHovered:ee,onDragStart:U,canvasRef:ve}=e,te=(E??X??N)!==void 0,{columns:ge,selection:Ne}=e,K=Ne.columns,ne=s.useCallback(q=>{const[me,Se]=q.location;i!==void 0&&l!==me&&me>=V?(u(!0),d(me)):w!==void 0&&Se!==void 0?(y(!0),x(Math.max(0,Se))):o===void 0&&!f&&!k&&(ee==null||ee(q))},[i,w,l,ee,V,o,f,k]),Ae=Y!==void 0,Ze=s.useCallback(q=>{var me;if(q.button===0){const[Se,Fe]=q.location;if(q.kind==="out-of-bounds"&&q.isEdge&&te){const Me=(me=W==null?void 0:W.current)==null?void 0:me.getBounds(ge.length-1,-1);Me!==void 0&&(n(Me.x),r(ge.length-1))}else if(q.kind==="header"&&Se>=V){const Me=ve==null?void 0:ve.current;if(q.isEdge&&te&&Me){n(q.bounds.x),r(Se);const et=Me.getBoundingClientRect().width/Me.offsetWidth,ct=q.bounds.width/et;N==null||N(ge[Se],ct,Se,ct+(ge[Se].growOffset??0))}else q.kind==="header"&&Ae&&(g(q.bounds.x),c(Se))}else q.kind==="cell"&&V>0&&Se===0&&Fe!==void 0&&ie!==void 0&&($(q.bounds.y),h(Fe))}ue==null||ue(q)},[ue,te,V,ie,W,ge,Ae,N,ve]),de=s.useCallback((q,me)=>{f||k||L==null||L(q,me)},[f,k,L]),Je=s.useCallback((q,me)=>{f||k||z==null||z(q,me)},[f,k,z]),at=s.useRef(-1),ke=s.useCallback(()=>{at.current=-1,h(void 0),x(void 0),$(void 0),y(!1),c(void 0),d(void 0),g(void 0),u(!1),r(void 0),n(void 0)},[]),ze=s.useCallback((q,me)=>{if(q.button===0){if(o!==void 0){if((K==null?void 0:K.hasIndex(o))===!0)for(const Fe of K){if(Fe===o)continue;const Me=ge[Fe],it=dr(Me,at.current,H,T);E==null||E(Me,it,Fe,it+(Me.growOffset??0))}const Se=dr(ge[o],at.current,H,T);if(X==null||X(ge[o],Se,o,Se+(ge[o].growOffset??0)),K.hasIndex(o))for(const Fe of K){if(Fe===o)continue;const Me=ge[Fe],it=dr(Me,at.current,H,T);X==null||X(Me,it,Fe,it+(Me.growOffset??0))}}ke(),i!==void 0&&l!==void 0&&(he==null?void 0:he(i,l))!==!1&&(Y==null||Y(i,l)),w!==void 0&&b!==void 0&&(ie==null||ie(w,b))}ye==null||ye(q,me)},[ye,o,i,l,w,b,K,X,ge,H,T,E,Y,ie,ke,he]),He=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(he==null?void 0:he(i,l))!==!1)return{src:i,dest:l}},[i,l,he]),wt=s.useCallback(q=>{const me=ve==null?void 0:ve.current;if(i!==void 0&&m!==void 0)Math.abs(q.clientX-m)>20&&u(!0);else if(w!==void 0&&R!==void 0)Math.abs(q.clientY-R)>20&&y(!0);else if(o!==void 0&&t!==void 0&&me){const Fe=me.getBoundingClientRect().width/me.offsetWidth,Me=(q.clientX-t)/Fe,it=ge[o],et=dr(it,Me,H,T);if(E==null||E(it,et,o,et+(it.growOffset??0)),at.current=Me,(K==null?void 0:K.first())===o)for(const ct of K){if(ct===o)continue;const j=ge[ct],se=dr(j,at.current,H,T);E==null||E(j,se,ct,se+(j.growOffset??0))}}},[i,m,w,R,o,t,ge,H,T,E,K,ve]),gt=s.useCallback((q,me)=>{if(w===void 0||b===void 0)return P(q,me);let[Se,Fe]=q;return Fe===b?Fe=w:(Fe>b&&(Fe-=1),Fe>=w&&(Fe+=1)),P([Se,Fe],me)},[w,b,P]),mt=s.useCallback(q=>{U==null||U(q),q.defaultPrevented()||ke()},[ke,U]);return s.createElement(od,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:gt,isResizing:o!==void 0,onHeaderMenuClick:de,onHeaderIndicatorClick:Je,isDragging:f,onItemHovered:ne,onDragStart:mt,onMouseDown:Ze,allowResize:te,onMouseUp:ze,dragAndDropState:He,onMouseMoveRaw:wt,ref:W})};function id(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=c=>{for(const l of c){const{width:d,height:f}=l&&l.contentRect||{};o(u=>u.width===d&&u.height===f?u:{width:d,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const ld=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),c=s.useRef(0),l=s.useRef(t);l.current=t;const d=n.current;s.useEffect(()=>{const f=()=>{var g,w;if(r.current===!1&&d!==null){const h=[d.scrollLeft,d.scrollTop];if(((g=i.current)==null?void 0:g[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(c.current>10){i.current=null,r.current=null;return}else c.current++;else c.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},m=g=>{g.touches.length===0&&(r.current=!1,c.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&d!==null){const g=d;return g.addEventListener("touchstart",u),g.addEventListener("touchend",m),()=>{g.removeEventListener("touchstart",u),g.removeEventListener("touchend",m),o.current!==null&&window.clearTimeout(o.current)}}},[e,d])},sd=()=>e=>e.isSafari?"scroll":"auto",ad=an("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[sd()]}}),cd=33554400,dd=5e6;function ud(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Vt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Vt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const fd=e=>{var Ne,K;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:c,className:l,preventDiagonalScrolling:d=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:m,rightElementProps:g,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:b}=e,x=[],k=(g==null?void 0:g.sticky)??!1,y=(g==null?void 0:g.fill)??!1,R=s.useRef(0),$=s.useRef(0),L=s.useRef(null),z=typeof window>"u"?1:window.devicePixelRatio,P=s.useRef(z);s.useEffect(()=>{if(P.current!==z){R.current=0,$.current=0,P.current=z;const ne=L.current;ne!==null&&ie.current(ne.scrollLeft,ne.scrollTop)}},[z]);const Y=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),E=s.useRef(null),N=ud(200),[X,W]=s.useState(!0),T=s.useRef(0);s.useLayoutEffect(()=>{if(!X||N||Y.current.lockDirection===void 0)return;const ne=L.current;if(ne===null)return;const[Ae,Ze]=Y.current.lockDirection;Ae!==void 0?ne.scrollLeft=Ae:Ze!==void 0&&(ne.scrollTop=Ze),Y.current.lockDirection=void 0},[N,X]);const H=s.useCallback((ne,Ae)=>{var Se;const Ze=L.current;if(Ze===null)return;Ae=Ae??Ze.scrollTop,ne=ne??Ze.scrollLeft;const de=Y.current.scrollTop,Je=Y.current.scrollLeft,at=ne-Je,ke=Ae-de;N&&at!==0&&ke!==0&&(Math.abs(at)>3||Math.abs(ke)>3)&&d&&Y.current.lockDirection===void 0&&(Y.current.lockDirection=Math.abs(at)<Math.abs(ke)?[Je,void 0]:[void 0,de]);const ze=Y.current.lockDirection;ne=(ze==null?void 0:ze[0])??ne,Ae=(ze==null?void 0:ze[1])??Ae,Y.current.scrollLeft=ne,Y.current.scrollTop=Ae;const He=Ze.clientWidth,wt=Ze.clientHeight,gt=Ae,mt=$.current-gt,q=Ze.scrollHeight-wt;$.current=gt;let me;if(q>0&&o>Ze.scrollHeight+5)if(Math.abs(mt)>2e3||gt===0||gt===q){const Fe=Math.max(0,Math.min(1,gt/q)),Me=o-wt;me=Fe*Me,R.current=me}else R.current-=mt,me=R.current;else me=gt,R.current=me;me=Math.max(0,Math.min(me,o-wt)),R.current=me,ze!==void 0&&(window.clearTimeout(T.current),W(!1),T.current=window.setTimeout(()=>W(!0),200)),i({x:ne,y:me,width:He-u,height:wt-f,paddingRight:((Se=E.current)==null?void 0:Se.clientWidth)??0})},[f,u,o,i,d,N]);ld(w&&qr.value,H,L);const ie=s.useRef(H);ie.current=H;const V=s.useRef(),he=s.useRef(!1);s.useLayoutEffect(()=>{he.current?H():he.current=!0},[H,f,u]);const ue=s.useCallback(ne=>{L.current=ne,h!==void 0&&(h.current=ne)},[h]);let ye=0,ee=0;const U=Math.min(o,cd);for(x.push(s.createElement("div",{key:ye++,style:{width:r,height:0}}));ee<U;){const ne=Math.min(dd,U-ee);x.push(s.createElement("div",{key:ye++,style:{width:0,height:ne}})),ee+=ne}const{ref:ve,width:te,height:ge}=id(b);return typeof window<"u"&&(((Ne=V.current)==null?void 0:Ne.height)!==ge||((K=V.current)==null?void 0:K.width)!==te)&&(window.setTimeout(()=>ie.current(),0),V.current={width:te,height:ge}),(te??0)===0||(ge??0)===0?s.createElement("div",{ref:ve}):s.createElement("div",{ref:ve},s.createElement(ad,{isSafari:qr.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:ue,style:V.current,draggable:c,onDragStart:ne=>{c||(ne.stopPropagation(),ne.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>H()},s.createElement("div",{className:"dvn-scroll-inner"+(m===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},x),m!==void 0&&s.createElement(s.Fragment,null,!y&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:E,style:{height:ge,maxHeight:n-Math.ceil(z%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:y?1:void 0,right:k?u??0:void 0,pointerEvents:"auto"}},m))))))},hd=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:c,freezeColumns:l,experimental:d,nonGrowWidth:f,clientSize:u,className:m,onVisibleRegionChanged:g,scrollRef:w,preventDiagonalScrolling:h,rightElement:b,rightElementProps:x,overscrollX:k,overscrollY:y,initialSize:R,smoothScrollX:$=!1,smoothScrollY:L=!1,isDraggable:z}=e,{paddingRight:P,paddingBottom:Y}=d??{},[E,N]=u,X=s.useRef(),W=s.useRef(),T=s.useRef(),H=s.useRef(),ie=f+Math.max(0,k??0);let V=c?r+i:r;if(typeof o=="number")V+=n*o;else for(let ee=0;ee<n;ee++)V+=o(ee);y!==void 0&&(V+=y);const he=s.useRef(),ue=s.useCallback(()=>{var Je,at;if(he.current===void 0)return;const ee={...he.current};let U=0,ve=ee.x<0?-ee.x:0,te=0,ge=0;ee.x=ee.x<0?0:ee.x;let Ne=0;for(let ke=0;ke<l;ke++)Ne+=t[ke].width;for(const ke of t){const ze=U-Ne;if(ee.x>=ze+ke.width)U+=ke.width,ge++,te++;else if(ee.x>ze)U+=ke.width,$?ve+=ze-ee.x:ge++,te++;else if(ee.x+ee.width>ze)U+=ke.width,te++;else break}let K=0,ne=0,Ae=0;if(typeof o=="number")L?(ne=Math.floor(ee.y/o),K=ne*o-ee.y):ne=Math.ceil(ee.y/o),Ae=Math.ceil(ee.height/o)+ne,K<0&&Ae++;else{let ke=0;for(let ze=0;ze<n;ze++){const He=o(ze),wt=ke+(L?0:He/2);if(ee.y>=ke+He)ke+=He,ne++,Ae++;else if(ee.y>wt)ke+=He,L?K+=wt-ee.y:ne++,Ae++;else if(ee.y+ee.height>He/2+ke)ke+=He,Ae++;else break}}ne=Math.max(0,Math.min(ne,n-1)),Ae=Math.max(ne,Math.min(Ae,n));const Ze={x:ge,y:ne,width:te-ge,height:Ae-ne},de=X.current;(de===void 0||de.y!==Ze.y||de.x!==Ze.x||de.height!==Ze.height||de.width!==Ze.width||W.current!==ve||T.current!==K||ee.width!==((Je=H.current)==null?void 0:Je[0])||ee.height!==((at=H.current)==null?void 0:at[1]))&&(g==null||g({x:ge,y:ne,width:te-ge,height:Ae-ne},ee.width,ee.height,ee.paddingRight??0,ve,K),X.current=Ze,W.current=ve,T.current=K,H.current=[ee.width,ee.height])},[t,o,n,g,l,$,L]),ye=s.useCallback(ee=>{he.current=ee,ue()},[ue]);return s.useEffect(()=>{ue()},[ue]),s.createElement(fd,{scrollRef:w,className:m,kineticScrollPerfHack:d==null?void 0:d.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:z===!0||typeof z=="string",scrollWidth:ie+(P??0),scrollHeight:V+(Y??0),clientHeight:N,rightElement:b,paddingBottom:Y,paddingRight:P,rightElementProps:x,update:ye,initialSize:R},s.createElement(rd,{eventTargetRef:w,width:E,height:N,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},gd=an("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),md=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),wd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),bd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),yd=10,pd=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:c,searchResults:l,onSearchValueChange:d,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:m=!1,onSearchClose:g}=e,[w]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,b]=s.useState(""),x=c??h,k=s.useCallback(U=>{b(U),d==null||d(U)},[d]),[y,R]=s.useState(),$=s.useRef(y);$.current=y,s.useEffect(()=>{l!==void 0&&(l.length>0?R(U=>({rowsSearched:o,results:l.length,selectedIndex:(U==null?void 0:U.selectedIndex)??-1})):R(void 0))},[o,l]);const L=s.useRef();L.current===void 0&&(L.current=new AbortController);const z=s.useRef(),[P,Y]=s.useState([]),E=l??P,N=s.useCallback(()=>{z.current!==void 0&&(window.cancelAnimationFrame(z.current),z.current=void 0),L.current!==void 0&&L.current.abort(),L.current=new AbortController},[]),X=s.useRef(n);X.current=n;const W=s.useCallback(U=>{const ve=new RegExp(U.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let te=X.current,ge=Math.min(10,o),Ne=0;R(void 0),Y([]);const K=[],ne=async()=>{var gt;if(f===void 0)return;const Ae=performance.now(),Ze=o-Ne;let de=f({x:0,y:te,width:r.length,height:Math.min(ge,Ze,o-te)},L.current.signal);typeof de=="function"&&(de=await de());let Je=!1;for(const[mt,q]of de.entries())for(const[me,Se]of q.entries()){let Fe;switch(Se.kind){case Q.Text:case Q.Number:Fe=Se.displayData;break;case Q.Uri:case Q.Markdown:Fe=Se.data;break;case Q.Boolean:Fe=typeof Se.data=="boolean"?Se.data.toString():void 0;break;case Q.Image:case Q.Bubble:Fe=Se.data.join("🐳");break;case Q.Custom:Fe=Se.copyData;break}Fe!==void 0&&ve.test(Fe)&&(K.push([me,mt+te]),Je=!0)}const at=performance.now();Je&&Y([...K]),Ne+=de.length,ln(Ne<=o);const ke=((gt=$.current)==null?void 0:gt.selectedIndex)??-1;R({results:K.length,rowsSearched:Ne,selectedIndex:ke}),u==null||u(K,ke),te+ge>=o?te=0:te+=ge;const ze=at-Ae,He=Math.max(ze,1),wt=yd/He;ge=Math.ceil(ge*wt),Ne<o&&K.length<1e3&&(z.current=window.requestAnimationFrame(ne))};N(),z.current=window.requestAnimationFrame(ne)},[N,r.length,f,u,o]),T=s.useCallback(()=>{var U;g==null||g(),R(void 0),Y([]),u==null||u([],-1),N(),(U=t==null?void 0:t.current)==null||U.focus()},[N,t,g,u]),H=s.useCallback(U=>{k(U.target.value),l===void 0&&(U.target.value===""?(R(void 0),Y([]),N()):W(U.target.value))},[W,N,k,l]);s.useEffect(()=>{i.current!==null&&(k(""),R(void 0),P.length>0&&(Y([]),u==null||u([],-1)),m?i.current.focus({preventScroll:!0}):N())},[m,i]);const ie=s.useCallback(U=>{var te;if((te=U==null?void 0:U.stopPropagation)==null||te.call(U),y===void 0||y.results===0)return;const ve=(y.selectedIndex+1)%y.results;R({...y,selectedIndex:ve}),u==null||u(E,ve)},[y,u,E]),V=s.useCallback(U=>{var te;if((te=U==null?void 0:U.stopPropagation)==null||te.call(U),y===void 0||y.results===0)return;let ve=(y.selectedIndex-1)%y.results;ve<0&&(ve+=y.results),R({...y,selectedIndex:ve}),u==null||u(E,ve)},[u,E,y]),he=s.useCallback(U=>{(U.ctrlKey||U.metaKey)&&U.nativeEvent.code==="KeyF"||U.key==="Escape"?(T(),U.stopPropagation(),U.preventDefault()):U.key==="Enter"&&(U.shiftKey?V():ie())},[T,ie,V]);s.useEffect(()=>()=>{N()},[N]);const[ue,ye]=s.useState(!1);s.useEffect(()=>{if(m)ye(!0);else{const U=setTimeout(()=>ye(!1),150);return()=>clearTimeout(U)}},[m]);const ee=s.useMemo(()=>{if(!m&&!ue)return null;let U;y!==void 0&&(U=y.results>=1e3?"over 1000":`${y.results} result${y.results!==1?"s":""}`,y.selectedIndex>=0&&(U=`${y.selectedIndex+1} of ${U}`));const ve=Ne=>{Ne.stopPropagation()},ge={width:`${o>0?Math.floor(((y==null?void 0:y.rowsSearched)??0)/o*100):0}%`};return s.createElement(gd,{className:"gdg-search-bar"+(m?"":" out"),onMouseDown:ve,onMouseMove:ve,onMouseUp:ve,onClick:ve},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:w,"aria-hidden":!m,"data-testid":"search-input",ref:i,onChange:H,value:x,tabIndex:m?void 0:-1,onKeyDownCapture:he}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:V,disabled:((y==null?void 0:y.results)??0)===0},md),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:ie,disabled:((y==null?void 0:y.results)??0)===0},wd),g!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!m,"data-testid":"search-close-button",tabIndex:m?void 0:-1,onClick:T},bd)),y!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},U)),s.createElement("div",{className:"gdg-search-progress",style:ge})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:w},"Type to search")))},[m,ue,y,o,w,i,H,x,he,V,ie,g,T]);return s.createElement(s.Fragment,null,s.createElement(hd,{prelightCells:E,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),ee)};class vd extends s.PureComponent{constructor(){super(...arguments);Le(this,"wrapperRef",s.createRef());Le(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const Cd=()=>e=>Math.max(16,e.targetHeight-10),xd=an("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[Cd(),"px"]}}),kd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[c,l]=Rt.useState(n);return Rt.createElement(vd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Rt.createElement(xd,{targetHeight:t.height,"data-testid":"group-rename-input",value:c,onBlur:o,onFocus:d=>d.target.setSelectionRange(0,c.length),onChange:d=>l(d.target.value),onKeyDown:d=>{d.key==="Enter"?i(c):d.key==="Escape"&&o()},autoFocus:!0}))};function Sd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function We(e,t,n){const o=Ss(e,t);return o&&(n.didMatch=!0),o}function Ss(e,t){if(e.length===0)return!1;if(e.includes("|")){const d=e.split("|");for(const f of d)if(Ss(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const c=e.split("+"),l=c.pop();if(!Sd(l,t))return!1;if(c[0]==="any")return!0;for(const d of c)switch(d){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":jr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function Md(e,t,n,o,r,i,c){const l=Rt.useCallback((u,m,g,w)=>{var R;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!c&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(g||w==="drag")||n==="additive",b=(o==="mixed"||o==="additive")&&h,x=(r==="mixed"||r==="additive")&&h;let k={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((R=e.current)==null?void 0:R.rangeStack)??[]:[]},columns:b?e.columns:rt.empty(),rows:x?e.rows:rt.empty()};g&&(i==="multi-rect"||i==="multi-cell")&&k.current!==void 0&&e.current!==void 0&&(k={...k,current:{...k.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(k,m)},[o,e,n,i,c,r,t]),d=Rt.useCallback((u,m,g)=>{u=u??e.rows,m!==void 0&&(u=u.add(m));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:rt.empty(),rows:u};else{const h=g&&n==="mixed"||n==="additive",b=g&&o==="mixed"||o==="additive";w={current:h?e.current:void 0,columns:b?e.columns:rt.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=Rt.useCallback((u,m,g)=>{u=u??e.columns,m!==void 0&&(u=u.add(m));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:rt.empty(),columns:u};else{const h=g&&n==="mixed"||n==="additive",b=g&&r==="mixed"||r==="additive";w={current:h?e.current:void 0,rows:b?e.rows:rt.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,d,f]}function Rd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let m=f.y;m<f.y+f.height;m++){const g=[];for(let w=f.x;w<f.x+f.width;w++)w<0||m>=r?g.push({kind:Q.Loading,allowOverlay:!1}):g.push(t([w,m]));u.push(g)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),c=e!==void 0?i:void 0,l=s.useCallback(f=>{if(c===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const m=c(u,o.signal);return typeof m=="function"?async()=>(await m()).map(g=>[{kind:Q.Loading,allowOverlay:!1},...g]):m.map(g=>[{kind:Q.Loading,allowOverlay:!1},...g])}return c(u,o.signal)},[o.signal,c,n]);return[e!==void 0?l:void 0,c]}function Ed(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case Q.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Oi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case Q.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case Q.Image:case Q.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case Q.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case Q.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case Q.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case Q.Markdown:case Q.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case Q.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case Q.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case Q.Protected:return{formatted:"************",rawValue:"",format:"string"};default:hr()}}function Id(e,t){return e.map((o,r)=>{const i=t[r];return o.map(c=>c.span!==void 0&&c.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:Ed(c))})}function Bl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Dd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(c=>Bl(c,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:Bl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Ti(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Ll(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Td(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function Fd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Ti(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((c,l)=>`<li gdg-raw-value=${Ll(r.rawValue[l])}>`+Ti(c)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Ll(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Ti(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function Hd(e,t){const n=Id(e,t),o=Dd(n),r=Fd(n);return{textPlain:o,textHtml:r}}function Wl(e){var c;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const d=l.cloneNode(!0),u=d.children.length===1&&d.children[0].nodeName==="P"?d.children[0]:null,m=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",g=d.querySelectorAll("br");for(const b of g)b.replaceWith(`
`);const w=d.getAttribute("gdg-raw-value"),h=d.getAttribute("gdg-format")??"string";if(d.querySelector("a")!==null)i==null||i.push({rawValue:((c=d.querySelector("a"))==null?void 0:c.getAttribute("href"))??"",formatted:d.textContent??"",format:h});else if(d.querySelector("ol")!==null){const b=d.querySelectorAll("li");i==null||i.push({rawValue:[...b].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...b].map(x=>x.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:Td(w),formatted:d.textContent??"",format:h});else{let b=d.textContent??"";m&&(b=b.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:b??"",formatted:b??"",format:h})}}}return i!==void 0&&r.push(i),r}function Ad(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let c=!1;do{if((e==null?void 0:e.current)===void 0)break;const d=(l=e.current)==null?void 0:l.range,f=[];if(d.width>2){const g=t({x:d.x,y:d.y,width:1,height:d.height},r.signal);if(typeof g=="function")return i;f.push(...g);const w=t({x:d.x+d.width-1,y:d.y,width:1,height:d.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const g=t({x:d.x,y:d.y,width:d.width,height:d.height},r.signal);if(typeof g=="function")return i;f.push(...g)}let u=d.x-n,m=d.x+d.width-1-n;for(const g of f)for(const w of g)w.span!==void 0&&(u=Math.min(w.span[0],u),m=Math.max(w.span[1],m));u===d.x-n&&m===d.x+d.width-1-n?c=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:d.y,width:m-u+1,height:d.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!c);return e}function $l(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function zd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let c=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,c)),r=c+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push($l(e.slice(r,c))),r=c+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}c++}return r<e.length&&o.push($l(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(d=>({rawValue:d,formatted:d,format:"string"})))}function Nl(e,t,n){var l;const o=Hd(e,t),r=d=>{var f;(f=window.navigator.clipboard)==null||f.writeText(d)},i=(d,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([d],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},c=(d,f)=>{var u,m;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",d),(m=n==null?void 0:n.clipboardData)==null||m.setData("text/html",f)}catch{i(d,f)||r(d)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?c(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function Ms(e){return e!==!0}function Ol(e){return typeof e=="string"?e:`${e}px`}const Pd=()=>e=>e.innerWidth,Bd=()=>e=>e.innerHeight,Ld=an("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Pd()],"wmyidgi-1":[Bd()]}}),Wd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(Ld,{innerHeight:Ol(n),innerWidth:Ol(t),...r},o)},$d=2,Nd=1300;function Od(e,t,n){const o=Rt.useRef(0),[r,i]=e??[0,0];Rt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let c=!1,l=0;const d=f=>{var u;if(!c){if(l===0)l=f;else{const m=f-l;o.current=Math.min(1,o.current+m/Nd);const g=o.current**1.618*m*$d;(u=t.current)==null||u.scrollBy(r*g,i*g),l=f,n==null||n()}window.requestAnimationFrame(d)}};return window.requestAnimationFrame(d),()=>{c=!0}},[t,r,i,n])}function Xd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:c,remSize:l}){const[d,f,u,m,g,w]=Rt.useMemo(()=>{if(!c||l===16)return[e,t,n,o,r,i];const h=l/16,b=e,x=ds();return[typeof b=="number"?b*h:k=>Math.ceil(b(k)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,c,o]);return{rowHeight:d,headerHeight:f,groupHeaderHeight:u,theme:m,overscrollX:g,overscrollY:w}}const Zn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function $e(e,t){return e===!0?t:e===!1?"":e}function Xl(e){const t=jr.value;return{activateCell:$e(e.activateCell," |Enter|shift+Enter"),clear:$e(e.clear,"any+Escape"),closeOverlay:$e(e.closeOverlay,"any+Escape"),acceptOverlayDown:$e(e.acceptOverlayDown,"Enter"),acceptOverlayUp:$e(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:$e(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:$e(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:$e(e.delete,t?"Backspace|Delete":"Delete"),downFill:$e(e.downFill,"primary+_68"),scrollToSelectedCell:$e(e.scrollToSelectedCell,"primary+Enter"),goDownCell:$e(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:$e(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:$e(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:$e(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:$e(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:$e(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:$e(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:$e(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:$e(e.goToFirstCell,"primary+Home"),goToFirstColumn:$e(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:$e(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:$e(e.goToLastCell,"primary+End"),goToLastColumn:$e(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:$e(e.goToLastRow,"primary+ArrowDown"),goToNextPage:$e(e.goToNextPage,"PageDown"),goToPreviousPage:$e(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:$e(e.rightFill,"primary+_82"),search:$e(e.search,"primary+f"),selectAll:$e(e.selectAll,"primary+a"),selectColumn:$e(e.selectColumn,"ctrl+ "),selectGrowDown:$e(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:$e(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:$e(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:$e(e.selectGrowUp,"shift+ArrowUp"),selectRow:$e(e.selectRow,"shift+ "),selectToFirstCell:$e(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:$e(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:$e(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:$e(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:$e(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:$e(e.selectToLastRow,"primary+shift+ArrowDown")}}function Yd(e){const t=Ea(e);return Rt.useMemo(()=>{if(t===void 0)return Xl(Zn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Zn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Zn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Zn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Zn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Zn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Zn.selectToLastCell};return Xl({...Zn,...n})},[t])}function Gd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const c={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(c.subGroups=o.subGroups.map((l,d)=>t(l,r+1,[...i,d])).sort((l,d)=>l.headerIndex-d.headerIndex)),c}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function ji(e,t){const n=[];function o(l,d,f=!1){let u=d!==null?d-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let m=0;m<l.subGroups.length;m++){const g=m<l.subGroups.length-1?l.subGroups[m+1].headerIndex:d;o(l.subGroups[m],g,f||l.isCollapsed)}}const r=Gd(e.groups);for(let l=0;l<r.length;l++){const d=l<r.length-1?r[l+1].headerIndex:null;o(r[l],d)}let i=0,c=0;for(const l of n)l.contentIndex=c,c+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:d,...f}=l;return f})}function Ni(e,t){if(t===void 0||ji.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function _d(e,t,n,o){const r=Rt.useMemo(()=>e===void 0?void 0:ji(e,t),[e,t]),i=Rt.useMemo(()=>r==null?void 0:r.reduce((u,m)=>(u[m.rowIndex]=m,u),{}),[r]),c=Rt.useMemo(()=>r===void 0?t:r.reduce((u,m)=>u+(m.isCollapsed?1:m.rows+1),0),[r,t]),l=Rt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),d=Rt.useCallback(u=>{if(r===void 0)return u;let m=u;for(const g of r){if(m===0)return;if(m--,!g.isCollapsed){if(m<g.rows)return g.contentIndex+m;m-=g.rows}}return u},[r]),f=Qn(o??(e==null?void 0:e.themeOverride),Rt.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:m,contentIndex:g,groupIndex:w}=Ni(u,r);return m?e.themeOverride:o==null?void 0:o(u,w,g)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:d,getRowThemeOverride:f}:{rowHeight:l,rows:c,rowNumberMapper:d,getRowThemeOverride:f}}function Ud(e,t){const n=Rt.useMemo(()=>e===void 0?void 0:ji(e,t),[e,t]);return{getRowGroupingForPath:Es,updateRowGroupingByPath:Rs,mapper:Rt.useCallback(o=>{if(typeof o=="number")return Ni(o,n);const r=Ni(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function Rs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,c)=>c===o?{...i,...n}:i):e.map((i,c)=>c===o?{...i,subGroups:Rs(i.subGroups??[],r,n)}:i)}function Es(e,t){const[n,...o]=t;return o[0]===-1?e[n]:Es(e[n].subGroups??[],o)}function Kd(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Vd(e,t,n,o,r){const[i,c]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:c}),[o,c,i]),[d,f,u]=Ra(l),m=s.useRef(r);m.current=r;const g=Kd(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),w=(d.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&g.current!==null&&w){if(g.current.scrollTop===t)return;g.current.scrollTop=t,g.current.scrollTop!==t&&u(),m.current()}},[t,w,u,g]);const h=(d.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&g.current!==null&&h){if(g.current.scrollLeft===e)return;g.current.scrollLeft=e,g.current.scrollLeft!==e&&u(),m.current()}},[e,h,u,g]),{visibleRegion:d,setVisibleRegion:f,scrollRef:g}}const qd=s.lazy(async()=>await Ul(()=>import("./data-grid-overlay-editor-CBe8IteY.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let jd=0;function Zd(e){return ma(yl(yl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return mo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Yr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Jn={kind:Q.Loading,allowOverlay:!1},Fi={columns:rt.empty(),rows:rt.empty(),current:void 0},Jd=(e,t)=>{var ml,wl,bl;const[n,o]=s.useState(Fi),[r,i]=s.useState(),c=s.useRef(null),l=s.useRef(null),[d,f]=s.useState(),u=s.useRef(void 0),m=typeof window>"u"?null:window,{imageEditorOverride:g,getRowThemeOverride:w,markdownDivCreateNode:h,width:b,height:x,columns:k,rows:y,getCellContent:R,onCellClicked:$,onCellActivated:L,onFillPattern:z,onFinishedEditing:P,coercePasteValue:Y,drawHeader:E,drawCell:N,editorBloom:X,onHeaderClicked:W,onColumnProposeMove:T,rangeSelectionColumnSpanning:H=!0,spanRangeBehavior:ie="default",onGroupHeaderClicked:V,onCellContextMenu:he,className:ue,onHeaderContextMenu:ye,getCellsForSelection:ee,onGroupHeaderContextMenu:U,onGroupHeaderRenamed:ve,onCellEdited:te,onCellsEdited:ge,onSearchResultsChanged:Ne,searchResults:K,onSearchValueChange:ne,searchValue:Ae,onKeyDown:Ze,onKeyUp:de,keybindings:Je,editOnType:at=!0,onRowAppended:ke,onColumnAppended:ze,onColumnMoved:He,validateCell:wt,highlightRegions:gt,rangeSelect:mt="rect",columnSelect:q="multi",rowSelect:me="multi",rangeSelectionBlending:Se="exclusive",columnSelectionBlending:Fe="exclusive",rowSelectionBlending:Me="exclusive",onDelete:it,onDragStart:et,onMouseMove:ct,onPaste:j,copyHeaders:se=!1,freezeColumns:Oe=0,cellActivationBehavior:Ye="second-click",rowSelectionMode:Et="auto",columnSelectionMode:It="auto",onHeaderMenuClick:De,onHeaderIndicatorClick:Re,getGroupDetails:ut,rowGrouping:vt,onSearchClose:Ct,onItemHovered:Nt,onSelectionCleared:Pt,showSearch:bn,onVisibleRegionChanged:cn,gridSelection:Dt,onGridSelectionChange:qt,minColumnWidth:Xt=50,maxColumnWidth:Sn=500,maxColumnAutoWidth:bt,provideEditor:ft,trailingRowOptions:Ge,freezeTrailingRows:Bt=0,allowedFillDirections:Qt="orthogonal",scrollOffsetX:Mn,scrollOffsetY:zn,verticalBorder:Gt,onDragOverCell:yn,onDrop:Te,onColumnResize:nt,onColumnResizeEnd:tt,onColumnResizeStart:Ue,customRenderers:Ot,fillHandle:_e,experimental:Ke,fixedShadowX:Pn,fixedShadowY:wr,headerIcons:Xn,imageWindowLoader:Bn,initialSize:Ln,isDraggable:vo,onDragLeave:br,onRowMoved:Yn,overscrollX:Co,overscrollY:xo,preventDiagonalScrolling:ko,rightElement:So,rightElementProps:no,trapFocus:Wn=!1,smoothScrollX:ei,smoothScrollY:yr,scaleToRem:ti=!1,rowHeight:ni=34,headerHeight:Rn=36,groupHeaderHeight:Gn=Rn,theme:oi,isOutsideClick:ri,renderers:Mo,resizeIndicator:pr,scrollToActiveCell:oo=!0,drawFocusRing:ii=!0,portalElementRef:vr,isActivationOnEnter:En,onRowStatus:ro,onRowId:_n}=e,io=ii==="no-editor"?r===void 0:ii,Ce=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,_o=(Ce==null?void 0:Ce.rowNumber)??!1;let In=(Ce==null?void 0:Ce.kind)??e.rowMarkers??"none",en=_o;(In==="both"||In==="checkbox-and-number")&&(In="checkbox",en=!0);const jt=In,Cr=(Ce==null?void 0:Ce.width)??e.rowMarkerWidth,Uo=(Ce==null?void 0:Ce.startIndex)??e.rowMarkerStartIndex??1,Ko=(Ce==null?void 0:Ce.theme)??e.rowMarkerTheme,Vo=Ce==null?void 0:Ce.headerTheme,qo=Ce==null?void 0:Ce.headerAlwaysVisible,lo=me!=="multi"||(Ce==null?void 0:Ce.headerDisabled)===!0,$n=(Ce==null?void 0:Ce.checkboxStyle)??"square",xr=(Ce==null?void 0:Ce.rowStatus)??!1,kr=(Ce==null?void 0:Ce.rowStatusWidth)??40,Ro=Ce==null?void 0:Ce.rowStatusTheme,li=(Ce==null?void 0:Ce.rowId)??!1,Sr=(Ce==null?void 0:Ce.rowIdWidth)??80,Eo=Ce==null?void 0:Ce.rowIdTheme,Dn=Math.max(Xt,20),Io=Math.max(Sn,Dn),si=Math.max(bt??Io,Dn),Mr=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Ee,rowNumberMapper:Do,rowHeight:To,getRowThemeOverride:tn}=_d(vt,y,ni,w),jo=s.useMemo(()=>Number.parseFloat(Mr.fontSize),[Mr]),{rowHeight:Tn,headerHeight:Un,groupHeaderHeight:Rr,theme:so,overscrollX:ai,overscrollY:ci}=Xd({groupHeaderHeight:Gn,headerHeight:Rn,overscrollX:Co,overscrollY:xo,remSize:jo,rowHeight:To,scaleToRem:ti,theme:oi}),M=Yd(Je),_=Cr??(y>1e4?48:y>1e3?44:y>100?36:32),re=jt!=="none",le=xr===!0,J=li===!0,v=(re?en?2:1:0)+(le?1:0)+(J?1:0),ae=Ge!==void 0,Pe=(Ge==null?void 0:Ge.sticky)===!0,[we,At]=s.useState(!1),pe=bn??we,lt=s.useCallback(()=>{Ct!==void 0?Ct():At(!1)},[Ct]),D=s.useMemo(()=>Dt===void 0?void 0:Yr(Dt,v),[Dt,v])??n,Ve=s.useRef(new AbortController);s.useEffect(()=>()=>Ve==null?void 0:Ve.current.abort(),[]);const[qe,zt]=Rd(ee,R,v,Ve.current,Ee),pn=s.useCallback((a,p,C)=>{if(wt===void 0)return!0;const S=[a[0]-v,a[1]];return wt==null?void 0:wt(S,p,C)},[v,wt]),nn=s.useRef(Dt),xt=s.useCallback((a,p)=>{p&&(a=Ad(a,qe,v,ie,Ve.current)),qt!==void 0?(nn.current=Yr(a,-v),qt(nn.current)):o(a)},[qt,qe,v,ie]),_t=Qn(nt,s.useCallback((a,p,C,S)=>{nt==null||nt(k[C-v],p,C-v,S)},[nt,v,k])),ht=Qn(tt,s.useCallback((a,p,C,S)=>{tt==null||tt(k[C-v],p,C-v,S)},[tt,v,k])),Fn=Qn(Ue,s.useCallback((a,p,C,S)=>{Ue==null||Ue(k[C-v],p,C-v,S)},[Ue,v,k])),dn=Qn(E,s.useCallback((a,p)=>(E==null?void 0:E({...a,columnIndex:a.columnIndex-v},p))??!1,[E,v])),Zo=Qn(N,s.useCallback((a,p)=>(N==null?void 0:N({...a,col:a.col-v},p))??!1,[N,v])),Ut=s.useCallback(a=>{if(it!==void 0){const p=it(Yr(a,-v));return typeof p=="boolean"?p:Yr(p,v)}return!0},[it,v]),[kt,Tt,Ft]=Md(D,xt,Se,Fe,Me,mt,H),Ht=s.useMemo(()=>On(ds(),so),[so]),[Jo,di]=s.useState([0,0,0]),Zi=s.useMemo(()=>{if(Mo===void 0)return{};const a={};for(const p of Mo)a[p.kind]=p;return a},[Mo]),Kt=s.useCallback(a=>a.kind!==Q.Custom?Zi[a.kind]:Ot==null?void 0:Ot.find(p=>p.isMatch(a)),[Ot,Zi]);let{sizedColumns:un,nonGrowWidth:Ji}=Ja(k,Ee,zt,Jo[0]-(v===0?0:_)-Jo[2],Dn,si,Ht,Kt,Ve.current);jt!=="none"&&(Ji+=_);const ui=s.useMemo(()=>un.some(a=>a.group!==void 0),[un]),Qo=ui?Un+Rr:Un,Qi=D.rows.length,el=jt==="none"?void 0:Qi===0?!1:Qi===Ee?!0:void 0,je=s.useMemo(()=>{const a=[];return jt!=="none"&&(en&&a.push({title:"",width:_,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Ko,rowMarker:$n,rowMarkerChecked:!1,headerRowMarkerTheme:Vo,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),a.push({title:"",width:_,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Ko,rowMarker:$n,rowMarkerChecked:el,headerRowMarkerTheme:Vo,headerRowMarkerAlwaysVisible:qo,headerRowMarkerDisabled:lo})),le&&a.push({title:"",width:kr,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Ro}),J&&a.push({title:"ID",width:Sr,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Eo}),[...a,...un]},[le,kr,Ro,J,Sr,Eo,jt,un,_,Ko,$n,el,Vo,qo,lo,en]),on=s.useRef({height:1,width:1,x:0,y:0}),Er=s.useRef(!1),{setVisibleRegion:tl,visibleRegion:ao,scrollRef:st}=Vd(Mn,zn,Tn,on,()=>Er.current=!0);on.current=ao;const Ts=ao.x+v,Ir=ao.y,Lt=s.useRef(null),Yt=s.useCallback(a=>{var p;a===!0?(p=Lt.current)==null||p.focus():window.requestAnimationFrame(()=>{var C;(C=Lt.current)==null||C.focus()})},[]),Wt=ae?Ee+1:Ee,fn=s.useCallback(a=>{const p=v===0?a:a.map(S=>({...S,location:[S.location[0]-v,S.location[1]]})),C=ge==null?void 0:ge(p);if(C!==!0)for(const S of p)te==null||te(S.location,S.value);return C},[te,ge,v]),[co,fi]=s.useState(),Dr=D.current!==void 0&&D.current.range.width*D.current.range.height>1?D.current.range:void 0,Fo=io?(ml=D.current)==null?void 0:ml.cell:void 0,Tr=Fo==null?void 0:Fo[0],Fr=Fo==null?void 0:Fo[1],Fs=s.useMemo(()=>{if((gt===void 0||gt.length===0)&&(Dr??Tr??Fr??co)===void 0)return;const a=[];if(gt!==void 0)for(const p of gt){const C=je.length-p.range.x-v;C>0&&a.push({color:p.color,range:{...p.range,x:p.range.x+v,width:Math.min(C,p.range.width)},style:p.style})}return co!==void 0&&a.push({color:bo(Ht.accentColor,0),range:co,style:"dashed"}),Dr!==void 0&&a.push({color:bo(Ht.accentColor,.5),range:Dr,style:"solid-outline"}),Tr!==void 0&&Fr!==void 0&&a.push({color:Ht.accentColor,range:{x:Tr,y:Fr,width:1,height:1},style:"solid-outline"}),a.length>0?a:void 0},[co,Dr,Tr,Fr,gt,je.length,Ht.accentColor,v]),nl=s.useRef(je);nl.current=je;const rn=s.useCallback(([a,p],C=!1)=>{var G,Z,ce,oe,Xe,Ie,Qe,Be,be;const S=ae&&p===Wt-1;let A=0,O=-1,F=-1,I=-1,B=-1;if(re&&en&&(O=A++),re&&(F=A++),le&&(I=A++),J&&(B=A++),a===O){if(S)return Jn;const xe=Do(p);return xe===void 0?Jn:{kind:$t.Marker,allowOverlay:!1,checkboxStyle:$n,checked:!1,markerKind:"number",row:Uo+xe,drawHandle:!1,cursor:void 0,disabled:((G=e.disabledRows)==null?void 0:G.call(e,p))===!0}}if(a===F){if(S)return Jn;const xe=Do(p);if(xe===void 0)return Jn;let ot;return en?ot=jt==="checkbox-visible"?"checkbox-visible":"checkbox":jt==="clickable-number"?ot="number":ot=jt,{kind:$t.Marker,allowOverlay:!1,checkboxStyle:$n,checked:(D==null?void 0:D.rows.hasIndex(p))===!0,markerKind:ot,row:Uo+xe,drawHandle:Yn!==void 0,cursor:en?void 0:jt==="clickable-number"?"pointer":void 0,disabled:((Z=e.disabledRows)==null?void 0:Z.call(e,p))===!0}}if(a===I){if(S)return Jn;const xe=ro==null?void 0:ro(p);return{kind:$t.RowStatus,allowOverlay:!1,status:xe,themeOverride:Ro}}if(a===B){if(S)return Jn;const xe=_n==null?void 0:_n(p);return{kind:$t.RowId,allowOverlay:!1,rowId:xe,themeOverride:Eo}}if(S){const ot=a===v?(Ge==null?void 0:Ge.hint)??"":"",fe=nl.current[a];if(((ce=fe==null?void 0:fe.trailingRowOptions)==null?void 0:ce.disabled)===!0)return Jn;{const dt=((oe=fe==null?void 0:fe.trailingRowOptions)==null?void 0:oe.hint)??ot,Mt=((Xe=fe==null?void 0:fe.trailingRowOptions)==null?void 0:Xe.addIcon)??(Ge==null?void 0:Ge.addIcon);return{kind:$t.NewRow,hint:dt,allowOverlay:!1,icon:Mt}}}else{const xe=a-v;if(C||(Ke==null?void 0:Ke.strict)===!0){const fe=on.current,dt=fe.x>xe||xe>fe.x+fe.width||fe.y>p||p>fe.y+fe.height||p>=wi.current,Mt=xe===((Qe=(Ie=fe.extras)==null?void 0:Ie.selected)==null?void 0:Qe[0])&&p===((Be=fe.extras)==null?void 0:Be.selected[1]);let Zt=!1;if(((be=fe.extras)==null?void 0:be.freezeRegions)!==void 0){for(const gn of fe.extras.freezeRegions)if(wo(gn,xe,p)){Zt=!0;break}}if(dt&&!Mt&&!Zt)return Jn}let ot=R([xe,p]);return v!==0&&ot.span!==void 0&&(ot={...ot,span:[ot.span[0]+v,ot.span[1]+v]}),ot}},[ae,Wt,le,ro,Ro,J,_n,Eo,re,Do,$n,D==null?void 0:D.rows,jt,Uo,Yn,v,Ge==null?void 0:Ge.hint,Ge==null?void 0:Ge.addIcon,Ke==null?void 0:Ke.strict,R,en]),hi=s.useCallback(a=>{let p=(ut==null?void 0:ut(a))??{name:a};return ve!==void 0&&a!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:C=>yi({group:p.name,bounds:C.bounds})}]}),p},[ut,ve]),Ho=s.useCallback(a=>{var I;const[p,C]=a.cell,S=je[p],A=(S==null?void 0:S.group)!==void 0?(I=hi(S.group))==null?void 0:I.overrideTheme:void 0,O=S==null?void 0:S.themeOverride,F=tn==null?void 0:tn(C);i({...a,theme:On(Ht,A,O,F,a.content.themeOverride)})},[tn,je,hi,Ht]),er=s.useCallback((a,p,C)=>{var F;if(D.current===void 0)return;const[S,A]=D.current.cell,O=rn([S,A]);if(O.kind!==Q.Boolean&&O.allowOverlay){let I=O;if(C!==void 0)switch(I.kind){case Q.Number:{const B=ba(()=>C==="-"?-0:Number.parseFloat(C),0);I={...I,data:Number.isNaN(B)?0:B};break}case Q.Text:case Q.Markdown:case Q.Uri:I={...I,data:C};break}Ho({target:a,content:I,initialValue:C,cell:[S,A],highlight:C===void 0,forceEditMode:C!==void 0,activation:p})}else O.kind===Q.Boolean&&p.inputType==="keyboard"&&O.readonly!==!0&&(fn([{location:D.current.cell,value:{...O,data:Ms(O.data)}}]),(F=Lt.current)==null||F.damage([{cell:D.current.cell}]))},[rn,D,fn,Ho]),ol=s.useCallback((a,p)=>{var A;const C=(A=Lt.current)==null?void 0:A.getBounds(a,p);if(C===void 0||st.current===null)return;const S=rn([a,p]);S.allowOverlay&&Ho({target:C,content:S,initialValue:void 0,highlight:!0,cell:[a,p],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[rn,st,Ho]),St=s.useCallback((a,p,C="both",S=0,A=0,O=void 0)=>{if(st.current!==null){const F=Lt.current,I=l.current,B=typeof a!="number"?a.unit==="cell"?a.amount:void 0:a,G=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,Z=typeof a!="number"&&a.unit==="px"?a.amount:void 0,ce=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(F!==null&&I!==null){let oe={x:0,y:0,width:0,height:0},Xe=0,Ie=0;if((B!==void 0||G!==void 0)&&(oe=F.getBounds((B??0)+v,G??0)??oe,oe.width===0||oe.height===0))return;const Qe=I.getBoundingClientRect(),Be=Qe.width/I.offsetWidth;if(Z!==void 0&&(oe={...oe,x:Z-Qe.left-st.current.scrollLeft,width:1}),ce!==void 0&&(oe={...oe,y:ce+Qe.top-st.current.scrollTop,height:1}),oe!==void 0){const be={x:oe.x-S,y:oe.y-A,width:oe.width+2*S,height:oe.height+2*A};let xe=0;for(let Mi=0;Mi<Oe;Mi++)xe+=un[Mi].width;let ot=0;const fe=Bt+(Pe?1:0);fe>0&&(ot=yo(Wt,fe,Tn));let dt=xe*Be+Qe.left+v*_*Be,Mt=Qe.right,Zt=Qe.top+Qo*Be,gn=Qe.bottom-ot*Be;const Wr=oe.width+S*2;switch(O==null?void 0:O.hAlign){case"start":Mt=dt+Wr;break;case"end":dt=Mt-Wr;break;case"center":dt=Math.floor((dt+Mt)/2)-Wr/2,Mt=dt+Wr;break}const $r=oe.height+A*2;switch(O==null?void 0:O.vAlign){case"start":gn=Zt+$r;break;case"end":Zt=gn-$r;break;case"center":Zt=Math.floor((Zt+gn)/2)-$r/2,gn=Zt+$r;break}dt>be.x?Xe=be.x-dt:Mt<be.x+be.width&&(Xe=be.x+be.width-Mt),Zt>be.y?Ie=be.y-Zt:gn<be.y+be.height&&(Ie=be.y+be.height-gn),C==="vertical"||typeof a=="number"&&a<Oe?Xe=0:(C==="horizontal"||typeof p=="number"&&p>=Wt-fe)&&(Ie=0),(Xe!==0||Ie!==0)&&(Be!==1&&(Xe/=Be,Ie/=Be),st.current.scrollTo({left:Xe+st.current.scrollLeft,top:Ie+st.current.scrollTop,behavior:(O==null?void 0:O.behavior)??"auto"}))}}}},[v,Bt,_,st,Qo,Oe,un,Wt,Pe,Tn]),gi=s.useRef(ol),mi=s.useRef(R);gi.current=ol,mi.current=R;const wi=s.useRef(Ee);wi.current=Ee;const rl=s.useRef(je.length);rl.current=je.length;const Kn=s.useCallback(async(a,p=!0,C)=>{var G;const S=je[a];if(((G=S==null?void 0:S.trailingRowOptions)==null?void 0:G.disabled)===!0)return;const A=ke==null?void 0:ke();let O,F=!0;A!==void 0&&(O=await A,O==="top"&&(F=!1),typeof O=="number"&&(F=!1));let I=0;const B=()=>{if(wi.current<=Ee){I<500&&window.setTimeout(B,I),I=50+I*2;return}const Z=typeof O=="number"?O:F?Ee:0;Lr.current(a-v,Z,"both",0,20,C?{behavior:C}:void 0),kt({cell:[a,Z],range:{x:a,y:Z,width:1,height:1}},!1,!1,"edit");const ce=mi.current([a-v,Z]);ce.allowOverlay&&Wo(ce)&&ce.readonly!==!0&&p&&window.setTimeout(()=>{gi.current(a,Z)},0)};B()},[je,ke,v,Ee,kt]),Hr=s.useCallback(async(a,p=!0)=>{const C=ze==null?void 0:ze();let S,A=!0;C!==void 0&&(S=await C,S==="left"&&(A=!1),typeof S=="number"&&(A=!1));let O=0;const F=()=>{if(rl.current<=je.length){O<500&&window.setTimeout(F,O),O=50+O*2;return}const I=typeof S=="number"?S:A?je.length:0;St(I-v,a),kt({cell:[I,a],range:{x:I,y:a,width:1,height:1}},!1,!1,"edit");const B=mi.current([I-v,a]);B.allowOverlay&&Wo(B)&&B.readonly!==!0&&p&&window.setTimeout(()=>{gi.current(I,a)},0)};F()},[je,ze,v,St,kt]),Ao=s.useCallback(a=>{var C,S;const p=((S=(C=un[a])==null?void 0:C.trailingRowOptions)==null?void 0:S.targetColumn)??(Ge==null?void 0:Ge.targetColumn);if(typeof p=="number")return p+(re?1:0);if(typeof p=="object"){const A=k.indexOf(p);if(A>=0)return A+(re?1:0)}},[un,k,re,Ge==null?void 0:Ge.targetColumn]),Vn=s.useRef(void 0),zo=s.useRef(void 0),tr=s.useCallback((a,p)=>{var A;const[C,S]=p;return On(Ht,(A=je[C])==null?void 0:A.themeOverride,tn==null?void 0:tn(S),a.themeOverride)},[tn,je,Ht]),{mapper:uo}=Ud(vt,y),vn=vt==null?void 0:vt.navigationBehavior,nr=s.useCallback(a=>{var G,Z,ce;const p=jr.value?a.metaKey:a.ctrlKey,C=p&&me==="multi",[S,A]=a.location,O=D.columns,F=D.rows,[I,B]=((G=D.current)==null?void 0:G.cell)??[];if(a.kind==="cell"){if(zo.current=void 0,fo.current=[S,A],S===(en?1:0)&&re){if(ae===!0&&A===Ee||jt==="number"||me==="none")return;const Ie=rn(a.location);if(Ie.kind!==$t.Marker||Ie.disabled===!0)return;if(Yn!==void 0){const be=Kt(Ie);ln((be==null?void 0:be.kind)===$t.Marker);const xe=(Z=be==null?void 0:be.onClick)==null?void 0:Z.call(be,{...a,cell:Ie,posX:a.localEventX,posY:a.localEventY,bounds:a.bounds,theme:tr(Ie,a.location),preventDefault:()=>{}});if(xe===void 0||xe.checked===Ie.checked)return}i(void 0),Yt();const Qe=F.hasIndex(A),Be=Vn.current;if(me==="multi"&&(a.shiftKey||a.isLongTouch===!0)&&Be!==void 0&&F.hasIndex(Be)){const be=[Math.min(Be,A),Math.max(Be,A)+1];C||Et==="multi"?Tt(void 0,be,!0):Tt(rt.fromSingleSelection(be),void 0,C)}else me==="multi"&&(C||a.isTouch||Et==="multi")?Qe?Tt(F.remove(A),void 0,!0):(Tt(void 0,A,!0),Vn.current=A):Qe&&F.length===1?Tt(rt.empty(),void 0,p):(Tt(rt.fromSingleSelection(A),void 0,p),Vn.current=A)}else if(S>=v&&ae&&A===Ee){const Ie=Ao(S);Kn(Ie??S)}else if(I!==S||B!==A){const Ie=rn(a.location),Qe=Kt(Ie);if((Qe==null?void 0:Qe.onSelect)!==void 0){let xe=!1;if(Qe.onSelect({...a,cell:Ie,posX:a.localEventX,posY:a.localEventY,bounds:a.bounds,preventDefault:()=>xe=!0,theme:tr(Ie,a.location)}),xe)return}if(vn==="block"&&uo(A).isGroupHeader)return;const Be=Pe&&A===Ee,be=Pe&&D!==void 0&&((ce=D.current)==null?void 0:ce.cell[1])===Ee;if((a.shiftKey||a.isLongTouch===!0)&&I!==void 0&&B!==void 0&&D.current!==void 0&&!be){if(Be)return;const xe=Math.min(S,I),ot=Math.max(S,I),fe=Math.min(A,B),dt=Math.max(A,B);kt({...D.current,range:{x:xe,y:fe,width:ot-xe+1,height:dt-fe+1}},!0,p,"click"),Vn.current=void 0,Yt()}else kt({cell:[S,A],range:{x:S,y:A,width:1,height:1}},!0,p,"click"),Vn.current=void 0,i(void 0),Yt()}}else if(a.kind==="header")if(fo.current=[S,A],i(void 0),re&&S===0)Vn.current=void 0,zo.current=void 0,!lo&&me==="multi"&&(F.length!==Ee?Tt(rt.fromSingleSelection([0,Ee]),void 0,p):Tt(rt.empty(),void 0,p),Yt());else{const oe=zo.current;if(q==="multi"&&(a.shiftKey||a.isLongTouch===!0)&&oe!==void 0&&O.hasIndex(oe)){const Xe=[Math.min(oe,S),Math.max(oe,S)+1];p||a.isTouch||It==="multi"?Ft(void 0,Xe,p):Ft(rt.fromSingleSelection(Xe),void 0,p)}else q==="multi"&&(p||a.isTouch||It==="multi")?(O.hasIndex(S)?Ft(O.remove(S),void 0,p):Ft(void 0,S,p),zo.current=S):q!=="none"&&(O.hasIndex(S)?Ft(O.remove(S),void 0,p):Ft(rt.fromSingleSelection(S),void 0,p),zo.current=S);Vn.current=void 0,Yt()}else a.kind===xn?fo.current=[S,A]:a.kind===Zr&&!a.isMaybeScrollbar&&(xt(Fi,!1),i(void 0),Yt(),Pt==null||Pt(),Vn.current=void 0,zo.current=void 0)},[me,q,D,re,v,ae,Ee,jt,rn,Yn,Yt,Et,It,Kt,tr,Tt,Ao,Kn,vn,uo,Pe,kt,lo,Ft,xt,Pt]),or=s.useRef(!1),fo=s.useRef(void 0),il=s.useRef(ao),hn=s.useRef(void 0),Hs=s.useCallback(a=>{if(Po.current=!1,il.current=on.current,a.button!==0&&a.button!==1){hn.current=void 0;return}const p=performance.now();hn.current={button:a.button,time:p,location:a.location},(a==null?void 0:a.kind)==="header"&&(or.current=!0);const C=a.kind==="cell"&&a.isFillHandle;!C&&a.kind!=="cell"&&a.isEdge||(f({previousSelection:D,fillHandle:C}),fo.current=void 0,!a.isTouch&&a.button===0&&!C?nr(a):!a.isTouch&&a.button===1&&(fo.current=a.location))},[D,nr]),[bi,yi]=s.useState(),ll=s.useCallback(a=>{if(a.kind!==xn||q!=="multi")return;const p=jr.value?a.metaKey:a.ctrlKey,[C]=a.location,S=D.columns;if(C<v)return;const A=je[C];let O=C,F=C;for(let I=C-1;I>=v&&gr(A.group,je[I].group);I--)O--;for(let I=C+1;I<je.length&&gr(A.group,je[I].group);I++)F++;if(Yt(),p||a.isTouch||It==="multi")if(S.hasAll([O,F+1])){let I=S;for(let B=O;B<=F;B++)I=I.remove(B);Ft(I,void 0,p)}else Ft(void 0,[O,F+1],p);else Ft(rt.fromSingleSelection([O,F+1]),void 0,p)},[q,Yt,D.columns,je,v,Ft,It]),Po=s.useRef(!1),Ar=s.useCallback(async a=>{if(qe!==void 0&&_t!==void 0){const p=on.current.y,C=on.current.height;let S=qe({x:a,y:p,width:1,height:Math.min(C,Ee-p)},Ve.current.signal);typeof S!="object"&&(S=await S());const A=un[a-v],F=document.createElement("canvas").getContext("2d",{alpha:!1});if(F!==null){F.font=Ht.baseFontFull;const I=fs(F,Ht,A,0,S,Dn,Io,!1,Kt);_t==null||_t(A,I.width,a,I.width)}}},[un,qe,Io,Ht,Dn,_t,v,Ee,Kt]),[As,pi]=s.useState(),Bo=s.useCallback(async(a,p)=>{var I,B;const C=(I=a.current)==null?void 0:I.range;if(C===void 0||qe===void 0||p.current===void 0)return;const S=p.current.range;if(z!==void 0){let G=!1;if(z({fillDestination:{...S,x:S.x-v},patternSource:{...C,x:C.x-v},preventDefault:()=>G=!0}),G)return}let A=qe(C,Ve.current.signal);typeof A!="object"&&(A=await A());const O=A,F=[];for(let G=0;G<S.width;G++)for(let Z=0;Z<S.height;Z++){const ce=[S.x+G,S.y+Z];if(es(ce,C))continue;const oe=O[Z%C.height][G%C.width];$o(oe)||!Wo(oe)||F.push({location:ce,value:{...oe}})}fn(F),(B=Lt.current)==null||B.damage(F.map(G=>({cell:G.location})))},[qe,fn,z,v]),sl=s.useCallback(()=>{if(D.current===void 0||D.current.range.width<=1)return;const a={...D,current:{...D.current,range:{...D.current.range,width:1}}};Bo(a,D)},[Bo,D]),al=s.useCallback(()=>{if(D.current===void 0||D.current.range.height<=1)return;const a={...D,current:{...D.current,range:{...D.current.range,height:1}}};Bo(a,D)},[Bo,D]),zs=s.useCallback((a,p)=>{var Z,ce;const C=d;if(f(void 0),fi(void 0),pi(void 0),or.current=!1,p)return;if((C==null?void 0:C.fillHandle)===!0&&D.current!==void 0&&((Z=C.previousSelection)==null?void 0:Z.current)!==void 0){if(co===void 0)return;const oe={...D,current:{...D.current,range:bs(C.previousSelection.current.range,co)}};Bo(C.previousSelection,oe),xt(oe,!0);return}const[S,A]=a.location,[O,F]=fo.current??[],I=()=>{Po.current=!0},B=oe=>{var Ie,Qe,Be;const Xe=oe.isTouch||O===S&&F===A;if(Xe&&($==null||$([S-v,A],{...oe,preventDefault:I})),oe.button===1)return!Po.current;if(!Po.current){const be=rn(a.location),xe=Kt(be);if(xe!==void 0&&xe.onClick!==void 0&&Xe){const fe=xe.onClick({...oe,cell:be,posX:oe.localEventX,posY:oe.localEventY,bounds:oe.bounds,theme:tr(be,a.location),preventDefault:I});fe!==void 0&&!$o(fe)&&Lo(fe)&&(fn([{location:oe.location,value:fe}]),(Ie=Lt.current)==null||Ie.damage([{cell:oe.location}]))}if(Po.current||D.current===void 0)return!1;let ot=!1;switch(be.activationBehaviorOverride??Ye){case"double-click":case"second-click":{if(((Be=(Qe=C==null?void 0:C.previousSelection)==null?void 0:Qe.current)==null?void 0:Be.cell)===void 0)break;const[fe,dt]=D.current.cell,[Mt,Zt]=C.previousSelection.current.cell;ot=S===fe&&S===Mt&&A===dt&&A===Zt&&(oe.isDoubleClick===!0||Ye==="second-click");break}case"single-click":{ot=!0;break}}if(ot){const dt={inputType:"pointer",pointerActivation:oe.isDoubleClick===!0?"double-click":be.activationBehaviorOverride??Ye,pointerType:oe.isTouch?"touch":"mouse"};return L==null||L([S-v,A],dt),er(oe.bounds,dt),!0}}return!1},G=a.location[0]-v;if(a.isTouch){const oe=on.current,Xe=il.current;if(oe.x!==Xe.x||oe.y!==Xe.y)return;if(a.isLongTouch===!0){if(a.kind==="cell"&&ur((ce=D.current)==null?void 0:ce.cell,a.location)){he==null||he([G,a.location[1]],{...a,preventDefault:I});return}else if(a.kind==="header"&&D.columns.hasIndex(S)){ye==null||ye(G,{...a,preventDefault:I});return}else if(a.kind===xn){if(G<0)return;U==null||U(G,{...a,preventDefault:I});return}}a.kind==="cell"?B(a)||nr(a):a.kind===xn?V==null||V(G,{...a,preventDefault:I}):(a.kind===eo&&(W==null||W(G,{...a,preventDefault:I})),nr(a));return}if(a.kind==="header"){if(G<0)return;a.isEdge?a.isDoubleClick===!0&&Ar(S):a.button===0&&S===O&&A===F&&(W==null||W(G,{...a,preventDefault:I}))}if(a.kind===xn){if(G<0)return;a.button===0&&S===O&&A===F&&(V==null||V(G,{...a,preventDefault:I}),Po.current||ll(a))}a.kind==="cell"&&(a.button===0||a.button===1)&&B(a),fo.current=void 0},[d,D,v,co,Bo,xt,$,rn,Kt,Ye,tr,fn,L,er,he,ye,U,nr,V,W,Ar,ll]),Ps=s.useCallback(a=>{const p={...a,location:[a.location[0]-v,a.location[1]]};ct==null||ct(p),d!==void 0&&a.buttons===0&&(f(void 0),fi(void 0),pi(void 0),or.current=!1),pi(C=>{var S;return or.current?[a.scrollEdge[0],0]:a.scrollEdge[0]===(C==null?void 0:C[0])&&a.scrollEdge[1]===C[1]?C:d===void 0||(((S=hn.current)==null?void 0:S.location[0])??0)<v?void 0:a.scrollEdge})},[d,ct,v]),Bs=s.useCallback((a,p)=>{De==null||De(a-v,p)},[De,v]),Ls=s.useCallback((a,p)=>{Re==null||Re(a-v,p)},[Re,v]);s.useEffect(()=>{if(r===void 0)return;const a=S=>{const A=[];let O=S.parentElement;for(;O&&O!==document.documentElement;){const F=window.getComputedStyle(O),I=F.overflow+F.overflowY+F.overflowX;(I.includes("scroll")||I.includes("auto"))&&A.push(O),O=O.parentElement}return A},p=S=>{const A=S.target;st.current&&!st.current.contains(A)&&i(void 0)},C=[];if(st.current){const S=a(st.current);C.push(...S)}return C.forEach(S=>{S.addEventListener("scroll",p)}),window.addEventListener("scroll",p),document.addEventListener("scroll",p,!0),()=>{C.forEach(S=>{S.removeEventListener("scroll",p)}),window.removeEventListener("scroll",p),document.removeEventListener("scroll",p,!0)}},[r,i,st]);const Hn=(wl=D==null?void 0:D.current)==null?void 0:wl.cell,Ws=s.useCallback((a,p,C,S,A,O)=>{if(Er.current=!1,r!==void 0){const Z=on.current;(Z.x!==a.x||Z.y!==a.y)&&i(void 0)}let F=Hn;F!==void 0&&(F=[F[0]-v,F[1]]);const I=Oe===0?void 0:{x:0,y:a.y,width:Oe,height:a.height},B=[];I!==void 0&&B.push(I),Bt>0&&(B.push({x:a.x-v,y:Ee-Bt,width:a.width,height:Bt}),Oe>0&&B.push({x:0,y:Ee-Bt,width:Oe,height:Bt}));const G={x:a.x-v,y:a.y,width:a.width,height:ae&&a.y+a.height>=Ee?a.height-1:a.height,tx:A,ty:O,extras:{selected:F,freezeRegion:I,freezeRegions:B}};on.current=G,tl(G),di([p,C,S]),cn==null||cn(G,G.tx,G.ty,G.extras)},[Hn,r,v,ae,Ee,Oe,Bt,i,tl,cn]),$s=Qn(T,s.useCallback((a,p)=>(T==null?void 0:T(a-v,p-v))!==!1,[T,v])),Ns=Qn(He,s.useCallback((a,p)=>{He==null||He(a-v,p-v),q!=="none"&&Ft(rt.fromSingleSelection(p),void 0,!0)},[q,He,v,Ft])),vi=s.useRef(!1),Os=s.useCallback(a=>{if(a.location[0]===0&&v>0){a.preventDefault();return}et==null||et({...a,location:[a.location[0]-v,a.location[1]]}),a.defaultPrevented()||(vi.current=!0),f(void 0)},[et,v]),Xs=s.useCallback(()=>{vi.current=!1},[]),cl=vt==null?void 0:vt.selectionBehavior,zr=s.useCallback(a=>{if(cl!=="block-spanning")return;const{isGroupHeader:p,path:C,groupRows:S}=uo(a);if(p)return[a,a];const A=C[C.length-1],O=a-A,F=a+S-A-1;return[O,F]},[uo,cl]),Ci=s.useRef(void 0),xi=s.useCallback(a=>{var p,C,S;if(!ks(a,Ci.current)&&(Ci.current=a,!(((p=hn==null?void 0:hn.current)==null?void 0:p.button)!==void 0&&hn.current.button>=1))){if(a.buttons!==0&&d!==void 0&&((C=hn.current)==null?void 0:C.location[0])===0&&v===1&&me==="multi"&&d.previousSelection&&!d.previousSelection.rows.hasIndex(hn.current.location[1])&&D.rows.hasIndex(hn.current.location[1])){const A=Math.min(hn.current.location[1],a.location[1]),O=Math.max(hn.current.location[1],a.location[1])+1;Tt(rt.fromSingleSelection([A,O]),void 0,!1)}else if(a.buttons!==0&&d!==void 0&&D.current!==void 0&&!vi.current&&!or.current&&(mt==="rect"||mt==="multi-rect")){const[A,O]=D.current.cell;let[F,I]=a.location;if(I<0&&(I=on.current.y),d.fillHandle===!0&&((S=d.previousSelection)==null?void 0:S.current)!==void 0){const B=d.previousSelection.current.range;I=Math.min(I,ae?Ee-1:Ee);const G=Hc(B,F,I,Qt);fi(G)}else{if(ae&&O===Ee)return;if(ae&&I===Ee)if(a.kind===Zr)I--;else return;F=Math.max(F,v);const Z=zr(O);I=Z===void 0?I:mn(I,Z[0],Z[1]);const ce=F-A,oe=I-O,Xe={x:ce>=0?A:F,y:oe>=0?O:I,width:Math.abs(ce)+1,height:Math.abs(oe)+1};kt({...D.current,range:Xe},!0,!1,"drag")}}Nt==null||Nt({...a,location:[a.location[0]-v,a.location[1]]})}},[d,v,me,D,mt,Nt,Tt,ae,Ee,Qt,zr,kt]),Ys=s.useCallback(()=>{var F,I;const a=Ci.current;if(a===void 0)return;const[p,C]=a.scrollEdge;let[S,A]=a.location;const O=on.current;p===-1?S=((I=(F=O.extras)==null?void 0:F.freezeRegion)==null?void 0:I.x)??O.x:p===1&&(S=O.x+O.width),C===-1?A=Math.max(0,O.y):C===1&&(A=Math.min(Ee-1,O.y+O.height)),S=mn(S,0,je.length-1),A=mn(A,0,Ee-1),xi({...a,location:[S,A]})},[je.length,xi,Ee]);Od(As,st,Ys);const Cn=s.useCallback(a=>{if(D.current===void 0)return;const[p,C]=a,[S,A]=D.current.cell,O=D.current.range;let F=O.x,I=O.x+O.width,B=O.y,G=O.y+O.height;const[Z,ce]=zr(A)??[0,Ee-1],oe=ce+1;if(C!==0)switch(C){case 2:{G=oe,B=A,St(0,G,"vertical");break}case-2:{B=Z,G=A+1,St(0,B,"vertical");break}case 1:{B<A?(B++,St(0,B,"vertical")):(G=Math.min(oe,G+1),St(0,G,"vertical"));break}case-1:{G>A+1?(G--,St(0,G,"vertical")):(B=Math.max(Z,B-1),St(0,B,"vertical"));break}default:hr()}if(p!==0)if(p===2)I=je.length,F=S,St(I-1-v,0,"horizontal");else if(p===-2)F=v,I=S+1,St(F-v,0,"horizontal");else{let Xe=[];if(qe!==void 0){const Ie=qe({x:F,y:B,width:I-F-v,height:G-B},Ve.current.signal);typeof Ie=="object"&&(Xe=Zd(Ie))}if(p===1){let Ie=!1;if(F<S){if(Xe.length>0){const Qe=mo(F+1,S+1).find(Be=>!Xe.includes(Be-v));Qe!==void 0&&(F=Qe,Ie=!0)}else F++,Ie=!0;Ie&&St(F,0,"horizontal")}Ie||(I=Math.min(je.length,I+1),St(I-1-v,0,"horizontal"))}else if(p===-1){let Ie=!1;if(I>S+1){if(Xe.length>0){const Qe=mo(I-1,S,-1).find(Be=>!Xe.includes(Be-v));Qe!==void 0&&(I=Qe,Ie=!0)}else I--,Ie=!0;Ie&&St(I-v,0,"horizontal")}Ie||(F=Math.max(v,F-1),St(F-v,0,"horizontal"))}else hr()}kt({cell:D.current.cell,range:{x:F,y:B,width:I-F,height:G-B}},!0,!1,"keyboard-select")},[qe,zr,D,je.length,v,Ee,St,kt]),ki=s.useRef(oo);ki.current=oo;const qn=s.useCallback((a,p,C,S)=>{const A=Wt-(C?0:1);a=mn(a,v,un.length-1+v),p=mn(p,0,A);const O=Hn==null?void 0:Hn[0],F=Hn==null?void 0:Hn[1];if(a===O&&p===F)return!1;if(S&&D.current!==void 0){const I=[...D.current.rangeStack];(D.current.range.width>1||D.current.range.height>1)&&I.push(D.current.range),xt({...D,current:{cell:[a,p],range:{x:a,y:p,width:1,height:1},rangeStack:I}},!0)}else kt({cell:[a,p],range:{x:a,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===a&&u.current[1]===p&&(u.current=void 0),ki.current&&St(a-v,p,"both",0,20),!0},[Wt,v,un.length,Hn,D,St,xt,kt]),Gs=s.useCallback((a,p)=>{(r==null?void 0:r.cell)!==void 0&&a!==void 0&&Lo(a)&&(fn([{location:r.cell,value:a}]),window.requestAnimationFrame(()=>{var A;(A=Lt.current)==null||A.damage([{cell:r.cell}])})),Yt(!0),i(void 0);const[C,S]=p;if(D.current!==void 0&&(C!==0||S!==0)){const A=D.current.cell[1]===Wt-1;if(A&&S===1){P==null||P(a,[0,0]);return}const O=D.current.cell[0]===je.length-1&&a!==void 0;let F=!0;if(A&&S===1&&ke!==void 0){F=!1;const I=D.current.cell[0]+C,B=Ao(I);Kn(B??I,!1)}if(O&&C===1&&ze!==void 0){F=!1;const I=D.current.cell[1]+S;Hr(I,!1)}if(F){let I=D.current.cell[0]+C,B=D.current.cell[1]+S,G=!1;En&&C===1&&S===0?I>=je.length?B>=Wt-1?(I=D.current.cell[0],B=D.current.cell[1],G=!1):(I=v,B+=1,G=!0):G=!0:(I=mn(I,v,je.length-1),B=mn(B,0,Wt-1),G=En===!0&&C===0&&S===1),qn(I,B,A,!1),G&&window.setTimeout(()=>{var ce;const Z=R([I-v,B]);if(Wo(Z)){const oe=(ce=Lt.current)==null?void 0:ce.getBounds(I,B);if(oe&&Z.allowOverlay){const Xe={inputType:"keyboard",key:"Enter"};L==null||L([I-v,B],Xe),Ho({target:oe,content:Z,initialValue:void 0,cell:[I,B],highlight:!0,forceEditMode:!0,activation:Xe})}}},50)}}P==null||P(a,p)},[r==null?void 0:r.cell,Yt,D,P,fn,Wt,qn,je.length,Kn,Hr,ke,ze,Ao,R,v,L,Ho,En]),_s=s.useMemo(()=>`gdg-overlay-${jd++}`,[]),ho=s.useCallback(a=>{var C,S,A,O;Yt();const p=[];for(let F=a.x;F<a.x+a.width;F++)for(let I=a.y;I<a.y+a.height;I++){const B=R([F-v,I]);if(!B.allowOverlay&&B.kind!==Q.Boolean)continue;let G;if(B.kind===Q.Custom){const Z=Kt(B),ce=(C=Z==null?void 0:Z.provideEditor)==null?void 0:C.call(Z,{...B,location:[F-v,I]});(Z==null?void 0:Z.onDelete)!==void 0?G=Z.onDelete(B):ya(ce)&&(G=(S=ce==null?void 0:ce.deletedValue)==null?void 0:S.call(ce,B))}else if(Lo(B)&&B.allowOverlay||B.kind===Q.Boolean){const Z=Kt(B);G=(A=Z==null?void 0:Z.onDelete)==null?void 0:A.call(Z,B)}G!==void 0&&!$o(G)&&Lo(G)&&p.push({location:[F,I],value:G})}fn(p),(O=Lt.current)==null||O.damage(p.map(F=>({cell:F.location})))},[Yt,R,Kt,fn,v]),rr=r!==void 0,dl=s.useCallback(a=>{var be,xe,ot;const p=()=>{a.stopPropagation(),a.preventDefault()},C={didMatch:!1},{bounds:S}=a,A=D.columns,O=D.rows,F=M;if(!rr&&We(F.clear,a,C)){const fe=((be=D.current)==null?void 0:be.cell)??[v,0];xt({columns:rt.empty(),rows:rt.empty(),current:{cell:fe,range:{x:fe[0],y:fe[1],width:1,height:1},rangeStack:[]}},!1),Pt==null||Pt(),Yt()}else if(!rr&&We(F.selectAll,a,C))xt({columns:rt.empty(),rows:rt.empty(),current:{cell:((xe=D.current)==null?void 0:xe.cell)??[v,0],range:{x:v,y:0,width:k.length,height:Ee},rangeStack:[]}},!1);else if(We(F.search,a,C))(ot=c==null?void 0:c.current)==null||ot.focus({preventScroll:!0}),At(!0);else if(We(F.delete,a,C)){const fe=(Ut==null?void 0:Ut(D))??!0;if(fe!==!1){const dt=fe===!0?D:fe;if(dt.current!==void 0){ho(dt.current.range);for(const Mt of dt.current.rangeStack)ho(Mt)}for(const Mt of dt.rows)ho({x:v,y:Mt,width:k.length,height:1});for(const Mt of dt.columns)ho({x:Mt,y:0,width:1,height:Ee})}}if(C.didMatch)return p(),!0;if(D.current===void 0)return!1;let[I,B]=D.current.cell;const[,G]=D.current.cell;let Z=!1,ce=!1;if(We(F.scrollToSelectedCell,a,C))Lr.current(I-v,B);else if(q!=="none"&&We(F.selectColumn,a,C))A.hasIndex(I)?Ft(A.remove(I),void 0,!0):q==="single"?Ft(rt.fromSingleSelection(I),void 0,!0):Ft(void 0,I,!0);else if(me!=="none"&&We(F.selectRow,a,C))O.hasIndex(B)?Tt(O.remove(B),void 0,!0):me==="single"?Tt(rt.fromSingleSelection(B),void 0,!0):Tt(void 0,B,!0);else if(!rr&&S!==void 0&&We(F.activateCell,a,C))if(B===Ee&&ae)window.setTimeout(()=>{const fe=Ao(I);Kn(fe??I)},0);else{const fe={inputType:"keyboard",key:a.key};L==null||L([I-v,B],fe),er(S,fe)}else if(D.current.range.height>1&&We(F.downFill,a,C))al();else if(D.current.range.width>1&&We(F.rightFill,a,C))sl();else if(We(F.goToNextPage,a,C))B+=Math.max(1,on.current.height-4);else if(We(F.goToPreviousPage,a,C))B-=Math.max(1,on.current.height-4);else if(We(F.goToFirstCell,a,C))i(void 0),B=0,I=0;else if(We(F.goToLastCell,a,C))i(void 0),B=Number.MAX_SAFE_INTEGER,I=Number.MAX_SAFE_INTEGER;else if(We(F.selectToFirstCell,a,C))i(void 0),Cn([-2,-2]);else if(We(F.selectToLastCell,a,C))i(void 0),Cn([2,2]);else if(rr)We(F.closeOverlay,a,C)&&i(void 0),We(F.acceptOverlayDown,a,C)&&(i(void 0),B++),We(F.acceptOverlayUp,a,C)&&(i(void 0),B--),We(F.acceptOverlayLeft,a,C)&&(i(void 0),I--),We(F.acceptOverlayRight,a,C)&&(i(void 0),I++);else{if(We(F.goDownCell,a,C))B+=1;else if(We(F.goUpCell,a,C))B-=1;else if(We(F.goRightCell,a,C)){const fe=a.key==="Tab"&&!a.shiftKey;if(En===!0&&fe){const dt=je.length-1;I>=dt?B<Wt-1&&(I=v,B+=1):I+=1}else I+=1}else We(F.goLeftCell,a,C)?I-=1:We(F.goDownCellRetainSelection,a,C)?(B+=1,Z=!0):We(F.goUpCellRetainSelection,a,C)?(B-=1,Z=!0):We(F.goRightCellRetainSelection,a,C)?(I+=1,Z=!0):We(F.goLeftCellRetainSelection,a,C)?(I-=1,Z=!0):We(F.goToLastRow,a,C)?B=Ee-1:We(F.goToFirstRow,a,C)?B=Number.MIN_SAFE_INTEGER:We(F.goToLastColumn,a,C)?I=Number.MAX_SAFE_INTEGER:We(F.goToFirstColumn,a,C)?I=Number.MIN_SAFE_INTEGER:(mt==="rect"||mt==="multi-rect")&&(We(F.selectGrowDown,a,C)?Cn([0,1]):We(F.selectGrowUp,a,C)?Cn([0,-1]):We(F.selectGrowRight,a,C)?Cn([1,0]):We(F.selectGrowLeft,a,C)?Cn([-1,0]):We(F.selectToLastRow,a,C)?Cn([0,2]):We(F.selectToFirstRow,a,C)?Cn([0,-2]):We(F.selectToLastColumn,a,C)?Cn([2,0]):We(F.selectToFirstColumn,a,C)&&Cn([-2,0]));ce=C.didMatch}if(vn!==void 0&&vn!=="normal"&&B!==G){const fe=vn==="skip-up"||vn==="skip"||vn==="block",dt=vn==="skip-down"||vn==="skip"||vn==="block",Mt=B<G;if(Mt&&fe){for(;B>=0&&uo(B).isGroupHeader;)B--;B<0&&(B=G)}else if(!Mt&&dt){for(;B<Ee&&uo(B).isGroupHeader;)B++;B>=Ee&&(B=G)}}const Xe=qn(I,B,!1,Z),Ie=C.didMatch,Qe=a.key==="Tab";return Ie&&(Xe||!ce||Wn||En===!0&&Qe)&&p(),Ie},[vn,rr,D,M,q,me,mt,v,uo,Ee,qn,xt,Pt,k.length,Ut,Wn,ho,Ft,Tt,ae,Ao,Kn,L,er,al,sl,Cn,En,je.length,Wt]),ir=s.useCallback(a=>{let p=!1;Ze!==void 0&&Ze({...a,...a.location&&{location:[a.location[0]-v,a.location[1]]},cancel:()=>{p=!0}}),!p&&(dl(a)||D.current)},[at,Ze,dl,D,R,v,Ee,ae,L,er]),Us=s.useCallback((a,p)=>{const C=a.location[0]-v;if(a.kind==="header"&&(ye==null||ye(C,{...a,preventDefault:p})),a.kind===xn){if(C<0)return;U==null||U(C,{...a,preventDefault:p})}if(a.kind==="cell"){const[S,A]=a.location;he==null||he([C,A],{...a,preventDefault:p}),Ba(D,a.location)||qn(S,A,!1,!1)}},[D,he,U,ye,v,qn]),Si=s.useCallback(async a=>{var F,I,B;if(!M.paste)return;function p(G,Z,ce,oe){var Ie,Qe;const Xe=typeof ce=="object"?(ce==null?void 0:ce.join(`
`))??"":(ce==null?void 0:ce.toString())??"";if(!$o(G)&&Wo(G)&&G.readonly!==!0){const Be=Y==null?void 0:Y(Xe,G);if(Be!==void 0&&Lo(Be))return{location:Z,value:Be};const be=Kt(G);if(be===void 0)return;if(be.kind===Q.Custom){ln(G.kind===Q.Custom);const xe=(Ie=be.onPaste)==null?void 0:Ie.call(be,Xe,G.data);return xe===void 0?void 0:{location:Z,value:{...G,data:xe}}}else{const xe=(Qe=be.onPaste)==null?void 0:Qe.call(be,Xe,G,{formatted:oe,formattedString:typeof oe=="string"?oe:oe==null?void 0:oe.join(`
`),rawValue:ce});return xe===void 0?void 0:(ln(xe.kind===G.kind),{location:Z,value:xe})}}}const C=D.columns,S=D.rows,A=((F=st.current)==null?void 0:F.contains(document.activeElement))===!0||((I=l.current)==null?void 0:I.contains(document.activeElement))===!0;let O;if(D.current!==void 0?O=[D.current.range.x,D.current.range.y]:C.length===1?O=[C.first()??0,0]:S.length===1&&(O=[v,S.first()??0]),A&&O!==void 0){let G,Z;const ce="text/plain",oe="text/html";if(navigator.clipboard.read!==void 0){const Be=await navigator.clipboard.read();for(const be of Be){if(be.types.includes(oe)){const ot=await(await be.getType(oe)).text(),fe=Wl(ot);if(fe!==void 0){G=fe;break}}be.types.includes(ce)&&(Z=await(await be.getType(ce)).text())}}else if(navigator.clipboard.readText!==void 0)Z=await navigator.clipboard.readText();else if(a!==void 0&&(a==null?void 0:a.clipboardData)!==null){if(a.clipboardData.types.includes(oe)){const Be=a.clipboardData.getData(oe);G=Wl(Be)}G===void 0&&a.clipboardData.types.includes(ce)&&(Z=a.clipboardData.getData(ce))}else return;const[Xe,Ie]=O,Qe=[];do{if(j===void 0){const Be=rn(O),be=Z??(G==null?void 0:G.map(ot=>ot.map(fe=>fe.rawValue).join("	")).join("	"))??"",xe=p(Be,O,be,void 0);xe!==void 0&&Qe.push(xe);break}if(G===void 0){if(Z===void 0)return;G=zd(Z)}if(j===!1||typeof j=="function"&&(j==null?void 0:j([O[0]-v,O[1]],G.map(Be=>Be.map(be=>{var xe;return((xe=be.rawValue)==null?void 0:xe.toString())??""}))))!==!0)return;for(const[Be,be]of G.entries()){if(Be+Ie>=Ee)break;for(const[xe,ot]of be.entries()){const fe=[xe+Xe,Be+Ie],[dt,Mt]=fe;if(dt>=je.length||Mt>=Wt)continue;const Zt=rn(fe),gn=p(Zt,fe,ot.rawValue,ot.formatted);gn!==void 0&&Qe.push(gn)}}}while(!1);fn(Qe),(B=Lt.current)==null||B.damage(Qe.map(Be=>({cell:Be.location})))}},[Y,Kt,rn,D,M.paste,st,je.length,fn,Wt,j,v,Ee]);Vt("paste",Si,m,!1,!0);const lr=s.useCallback(async(a,p)=>{var F,I;if(!M.copy)return;const C=p===!0||((F=st.current)==null?void 0:F.contains(document.activeElement))===!0||((I=l.current)==null?void 0:I.contains(document.activeElement))===!0,S=D.columns,A=D.rows,O=(B,G)=>{if(!se)Nl(B,G,a);else{const Z=G.map(ce=>({kind:Q.Text,data:k[ce].title,displayData:k[ce].title,allowOverlay:!1}));Nl([Z,...B],G,a)}};if(C&&qe!==void 0){if(D.current!==void 0){let B=qe(D.current.range,Ve.current.signal);typeof B!="object"&&(B=await B()),O(B,mo(D.current.range.x-v,D.current.range.x+D.current.range.width-v))}else if(A!==void 0&&A.length>0){const G=[...A].map(Z=>{const ce=qe({x:v,y:Z,width:k.length,height:1},Ve.current.signal);return typeof ce=="object"?ce[0]:ce().then(oe=>oe[0])});if(G.some(Z=>Z instanceof Promise)){const Z=await Promise.all(G);O(Z,mo(k.length))}else O(G,mo(k.length))}else if(S.length>0){const B=[],G=[];for(const Z of S){let ce=qe({x:Z,y:0,width:1,height:Ee},Ve.current.signal);typeof ce!="object"&&(ce=await ce()),B.push(ce),G.push(Z-v)}if(B.length===1)O(B[0],G);else{const Z=B.reduce((ce,oe)=>ce.map((Xe,Ie)=>[...Xe,...oe[Ie]]));O(Z,G)}}}},[k,qe,D,M.copy,v,st,Ee,se]);Vt("copy",lr,m,!1,!1);const Ks=s.useCallback(async a=>{var C,S;if(!(!M.cut||!(((C=st.current)==null?void 0:C.contains(document.activeElement))===!0||((S=l.current)==null?void 0:S.contains(document.activeElement))===!0))&&(await lr(a),D.current!==void 0)){let A={current:{cell:D.current.cell,range:D.current.range,rangeStack:[]},rows:rt.empty(),columns:rt.empty()};const O=Ut==null?void 0:Ut(A);if(O===!1||(A=O===!0?A:O,A.current===void 0))return;ho(A.current.range)}},[ho,D,M.cut,lr,st,Ut]);Vt("cut",Ks,m,!1,!1);const Vs=s.useCallback((a,p)=>{if(Ne!==void 0){v!==0&&(a=a.map(A=>[A[0]-v,A[1]])),Ne(a,p);return}if(a.length===0||p===-1)return;const[C,S]=a[p];u.current!==void 0&&u.current[0]===C&&u.current[1]===S||(u.current=[C,S],qn(C,S,!1,!1))},[Ne,v,qn]),[Pr,Br]=((bl=Dt==null?void 0:Dt.current)==null?void 0:bl.cell)??[],Lr=s.useRef(St);Lr.current=St,s.useLayoutEffect(()=>{var a,p,C,S;ki.current&&!Er.current&&Pr!==void 0&&Br!==void 0&&(Pr!==((p=(a=nn.current)==null?void 0:a.current)==null?void 0:p.cell[0])||Br!==((S=(C=nn.current)==null?void 0:C.current)==null?void 0:S.cell[1]))&&Lr.current(Pr,Br),Er.current=!1},[Pr,Br]);const ul=D.current!==void 0&&(D.current.cell[0]>=je.length||D.current.cell[1]>=Wt);s.useLayoutEffect(()=>{ul&&xt(Fi,!1)},[ul,xt]);const qs=s.useMemo(()=>ae===!0&&(Ge==null?void 0:Ge.tint)===!0?rt.fromSingleSelection(Wt-1):rt.empty(),[Wt,ae,Ge==null?void 0:Ge.tint]),js=s.useCallback(a=>typeof Gt=="boolean"?Gt:(Gt==null?void 0:Gt(a-v))??!0,[v,Gt]),Zs=s.useMemo(()=>{if(bi===void 0||l.current===null)return null;const{bounds:a,group:p}=bi,C=l.current.getBoundingClientRect();return s.createElement(kd,{bounds:a,group:p,canvasBounds:C,onClose:()=>yi(void 0),onFinish:S=>{yi(void 0),ve==null||ve(p,S)}})},[ve,bi]),Js=Math.min(je.length,Oe+v);s.useImperativeHandle(t,()=>({appendRow:(a,p)=>Kn(a+v,p),appendColumn:(a,p)=>Hr(a,p),updateCells:a=>{var p;return v!==0&&(a=a.map(C=>({cell:[C.cell[0]+v,C.cell[1]]}))),(p=Lt.current)==null?void 0:p.damage(a)},getBounds:(a,p)=>{var C;if(!((l==null?void 0:l.current)===null||(st==null?void 0:st.current)===null)){if(a===void 0&&p===void 0){const S=l.current.getBoundingClientRect(),A=S.width/st.current.clientWidth;return{x:S.x-st.current.scrollLeft*A,y:S.y-st.current.scrollTop*A,width:st.current.scrollWidth*A,height:st.current.scrollHeight*A}}return(C=Lt.current)==null?void 0:C.getBounds((a??0)+v,p)}},focus:()=>{var a;return(a=Lt.current)==null?void 0:a.focus()},emit:async a=>{switch(a){case"delete":ir({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":ir({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":ir({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await lr(void 0,!0);break;case"paste":await Si();break}},scrollTo:St,remeasureColumns:a=>{for(const p of a)Ar(p+v)},getMouseArgsForPosition:(a,p,C)=>{if((Lt==null?void 0:Lt.current)===null)return;const S=Lt.current.getMouseArgsForPosition(a,p,C);if(S!==void 0)return{...S,location:[S.location[0]-v,S.location[1]]}}}),[Kn,Hr,Ar,st,lr,ir,Si,v,St]);const[fl,hl]=Hn??[],Qs=s.useCallback(a=>{const[p,C]=a;if(C===-1){q!=="none"&&(Ft(rt.fromSingleSelection(p),void 0,!1),Yt());return}fl===p&&hl===C||(kt({cell:a,range:{x:p,y:C,width:1,height:1}},!0,!1,"keyboard-nav"),St(p,C))},[q,Yt,St,fl,hl,kt,Ft]),[ea,ta]=s.useState(!1),gl=s.useRef(Kl(a=>{ta(a)},5)),na=s.useCallback(()=>{gl.current(!0),D.current===void 0&&D.columns.length===0&&D.rows.length===0&&d===void 0&&kt({cell:[v,Ir],range:{x:v,y:Ir,width:1,height:1}},!0,!1,"keyboard-select")},[Ir,D,d,v,kt]),oa=s.useCallback(()=>{gl.current(!1)},[]),[ra,ia]=s.useMemo(()=>{let a;const p=(Ke==null?void 0:Ke.scrollbarWidthOverride)??Pi(),C=Ee+(ae?1:0);if(typeof Tn=="number")a=Qo+C*Tn;else{let A=0;const O=Math.min(C,10);for(let F=0;F<O;F++)A+=Tn(F);A=Math.floor(A/O),a=Qo+C*A}a+=p;const S=je.reduce((A,O)=>O.width+A,0)+p;return[`${Math.min(1e5,S)}px`,`${Math.min(1e5,a)}px`]},[je,Ke==null?void 0:Ke.scrollbarWidthOverride,Tn,Ee,ae,Qo]),la=s.useMemo(()=>ja(Ht),[Ht]);return s.createElement(us.Provider,{value:Ht},s.createElement(Wd,{style:la,className:ue,inWidth:b??ra,inHeight:x??ia},s.createElement(pd,{fillHandle:_e,drawFocusRing:io,experimental:Ke,fixedShadowX:Pn,fixedShadowY:wr,getRowThemeOverride:tn,headerIcons:Xn,imageWindowLoader:Bn,initialSize:Ln,isDraggable:vo,onDragLeave:br,onRowMoved:Yn,overscrollX:ai,overscrollY:ci,preventDiagonalScrolling:ko,rightElement:So,rightElementProps:no,smoothScrollX:ei,smoothScrollY:yr,className:ue,enableGroups:ui,onCanvasFocused:na,onCanvasBlur:oa,canvasRef:l,onContextMenu:Us,theme:Ht,cellXOffset:Ts,cellYOffset:Ir,accessibilityHeight:ao.height,onDragEnd:Xs,columns:je,nonGrowWidth:Ji,drawHeader:dn,onColumnProposeMove:$s,drawCell:Zo,disabledRows:qs,freezeColumns:Js,lockColumns:v,firstColAccessible:v===0,getCellContent:rn,minColumnWidth:Dn,maxColumnWidth:Io,searchInputRef:c,showSearch:pe,onSearchClose:lt,highlightRegions:Fs,getCellsForSelection:qe,getGroupDetails:hi,headerHeight:Un,isFocused:ea,groupHeaderHeight:ui?Rr:0,freezeTrailingRows:Bt+(ae&&(Ge==null?void 0:Ge.sticky)===!0?1:0),hasAppendRow:ae,onColumnResize:_t,onColumnResizeEnd:ht,onColumnResizeStart:Fn,onCellFocused:Qs,onColumnMoved:Ns,onDragStart:Os,onHeaderMenuClick:Bs,onHeaderIndicatorClick:Ls,onItemHovered:xi,isFilling:(d==null?void 0:d.fillHandle)===!0,onMouseMove:Ps,onKeyDown:ir,onKeyUp:de,onMouseDown:Hs,onMouseUp:zs,onDragOverCell:yn,onDrop:Te,onSearchResultsChanged:Vs,onVisibleRegionChanged:Ws,clientSize:Jo,rowHeight:Tn,searchResults:K,searchValue:Ae,onSearchValueChange:ne,rows:Wt,scrollRef:st,selection:D,translateX:ao.tx,translateY:ao.ty,verticalBorder:js,gridRef:Lt,getCellRenderer:Kt,resizeIndicator:pr}),Zs,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(qd,{...r,validateCell:pn,bloom:X,id:_s,getCellRenderer:Kt,className:(Ke==null?void 0:Ke.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:ft,imageEditorOverride:g,portalElementRef:vr,onFinishEditing:Gs,markdownDivCreateNode:h,isOutsideClick:ri,customEventTarget:Ke==null?void 0:Ke.eventTarget}))))},Qd=s.forwardRef(Jd);function Yl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:c,height:l,x:d,y:f}=r,u=t.maxSize??i.checkboxMaxSize,m=Math.floor(r.y+l/2),g=Zl(u,l,i.cellVerticalPadding),w=jl(t.contentAlign??"center",d,c,i.cellHorizontalPadding,g),h=ql(w,m,g),b=Jl(d+n,f+o,h);return Xi(t)&&b}const eu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:Q.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>tu(e,e.cell.data,Xi(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Yl(e)&&e.preventDefault()},onClick:e=>{if(Yl(e))return{...e.cell,data:Ms(e.cell.data)}},onPaste:(e,t)=>{let n=_r;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Oi),n===t.data?void 0:{...t,data:n}}};function tu(e,t,n,o,r){if(!n&&t===_r)return;const{ctx:i,hoverAmount:c,theme:l,rect:d,highlighted:f,hoverX:u,hoverY:m,cell:{contentAlign:g}}=e,{x:w,y:h,width:b,height:x}=d;let k=!1;if(r>0){let y=n?1-r+r*c:.4;if(t===_r&&(y*=c),y===0)return;y<1&&(k=!0,i.globalAlpha=y)}Vr(i,l,t,w,h,b,x,f,u,m,o,g),k&&(i.globalAlpha=1)}const nu=an("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),ou=e=>{const{bubbles:t}=e;return s.createElement(nu,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},ru={getAccessibilityString:e=>Ql(e.data),kind:Q.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>iu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(ou,{bubbles:t.data})},onPaste:()=>{}};function iu(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:c,y:l,width:d,height:f}=n;let u=c+o.cellHorizontalPadding;const m=[];for(const g of t){if(u>c+d)break;const w=po(g,r,o.baseFontFull).width;m.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const g of m)An(r,g.x,l+(f-o.bubbleHeight)/2,g.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[g,w]of m.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[g],w.x+o.bubblePadding,l+f/2+wn(r,o))}const lu=an("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),su=e=>{const{drilldowns:t}=e;return s.createElement(lu,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},au={getAccessibilityString:e=>Ql(e.data.map(t=>t.text)),kind:Q.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>du(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(su,{drilldowns:t.data})},onPaste:()=>{}},Hi={};function cu(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,c=n-i*2,l=4,d=n*r,f=o+i,u=o*3,m=(u+i*2)*r,g=`${e},${t},${r},${n}`;if(Hi[g]!==void 0)return{el:Hi[g],height:d,width:m,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=m,w.height=d,h.scale(r,r),Hi[g]=w,h.beginPath(),An(h,i,i,u,c,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),An(h,i+.5,i+.5,u,c,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:d,width:m,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function du(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:c,row:l}=e,{x:d,width:f}=n,u=o.baseFontFull,m=ls(r,u),g=Math.min(n.height,Math.max(16,Math.ceil(m*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-g)/2),h=g-10,b=o.bubblePadding,x=o.bubbleMargin;let k=d+o.cellHorizontalPadding;const y=o.roundingRadius??6,R=cu(o.bgCell,o.drilldownBorder,g,y),$=[];for(const L of t){if(k>d+f)break;const P=po(L.text,r,u).width;let Y=0;L.img!==void 0&&i.loadOrGetImage(L.img,c,l)!==void 0&&(Y=h-8+4);const E=P+Y+b*2;$.push({x:k,width:E}),k+=E+x}if(R!==null){const{el:L,height:z,middleWidth:P,sideWidth:Y,width:E,dpr:N,padding:X}=R,W=Y/N,T=X/N;for(const H of $){const ie=Math.floor(H.x),V=Math.floor(H.width),he=V-(W-T)*2;r.imageSmoothingEnabled=!1,r.drawImage(L,0,0,Y,z,ie-T,w,W,g),he>0&&r.drawImage(L,Y,0,P,z,ie+(W-T),w,he,g),r.drawImage(L,E-Y,0,Y,z,ie+V-(W-T),w,W,g),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[L,z]of $.entries()){const P=t[L];let Y=z.x+b;if(P.img!==void 0){const E=i.loadOrGetImage(P.img,c,l);if(E!==void 0){const N=h-8;let X=0,W=0,T=E.width,H=E.height;T>H?(X+=(T-H)/2,T=H):H>T&&(W+=(H-T)/2,H=T),r.beginPath(),An(r,Y,w+g/2-N/2,N,N,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(E,X,W,T,H,Y,w+g/2-N/2,N,N),r.restore(),Y+=N+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(P.text,Y,w+g/2+wn(r,o))}}const uu={getAccessibilityString:e=>e.data.join(", "),kind:Q.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>fu(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??Ia;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Ai=4;function fu(e,t,n,o){const{rect:r,col:i,row:c,theme:l,ctx:d,imageLoader:f}=e,{x:u,y:m,height:g,width:w}=r,h=g-l.cellVerticalPadding*2,b=[];let x=0;for(let y=0;y<t.length;y++){const R=t[y];if(R.length===0)continue;const $=f.loadOrGetImage(R,i,c);if($!==void 0){b[y]=$;const L=$.width*(h/$.height);x+=L+Ai}}if(x===0)return;x-=Ai;let k=u+l.cellHorizontalPadding;o==="right"?k=Math.floor(u+w-l.cellHorizontalPadding-x):o==="center"&&(k=Math.floor(u+w/2-x/2));for(const y of b){if(y===void 0)continue;const R=y.width*(h/y.height);n>0&&(d.beginPath(),An(d,k,m+l.cellVerticalPadding,R,h,n),d.save(),d.clip()),d.drawImage(y,k,m+l.cellVerticalPadding,R,h),n>0&&d.restore(),k+=R+Ai}}function hu(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const gu={getAccessibilityString:()=>"",kind:Q.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:c}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(hu(n,o)*t.skeletonWidthVariability));const d=c.cellHorizontalPadding;l+d*2>=i.width&&(l=i.width-d*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*c.cellVerticalPadding);An(r,i.x+d,i.y+(i.height-f)/2,l,f,c.roundingRadius??3),r.fillStyle=bo(c.textDark,.1),r.fill()},onPaste:()=>{}},mu=()=>e=>e.targetWidth,Gl=an("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[mu(),"px"]}}),wu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:c,validatedSelection:l}=e,d=t.data,f=t.readonly===!0,[u,m]=s.useState(d===""||o),g=s.useCallback(()=>{m(h=>!h)},[]),w=d?"gdg-ml-6":"";return u?s.createElement(Gl,{targetWidth:i.width-20},s.createElement(_i,{autoFocus:!0,highlight:!1,validatedSelection:l,value:d,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${w}`,onClick:()=>c(t)},s.createElement(Ca,null))):s.createElement(Gl,{targetWidth:i.width},s.createElement(Ta,{contents:d,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${w}`,onClick:g},s.createElement(Yi,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},bu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:Jr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Nn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:c,validatedSelection:l}=e;return s.createElement(wu,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:d=>t({...n,data:d.target.value}),forceEditMode:c,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},yu={getAccessibilityString:e=>e.row.toString(),kind:$t.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:pu,measure:()=>44,draw:e=>Cu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e;if(n.disabled===!0)return;const{width:i,height:c}=t,l=n.drawHandle?7+(i-7)/2:i/2,d=c/2;if(Math.abs(o-l)<=10&&Math.abs(r-d)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function pu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=vu,n.textAlign="center",i}function vu(e){const{ctx:t}=e;t.textAlign="start"}function Cu(e,t,n,o,r,i,c){if(c){const{ctx:x,rect:k,theme:y}=e,{x:R,y:$,width:L,height:z}=k,P=o==="checkbox"?"checkbox-visible":o;if(P!=="number"&&(x.globalAlpha=n?1:.4,Vr(x,y,n,r?R+7:R,$,r?L-7:L,z,!1,-20,-20,y.checkboxMaxSize,"center",i,!0),x.globalAlpha=1),P==="number"||P==="both"&&!n){const Y=t.toString(),E=y.markerFontFull,N=R+L/2;x.fillStyle="#cccccc",x.font=E,x.fillText(Y,N,$+z/2+wn(x,E))}if(r){x.globalAlpha=.4,x.beginPath();for(const Y of[3,6])for(const E of[-5,-1,3])x.rect(R+Y,$+z/2+E,2,2);x.fillStyle="#cccccc",x.fill(),x.beginPath(),x.globalAlpha=1}return}const{ctx:l,rect:d,hoverAmount:f,theme:u}=e,{x:m,y:g,width:w,height:h}=d,b=n?1:o==="checkbox-visible"?.6+.4*f:f;if(o!=="number"&&b>0){l.globalAlpha=b;const x=7*(n?f:1);if(Vr(l,u,n,r?m+x:m,g,r?w-x:w,h,!0,void 0,void 0,u.checkboxMaxSize,"center",i,c),r){l.globalAlpha=f,l.beginPath();for(const k of[3,6])for(const y of[-5,-1,3])l.rect(m+k,g+h/2+y,2,2);l.fillStyle=u.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const x=t.toString(),k=u.markerFontFull,y=m+w/2;o==="both"&&f!==0&&(l.globalAlpha=1-f),l.fillStyle=u.textLight,l.font=k,l.fillText(x,y,g+h/2+wn(l,k)),f!==0&&(l.globalAlpha=1)}}const xu={getAccessibilityString:()=>"",kind:$t.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>ku(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function ku(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:c,spriteManager:l}=e,{x:d,y:f,width:u,height:m}=r;o.beginPath(),o.globalAlpha=i,o.rect(d+1,f+1,u,m-2),o.fillStyle=c.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let w=0;if(n!==void 0){const b=m-8,x=d+8/2,k=f+8/2;l.drawSprite(n,"normal",o,x,k,b,c,g?1:i),w=b}else{w=24;const h=12,b=g?h:i*h,x=g?0:(1-i)*h*.5,k=c.cellHorizontalPadding+4;b>0&&(o.moveTo(d+k+x,f+m/2),o.lineTo(d+k+x+b,f+m/2),o.moveTo(d+k+x+b*.5,f+m/2-b*.5),o.lineTo(d+k+x+b*.5,f+m/2+b*.5),o.lineWidth=2,o.strokeStyle=c.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=c.textMedium,o.fillText(t,w+d+c.cellHorizontalPadding+.5,f+m/2+wn(o,c)),o.beginPath()}function Is(e,t,n,o,r,i,c){e.textBaseline="alphabetic";const l=Su(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),An(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??bo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",c==null||c("text")}function Su(e,t,n,o,r){const i=o.cellHorizontalPadding,c=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+c/2+1,width:t.width-i,height:t.height-c-1};const l=po(n,e,o.baseFontFull,"alphabetic"),d=t.height-c,f=Math.min(d,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const Mu=s.lazy(async()=>await Ul(()=>import("./number-overlay-editor-pnQFXKxJ.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),Ru={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:Jr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:c}=e,{hoverEffect:l,displayData:d,hoverEffectTheme:f}=n;l===!0&&t>0&&Is(o,r,f,d,i,t,c),Nn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(Mu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Eu={getAccessibilityString:()=>"",measure:()=>108,kind:Q.Protected,needsHover:!1,needsHoverPosition:!1,draw:Iu,onPaste:()=>{}};function Iu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:c}=o;t.beginPath();const l=2.5;let d=r+n.cellHorizontalPadding+l;const f=i+c/2,u=Math.cos(kl(30))*l,m=Math.sin(kl(30))*l;for(let g=0;g<12;g++)t.moveTo(d,f-l),t.lineTo(d,f+l),t.moveTo(d+u,f-m),t.lineTo(d-u,f+m),t.moveTo(d-u,f-m),t.lineTo(d+u,f+m),d+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Du={getAccessibilityString:e=>e.rowId??"",kind:$t.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>po(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:r}=e,i=o.rowId;if(!i)return;t.fillStyle=r.textDark,t.font=r.baseFontStyle,t.textAlign="left";const c=n.x+r.cellHorizontalPadding,l=n.y+n.height/2;t.fillText(i,c,l+wn(t,r))},onClick:()=>{},onPaste:()=>{}},Tu={getAccessibilityString:e=>e.rowId??"",kind:$t.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:Fu,measure:()=>80,draw:e=>Au(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function Fu(e,t){const{ctx:n}=e,o="12px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=Hu,n.textAlign="left",r}function Hu(e){const{ctx:t}=e;t.textAlign="start"}function Au(e,t){if(!t)return;const{ctx:n,rect:o,theme:r}=e,{x:i,y:c,height:l}=o;n.fillStyle=r.textDark,n.font="12px sans-serif";const d=i+8,f=c+l/2;n.fillText(t,d,f+wn(n,n.font))}const zu={getAccessibilityString:e=>e.status??"",kind:$t.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:Pu,measure:()=>40,draw:e=>Lu(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function Pu(e,t){const{ctx:n}=e,o="bold 14px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=Bu,n.textAlign="center",r}function Bu(e){const{ctx:t}=e;t.textAlign="start"}function Lu(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:r,y:i,width:c,height:l}=o,d={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=d[t],n.font="bold 14px sans-serif";const f=r+c/2,u=i+l/2;n.fillText(t,f,u+wn(n,n.font))}const Wu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:Jr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:c,overrideCursor:l}=e,{displayData:d,contentAlign:f,hoverEffect:u,allowWrapping:m,hoverEffectTheme:g}=t;u===!0&&n>0&&Is(r,c,g,d,i,n,l),Nn(e,d,f,m,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(_i,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:c=>o({...r,data:c.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},$u=an("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),Nu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:c}=e,[l,d]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{d(!0)},[]);return l?s.createElement(_i,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement($u,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},c),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Yi,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function Ds(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,c=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-c-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-c/2),{x:r,y:i,width:c,height:l}}function _l(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,c=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=rs(c,i.baseFontFull);if(l===void 0)return!1;const d=Ds(l,n,i,t.contentAlign);return wo({x:d.x-4,y:d.y-4,width:d.width+8,height:d.height+8},o,r)}const Ou={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:Q.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:Jr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:c,ctx:l}=e,d=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=po(d,l,n.baseFontFull),m=Ds(u,c,n,t.contentAlign),{x:g,y:w,width:h,height:b}=m;if(r>=g-4&&r<=g-4+h+8&&i>=w-4&&i<=w-4+b+8){const x=wn(l,n.baseFontFull);o("pointer");const k=5,y=w-x;l.beginPath(),l.moveTo(c.x+g,Math.floor(c.y+y+b+k)+.5),l.lineTo(c.x+g+h,Math.floor(c.y+y+b+k)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Nn({...e,rect:{...c,x:c.x-1}},d,t.contentAlign),Nn({...e,rect:{...c,x:c.x-2}},d,t.contentAlign),Nn({...e,rect:{...c,x:c.x+1}},d,t.contentAlign),Nn({...e,rect:{...c,x:c.x+2}},d,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Nn(e,d,t.contentAlign)},onSelect:e=>{_l(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;_l(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(Nu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:c=>n({...o,data:c.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Xu=[yu,xu,zu,Tu,eu,ru,au,uu,gu,bu,Ru,Eu,Du,Wu,Ou],zi=[];class Yu extends as{constructor(){super(...arguments);Le(this,"imageLoaded",()=>{});Le(this,"loadedLocations",[]);Le(this,"cache",{});Le(this,"sendLoaded",ga(()=>{this.imageLoaded(new Oo(this.loadedLocations)),this.loadedLocations=[]},20));Le(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let c=0;c<r.cells.length;c++){const l=r.cells[c];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let c=!1;const l=zi.pop()??new Image;let d=!1;const f={img:void 0,cells:[kn(o,r)],url:n,cancel:()=>{d||(d=!0,zi.length<12?zi.unshift(l):c||(l.src=""))}},u=new Promise(m=>l.addEventListener("load",()=>m(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const m=this.cache[i];if(m!==void 0&&!d){m.img=l;for(const g of m.cells)this.loadedLocations.push(Vi(g));c=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,c=this.cache[i];if(c!==void 0){const l=kn(o,r);return c.cells.includes(l)||c.cells.push(l),c.img}else this.loadImage(n,o,r,i)}}const Gu=(e,t)=>{const n=s.useMemo(()=>({...Dc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??Xu,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new Yu,[e.imageWindowLoader]);return s.createElement(Qd,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},nf=s.forwardRef(Gu);export{vd as C,nf as D,Q as G,us as T,_i as a,ls as b,sn as c,ef as d,Qu as e,Zu as f,wn as g,Lo as h,Ju as i,vl as j,$o as k,ya as l,po as m,ja as n,Yo as p,An as r,tf as u};
