const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-CX6We0rl.js","./iframe-Cdn7Weob.js","./preload-helper-C1FmrZbK.js","./index-BCEAkrMu.js","./image-window-loader-CDJX2pm9.js","./throttle-BQPBlX3O.js","./marked.esm-Bd9Q6jcK.js","./image-window-loader-DhbFCWIb.css","./flatten-DaOm-iAz.js","./scrolling-data-grid-8nsunyS7.js","./scrolling-data-grid-wZ406GJK.css","./data-grid-overlay-editor-Cmj_ecGQ.css"])))=>i.map(i=>d[i]);
var Yl=Object.defineProperty;var ql=(t,o,c)=>o in t?Yl(t,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[o]=c;var Cn=(t,o,c)=>ql(t,typeof o!="symbol"?o+"":o,c);import{r as l,R as fe}from"./iframe-Cdn7Weob.js";import{_ as jl}from"./preload-helper-C1FmrZbK.js";import{G as oe,c as Oo,d as Go,r as lr,e as Wo,C as Y,g as mr,f as Zl,w as gt,h as Jl,j as Ql,k as pn,l as ir,I as lo,p as ei,n as ti,t as oi,o as ni,q as Wt,s as cr,v as sr,x as ri,y as No,z as io,B as li,D as ii,E as ci,F as si,H as ai,J as ar,i as co,K as ui,L as di,M as ur,N as fi,b as bn,O as hi,P as gi,T as mi,Q as dr,A as vi,R as wi}from"./image-window-loader-CDJX2pm9.js";import{m as Et,r as Vt,g as Ci}from"./throttle-BQPBlX3O.js";import{u as pi,f as fr}from"./flatten-DaOm-iAz.js";import{G as bi}from"./scrolling-data-grid-8nsunyS7.js";import{s as Mn}from"./marked.esm-Bd9Q6jcK.js";const ee='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',yi=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}<rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},xi=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}<rect x="2" y="2" width="16" height="16" rx="4" fill="${c}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},ki=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},Mi=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},Ri=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${c}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},vr=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},Si=t=>{const o=t.bgColor;return`${ee}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Ti=vr,Ei=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},zi=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},Li=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Hi=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${c}"/>
  </svg>`},Di=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},Ii=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},Fi=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},$i=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Ai=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${c}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${c}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},Pi=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${c}"/>
</svg>`},Gi=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},Ni=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},Ki=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Oi=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},Wi=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Ui=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},Vi=t=>{const o=t.fgColor,c=t.bgColor;return`
    ${ee}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},Bi=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},Xi=t=>{const o=t.fgColor,c=t.bgColor;return`${ee}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},_i=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Yi=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},qi=t=>(t.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${t.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),ji=t=>(t.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${t.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),Zi={headerRowID:yi,headerNumber:ki,headerCode:xi,headerString:Mi,headerBoolean:Ri,headerAudioUri:Ti,headerVideoUri:Ei,headerEmoji:zi,headerImage:Li,headerUri:vr,headerPhone:Hi,headerMarkdown:Di,headerDate:Ii,headerTime:Fi,headerEmail:$i,headerReference:Ai,headerIfThenElse:Pi,headerSingleValue:Gi,headerLookup:Ni,headerTextTemplate:Ki,headerMath:Oi,headerRollup:Wi,headerJoinStrings:Ui,headerSplitString:Vi,headerGeoDistance:Bi,headerArray:Xi,rowOwnerOverlay:_i,protectedColumnOverlay:Yi,renameIcon:Si,headerArrowDown:qi,headerArrowUp:ji},Ji=Mn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),Qi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),ec=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),tc=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),oc=10,nc=t=>{const{canvasRef:o,cellYOffset:c,rows:f,columns:C,searchInputRef:y,searchValue:D,searchResults:p,onSearchValueChange:R,getCellsForSelection:z,onSearchResultsChanged:v,showSearch:M=!1,onSearchClose:E}=t,[K]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[V,j]=l.useState(""),ve=D??V,B=l.useCallback(L=>{j(L),R==null||R(L)},[R]),[I,O]=l.useState(),ye=l.useRef(I);ye.current=I,l.useEffect(()=>{p!==void 0&&(p.length>0?O(L=>({rowsSearched:f,results:p.length,selectedIndex:(L==null?void 0:L.selectedIndex)??-1})):O(void 0))},[f,p]);const te=l.useRef();te.current===void 0&&(te.current=new AbortController);const he=l.useRef(),[q,ne]=l.useState([]),re=p??q,Z=l.useCallback(()=>{he.current!==void 0&&(window.cancelAnimationFrame(he.current),he.current=void 0),te.current!==void 0&&te.current.abort(),te.current=new AbortController},[]),qe=l.useRef(c);qe.current=c;const Le=l.useCallback(L=>{const ce=new RegExp(L.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let de=qe.current,De=Math.min(10,f),Ke=0;O(void 0),ne([]);const vt=[],ao=async()=>{var rt;if(z===void 0)return;const Vo=performance.now(),Xt=f-Ke;let wt=z({x:0,y:de,width:C.length,height:Math.min(De,Xt,f-de)},te.current.signal);typeof wt=="function"&&(wt=await wt());let uo=!1;for(const[Ze,xe]of wt.entries())for(const[Se,Je]of xe.entries()){let Qe;switch(Je.kind){case oe.Text:case oe.Number:Qe=Je.displayData;break;case oe.Uri:case oe.Markdown:Qe=Je.data;break;case oe.Boolean:Qe=typeof Je.data=="boolean"?Je.data.toString():void 0;break;case oe.Image:case oe.Bubble:Qe=Je.data.join("üê≥");break;case oe.Custom:Qe=Je.copyData;break}Qe!==void 0&&ce.test(Qe)&&(vt.push([Se,Ze+de]),uo=!0)}const Bo=performance.now();uo&&ne([...vt]),Ke+=wt.length,Oo(Ke<=f);const je=((rt=ye.current)==null?void 0:rt.selectedIndex)??-1;O({results:vt.length,rowsSearched:Ke,selectedIndex:je}),v==null||v(vt,je),de+De>=f?de=0:de+=De;const nt=Bo-Vo,Ct=Math.max(nt,1),pt=oc/Ct;De=Math.ceil(De*pt),Ke<f&&vt.length<1e3&&(he.current=window.requestAnimationFrame(ao))};Z(),he.current=window.requestAnimationFrame(ao)},[Z,C.length,z,v,f]),Re=l.useCallback(()=>{var L;E==null||E(),O(void 0),ne([]),v==null||v([],-1),Z(),(L=o==null?void 0:o.current)==null||L.focus()},[Z,o,E,v]),so=l.useCallback(L=>{B(L.target.value),p===void 0&&(L.target.value===""?(O(void 0),ne([]),Z()):Le(L.target.value))},[Le,Z,B,p]);l.useEffect(()=>{y.current!==null&&(B(""),O(void 0),q.length>0&&(ne([]),v==null||v([],-1)),M?y.current.focus({preventScroll:!0}):Z())},[M,y]);const mt=l.useCallback(L=>{var de;if((de=L==null?void 0:L.stopPropagation)==null||de.call(L),I===void 0||I.results===0)return;const ce=(I.selectedIndex+1)%I.results;O({...I,selectedIndex:ce}),v==null||v(re,ce)},[I,v,re]),He=l.useCallback(L=>{var de;if((de=L==null?void 0:L.stopPropagation)==null||de.call(L),I===void 0||I.results===0)return;let ce=(I.selectedIndex-1)%I.results;ce<0&&(ce+=I.results),O({...I,selectedIndex:ce}),v==null||v(re,ce)},[v,re,I]),Ge=l.useCallback(L=>{(L.ctrlKey||L.metaKey)&&L.nativeEvent.code==="KeyF"||L.key==="Escape"?(Re(),L.stopPropagation(),L.preventDefault()):L.key==="Enter"&&(L.shiftKey?He():mt())},[Re,mt,He]);l.useEffect(()=>()=>{Z()},[Z]);const[Bt,Ne]=l.useState(!1);l.useEffect(()=>{if(M)Ne(!0);else{const L=setTimeout(()=>Ne(!1),150);return()=>clearTimeout(L)}},[M]);const Uo=l.useMemo(()=>{if(!M&&!Bt)return null;let L;I!==void 0&&(L=I.results>=1e3?"over 1000":`${I.results} result${I.results!==1?"s":""}`,I.selectedIndex>=0&&(L=`${I.selectedIndex+1} of ${L}`));const ce=Ke=>{Ke.stopPropagation()},De={width:`${f>0?Math.floor(((I==null?void 0:I.rowsSearched)??0)/f*100):0}%`};return l.createElement(Ji,{className:"gdg-search-bar"+(M?"":" out"),onMouseDown:ce,onMouseMove:ce,onMouseUp:ce,onClick:ce},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:K,"aria-hidden":!M,"data-testid":"search-input",ref:y,onChange:so,value:ve,tabIndex:M?void 0:-1,onKeyDownCapture:Ge}),l.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:He,disabled:((I==null?void 0:I.results)??0)===0},Qi),l.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:mt,disabled:((I==null?void 0:I.results)??0)===0},ec),E!==void 0&&l.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!M,"data-testid":"search-close-button",tabIndex:M?void 0:-1,onClick:Re},tc)),I!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},L)),l.createElement("div",{className:"gdg-search-progress",style:De})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:K},"Type to search")))},[M,Bt,I,f,K,y,so,ve,Ge,He,mt,E,Re]);return l.createElement(l.Fragment,null,l.createElement(bi,{prelightCells:re,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY,resizeIndicator:t.resizeIndicator}),Uo)};class rc extends l.PureComponent{constructor(){super(...arguments);Cn(this,"wrapperRef",l.createRef());Cn(this,"clickOutside",c=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(c))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(c.target)){let f=c.target;for(;f!==null;){if(f.classList.contains("click-outside-ignore"))return;f=f.parentElement}this.props.onClickOutside()}})}componentDidMount(){const c=this.props.customEventTarget??document;c.addEventListener("pointerdown",this.clickOutside,!0),c.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const c=this.props.customEventTarget??document;c.removeEventListener("pointerdown",this.clickOutside,!0),c.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:c,isOutsideClick:f,customEventTarget:C,...y}=this.props;return l.createElement("div",{...y,ref:this.wrapperRef},this.props.children)}}const lc=()=>t=>Math.max(16,t.targetHeight-10),ic=Mn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[lc(),"px"]}}),cc=t=>{const{bounds:o,group:c,onClose:f,canvasBounds:C,onFinish:y}=t,[D,p]=fe.useState(c);return fe.createElement(rc,{style:{position:"absolute",left:o.x-C.left+1,top:o.y-C.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:f},fe.createElement(ic,{targetHeight:o.height,"data-testid":"group-rename-input",value:D,onBlur:f,onFocus:R=>R.target.setSelectionRange(0,D.length),onChange:R=>p(R.target.value),onKeyDown:R=>{R.key==="Enter"?y(D):R.key==="Escape"&&f()},autoFocus:!0}))},xn=150;function sc(t,o,c,f){var y;const C=f(o);return((y=C==null?void 0:C.measure)==null?void 0:y.call(C,t,o,c))??xn}function wr(t,o,c,f,C,y,D,p,R){let z=0;const v=C===void 0?[]:C.map(K=>{const V=sc(t,K[f],o,R);return z=Math.max(z,V),V});if(v.length>5&&p){z=0;let K=0;for(const j of v)K+=j;const V=K/v.length;for(let j=0;j<v.length;j++)v[j]>=V*2?v[j]=0:z=Math.max(z,v[j])}const M=t.font;t.font=o.headerFontFull,z=Math.max(z,t.measureText(c.title).width+o.cellHorizontalPadding*2+(c.icon===void 0?0:28)),t.font=M;const E=Math.max(Math.ceil(y),Math.min(Math.floor(D),Math.ceil(z)));return{...c,width:E}}function ac(t,o,c,f,C,y,D,p,R){const z=l.useRef(o),v=l.useRef(c),M=l.useRef(D);z.current=o,v.current=c,M.current=D;const[E,K]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const I=document.createElement("canvas");return I.style.display="none",I.style.opacity="0",I.style.position="fixed",[I,I.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(E&&document.documentElement.append(E),()=>{E==null||E.remove()}),[E]);const V=l.useRef({}),j=l.useRef(),[ve,B]=l.useState();return l.useLayoutEffect(()=>{const I=v.current;if(I===void 0||t.every(Go))return;let O=Math.max(1,10-Math.floor(t.length/1e4)),ye=0;O<z.current&&O>1&&(O--,ye=1);const te={x:0,y:0,width:t.length,height:Math.min(z.current,O)},he={x:0,y:z.current-1,width:t.length,height:1};(async()=>{const ne=I(te,R.signal),re=ye>0?I(he,R.signal):void 0;let Z;typeof ne=="object"?Z=ne:Z=await lr(ne),re!==void 0&&(typeof re=="object"?Z=[...Z,...re]:Z=[...Z,...await lr(re)]),j.current=t,B(Z)})()},[R.signal,t]),l.useMemo(()=>{let O=t.every(Go)?t:K===null?t.map(q=>Go(q)?q:{...q,width:xn}):(K.font=M.current.baseFontFull,t.map((q,ne)=>{if(Go(q))return q;if(V.current[q.id]!==void 0)return{...q,width:V.current[q.id]};if(ve===void 0||j.current!==t||q.id===void 0)return{...q,width:xn};const re=wr(K,D,q,ne,ve,C,y,!0,p);return V.current[q.id]=re.width,re})),ye=0,te=0;const he=[];for(const[q,ne]of O.entries())ye+=ne.width,ne.grow!==void 0&&ne.grow>0&&(te+=ne.grow,he.push(q));if(ye<f&&he.length>0){const q=[...O],ne=f-ye;let re=ne;for(let Z=0;Z<he.length;Z++){const qe=he[Z],Le=(O[qe].grow??0)/te,Re=Z===he.length-1?re:Math.min(re,Math.floor(ne*Le));q[qe]={...O[qe],growOffset:Re,width:O[qe].width+Re},re-=Re}O=q}return{sizedColumns:O,nonGrowWidth:ye}},[f,t,K,ve,D,C,y,p])}function uc(t,o){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===o.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===o.keyCode:t===o.key}function G(t,o,c){const f=Cr(t,o);return f&&(c.didMatch=!0),f}function Cr(t,o){if(t.length===0)return!1;if(t.includes("|")){const R=t.split("|");for(const z of R)if(Cr(z,o))return!0;return!1}let c=!1,f=!1,C=!1,y=!1;const D=t.split("+"),p=D.pop();if(!uc(p,o))return!1;if(D[0]==="any")return!0;for(const R of D)switch(R){case"ctrl":c=!0;break;case"shift":f=!0;break;case"alt":C=!0;break;case"meta":y=!0;break;case"primary":Wo.value?y=!0:c=!0;break}return o.altKey===C&&o.ctrlKey===c&&o.shiftKey===f&&o.metaKey===y}function dc(t,o,c,f,C,y,D){const p=fe.useCallback((v,M,E,K)=>{var O;(y==="cell"||y==="multi-cell")&&v!==void 0&&(v={...v,range:{x:v.cell[0],y:v.cell[1],width:1,height:1}}),!D&&v!==void 0&&v.range.width>1&&(v={...v,range:{...v.range,width:1,x:v.cell[0]}});const V=c==="mixed"&&(E||K==="drag")||c==="additive",j=(f==="mixed"||f==="additive")&&V,ve=(C==="mixed"||C==="additive")&&V;let B={current:v===void 0?void 0:{...v,rangeStack:K==="drag"?((O=t.current)==null?void 0:O.rangeStack)??[]:[]},columns:j?t.columns:Y.empty(),rows:ve?t.rows:Y.empty()};E&&(y==="multi-rect"||y==="multi-cell")&&B.current!==void 0&&t.current!==void 0&&(B={...B,current:{...B.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),o(B,M)},[f,t,c,y,D,C,o]),R=fe.useCallback((v,M,E)=>{v=v??t.rows,M!==void 0&&(v=v.add(M));let K;if(C==="exclusive"&&v.length>0)K={current:void 0,columns:Y.empty(),rows:v};else{const V=E&&c==="mixed"||c==="additive",j=E&&f==="mixed"||f==="additive";K={current:V?t.current:void 0,columns:j?t.columns:Y.empty(),rows:v}}o(K,!1)},[f,t,c,C,o]),z=fe.useCallback((v,M,E)=>{v=v??t.columns,M!==void 0&&(v=v.add(M));let K;if(f==="exclusive"&&v.length>0)K={current:void 0,rows:Y.empty(),columns:v};else{const V=E&&c==="mixed"||c==="additive",j=E&&C==="mixed"||C==="additive";K={current:V?t.current:void 0,rows:j?t.rows:Y.empty(),columns:v}}o(K,!1)},[f,t,c,C,o]);return[p,R,z]}function fc(t,o,c,f,C){const y=l.useCallback(z=>{if(t===!0){const v=[];for(let M=z.y;M<z.y+z.height;M++){const E=[];for(let K=z.x;K<z.x+z.width;K++)K<0||M>=C?E.push({kind:oe.Loading,allowOverlay:!1}):E.push(o([K,M]));v.push(E)}return v}return(t==null?void 0:t(z,f.signal))??[]},[f.signal,o,t,C]),D=t!==void 0?y:void 0,p=l.useCallback(z=>{if(D===void 0)return[];const v={...z,x:z.x-c};if(v.x<0){v.x=0,v.width--;const M=D(v,f.signal);return typeof M=="function"?async()=>(await M()).map(E=>[{kind:oe.Loading,allowOverlay:!1},...E]):M.map(E=>[{kind:oe.Loading,allowOverlay:!1},...E])}return D(v,f.signal)},[f.signal,D,c]);return[t!==void 0?p:void 0,D]}function hr(t){return typeof t=="string"?t:`${t}px`}const hc=()=>t=>t.innerWidth,gc=()=>t=>t.innerHeight,mc=Mn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[hc()],"w2q57ts-1":[gc()]}}),vc=t=>{const{inWidth:o,inHeight:c,children:f,...C}=t;return l.createElement(mc,{innerHeight:hr(c),innerWidth:hr(o),...C},f)},wc=2,Cc=1300;function pc(t,o,c){const f=fe.useRef(0),[C,y]=t??[0,0];fe.useEffect(()=>{if(C===0&&y===0){f.current=0;return}let D=!1,p=0;const R=z=>{var v;if(!D){if(p===0)p=z;else{const M=z-p;f.current=Math.min(1,f.current+M/Cc);const E=f.current**1.618*M*wc;(v=o.current)==null||v.scrollBy(C*E,y*E),p=z,c==null||c()}window.requestAnimationFrame(R)}};return window.requestAnimationFrame(R),()=>{D=!0}},[o,C,y,c])}function bc({rowHeight:t,headerHeight:o,groupHeaderHeight:c,theme:f,overscrollX:C,overscrollY:y,scaleToRem:D,remSize:p}){const[R,z,v,M,E,K]=fe.useMemo(()=>{if(!D||p===16)return[t,o,c,f,C,y];const V=p/16,j=t,ve=mr();return[typeof j=="number"?j*V:B=>Math.ceil(j(B)*V),Math.ceil(o*V),Math.ceil(c*V),{...f,headerIconSize:((f==null?void 0:f.headerIconSize)??ve.headerIconSize)*V,cellHorizontalPadding:((f==null?void 0:f.cellHorizontalPadding)??ve.cellHorizontalPadding)*V,cellVerticalPadding:((f==null?void 0:f.cellVerticalPadding)??ve.cellVerticalPadding)*V},Math.ceil((C??0)*V),Math.ceil((y??0)*V)]},[c,o,C,y,p,t,D,f]);return{rowHeight:R,headerHeight:z,groupHeaderHeight:v,theme:M,overscrollX:E,overscrollY:K}}const ht={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function N(t,o){return t===!0?o:t===!1?"":t}function gr(t){const o=Wo.value;return{activateCell:N(t.activateCell," |Enter|shift+Enter"),clear:N(t.clear,"any+Escape"),closeOverlay:N(t.closeOverlay,"any+Escape"),acceptOverlayDown:N(t.acceptOverlayDown,"Enter"),acceptOverlayUp:N(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:N(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:N(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:N(t.delete,o?"Backspace|Delete":"Delete"),downFill:N(t.downFill,"primary+_68"),scrollToSelectedCell:N(t.scrollToSelectedCell,"primary+Enter"),goDownCell:N(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:N(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:N(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:N(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:N(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:N(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:N(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:N(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:N(t.goToFirstCell,"primary+Home"),goToFirstColumn:N(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:N(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:N(t.goToLastCell,"primary+End"),goToLastColumn:N(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:N(t.goToLastRow,"primary+ArrowDown"),goToNextPage:N(t.goToNextPage,"PageDown"),goToPreviousPage:N(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:N(t.rightFill,"primary+_82"),search:N(t.search,"primary+f"),selectAll:N(t.selectAll,"primary+a"),selectColumn:N(t.selectColumn,"ctrl+ "),selectGrowDown:N(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:N(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:N(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:N(t.selectGrowUp,"shift+ArrowUp"),selectRow:N(t.selectRow,"shift+ "),selectToFirstCell:N(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:N(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:N(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:N(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:N(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:N(t.selectToLastRow,"primary+shift+ArrowDown")}}function yc(t){const o=Zl(t);return fe.useMemo(()=>{if(o===void 0)return gr(ht);const c={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??ht.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??ht.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??ht.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??ht.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??ht.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??ht.selectToLastCell};return gr({...ht,...c})},[o])}function xc(t){function o(f,C,y){if(typeof f=="number")return{headerIndex:f,isCollapsed:!1,depth:C,path:y};const D={headerIndex:f.headerIndex,isCollapsed:f.isCollapsed,depth:C,path:y};return f.subGroups!==void 0&&(D.subGroups=f.subGroups.map((p,R)=>o(p,C+1,[...y,R])).sort((p,R)=>p.headerIndex-R.headerIndex)),D}return t.map((f,C)=>o(f,0,[C])).sort((f,C)=>f.headerIndex-C.headerIndex)}function Rn(t,o){const c=[];function f(p,R,z=!1){let v=R!==null?R-p.headerIndex:o-p.headerIndex;if(p.subGroups!==void 0&&(v=p.subGroups[0].headerIndex-p.headerIndex),v--,c.push({rowIndex:-1,headerIndex:p.headerIndex,contentIndex:-1,skip:z,isCollapsed:p.isCollapsed,depth:p.depth,path:p.path,rows:v}),p.subGroups)for(let M=0;M<p.subGroups.length;M++){const E=M<p.subGroups.length-1?p.subGroups[M+1].headerIndex:R;f(p.subGroups[M],E,z||p.isCollapsed)}}const C=xc(t.groups);for(let p=0;p<C.length;p++){const R=p<C.length-1?C[p+1].headerIndex:null;f(C[p],R)}let y=0,D=0;for(const p of c)p.contentIndex=D,D+=p.rows,p.rowIndex=y,y+=p.isCollapsed?1:p.rows+1;return c.filter(p=>p.skip===!1).map(p=>{const{skip:R,...z}=p;return z})}function kn(t,o){if(o===void 0||Rn.length===0)return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1};let c=t;for(const f of o){if(c===0)return{path:[...f.path,-1],originalIndex:f.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:f.rows};if(f.isCollapsed)c--;else{if(c<=f.rows)return{path:[...f.path,c-1],originalIndex:f.headerIndex+c,isGroupHeader:!1,groupIndex:c-1,contentIndex:f.contentIndex+c-1,groupRows:f.rows};c=c-f.rows-1}}return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1}}function kc(t,o,c,f){const C=fe.useMemo(()=>t===void 0?void 0:Rn(t,o),[t,o]),y=fe.useMemo(()=>C==null?void 0:C.reduce((v,M)=>(v[M.rowIndex]=M,v),{}),[C]),D=fe.useMemo(()=>C===void 0?o:C.reduce((v,M)=>v+(M.isCollapsed?1:M.rows+1),0),[C,o]),p=fe.useMemo(()=>t===void 0||typeof c=="number"&&t.height===c?c:v=>y!=null&&y[v]?t.height:typeof c=="number"?c:c(v),[y,t,c]),R=fe.useCallback(v=>{if(C===void 0)return v;let M=v;for(const E of C){if(M===0)return;if(M--,!E.isCollapsed){if(M<E.rows)return E.contentIndex+M;M-=E.rows}}return v},[C]),z=gt(f??(t==null?void 0:t.themeOverride),fe.useCallback(v=>{if(t===void 0)return f==null?void 0:f(v,v,v);if(f===void 0&&(t==null?void 0:t.themeOverride)===void 0)return;const{isGroupHeader:M,contentIndex:E,groupIndex:K}=kn(v,C);return M?t.themeOverride:f==null?void 0:f(v,K,E)},[C,f,t]));return t===void 0?{rowHeight:p,rows:o,rowNumberMapper:R,getRowThemeOverride:z}:{rowHeight:p,rows:D,rowNumberMapper:R,getRowThemeOverride:z}}function Mc(t,o){const c=fe.useMemo(()=>t===void 0?void 0:Rn(t,o),[t,o]);return{getRowGroupingForPath:br,updateRowGroupingByPath:pr,mapper:fe.useCallback(f=>{if(typeof f=="number")return kn(f,c);const C=kn(f[1],c);return{...C,originalIndex:[f[0],C.originalIndex]}},[c])}}function pr(t,o,c){const[f,...C]=o;return C[0]===-1?t.map((y,D)=>D===f?{...y,...c}:y):t.map((y,D)=>D===f?{...y,subGroups:pr(y.subGroups??[],C,c)}:y)}function br(t,o){const[c,...f]=o;return f[0]===-1?t[c]:br(t[c].subGroups??[],f)}function Rc(t,o){const[c]=l.useState(()=>({value:t,callback:o,facade:{get current(){return c.value},set current(f){const C=c.value;C!==f&&(c.value=f,c.callback(f,C))}}}));return c.callback=o,c.facade}function Sc(t,o,c,f,C){const[y,D]=l.useMemo(()=>[o!==void 0&&typeof c=="number"?Math.floor(o/c):0,o!==void 0&&typeof c=="number"?-(o%c):0],[o,c]),p=l.useMemo(()=>({x:f.current.x,y,width:f.current.width??1,height:f.current.height??1,ty:D}),[f,D,y]),[R,z,v]=Jl(p),M=l.useRef(C);M.current=C;const E=Rc(null,j=>{j!==null&&o!==void 0?j.scrollTop=o:j!==null&&t!==void 0&&(j.scrollLeft=t)}),K=(R.height??1)>1;l.useLayoutEffect(()=>{if(o!==void 0&&E.current!==null&&K){if(E.current.scrollTop===o)return;E.current.scrollTop=o,E.current.scrollTop!==o&&v(),M.current()}},[o,K,v,E]);const V=(R.width??1)>1;return l.useLayoutEffect(()=>{if(t!==void 0&&E.current!==null&&V){if(E.current.scrollLeft===t)return;E.current.scrollLeft=t,E.current.scrollLeft!==t&&v(),M.current()}},[t,V,v,E]),{visibleRegion:R,setVisibleRegion:z,scrollRef:E}}const Tc=l.lazy(async()=>await jl(()=>import("./data-grid-overlay-editor-CX6We0rl.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url));let Ec=0;function zc(t){return pi(fr(fr(t).filter(o=>o.span!==void 0).map(o=>{var c,f;return Vt((((c=o.span)==null?void 0:c[0])??0)+1,(((f=o.span)==null?void 0:f[1])??0)+1)})))}function Ko(t,o){return t===void 0||o===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+o,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+o},rangeStack:t.current.rangeStack.map(c=>({...c,x:c.x+o}))},rows:t.rows,columns:t.columns.offset(o)}}const Ut={kind:oe.Loading,allowOverlay:!1},yn={columns:Y.empty(),rows:Y.empty(),current:void 0},Lc=(t,o)=>{var or,nr,rr;const[c,f]=l.useState(yn),[C,y]=l.useState(),D=l.useRef(null),p=l.useRef(null),[R,z]=l.useState(),v=l.useRef(void 0),M=typeof window>"u"?null:window,{imageEditorOverride:E,getRowThemeOverride:K,markdownDivCreateNode:V,width:j,height:ve,columns:B,rows:I,getCellContent:O,onCellClicked:ye,onCellActivated:te,onFillPattern:he,onFinishedEditing:q,coercePasteValue:ne,drawHeader:re,drawCell:Z,editorBloom:qe,onHeaderClicked:Le,onColumnProposeMove:Re,rangeSelectionColumnSpanning:so=!0,spanRangeBehavior:mt="default",onGroupHeaderClicked:He,onCellContextMenu:Ge,className:Bt,onHeaderContextMenu:Ne,getCellsForSelection:Uo,onGroupHeaderContextMenu:L,onGroupHeaderRenamed:ce,onCellEdited:de,onCellsEdited:De,onSearchResultsChanged:Ke,searchResults:vt,onSearchValueChange:ao,searchValue:Vo,onKeyDown:Xt,onKeyUp:wt,keybindings:uo,editOnType:Bo=!0,onRowAppended:je,onColumnAppended:nt,onColumnMoved:Ct,validateCell:pt,highlightRegions:rt,rangeSelect:Ze="rect",columnSelect:xe="multi",rowSelect:Se="multi",rangeSelectionBlending:Je="exclusive",columnSelectionBlending:Qe="exclusive",rowSelectionBlending:yr="exclusive",onDelete:Xo,onDragStart:fo,onMouseMove:ho,onPaste:bt,copyHeaders:Sn=!1,freezeColumns:et=0,cellActivationBehavior:go="second-click",rowSelectionMode:_o="auto",columnSelectionMode:_t="auto",onHeaderMenuClick:mo,onHeaderIndicatorClick:vo,getGroupDetails:wo,rowGrouping:lt,onSearchClose:Yo,onItemHovered:Co,onSelectionCleared:it,showSearch:xr,onVisibleRegionChanged:po,gridSelection:yt,onGridSelectionChange:zt,minColumnWidth:kr=50,maxColumnWidth:Mr=500,maxColumnAutoWidth:Rr,provideEditor:Sr,trailingRowOptions:X,freezeTrailingRows:tt=0,allowedFillDirections:Tn="orthogonal",scrollOffsetX:Tr,scrollOffsetY:Er,verticalBorder:Lt,onDragOverCell:zr,onDrop:Lr,onColumnResize:Yt,onColumnResizeEnd:qt,onColumnResizeStart:jt,customRenderers:bo,fillHandle:Hr,experimental:ae,fixedShadowX:Dr,fixedShadowY:Ir,headerIcons:Fr,imageWindowLoader:$r,initialSize:Ar,isDraggable:Pr,onDragLeave:Gr,onRowMoved:Ht,overscrollX:Nr,overscrollY:Kr,preventDiagonalScrolling:Or,rightElement:Wr,rightElementProps:Ur,trapFocus:En=!1,smoothScrollX:Vr,smoothScrollY:Br,scaleToRem:Xr=!1,rowHeight:_r=34,headerHeight:zn=36,groupHeaderHeight:Yr=zn,theme:qr,isOutsideClick:jr,renderers:qo,resizeIndicator:Zr,scrollToActiveCell:Ln=!0,drawFocusRing:Hn=!0,portalElementRef:Jr,isActivationOnEnter:Qr}=t,Dn=Hn==="no-editor"?C===void 0:Hn,Q=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,el=(Q==null?void 0:Q.rowNumber)??!1;let yo=(Q==null?void 0:Q.kind)??t.rowMarkers??"none",Ve=el;(yo==="both"||yo==="checkbox-and-number")&&(yo="checkbox",Ve=!0);const Ie=yo,tl=(Q==null?void 0:Q.width)??t.rowMarkerWidth,jo=(Q==null?void 0:Q.startIndex)??t.rowMarkerStartIndex??1,Zo=(Q==null?void 0:Q.theme)??t.rowMarkerTheme,Jo=Q==null?void 0:Q.headerTheme,In=Q==null?void 0:Q.headerAlwaysVisible,xo=Se!=="multi"||(Q==null?void 0:Q.headerDisabled)===!0,Dt=(Q==null?void 0:Q.checkboxStyle)??"square",It=Math.max(kr,20),ko=Math.max(Mr,It),ol=Math.max(Rr??ko,It),Fn=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:F,rowNumberMapper:Qo,rowHeight:nl,getRowThemeOverride:ot}=kc(lt,I,_r,K),rl=l.useMemo(()=>Number.parseFloat(Fn.fontSize),[Fn]),{rowHeight:ct,headerHeight:en,groupHeaderHeight:$n,theme:An,overscrollX:ll,overscrollY:il}=bc({groupHeaderHeight:Yr,headerHeight:zn,overscrollX:Nr,overscrollY:Kr,remSize:rl,rowHeight:nl,scaleToRem:Xr,theme:qr}),st=yc(uo),xt=tl??(I>1e4?48:I>1e3?44:I>100?36:32),Be=Ie!=="none",u=Be?Ve?2:1:0,se=X!==void 0,Zt=(X==null?void 0:X.sticky)===!0,[cl,Pn]=l.useState(!1),sl=xr??cl,al=l.useCallback(()=>{Yo!==void 0?Yo():Pn(!1)},[Yo]),h=l.useMemo(()=>yt===void 0?void 0:Ko(yt,u),[yt,u])??c,Fe=l.useRef(new AbortController);l.useEffect(()=>()=>Fe==null?void 0:Fe.current.abort(),[]);const[ge,ul]=fc(Uo,O,u,Fe.current,F),dl=l.useCallback((e,n,r)=>{if(pt===void 0)return!0;const i=[e[0]-u,e[1]];return pt==null?void 0:pt(i,n,r)},[u,pt]),Mo=l.useRef(yt),$e=l.useCallback((e,n)=>{n&&(e=Ql(e,ge,u,mt,Fe.current)),zt!==void 0?(Mo.current=Ko(e,-u),zt(Mo.current)):f(e)},[zt,ge,u,mt]),Ft=gt(Yt,l.useCallback((e,n,r,i)=>{Yt==null||Yt(B[r-u],n,r-u,i)},[Yt,u,B])),fl=gt(qt,l.useCallback((e,n,r,i)=>{qt==null||qt(B[r-u],n,r-u,i)},[qt,u,B])),hl=gt(jt,l.useCallback((e,n,r,i)=>{jt==null||jt(B[r-u],n,r-u,i)},[jt,u,B])),gl=gt(re,l.useCallback((e,n)=>(re==null?void 0:re({...e,columnIndex:e.columnIndex-u},n))??!1,[re,u])),ml=gt(Z,l.useCallback((e,n)=>(Z==null?void 0:Z({...e,col:e.col-u},n))??!1,[Z,u])),at=l.useCallback(e=>{if(Xo!==void 0){const n=Xo(Ko(e,-u));return typeof n=="boolean"?n:Ko(n,u)}return!0},[Xo,u]),[me,ke,ue]=dc(h,$e,Je,Qe,yr,Ze,so),we=l.useMemo(()=>pn(mr(),An),[An]),[tn,vl]=l.useState([0,0,0]),Gn=l.useMemo(()=>{if(qo===void 0)return{};const e={};for(const n of qo)e[n.kind]=n;return e},[qo]),Me=l.useCallback(e=>e.kind!==oe.Custom?Gn[e.kind]:bo==null?void 0:bo.find(n=>n.isMatch(e)),[bo,Gn]);let{sizedColumns:Te,nonGrowWidth:Nn}=ac(B,F,ul,tn[0]-(u===0?0:xt)-tn[2],It,ol,we,Me,Fe.current);Ie!=="none"&&(Nn+=xt);const on=l.useMemo(()=>Te.some(e=>e.group!==void 0),[Te]),Jt=on?en+$n:en,Kn=h.rows.length,On=Ie==="none"?void 0:Kn===0?!1:Kn===F?!0:void 0,W=l.useMemo(()=>{if(Ie==="none")return Te;const e=[];return Ve&&e.push({title:"",width:xt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Zo,rowMarker:Dt,rowMarkerChecked:!1,headerRowMarkerTheme:Jo,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),e.push({title:"",width:xt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Zo,rowMarker:Dt,rowMarkerChecked:On,headerRowMarkerTheme:Jo,headerRowMarkerAlwaysVisible:In,headerRowMarkerDisabled:xo}),[...e,...Te]},[Ie,Te,xt,Zo,Dt,On,Jo,In,xo,Ve]),Ee=l.useRef({height:1,width:1,x:0,y:0}),Ro=l.useRef(!1),{setVisibleRegion:Wn,visibleRegion:kt,scrollRef:_}=Sc(Tr,Er,ct,Ee,()=>Ro.current=!0);Ee.current=kt;const wl=kt.x+u,So=kt.y,ie=l.useRef(null),Ce=l.useCallback(e=>{var n;e===!0?(n=ie.current)==null||n.focus():window.requestAnimationFrame(()=>{var r;(r=ie.current)==null||r.focus()})},[]),pe=se?F+1:F,Ae=l.useCallback(e=>{const n=u===0?e:e.map(i=>({...i,location:[i.location[0]-u,i.location[1]]})),r=De==null?void 0:De(n);if(r!==!0)for(const i of n)de==null||de(i.location,i.value);return r},[de,De,u]),[Mt,nn]=l.useState(),To=h.current!==void 0&&h.current.range.width*h.current.range.height>1?h.current.range:void 0,$t=Dn?(or=h.current)==null?void 0:or.cell:void 0,Eo=$t==null?void 0:$t[0],zo=$t==null?void 0:$t[1],Cl=l.useMemo(()=>{if((rt===void 0||rt.length===0)&&(To??Eo??zo??Mt)===void 0)return;const e=[];if(rt!==void 0)for(const n of rt){const r=W.length-n.range.x-u;r>0&&e.push({color:n.color,range:{...n.range,x:n.range.x+u,width:Math.min(r,n.range.width)},style:n.style})}return Mt!==void 0&&e.push({color:ir(we.accentColor,0),range:Mt,style:"dashed"}),To!==void 0&&e.push({color:ir(we.accentColor,.5),range:To,style:"solid-outline"}),Eo!==void 0&&zo!==void 0&&e.push({color:we.accentColor,range:{x:Eo,y:zo,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[Mt,To,Eo,zo,rt,W.length,we.accentColor,u]),Un=l.useRef(W);Un.current=W;const ze=l.useCallback(([e,n],r=!1)=>{var a,s,g,w,b,S,x,H,A;const i=se&&n===pe-1,d=e===0&&Be,m=e===1&&Be&&Ve;if(d){if(i)return Ut;const $=Qo(n);if($===void 0)return Ut;let T;return Ve||Ie==="clickable-number"?T="number":T=Ie,{kind:lo.Marker,allowOverlay:!1,checkboxStyle:Dt,checked:Ve?!1:(h==null?void 0:h.rows.hasIndex(n))===!0,markerKind:T,row:jo+$,drawHandle:Ve?!1:Ht!==void 0,cursor:Ve?void 0:Ie==="clickable-number"?"pointer":void 0,disabled:((a=t.disabledRows)==null?void 0:a.call(t,n))===!0}}if(m){if(i)return Ut;const $=Qo(n);return $===void 0?Ut:{kind:lo.Marker,allowOverlay:!1,checkboxStyle:Dt,checked:(h==null?void 0:h.rows.hasIndex(n))===!0,markerKind:Ie==="checkbox-visible"?"checkbox-visible":"checkbox",row:jo+$,drawHandle:Ht!==void 0,cursor:void 0,disabled:((s=t.disabledRows)==null?void 0:s.call(t,n))===!0}}else if(i){const T=e===u?(X==null?void 0:X.hint)??"":"",k=Un.current[e];if(((g=k==null?void 0:k.trailingRowOptions)==null?void 0:g.disabled)===!0)return Ut;{const P=((w=k==null?void 0:k.trailingRowOptions)==null?void 0:w.hint)??T,J=((b=k==null?void 0:k.trailingRowOptions)==null?void 0:b.addIcon)??(X==null?void 0:X.addIcon);return{kind:lo.NewRow,hint:P,allowOverlay:!1,icon:J}}}else{const $=e-u;if(r||(ae==null?void 0:ae.strict)===!0){const k=Ee.current,P=k.x>$||$>k.x+k.width||k.y>n||n>k.y+k.height||n>=sn.current,J=$===((x=(S=k.extras)==null?void 0:S.selected)==null?void 0:x[0])&&n===((H=k.extras)==null?void 0:H.selected[1]);let U=!1;if(((A=k.extras)==null?void 0:A.freezeRegions)!==void 0){for(const be of k.extras.freezeRegions)if(ei(be,$,n)){U=!0;break}}if(P&&!J&&!U)return Ut}let T=O([$,n]);return u!==0&&T.span!==void 0&&(T={...T,span:[T.span[0]+u,T.span[1]+u]}),T}},[se,pe,Be,Qo,Dt,h==null?void 0:h.rows,Ie,jo,Ht,u,X==null?void 0:X.hint,X==null?void 0:X.addIcon,ae==null?void 0:ae.strict,O]),rn=l.useCallback(e=>{let n=(wo==null?void 0:wo(e))??{name:e};return ce!==void 0&&e!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:r=>un({group:n.name,bounds:r.bounds})}]}),n},[wo,ce]),At=l.useCallback(e=>{var s;const[n,r]=e.cell,i=W[n],d=(i==null?void 0:i.group)!==void 0?(s=rn(i.group))==null?void 0:s.overrideTheme:void 0,m=i==null?void 0:i.themeOverride,a=ot==null?void 0:ot(r);y({...e,theme:pn(we,d,m,a,e.content.themeOverride)})},[ot,W,rn,we]),Pt=l.useCallback((e,n,r)=>{var a;if(h.current===void 0)return;const[i,d]=h.current.cell,m=ze([i,d]);if(m.kind!==oe.Boolean&&m.allowOverlay){let s=m;if(r!==void 0)switch(s.kind){case oe.Number:{const g=ti(()=>r==="-"?-0:Number.parseFloat(r),0);s={...s,data:Number.isNaN(g)?0:g};break}case oe.Text:case oe.Markdown:case oe.Uri:s={...s,data:r};break}At({target:e,content:s,initialValue:r,cell:[i,d],highlight:r===void 0,forceEditMode:r!==void 0,activation:n})}else m.kind===oe.Boolean&&n.inputType==="keyboard"&&m.readonly!==!0&&(Ae([{location:h.current.cell,value:{...m,data:oi(m.data)}}]),(a=ie.current)==null||a.damage([{cell:h.current.cell}]))},[ze,h,Ae,At]),Vn=l.useCallback((e,n)=>{var d;const r=(d=ie.current)==null?void 0:d.getBounds(e,n);if(r===void 0||_.current===null)return;const i=ze([e,n]);i.allowOverlay&&At({target:r,content:i,initialValue:void 0,highlight:!0,cell:[e,n],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[ze,_,At]),le=l.useCallback((e,n,r="both",i=0,d=0,m=void 0)=>{if(_.current!==null){const a=ie.current,s=p.current,g=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,w=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,b=typeof e!="number"&&e.unit==="px"?e.amount:void 0,S=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(a!==null&&s!==null){let x={x:0,y:0,width:0,height:0},H=0,A=0;if((g!==void 0||w!==void 0)&&(x=a.getBounds((g??0)+u,w??0)??x,x.width===0||x.height===0))return;const $=s.getBoundingClientRect(),T=$.width/s.offsetWidth;if(b!==void 0&&(x={...x,x:b-$.left-_.current.scrollLeft,width:1}),S!==void 0&&(x={...x,y:S+$.top-_.current.scrollTop,height:1}),x!==void 0){const k={x:x.x-i,y:x.y-d,width:x.width+2*i,height:x.height+2*d};let P=0;for(let wn=0;wn<et;wn++)P+=Te[wn].width;let J=0;const U=tt+(Zt?1:0);U>0&&(J=ni(pe,U,ct));let be=P*T+$.left+u*xt*T,_e=$.right,Ue=$.top+Jt*T,Ye=$.bottom-J*T;const Ao=x.width+i*2;switch(m==null?void 0:m.hAlign){case"start":_e=be+Ao;break;case"end":be=_e-Ao;break;case"center":be=Math.floor((be+_e)/2)-Ao/2,_e=be+Ao;break}const Po=x.height+d*2;switch(m==null?void 0:m.vAlign){case"start":Ye=Ue+Po;break;case"end":Ue=Ye-Po;break;case"center":Ue=Math.floor((Ue+Ye)/2)-Po/2,Ye=Ue+Po;break}be>k.x?H=k.x-be:_e<k.x+k.width&&(H=k.x+k.width-_e),Ue>k.y?A=k.y-Ue:Ye<k.y+k.height&&(A=k.y+k.height-Ye),r==="vertical"||typeof e=="number"&&e<et?H=0:(r==="horizontal"||typeof n=="number"&&n>=pe-U)&&(A=0),(H!==0||A!==0)&&(T!==1&&(H/=T,A/=T),_.current.scrollTo({left:H+_.current.scrollLeft,top:A+_.current.scrollTop,behavior:(m==null?void 0:m.behavior)??"auto"}))}}}},[u,tt,xt,_,Jt,et,Te,pe,Zt,ct]),ln=l.useRef(Vn),cn=l.useRef(O);ln.current=Vn,cn.current=O;const sn=l.useRef(F);sn.current=F;const Bn=l.useRef(W.length);Bn.current=W.length;const ut=l.useCallback(async(e,n=!0,r)=>{var w;const i=W[e];if(((w=i==null?void 0:i.trailingRowOptions)==null?void 0:w.disabled)===!0)return;const d=je==null?void 0:je();let m,a=!0;d!==void 0&&(m=await d,m==="top"&&(a=!1),typeof m=="number"&&(a=!1));let s=0;const g=()=>{if(sn.current<=F){s<500&&window.setTimeout(g,s),s=50+s*2;return}const b=typeof m=="number"?m:a?F:0;$o.current(e-u,b,"both",0,0,r?{behavior:r}:void 0),me({cell:[e,b],range:{x:e,y:b,width:1,height:1}},!1,!1,"edit");const S=cn.current([e-u,b]);S.allowOverlay&&io(S)&&S.readonly!==!0&&n&&window.setTimeout(()=>{ln.current(e,b)},0)};g()},[W,je,u,F,me]),Lo=l.useCallback(async(e,n=!0)=>{const r=nt==null?void 0:nt();let i,d=!0;r!==void 0&&(i=await r,i==="left"&&(d=!1),typeof i=="number"&&(d=!1));let m=0;const a=()=>{if(Bn.current<=W.length){m<500&&window.setTimeout(a,m),m=50+m*2;return}const s=typeof i=="number"?i:d?W.length:0;le(s-u,e),me({cell:[s,e],range:{x:s,y:e,width:1,height:1}},!1,!1,"edit");const g=cn.current([s-u,e]);g.allowOverlay&&io(g)&&g.readonly!==!0&&n&&window.setTimeout(()=>{ln.current(s,e)},0)};a()},[W,nt,u,le,me]),Gt=l.useCallback(e=>{var r,i;const n=((i=(r=Te[e])==null?void 0:r.trailingRowOptions)==null?void 0:i.targetColumn)??(X==null?void 0:X.targetColumn);if(typeof n=="number")return n+(Be?1:0);if(typeof n=="object"){const d=B.indexOf(n);if(d>=0)return d+(Be?1:0)}},[Te,B,Be,X==null?void 0:X.targetColumn]),dt=l.useRef(void 0),Nt=l.useRef(void 0),Qt=l.useCallback((e,n)=>{var d;const[r,i]=n;return pn(we,(d=W[r])==null?void 0:d.themeOverride,ot==null?void 0:ot(i),e.themeOverride)},[ot,W,we]),{mapper:Rt}=Mc(lt,I),Oe=lt==null?void 0:lt.navigationBehavior,eo=l.useCallback(e=>{var w,b,S;const n=Wo.value?e.metaKey:e.ctrlKey,r=n&&Se==="multi",[i,d]=e.location,m=h.columns,a=h.rows,[s,g]=((w=h.current)==null?void 0:w.cell)??[];if(e.kind==="cell"){if(Nt.current=void 0,St.current=[i,d],(Ve?i===1:i===0)&&Be){if(se===!0&&d===F||Ie==="number"||Se==="none")return;const H=ze(e.location);if(H.kind!==lo.Marker||H.disabled===!0)return;if(Ht!==void 0){const T=Me(H);Oo((T==null?void 0:T.kind)===lo.Marker);const k=(b=T==null?void 0:T.onClick)==null?void 0:b.call(T,{...e,cell:H,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:Qt(H,e.location),preventDefault:()=>{}});if(k===void 0||k.checked===H.checked)return}y(void 0),Ce();const A=a.hasIndex(d),$=dt.current;if(Se==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&$!==void 0&&a.hasIndex($)){const T=[Math.min($,d),Math.max($,d)+1];r||_o==="multi"?ke(void 0,T,!0):ke(Y.fromSingleSelection(T),void 0,r)}else Se==="multi"&&(r||e.isTouch||_o==="multi")?A?ke(a.remove(d),void 0,!0):(ke(void 0,d,!0),dt.current=d):A&&a.length===1?ke(Y.empty(),void 0,n):(ke(Y.fromSingleSelection(d),void 0,n),dt.current=d)}else if(i>=u&&se&&d===F){const H=Gt(i);ut(H??i)}else if(s!==i||g!==d){const H=ze(e.location),A=Me(H);if((A==null?void 0:A.onSelect)!==void 0){let k=!1;if(A.onSelect({...e,cell:H,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>k=!0,theme:Qt(H,e.location)}),k)return}if(Oe==="block"&&Rt(d).isGroupHeader)return;const $=Zt&&d===F,T=Zt&&h!==void 0&&((S=h.current)==null?void 0:S.cell[1])===F;if((e.shiftKey||e.isLongTouch===!0)&&s!==void 0&&g!==void 0&&h.current!==void 0&&!T){if($)return;const k=Math.min(i,s),P=Math.max(i,s),J=Math.min(d,g),U=Math.max(d,g);me({...h.current,range:{x:k,y:J,width:P-k+1,height:U-J+1}},!0,n,"click"),dt.current=void 0,Ce()}else me({cell:[i,d],range:{x:i,y:d,width:1,height:1}},!0,n,"click"),dt.current=void 0,y(void 0),Ce()}}else if(e.kind==="header")if(St.current=[i,d],y(void 0),Be&&i===0)dt.current=void 0,Nt.current=void 0,!xo&&Se==="multi"&&(a.length!==F?ke(Y.fromSingleSelection([0,F]),void 0,n):ke(Y.empty(),void 0,n),Ce());else{const x=Nt.current;if(xe==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&x!==void 0&&m.hasIndex(x)){const H=[Math.min(x,i),Math.max(x,i)+1];n||e.isTouch||_t==="multi"?ue(void 0,H,n):ue(Y.fromSingleSelection(H),void 0,n)}else xe==="multi"&&(n||e.isTouch||_t==="multi")?(m.hasIndex(i)?ue(m.remove(i),void 0,n):ue(void 0,i,n),Nt.current=i):xe!=="none"&&(m.hasIndex(i)?ue(m.remove(i),void 0,n):ue(Y.fromSingleSelection(i),void 0,n),Nt.current=i);dt.current=void 0,Ce()}else e.kind===Wt?St.current=[i,d]:e.kind===cr&&!e.isMaybeScrollbar&&($e(yn,!1),y(void 0),Ce(),it==null||it(),dt.current=void 0,Nt.current=void 0)},[Se,xe,h,Be,u,se,F,Ie,ze,Ht,Ce,_o,_t,Me,Qt,ke,Gt,ut,Oe,Rt,Zt,me,xo,ue,$e,it]),to=l.useRef(!1),St=l.useRef(void 0),Xn=l.useRef(kt),Pe=l.useRef(void 0),pl=l.useCallback(e=>{if(Kt.current=!1,Xn.current=Ee.current,e.button!==0&&e.button!==1){Pe.current=void 0;return}const n=performance.now();Pe.current={button:e.button,time:n,location:e.location},(e==null?void 0:e.kind)==="header"&&(to.current=!0);const r=e.kind==="cell"&&e.isFillHandle;!r&&e.kind!=="cell"&&e.isEdge||(z({previousSelection:h,fillHandle:r}),St.current=void 0,!e.isTouch&&e.button===0&&!r?eo(e):!e.isTouch&&e.button===1&&(St.current=e.location))},[h,eo]),[an,un]=l.useState(),_n=l.useCallback(e=>{if(e.kind!==Wt||xe!=="multi")return;const n=Wo.value?e.metaKey:e.ctrlKey,[r]=e.location,i=h.columns;if(r<u)return;const d=W[r];let m=r,a=r;for(let s=r-1;s>=u&&sr(d.group,W[s].group);s--)m--;for(let s=r+1;s<W.length&&sr(d.group,W[s].group);s++)a++;if(Ce(),n||e.isTouch||_t==="multi")if(i.hasAll([m,a+1])){let s=i;for(let g=m;g<=a;g++)s=s.remove(g);ue(s,void 0,n)}else ue(void 0,[m,a+1],n);else ue(Y.fromSingleSelection([m,a+1]),void 0,n)},[xe,Ce,h.columns,W,u,ue,_t]),Kt=l.useRef(!1),Ho=l.useCallback(async e=>{if(ge!==void 0&&Ft!==void 0){const n=Ee.current.y,r=Ee.current.height;let i=ge({x:e,y:n,width:1,height:Math.min(r,F-n)},Fe.current.signal);typeof i!="object"&&(i=await i());const d=Te[e-u],a=document.createElement("canvas").getContext("2d",{alpha:!1});if(a!==null){a.font=we.baseFontFull;const s=wr(a,we,d,0,i,It,ko,!1,Me);Ft==null||Ft(d,s.width,e,s.width)}}},[Te,ge,ko,we,It,Ft,u,F,Me]),[bl,dn]=l.useState(),Ot=l.useCallback(async(e,n)=>{var s,g;const r=(s=e.current)==null?void 0:s.range;if(r===void 0||ge===void 0||n.current===void 0)return;const i=n.current.range;if(he!==void 0){let w=!1;if(he({fillDestination:{...i,x:i.x-u},patternSource:{...r,x:r.x-u},preventDefault:()=>w=!0}),w)return}let d=ge(r,Fe.current.signal);typeof d!="object"&&(d=await d());const m=d,a=[];for(let w=0;w<i.width;w++)for(let b=0;b<i.height;b++){const S=[i.x+w,i.y+b];if(ri(S,r))continue;const x=m[b%r.height][w%r.width];No(x)||!io(x)||a.push({location:S,value:{...x}})}Ae(a),(g=ie.current)==null||g.damage(a.map(w=>({cell:w.location})))},[ge,Ae,he,u]),Yn=l.useCallback(()=>{if(h.current===void 0||h.current.range.width<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,width:1}}};Ot(e,h)},[Ot,h]),qn=l.useCallback(()=>{if(h.current===void 0||h.current.range.height<=1)return;const e={...h,current:{...h.current,range:{...h.current.range,height:1}}};Ot(e,h)},[Ot,h]),yl=l.useCallback((e,n)=>{var b,S;const r=R;if(z(void 0),nn(void 0),dn(void 0),to.current=!1,n)return;if((r==null?void 0:r.fillHandle)===!0&&h.current!==void 0&&((b=r.previousSelection)==null?void 0:b.current)!==void 0){if(Mt===void 0)return;const x={...h,current:{...h.current,range:li(r.previousSelection.current.range,Mt)}};Ot(r.previousSelection,x),$e(x,!0);return}const[i,d]=e.location,[m,a]=St.current??[],s=()=>{Kt.current=!0},g=x=>{var A,$,T;const H=x.isTouch||m===i&&a===d;if(H&&(ye==null||ye([i-u,d],{...x,preventDefault:s})),x.button===1)return!Kt.current;if(!Kt.current){const k=ze(e.location),P=Me(k);if(P!==void 0&&P.onClick!==void 0&&H){const U=P.onClick({...x,cell:k,posX:x.localEventX,posY:x.localEventY,bounds:x.bounds,theme:Qt(k,e.location),preventDefault:s});U!==void 0&&!No(U)&&co(U)&&(Ae([{location:x.location,value:U}]),(A=ie.current)==null||A.damage([{cell:x.location}]))}if(Kt.current||h.current===void 0)return!1;let J=!1;switch(k.activationBehaviorOverride??go){case"double-click":case"second-click":{if(((T=($=r==null?void 0:r.previousSelection)==null?void 0:$.current)==null?void 0:T.cell)===void 0)break;const[U,be]=h.current.cell,[_e,Ue]=r.previousSelection.current.cell;J=i===U&&i===_e&&d===be&&d===Ue&&(x.isDoubleClick===!0||go==="second-click");break}case"single-click":{J=!0;break}}if(J){const be={inputType:"pointer",pointerActivation:x.isDoubleClick===!0?"double-click":k.activationBehaviorOverride??go,pointerType:x.isTouch?"touch":"mouse"};return te==null||te([i-u,d],be),Pt(x.bounds,be),!0}}return!1},w=e.location[0]-u;if(e.isTouch){const x=Ee.current,H=Xn.current;if(x.x!==H.x||x.y!==H.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&ii((S=h.current)==null?void 0:S.cell,e.location)){Ge==null||Ge([w,e.location[1]],{...e,preventDefault:s});return}else if(e.kind==="header"&&h.columns.hasIndex(i)){Ne==null||Ne(w,{...e,preventDefault:s});return}else if(e.kind===Wt){if(w<0)return;L==null||L(w,{...e,preventDefault:s});return}}e.kind==="cell"?g(e)||eo(e):e.kind===Wt?He==null||He(w,{...e,preventDefault:s}):(e.kind===ci&&(Le==null||Le(w,{...e,preventDefault:s})),eo(e));return}if(e.kind==="header"){if(w<0)return;e.isEdge?e.isDoubleClick===!0&&Ho(i):e.button===0&&i===m&&d===a&&(Le==null||Le(w,{...e,preventDefault:s}))}if(e.kind===Wt){if(w<0)return;e.button===0&&i===m&&d===a&&(He==null||He(w,{...e,preventDefault:s}),Kt.current||_n(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&g(e),St.current=void 0},[R,h,u,Mt,Ot,$e,ye,ze,Me,go,Qt,Ae,te,Pt,Ge,Ne,L,eo,He,Le,Ho,_n]),xl=l.useCallback(e=>{const n={...e,location:[e.location[0]-u,e.location[1]]};ho==null||ho(n),R!==void 0&&e.buttons===0&&(z(void 0),nn(void 0),dn(void 0),to.current=!1),dn(r=>{var i;return to.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(r==null?void 0:r[0])&&e.scrollEdge[1]===r[1]?r:R===void 0||(((i=Pe.current)==null?void 0:i.location[0])??0)<u?void 0:e.scrollEdge})},[R,ho,u]),kl=l.useCallback((e,n)=>{mo==null||mo(e-u,n)},[mo,u]),Ml=l.useCallback((e,n)=>{vo==null||vo(e-u,n)},[vo,u]);l.useEffect(()=>{if(C===void 0)return;const e=i=>{const d=[];let m=i.parentElement;for(;m&&m!==document.documentElement;){const a=window.getComputedStyle(m),s=a.overflow+a.overflowY+a.overflowX;(s.includes("scroll")||s.includes("auto"))&&d.push(m),m=m.parentElement}return d},n=i=>{const d=i.target;_.current&&!_.current.contains(d)&&y(void 0)},r=[];if(_.current){const i=e(_.current);r.push(...i)}return r.forEach(i=>{i.addEventListener("scroll",n)}),window.addEventListener("scroll",n),document.addEventListener("scroll",n,!0),()=>{r.forEach(i=>{i.removeEventListener("scroll",n)}),window.removeEventListener("scroll",n),document.removeEventListener("scroll",n,!0)}},[C,y,_]);const Xe=(nr=h==null?void 0:h.current)==null?void 0:nr.cell,Rl=l.useCallback((e,n,r,i,d,m)=>{if(Ro.current=!1,C!==void 0){const b=Ee.current;(b.x!==e.x||b.y!==e.y)&&y(void 0)}let a=Xe;a!==void 0&&(a=[a[0]-u,a[1]]);const s=et===0?void 0:{x:0,y:e.y,width:et,height:e.height},g=[];s!==void 0&&g.push(s),tt>0&&(g.push({x:e.x-u,y:F-tt,width:e.width,height:tt}),et>0&&g.push({x:0,y:F-tt,width:et,height:tt}));const w={x:e.x-u,y:e.y,width:e.width,height:se&&e.y+e.height>=F?e.height-1:e.height,tx:d,ty:m,extras:{selected:a,freezeRegion:s,freezeRegions:g}};Ee.current=w,Wn(w),vl([n,r,i]),po==null||po(w,w.tx,w.ty,w.extras)},[Xe,C,u,se,F,et,tt,y,Wn,po]),Sl=gt(Re,l.useCallback((e,n)=>(Re==null?void 0:Re(e-u,n-u))!==!1,[Re,u])),Tl=gt(Ct,l.useCallback((e,n)=>{Ct==null||Ct(e-u,n-u),xe!=="none"&&ue(Y.fromSingleSelection(n),void 0,!0)},[xe,Ct,u,ue])),fn=l.useRef(!1),El=l.useCallback(e=>{if(e.location[0]===0&&u>0){e.preventDefault();return}fo==null||fo({...e,location:[e.location[0]-u,e.location[1]]}),e.defaultPrevented()||(fn.current=!0),z(void 0)},[fo,u]),zl=l.useCallback(()=>{fn.current=!1},[]),jn=lt==null?void 0:lt.selectionBehavior,Do=l.useCallback(e=>{if(jn!=="block-spanning")return;const{isGroupHeader:n,path:r,groupRows:i}=Rt(e);if(n)return[e,e];const d=r[r.length-1],m=e-d,a=e+i-d-1;return[m,a]},[Rt,jn]),hn=l.useRef(void 0),gn=l.useCallback(e=>{var n,r,i;if(!si(e,hn.current)&&(hn.current=e,!(((n=Pe==null?void 0:Pe.current)==null?void 0:n.button)!==void 0&&Pe.current.button>=1))){if(e.buttons!==0&&R!==void 0&&((r=Pe.current)==null?void 0:r.location[0])===0&&u===1&&Se==="multi"&&R.previousSelection&&!R.previousSelection.rows.hasIndex(Pe.current.location[1])&&h.rows.hasIndex(Pe.current.location[1])){const d=Math.min(Pe.current.location[1],e.location[1]),m=Math.max(Pe.current.location[1],e.location[1])+1;ke(Y.fromSingleSelection([d,m]),void 0,!1)}else if(e.buttons!==0&&R!==void 0&&h.current!==void 0&&!fn.current&&!to.current&&(Ze==="rect"||Ze==="multi-rect")){const[d,m]=h.current.cell;let[a,s]=e.location;if(s<0&&(s=Ee.current.y),R.fillHandle===!0&&((i=R.previousSelection)==null?void 0:i.current)!==void 0){const g=R.previousSelection.current.range;s=Math.min(s,se?F-1:F);const w=ai(g,a,s,Tn);nn(w)}else{if(se&&m===F)return;if(se&&s===F)if(e.kind===cr)s--;else return;a=Math.max(a,u);const b=Do(m);s=b===void 0?s:Et(s,b[0],b[1]);const S=a-d,x=s-m,H={x:S>=0?d:a,y:x>=0?m:s,width:Math.abs(S)+1,height:Math.abs(x)+1};me({...h.current,range:H},!0,!1,"drag")}}Co==null||Co({...e,location:[e.location[0]-u,e.location[1]]})}},[R,u,Se,h,Ze,Co,ke,se,F,Tn,Do,me]),Ll=l.useCallback(()=>{var a,s;const e=hn.current;if(e===void 0)return;const[n,r]=e.scrollEdge;let[i,d]=e.location;const m=Ee.current;n===-1?i=((s=(a=m.extras)==null?void 0:a.freezeRegion)==null?void 0:s.x)??m.x:n===1&&(i=m.x+m.width),r===-1?d=Math.max(0,m.y):r===1&&(d=Math.min(F-1,m.y+m.height)),i=Et(i,0,W.length-1),d=Et(d,0,F-1),gn({...e,location:[i,d]})},[W.length,gn,F]);pc(bl,_,Ll);const We=l.useCallback(e=>{if(h.current===void 0)return;const[n,r]=e,[i,d]=h.current.cell,m=h.current.range;let a=m.x,s=m.x+m.width,g=m.y,w=m.y+m.height;const[b,S]=Do(d)??[0,F-1],x=S+1;if(r!==0)switch(r){case 2:{w=x,g=d,le(0,w,"vertical");break}case-2:{g=b,w=d+1,le(0,g,"vertical");break}case 1:{g<d?(g++,le(0,g,"vertical")):(w=Math.min(x,w+1),le(0,w,"vertical"));break}case-1:{w>d+1?(w--,le(0,w,"vertical")):(g=Math.max(b,g-1),le(0,g,"vertical"));break}default:ar()}if(n!==0)if(n===2)s=W.length,a=i,le(s-1-u,0,"horizontal");else if(n===-2)a=u,s=i+1,le(a-u,0,"horizontal");else{let H=[];if(ge!==void 0){const A=ge({x:a,y:g,width:s-a-u,height:w-g},Fe.current.signal);typeof A=="object"&&(H=zc(A))}if(n===1){let A=!1;if(a<i){if(H.length>0){const $=Vt(a+1,i+1).find(T=>!H.includes(T-u));$!==void 0&&(a=$,A=!0)}else a++,A=!0;A&&le(a,0,"horizontal")}A||(s=Math.min(W.length,s+1),le(s-1-u,0,"horizontal"))}else if(n===-1){let A=!1;if(s>i+1){if(H.length>0){const $=Vt(s-1,i,-1).find(T=>!H.includes(T-u));$!==void 0&&(s=$,A=!0)}else s--,A=!0;A&&le(s-u,0,"horizontal")}A||(a=Math.max(u,a-1),le(a-u,0,"horizontal"))}else ar()}me({cell:h.current.cell,range:{x:a,y:g,width:s-a,height:w-g}},!0,!1,"keyboard-select")},[ge,Do,h,W.length,u,F,le,me]),mn=l.useRef(Ln);mn.current=Ln;const ft=l.useCallback((e,n,r,i)=>{const d=pe-(r?0:1);e=Et(e,u,Te.length-1+u),n=Et(n,0,d);const m=Xe==null?void 0:Xe[0],a=Xe==null?void 0:Xe[1];if(e===m&&n===a)return!1;if(i&&h.current!==void 0){const s=[...h.current.rangeStack];(h.current.range.width>1||h.current.range.height>1)&&s.push(h.current.range),$e({...h,current:{cell:[e,n],range:{x:e,y:n,width:1,height:1},rangeStack:s}},!0)}else me({cell:[e,n],range:{x:e,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return v.current!==void 0&&v.current[0]===e&&v.current[1]===n&&(v.current=void 0),mn.current&&le(e-u,n),!0},[pe,u,Te.length,Xe,h,le,$e,me]),Hl=l.useCallback((e,n)=>{(C==null?void 0:C.cell)!==void 0&&e!==void 0&&co(e)&&(Ae([{location:C.cell,value:e}]),window.requestAnimationFrame(()=>{var d;(d=ie.current)==null||d.damage([{cell:C.cell}])})),Ce(!0),y(void 0);const[r,i]=n;if(h.current!==void 0&&(r!==0||i!==0)){const d=h.current.cell[1]===pe-1;if(d&&i===1){q==null||q(e,[0,0]);return}const m=h.current.cell[0]===W.length-1&&e!==void 0;let a=!0;if(d&&i===1&&je!==void 0){a=!1;const s=h.current.cell[0]+r,g=Gt(s);ut(g??s,!1)}if(m&&r===1&&nt!==void 0){a=!1;const s=h.current.cell[1]+i;Lo(s,!1)}if(a){const s=Et(h.current.cell[0]+r,0,W.length-1),g=Et(h.current.cell[1]+i,0,pe-1);ft(s,g,d,!1),Qr&&(r===0&&i===1||r===1&&i===0)&&window.setTimeout(()=>{var b;const w=O([s-u,g]);if(io(w)){const S=(b=ie.current)==null?void 0:b.getBounds(s,g);if(S&&w.allowOverlay){ie.current&&ie.current.focus();const x={current:{cell:[s,g],range:{x:s,y:g,width:1,height:1},rangeStack:[]},columns:Y.empty(),rows:Y.empty()};zt==null||zt(x);const H={inputType:"keyboard",key:"Enter"};te==null||te([s-u,g],H),At({target:S,content:w,initialValue:void 0,cell:[s,g],highlight:!0,forceEditMode:!0,activation:H})}}},50)}}q==null||q(e,n)},[C==null?void 0:C.cell,Ce,h,q,Ae,pe,ft,W.length,ut,Lo,je,nt,Gt,ie,O,u,te,Pt,At]),Dl=l.useMemo(()=>`gdg-overlay-${Ec++}`,[]),Tt=l.useCallback(e=>{var r,i,d,m;Ce();const n=[];for(let a=e.x;a<e.x+e.width;a++)for(let s=e.y;s<e.y+e.height;s++){const g=O([a-u,s]);if(!g.allowOverlay&&g.kind!==oe.Boolean)continue;let w;if(g.kind===oe.Custom){const b=Me(g),S=(r=b==null?void 0:b.provideEditor)==null?void 0:r.call(b,{...g,location:[a-u,s]});(b==null?void 0:b.onDelete)!==void 0?w=b.onDelete(g):ui(S)&&(w=(i=S==null?void 0:S.deletedValue)==null?void 0:i.call(S,g))}else if(co(g)&&g.allowOverlay||g.kind===oe.Boolean){const b=Me(g);w=(d=b==null?void 0:b.onDelete)==null?void 0:d.call(b,g)}w!==void 0&&!No(w)&&co(w)&&n.push({location:[a,s],value:w})}Ae(n),(m=ie.current)==null||m.damage(n.map(a=>({cell:a.location})))},[Ce,O,Me,Ae,u]),oo=C!==void 0,Zn=l.useCallback(e=>{var $,T,k;const n=()=>{e.stopPropagation(),e.preventDefault()},r={didMatch:!1},{bounds:i}=e,d=h.columns,m=h.rows,a=st;if(!oo&&G(a.clear,e,r)){const P=(($=h.current)==null?void 0:$.cell)??[u,0];$e({columns:Y.empty(),rows:Y.empty(),current:{cell:P,range:{x:P[0],y:P[1],width:1,height:1},rangeStack:[]}},!1),it==null||it(),Ce()}else if(!oo&&G(a.selectAll,e,r))$e({columns:Y.empty(),rows:Y.empty(),current:{cell:((T=h.current)==null?void 0:T.cell)??[u,0],range:{x:u,y:0,width:B.length,height:F},rangeStack:[]}},!1);else if(G(a.search,e,r))(k=D==null?void 0:D.current)==null||k.focus({preventScroll:!0}),Pn(!0);else if(G(a.delete,e,r)){const P=(at==null?void 0:at(h))??!0;if(P!==!1){const J=P===!0?h:P;if(J.current!==void 0){Tt(J.current.range);for(const U of J.current.rangeStack)Tt(U)}for(const U of J.rows)Tt({x:u,y:U,width:B.length,height:1});for(const U of J.columns)Tt({x:U,y:0,width:1,height:F})}}if(r.didMatch)return n(),!0;if(h.current===void 0)return!1;let[s,g]=h.current.cell;const[,w]=h.current.cell;let b=!1,S=!1;if(G(a.scrollToSelectedCell,e,r))$o.current(s-u,g);else if(xe!=="none"&&G(a.selectColumn,e,r))d.hasIndex(s)?ue(d.remove(s),void 0,!0):xe==="single"?ue(Y.fromSingleSelection(s),void 0,!0):ue(void 0,s,!0);else if(Se!=="none"&&G(a.selectRow,e,r))m.hasIndex(g)?ke(m.remove(g),void 0,!0):Se==="single"?ke(Y.fromSingleSelection(g),void 0,!0):ke(void 0,g,!0);else if(!oo&&i!==void 0&&G(a.activateCell,e,r))if(g===F&&se)window.setTimeout(()=>{const P=Gt(s);ut(P??s)},0);else{const P={inputType:"keyboard",key:e.key};te==null||te([s-u,g],P),Pt(i,P)}else h.current.range.height>1&&G(a.downFill,e,r)?qn():h.current.range.width>1&&G(a.rightFill,e,r)?Yn():G(a.goToNextPage,e,r)?g+=Math.max(1,Ee.current.height-4):G(a.goToPreviousPage,e,r)?g-=Math.max(1,Ee.current.height-4):G(a.goToFirstCell,e,r)?(y(void 0),g=0,s=0):G(a.goToLastCell,e,r)?(y(void 0),g=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER):G(a.selectToFirstCell,e,r)?(y(void 0),We([-2,-2])):G(a.selectToLastCell,e,r)?(y(void 0),We([2,2])):oo?(G(a.closeOverlay,e,r)&&y(void 0),G(a.acceptOverlayDown,e,r)&&(y(void 0),g++),G(a.acceptOverlayUp,e,r)&&(y(void 0),g--),G(a.acceptOverlayLeft,e,r)&&(y(void 0),s--),G(a.acceptOverlayRight,e,r)&&(y(void 0),s++)):(G(a.goDownCell,e,r)?g+=1:G(a.goUpCell,e,r)?g-=1:G(a.goRightCell,e,r)?s+=1:G(a.goLeftCell,e,r)?s-=1:G(a.goDownCellRetainSelection,e,r)?(g+=1,b=!0):G(a.goUpCellRetainSelection,e,r)?(g-=1,b=!0):G(a.goRightCellRetainSelection,e,r)?(s+=1,b=!0):G(a.goLeftCellRetainSelection,e,r)?(s-=1,b=!0):G(a.goToLastRow,e,r)?g=F-1:G(a.goToFirstRow,e,r)?g=Number.MIN_SAFE_INTEGER:G(a.goToLastColumn,e,r)?s=Number.MAX_SAFE_INTEGER:G(a.goToFirstColumn,e,r)?s=Number.MIN_SAFE_INTEGER:(Ze==="rect"||Ze==="multi-rect")&&(G(a.selectGrowDown,e,r)?We([0,1]):G(a.selectGrowUp,e,r)?We([0,-1]):G(a.selectGrowRight,e,r)?We([1,0]):G(a.selectGrowLeft,e,r)?We([-1,0]):G(a.selectToLastRow,e,r)?We([0,2]):G(a.selectToFirstRow,e,r)?We([0,-2]):G(a.selectToLastColumn,e,r)?We([2,0]):G(a.selectToFirstColumn,e,r)&&We([-2,0])),S=r.didMatch);if(Oe!==void 0&&Oe!=="normal"&&g!==w){const P=Oe==="skip-up"||Oe==="skip"||Oe==="block",J=Oe==="skip-down"||Oe==="skip"||Oe==="block",U=g<w;if(U&&P){for(;g>=0&&Rt(g).isGroupHeader;)g--;g<0&&(g=w)}else if(!U&&J){for(;g<F&&Rt(g).isGroupHeader;)g++;g>=F&&(g=w)}}const H=ft(s,g,!1,b),A=r.didMatch;return A&&(H||!S||En)&&n(),A},[Oe,oo,h,st,xe,Se,Ze,u,Rt,F,ft,$e,it,B.length,at,En,Tt,ue,ke,se,Gt,ut,te,Pt,qn,Yn,We]),no=l.useCallback(e=>{let n=!1;Xt!==void 0&&Xt({...e,...e.location&&{location:[e.location[0]-u,e.location[1]]},cancel:()=>{n=!0}}),!n&&(Zn(e)||h.current)},[Bo,Xt,Zn,h,O,u,F,se,te,Pt]),Il=l.useCallback((e,n)=>{const r=e.location[0]-u;if(e.kind==="header"&&(Ne==null||Ne(r,{...e,preventDefault:n})),e.kind===Wt){if(r<0)return;L==null||L(r,{...e,preventDefault:n})}if(e.kind==="cell"){const[i,d]=e.location;Ge==null||Ge([r,d],{...e,preventDefault:n}),di(h,e.location)||ft(i,d,!1,!1)}},[h,Ge,L,Ne,u,ft]),vn=l.useCallback(async e=>{var a,s,g;if(!st.paste)return;function n(w,b,S,x){var A,$;const H=typeof S=="object"?(S==null?void 0:S.join(`
`))??"":(S==null?void 0:S.toString())??"";if(!No(w)&&io(w)&&w.readonly!==!0){const T=ne==null?void 0:ne(H,w);if(T!==void 0&&co(T))return{location:b,value:T};const k=Me(w);if(k===void 0)return;if(k.kind===oe.Custom){Oo(w.kind===oe.Custom);const P=(A=k.onPaste)==null?void 0:A.call(k,H,w.data);return P===void 0?void 0:{location:b,value:{...w,data:P}}}else{const P=($=k.onPaste)==null?void 0:$.call(k,H,w,{formatted:x,formattedString:typeof x=="string"?x:x==null?void 0:x.join(`
`),rawValue:S});return P===void 0?void 0:(Oo(P.kind===w.kind),{location:b,value:P})}}}const r=h.columns,i=h.rows,d=((a=_.current)==null?void 0:a.contains(document.activeElement))===!0||((s=p.current)==null?void 0:s.contains(document.activeElement))===!0;let m;if(h.current!==void 0?m=[h.current.range.x,h.current.range.y]:r.length===1?m=[r.first()??0,0]:i.length===1&&(m=[u,i.first()??0]),d&&m!==void 0){let w,b;const S="text/plain",x="text/html";if(navigator.clipboard.read!==void 0){const T=await navigator.clipboard.read();for(const k of T){if(k.types.includes(x)){const J=await(await k.getType(x)).text(),U=ur(J);if(U!==void 0){w=U;break}}k.types.includes(S)&&(b=await(await k.getType(S)).text())}}else if(navigator.clipboard.readText!==void 0)b=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(x)){const T=e.clipboardData.getData(x);w=ur(T)}w===void 0&&e.clipboardData.types.includes(S)&&(b=e.clipboardData.getData(S))}else return;const[H,A]=m,$=[];do{if(bt===void 0){const T=ze(m),k=b??(w==null?void 0:w.map(J=>J.map(U=>U.rawValue).join("	")).join("	"))??"",P=n(T,m,k,void 0);P!==void 0&&$.push(P);break}if(w===void 0){if(b===void 0)return;w=fi(b)}if(bt===!1||typeof bt=="function"&&(bt==null?void 0:bt([m[0]-u,m[1]],w.map(T=>T.map(k=>{var P;return((P=k.rawValue)==null?void 0:P.toString())??""}))))!==!0)return;for(const[T,k]of w.entries()){if(T+A>=F)break;for(const[P,J]of k.entries()){const U=[P+H,T+A],[be,_e]=U;if(be>=W.length||_e>=pe)continue;const Ue=ze(U),Ye=n(Ue,U,J.rawValue,J.formatted);Ye!==void 0&&$.push(Ye)}}}while(!1);Ae($),(g=ie.current)==null||g.damage($.map(T=>({cell:T.location})))}},[ne,Me,ze,h,st.paste,_,W.length,Ae,pe,bt,u,F]);bn("paste",vn,M,!1,!0);const ro=l.useCallback(async(e,n)=>{var a,s;if(!st.copy)return;const r=n===!0||((a=_.current)==null?void 0:a.contains(document.activeElement))===!0||((s=p.current)==null?void 0:s.contains(document.activeElement))===!0,i=h.columns,d=h.rows,m=(g,w)=>{if(!Sn)dr(g,w,e);else{const b=w.map(S=>({kind:oe.Text,data:B[S].title,displayData:B[S].title,allowOverlay:!1}));dr([b,...g],w,e)}};if(r&&ge!==void 0){if(h.current!==void 0){let g=ge(h.current.range,Fe.current.signal);typeof g!="object"&&(g=await g()),m(g,Vt(h.current.range.x-u,h.current.range.x+h.current.range.width-u))}else if(d!==void 0&&d.length>0){const w=[...d].map(b=>{const S=ge({x:u,y:b,width:B.length,height:1},Fe.current.signal);return typeof S=="object"?S[0]:S().then(x=>x[0])});if(w.some(b=>b instanceof Promise)){const b=await Promise.all(w);m(b,Vt(B.length))}else m(w,Vt(B.length))}else if(i.length>0){const g=[],w=[];for(const b of i){let S=ge({x:b,y:0,width:1,height:F},Fe.current.signal);typeof S!="object"&&(S=await S()),g.push(S),w.push(b-u)}if(g.length===1)m(g[0],w);else{const b=g.reduce((S,x)=>S.map((H,A)=>[...H,...x[A]]));m(b,w)}}}},[B,ge,h,st.copy,u,_,F,Sn]);bn("copy",ro,M,!1,!1);const Fl=l.useCallback(async e=>{var r,i;if(!(!st.cut||!(((r=_.current)==null?void 0:r.contains(document.activeElement))===!0||((i=p.current)==null?void 0:i.contains(document.activeElement))===!0))&&(await ro(e),h.current!==void 0)){let d={current:{cell:h.current.cell,range:h.current.range,rangeStack:[]},rows:Y.empty(),columns:Y.empty()};const m=at==null?void 0:at(d);if(m===!1||(d=m===!0?d:m,d.current===void 0))return;Tt(d.current.range)}},[Tt,h,st.cut,ro,_,at]);bn("cut",Fl,M,!1,!1);const $l=l.useCallback((e,n)=>{if(Ke!==void 0){u!==0&&(e=e.map(d=>[d[0]-u,d[1]])),Ke(e,n);return}if(e.length===0||n===-1)return;const[r,i]=e[n];v.current!==void 0&&v.current[0]===r&&v.current[1]===i||(v.current=[r,i],ft(r,i,!1,!1))},[Ke,u,ft]),[Io,Fo]=((rr=yt==null?void 0:yt.current)==null?void 0:rr.cell)??[],$o=l.useRef(le);$o.current=le,l.useLayoutEffect(()=>{var e,n,r,i;mn.current&&!Ro.current&&Io!==void 0&&Fo!==void 0&&(Io!==((n=(e=Mo.current)==null?void 0:e.current)==null?void 0:n.cell[0])||Fo!==((i=(r=Mo.current)==null?void 0:r.current)==null?void 0:i.cell[1]))&&$o.current(Io,Fo),Ro.current=!1},[Io,Fo]);const Jn=h.current!==void 0&&(h.current.cell[0]>=W.length||h.current.cell[1]>=pe);l.useLayoutEffect(()=>{Jn&&$e(yn,!1)},[Jn,$e]);const Al=l.useMemo(()=>se===!0&&(X==null?void 0:X.tint)===!0?Y.fromSingleSelection(pe-1):Y.empty(),[pe,se,X==null?void 0:X.tint]),Pl=l.useCallback(e=>typeof Lt=="boolean"?Lt:(Lt==null?void 0:Lt(e-u))??!0,[u,Lt]),Gl=l.useMemo(()=>{if(an===void 0||p.current===null)return null;const{bounds:e,group:n}=an,r=p.current.getBoundingClientRect();return l.createElement(cc,{bounds:e,group:n,canvasBounds:r,onClose:()=>un(void 0),onFinish:i=>{un(void 0),ce==null||ce(n,i)}})},[ce,an]),Nl=Math.min(W.length,et+u);l.useImperativeHandle(o,()=>({appendRow:(e,n)=>ut(e+u,n),appendColumn:(e,n)=>Lo(e,n),updateCells:e=>{var n;return u!==0&&(e=e.map(r=>({cell:[r.cell[0]+u,r.cell[1]]}))),(n=ie.current)==null?void 0:n.damage(e)},getBounds:(e,n)=>{var r;if(!((p==null?void 0:p.current)===null||(_==null?void 0:_.current)===null)){if(e===void 0&&n===void 0){const i=p.current.getBoundingClientRect(),d=i.width/_.current.clientWidth;return{x:i.x-_.current.scrollLeft*d,y:i.y-_.current.scrollTop*d,width:_.current.scrollWidth*d,height:_.current.scrollHeight*d}}return(r=ie.current)==null?void 0:r.getBounds((e??0)+u,n)}},focus:()=>{var e;return(e=ie.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":no({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":no({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":no({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await ro(void 0,!0);break;case"paste":await vn();break}},scrollTo:le,remeasureColumns:e=>{for(const n of e)Ho(n+u)},getMouseArgsForPosition:(e,n,r)=>{if((ie==null?void 0:ie.current)===null)return;const i=ie.current.getMouseArgsForPosition(e,n,r);if(i!==void 0)return{...i,location:[i.location[0]-u,i.location[1]]}}}),[ut,Lo,Ho,_,ro,no,vn,u,le]);const[Qn,er]=Xe??[],Kl=l.useCallback(e=>{const[n,r]=e;if(r===-1){xe!=="none"&&(ue(Y.fromSingleSelection(n),void 0,!1),Ce());return}Qn===n&&er===r||(me({cell:e,range:{x:n,y:r,width:1,height:1}},!0,!1,"keyboard-nav"),le(n,r))},[xe,Ce,le,Qn,er,me,ue]),[Ol,Wl]=l.useState(!1),tr=l.useRef(Ci(e=>{Wl(e)},5)),Ul=l.useCallback(()=>{tr.current(!0),h.current===void 0&&h.columns.length===0&&h.rows.length===0&&R===void 0&&me({cell:[u,So],range:{x:u,y:So,width:1,height:1}},!0,!1,"keyboard-select")},[So,h,R,u,me]),Vl=l.useCallback(()=>{tr.current(!1)},[]),[Bl,Xl]=l.useMemo(()=>{let e;const n=(ae==null?void 0:ae.scrollbarWidthOverride)??hi(),r=F+(se?1:0);if(typeof ct=="number")e=Jt+r*ct;else{let d=0;const m=Math.min(r,10);for(let a=0;a<m;a++)d+=ct(a);d=Math.floor(d/m),e=Jt+r*d}e+=n;const i=W.reduce((d,m)=>m.width+d,0)+n;return[`${Math.min(1e5,i)}px`,`${Math.min(1e5,e)}px`]},[W,ae==null?void 0:ae.scrollbarWidthOverride,ct,F,se,Jt]),_l=l.useMemo(()=>gi(we),[we]);return l.createElement(mi.Provider,{value:we},l.createElement(vc,{style:_l,className:Bt,inWidth:j??Bl,inHeight:ve??Xl},l.createElement(nc,{fillHandle:Hr,drawFocusRing:Dn,experimental:ae,fixedShadowX:Dr,fixedShadowY:Ir,getRowThemeOverride:ot,headerIcons:Fr,imageWindowLoader:$r,initialSize:Ar,isDraggable:Pr,onDragLeave:Gr,onRowMoved:Ht,overscrollX:ll,overscrollY:il,preventDiagonalScrolling:Or,rightElement:Wr,rightElementProps:Ur,smoothScrollX:Vr,smoothScrollY:Br,className:Bt,enableGroups:on,onCanvasFocused:Ul,onCanvasBlur:Vl,canvasRef:p,onContextMenu:Il,theme:we,cellXOffset:wl,cellYOffset:So,accessibilityHeight:kt.height,onDragEnd:zl,columns:W,nonGrowWidth:Nn,drawHeader:gl,onColumnProposeMove:Sl,drawCell:ml,disabledRows:Al,freezeColumns:Nl,lockColumns:u,firstColAccessible:u===0,getCellContent:ze,minColumnWidth:It,maxColumnWidth:ko,searchInputRef:D,showSearch:sl,onSearchClose:al,highlightRegions:Cl,getCellsForSelection:ge,getGroupDetails:rn,headerHeight:en,isFocused:Ol,groupHeaderHeight:on?$n:0,freezeTrailingRows:tt+(se&&(X==null?void 0:X.sticky)===!0?1:0),hasAppendRow:se,onColumnResize:Ft,onColumnResizeEnd:fl,onColumnResizeStart:hl,onCellFocused:Kl,onColumnMoved:Tl,onDragStart:El,onHeaderMenuClick:kl,onHeaderIndicatorClick:Ml,onItemHovered:gn,isFilling:(R==null?void 0:R.fillHandle)===!0,onMouseMove:xl,onKeyDown:no,onKeyUp:wt,onMouseDown:pl,onMouseUp:yl,onDragOverCell:zr,onDrop:Lr,onSearchResultsChanged:$l,onVisibleRegionChanged:Rl,clientSize:tn,rowHeight:ct,searchResults:vt,searchValue:Vo,onSearchValueChange:ao,rows:pe,scrollRef:_,selection:h,translateX:kt.tx,translateY:kt.ty,verticalBorder:Pl,gridRef:ie,getCellRenderer:Me,resizeIndicator:Zr}),Gl,C!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(Tc,{...C,validateCell:dl,bloom:qe,id:Dl,getCellRenderer:Me,className:(ae==null?void 0:ae.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Sr,imageEditorOverride:E,portalElementRef:Jr,onFinishEditing:Hl,markdownDivCreateNode:V,isOutsideClick:jr,customEventTarget:ae==null?void 0:ae.eventTarget}))))},Hc=l.forwardRef(Lc),Dc=(t,o)=>{const c=l.useMemo(()=>({...Zi,...t.headerIcons}),[t.headerIcons]),f=l.useMemo(()=>t.renderers??vi,[t.renderers]),C=l.useMemo(()=>t.imageWindowLoader??new wi,[t.imageWindowLoader]);return l.createElement(Hc,{...t,renderers:f,headerIcons:c,ref:o,imageWindowLoader:C})},Wc=l.forwardRef(Dc);export{rc as C,Wc as D,ht as k,Mc as u};
