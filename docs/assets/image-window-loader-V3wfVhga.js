const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-By72j_Tx.js","./iframe-DNtM7szx.js","./preload-helper-C1FmrZbK.js","./marked.esm-Bk15hlo4.js","./react-number-format.es-DlYmFdwX.js","./number-overlay-editor-DjcVbkae.css"])))=>i.map(i=>d[i]);
var Yi=Object.defineProperty;var _i=(e,t,n)=>t in e?Yi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ee=(e,t,n)=>_i(e,typeof t!="symbol"?t+"":t,n);import{r as b,R as tn}from"./iframe-DNtM7szx.js";import{h as Vi,g as qi,k as Ui,v as ji,l as Ki,m as kn,r as Gi,j as Ji,t as Qi}from"./throttle-DwxcRZC0.js";import{s as ft,a as Zi}from"./marked.esm-Bk15hlo4.js";import{_ as er}from"./preload-helper-C1FmrZbK.js";function Uo(e="This should not happen"){throw new Error(e)}function dt(e,t="Assertion failed"){if(!e)return Uo(t)}function Jn(e,t){return Uo(t??"Hell froze over")}function ea(e,t){try{return e()}catch{return t}}const So=Object.prototype.hasOwnProperty;function Ot(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Ot(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(So.call(e,n)&&++o&&!So.call(t,n)||!(n in t)||!Ot(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const xn=null,Qn=void 0;var le=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(le||{}),tr=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e))(tr||{}),_n=(e=>(e.Triangle="triangle",e.Dots="dots",e))(_n||{});function ta(e){return"width"in e&&typeof e.width=="number"}async function na(e){return typeof e=="object"?e:await e()}function nr(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function oa(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function jo(e){return e.kind==="marker"||e.kind==="new-row"}function or(e){if(!nr(e)||e.kind==="image")return!1;switch(e.kind){case"text":case"number":case"markdown":case"uri":case"custom":case"boolean":return e.readonly!==!0;default:Jn(e,"A cell was passed with an invalid kind")}}function ia(e){return Vi(e,"editor")}function Zn(e){return!(e.readonly??!1)}var nn=(e=>(e.NewRow="new-row",e.Marker="marker",e))(nn||{});const Sn={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Wn(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Io;const Ve=class Ve{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Ve(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Wn([...this.items,n]);return new Ve(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,a]of n.entries()){const[s,l]=a;if(s<=i&&o<=l){const c=[];s<o&&c.push([s,o]),i<l&&c.push([i,l]),n.splice(r,1,...c)}}return new Ve(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};ee(Ve,"create",t=>new Ve(Wn(t))),ee(Ve,"empty",()=>Io??(Io=new Ve([]))),ee(Ve,"fromSingleSelection",t=>Ve.empty().add(t)),ee(Ve,"fromArray",t=>{if(t.length===0)return Ve.empty();const n=t.map(i=>[i,i+1]),o=Wn(n);return new Ve(o)});let Vn=Ve;function st(e,t,n,o,i=!1){const r=b.useRef();r.current=t,b.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,s=l=>{var c;(c=r.current)==null||c.call(a,l)};return a.addEventListener(e,s,{passive:o,capture:i}),()=>{a.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function ra(e,t){return e===void 0?void 0:t}const ir=Math.PI;function Co(e){return e*ir/180}const Ko=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Go=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},Jo=(e,t,n)=>Math.min(e,t-n*2),Qo=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,eo=e=>{const t=e.fgColor??"currentColor";return b.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},b.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),b.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},rr=e=>{const t=e.fgColor??"currentColor";return b.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},b.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function sr(e,t,n){const[o,i]=b.useState(e),r=b.useRef(!0);b.useEffect(()=>()=>{r.current=!1},[]);const a=b.useRef(qi(s=>{r.current&&i(s)},n));return b.useLayoutEffect(()=>{r.current&&a.current(()=>e())},t),o}const ar="֑-߿יִ-﷽ﹰ-ﻼ",lr="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",cr=new RegExp("^[^"+lr+"]*["+ar+"]");function to(e){return cr.test(e)?"rtl":"not-rtl"}let yn;function Mo(){if(typeof document>"u")return 0;if(yn!==void 0)return yn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),yn=n-o,yn}const Bt=Symbol();function sa(e){const t=b.useRef([Bt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=b.useState(e),[,i]=b.useState(),r=b.useCallback(s=>{const l=t.current[0];l!==Bt&&(s=typeof s=="function"?s(l):s,s===l)||(l!==Bt&&i({}),o(c=>typeof s=="function"?s(l===Bt?c:l):s),t.current[0]=Bt)},[]),a=b.useCallback(()=>{t.current[0]=Bt,i({})},[]);return[t.current[0]===Bt?n:t.current[0],r,a]}function Zo(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function aa(e){const t=b.useRef(e);return Ot(e,t.current)||(t.current=e),t.current}function dr(e,t){return tn.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function la(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(pn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function qn(e,t){return(e??"")===(t??"")}function ur(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function fr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function pn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ei(e){return[e.x+e.width-1,e.y+e.height-1]}function Eo(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,a=n.y+n.height-1,[s,l]=e;if(l<r||l>a)return!1;if(t.span===void 0)return s>=o&&s<=i;const[c,f]=t.span;return c>=o&&c<=i||f>=o&&c<=i||c<o&&f>i}function hr(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&Eo(e,t,r)&&i++;for(const a of n.current.rangeStack)Eo(e,t,a)&&i++;return i}function ti(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,a)=>({...r,sticky:e[a].sticky})),n=o}return n}function Xt(e,t){let n=0;const o=ti(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Pt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function Un(e,t,n,o,i){const r=ti(e,o),a=[];for(const c of r)if(c.sticky)a.push(c);else break;if(a.length>0)for(const c of a)n-=c.width;let s=t,l=i??0;for(;l<=n&&s<r.length;)l+=r[s].width,s++;for(let c=t;c<s;c++){const f=r[c];f.sticky||a.push(f)}return a}function gr(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function mr(e,t,n,o,i,r,a,s,l,c){const f=o+i;if(n&&e<=i)return-2;if(e<=f)return-1;let g=t;for(let d=0;d<c;d++){const u=r-1-d,v=typeof a=="number"?a:a(u);if(g-=v,e>=g)return u}const m=r-c,h=e-(l??0);if(typeof a=="number"){const d=Math.floor((h-f)/a)+s;return d>=m?void 0:d}else{let d=f;for(let u=s;u<m;u++){const v=a(u);if(h<=d+v)return u;d+=v}return}}let wn=0,Zt={};const br=typeof window>"u";async function yr(){var e;br||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,wn=0,Zt={},ji())}yr();function ni(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Yt(e,t,n,o="middle"){const i=ni(e,t,o,n);let r=Zt[i];return r===void 0&&(r=t.measureText(e),Zt[i]=r,wn++),wn>1e4&&(Zt={},wn=0),r}function oi(e,t){const n=ni(e,void 0,"middle",t);return Zt[n]}function wt(e,t){return typeof t!="string"&&(t=t.baseFontFull),vr(e,t)}function Bo(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Fo=[];function vr(e,t){for(const r of Fo)if(r.key===t)return r.val;const n=Bo(e,"alphabetic"),i=-(Bo(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Fo.push({key:t,val:i}),i}function pr(e,t,n,o,i,r){const{ctx:a,rect:s,theme:l}=e;let c=Number.MAX_SAFE_INTEGER;const f=500;if(t!==void 0&&(c=n-t,c<f)){const g=1-c/f;a.globalAlpha=g,a.fillStyle=l.bgSearchResult,a.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=l.bgSearchResult)}return c<f}function rn(e,t,n){const{ctx:o,theme:i}=e,r=t??{},a=n??i.textDark;return a!==r.fillStyle&&(o.fillStyle=a,r.fillStyle=a),r}function ii(e,t,n,o,i,r,a,s,l){l==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+a):l==="center"?e.fillText(t,n+i/2,o+r/2+a):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+a)}function ri(e,t){const n=Yt("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function wr(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function kr(e,t,n,o,i,r,a,s,l,c){const f=s.baseFontFull,g=Ui(e,t,f,i-s.cellHorizontalPadding*2,c??!1),m=ri(e,f),h=s.lineHeight*m,d=m+h*(g.length-1),u=d+s.cellVerticalPadding>r;u&&(e.save(),e.rect(n,o,i,r),e.clip());const v=o+r/2-d/2;let k=Math.max(o+s.cellVerticalPadding,v);for(const p of g)if(ii(e,p,n,k,i,m,a,s,l),k+=h,k>o+r)break;u&&e.restore()}function ut(e,t,n,o,i){const{ctx:r,rect:a,theme:s}=e,{x:l,y:c,width:f,height:g}=a;o=o??!1,o||(t=wr(t,f));const m=wt(r,s),h=to(t)==="rtl";if(n===void 0&&h&&(n="right"),h&&(r.direction="rtl"),t.length>0){let d=!1;n==="right"?(r.textAlign="right",d=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,d=!0),o?kr(r,t,l,c,f,g,m,s,n,i):ii(r,t,l,c,f,g,m,s,n),d&&(r.textAlign="start"),h&&(r.direction="inherit")}}function at(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function xr(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Sr(e,t,n){const o=function(s,l){const c=l.x-s.x,f=l.y-s.y,g=Math.sqrt(c*c+f*f),m=c/g,h=f/g;return{x:c,y:l.y-s.y,len:g,nx:m,ny:h,ang:Math.atan2(h,m)}};let i;const r=t.length;let a=t[r-1];for(let s=0;s<r;s++){let l=t[s%r];const c=t[(s+1)%r],f=o(l,a),g=o(l,c),m=f.nx*g.ny-f.ny*g.nx,h=f.nx*g.nx-f.ny*-g.ny;let d=Math.asin(m<-1?-1:m>1?1:m),u=1,v=!1;h<0?d<0?d=Math.PI+d:(d=Math.PI-d,u=-1,v=!0):d>0&&(u=-1,v=!0),i=l.radius!==void 0?l.radius:n;const k=d/2;let p=Math.abs(Math.cos(k)*i/Math.sin(k)),C;p>Math.min(f.len/2,g.len/2)?(p=Math.min(f.len/2,g.len/2),C=Math.abs(p*Math.sin(k)/Math.cos(k))):C=i;let B=l.x+g.nx*p,D=l.y+g.ny*p;B+=-g.ny*C*u,D+=g.nx*C*u,e.arc(B,D,C,f.ang+Math.PI/2*u,g.ang-Math.PI/2*u,v),a=l,l=c}e.closePath()}function jn(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d){const u={x:0,y:r+c,width:0,height:0};if(e>=h.length||t>=f||t<-2||e<0)return u;const v=r-i;if(e>=g){const k=a>e?-1:1,p=Xt(h);u.x+=p+l;for(let C=a;C!==e;C+=k)u.x+=h[k===1?C:C-1].width*k}else for(let k=0;k<e;k++)u.x+=h[k].width;if(u.width=h[e].width+1,t===-1)u.y=i,u.height=v;else if(t===-2){u.y=0,u.height=i;let k=e;const p=h[e].group,C=h[e].sticky;for(;k>0&&qn(h[k-1].group,p)&&h[k-1].sticky===C;){const D=h[k-1];u.x-=D.width,u.width+=D.width,k--}let B=e;for(;B+1<h.length&&qn(h[B+1].group,p)&&h[B+1].sticky===C;){const D=h[B+1];u.width+=D.width,B++}if(!C){const D=Xt(h),I=u.x-D;I<0&&(u.x-=I,u.width+=I),u.x+u.width>n&&(u.width=n-u.x)}}else if(t>=f-m){let k=f-t;for(u.y=o;k>0;){const p=t+k-1;u.height=typeof d=="number"?d:d(p),u.y-=u.height,k--}u.height+=1}else{const k=s>t?-1:1;if(typeof d=="number"){const p=t-s;u.y+=p*d}else for(let p=s;p!==t;p+=k)u.y+=d(p)*k;u.height=(typeof d=="number"?d:d(t))+1}return u}const no=1<<21;function et(e,t){return(t+2)*no+e}function si(e){return e%no}function oo(e){return Math.floor(e/no)-2}function io(e){const t=si(e),n=oo(e);return[t,n]}class ai{constructor(){ee(this,"visibleWindow",{x:0,y:0,width:0,height:0});ee(this,"freezeCols",0);ee(this,"freezeRows",[]);ee(this,"isInWindow",t=>{const n=si(t),o=oo(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,a=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Ot(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Ir extends ai{constructor(){super(...arguments);ee(this,"cache",new Map);ee(this,"setValue",(n,o)=>{this.cache.set(et(n[0],n[1]),o)});ee(this,"getValue",n=>this.cache.get(et(n[0],n[1])));ee(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class en{constructor(t=[]){ee(this,"cells");this.cells=new Set(t.map(n=>et(n[0],n[1])))}add(t){this.cells.add(et(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(et(t[0],t[1]))}remove(t){this.cells.delete(et(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(oo(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(et(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield io(t)}}function Cr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Mr{constructor(t,n){ee(this,"spriteMap",new Map);ee(this,"headerIcons");ee(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,a,s,l=1){const[c,f]=Cr(n,s),g=a*Math.ceil(window.devicePixelRatio),m=`${c}_${f}_${g}_${t}`;let h=this.spriteMap.get(m);if(h===void 0){const d=this.headerIcons[t];if(d===void 0)return;h=document.createElement("canvas");const u=h.getContext("2d");if(u===null)return;const v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(d({fgColor:f,bgColor:c}))}`,this.spriteMap.set(m,h);const k=v.decode();if(k===void 0)return;this.inFlight++,k.then(()=>{u.drawImage(v,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else l<1&&(o.globalAlpha=l),o.drawImage(h,0,0,g,g,i,r,a,a),l<1&&(o.globalAlpha=1)}}const zn={};let pt=null;function Er(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Kn(e){const t=e.toLowerCase().trim();if(zn[t]!==void 0)return zn[t];pt=pt||Er(),pt.style.color="#000",pt.style.color=t;const n=getComputedStyle(pt).color;pt.style.color="#fff",pt.style.color=t;const o=getComputedStyle(pt).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),zn[t]=i,i}function sn(e,t){const[n,o,i]=Kn(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Po=new Map;function Do(e,t){const n=`${e}-${t}`,o=Po.get(n);if(o!==void 0)return o;const i=Ge(e,t);return Po.set(n,i),i}function Ge(e,t){if(t===void 0)return e;const[n,o,i,r]=Kn(e);if(r===1)return e;const[a,s,l,c]=Kn(t),f=r+c*(1-r),g=(r*n+c*a*(1-r))/f,m=(r*o+c*s*(1-r))/f,h=(r*i+c*l*(1-r))/f;return`rgba(${g}, ${m}, ${h}, ${f})`}function li(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function In(e,t,n,o,i,r,a,s,l){s=s??t;let c=t,f=e;const g=o-r;let m=!1;for(;c<n&&f<g;){const h=i(f);if(c+h>s&&l(c,f,h,!1,a&&f===o-1)===!0){m=!0;break}c+=h,f++}if(!m){c=n;for(let h=0;h<r;h++){f=o-1-h;const d=i(f);c-=d,l(c,f,d,!0,a&&f===o-1)}}}function kt(e,t,n,o,i,r){let a=0,s=0;const l=i+o;for(const c of e){const f=c.sticky?s:a+n;if(r(c,f,l,c.sticky?0:s,t)===!0)break;a+=c.width,s+=c.sticky?c.width:0}}function ci(e,t,n,o,i){let r=0,a=0;for(let s=0;s<e.length;s++){const l=e[s];let c=s+1,f=l.width;for(l.sticky&&(a+=f);c<e.length&&qn(e[c].group,l.group)&&e[c].sticky===e[s].sticky;){const u=e[c];f+=u.width,c++,s++,u.sticky&&(a+=u.width)}const g=l.sticky?0:n,m=r+g,h=l.sticky?0:Math.max(0,a-m),d=Math.min(f-h,t-(m+h));i([l.sourceIndex,e[c-1].sourceIndex],l.group??"",m+h,0,d,o),r+=f}}function di(e,t,n,o,i,r,a){var m;const[s,l]=e;let c,f;const g=((m=a.find(h=>!h.sticky))==null?void 0:m.sourceIndex)??0;if(l>g){const h=Math.max(s,g);let d=t,u=o;for(let v=r.sourceIndex-1;v>=h;v--)d-=a[v].width,u+=a[v].width;for(let v=r.sourceIndex+1;v<=l;v++)u+=a[v].width;f={x:d,y:n,width:u,height:i}}if(g>s){const h=Math.min(l,g-1);let d=t,u=o;for(let v=r.sourceIndex-1;v>=s;v--)d-=a[v].width,u+=a[v].width;for(let v=r.sourceIndex+1;v<=h;v++)u+=a[v].width;c={x:d,y:n,width:u,height:i}}return[c,f]}function ca(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ui={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function da(){return ui}const ua=tn.createContext(ui);function $t(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=Ge(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function fa(e,t,n,o){if(o==="any")return Br(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),fr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,a=n-e.y+1,s=e.y+e.height-n,l=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return l===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:l===a?{x:e.x,y:n,width:e.width,height:e.y-n}:l===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function on(e,t,n,o,i,r,a,s){return e<=i+a&&i<=e+n&&t<=r+s&&r<=t+o}function Nt(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Br(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Fr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Pr(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,a=t+4,s=n+4,l=i-e.x,c=e.x+e.width-a,f=r-e.y,g=e.y+e.height-s,m=l>0?e.x+Math.floor(l/o)*o:e.x,h=c>0?e.x+e.width-Math.floor(c/o)*o:e.x+e.width,d=f>0?e.y+Math.floor(f/o)*o:e.y,u=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:d,width:h-m,height:u-d}}function Dr(e,t,n,o,i){const[r,a,s,l]=t,[c,f,g,m]=i,{x:h,y:d,width:u,height:v}=e,k=[];if(u<=0||v<=0)return k;const p=h+u,C=d+v,B=h<r,D=d<a,I=h+u>s,F=d+v>l,W=h>=r&&h<s||p>r&&p<=s||h<r&&p>s,S=d>=a&&d<l||C>a&&C<=l||d<a&&C>l;if(W&&S){const E=Math.max(h,r),P=Math.max(d,a),x=Math.min(p,s),w=Math.min(C,l);k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:c,y:f,width:g-c+1,height:m-f+1}})}if(B&&D){const E=h,P=d,x=Math.min(p,r),w=Math.min(C,a);k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:0,y:0,width:c+1,height:f+1}})}if(D&&W){const E=Math.max(h,r),P=d,x=Math.min(p,s),w=Math.min(C,a);k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:c,y:0,width:g-c+1,height:f+1}})}if(D&&I){const E=Math.max(h,s),P=d,x=p,w=Math.min(C,a);k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:g,y:0,width:n-g+1,height:f+1}})}if(B&&S){const E=h,P=Math.max(d,a),x=Math.min(p,r),w=Math.min(C,l);k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:0,y:f,width:c+1,height:m-f+1}})}if(I&&S){const E=Math.max(h,s),P=Math.max(d,a),x=p,w=Math.min(C,l);k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:g,y:f,width:n-g+1,height:m-f+1}})}if(B&&F){const E=h,P=Math.max(d,l),x=Math.min(p,r),w=C;k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:0,y:m,width:c+1,height:o-m+1}})}if(F&&W){const E=Math.max(h,r),P=Math.max(d,l),x=Math.min(p,s),w=C;k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:c,y:m,width:g-c+1,height:o-m+1}})}if(I&&F){const E=Math.max(h,s),P=Math.max(d,l),x=p,w=C;k.push({rect:{x:E,y:P,width:x-E,height:w-P},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return k}const Ar={kind:le.Loading,allowOverlay:!1};function Ao(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u,v,k,p,C,B,D,I,F,W,S,H,E,P,x,w,V,R,$,Q){let G=(C==null?void 0:C.size)??Number.MAX_SAFE_INTEGER;const U=performance.now();let j=x.baseFontFull;e.font=j;const ge={ctx:e},_=[0,0],ce=v>0?Pt(l,v,c):0;let be,N;const se=li(p);return kt(t,s,r,a,i,(ne,De,Be,Ce,Je)=>{const Ye=Math.max(0,Ce-De),$e=De+Ye,ye=i+1,ht=ne.width-Ye,gt=o-i-1;if(p.length>0){let Me=!1;for(let ae=0;ae<p.length;ae++){const pe=p[ae];if(on($e,ye,ht,gt,pe.x,pe.y,pe.width,pe.height)){Me=!0;break}}if(!Me)return}const qe=()=>{e.save(),e.beginPath(),e.rect($e,ye,ht,gt),e.clip()},de=B.columns.hasIndex(ne.sourceIndex),Ue=g(ne.group??"").overrideTheme,Ae=ne.themeOverride===void 0&&Ue===void 0?x:$t(x,Ue,ne.themeOverride),Oe=Ae.baseFontFull;Oe!==j&&(j=Oe,e.font=Oe),qe();let te;return In(Je,Be,o,l,c,v,k,se,(Me,ae,pe,O,q)=>{var St,tt,nt;if(ae<0||(_[0]=ne.sourceIndex,_[1]=ae,C!==void 0&&!C.has(_)))return;if(p.length>0){let ie=!1;for(let Re=0;Re<p.length;Re++){const Ie=p[Re];if(on(De,Me,ne.width,pe,Ie.x,Ie.y,Ie.width,Ie.height)){ie=!0;break}}if(!ie)return}const ue=B.rows.hasIndex(ae),oe=h.hasIndex(ae),re=ae<l?f(_):Ar;let Fe=De,fe=ne.width,J=!1,We=!1;if(re.span!==void 0){const[ie,Re]=re.span,Ie=`${ae},${ie},${Re},${ne.sticky}`;if(N===void 0&&(N=new Set),N.has(Ie)){G--;return}else{const ot=di(re.span,De,Me,ne.width,pe,ne,n),Ke=ne.sticky?ot[0]:ot[1];if(!ne.sticky&&ot[0]!==void 0&&(We=!0),Ke!==void 0){Fe=Ke.x,fe=Ke.width,N.add(Ie),e.restore(),te=void 0,e.save(),e.beginPath();const mt=Math.max(0,Ce-Ke.x);e.rect(Ke.x+mt,Me,Ke.width-mt,pe),be===void 0&&(be=[]),be.push({x:Ke.x+mt,y:Me,width:Ke.width-mt,height:pe}),e.clip(),J=!0}}}const Ze=m==null?void 0:m(ae),je=q&&((St=ne.trailingRowOptions)==null?void 0:St.themeOverride)!==void 0?(tt=ne.trailingRowOptions)==null?void 0:tt.themeOverride:void 0,He=re.themeOverride===void 0&&Ze===void 0&&je===void 0?Ae:$t(Ae,Ze,je,re.themeOverride);e.beginPath();const Qe=ur(_,re,B);let Xe=hr(_,re,B,u);const Dt=re.span!==void 0&&B.columns.some(ie=>re.span!==void 0&&ie>=re.span[0]&&ie<=re.span[1]);Qe&&!d&&u?Xe=0:Qe&&u&&(Xe=Math.max(Xe,1)),Dt&&Xe++,Qe||(ue&&Xe++,de&&!q&&Xe++);const At=re.kind===le.Protected?He.bgCellMedium:He.bgCell;let xe;if((O||At!==x.bgCell)&&(xe=Ge(At,xe)),Xe>0||oe){oe&&(xe=Ge(He.bgHeader,xe));for(let ie=0;ie<Xe;ie++)xe=Ge(He.accentLight,xe)}else if(D!==void 0){for(const ie of D)if(ie[0]===ne.sourceIndex&&ie[1]===ae){xe=Ge(He.bgSearchResult,xe);break}}if(I!==void 0)for(let ie=0;ie<I.length;ie++){const Re=I[ie],Ie=Re.range;Re.style!=="solid-outline"&&Ie.x<=ne.sourceIndex&&ne.sourceIndex<Ie.x+Ie.width&&Ie.y<=ae&&ae<Ie.y+Ie.height&&(xe=Ge(Re.color,xe))}let xt=!1;if(C!==void 0){const ie=Me+1,Ie=(O?ie+pe-1:Math.min(ie+pe-1,o-ce))-ie;(Ie!==pe-1||Fe+1<=Ce)&&(xt=!0,e.save(),e.beginPath(),e.rect(Fe+1,ie,fe-1,Ie),e.clip()),xe=xe===void 0?He.bgCell:Ge(xe,He.bgCell)}const lt=ne.sourceIndex===n.length-1,Se=ae===l-1;xe!==void 0&&(e.fillStyle=xe,te!==void 0&&(te.fillStyle=xe),C!==void 0?e.fillRect(Fe+1,Me+1,fe-(lt?2:1),pe-(Se?2:1)):e.fillRect(Fe,Me,fe,pe)),re.style==="faded"&&(e.globalAlpha=.6);let _e;for(let ie=0;ie<S.length;ie++){const Re=S[ie];if(Re.item[0]===ne.sourceIndex&&Re.item[1]===ae){_e=Re;break}}if(fe>Q&&!We){const ie=He.baseFontFull;ie!==j&&(e.font=ie,j=ie),te=fi(e,re,ne.sourceIndex,ae,lt,Se,Fe,Me,fe,pe,Xe>0,He,xe??He.bgCell,F,W,(_e==null?void 0:_e.hoverAmount)??0,H,P,U,E,te,w,V,R,$)}return xt&&e.restore(),re.style==="faded"&&(e.globalAlpha=1),G--,J&&(e.restore(),(nt=te==null?void 0:te.deprep)==null||nt.call(te,ge),te=void 0,qe(),j=Oe,e.font=Oe),G<=0}),e.restore(),G<=0}),be}const jt=[0,0],Kt={x:0,y:0,width:0,height:0},Ln=[void 0,()=>{}];let Gn=!1;function Hr(){Gn=!0}function fi(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u,v,k,p,C,B,D,I,F,W){var V,R;let S,H;v!==void 0&&v[0][0]===n&&v[0][1]===o&&(S=v[1][0],H=v[1][1]);let E;jt[0]=n,jt[1]=o,Kt.x=a,Kt.y=s,Kt.width=l,Kt.height=c,Ln[0]=I.getValue(jt),Ln[1]=$=>I.setValue(jt,$),Gn=!1;const P={ctx:e,theme:g,col:n,row:o,cell:t,rect:Kt,highlighted:f,cellFillColor:m,hoverAmount:u,frameTime:p,hoverX:S,drawState:Ln,hoverY:H,imageLoader:h,spriteManager:d,hyperWrapping:k,overrideCursor:S!==void 0?W:void 0,requestAnimationFrame:Hr},x=pr(P,t.lastUpdated,p,B,i,r),w=F(t);if(w!==void 0){(B==null?void 0:B.renderer)!==w&&((V=B==null?void 0:B.deprep)==null||V.call(B,P),B=void 0);const $=(R=w.drawPrep)==null?void 0:R.call(w,P,B);C!==void 0&&!jo(P.cell)?C(P,()=>w.draw(P,t)):w.draw(P,t),E=$===void 0?void 0:{deprep:$==null?void 0:$.deprep,fillStyle:$==null?void 0:$.fillStyle,font:$==null?void 0:$.font,renderer:w}}return(x||Gn)&&(D==null||D(jt)),E}function ro(e,t,n,o,i,r,a,s,l=-20,c=-20,f=void 0,g="center",m="square"){const h=Math.floor(i+a/2),d=m==="circle"?1e4:t.roundingRadius??4;let u=Jo(f??t.checkboxMaxSize,a,t.cellVerticalPadding),v=u/2;const k=Go(g,o,r,t.cellHorizontalPadding,u),p=Ko(k,h,u),C=Qo(o+l,i+c,p);switch(n){case!0:{e.beginPath(),at(e,k-u/2,h-u/2,u,u,d),m==="circle"&&(v*=.8,u*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(k-v+u/4.23,h-v+u/1.97),e.lineTo(k-v+u/2.42,h-v+u/1.44),e.lineTo(k-v+u/1.29,h-v+u/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case xn:case!1:{e.beginPath(),at(e,k-u/2+.5,h-u/2+.5,u-1,u-1,d),e.lineWidth=1,e.strokeStyle=C?t.textDark:t.textMedium,e.stroke();break}case Qn:{e.beginPath(),at(e,k-u/2,h-u/2,u,u,d),e.fillStyle=C?t.textMedium:t.textLight,e.fill(),m==="circle"&&(v*=.8,u*=.8),e.beginPath(),e.moveTo(k-u/3,h),e.lineTo(k+u/3,h),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Jn()}}function Rr(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u,v,k,p){var S,H,E,P;const C=a+s;if(C<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,i,C);const B=(S=o==null?void 0:o[0])==null?void 0:S[0],D=(H=o==null?void 0:o[0])==null?void 0:H[1],I=(E=o==null?void 0:o[1])==null?void 0:E[0],F=(P=o==null?void 0:o[1])==null?void 0:P[1],W=g.headerFontFull;e.font=W,kt(t,0,r,0,C,(x,w,V,R)=>{var ne;if(v!==void 0&&!v.has([x.sourceIndex,-1]))return;const $=Math.max(0,R-w);e.save(),e.beginPath(),e.rect(w+$,s,x.width-$,a),e.clip();const Q=u(x.group??"").overrideTheme,G=x.themeOverride===void 0&&Q===void 0?g:$t(g,Q,x.themeOverride);G.bgHeader!==g.bgHeader&&(e.fillStyle=G.bgHeader,e.fill()),G!==g&&(e.font=G.headerFontFull);const U=f.columns.hasIndex(x.sourceIndex),j=l!==void 0||c||x.headerRowMarkerDisabled===!0,ge=!j&&D===-1&&B===x.sourceIndex,_=j?0:((ne=h.find(De=>De.item[0]===x.sourceIndex&&De.item[1]===-1))==null?void 0:ne.hoverAmount)??0,ce=(f==null?void 0:f.current)!==void 0&&f.current.cell[0]===x.sourceIndex,be=U?G.accentColor:ce?G.bgHeaderHasFocus:G.bgHeader,N=n?s:0,se=x.sourceIndex===0?0:1;U?(e.fillStyle=be,e.fillRect(w+se,N,x.width-se,a)):(ce||_>0)&&(e.beginPath(),e.rect(w+se,N,x.width-se,a),ce&&(e.fillStyle=G.bgHeaderHasFocus,e.fill()),_>0&&(e.globalAlpha=_,e.fillStyle=G.bgHeaderHovered,e.fill(),e.globalAlpha=1)),mi(e,w,N,x.width,a,x,U,G,ge,ge?I:void 0,ge?F:void 0,ce,_,m,k,p),e.restore()}),n&&Tr(e,t,i,r,s,o,g,m,h,d,u,v)}function Tr(e,t,n,o,i,r,a,s,l,c,f,g){const[h,d]=(r==null?void 0:r[0])??[];let u=0;ci(t,n,o,i,(v,k,p,C,B,D)=>{if(g!==void 0&&!g.hasItemInRectangle({x:v[0],y:-2,width:v[1]-v[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(p,C,B,D),e.clip();const I=f(k),F=(I==null?void 0:I.overrideTheme)===void 0?a:$t(a,I.overrideTheme),W=d===-2&&h!==void 0&&h>=v[0]&&h<=v[1],S=W?F.bgGroupHeaderHovered??F.bgHeaderHovered:F.bgGroupHeader??F.bgHeader;if(S!==a.bgHeader&&(e.fillStyle=S,e.fill()),e.fillStyle=F.textGroupHeader??F.textHeader,I!==void 0){let H=p;if(I.icon!==void 0&&(s.drawSprite(I.icon,"normal",e,H+8,(i-20)/2,20,F),H+=26),e.fillText(I.name,H+8,i/2+wt(e,a.headerFontFull)),I.actions!==void 0&&W){const E=hi({x:p,y:C,width:B,height:D},I.actions);e.beginPath();const P=E[0].x-10,x=p+B-P;e.rect(P,0,x,i);const w=e.createLinearGradient(P,0,P+x,0),V=sn(S,0);w.addColorStop(0,V),w.addColorStop(10/x,S),w.addColorStop(1,S),e.fillStyle=w,e.fill(),e.globalAlpha=.6;const[R,$]=(r==null?void 0:r[1])??[-1,-1];for(let Q=0;Q<I.actions.length;Q++){const G=I.actions[Q],U=E[Q],j=Nt(U,R+p,$);j&&(e.globalAlpha=1),s.drawSprite(G.icon,"normal",e,U.x+U.width/2-10,U.y+U.height/2-10,20,F),j&&(e.globalAlpha=.6)}e.globalAlpha=1}}p!==0&&c(v[0])&&(e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,i),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),u=p+B}),e.beginPath(),e.moveTo(u+.5,0),e.lineTo(u+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const vn=30;function Wr(e,t,n,o,i){return{x:e+n-vn,y:Math.max(t,t+o/2-vn/2),width:vn,height:Math.min(vn,o)}}function hi(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,a=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:a,height:r}),o+=26;return n}function Gt(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function gi(e,t,n,o,i,r,a,s){var k;const l=a.cellHorizontalPadding,c=a.headerIconSize,f=Wr(n,o,i,r);let g=n+l;const m=t.icon===void 0?void 0:{x:g,y:o+(r-c)/2,width:c,height:c},h=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(g+=Math.ceil(c*1.3));const d={x:g,y:o,width:i-g,height:r};let u;if(t.indicatorIcon!==void 0){const p=e===void 0?((k=oi(t.title,a.headerFontFull))==null?void 0:k.width)??0:Yt(t.title,e,a.headerFontFull).width;d.width=p,g+=p+l,u={x:g,y:o+(r-c)/2,width:c,height:c}}const v=n+i/2;return{menuBounds:Gt(f,v,s),iconBounds:Gt(m,v,s),iconOverlayBounds:Gt(h,v,s),textBounds:Gt(d,v,s),indicatorIconBounds:Gt(u,v,s)}}function Ho(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const p=r.rowMarkerChecked;p!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const C=r.headerRowMarkerTheme!==void 0?$t(s,r.headerRowMarkerTheme):s;ro(e,C,p,t,n,o,i,!1,void 0,void 0,s.checkboxMaxSize,"center",r.rowMarker),p!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const v=a?s.textHeaderSelected:s.textHeader,k=r.hasMenu===!0&&(l||h&&a)&&u.menuBounds!==void 0;if(r.icon!==void 0&&u.iconBounds!==void 0){let p=a?"selected":"normal";r.style==="highlight"&&(p=a?"selected":"special"),m.drawSprite(r.icon,p,e,u.iconBounds.x,u.iconBounds.y,u.iconBounds.width,s),r.overlayIcon!==void 0&&u.iconOverlayBounds!==void 0&&m.drawSprite(r.overlayIcon,a?"selected":"special",e,u.iconOverlayBounds.x,u.iconOverlayBounds.y,u.iconOverlayBounds.width,s)}if(k&&o>35){const C=d?35:o-35,B=d?35*.7:o-35*.7,D=C/o,I=B/o,F=e.createLinearGradient(t,0,t+o,0),W=sn(v,0);F.addColorStop(d?1:0,v),F.addColorStop(D,v),F.addColorStop(I,W),F.addColorStop(d?0:1,W),e.fillStyle=F}else e.fillStyle=v;if(d&&(e.textAlign="right"),u.textBounds!==void 0&&e.fillText(r.title,d?u.textBounds.x+u.textBounds.width:u.textBounds.x,n+i/2+wt(e,s.headerFontFull)),d&&(e.textAlign="left"),r.indicatorIcon!==void 0&&u.indicatorIconBounds!==void 0&&(!k||!on(u.menuBounds.x,u.menuBounds.y,u.menuBounds.width,u.menuBounds.height,u.indicatorIconBounds.x,u.indicatorIconBounds.y,u.indicatorIconBounds.width,u.indicatorIconBounds.height))){let p=a?"selected":"normal";r.style==="highlight"&&(p=a?"selected":"special"),m.drawSprite(r.indicatorIcon,p,e,u.indicatorIconBounds.x,u.indicatorIconBounds.y,u.indicatorIconBounds.width,s)}if(k&&u.menuBounds!==void 0){const p=u.menuBounds,C=c!==void 0&&f!==void 0&&Nt(p,c+t,f+n);if(C||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===_n.Triangle){e.beginPath();const B=p.x+p.width/2-5.5,D=p.y+p.height/2-3;Sr(e,[{x:B,y:D},{x:B+11,y:D},{x:B+5.5,y:D+6}],1),e.fillStyle=v,e.fill()}else if(r.menuIcon===_n.Dots){e.beginPath();const B=p.x+p.width/2,D=p.y+p.height/2;xr(e,B,D),e.fillStyle=v,e.fill()}else{const B=p.x+(p.width-s.headerIconSize)/2,D=p.y+(p.height-s.headerIconSize)/2;m.drawSprite(r.menuIcon,"normal",e,B,D,s.headerIconSize,s)}C||(e.globalAlpha=1)}}function mi(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u){const v=to(r.title)==="rtl",k=gi(e,r,t,n,o,i,s,v);d!==void 0?d({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:a,hoverAmount:m,isHovered:l,hasSelectedCell:g,spriteManager:h,menuBounds:(k==null?void 0:k.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:c,hoverY:f},()=>Ho(e,t,n,o,i,r,a,s,l,c,f,m,h,u,v,k)):Ho(e,t,n,o,i,r,a,s,l,c,f,m,h,u,v,k)}function zr(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u,v,k,p){if(k!==void 0||t[t.length-1]!==n[t.length-1])return;const C=li(v);kt(t,l,a,s,r,(B,D,I,F,W)=>{if(B!==t[t.length-1])return;D+=B.width;const S=Math.max(D,F);S>o||(e.save(),e.beginPath(),e.rect(S,r+1,1e4,i-r-1),e.clip(),In(W,I,i,c,f,d,u,C,(H,E,P,x)=>{if(!x&&v.length>0&&!v.some(Q=>on(D,H,1e4,P,Q.x,Q.y,Q.width,Q.height)))return;const w=m.hasIndex(E),V=h.hasIndex(E);e.beginPath();const R=g==null?void 0:g(E),$=R===void 0?p:$t(p,R);$.bgCell!==p.bgCell&&(e.fillStyle=$.bgCell,e.fillRect(D,H,1e4,P)),V&&(e.fillStyle=$.bgHeader,e.fillRect(D,H,1e4,P)),w&&(e.fillStyle=$.accentLight,e.fillRect(D,H,1e4,P))}),e.restore())})}function Lr(e,t,n,o,i,r,a,s,l){let c=!1;for(const d of t)if(!d.sticky){c=a(d.sourceIndex);break}const f=l.horizontalBorderColor??l.borderColor,g=l.borderColor,m=c?Xt(t):0;let h;if(m!==0&&(h=Do(g,l.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=h,e.stroke()),i>0){const d=g===f&&h!==void 0?h:Do(f,l.bgCell),u=Pt(r,i,s);e.beginPath(),e.moveTo(0,o-u+.5),e.lineTo(n,o-u+.5),e.strokeStyle=d,e.stroke()}}const bi=(e,t,n)=>{let o=0,i=t,r=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),a=Math.max(a,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:a}};function Nr(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d){var P;const u=d.bgCell,{minX:v,maxX:k,minY:p,maxY:C}=bi(s,r,a),B=[],D=a-Pt(h,m,c);let I=l,F=n,W=0;for(;I+i<D;){const x=I+i,w=c(F);if(x>=p&&x<=C-1){const V=f==null?void 0:f(F),R=V==null?void 0:V.bgCell;R!==void 0&&R!==u&&F>=h-m&&B.push({x:v,y:x,w:k-v,h:w,color:R})}I+=w,F<h-m&&(W=I),F++}let S=0;const H=Math.min(D,C)-W;if(H>0)for(let x=0;x<t.length;x++){const w=t[x];if(w.width===0)continue;const V=w.sticky?S:S+o,R=(P=w.themeOverride)==null?void 0:P.bgCell;R!==void 0&&R!==u&&V>=v&&V<=k&&g(x+1)&&B.push({x:V,y:W,w:w.width,h:H,color:R}),S+=w.width}if(B.length===0)return;let E;e.beginPath();for(let x=B.length-1;x>=0;x--){const w=B[x];E===void 0?E=w.color:w.color!==E&&(e.fillStyle=E,e.fill(),e.beginPath(),E=w.color),e.rect(w.x,w.y,w.w,w.h)}E!==void 0&&(e.fillStyle=E,e.fill()),e.beginPath()}function Ro(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u,v,k=!1,p){if(l!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,a);for(const x of l)e.rect(x.x+1,x.y+1,x.width-1,x.height-1);e.clip("evenodd")}const C=v.horizontalBorderColor??v.borderColor,B=v.borderColor,{minX:D,maxX:I,minY:F,maxY:W}=bi(s,r,a),S=[];e.beginPath();let H=.5;for(let x=0;x<t.length;x++){const w=t[x];if(w.width===0)continue;H+=w.width;const V=w.sticky?H:H+o;if(V>=D&&V<=I&&h(x+1))if(p){let R=f+.5,$=n;const Q=a-Pt(u,d,g);for(;R+i<Q&&$<u;){const U=R+i,j=g($);if(U>=F&&U<=W-1){const ge=p([w.sourceIndex,$]),_=x<t.length-1?p([t[x+1].sourceIndex,$]):void 0;(ge==null?void 0:ge.borderRight)!==!1&&(_==null?void 0:_.borderLeft)!==!1&&S.push({x1:V,y1:U,x2:V,y2:U+j,color:B})}R+=j,$++}let G=a+.5;for(let U=u-d;U<u;U++){const j=g(U);G-=j;const ge=p([w.sourceIndex,U]),_=x<t.length-1?p([t[x+1].sourceIndex,U]):void 0;(ge==null?void 0:ge.borderRight)!==!1&&(_==null?void 0:_.borderLeft)!==!1&&S.push({x1:V,y1:G,x2:V,y2:G+j,color:B})}}else S.push({x1:V,y1:Math.max(c,F),x2:V,y2:Math.min(a,W),color:B})}let E=a+.5;for(let x=u-d;x<u;x++){const w=g(x);E-=w,S.push({x1:D,y1:E,x2:I,y2:E,color:C})}if(k!==!0){let x=f+.5,w=n;const V=E;for(;x+i<V;){const R=x+i;if(w>=5&&console.log(`Render bounds check: row=${w}, ty=${R}, minY=${F}, maxY=${W}, target=${V}, inBounds=${R>=F&&R<=W-1}`),R>=F&&R<=W-1){const $=m==null?void 0:m(w),Q=($==null?void 0:$.horizontalBorderColor)??($==null?void 0:$.borderColor)??C;if(p){let G=.5;for(let U=0;U<t.length;U++){const j=t[U];if(j.width===0)continue;const ge=j.sticky?G:G+o,_=ge+j.width;if(_>=D&&ge<=I&&w>=0){const ce=w-n,be=ce>=0&&ce<u?p([j.sourceIndex,ce]):void 0,N=ce+1>=0&&ce+1<u?p([j.sourceIndex,ce+1]):void 0;let se;if(j.sourceIndex===2||j.sourceIndex===3?se=(be==null?void 0:be.borderBottom)===!0:se=(be==null?void 0:be.borderBottom)!==!1&&(N==null?void 0:N.borderTop)!==!1,se)if(j.sourceIndex===2||j.sourceIndex===3){const ne=g(ce>=0?ce:0),De=R+ne;S.push({x1:Math.max(ge,D),y1:De,x2:Math.min(_,I),y2:De,color:Q})}else S.push({x1:Math.max(ge,D),y1:R,x2:Math.min(_,I),y2:R,color:Q})}G+=j.width}}else S.push({x1:D,y1:R,x2:I,y2:R,color:Q})}x+=g(w),w++}}const P=Ki(S,x=>x.color);for(const x of Object.keys(P)){e.strokeStyle=x;for(const w of P[x])e.moveTo(w.x1,w.y1),e.lineTo(w.x2,w.y2);e.stroke(),e.beginPath()}l!==void 0&&e.restore()}function Or(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u,v,k,p){const C=[];e.imageSmoothingEnabled=!1;const B=Math.min(i.cellYOffset,a),D=Math.max(i.cellYOffset,a);let I=0;if(typeof k=="number")I+=(D-B)*k;else for(let w=B;w<D;w++)I+=k(w);a>i.cellYOffset&&(I=-I),I+=l-i.translateY;const F=Math.min(i.cellXOffset,r),W=Math.max(i.cellXOffset,r);let S=0;for(let w=F;w<W;w++)S+=u[w].width;r>i.cellXOffset&&(S=-S),S+=s-i.translateX;const H=Xt(v);if(S!==0&&I!==0)return{regions:[]};const E=c>0?Pt(m,c,k):0,P=f-H-Math.abs(S),x=g-h-E-Math.abs(I)-1;if(P>150&&x>150){const w={sx:0,sy:0,sw:f*d,sh:g*d,dx:0,dy:0,dw:f*d,dh:g*d};if(I>0?(w.sy=(h+1)*d,w.sh=x*d,w.dy=(I+h+1)*d,w.dh=x*d,C.push({x:0,y:h,width:f,height:I+1})):I<0&&(w.sy=(-I+h+1)*d,w.sh=x*d,w.dy=(h+1)*d,w.dh=x*d,C.push({x:0,y:g+I-E,width:f,height:-I+E})),S>0?(w.sx=H*d,w.sw=P*d,w.dx=(S+H)*d,w.dw=P*d,C.push({x:H-1,y:0,width:S+2,height:g})):S<0&&(w.sx=(H-S)*d,w.sw=P*d,w.dx=H*d,w.dw=P*d,C.push({x:f+S,y:0,width:-S,height:g})),e.setTransform(1,0,0,1,0,0),p){if(H>0&&S!==0&&I===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const V=H*d,R=g*d;e.drawImage(t,0,0,V,R,0,0,V,R)}if(E>0&&S===0&&I!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const V=(g-E)*d,R=f*d,$=E*d;e.drawImage(t,0,V,R,$,0,V,R,$)}}e.drawImage(t,w.sx,w.sy,w.sw,w.sh,w.dx,w.dy,w.dw,w.dh),e.scale(d,d)}return e.imageSmoothingEnabled=!0,{regions:C}}function Xr(e,t,n,o,i,r,a,s,l,c){const f=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||kt(l,n,o,i,s,(g,m,h,d)=>{if(g.sourceIndex===c){const u=Math.max(m,d)+1;return f.push({x:u,y:0,width:r-u,height:a}),!0}}),f}function $r(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(Ot(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:a,...s}=i,{width:l,...c}=r;if(!Ot(s,c))return!1;n=o}return n===void 0?!0:n}return!0}function To(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u){const v=d==null?void 0:d.filter(F=>F.style!=="no-outline");if(v===void 0||v.length===0)return;const k=Xt(s),p=Pt(h,m,g),C=[l,0,s.length,h-m],B=[k,0,t,n-p],D=v.map(F=>{const W=F.range,S=F.style??"dashed";return Dr(W,C,t,n,B).map(H=>{const E=H.rect,P=jn(E.x,E.y,t,n,f,c+f,o,i,r,a,h,l,m,s,g),x=E.width===1&&E.height===1?P:jn(E.x+E.width-1,E.y+E.height-1,t,n,f,c+f,o,i,r,a,h,l,m,s,g);return E.x+E.width>=s.length&&(x.width-=1),E.y+E.height>=h&&(x.height-=1),{color:F.color,style:S,clip:H.clip,rect:Pr({x:P.x,y:P.y,width:x.x+x.width-P.x,height:x.y+x.height-P.y},t,n,8)}})}),I=()=>{e.lineWidth=1;let F=!1;for(const W of D)for(const S of W)if((S==null?void 0:S.rect)!==void 0&&on(0,0,t,n,S.rect.x,S.rect.y,S.rect.width,S.rect.height)){const H=F,E=!Fr(S.clip,S.rect);e.beginPath(),E&&(e.save(),e.rect(S.clip.x,S.clip.y,S.clip.width,S.clip.height),e.clip()),S.style==="dashed"&&!F?(e.setLineDash([5,3]),F=!0):(S.style==="solid"||S.style==="solid-outline")&&F&&(e.setLineDash([]),F=!1),e.strokeStyle=S.style==="solid-outline"?Ge(Ge(S.color,u.borderColor),u.bgCell):sn(S.color,1),e.closePath(),e.strokeRect(S.rect.x+.5,S.rect.y+.5,S.rect.width-1,S.rect.height-1),E&&(e.restore(),F=H)}F&&e.setLineDash([])};return I(),I}function Wo(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function Nn(e,t,n,o,i,r,a,s,l,c,f,g,m,h,d,u,v){if(f.current===void 0)return;const k=u!==!1&&u!==void 0;if(!k)return;const p=typeof u=="object"?{...Sn,...u}:Sn,C=f.current.range,B=f.current.cell,D=[C.x+C.width-1,C.y+C.height-1];if(B[1]>=v&&D[1]>=v||!a.some(R=>R.sourceIndex===B[0]||R.sourceIndex===D[0]))return;const[F,W]=f.current.cell,S=m(f.current.cell),H=S.span??[F,F],E=W>=v-h,P=h>0&&!E?Pt(v,h,g)-1:0,x=D[1];let w;if(kt(a,o,i,r,c,(R,$,Q,G,U)=>{if(R.sticky&&F>R.sourceIndex)return;const j=R.sourceIndex<H[0],ge=R.sourceIndex>H[1],_=R.sourceIndex===D[0];if(!(!_&&(j||ge)))return In(U,Q,n,v,g,h,d,void 0,(ce,be,N)=>{if(be!==W&&be!==x)return;let se=$,ne=R.width;if(S.span!==void 0){const Be=di(S.span,$,ce,R.width,N,R,s),Ce=R.sticky?Be[0]:Be[1];Ce!==void 0&&(se=Ce.x,ne=Ce.width)}return be===x&&_&&k&&(w=()=>{var $e;G>se&&!R.sticky&&(e.beginPath(),e.rect(G,0,t-G,n),e.clip());const Be=p.size,Ce=Be/2,Je=se+ne+p.offsetX-Ce+.5,Ye=ce+N+p.offsetY-Ce+.5;e.beginPath(),p.shape==="circle"?e.arc(Je+Ce,Ye+Ce,Ce,0,Math.PI*2):e.rect(Je,Ye,Be,Be),e.fillStyle=(($e=R.themeOverride)==null?void 0:$e.accentColor)??l.accentColor,e.fill(),p.outline>0&&(e.lineWidth=p.outline,e.strokeStyle=l.bgCell,p.shape==="circle"?(e.beginPath(),e.arc(Je+Ce,Ye+Ce,Ce+p.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(Je-p.outline/2,Ye-p.outline/2,Be+p.outline,Be+p.outline))}),w!==void 0}),w!==void 0}),w===void 0)return;const V=()=>{e.save(),e.beginPath(),e.rect(0,c,t,n-c-P),e.clip(),w==null||w(),e.restore()};return V(),V}function Yr(e,t,n,o,i,r,a,s,l){l===void 0||l.size===0||(e.beginPath(),ci(t,n,r,o,(c,f,g,m,h,d)=>{l.hasItemInRectangle({x:c[0],y:-2,width:c[1]-c[0]+1,height:1})&&e.rect(g,m,h,d)}),kt(t,s,r,a,i,(c,f,g,m)=>{const h=Math.max(0,m-f),d=f+h+1,u=c.width-h-1;l.has([c.sourceIndex,-1])&&e.rect(d,o,u,i-o)}),e.clip())}function _r(e,t,n,o,i,r,a,s,l,c){let f=0;return kt(e,r,o,i,n,(g,m,h,d,u)=>(In(u,h,t,a,s,l,c,void 0,(v,k,p,C)=>{C||(f=Math.max(k,f))}),!0)),f}function zo(e,t){var lt;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:a,cellYOffset:s,translateX:l,translateY:c,mappedColumns:f,enableGroups:g,freezeColumns:m,dragAndDropState:h,theme:d,drawFocus:u,headerHeight:v,groupHeaderHeight:k,disabledRows:p,rowHeight:C,verticalBorder:B,overrideCursor:D,isResizing:I,selection:F,fillHandle:W,freezeTrailingRows:S,rows:H,getCellContent:E,getGroupDetails:P,getRowThemeOverride:x,isFocused:w,drawHeaderCallback:V,prelightCells:R,drawCellCallback:$,highlightRegions:Q,resizeCol:G,imageLoader:U,lastBlitData:j,hoverValues:ge,hyperWrapping:_,hoverInfo:ce,spriteManager:be,maxScaleFactor:N,hasAppendRow:se,touchMode:ne,enqueue:De,renderStateProvider:Be,getCellRenderer:Ce,renderStrategy:Je,bufferACtx:Ye,bufferBCtx:$e,damage:ye,minimumCellWidth:ht,resizeIndicator:gt}=e;if(i===0||r===0)return;const qe=Je==="double-buffer",de=Math.min(N,Math.ceil(window.devicePixelRatio??1)),Ue=Je!=="direct"&&$r(e,t),Ae=n.canvas;(Ae.width!==i*de||Ae.height!==r*de)&&(Ae.width=i*de,Ae.height=r*de,Ae.style.width=i+"px",Ae.style.height=r+"px");const Oe=o.canvas,te=g?k+v:v,Me=te+1;(Oe.width!==i*de||Oe.height!==Me*de)&&(Oe.width=i*de,Oe.height=Me*de,Oe.style.width=i+"px",Oe.style.height=Me+"px");const ae=Ye.canvas,pe=$e.canvas;qe&&(ae.width!==i*de||ae.height!==r*de)&&(ae.width=i*de,ae.height=r*de,j.current!==void 0&&(j.current.aBufferScroll=void 0)),qe&&(pe.width!==i*de||pe.height!==r*de)&&(pe.width=i*de,pe.height=r*de,j.current!==void 0&&(j.current.bBufferScroll=void 0));const O=j.current;if(Ue===!0&&a===(O==null?void 0:O.cellXOffset)&&s===(O==null?void 0:O.cellYOffset)&&l===(O==null?void 0:O.translateX)&&c===(O==null?void 0:O.translateY))return;let q=null;qe&&(q=n);const ue=o;let oe;qe?ye!==void 0?oe=(O==null?void 0:O.lastBuffer)==="b"?$e:Ye:oe=(O==null?void 0:O.lastBuffer)==="b"?Ye:$e:oe=n;const re=oe.canvas,Fe=qe?re===ae?pe:ae:Ae,fe=typeof C=="number"?()=>C:C;ue.save(),oe.save(),ue.beginPath(),oe.beginPath(),ue.textBaseline="middle",oe.textBaseline="middle",de!==1&&(ue.scale(de,de),oe.scale(de,de));const J=Un(f,a,i,h,l);let We=[];const Ze=u&&((lt=F.current)==null?void 0:lt.cell[1])===s&&c===0;let je=!1;if(Q!==void 0){for(const Se of Q)if(Se.style!=="no-outline"&&Se.range.y===s&&c===0){je=!0;break}}const He=()=>{Rr(ue,J,g,ce,i,l,v,k,h,I,F,d,be,ge,B,P,ye,V,ne),Ro(ue,J,s,l,c,i,r,void 0,void 0,k,te,fe,x,B,S,H,d,!0,E),ue.beginPath(),ue.moveTo(0,Me-.5),ue.lineTo(i,Me-.5),ue.strokeStyle=Ge(d.headerBottomBorderColor??d.horizontalBorderColor??d.borderColor,d.bgHeader),ue.stroke(),je&&To(ue,i,r,a,s,l,c,f,m,v,k,C,S,H,Q,d),Ze&&Nn(ue,i,r,s,l,c,J,f,d,te,F,fe,E,S,se,W,H)};if(ye!==void 0){const Se=J[J.length-1].sourceIndex+1,_e=ye.hasItemInRegion([{x:a,y:-2,width:Se,height:2},{x:a,y:s,width:Se,height:300},{x:0,y:s,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:a,y:H-S,width:Se,height:S,when:S>0}]),St=tt=>{Ao(tt,J,f,r,te,l,c,s,H,fe,E,P,x,p,w,u,S,se,We,ye,F,R,Q,U,be,ge,ce,$,_,d,De,Be,Ce,D,ht);const nt=F.current;W!==!1&&W!==void 0&&u&&nt!==void 0&&ye.has(ei(nt.range))&&Nn(tt,i,r,s,l,c,J,f,d,te,F,fe,E,S,se,W,H)};_e&&(St(oe),q!==null&&(q.save(),q.scale(de,de),q.textBaseline="middle",St(q),q.restore()),ye.hasHeader()&&(Yr(ue,J,i,k,te,l,c,s,ye),He())),oe.restore(),ue.restore();return}if((Ue!==!0||a!==(O==null?void 0:O.cellXOffset)||l!==(O==null?void 0:O.translateX)||Ze!==(O==null?void 0:O.mustDrawFocusOnHeader)||je!==(O==null?void 0:O.mustDrawHighlightRingsOnHeader))&&He(),Ue===!0){dt(Fe!==void 0&&O!==void 0);const{regions:Se}=Or(oe,Fe,Fe===ae?O.aBufferScroll:O.bBufferScroll,Fe===ae?O.bBufferScroll:O.aBufferScroll,O,a,s,l,c,S,i,r,H,te,de,f,J,C,qe);We=Se}else Ue!==!1&&(dt(O!==void 0),We=Xr(O,a,s,l,c,i,r,te,J,Ue));Lr(oe,J,i,r,S,H,B,fe,d);const Qe=To(oe,i,r,a,s,l,c,f,m,v,k,C,S,H,Q,d),Xe=u?Nn(oe,i,r,s,l,c,J,f,d,te,F,fe,E,S,se,W,H):void 0;if(oe.fillStyle=d.bgCell,We.length>0){oe.beginPath();for(const Se of We)oe.rect(Se.x,Se.y,Se.width,Se.height);oe.clip(),oe.fill(),oe.beginPath()}else oe.fillRect(0,0,i,r);const Dt=Ao(oe,J,f,r,te,l,c,s,H,fe,E,P,x,p,w,u,S,se,We,ye,F,R,Q,U,be,ge,ce,$,_,d,De,Be,Ce,D,ht);zr(oe,J,f,i,r,te,l,c,s,H,fe,x,F.rows,p,S,se,We,ye,d),Nr(oe,J,s,l,c,i,r,We,te,fe,x,B,S,H,d),Ro(oe,J,s,l,c,i,r,We,Dt,k,te,fe,x,B,S,H,d,!1,E),Qe==null||Qe(),Xe==null||Xe(),I&&gt!=="none"&&kt(J,0,l,0,te,(Se,_e)=>Se.sourceIndex===G?(Wo(ue,_e+Se.width,0,te+1,Ge(d.resizeIndicatorColor??d.accentLight,d.bgHeader)),gt==="full"&&Wo(oe,_e+Se.width,te,r,Ge(d.resizeIndicatorColor??d.accentLight,d.bgCell)),!0):!1),q!==null&&(q.fillStyle=d.bgCell,q.fillRect(0,0,i,r),q.drawImage(oe.canvas,0,0));const At=_r(J,r,te,l,c,s,H,fe,S,se);U==null||U.setWindow({x:a,y:s,width:J.length,height:At-s},m,Array.from({length:S},(Se,_e)=>H-1-_e));const xe=O!==void 0&&(a!==O.cellXOffset||l!==O.translateX),xt=O!==void 0&&(s!==O.cellYOffset||c!==O.translateY);j.current={cellXOffset:a,cellYOffset:s,translateX:l,translateY:c,mustDrawFocusOnHeader:Ze,mustDrawHighlightRingsOnHeader:je,lastBuffer:qe?re===ae?"a":"b":void 0,aBufferScroll:re===ae?[xe,xt]:O==null?void 0:O.aBufferScroll,bBufferScroll:re===pe?[xe,xt]:O==null?void 0:O.bBufferScroll},oe.restore(),ue.restore()}const Vr=80;function qr(e){const t=e-1;return t*t*t+1}class Ur{constructor(t){ee(this,"currentHoveredItem");ee(this,"leavingItems",[]);ee(this,"lastAnimationTime");ee(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>pn(o.item,t.item))||this.leavingItems.push(t)});ee(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>pn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});ee(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});ee(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});ee(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:qr(t.hoverAmount)})));ee(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Vr;for(const r of this.leavingItems)r.hoverAmount=kn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=kn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});ee(this,"setHovered",t=>{var n;if(!pn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class jr{constructor(t){ee(this,"fn");ee(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function so(e){return new jr(e)}const Kr=so(()=>window.navigator.userAgent.includes("Firefox")),Lo=so(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),ha=so(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Gr(e){const t=b.useRef([]),n=b.useRef(0),o=b.useRef(e);o.current=e;const i=b.useCallback(()=>{const r=()=>window.requestAnimationFrame(a),a=()=>{const s=t.current.map(io);t.current=[],o.current(new en(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:a)},[]);return b.useCallback(r=>{t.current.length===0&&i();const a=et(r[0],r[1]);t.current.includes(a)||t.current.push(a)},[i])}const Ft="header",Jt="group-header",No="out-of-bounds";var Qt=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(Qt||{});function Jr(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Qr=(e,t)=>{if(e.kind===le.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Zr=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:a,cellYOffset:s,headerHeight:l,fillHandle:c=!1,groupHeaderHeight:f,rowHeight:g,rows:m,getCellContent:h,getRowThemeOverride:d,onHeaderMenuClick:u,onHeaderIndicatorClick:v,enableGroups:k,isFilling:p,onCanvasFocused:C,onCanvasBlur:B,isFocused:D,selection:I,freezeColumns:F,onContextMenu:W,freezeTrailingRows:S,fixedShadowX:H=!0,fixedShadowY:E=!0,drawFocusRing:P,onMouseDown:x,onMouseUp:w,onMouseMoveRaw:V,onMouseMove:R,onItemHovered:$,dragAndDropState:Q,firstColAccessible:G,onKeyDown:U,onKeyUp:j,highlightRegions:ge,canvasRef:_,onDragStart:ce,onDragEnd:be,eventTargetRef:N,isResizing:se,resizeColumn:ne,isDragging:De,isDraggable:Be=!1,allowResize:Ce,disabledRows:Je,hasAppendRow:Ye,getGroupDetails:$e,theme:ye,prelightCells:ht,headerIcons:gt,verticalBorder:qe,drawCell:de,drawHeader:Ue,onCellFocused:Ae,onDragOverCell:Oe,onDrop:te,onDragLeave:Me,imageWindowLoader:ae,smoothScrollX:pe=!1,smoothScrollY:O=!1,experimental:q,getCellRenderer:ue,resizeIndicator:oe="full"}=e,re=e.translateX??0,Fe=e.translateY??0,fe=Math.max(F,Math.min(r.length-1,a)),J=b.useRef(null),We=b.useRef((q==null?void 0:q.eventTarget)??window),Ze=We.current,je=ae,He=b.useRef(),[Qe,Xe]=b.useState(!1),Dt=b.useRef([]),At=b.useRef(),[xe,xt]=b.useState(),[lt,Se]=b.useState(),_e=b.useRef(null),[St,tt]=b.useState(),[nt,ie]=b.useState(!1),Re=b.useRef(nt);Re.current=nt;const Ie=b.useMemo(()=>new Mr(gt,()=>{ln.current=void 0,_t.current()}),[gt]),ot=k?f+l:l,Ke=b.useRef(-1),mt=((q==null?void 0:q.enableFirefoxRescaling)??!1)&&Kr.value,Mn=((q==null?void 0:q.enableSafariRescaling)??!1)&&Lo.value;b.useLayoutEffect(()=>{window.devicePixelRatio===1||!mt&&!Mn||(Ke.current!==-1&&Xe(!0),window.clearTimeout(Ke.current),Ke.current=window.setTimeout(()=>{Xe(!1),Ke.current=-1},200))},[s,fe,re,Fe,mt,Mn]);const Ee=dr(r,F),En=b.useMemo(()=>H?Xt(Ee,Q):0,[Ee,Q,H]),ze=b.useCallback((y,M,z)=>{const L=y.getBoundingClientRect();if(M>=Ee.length||z>=m)return;const A=L.width/n,T=jn(M,z,n,o,f,ot,fe,s,re,Fe,m,F,S,Ee,g);return A!==1&&(T.x*=A,T.y*=A,T.width*=A,T.height*=A),T.x+=L.x,T.y+=L.y,T},[n,o,f,ot,fe,s,re,Fe,m,F,S,Ee,g]),Le=b.useCallback((y,M,z,L)=>{const A=y.getBoundingClientRect(),T=A.width/n,K=(M-A.left)/T,Z=(z-A.top)/T,X=5,Ne=Un(Ee,fe,n,void 0,re);let Y=0,he=0;const we=typeof PointerEvent<"u"&&L instanceof PointerEvent&&L.pointerType==="mouse"||typeof MouseEvent<"u"&&L instanceof MouseEvent,ve=typeof PointerEvent<"u"&&L instanceof PointerEvent&&L.pointerType==="touch"||typeof TouchEvent<"u"&&L instanceof TouchEvent;we&&(Y=L.button,he=L.buttons);const ke=gr(K,Ne,re),Pe=mr(Z,o,k,l,f,m,g,s,Fe,S),Te=(L==null?void 0:L.shiftKey)===!0,ct=(L==null?void 0:L.ctrlKey)===!0,bt=(L==null?void 0:L.metaKey)===!0,it=[K<0?-1:n<K?1:0,Z<ot?-1:o<Z?1:0];let yt;if(ke===-1||Z<0||K<0||Pe===void 0||K>n||Z>o){const me=K>n?1:K<0?-1:0,vt=Z>o?1:Z<0?-1:0;let rt=me*2,Tn=vt*2;me===0&&(rt=ke===-1?Qt.EndPadding:Qt.Center),vt===0&&(Tn=Pe===void 0?Qt.EndPadding:Qt.Center);let zt=!1;if(ke===-1&&Pe===-1){const Lt=ze(y,Ee.length-1,-1);dt(Lt!==void 0),zt=M<Lt.x+Lt.width+X}const qt=K>n&&K<n+Mo()||Z>o&&Z<o+Mo();yt={kind:No,location:[ke!==-1?ke:K<0?0:Ee.length-1,Pe??m-1],region:[rt,Tn],shiftKey:Te,ctrlKey:ct,metaKey:bt,isEdge:zt,isTouch:ve,button:Y,buttons:he,scrollEdge:it,isMaybeScrollbar:qt}}else if(Pe<=-1){let me=ze(y,ke,Pe);dt(me!==void 0);let vt=me!==void 0&&me.x+me.width-M<=X;const rt=ke-1;M-me.x<=X&&rt>=0?(vt=!0,me=ze(y,rt,Pe),dt(me!==void 0),yt={kind:k&&Pe===-2?Jt:Ft,location:[rt,Pe],bounds:me,group:Ee[rt].group??"",isEdge:vt,shiftKey:Te,ctrlKey:ct,metaKey:bt,isTouch:ve,localEventX:M-me.x,localEventY:z-me.y,button:Y,buttons:he,scrollEdge:it}):yt={kind:k&&Pe===-2?Jt:Ft,group:Ee[ke].group??"",location:[ke,Pe],bounds:me,isEdge:vt,shiftKey:Te,ctrlKey:ct,metaKey:bt,isTouch:ve,localEventX:M-me.x,localEventY:z-me.y,button:Y,buttons:he,scrollEdge:it}}else{const me=ze(y,ke,Pe);dt(me!==void 0);const vt=me!==void 0&&me.x+me.width-M<X;let rt=!1;if(c!==!1&&c!==void 0&&I.current!==void 0){const zt=typeof c=="object"?{...Sn,...c}:Sn,qt=zt.size,Lt=qt/2,xo=ei(I.current.range),Ut=ze(y,xo[0],xo[1]);if(Ut!==void 0){const Xi=Ut.x+Ut.width+zt.offsetX-Lt+.5,$i=Ut.y+Ut.height+zt.offsetY-Lt+.5;rt=Math.abs(Xi-M)<qt&&Math.abs($i-z)<qt}}yt={kind:"cell",location:[ke,Pe],bounds:me,isEdge:vt,shiftKey:Te,ctrlKey:ct,isFillHandle:rt,metaKey:bt,isTouch:ve,localEventX:M-me.x,localEventY:z-me.y,button:Y,buttons:he,scrollEdge:it}}return yt},[n,Ee,fe,re,o,k,l,f,m,g,s,Fe,S,ze,c,I,ot]),[It]=xe??[],ao=b.useRef(()=>{}),Ht=b.useRef(xe);Ht.current=xe;const[Ct,Mt]=b.useMemo(()=>{const y=document.createElement("canvas"),M=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",M.style.display="none",M.style.opacity="0",M.style.position="fixed",[y.getContext("2d",{alpha:!1}),M.getContext("2d",{alpha:!1})]},[]);b.useLayoutEffect(()=>{if(!(Ct===null||Mt===null))return document.documentElement.append(Ct.canvas),document.documentElement.append(Mt.canvas),()=>{Ct.canvas.remove(),Mt.canvas.remove()}},[Ct,Mt]);const an=b.useMemo(()=>new Ir,[]),lo=mt&&Qe?1:Mn&&Qe?2:5,co=(q==null?void 0:q.disableMinimumCellWidth)===!0?1:10,ln=b.useRef(),cn=b.useRef(null),dn=b.useRef(null),un=b.useCallback(()=>{var K;const y=J.current,M=_e.current;if(y===null||M===null||(cn.current===null&&(cn.current=y.getContext("2d",{alpha:!1}),y.width=0,y.height=0),dn.current===null&&(dn.current=M.getContext("2d",{alpha:!1}),M.width=0,M.height=0),cn.current===null||dn.current===null||Ct===null||Mt===null))return;let z=!1;const L=Z=>{z=!0,tt(Z)},A=ln.current,T={headerCanvasCtx:dn.current,canvasCtx:cn.current,bufferACtx:Ct,bufferBCtx:Mt,width:n,height:o,cellXOffset:fe,cellYOffset:s,translateX:Math.round(re),translateY:Math.round(Fe),mappedColumns:Ee,enableGroups:k,freezeColumns:F,dragAndDropState:Q,theme:ye,headerHeight:l,groupHeaderHeight:f,disabledRows:Je??Vn.empty(),rowHeight:g,verticalBorder:qe,isResizing:se,resizeCol:ne,isFocused:D,selection:I,fillHandle:c,drawCellCallback:de,hasAppendRow:Ye,overrideCursor:L,maxScaleFactor:lo,freezeTrailingRows:S,rows:m,drawFocus:P,getCellContent:h,getGroupDetails:$e??(Z=>({name:Z})),getRowThemeOverride:d,drawHeaderCallback:Ue,prelightCells:ht,highlightRegions:ge,imageLoader:je,lastBlitData:At,damage:He.current,hoverValues:Dt.current,hoverInfo:Ht.current,spriteManager:Ie,scrolling:Qe,hyperWrapping:(q==null?void 0:q.hyperWrapping)??!1,touchMode:nt,enqueue:ao.current,renderStateProvider:an,renderStrategy:(q==null?void 0:q.renderStrategy)??(Lo.value?"double-buffer":"single-buffer"),getCellRenderer:ue,minimumCellWidth:co,resizeIndicator:oe};T.damage===void 0?(ln.current=T,zo(T,A)):zo(T,void 0),!z&&(T.damage===void 0||T.damage.has((K=Ht==null?void 0:Ht.current)==null?void 0:K[0]))&&tt(void 0)},[Ct,Mt,n,o,fe,s,re,Fe,Ee,k,F,Q,ye,l,f,Je,g,qe,se,Ye,ne,D,I,c,S,m,P,lo,h,$e,d,de,Ue,ht,ge,je,Ie,Qe,q==null?void 0:q.hyperWrapping,q==null?void 0:q.renderStrategy,nt,an,ue,co,oe]),_t=b.useRef(un);b.useLayoutEffect(()=>{un(),_t.current=un},[un]),b.useLayoutEffect(()=>{(async()=>{var M;((M=document==null?void 0:document.fonts)==null?void 0:M.ready)!==void 0&&(await document.fonts.ready,ln.current=void 0,_t.current())})()},[]);const Rt=b.useCallback(y=>{He.current=y,_t.current(),He.current=void 0},[]),pi=Gr(Rt);ao.current=pi;const uo=b.useCallback(y=>{Rt(new en(y.map(M=>M.cell)))},[Rt]);je.setCallback(Rt);const[wi,ki]=b.useState(!1),[Et,Tt]=It??[],xi=Et!==void 0&&Tt===-1&&Et>=0&&Et<Ee.length&&Ee[Et].headerRowMarkerDisabled!==!0,Si=Et!==void 0&&Tt===-2;let fo=!1,ho=!1,fn=St;if(fn===void 0&&Et!==void 0&&Tt!==void 0&&Tt>-1&&Tt<m){const y=h([Et,Tt],!0);fo=y.kind===nn.NewRow||y.kind===nn.Marker&&y.markerKind!=="number",ho=y.kind===le.Boolean&&Zn(y),fn=y.cursor}const go=De?"grabbing":(lt??!1)||se?"col-resize":wi||p?"crosshair":fn!==void 0?fn:xi||fo||ho||Si?"pointer":"default",Bn=b.useMemo(()=>({contain:"strict",display:"block",cursor:go}),[go]),mo=b.useRef("default"),Fn=N==null?void 0:N.current;Fn!=null&&mo.current!==Bn.cursor&&(Fn.style.cursor=mo.current=Bn.cursor);const hn=b.useCallback((y,M,z,L)=>{if($e===void 0)return;const A=$e(y);if(A.actions!==void 0){const T=hi(M,A.actions);for(const[K,Z]of T.entries())if(Nt(Z,z+M.x,L+Z.y))return A.actions[K]}},[$e]),Wt=b.useCallback((y,M,z,L)=>{const A=Ee[M];if(!De&&!se&&!(lt??!1)){const T=ze(y,M,-1);dt(T!==void 0);const K=gi(void 0,A,T.x,T.y,T.width,T.height,ye,to(A.title)==="rtl");if(A.hasMenu===!0&&K.menuBounds!==void 0&&Nt(K.menuBounds,z,L))return{area:"menu",bounds:K.menuBounds};if(A.indicatorIcon!==void 0&&K.indicatorIconBounds!==void 0&&Nt(K.indicatorIconBounds,z,L))return{area:"indicator",bounds:K.indicatorIconBounds}}},[Ee,ze,lt,De,se,ye]),Pn=b.useRef(0),Vt=b.useRef(),Dn=b.useRef(!1),Ii=b.useCallback(y=>{const M=J.current,z=N==null?void 0:N.current;if(M===null||y.target!==M&&y.target!==z)return;Dn.current=!0;const L=y.clientX,A=y.clientY;if(y.target===z&&z!==null){const K=z.getBoundingClientRect();if(L>K.right||A>K.bottom)return}const T=Le(M,L,A,y);Vt.current=T.location,T.isTouch&&(Pn.current=Date.now()),Re.current!==T.isTouch&&ie(T.isTouch),!(T.kind===Ft&&Wt(M,T.location[0],L,A)!==void 0)&&(T.kind===Jt&&hn(T.group,T.bounds,T.localEventX,T.localEventY)!==void 0||(x==null||x(T),!T.isTouch&&Be!==!0&&Be!==T.kind&&T.button<3&&T.button!==1&&y.preventDefault()))},[N,Be,Le,hn,Wt,x]);st("pointerdown",Ii,Ze,!1);const bo=b.useRef(0),Ci=b.useCallback(y=>{var he,we;const M=bo.current;bo.current=Date.now();const z=J.current;if(Dn.current=!1,w===void 0||z===null)return;const L=N==null?void 0:N.current,A=y.target!==z&&y.target!==L,T=y.clientX,K=y.clientY,Z=y.pointerType==="mouse"?y.button<3:!0;let X=Le(z,T,K,y);X.isTouch&&Pn.current!==0&&Date.now()-Pn.current>500&&(X={...X,isLongTouch:!0}),M!==0&&Date.now()-M<(X.isTouch?1e3:500)&&(X={...X,isDoubleClick:!0}),Re.current!==X.isTouch&&ie(X.isTouch),!A&&y.cancelable&&Z&&y.preventDefault();const[Ne]=X.location,Y=Wt(z,Ne,T,K);if(X.kind===Ft&&Y!==void 0){(X.button!==0||((he=Vt.current)==null?void 0:he[0])!==Ne||((we=Vt.current)==null?void 0:we[1])!==-1)&&w(X,!0);return}else if(X.kind===Jt){const ve=hn(X.group,X.bounds,X.localEventX,X.localEventY);if(ve!==void 0){X.button===0&&ve.onClick(X);return}}w(X,A)},[w,N,Le,Wt,hn]);st("pointerup",Ci,Ze,!1);const Mi=b.useCallback(y=>{var Ne,Y;const M=J.current;if(M===null)return;const z=N==null?void 0:N.current,L=y.target!==M&&y.target!==z;let A,T,K=!0;y instanceof MouseEvent?(A=y.clientX,T=y.clientY,K=y.button<3):(A=y.changedTouches[0].clientX,T=y.changedTouches[0].clientY);const Z=Le(M,A,T,y);Re.current!==Z.isTouch&&ie(Z.isTouch),!L&&y.cancelable&&K&&y.preventDefault();const[X]=Z.location;if(Z.kind===Ft){const he=Wt(M,X,A,T);he!==void 0&&Z.button===0&&((Ne=Vt.current)==null?void 0:Ne[0])===X&&((Y=Vt.current)==null?void 0:Y[1])===-1&&(he.area==="menu"?u==null||u(X,he.bounds):he.area==="indicator"&&(v==null||v(X,he.bounds)))}},[N,Le,Wt,u,v]);st("click",Mi,Ze,!1);const Ei=b.useCallback(y=>{const M=J.current,z=N==null?void 0:N.current;if(M===null||y.target!==M&&y.target!==z||W===void 0)return;const L=Le(M,y.clientX,y.clientY,y);W(L,()=>{y.cancelable&&y.preventDefault()})},[N,Le,W]);st("contextmenu",Ei,(N==null?void 0:N.current)??null,!1);const yo=b.useCallback(y=>{He.current=new en(y.map(M=>M.item)),Dt.current=y,_t.current(),He.current=void 0},[]),vo=b.useMemo(()=>new Ur(yo),[yo]),po=b.useRef(vo);po.current=vo,b.useLayoutEffect(()=>{const y=po.current;if(It===void 0||It[1]<0){y.setHovered(It);return}const M=h(It,!0),z=ue(M),L=z===void 0&&M.kind===le.Custom||(z==null?void 0:z.needsHover)!==void 0&&(typeof z.needsHover=="boolean"?z.needsHover:z.needsHover(M));y.setHovered(L?It:void 0)},[h,ue,It]);const wo=b.useRef(),Bi=b.useCallback(y=>{var Z;const M=J.current;if(M===null)return;const z=N==null?void 0:N.current,L=y.target!==M&&y.target!==z,A=Le(M,y.clientX,y.clientY,y);if(A.kind!=="out-of-bounds"&&L&&!Dn.current&&!A.isTouch)return;const T=(X,Ne)=>{xt(Y=>Y===X||(Y==null?void 0:Y[0][0])===(X==null?void 0:X[0][0])&&(Y==null?void 0:Y[0][1])===(X==null?void 0:X[0][1])&&((Y==null?void 0:Y[1][0])===(X==null?void 0:X[1][0])&&(Y==null?void 0:Y[1][1])===(X==null?void 0:X[1][1])||!Ne)?Y:X)};if(!Jr(A,wo.current))tt(void 0),$==null||$(A),T(A.kind===No?void 0:[A.location,[A.localEventX,A.localEventY]],!0),wo.current=A;else if(A.kind==="cell"||A.kind===Ft||A.kind===Jt){let X=!1,Ne=!0;if(A.kind==="cell"){const he=h(A.location);Ne=((Z=ue(he))==null?void 0:Z.needsHoverPosition)??he.kind===le.Custom,X=Ne}else X=!0;const Y=[A.location,[A.localEventX,A.localEventY]];T(Y,Ne),Ht.current=Y,X&&Rt(new en([A.location]))}const K=A.location[0]>=(G?0:1);Se(A.kind===Ft&&A.isEdge&&K&&Ce===!0),ki(A.kind==="cell"&&A.isFillHandle),V==null||V(y),R(A)},[N,Le,G,Ce,V,R,$,h,ue,Rt]);st("pointermove",Bi,Ze,!0);const Fi=b.useCallback(y=>{const M=J.current;if(M===null)return;let z,L;I.current!==void 0&&(z=ze(M,I.current.cell[0],I.current.cell[1]),L=I.current.cell),U==null||U({bounds:z,stopPropagation:()=>y.stopPropagation(),preventDefault:()=>y.preventDefault(),cancel:()=>{},ctrlKey:y.ctrlKey,metaKey:y.metaKey,shiftKey:y.shiftKey,altKey:y.altKey,key:y.key,keyCode:y.keyCode,rawEvent:y,location:L})},[U,I,ze]),Pi=b.useCallback(y=>{const M=J.current;if(M===null)return;let z,L;I.current!==void 0&&(z=ze(M,I.current.cell[0],I.current.cell[1]),L=I.current.cell),j==null||j({bounds:z,stopPropagation:()=>y.stopPropagation(),preventDefault:()=>y.preventDefault(),cancel:()=>{},ctrlKey:y.ctrlKey,metaKey:y.metaKey,shiftKey:y.shiftKey,altKey:y.altKey,key:y.key,keyCode:y.keyCode,rawEvent:y,location:L})},[j,I,ze]),Di=b.useCallback(y=>{if(J.current=y,_!==void 0&&(_.current=y),q!=null&&q.eventTarget)We.current=q.eventTarget;else if(y===null)We.current=window;else{const M=y.getRootNode();M===document&&(We.current=window),We.current=M}},[_,q==null?void 0:q.eventTarget]),Ai=b.useCallback(y=>{const M=J.current;if(M===null||Be===!1||se){y.preventDefault();return}let z,L;const A=Le(M,y.clientX,y.clientY);if(Be!==!0&&A.kind!==Be){y.preventDefault();return}const T=(he,we)=>{z=he,L=we};let K,Z,X;const Ne=(he,we,ve)=>{K=he,Z=we,X=ve};let Y=!1;if(ce==null||ce({...A,setData:T,setDragImage:Ne,preventDefault:()=>Y=!0,defaultPrevented:()=>Y}),!Y&&z!==void 0&&L!==void 0&&y.dataTransfer!==null)if(y.dataTransfer.setData(z,L),y.dataTransfer.effectAllowed="copyLink",K!==void 0&&Z!==void 0&&X!==void 0)y.dataTransfer.setDragImage(K,Z,X);else{const[he,we]=A.location;if(we!==void 0){const ve=document.createElement("canvas"),ke=ze(M,he,we);dt(ke!==void 0);const Pe=Math.ceil(window.devicePixelRatio??1);ve.width=ke.width*Pe,ve.height=ke.height*Pe;const Te=ve.getContext("2d");Te!==null&&(Te.scale(Pe,Pe),Te.textBaseline="middle",we===-1?(Te.font=ye.headerFontFull,Te.fillStyle=ye.bgHeader,Te.fillRect(0,0,ve.width,ve.height),mi(Te,0,0,ke.width,ke.height,Ee[he],!1,ye,!1,void 0,void 0,!1,0,Ie,Ue,!1)):(Te.font=ye.baseFontFull,Te.fillStyle=ye.bgCell,Te.fillRect(0,0,ve.width,ve.height),fi(Te,h([he,we]),0,we,!1,!1,0,0,ke.width,ke.height,!1,ye,ye.bgCell,je,Ie,1,void 0,!1,0,void 0,void 0,void 0,an,ue,()=>{}))),ve.style.left="-100%",ve.style.position="absolute",ve.style.width=`${ke.width}px`,ve.style.height=`${ke.height}px`,document.body.append(ve),y.dataTransfer.setDragImage(ve,ke.width/2,ke.height/2),window.setTimeout(()=>{ve.remove()},0)}}else y.preventDefault()},[Be,se,Le,ce,ze,ye,Ee,Ie,Ue,h,je,an,ue]);st("dragstart",Ai,(N==null?void 0:N.current)??null,!1,!1);const An=b.useRef(),Hi=b.useCallback(y=>{const M=J.current;if(te!==void 0&&y.preventDefault(),M===null||Oe===void 0)return;const z=Le(M,y.clientX,y.clientY),[L,A]=z.location,T=L-(G?0:1),[K,Z]=An.current??[];(K!==T||Z!==A)&&(An.current=[T,A],Oe([T,A],y.dataTransfer))},[G,Le,Oe,te]);st("dragover",Hi,(N==null?void 0:N.current)??null,!1,!1);const Ri=b.useCallback(()=>{An.current=void 0,be==null||be()},[be]);st("dragend",Ri,(N==null?void 0:N.current)??null,!1,!1);const Ti=b.useCallback(y=>{const M=J.current;if(M===null||te===void 0)return;y.preventDefault();const z=Le(M,y.clientX,y.clientY),[L,A]=z.location,T=L-(G?0:1);te([T,A],y.dataTransfer)},[G,Le,te]);st("drop",Ti,(N==null?void 0:N.current)??null,!1,!1);const Wi=b.useCallback(()=>{Me==null||Me()},[Me]);st("dragleave",Wi,(N==null?void 0:N.current)??null,!1,!1);const ko=b.useRef(I);ko.current=I;const gn=b.useRef(null),Hn=b.useCallback(y=>{var M;J.current===null||!J.current.contains(document.activeElement)||(y===null&&ko.current.current!==void 0?(M=_==null?void 0:_.current)==null||M.focus({preventScroll:!0}):y!==null&&y.focus({preventScroll:!0}),gn.current=y)},[_]);b.useImperativeHandle(t,()=>({focus:()=>{var M;const y=gn.current;y===null||!document.contains(y)?(M=_==null?void 0:_.current)==null||M.focus({preventScroll:!0}):y.focus({preventScroll:!0})},getBounds:(y,M)=>{if(!(_===void 0||_.current===null))return ze(_.current,y??0,M??-1)},damage:uo,getMouseArgsForPosition:(y,M,z)=>{if(!(_===void 0||_.current===null))return Le(_.current,y,M,z)}}),[_,uo,ze,Le]);const Rn=b.useRef(),zi=sr(()=>{var Z,X,Ne;if(n<50||(q==null?void 0:q.disableAccessibilityTree)===!0)return null;let y=Un(Ee,fe,n,Q,re);const M=G?0:-1;!G&&((Z=y[0])==null?void 0:Z.sourceIndex)===0&&(y=y.slice(1));const[z,L]=((X=I.current)==null?void 0:X.cell)??[],A=(Ne=I.current)==null?void 0:Ne.range,T=y.map(Y=>Y.sourceIndex),K=Gi(s,Math.min(m,s+i));return z!==void 0&&L!==void 0&&!(T.includes(z)&&K.includes(L))&&Hn(null),b.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":Ee.length+M},b.createElement("thead",{role:"rowgroup"},b.createElement("tr",{role:"row","aria-rowindex":1},y.map(Y=>b.createElement("th",{role:"columnheader","aria-selected":I.columns.hasIndex(Y.sourceIndex),"aria-colindex":Y.sourceIndex+1+M,tabIndex:-1,onFocus:he=>{if(he.target!==gn.current)return Ae==null?void 0:Ae([Y.sourceIndex,-1])},key:Y.sourceIndex},Y.title)))),b.createElement("tbody",{role:"rowgroup"},K.map(Y=>b.createElement("tr",{role:"row","aria-selected":I.rows.hasIndex(Y),key:Y,"aria-rowindex":Y+2},y.map(he=>{const we=he.sourceIndex,ve=et(we,Y),ke=z===we&&L===Y,Pe=A!==void 0&&we>=A.x&&we<A.x+A.width&&Y>=A.y&&Y<A.y+A.height,Te=`glide-cell-${we}-${Y}`,ct=[we,Y],bt=h(ct,!0);return b.createElement("td",{key:ve,role:"gridcell","aria-colindex":we+1+M,"aria-selected":Pe,"aria-readonly":jo(bt)||!or(bt),id:Te,"data-testid":Te,onClick:()=>{const it=_==null?void 0:_.current;if(it!=null)return U==null?void 0:U({bounds:ze(it,we,Y),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:ct})},onFocusCapture:it=>{var yt,me;if(!(it.target===gn.current||((yt=Rn.current)==null?void 0:yt[0])===we&&((me=Rn.current)==null?void 0:me[1])===Y))return Rn.current=ct,Ae==null?void 0:Ae(ct)},ref:ke?Hn:void 0,tabIndex:-1},Qr(bt,ue))})))))},[n,Ee,fe,Q,re,m,s,i,I,Hn,h,_,U,ze,Ae],200),mn=F===0||!H?0:fe>F?1:kn(-re/100,0,1),Li=-s*32+Fe,bn=E?kn(-Li/100,0,1):0,Ni=b.useMemo(()=>{if(!mn&&!bn)return null;const y={position:"absolute",top:0,left:En,width:n-En,height:o,opacity:mn,pointerEvents:"none",transition:pe?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},M={position:"absolute",top:ot,left:0,width:n,height:o,opacity:bn,pointerEvents:"none",transition:O?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return b.createElement(b.Fragment,null,mn>0&&b.createElement("div",{id:"shadow-x",style:y}),bn>0&&b.createElement("div",{id:"shadow-y",style:M}))},[mn,bn,En,n,pe,ot,o,O]),Oi=b.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return b.createElement(b.Fragment,null,b.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Fi,onKeyUp:Pi,onFocus:C,onBlur:B,ref:Di,style:Bn},zi),b.createElement("canvas",{ref:_e,style:Oi}),Ni)},ga=b.memo(b.forwardRef(Zr));function es(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case le.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Qn?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case le.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case le.Image:case le.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case le.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case le.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case le.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case le.Markdown:case le.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case le.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case le.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case le.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Jn()}}function ts(e,t){return e.map((o,i)=>{const r=t[i];return o.map(a=>a.span!==void 0&&a.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:es(a))})}function Oo(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function ns(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(a=>Oo(a,!0)).join(",")):i.push(r.doNotEscape===!0?r.formatted:Oo(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function On(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Xo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function os(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function is(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${On(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((a,s)=>`<li gdg-raw-value=${Xo(i.rawValue[s])}>`+On(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Xo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${On(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function rs(e,t){const n=ts(e,t),o=ns(n),i=is(n);return{textPlain:o,textHtml:i}}function ma(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const l=s.cloneNode(!0),f=l.children.length===1&&l.children[0].nodeName==="P"?l.children[0]:null,g=(f==null?void 0:f.children.length)===1&&f.children[0].nodeName==="FONT",m=l.querySelectorAll("br");for(const u of m)u.replaceWith(`
`);const h=l.getAttribute("gdg-raw-value"),d=l.getAttribute("gdg-format")??"string";if(l.querySelector("a")!==null)r==null||r.push({rawValue:((a=l.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:l.textContent??"",format:d});else if(l.querySelector("ol")!==null){const u=l.querySelectorAll("li");r==null||r.push({rawValue:[...u].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...u].map(v=>v.textContent??""),format:"string-array"})}else if(h!==null)r==null||r.push({rawValue:os(h),formatted:l.textContent??"",format:d});else{let u=l.textContent??"";g&&(u=u.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:u??"",formatted:u??"",format:d})}}}return r!==void 0&&i.push(r),i}function ba(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const l=(s=e.current)==null?void 0:s.range,c=[];if(l.width>2){const m=t({x:l.x,y:l.y,width:1,height:l.height},i.signal);if(typeof m=="function")return r;c.push(...m);const h=t({x:l.x+l.width-1,y:l.y,width:1,height:l.height},i.signal);if(typeof h=="function")return r;c.push(...h)}else{const m=t({x:l.x,y:l.y,width:l.width,height:l.height},i.signal);if(typeof m=="function")return r;c.push(...m)}let f=l.x-n,g=l.x+l.width-1-n;for(const m of c)for(const h of m)h.span!==void 0&&(f=Math.min(h.span[0],f),g=Math.max(h.span[1],g));f===l.x-n&&g===l.x+l.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:f+n,y:l.y,width:g-f+1,height:l.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function $o(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function ya(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let a=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,a)),i=a+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push($o(e.slice(i,a))),i=a+1,s===`
`&&(n.push(o),o=[])),r=0);break}a++}return i<e.length&&o.push($o(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(l=>({rawValue:l,formatted:l,format:"string"})))}function va(e,t,n){var s;const o=rs(e,t),i=l=>{var c;(c=window.navigator.clipboard)==null||c.writeText(l)},r=(l,c)=>{var f;return((f=window.navigator.clipboard)==null?void 0:f.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([l],{type:"text/plain"}),"text/html":new Blob([c],{type:"text/html"})})]),!0)},a=(l,c)=>{var f,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(f=n==null?void 0:n.clipboardData)==null||f.setData("text/plain",l),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",c)}catch{r(l,c)||i(l)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function ss(e){return e!==!0}function Yo(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:a,height:s,x:l,y:c}=i,f=t.maxSize??r.checkboxMaxSize,g=Math.floor(i.y+s/2),m=Jo(f,s,r.cellVerticalPadding),h=Go(t.contentAlign??"center",l,a,r.cellHorizontalPadding,m),d=Ko(h,g,m),u=Qo(l+n,c+o,d);return Zn(t)&&u}const as={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:le.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>ls(e,e.cell.data,Zn(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Yo(e)&&e.preventDefault()},onClick:e=>{if(Yo(e))return{...e.cell,data:ss(e.cell.data)}},onPaste:(e,t)=>{let n=xn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Qn),n===t.data?void 0:{...t,data:n}}};function ls(e,t,n,o,i){if(!n&&t===xn)return;const{ctx:r,hoverAmount:a,theme:s,rect:l,highlighted:c,hoverX:f,hoverY:g,cell:{contentAlign:m}}=e,{x:h,y:d,width:u,height:v}=l;let k=!1;if(i>0){let p=n?1-i+i*a:.4;if(t===xn&&(p*=a),p===0)return;p<1&&(k=!0,r.globalAlpha=p)}ro(r,s,t,h,d,u,v,c,f,g,o,m),k&&(r.globalAlpha=1)}const cs=ft("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),ds=e=>{const{bubbles:t}=e;return b.createElement(cs,null,t.map((n,o)=>b.createElement("div",{key:o,className:"boe-bubble"},n)),b.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},us={getAccessibilityString:e=>Zo(e.data),kind:le.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((i,r)=>e.measureText(r).width+i+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>fs(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return b.createElement(ds,{bubbles:t.data})},onPaste:()=>{}};function fs(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:a,y:s,width:l,height:c}=n;let f=a+o.cellHorizontalPadding;const g=[];for(const m of t){if(f>a+l)break;const h=Yt(m,i,o.baseFontFull).width;g.push({x:f,width:h}),f+=h+o.bubblePadding*2+o.bubbleMargin}i.beginPath();for(const m of g)at(i,m.x,s+(c-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[m,h]of g.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[m],h.x+o.bubblePadding,s+c/2+wt(i,o))}const hs=ft("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),gs=e=>{const{drilldowns:t}=e;return b.createElement(hs,null,t.map((n,o)=>b.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&b.createElement("img",{src:n.img}),b.createElement("div",null,n.text))))},ms={getAccessibilityString:e=>Zo(e.data.map(t=>t.text)),kind:le.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+n.bubblePadding*2+n.bubbleMargin+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>ys(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return b.createElement(gs,{drilldowns:t.data})},onPaste:()=>{}},Xn={};function bs(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,a=n-r*2,s=4,l=n*i,c=o+r,f=o*3,g=(f+r*2)*i,m=`${e},${t},${i},${n}`;if(Xn[m]!==void 0)return{el:Xn[m],height:l,width:g,middleWidth:s*i,sideWidth:c*i,padding:r*i,dpr:i};const h=document.createElement("canvas"),d=h.getContext("2d");return d===null?null:(h.width=g,h.height=l,d.scale(i,i),Xn[m]=h,d.beginPath(),at(d,r,r,f,a,o),d.shadowColor="rgba(24, 25, 34, 0.4)",d.shadowBlur=1,d.fillStyle=e,d.fill(),d.shadowColor="rgba(24, 25, 34, 0.3)",d.shadowOffsetY=1,d.shadowBlur=5,d.fillStyle=e,d.fill(),d.shadowOffsetY=0,d.shadowBlur=0,d.shadowBlur=0,d.beginPath(),at(d,r+.5,r+.5,f,a,o),d.strokeStyle=t,d.lineWidth=1,d.stroke(),{el:h,height:l,width:g,sideWidth:c*i,middleWidth:o*i,padding:r*i,dpr:i})}function ys(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:a,row:s}=e,{x:l,width:c}=n,f=o.baseFontFull,g=ri(i,f),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),h=Math.floor(n.y+(n.height-m)/2),d=m-10,u=o.bubblePadding,v=o.bubbleMargin;let k=l+o.cellHorizontalPadding;const p=o.roundingRadius??6,C=bs(o.bgCell,o.drilldownBorder,m,p),B=[];for(const D of t){if(k>l+c)break;const F=Yt(D.text,i,f).width;let W=0;D.img!==void 0&&r.loadOrGetImage(D.img,a,s)!==void 0&&(W=d-8+4);const S=F+W+u*2;B.push({x:k,width:S}),k+=S+v}if(C!==null){const{el:D,height:I,middleWidth:F,sideWidth:W,width:S,dpr:H,padding:E}=C,P=W/H,x=E/H;for(const w of B){const V=Math.floor(w.x),R=Math.floor(w.width),$=R-(P-x)*2;i.imageSmoothingEnabled=!1,i.drawImage(D,0,0,W,I,V-x,h,P,m),$>0&&i.drawImage(D,W,0,F,I,V+(P-x),h,$,m),i.drawImage(D,S-W,0,W,I,V+R-(P-x),h,P,m),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[D,I]of B.entries()){const F=t[D];let W=I.x+u;if(F.img!==void 0){const S=r.loadOrGetImage(F.img,a,s);if(S!==void 0){const H=d-8;let E=0,P=0,x=S.width,w=S.height;x>w?(E+=(x-w)/2,x=w):w>x&&(P+=(w-x)/2,w=x),i.beginPath(),at(i,W,h+m/2-H/2,H,H,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(S,E,P,x,w,W,h+m/2-H/2,H,H),i.restore(),W+=H+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(F.text,W,h+m/2+wt(i,o))}}const vs=ft("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),ps=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const a=r.length>1;return b.createElement(vs,{"data-testid":"GDG-default-image-overlay-editor"},b.createElement(Ji.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},r.map(s=>{const l=(i==null?void 0:i(s))??b.createElement("img",{draggable:!1,src:s});return b.createElement("div",{className:"gdg-centering-container",key:s},l)})),n&&o&&b.createElement("button",{className:"gdg-edit-icon",onClick:o},b.createElement(eo,null)))},ws={getAccessibilityString:e=>e.data.join(", "),kind:le.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>ks(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??ps;return b.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},$n=4;function ks(e,t,n,o){const{rect:i,col:r,row:a,theme:s,ctx:l,imageLoader:c}=e,{x:f,y:g,height:m,width:h}=i,d=m-s.cellVerticalPadding*2,u=[];let v=0;for(let p=0;p<t.length;p++){const C=t[p];if(C.length===0)continue;const B=c.loadOrGetImage(C,r,a);if(B!==void 0){u[p]=B;const D=B.width*(d/B.height);v+=D+$n}}if(v===0)return;v-=$n;let k=f+s.cellHorizontalPadding;o==="right"?k=Math.floor(f+h-s.cellHorizontalPadding-v):o==="center"&&(k=Math.floor(f+h/2-v/2));for(const p of u){if(p===void 0)continue;const C=p.width*(d/p.height);n>0&&(l.beginPath(),at(l,k,g+s.cellVerticalPadding,C,d,n),l.save(),l.clip()),l.drawImage(p,k,g+s.cellVerticalPadding,C,d),n>0&&l.restore(),k+=C+$n}}function xs(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Ss={getAccessibilityString:()=>"",kind:le.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(xs(n,o)*t.skeletonWidthVariability));const l=a.cellHorizontalPadding;s+l*2>=r.width&&(s=r.width-l*2-1);const c=t.skeletonHeight??Math.min(18,r.height-2*a.cellVerticalPadding);at(i,r.x+l,r.y+(r.height-c)/2,s,c,a.roundingRadius??3),i.fillStyle=sn(a.textDark,.1),i.fill()},onPaste:()=>{}},Is=ft("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Cs extends tn.PureComponent{constructor(){super(...arguments);ee(this,"targetElement",null);ee(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,a=Zi(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let l=r==null?void 0:r(a);if(l===void 0){const f=document.createElement("template");f.innerHTML=a,l=f.content}n.append(l);const c=n.getElementsByTagName("a");for(const f of c)f.target="_blank",f.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),tn.createElement(Is,{ref:this.containerRefHook})}}const Ms=ft("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Es=ft("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Bs=ft("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let _o=0;const Cn=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:a,...s}=e,{onChange:l,className:c}=s,f=b.useRef(null),g=n??"";dt(l!==void 0,"GrowingEntry must be a controlled input area");const[m]=b.useState(()=>"input-box-"+(_o=(_o+1)%1e7));b.useEffect(()=>{const d=f.current;if(d===null||d.disabled)return;const u=g.toString().length;d.focus(),d.setSelectionRange(i?0:u,u)},[]),b.useLayoutEffect(()=>{var d;if(a!==void 0){const u=typeof a=="number"?[a,null]:a;(d=f.current)==null||d.setSelectionRange(u[0],u[1])}},[a]);const h=b.useCallback(d=>{d.key==="Enter"&&d.shiftKey&&r===!0||o==null||o(d)},[r,o]);return b.createElement(Bs,{className:"gdg-growing-entry"},b.createElement(Es,{className:c},g+`
`),b.createElement(Ms,{...s,className:(c??"")+" gdg-input",id:m,ref:f,onKeyDown:h,value:g,placeholder:t,dir:"auto"}))},Fs=()=>e=>e.targetWidth,Vo=ft("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Fs(),"px"]}}),Ps=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:a,validatedSelection:s}=e,l=t.data,c=t.readonly===!0,[f,g]=b.useState(l===""||o),m=b.useCallback(()=>{g(d=>!d)},[]),h=l?"gdg-ml-6":"";return f?b.createElement(Vo,{targetWidth:r.width-20},b.createElement(Cn,{autoFocus:!0,highlight:!1,validatedSelection:s,value:l,onKeyDown:d=>{d.key==="Enter"&&d.stopPropagation()},onChange:n}),b.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${h}`,onClick:()=>a(t)},b.createElement(rr,null))):b.createElement(Vo,{targetWidth:r.width},b.createElement(Cs,{contents:l,createNode:i}),!c&&b.createElement(b.Fragment,null,b.createElement("div",{className:"spacer"}),b.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${h}`,onClick:m},b.createElement(eo,null))),b.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Ds={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:rn,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>ut(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:a,validatedSelection:s}=e;return b.createElement(Ps,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:l=>t({...n,data:l.target.value}),forceEditMode:a,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},As={getAccessibilityString:e=>e.row.toString(),kind:nn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Hs,measure:()=>44,draw:e=>Ts(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e,{width:r,height:a}=t,s=n.drawHandle?7+(r-7)/2:r/2,l=a/2;if(Math.abs(o-s)<=10&&Math.abs(i-l)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Hs(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=Rs,n.textAlign="center",r}function Rs(e){const{ctx:t}=e;t.textAlign="start"}function Ts(e,t,n,o,i,r){const{ctx:a,rect:s,hoverAmount:l,theme:c}=e,{x:f,y:g,width:m,height:h}=s,d=n?1:o==="checkbox-visible"?.6+.4*l:l;if(o!=="number"&&d>0){a.globalAlpha=d;const u=7*(n?l:1);if(ro(a,c,n,i?f+u:f,g,i?m-u:m,h,!0,void 0,void 0,c.checkboxMaxSize,"center",r),i){a.globalAlpha=l,a.beginPath();for(const v of[3,6])for(const k of[-5,-1,3])a.rect(f+v,g+h/2+k,2,2);a.fillStyle=c.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const u=t.toString(),v=c.markerFontFull,k=f+m/2;o==="both"&&l!==0&&(a.globalAlpha=1-l),a.fillStyle=c.textLight,a.font=v,a.fillText(u,k,g+h/2+wt(a,v)),l!==0&&(a.globalAlpha=1)}}const Ws={getAccessibilityString:()=>"",kind:nn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>zs(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function zs(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:a,spriteManager:s}=e,{x:l,y:c,width:f,height:g}=i;o.beginPath(),o.globalAlpha=r,o.rect(l+1,c+1,f,g-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let h=0;if(n!==void 0){const u=g-8,v=l+8/2,k=c+8/2;s.drawSprite(n,"normal",o,v,k,u,a,m?1:r),h=u}else{h=24;const d=12,u=m?d:r*d,v=m?0:(1-r)*d*.5,k=a.cellHorizontalPadding+4;u>0&&(o.moveTo(l+k+v,c+g/2),o.lineTo(l+k+v+u,c+g/2),o.moveTo(l+k+v+u*.5,c+g/2-u*.5),o.lineTo(l+k+v+u*.5,c+g/2+u*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,h+l+a.cellHorizontalPadding+.5,c+g/2+wt(o,a)),o.beginPath()}function yi(e,t,n,o,i,r,a){e.textBaseline="alphabetic";const s=Ls(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),at(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??sn(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function Ls(e,t,n,o,i){const r=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+a/2+1,width:t.width-r,height:t.height-a-1};const s=Yt(n,e,o.baseFontFull,"alphabetic"),l=t.height-a,c=Math.min(l,s.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-c)/2+1,width:s.width+r*3,height:c-1}}const Ns=b.lazy(async()=>await er(()=>import("./number-overlay-editor-By72j_Tx.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),Os={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:rn,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:a}=e,{hoverEffect:s,displayData:l,hoverEffectTheme:c}=n;s===!0&&t>0&&yi(o,i,c,l,r,t,a),ut(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return b.createElement(b.Suspense,{fallback:null},b.createElement(Ns,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:i,onChange:r=>n({...o,data:Number.isNaN(r.floatValue??0)?0:r.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Xs={getAccessibilityString:()=>"",measure:()=>108,kind:le.Protected,needsHover:!1,needsHoverPosition:!1,draw:$s,onPaste:()=>{}};function $s(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:a}=o;t.beginPath();const s=2.5;let l=i+n.cellHorizontalPadding+s;const c=r+a/2,f=Math.cos(Co(30))*s,g=Math.sin(Co(30))*s;for(let m=0;m<12;m++)t.moveTo(l,c-s),t.lineTo(l,c+s),t.moveTo(l+f,c-g),t.lineTo(l-f,c+g),t.moveTo(l-f,c-g),t.lineTo(l+f,c+g),l+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Ys={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>rn(e,t,e.theme.textLight),draw:e=>ut(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return tn.createElement(Cn,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:i,onChange:r=>n({...o,data:r.target.value})})},onPaste:()=>{}},_s={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:rn,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:a,overrideCursor:s}=e,{displayData:l,contentAlign:c,hoverEffect:f,allowWrapping:g,hoverEffectTheme:m}=t;f===!0&&n>0&&yi(i,a,m,l,r,n,s),ut(e,l,c,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return b.createElement(Cn,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:a=>o({...i,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Vs=ft("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),qs=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:a}=e,[s,l]=b.useState(!i&&(t===""||o)),c=b.useCallback(()=>{l(!0)},[]);return s?b.createElement(Cn,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):b.createElement(Vs,null,b.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!i&&b.createElement("div",{className:"gdg-edit-icon",onClick:c},b.createElement(eo,null)),b.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function vi(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-a-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-a/2),{x:i,y:r,width:a,height:s}}function qo(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=oi(a,r.baseFontFull);if(s===void 0)return!1;const l=vi(s,n,r,t.contentAlign);return Nt({x:l.x-4,y:l.y-4,width:l.width+8,height:l.height+8},o,i)}const Us={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:le.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:rn,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:a,ctx:s}=e,l=t.displayData??t.data,c=t.hoverEffect===!0;if(o!==void 0&&c&&i!==void 0&&r!==void 0){const f=Yt(l,s,n.baseFontFull),g=vi(f,a,n,t.contentAlign),{x:m,y:h,width:d,height:u}=g;if(i>=m-4&&i<=m-4+d+8&&r>=h-4&&r<=h-4+u+8){const v=wt(s,n.baseFontFull);o("pointer");const k=5,p=h-v;s.beginPath(),s.moveTo(a.x+m,Math.floor(a.y+p+u+k)+.5),s.lineTo(a.x+m+d,Math.floor(a.y+p+u+k)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,ut({...e,rect:{...a,x:a.x-1}},l,t.contentAlign),ut({...e,rect:{...a,x:a.x-2}},l,t.contentAlign),ut({...e,rect:{...a,x:a.x+1}},l,t.contentAlign),ut({...e,rect:{...a,x:a.x+2}},l,t.contentAlign),s.restore()}}s.fillStyle=c?n.linkColor:n.textDark,ut(e,l,t.contentAlign)},onSelect:e=>{qo(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;qo(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return b.createElement(qs,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},pa=[As,Ws,as,us,ms,ws,Ss,Ds,Os,Xs,Ys,_s,Us],Yn=[];class wa extends ai{constructor(){super(...arguments);ee(this,"imageLoaded",()=>{});ee(this,"loadedLocations",[]);ee(this,"cache",{});ee(this,"sendLoaded",Qi(()=>{this.imageLoaded(new en(this.loadedLocations)),this.loadedLocations=[]},20));ee(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let a=0;a<i.cells.length;a++){const s=i.cells[a];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let a=!1;const s=Yn.pop()??new Image;let l=!1;const c={img:void 0,cells:[et(o,i)],url:n,cancel:()=>{l||(l=!0,Yn.length<12?Yn.unshift(s):a||(s.src=""))}},f=new Promise(g=>s.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{s.src=n,await f,await s.decode();const g=this.cache[r];if(g!==void 0&&!l){g.img=s;for(const m of g.cells)this.loadedLocations.push(io(m));a=!0,this.sendLoaded()}}catch{c.cancel()}}),this.cache[r]=c}loadOrGetImage(n,o,i){const r=n,a=this.cache[r];if(a!==void 0){const s=et(o,i);return a.cells.includes(s)||a.cells.push(s),a.img}else this.loadImage(n,o,i,r)}}export{Jr as A,fa as B,Vn as C,Jn as D,nr as E,ia as F,le as G,la as H,nn as I,ma as J,ya as K,Mo as L,ca as M,va as N,pa as O,wa as P,ga as Q,Lo as R,Kr as S,ua as T,oa as U,As as V,tr as a,dt as b,ha as c,aa as d,sa as e,ba as f,da as g,sn as h,ta as i,ea as j,Pt as k,Jt as l,$t as m,qn as n,No as o,Nt as p,fr as q,na as r,jo as s,ss as t,st as u,or as v,ra as w,Br as x,pn as y,Ft as z};
