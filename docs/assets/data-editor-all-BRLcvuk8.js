const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-B2Uwr3VQ.js","./iframe-C1adrrhA.js","./preload-helper-C1FmrZbK.js","./marked.esm-BsrRDEkT.js","./react-number-format.es-BWfAeLKy.js","./index-BXP72RLD.js","./throttle-BbvBCwfb.js","./flatten-B9xqSffn.js"])))=>i.map(i=>d[i]);
import{r as c,R as Xn}from"./iframe-C1adrrhA.js";import{_ as ou}from"./preload-helper-C1FmrZbK.js";import{r as iu}from"./index-BXP72RLD.js";import{h as Ns,g as lu,j as Gs,k as $s,v as Xs,l as Ks,m as vn,r as po,t as Ys}from"./throttle-BbvBCwfb.js";import{u as Vs,f as Ar}from"./flatten-B9xqSffn.js";import{s as _t,a as Us}from"./marked.esm-BsrRDEkT.js";function ru(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"This should not happen";throw new Error(e)}function ln(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Assertion failed";if(!e)return ru(t)}function hi(e,t){return ru(t??"Hell froze over")}function js(e,t){try{return e()}catch{return t}}const Br=Object.prototype.hasOwnProperty;function Yo(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Yo(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Br.call(e,n)&&++o&&!Br.call(t,n)||!(n in t)||!Yo(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}var Vo;const ji=null,Ul=void 0;var te;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(te||(te={}));var Ir;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(Ir||(Ir={}));var qi;(function(e){e.Triangle="triangle",e.Dots="dots"})(qi||(qi={}));function $i(e){return"width"in e&&typeof e.width=="number"}async function Hr(e){return typeof e=="object"?e:await e()}function Kn(e){return!(e.kind===te.Loading||e.kind===te.Bubble||e.kind===te.RowID||e.kind===te.Protected||e.kind===te.Drilldown)}function uf(e){return!(e.kind===te.Loading||e.kind===te.Bubble||e.kind===te.RowID||e.kind===te.Protected||e.kind===te.Drilldown||e.kind===te.Boolean||e.kind===te.Image||e.kind===te.Custom)}function Co(e){return e.kind===Nt.Marker||e.kind===Nt.NewRow||e.kind===Nt.RowStatus}function so(e){if(!Kn(e)||e.kind===te.Image)return!1;switch(e.kind){case te.Text:case te.Number:case te.Markdown:case te.Uri:case te.Custom:case te.Boolean:return e.readonly!==!0;default:hi(e,"A cell was passed with an invalid kind")}}function uu(e){return Ns(e,"editor")}function jl(e){var t;return!((t=e.readonly)!==null&&t!==void 0&&t)}var Nt;(function(e){e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id"})(Nt||(Nt={}));const _i={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function ql(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Xi;class Je{constructor(t){this.items=void 0,this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Je(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=ql([...this.items,n]);return new Je(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[l,u]of n.entries()){const[r,s]=u;if(r<=i&&o<=s){const a=[];r<o&&a.push([r,o]),i<s&&a.push([i,s]),n.splice(l,1,...a)}}return new Je(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}}Vo=Je;Je.create=e=>new Vo(ql(e));Je.empty=()=>Xi??(Xi=new Vo([]));Je.fromSingleSelection=e=>Vo.empty().add(e);Je.fromArray=e=>{if(e.length===0)return Vo.empty();const t=e.map(o=>[o,o+1]),n=ql(t);return new Vo(n)};const qs=_t("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function qt(e,t,n,o){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const l=c.useRef();l.current=t,c.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const u=n,r=s=>{var a;(a=l.current)===null||a===void 0||a.call(u,s)};return u.addEventListener(e,r,{passive:o,capture:i}),()=>{u.removeEventListener(e,r,{capture:i})}},[e,n,o,i])}function lo(e,t){return e===void 0?void 0:t}const _s=Math.PI;function Tr(e){return e*_s/180}const su=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),du=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},au=(e,t,n)=>Math.min(e,t-n*2),cu=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,_l=e=>{var t;const n=(t=e.fgColor)!==null&&t!==void 0?t:"currentColor";return c.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:n,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),c.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:n,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Zs=e=>{var t;const n=(t=e.fgColor)!==null&&t!==void 0?t:"currentColor";return c.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:n,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Js(e,t,n){const[o,i]=c.useState(e),l=c.useRef(!0);c.useEffect(()=>()=>{l.current=!1},[]);const u=c.useRef(lu(r=>{l.current&&i(r)},n));return c.useLayoutEffect(()=>{l.current&&u.current(()=>e())},t),o}const Qs="֑-߿יִ-﷽ﹰ-ﻼ",ed="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",td=new RegExp("^[^"+ed+"]*["+Qs+"]");function Zl(e){return td.test(e)?"rtl":"not-rtl"}let Ki;function Nl(){if(typeof document>"u")return 0;if(Ki!==void 0)return Ki;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Ki=n-o,Ki}const wo=Symbol();function nd(e){const t=c.useRef([wo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=c.useState(e),[,i]=c.useState(),l=c.useCallback(r=>{const s=t.current[0];s!==wo&&(r=typeof r=="function"?r(s):r,r===s)||(s!==wo&&i({}),o(a=>typeof r=="function"?r(s===wo?a:s):r),t.current[0]=wo)},[]),u=c.useCallback(()=>{t.current[0]=wo,i({})},[]);return[t.current[0]===wo?n:t.current[0],l,u]}function fu(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function od(e){const t=c.useRef(e);return Yo(e,t.current)||(t.current=e),t.current}const id=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,l=t.filter(r=>r!=="");if(l.length===0)return null;const u=l.length>1;return c.createElement(qs,{"data-testid":"GDG-default-image-overlay-editor"},c.createElement(Gs.Carousel,{showArrows:u,showThumbs:!1,swipeable:u,emulateTouch:u,infiniteLoop:u},l.map(r=>{var s;const a=(s=i==null?void 0:i(r))!==null&&s!==void 0?s:c.createElement("img",{draggable:!1,src:r});return c.createElement("div",{className:"gdg-centering-container",key:r},a)})),n&&o&&c.createElement("button",{className:"gdg-edit-icon",onClick:o},c.createElement(_l,null)))},ld=_t("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class rd extends Xn.PureComponent{constructor(){super(...arguments),this.targetElement=null,this.containerRefHook=t=>{this.targetElement=t,this.renderMarkdownIntoDiv()}}renderMarkdownIntoDiv(){const{targetElement:t,props:n}=this;if(t===null)return;const{contents:o,createNode:i}=n,l=Us(o),u=document.createRange();u.selectNodeContents(t),u.deleteContents();let r=i==null?void 0:i(l);if(r===void 0){const a=document.createElement("template");a.innerHTML=l,r=a.content}t.append(r);const s=t.getElementsByTagName("a");for(const a of s)a.target="_blank",a.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Xn.createElement(ld,{ref:this.containerRefHook})}}const ud=_t("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),sd=_t("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),dd=_t("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});class hu extends c.PureComponent{constructor(){super(...arguments),this.wrapperRef=c.createRef(),this.clickOutside=t=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(t))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(t.target)){let n=t.target;for(;n!==null;){if(n.classList.contains("click-outside-ignore"))return;n=n.parentElement}this.props.onClickOutside()}}}componentDidMount(){var t;const n=(t=this.props.customEventTarget)!==null&&t!==void 0?t:document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){var t;const n=(t=this.props.customEventTarget)!==null&&t!==void 0?t:document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:t,isOutsideClick:n,customEventTarget:o,...i}=this.props;return c.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const Il={};let no=null;function ad(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Uo(e){const t=e.toLowerCase().trim();if(Il[t]!==void 0)return Il[t];no=no||ad(),no.style.color="#000",no.style.color=t;const n=getComputedStyle(no).color;no.style.color="#fff",no.style.color=t;const o=getComputedStyle(no).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(l=>Number.isNaN(l)?0:l),Il[t]=i,i}function ao(e,t){const[n,o,i]=Uo(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const zr=new Map;function Pr(e,t){const n=`${e}-${t}`,o=zr.get(n);if(o!==void 0)return o;const i=rn(e,t);return zr.set(n,i),i}function rn(e,t){if(t===void 0)return e;const[n,o,i,l]=Uo(e);if(l===1)return e;const[u,r,s,a]=Uo(t),d=l+a*(1-l),h=(l*n+a*u*(1-l))/d,g=(l*o+a*r*(1-l))/d,m=(l*i+a*s*(1-l))/d;return`rgba(${h}, ${g}, ${m}, ${d})`}function sf(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,i,l,u]=Uo(e),[r,s,a,d]=Uo(t),h=o*u,g=i*u,m=l*u,f=r*d,v=s*d,C=a*d,p=n,w=1-n,b=u*w+d*p;if(b===0)return"rgba(0, 0, 0, 0)";const x=Math.floor((h*w+f*p)/b),E=Math.floor((g*w+v*p)/b),H=Math.floor((m*w+C*p)/b);return`rgba(${x}, ${E}, ${H}, ${b})`}function df(e){if(e==="transparent")return 0;function t(l){const u=l/255;return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}const[n,o,i]=Uo(e);return .2126*t(n)+.7152*t(o)+.0722*t(i)}function gu(e){var t,n,o,i;return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":(t=e.textGroupHeader)!==null&&t!==void 0?t:e.textHeader,"--gdg-bg-group-header":(n=e.bgGroupHeader)!==null&&n!==void 0?n:e.bgHeader,"--gdg-bg-group-header-hovered":(o=e.bgGroupHeaderHovered)!==null&&o!==void 0?o:e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":(i=e.horizontalBorderColor)!==null&&i!==void 0?i:e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const vu={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function mu(){return vu}const Jl=Xn.createContext(vu);function af(){return Xn.useContext(Jl)}function An(e){const t={...e};for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];for(const l of o)if(l!==void 0)for(const u in l)l.hasOwnProperty(u)&&(u==="bgCell"?t[u]=rn(l[u],t[u]):t[u]=l[u]);return(t.headerFontFull===void 0||e.fontFamily!==t.fontFamily||e.headerFontStyle!==t.headerFontStyle)&&(t.headerFontFull=`${t.headerFontStyle} ${t.fontFamily}`),(t.baseFontFull===void 0||e.fontFamily!==t.fontFamily||e.baseFontStyle!==t.baseFontStyle)&&(t.baseFontFull=`${t.baseFontStyle} ${t.fontFamily}`),(t.markerFontFull===void 0||e.fontFamily!==t.fontFamily||e.markerFontStyle!==t.markerFontStyle)&&(t.markerFontFull=`${t.markerFontStyle} ${t.fontFamily}`),t}const cd=()=>e=>e.targetX,fd=()=>e=>e.targetY,hd=()=>e=>e.targetWidth,gd=()=>e=>e.targetHeight,vd=()=>e=>e.targetY+10,md=()=>e=>Math.max(0,(e.targetHeight-28)/2),wd=_t("div")({name:"DataGridOverlayEditorStyle",class:"gdg-d19meir1",propsAsIs:!1,vars:{"d19meir1-0":[fd(),"px"],"d19meir1-1":[cd(),"px"],"d19meir1-2":[hd(),"px"],"d19meir1-3":[gd(),"px"],"d19meir1-4":[vd(),"px"],"d19meir1-5":[md(),"px"]}});var wu={exports:{}},pu={};/**
 * @license React
 * react-compiler-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pd=c.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;pu.c=function(e){return pd.H.useMemoCache(e)};wu.exports=pu;var sn=wu.exports;function Cd(){const e=sn.c(2),[t,n]=c.useState(),o=t??void 0;let i;return e[0]!==o?(i=[o,n],e[0]=o,e[1]=i):i=e[1],i}function yd(){const e=sn.c(12),[t,n]=Cd(),[o,i]=c.useState(0),[l,u]=c.useState(!0);let r,s;e[0]!==t?(r=()=>{if(t===void 0||!("IntersectionObserver"in window))return;const v=new IntersectionObserver(C=>{C.length!==0&&u(C[0].isIntersecting)},{threshold:1});return v.observe(t),()=>v.disconnect()},s=[t],e[0]=t,e[1]=r,e[2]=s):(r=e[1],s=e[2]),c.useLayoutEffect(r,s);let a,d;e[3]!==l||e[4]!==t?(a=()=>{if(l||t===void 0)return;let v;const C=()=>{const{right:p}=t.getBoundingClientRect();i(w=>Math.min(w+window.innerWidth-p-10,0)),v=requestAnimationFrame(C)};return v=requestAnimationFrame(C),()=>{v!==void 0&&cancelAnimationFrame(v)}},d=[t,l],e[3]=l,e[4]=t,e[5]=a,e[6]=d):(a=e[5],d=e[6]),c.useEffect(a,d);const h=`translateX(${o}px)`;let g;e[7]!==h?(g={transform:h},e[7]=h,e[8]=g):g=e[8];const m=g;let f;return e[9]!==n||e[10]!==m?(f={ref:n,style:m},e[9]=n,e[10]=m,e[11]=f):f=e[11],f}const qo=c.createContext({isGhostMode:!1,ghostValue:""}),bd=e=>{var t,n,o;const{target:i,content:l,onFinishEditing:u,forceEditMode:r,initialValue:s,imageEditorOverride:a,markdownDivCreateNode:d,highlight:h,className:g,theme:m,id:f,cell:v,bloom:C,portalElementRef:p,validateCell:w,getCellRenderer:b,provideEditor:x,isOutsideClick:E,customEventTarget:H,activation:B,ghostValue:S,isGhostMode:D}=e,[k,I]=c.useState(r?l:void 0),R=c.useRef(k??l);R.current=k??l;const[z,F]=c.useState(()=>w===void 0?!0:!(Kn(l)&&(w==null?void 0:w(v,l,R.current))===!1)),M=c.useCallback((J,Be)=>{u(z?J:void 0,Be)},[z,u]),G=c.useCallback(J=>{if(w!==void 0&&J!==void 0&&Kn(J)){const Be=w(v,J,R.current);Be===!1?F(!1):(typeof Be=="object"&&(J=Be),F(!0))}I(J)},[v,w]),$=c.useRef(!1),le=c.useRef(void 0),Y=c.useCallback(()=>{M(k,[0,0]),$.current=!0},[k,M]),ne=c.useCallback((J,Be)=>{var Ve;console.log("[onEditorFinished] newValue:",J),console.log("[onEditorFinished] movement:",Be),console.log("[onEditorFinished] calling onFinishEditing"),M(J,(Ve=Be??le.current)!==null&&Ve!==void 0?Ve:[0,0]),console.log("[onEditorFinished] onFinishEditing called"),$.current=!0},[M]),se=c.useCallback(async J=>{if(J.nativeEvent.isComposing)return;let Be=!1;J.key==="Escape"?(J.stopPropagation(),J.preventDefault(),le.current=[0,0]):J.key==="Enter"&&!J.shiftKey?(J.stopPropagation(),J.preventDefault(),le.current=[0,1],Be=!0):J.key==="Tab"&&(J.stopPropagation(),J.preventDefault(),le.current=[J.shiftKey?-1:1,0],Be=!0),window.setTimeout(()=>{!$.current&&le.current!==void 0&&(M(Be?k:void 0,le.current),$.current=!0)},0)},[M,k]),X=k??l,[oe,ae]=c.useMemo(()=>{var J,Be;if(Co(l))return[];const Ve={...l,location:v,activation:B},ce=x==null?void 0:x(Ve);return ce!==void 0?[ce,!1]:[(J=b(l))===null||J===void 0||(Be=J.provideEditor)===null||Be===void 0?void 0:Be.call(J,Ve),!1]},[v,l,b,x,B]),{ref:de,style:pe}=yd();let W=!0,me,O=!0,ve;if(oe!==void 0){W=oe.disablePadding!==!0,O=oe.disableStyling!==!0;const J=uu(oe);J&&(ve=oe.styleOverride);const Be=J?oe.editor:oe;me=c.createElement(Be,{portalElementRef:p,isHighlighted:h,activation:B,onChange:G,value:X,initialValue:s,onFinishedEditing:ne,validatedSelection:Kn(X)?X.selectionRange:void 0,forceEditMode:r,target:i,imageEditorOverride:a,markdownDivCreateNode:d,isValid:z,theme:m})}ve={...ve,...pe};const q=c.useMemo(()=>({isGhostMode:D??!1,ghostValue:S??""}),[D,S]),he=(t=p==null?void 0:p.current)!==null&&t!==void 0?t:document.getElementById("portal");if(he===null)return console.error('Cannot open Data Grid overlay editor, because portal not found. Please, either provide a portalElementRef or add `<div id="portal" />` as the last child of your `<body>`.'),null;let K=O?"gdg-style":"gdg-unstyle";z||(K+=" gdg-invalid"),W&&(K+=" gdg-pad");const re=(n=C==null?void 0:C[0])!==null&&n!==void 0?n:1,ke=(o=C==null?void 0:C[1])!==null&&o!==void 0?o:1;return iu.createPortal(c.createElement(Jl.Provider,{value:m},c.createElement(qo.Provider,{value:q},c.createElement(hu,{style:gu(m),className:g,onClickOutside:Y,isOutsideClick:E,customEventTarget:H},c.createElement(wd,{ref:de,id:f,className:K,style:D?{...ve,visibility:"hidden"}:ve,as:ae===!0?"label":void 0,targetX:i.x-re,targetY:i.y-ke,targetWidth:i.width+re*2,targetHeight:i.height+ke*2},c.createElement("div",{className:"gdg-clip-region",onKeyDown:se},me))))),he)},Ed=Object.freeze(Object.defineProperty({__proto__:null,GhostModeContext:qo,default:bd},Symbol.toStringTag,{value:"Module"}));let Lr=0;const Ql=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:l,validatedSelection:u,autoFocus:r,...s}=e,{onChange:a,className:d}=s,h=c.useRef(null),{isGhostMode:g,ghostValue:m}=c.useContext(qo),f=g&&m?m:n??"";ln(a!==void 0,"GrowingEntry must be a controlled input area");const[v]=c.useState(()=>"input-box-"+(Lr=(Lr+1)%1e7));c.useEffect(()=>{if(g)return;const w=h.current;if(w===null||w.disabled)return;const b=f.toString().length;w.focus(),w.setSelectionRange(i?0:b,b)},[g]),c.useLayoutEffect(()=>{if(u!==void 0){var w;const b=typeof u=="number"?[u,null]:u;(w=h.current)===null||w===void 0||w.setSelectionRange(b[0],b[1])}},[u]);const C=c.useCallback(w=>{w.key==="Enter"&&w.shiftKey&&l===!0||o==null||o(w)},[l,o]),p=g?{visibility:"hidden"}:void 0;return c.createElement(dd,{className:"gdg-growing-entry"},c.createElement(sd,{className:d},f+`
`),c.createElement(ud,{...s,className:(d??"")+" gdg-input",id:v,ref:h,onKeyDown:C,value:f,placeholder:t,dir:"auto",style:p}))};function xd(e,t){const n=sn.c(5);let o;if(n[0]!==e||n[1]!==t){let i;n[3]!==t?(i=(l,u)=>({group:l.group,grow:l.grow,hasMenu:l.hasMenu,icon:l.icon,id:l.id,menuIcon:l.menuIcon,overlayIcon:l.overlayIcon,sourceIndex:u,sticky:u<t,indicatorIcon:l.indicatorIcon,style:l.style,themeOverride:l.themeOverride,title:l.title,trailingRowOptions:l.trailingRowOptions,width:l.width,growOffset:l.growOffset,rowMarker:l.rowMarker,rowMarkerChecked:l.rowMarkerChecked,headerRowMarkerTheme:l.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:l.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:l.headerRowMarkerDisabled,rowGroupBorder:l.rowGroupBorder,required:l.required}),n[3]=t,n[4]=i):i=n[4],o=e.map(i),n[0]=e,n[1]=t,n[2]=o}else o=n[2];return o}function Fd(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(ci(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const l of i)if(n>=l.x&&n<l.x+l.width&&o>=l.y&&o<l.y+l.height)return!0}return!1}function yo(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Gl(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function Cu(e,t){const n=yo(e),o=yo(t);return n===o}function Zi(e,t,n,o){for(let u=0;u<=n;u++){var i,l;const r=(i=Gl(e,u,o))!==null&&i!==void 0?i:"",s=(l=Gl(t,u,o))!==null&&l!==void 0?l:"";if(r!==s)return!1}return!0}function Dd(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function yu(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function ci(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function bu(e){return[e.x+e.width-1,e.y+e.height-1]}function Or(e,t,n){const o=n.x,i=n.x+n.width-1,l=n.y,u=n.y+n.height-1,[r,s]=e;if(s<l||s>u)return!1;if(t.span===void 0)return r>=o&&r<=i;const[a,d]=t.span;return a>=o&&a<=i||d>=o&&a<=i||a<o&&d>i}function kd(e,t,n,o){let i=0;if(n.current===void 0)return i;const l=n.current.range;(o||l.height*l.width>1)&&Or(e,t,l)&&i++;for(const u of n.current.rangeStack)Or(e,t,u)&&i++;return i}function Eu(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((l,u)=>({...l,sticky:e[u].sticky})),n=o}return n}function jo(e,t){let n=0;const o=Eu(e,t);for(let i=0;i<o.length;i++){const l=o[i];if(l.sticky)n+=l.width;else break}return n}function bo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function $l(e,t,n,o,i){const l=Eu(e,o),u=[];for(const a of l)if(a.sticky)u.push(a);else break;if(u.length>0)for(const a of u)n-=a.width;let r=t,s=i??0;for(;s<=n&&r<l.length;)s+=l[r].width,r++;for(let a=t;a<r;a++){const d=l[a];d.sticky||u.push(d)}return u}function Sd(e,t,n){let o=0;for(const i of t){const l=i.sticky?o:o+(n??0);if(e<=l+i.width)return i.sourceIndex;o+=i.width}return-1}function Rd(e,t,n,o,i,l,u,r,s,a,d,h){const g=d??(n?1:0),m=h??(n?[i]:[]),f=m.reduce((x,E)=>x+E,0),v=o+f;if(n&&g>0){let x=0;for(let E=0;E<g;E++){var C;if(x+=(C=m[E])!==null&&C!==void 0?C:0,e<=x)return-(E+2)}}if(e<=v)return-1;let p=t;for(let x=0;x<a;x++){const E=l-1-x,H=typeof u=="number"?u:u(E);if(p-=H,e>=p)return E}const w=l-a,b=e-(s??0);if(typeof u=="number"){const x=Math.floor((b-v)/u)+r;return x>=w?void 0:x}else{let x=v;for(let E=r;E<w;E++){const H=u(E);if(b<=x+H)return E;x+=H}return}}let Ui=0,fi={};const Md=typeof window>"u";async function Ad(){var e;Md||((e=document)===null||e===void 0||(e=e.fonts)===null||e===void 0?void 0:e.ready)===void 0||(await document.fonts.ready,Ui=0,fi={},Xs())}Ad();function xu(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Eo(e,t,n){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"middle";const i=xu(e,t,o,n);let l=fi[i];return l===void 0&&(l=t.measureText(e),fi[i]=l,Ui++),Ui>1e4&&(fi={},Ui=0),l}function Fu(e,t){const n=xu(e,void 0,"middle",t);return fi[n]}function un(e,t){return typeof t!="string"&&(t=t.baseFontFull),Bd(e,t)}function Wr(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Nr=[];function Bd(e,t){for(const l of Nr)if(l.key===t)return l.val;const n=Wr(e,"alphabetic"),i=-(Wr(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Nr.push({key:t,val:i}),i}function Id(e,t,n,o,i,l){const{ctx:u,rect:r,theme:s}=e;let a=Number.MAX_SAFE_INTEGER;const d=500;if(t!==void 0&&(a=n-t,a<d)){const h=1-a/d;u.globalAlpha=h,u.fillStyle=s.bgSearchResult,u.fillRect(r.x+1,r.y+1,r.width-(i?2:1),r.height-(l?2:1)),u.globalAlpha=1,o!==void 0&&(o.fillStyle=s.bgSearchResult)}return a<d}function tl(e,t,n){const{ctx:o,theme:i}=e,l=t??{},u=n??i.textDark;return u!==l.fillStyle&&(o.fillStyle=u,l.fillStyle=u),l}function cf(e,t,n,o,i){const{rect:l,ctx:u,theme:r}=e;u.fillStyle=r.textDark,$n({ctx:u,rect:l,theme:r},t,n,o,i)}function Du(e,t,n,o,i,l,u,r,s){s==="right"?e.fillText(t,n+i-(r.cellHorizontalPadding+.5),o+l/2+u):s==="center"?e.fillText(t,n+i/2,o+l/2+u):e.fillText(t,n+r.cellHorizontalPadding+.5,o+l/2+u)}function ku(e,t){const n=Eo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Hd(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Td(e,t,n,o,i,l,u,r,s,a){const d=r.baseFontFull,h=$s(e,t,d,i-r.cellHorizontalPadding*2,a??!1),g=ku(e,d),m=r.lineHeight*g,f=g+m*(h.length-1),v=f+r.cellVerticalPadding>l;v&&(e.save(),e.rect(n,o,i,l),e.clip());const C=o+l/2-f/2;let p=Math.max(o+r.cellVerticalPadding,C);for(const w of h)if(Du(e,w,n,p,i,g,u,r,s),p+=m,p>o+l)break;v&&e.restore()}function $n(e,t,n,o,i){const{ctx:l,rect:u,theme:r}=e,{x:s,y:a,width:d,height:h}=u;o=o??!1,o||(t=Hd(t,d));const g=un(l,r),m=Zl(t)==="rtl";if(n===void 0&&m&&(n="right"),m&&(l.direction="rtl"),t.length>0){let f=!1;n==="right"?(l.textAlign="right",f=!0):n!==void 0&&n!=="left"&&(l.textAlign=n,f=!0),o?Td(l,t,s,a,d,h,g,r,n,i):Du(l,t,s,a,d,h,g,r,n),f&&(l.textAlign="start"),m&&(l.direction="inherit")}}function Bn(e,t,n,o,i,l){typeof l=="number"&&(l={tl:l,tr:l,br:l,bl:l}),l={tl:Math.max(0,Math.min(l.tl,i/2,o/2)),tr:Math.max(0,Math.min(l.tr,i/2,o/2)),bl:Math.max(0,Math.min(l.bl,i/2,o/2)),br:Math.max(0,Math.min(l.br,i/2,o/2))},e.moveTo(t+l.tl,n),e.arcTo(t+o,n,t+o,n+l.tr,l.tr),e.arcTo(t+o,n+i,t+o-l.br,n+i,l.br),e.arcTo(t,n+i,t,n+i-l.bl,l.bl),e.arcTo(t,n,t+l.tl,n,l.tl)}function zd(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Pd(e,t,n){const o=function(r,s){const a=s.x-r.x,d=s.y-r.y,h=Math.sqrt(a*a+d*d),g=a/h,m=d/h;return{x:a,y:s.y-r.y,len:h,nx:g,ny:m,ang:Math.atan2(m,g)}};let i;const l=t.length;let u=t[l-1];for(let r=0;r<l;r++){let s=t[r%l];const a=t[(r+1)%l],d=o(s,u),h=o(s,a),g=d.nx*h.ny-d.ny*h.nx,m=d.nx*h.nx-d.ny*-h.ny;let f=Math.asin(g<-1?-1:g>1?1:g),v=1,C=!1;m<0?f<0?f=Math.PI+f:(f=Math.PI-f,v=-1,C=!0):f>0&&(v=-1,C=!0),i=s.radius!==void 0?s.radius:n;const p=f/2;let w=Math.abs(Math.cos(p)*i/Math.sin(p)),b;w>Math.min(d.len/2,h.len/2)?(w=Math.min(d.len/2,h.len/2),b=Math.abs(w*Math.sin(p)/Math.cos(p))):b=i;let x=s.x+h.nx*w,E=s.y+h.ny*w;x+=-h.ny*b*v,E+=h.nx*b*v,e.arc(x,E,b,d.ang+Math.PI/2*v,h.ang-Math.PI/2*v,C),u=s,s=a}e.closePath()}function Xl(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C){const p={x:0,y:l+a,width:0,height:0},w=v??(i>0?1:0),b=-(w+1);if(e>=m.length||t>=d||t<b||e<0)return p;const x=C??(i>0?[i]:[]),E=x.reduce((D,k)=>D+k,0),H=l-E;if(e>=h){const D=u>e?-1:1,k=jo(m);p.x+=k+s;for(let I=u;I!==e;I+=D)p.x+=m[D===1?I:I-1].width*D}else for(let D=0;D<e;D++)p.x+=m[D].width;if(p.width=m[e].width+1,t===-1)p.y=E,p.height=H;else if(t<=-2){var B;const D=-(t+2);let k=0;for(let M=0;M<D;M++){var S;k+=(S=x[M])!==null&&S!==void 0?S:0}p.y=k,p.height=(B=x[D])!==null&&B!==void 0?B:i;let I=e;const R=m[e].group,z=m[e].sticky;for(;I>0&&Zi(m[I-1].group,R,D,w)&&m[I-1].sticky===z;){const M=m[I-1];p.x-=M.width,p.width+=M.width,I--}let F=e;for(;F+1<m.length&&Zi(m[F+1].group,R,D,w)&&m[F+1].sticky===z;){const M=m[F+1];p.width+=M.width,F++}if(!z){const M=jo(m),G=p.x-M;G<0&&(p.x-=G,p.width+=G),p.x+p.width>n&&(p.width=n-p.x)}}else if(t>=d-g){let D=d-t;for(p.y=o;D>0;){const k=t+D-1;p.height=typeof f=="number"?f:f(k),p.y-=p.height,D--}p.height+=1}else{const D=r>t?-1:1;if(typeof f=="number"){const k=t-r;p.y+=k*f}else for(let k=r;k!==t;k+=D)p.y+=f(k)*D;p.height=(typeof f=="number"?f:f(t))+1}return p}const er=1<<21;function yn(e,t){return(t+2)*er+e}function Su(e){return e%er}function tr(e){return Math.floor(e/er)-2}function nr(e){const t=Su(e),n=tr(e);return[t,n]}class Ru{constructor(){this.visibleWindow={x:0,y:0,width:0,height:0},this.freezeCols=0,this.freezeRows=[],this.isInWindow=t=>{const n=Su(t),o=tr(t),i=this.visibleWindow,l=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,u=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return l&&u}}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Yo(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Ld extends Ru{constructor(){super(...arguments),this.cache=new Map,this.setValue=(t,n)=>{this.cache.set(yn(t[0],t[1]),n)},this.getValue=t=>this.cache.get(yn(t[0],t[1])),this.clearOutOfWindow=()=>{for(const[t]of this.cache.entries())this.isInWindow(t)||this.cache.delete(t)}}}class Ko{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.cells=void 0,this.cells=new Set(t.map(n=>yn(n[0],n[1])))}add(t){this.cells.add(yn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(yn(t[0],t[1]))}remove(t){this.cells.delete(yn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(tr(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(yn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield nr(t)}}const Kl=150;function Od(e,t,n,o){var i,l;const u=o(t);return(i=u==null||(l=u.measure)===null||l===void 0?void 0:l.call(u,e,t,n))!==null&&i!==void 0?i:Kl}function Mu(e,t,n,o,i,l,u,r,s){let a=0;const d=i===void 0?[]:i.map(m=>{const f=Od(e,m[o],t,s);return a=Math.max(a,f),f});if(d.length>5&&r){a=0;let m=0;for(const v of d)m+=v;const f=m/d.length;for(let v=0;v<d.length;v++)d[v]>=f*2?d[v]=0:a=Math.max(a,d[v])}const h=e.font;e.font=t.headerFontFull,a=Math.max(a,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=h;const g=Math.max(Math.ceil(l),Math.min(Math.floor(u),Math.ceil(a)));return{...n,width:g}}function Wd(e,t,n,o,i,l,u,r,s){const a=c.useRef(t),d=c.useRef(n),h=c.useRef(u);a.current=t,d.current=n,h.current=u;const[g,m]=(()=>{if(typeof window>"u")return[null,null];const S=document.createElement("canvas");return S.style.display="none",S.style.opacity="0",S.style.position="fixed",[S,S.getContext("2d",{alpha:!1})]})();c.useLayoutEffect(()=>(g&&document.documentElement.append(g),()=>{g==null||g.remove()}),[g]);const f=c.useRef({}),v=c.useRef(),[C,p]=c.useState();c.useLayoutEffect(()=>{const S=d.current;if(S===void 0||e.every($i))return;let D=Math.max(1,10-Math.floor(e.length/1e4)),k=0;D<a.current&&D>1&&(D--,k=1);const I={x:0,y:0,width:e.length,height:Math.min(a.current,D)},R={x:0,y:a.current-1,width:e.length,height:1};(async()=>{const F=S(I,s.signal),M=k>0?S(R,s.signal):void 0;let G;typeof F=="object"?G=F:G=await Hr(F),M!==void 0&&(typeof M=="object"?G=[...G,...M]:G=[...G,...await Hr(M)]),v.current=e,p(G)})()},[s.signal,e]);let b=e.every($i)?e:m===null?e.map(S=>$i(S)?S:{...S,width:Kl}):(m.font=h.current.baseFontFull,e.map((S,D)=>{if($i(S))return S;if(f.current[S.id]!==void 0)return{...S,width:f.current[S.id]};if(C===void 0||v.current!==e||S.id===void 0)return{...S,width:Kl};const k=Mu(m,u,S,D,C,i,l,!0,r);return f.current[S.id]=k.width,k})),x=0,E=0;const H=[];for(const[S,D]of b.entries())x+=D.width,D.grow!==void 0&&D.grow>0&&(E+=D.grow,H.push(S));if(x<o&&H.length>0){const S=[...b],D=o-x;let k=D;for(let I=0;I<H.length;I++){var B;const R=H[I],z=((B=b[R].grow)!==null&&B!==void 0?B:0)/E,F=I===H.length-1?k:Math.min(k,Math.floor(D*z));S[R]={...b[R],growOffset:F,width:b[R].width+F},k-=F}b=S}return{sizedColumns:b,nonGrowWidth:x}}const Dt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Nd=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Gd=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},$d=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Xd=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Kd=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Au=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Yd=e=>{const t=e.bgColor;return`${Dt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Vd=Au,Ud=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},jd=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},qd=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},_d=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Zd=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Jd=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Qd=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},ea=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},ta=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},na=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},oa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},ia=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},la=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},ra=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},ua=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},sa=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},da=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Dt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},aa=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},ca=e=>{const t=e.fgColor,n=e.bgColor;return`${Dt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},fa=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},ha=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},ga=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),va=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),ma={headerRowID:Nd,headerNumber:$d,headerCode:Gd,headerString:Xd,headerBoolean:Kd,headerAudioUri:Vd,headerVideoUri:Ud,headerEmoji:jd,headerImage:qd,headerUri:Au,headerPhone:_d,headerMarkdown:Zd,headerDate:Jd,headerTime:Qd,headerEmail:ea,headerReference:ta,headerIfThenElse:na,headerSingleValue:oa,headerLookup:ia,headerTextTemplate:la,headerMath:ra,headerRollup:ua,headerJoinStrings:sa,headerSplitString:da,headerGeoDistance:aa,headerArray:ca,rowOwnerOverlay:fa,protectedColumnOverlay:ha,renameIcon:Yd,headerArrowDown:ga,headerArrowUp:va};function wa(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class pa{constructor(t,n){this.onSettled=void 0,this.spriteMap=new Map,this.headerIcons=void 0,this.inFlight=0,this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,l,u,r){let s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:1;const[a,d]=wa(n,r),h=u*Math.ceil(window.devicePixelRatio),g=`${a}_${d}_${h}_${t}`;let m=this.spriteMap.get(g);if(m===void 0){const f=this.headerIcons[t];if(f===void 0)return;m=document.createElement("canvas");const v=m.getContext("2d");if(v===null)return;const C=new Image;C.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(f({fgColor:d,bgColor:a}))}`,this.spriteMap.set(g,m);const p=C.decode();if(p===void 0)return;this.inFlight++,p.then(()=>{v.drawImage(C,0,0,h,h)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else s<1&&(o.globalAlpha=s),o.drawImage(m,0,0,h,h,i,l,u,u),s<1&&(o.globalAlpha=1)}}function Bu(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function nl(e,t,n,o,i,l,u,r,s){r=r??t;let a=t,d=e;const h=o-l;let g=!1;for(;a<n&&d<h;){const m=i(d);if(a+m>r&&s(a,d,m,!1,u&&d===o-1)===!0){g=!0;break}a+=m,d++}if(!g){a=n;for(let m=0;m<l;m++){d=o-1-m;const f=i(d);a-=f,s(a,d,f,!0,u&&d===o-1)}}}function co(e,t,n,o,i,l){let u=0,r=0;const s=i+o;for(const a of e){const d=a.sticky?r:u+n;if(l(a,d,s,a.sticky?0:r,t)===!0)break;u+=a.width,r+=a.sticky?a.width:0}}function Ca(e,t,n,o,i){let l=0,u=0;for(let r=0;r<e.length;r++){const s=e[r];let a=r+1,d=s.width;for(s.sticky&&(u+=d);a<e.length&&Cu(e[a].group,s.group)&&e[a].sticky===e[r].sticky;){const v=e[a];d+=v.width,a++,r++,v.sticky&&(u+=v.width)}const h=s.sticky?0:n,g=l+h,m=s.sticky?0:Math.max(0,u-g),f=Math.min(d-m,t-(g+m));i([s.sourceIndex,e[a-1].sourceIndex],yo(s.group),g+m,0,f,o),l+=d}}function ya(e,t,n,o,i,l){if(i===0)return;const u=[];let r=0;for(let g=0;g<i;g++){var s;u.push(r),r+=(s=o[g])!==null&&s!==void 0?s:0}const a=[];let d=0;for(const g of e)a.push(d),d+=g.width;for(let g=0;g<i;g++){var h;const m=u[g],f=(h=o[g])!==null&&h!==void 0?h:0;let v=0,C=0;for(;C<e.length;){const p=e[C],w=Gl(p.group,g,i);if(w===void 0){p.sticky&&(v+=p.width),C++;continue}const b=a[C];let x=C+1,E=p.width;for(p.sticky&&(v+=p.width);x<e.length;){const k=e[x],I=Zi(k.group,p.group,g,i),R=k.sticky===p.sticky;if(!I||!R)break;E+=k.width,k.sticky&&(v+=k.width),x++}const H=p.sticky?0:n,B=b+H,S=p.sticky?0:Math.max(0,v-B),D=Math.min(E-S,t-(B+S));D>0&&l([p.sourceIndex,e[x-1].sourceIndex],w,B+S,m,D,f,g),C=x}}}function Iu(e,t,n,o,i,l,u){var r,s;const[a,d]=e;let h,g;const m=(r=(s=u.find(f=>!f.sticky))===null||s===void 0?void 0:s.sourceIndex)!==null&&r!==void 0?r:0;if(d>m){const f=Math.max(a,m);let v=t,C=o;for(let p=l.sourceIndex-1;p>=f;p--)v-=u[p].width,C+=u[p].width;for(let p=l.sourceIndex+1;p<=d;p++)C+=u[p].width;g={x:v,y:n,width:C,height:i}}if(m>a){const f=Math.min(d,m-1);let v=t,C=o;for(let p=l.sourceIndex-1;p>=a;p--)v-=u[p].width,C+=u[p].width;for(let p=l.sourceIndex+1;p<=f;p++)C+=u[p].width;h={x:v,y:n,width:C,height:i}}return[h,g]}function ba(e,t,n,o){if(o==="any")return Hu(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),yu([t,n],e))return;const i=t-e.x,l=e.x+e.width-t,u=n-e.y+1,r=e.y+e.height-n,s=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:u,o==="horizontal"?Number.MAX_SAFE_INTEGER:r);return s===r?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:s===u?{x:e.x,y:n,width:e.width,height:e.y-n}:s===l?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function gi(e,t,n,o,i,l,u,r){return e<=i+u&&i<=e+n&&t<=l+r&&l<=t+o}function uo(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Hu(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,l=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:l}}function Ea(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function xa(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,l=-4,u=t+4,r=n+4,s=i-e.x,a=e.x+e.width-u,d=l-e.y,h=e.y+e.height-r,g=s>0?e.x+Math.floor(s/o)*o:e.x,m=a>0?e.x+e.width-Math.floor(a/o)*o:e.x+e.width,f=d>0?e.y+Math.floor(d/o)*o:e.y,v=h>0?e.y+e.height-Math.floor(h/o)*o:e.y+e.height;return{x:g,y:f,width:m-g,height:v-f}}function Fa(e,t,n,o,i){const[l,u,r,s]=t,[a,d,h,g]=i,{x:m,y:f,width:v,height:C}=e,p=[];if(v<=0||C<=0)return p;const w=m+v,b=f+C,x=m<l,E=f<u,H=m+v>r,B=f+C>s,S=m>=l&&m<r||w>l&&w<=r||m<l&&w>r,D=f>=u&&f<s||b>u&&b<=s||f<u&&b>s;if(S&&D){const I=Math.max(m,l),R=Math.max(f,u),z=Math.min(w,r),F=Math.min(b,s);p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:a,y:d,width:h-a+1,height:g-d+1}})}if(x&&E){const I=m,R=f,z=Math.min(w,l),F=Math.min(b,u);p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:0,y:0,width:a+1,height:d+1}})}if(E&&S){const I=Math.max(m,l),R=f,z=Math.min(w,r),F=Math.min(b,u);p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:a,y:0,width:h-a+1,height:d+1}})}if(E&&H){const I=Math.max(m,r),R=f,z=w,F=Math.min(b,u);p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:h,y:0,width:n-h+1,height:d+1}})}if(x&&D){const I=m,R=Math.max(f,u),z=Math.min(w,l),F=Math.min(b,s);p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:0,y:d,width:a+1,height:g-d+1}})}if(H&&D){const I=Math.max(m,r),R=Math.max(f,u),z=w,F=Math.min(b,s);p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:h,y:d,width:n-h+1,height:g-d+1}})}if(x&&B){const I=m,R=Math.max(f,s),z=Math.min(w,l),F=b;p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:0,y:g,width:a+1,height:o-g+1}})}if(B&&S){const I=Math.max(m,l),R=Math.max(f,s),z=Math.min(w,r),F=b;p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:a,y:g,width:h-a+1,height:o-g+1}})}if(H&&B){const I=Math.max(m,r),R=Math.max(f,s),z=w,F=b;p.push({rect:{x:I,y:R,width:z-I,height:F-R},clip:{x:h,y:g,width:n-h+1,height:o-g+1}})}return p}const Da={kind:te.Loading,allowOverlay:!1};function Gr(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C,p,w,b,x,E,H,B,S,D,k,I,R,z,F,M,G,$,le){var Y;let ne=(Y=b==null?void 0:b.size)!==null&&Y!==void 0?Y:Number.MAX_SAFE_INTEGER;const se=performance.now();let X=z.baseFontFull;e.font=X;const oe={ctx:e},ae=[0,0],de=C>0?bo(s,C,a):0;let pe,W;const me=new Ko,O=new Set,ve=Bu(w);if(co(t,r,l,u,i,(q,he,K,re,ke)=>{const J=Math.max(0,re-he),Be=he+J,Ve=i+1,ce=q.width-J,T=o-i-1;if(w.length>0){let Ie=!1;for(let fe=0;fe<w.length;fe++){const Ee=w[fe];if(gi(Be,Ve,ce,T,Ee.x,Ee.y,Ee.width,Ee.height)){Ie=!0;break}}if(!Ie)return}const ie=()=>{e.save(),e.beginPath(),e.rect(Be,Ve,ce,T),e.clip()},ge=x.columns.hasIndex(q.sourceIndex),_=h(yo(q.group)).overrideTheme,Me=q.themeOverride===void 0&&_===void 0?z:An(z,_,q.themeOverride),Se=Me.baseFontFull;Se!==X&&(X=Se,e.font=Se),ie();let Fe;return nl(ke,K,o,s,a,C,p,ve,(Ie,fe,Ee,Te,We)=>{var Ce,Ke;if(fe<0)return;if(ae[0]=q.sourceIndex,ae[1]=fe,me.has(ae)){ne--;return}if(b!==void 0&&!b.has(ae))return;if(w.length>0){let Ne=!1;for(let Ct=0;Ct<w.length;Ct++){const rt=w[Ct];if(gi(he,Ie,q.width,Ee,rt.x,rt.y,rt.width,rt.height)){Ne=!0;break}}if(!Ne)return}const tt=x.rows.hasIndex(fe),Ue=m.hasIndex(fe),Qe=fe<s?d(ae):Da;let ct=he,ft=q.width,_e=Ie,ht=Ee,Le=!1,lt=!1;if(Qe.rowspan!==void 0){const[Ne,Ct]=Qe.rowspan,rt=`${q.sourceIndex}|${Ne}`;if(O.has(rt)){ne--;return}else{let Gt=Ie;for(let gt=Ne;gt<fe;gt++)Gt-=a(gt);let Kt=0;for(let gt=Ne;gt<Ct;gt++)Kt+=a(gt);if(Gt<Ve+T&&Gt+Kt>Ve){_e=Gt,ht=Kt,O.add(rt);for(let gt=Ne;gt<Ct;gt++)gt!==fe&&me.add([q.sourceIndex,gt]);Le=!0}else{O.add(rt);for(let gt=Ne;gt<Ct;gt++)me.add([q.sourceIndex,gt]);ne--;return}}}if(Qe.span!==void 0){const[Ne,Ct]=Qe.span,rt=`${fe},${Ne},${Ct},${q.sticky}`;if(W===void 0&&(W=new Set),W.has(rt)){ne--;return}else{const Gt=Iu(Qe.span,he,Ie,q.width,Ee,q,n),Kt=q.sticky?Gt[0]:Gt[1];!q.sticky&&Gt[0]!==void 0&&(lt=!0),Kt!==void 0&&(ct=Kt.x,ft=Kt.width,W.add(rt),Le=!0)}}if(Le){e.restore(),Fe=void 0,e.save(),e.beginPath();const Ne=Math.max(0,re-ct);e.rect(ct+Ne,_e,ft-Ne,ht),pe===void 0&&(pe=[]),pe.push({x:ct+Ne,y:_e,width:ft-Ne,height:ht}),e.clip()}const Mt=g==null?void 0:g(fe),At=We&&((Ce=q.trailingRowOptions)===null||Ce===void 0?void 0:Ce.themeOverride)!==void 0?(Ke=q.trailingRowOptions)===null||Ke===void 0?void 0:Ke.themeOverride:void 0,bt=Qe.themeOverride===void 0&&Mt===void 0&&At===void 0?Me:An(Me,Mt,At,Qe.themeOverride);e.beginPath();const Lt=Dd(ae,Qe,x);let wt=kd(ae,Qe,x,v);const Zt=Qe.span!==void 0&&x.columns.some(Ne=>Qe.span!==void 0&&Ne>=Qe.span[0]&&Ne<=Qe.span[1]);Lt&&!f&&v?wt=0:Lt&&v&&(wt=Math.max(wt,1)),Zt&&wt++,Lt||(tt&&wt++,ge&&!We&&wt++);const dn=Qe.kind===te.Protected?bt.bgCellMedium:bt.bgCell;let Pe;if((Te||dn!==z.bgCell)&&(Pe=rn(dn,Pe)),wt>0||Ue){Ue&&(Pe=rn(bt.bgHeader,Pe));for(let Ne=0;Ne<wt;Ne++)Pe=rn(bt.accentLight,Pe)}else if(E!==void 0){for(const Ne of E)if(Ne[0]===q.sourceIndex&&Ne[1]===fe){Pe=rn(bt.bgSearchResult,Pe);break}}if(H!==void 0)for(let Ne=0;Ne<H.length;Ne++){const Ct=H[Ne],rt=Ct.range;Ct.style!=="solid-outline"&&rt.x<=q.sourceIndex&&q.sourceIndex<rt.x+rt.width&&rt.y<=fe&&fe<rt.y+rt.height&&(Pe=rn(Ct.color,Pe))}let St=!1;if(b!==void 0){const Ne=Ie+1,rt=(Te?Ne+Ee-1:Math.min(Ne+Ee-1,o-de))-Ne;(rt!==Ee-1||ct+1<=re)&&(St=!0,e.save(),e.beginPath(),e.rect(ct+1,Ne,ft-1,rt),e.clip()),Pe=Pe===void 0?bt.bgCell:rn(Pe,bt.bgCell)}const Bt=q.sourceIndex===n.length-1,Vt=fe===s-1;Pe!==void 0&&(e.fillStyle=Pe,Fe!==void 0&&(Fe.fillStyle=Pe),b!==void 0?e.fillRect(ct+1,_e+1,ft-(Bt?2:1),ht-(Vt?2:1)):e.fillRect(ct,_e,ft,ht)),Qe.style==="faded"&&(e.globalAlpha=.6);let mn;for(let Ne=0;Ne<D.length;Ne++){const Ct=D[Ne];if(Ct.item[0]===q.sourceIndex&&Ct.item[1]===fe){mn=Ct;break}}if(ft>le&&!lt){var In,en;const Ne=bt.baseFontFull;Ne!==X&&(e.font=Ne,X=Ne);let Ct=0;if(Qe.rowspan!==void 0){var Hn;const rt=(Hn=Qe.rowSpanPosition)!==null&&Hn!==void 0?Hn:"top";if(rt==="top")Ct=Ee/2-ht/2;else if(rt==="bottom"){const[Gt,Kt]=Qe.rowspan,gt=a(Kt-1);Ct=ht/2-gt/2}}Fe=Tu(e,Qe,q.sourceIndex,fe,Bt,Vt,ct,_e,ft,ht,wt>0,bt,Pe??bt.bgCell,B,S,(In=(en=mn)===null||en===void 0?void 0:en.hoverAmount)!==null&&In!==void 0?In:0,k,R,se,I,Fe,F,M,G,$,Ct)}if(St&&e.restore(),Qe.style==="faded"&&(e.globalAlpha=1),ne--,Le){var Yt,Jt;e.restore(),(Yt=Fe)===null||Yt===void 0||(Jt=Yt.deprep)===null||Jt===void 0||Jt.call(Yt,oe),Fe=void 0,ie(),X=Se,e.font=Se}return ne<=0}),e.restore(),ne<=0}),pe!==void 0)return pe}const ui=[0,0],si={x:0,y:0,width:0,height:0},Hl=[void 0,()=>{}];let Yl=!1;function ka(){Yl=!0}function Tu(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C,p,w,b,x,E,H,B,S,D){let k,I;C!==void 0&&C[0][0]===n&&C[0][1]===o&&(k=C[1][0],I=C[1][1]);let R;ui[0]=n,ui[1]=o,si.x=u,si.y=r,si.width=s,si.height=a,Hl[0]=H.getValue(ui),Hl[1]=ne=>H.setValue(ui,ne),Yl=!1;const z={ctx:e,theme:h,col:n,row:o,cell:t,rect:si,highlighted:d,cellFillColor:g,hoverAmount:v,frameTime:w,hoverX:k,drawState:Hl,hoverY:I,imageLoader:m,spriteManager:f,hyperWrapping:p,overrideCursor:k!==void 0?S:void 0,requestAnimationFrame:ka},F=Id(z,t.lastUpdated,w,x,i,l),M=B(t);if(M!==void 0){var G,$;if(((G=x)===null||G===void 0?void 0:G.renderer)!==M){var le,Y;(le=x)===null||le===void 0||(Y=le.deprep)===null||Y===void 0||Y.call(le,z),x=void 0}const ne=($=M.drawPrep)===null||$===void 0?void 0:$.call(M,z,x);e.save(),e.translate(0,D),b!==void 0&&!Co(z.cell)?b(z,()=>M.draw(z,t)):M.draw(z,t),e.restore(),R=ne===void 0?void 0:{deprep:ne==null?void 0:ne.deprep,fillStyle:ne==null?void 0:ne.fillStyle,font:ne==null?void 0:ne.font,renderer:M}}return(F||Yl)&&(E==null||E(ui)),R}function Ji(e,t,n,o,i,l,u,r){var s;let a=arguments.length>8&&arguments[8]!==void 0?arguments[8]:-20,d=arguments.length>9&&arguments[9]!==void 0?arguments[9]:-20,h=arguments.length>10&&arguments[10]!==void 0?arguments[10]:void 0,g=arguments.length>11&&arguments[11]!==void 0?arguments[11]:"center",m=arguments.length>12&&arguments[12]!==void 0?arguments[12]:"square",f=arguments.length>13&&arguments[13]!==void 0?arguments[13]:!1;const v=Math.floor(i+u/2),C=m==="circle"?1e4:(s=t.roundingRadius)!==null&&s!==void 0?s:4;let p=au(h??t.checkboxMaxSize,u,t.cellVerticalPadding),w=p/2;const b=du(g,o,l,t.cellHorizontalPadding,p),x=su(b,v,p),E=cu(o+a,i+d,x);switch(n){case!0:{e.beginPath(),Bn(e,b-p/2,v-p/2,p,p,C),m==="circle"&&(w*=.8,p*=.8),e.fillStyle=f?t.bgCellMedium:r?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(b-w+p/4.23,v-w+p/1.97),e.lineTo(b-w+p/2.42,v-w+p/1.44),e.lineTo(b-w+p/1.29,v-w+p/3.25),e.strokeStyle=f?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case ji:case!1:{e.beginPath(),Bn(e,b-p/2+.5,v-p/2+.5,p-1,p-1,C),e.lineWidth=1,e.strokeStyle=f?t.textLight:E?t.textDark:t.textMedium,e.stroke();break}case Ul:{e.beginPath(),Bn(e,b-p/2,v-p/2,p,p,C),e.fillStyle=f?t.bgCellMedium:E?t.textMedium:t.textLight,e.fill(),m==="circle"&&(w*=.8,p*=.8),e.beginPath(),e.moveTo(b-p/3,v),e.lineTo(b+p/3,v),e.strokeStyle=f?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:hi()}}function Sa(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C,p,w,b,x,E){var H,B,S,D;const k=x??(o?1:0),I=E??(o?[s]:[]),R=I.reduce((Y,ne)=>Y+ne,0),z=r+R;if(z<=0)return;e.fillStyle=g.bgHeader,p!==void 0&&o&&(x??1)>1?e.fillRect(0,R,l,r):e.fillRect(0,0,l,z);const F=i==null||(H=i[0])===null||H===void 0?void 0:H[0],M=i==null||(B=i[0])===null||B===void 0?void 0:B[1],G=i==null||(S=i[1])===null||S===void 0?void 0:S[0],$=i==null||(D=i[1])===null||D===void 0?void 0:D[1],le=g.headerFontFull;e.font=le,co(t,0,u,0,z,(Y,ne,se,X)=>{var oe,ae;if(p!==void 0&&!p.has([Y.sourceIndex,-1]))return;const de=Math.max(0,X-ne);e.save(),e.beginPath(),e.rect(ne+de,R,Y.width-de,r),e.clip();const pe=C(yo(Y.group)).overrideTheme,W=Y.themeOverride===void 0&&pe===void 0?g:An(g,pe,Y.themeOverride);W.bgHeader!==g.bgHeader&&(e.fillStyle=W.bgHeader,e.fill()),W!==g&&(e.font=W.headerFontFull);const me=h.columns.hasIndex(Y.sourceIndex),O=a!==void 0||d||Y.headerRowMarkerDisabled===!0,ve=!O&&M===-1&&F===Y.sourceIndex,q=O?0:(oe=(ae=f.find(J=>J.item[0]===Y.sourceIndex&&J.item[1]===-1))===null||ae===void 0?void 0:ae.hoverAmount)!==null&&oe!==void 0?oe:0,he=(h==null?void 0:h.current)!==void 0&&h.current.cell[0]===Y.sourceIndex,K=me?W.accentColor:he?W.bgHeaderHasFocus:W.bgHeader,re=o?R:0,ke=Y.sourceIndex===0?0:1;me?(e.fillStyle=K,e.fillRect(ne+ke,re,Y.width-ke,r)):(he||q>0)&&(e.beginPath(),e.rect(ne+ke,re,Y.width-ke,r),he&&(e.fillStyle=W.bgHeaderHasFocus,e.fill()),q>0&&(e.globalAlpha=q,e.fillStyle=W.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Pu(e,ne,re,Y.width,r,Y,me,W,ve,ve?G:void 0,ve?$:void 0,he,q,m,w,b),e.restore()}),o&&(k>1?Ma(e,t,l,u,I,k,i,g,m,f,v,C,p):Ra(e,t,l,u,s,i,g,m,f,v,C,p)),o&&(x??1)>1&&(e.beginPath(),e.moveTo(0,R+.5),e.lineTo(l,R+.5),e.strokeStyle=g.borderColor,e.lineWidth=1,e.stroke())}function Ra(e,t,n,o,i,l,u,r,s,a,d,h){var g;const[m,f]=(g=l==null?void 0:l[0])!==null&&g!==void 0?g:[];let v=0;Ca(t,n,o,i,(C,p,w,b,x,E)=>{var H,B,S;if(h!==void 0&&!h.hasItemInRectangle({x:C[0],y:-2,width:C[1]-C[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(w,b,x,E),e.clip();const D=d(p),k=(D==null?void 0:D.overrideTheme)===void 0?u:An(u,D.overrideTheme),I=f===-2&&m!==void 0&&m>=C[0]&&m<=C[1],R=I?(H=k.bgGroupHeaderHovered)!==null&&H!==void 0?H:k.bgHeaderHovered:(B=k.bgGroupHeader)!==null&&B!==void 0?B:k.bgHeader;if(R!==u.bgHeader&&(e.fillStyle=R,e.fill()),e.fillStyle=(S=k.textGroupHeader)!==null&&S!==void 0?S:k.textHeader,D!==void 0){const F=D.name,G=e.measureText(F).width,$=D.icon!==void 0?26:0,le=$+G,Y=w+(x-le)/2;if(D.icon!==void 0&&r.drawSprite(D.icon,"normal",e,Y,(i-20)/2,20,k),e.fillText(F,Y+$,i/2+un(e,u.headerFontFull)),D.actions!==void 0&&I){var z;const ne=or({x:w,y:b,width:x,height:E},D.actions);e.beginPath();const se=ne[0].x-10,X=w+x-se;e.rect(se,0,X,i);const oe=e.createLinearGradient(se,0,se+X,0),ae=ao(R,0);oe.addColorStop(0,ae),oe.addColorStop(10/X,R),oe.addColorStop(1,R),e.fillStyle=oe,e.fill(),e.globalAlpha=.6;const[de,pe]=(z=l==null?void 0:l[1])!==null&&z!==void 0?z:[-1,-1];for(let W=0;W<D.actions.length;W++){const me=D.actions[W],O=ne[W],ve=uo(O,de+w,pe);ve&&(e.globalAlpha=1),r.drawSprite(me.icon,"normal",e,O.x+O.width/2-10,O.y+O.height/2-10,20,k),ve&&(e.globalAlpha=.6)}e.globalAlpha=1}}w!==0&&a(C[0])&&(e.beginPath(),e.moveTo(w+.5,0),e.lineTo(w+.5,i),e.strokeStyle=u.borderColor,e.lineWidth=1,e.stroke()),e.restore(),v=w+x}),e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=u.borderColor,e.lineWidth=1,e.stroke()}function Ma(e,t,n,o,i,l,u,r,s,a,d,h,g){var m;const[f,v]=(m=u==null?void 0:u[0])!==null&&m!==void 0?m:[];e.font=r.headerFontFull;const C=i.reduce((w,b)=>w+b,0);g===void 0&&(e.fillStyle=r.bgHeader,e.fillRect(0,0,n,C));let p=0;if(ya(t,n,o,i,l,(w,b,x,E,H,B,S)=>{var D,k,I,R;const z=-(S+2);if(g!==void 0&&!g.hasItemInRectangle({x:w[0],y:z,width:w[1]-w[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(x,E,H,B),e.clip();const F=h(b),M=(F==null?void 0:F.overrideTheme)===void 0?r:An(r,F.overrideTheme),G=v===z&&f!==void 0&&f>=w[0]&&f<=w[1],$=G?(D=M.bgGroupHeaderHovered)!==null&&D!==void 0?D:M.bgHeaderHovered:(k=M.bgGroupHeader)!==null&&k!==void 0?k:M.bgHeader;e.fillStyle=$,e.fillRect(x,E,H,B),e.fillStyle=(I=M.textGroupHeader)!==null&&I!==void 0?I:M.textHeader;const le=(R=F==null?void 0:F.name)!==null&&R!==void 0?R:b,ne=e.measureText(le).width,se=(F==null?void 0:F.icon)!==void 0?26:0,X=se+ne,oe=x+(H-X)/2;if((F==null?void 0:F.icon)!==void 0&&s.drawSprite(F.icon,"normal",e,oe,E+(B-20)/2,20,M),e.fillText(le,oe+se,E+B/2+un(e,r.headerFontFull)),F!==void 0&&F.actions!==void 0&&G){var ae;const de=or({x,y:E,width:H,height:B},F.actions);e.beginPath();const pe=de[0].x-10,W=x+H-pe;e.rect(pe,E,W,B);const me=e.createLinearGradient(pe,0,pe+W,0),O=ao($,0);me.addColorStop(0,O),me.addColorStop(10/W,$),me.addColorStop(1,$),e.fillStyle=me,e.fill(),e.globalAlpha=.6;const[ve,q]=(ae=u==null?void 0:u[1])!==null&&ae!==void 0?ae:[-1,-1];for(let he=0;he<F.actions.length;he++){const K=F.actions[he],re=de[he],ke=uo(re,ve+x,q);ke&&(e.globalAlpha=1),s.drawSprite(K.icon,"normal",e,re.x+re.width/2-10,re.y+re.height/2-10,20,M),ke&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=r.borderColor,e.lineWidth=1,x!==0&&d(w[0])&&(e.beginPath(),e.moveTo(x+.5,E),e.lineTo(x+.5,E+B),e.stroke()),(S<l-1||g===void 0)&&(e.beginPath(),e.moveTo(x,E+B+.5),e.lineTo(x+H,E+B+.5),e.stroke()),e.restore(),p=Math.max(p,x+H)}),g===void 0){e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,C);let w=0;for(let b=0;b<l-1;b++)w+=i[b],e.moveTo(0,w+.5),e.lineTo(n,w+.5);e.strokeStyle=r.borderColor,e.lineWidth=1,e.stroke()}}const Yi=30;function Aa(e,t,n,o,i){return{x:e+n-Yi,y:Math.max(t,t+o/2-Yi/2),width:Yi,height:Math.min(Yi,o)}}function or(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,l=26,u=26;for(let r=0;r<t.length;r++)n.push({x:o,y:i,width:u,height:l}),o+=26;return n}function di(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function zu(e,t,n,o,i,l,u,r){var s,a;const d=u.cellHorizontalPadding,h=u.headerIconSize,g=Aa(n,o,i,l),m=e===void 0?(s=(a=Fu(t.title,u.headerFontFull))===null||a===void 0?void 0:a.width)!==null&&s!==void 0?s:0:Eo(t.title,e,u.headerFontFull).width,f=t.icon!==void 0?Math.ceil(h*1.3):0,v=f+m,C=n+Math.max(d,(i-v)/2),p=t.icon===void 0?void 0:{x:C,y:o+(l-h)/2,width:h,height:h},w=p===void 0||t.overlayIcon===void 0?void 0:{x:p.x+9,y:p.y+6,width:18,height:18},b={x:C+f,y:o,width:m,height:l};let x;t.indicatorIcon!==void 0&&(x={x:b.x+m+d,y:o+(l-h)/2,width:h,height:h});const E=n+i/2;return{menuBounds:di(g,E,r),iconBounds:di(p,E,r),iconOverlayBounds:di(w,E,r),textBounds:di(b,E,r),indicatorIconBounds:di(x,E,r)}}function $r(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v){if(l.rowMarker!==void 0&&l.headerRowMarkerDisabled!==!0){const w=l.rowMarkerChecked;w!==!0&&l.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=h);const b=l.headerRowMarkerTheme!==void 0?An(r,l.headerRowMarkerTheme):r;Ji(e,b,w,t,n,o,i,!1,void 0,void 0,r.checkboxMaxSize,"center",l.rowMarker),w!==!0&&l.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const C=u?r.textHeaderSelected:r.textHeader,p=l.hasMenu===!0&&(s||m&&u)&&v.menuBounds!==void 0;if(l.icon!==void 0&&v.iconBounds!==void 0){let w=u?"selected":"normal";l.style==="highlight"&&(w=u?"selected":"special"),g.drawSprite(l.icon,w,e,v.iconBounds.x,v.iconBounds.y,v.iconBounds.width,r),l.overlayIcon!==void 0&&v.iconOverlayBounds!==void 0&&g.drawSprite(l.overlayIcon,u?"selected":"special",e,v.iconOverlayBounds.x,v.iconOverlayBounds.y,v.iconOverlayBounds.width,r)}if(p&&o>35){const b=f?35:o-35,x=f?35*.7:o-35*.7,E=b/o,H=x/o,B=e.createLinearGradient(t,0,t+o,0),S=ao(C,0);B.addColorStop(f?1:0,C),B.addColorStop(E,C),B.addColorStop(H,S),B.addColorStop(f?0:1,S),e.fillStyle=B}else e.fillStyle=C;if(f&&(e.textAlign="right"),v.textBounds!==void 0&&e.fillText(l.title,f?v.textBounds.x+v.textBounds.width:v.textBounds.x,n+i/2+un(e,r.headerFontFull)),f&&(e.textAlign="left"),l.indicatorIcon!==void 0&&v.indicatorIconBounds!==void 0&&(!p||!gi(v.menuBounds.x,v.menuBounds.y,v.menuBounds.width,v.menuBounds.height,v.indicatorIconBounds.x,v.indicatorIconBounds.y,v.indicatorIconBounds.width,v.indicatorIconBounds.height))){let w=u?"selected":"normal";l.style==="highlight"&&(w=u?"selected":"special"),g.drawSprite(l.indicatorIcon,w,e,v.indicatorIconBounds.x,v.indicatorIconBounds.y,v.indicatorIconBounds.width,r)}if(p&&v.menuBounds!==void 0){const w=v.menuBounds,b=a!==void 0&&d!==void 0&&uo(w,a+t,d+n);if(b||(e.globalAlpha=.7),l.menuIcon===void 0||l.menuIcon===qi.Triangle){e.beginPath();const x=w.x+w.width/2-5.5,E=w.y+w.height/2-3;Pd(e,[{x,y:E},{x:x+11,y:E},{x:x+5.5,y:E+6}],1),e.fillStyle=C,e.fill()}else if(l.menuIcon===qi.Dots){e.beginPath();const x=w.x+w.width/2,E=w.y+w.height/2;zd(e,x,E),e.fillStyle=C,e.fill()}else{const x=w.x+(w.width-r.headerIconSize)/2,E=w.y+(w.height-r.headerIconSize)/2;g.drawSprite(l.menuIcon,"normal",e,x,E,r.headerIconSize,r)}b||(e.globalAlpha=1)}}function Pu(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v){const C=Zl(l.title)==="rtl",p=zu(e,l,t,n,o,i,r,C);if(f!==void 0){var w;f({ctx:e,theme:r,rect:{x:t,y:n,width:o,height:i},column:l,columnIndex:l.sourceIndex,isSelected:u,hoverAmount:g,isHovered:s,hasSelectedCell:h,spriteManager:m,menuBounds:(w=p==null?void 0:p.menuBounds)!==null&&w!==void 0?w:{x:0,y:0,height:0,width:0},hoverX:a,hoverY:d},()=>$r(e,t,n,o,i,l,u,r,s,a,d,g,m,v,C,p))}else $r(e,t,n,o,i,l,u,r,s,a,d,g,m,v,C,p)}function Ba(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C,p,w){if(p!==void 0||t[t.length-1]!==n[t.length-1])return;const b=Bu(C);co(t,s,u,r,l,(x,E,H,B,S)=>{if(x!==t[t.length-1])return;E+=x.width;const D=Math.max(E,B);D>o||(e.save(),e.beginPath(),e.rect(D,l+1,1e4,i-l-1),e.clip(),nl(S,H,i,a,d,f,v,b,(k,I,R,z)=>{if(!z&&C.length>0&&!C.some(le=>gi(E,k,1e4,R,le.x,le.y,le.width,le.height)))return;const F=g.hasIndex(I),M=m.hasIndex(I);e.beginPath();const G=h==null?void 0:h(I),$=G===void 0?w:An(w,G);$.bgCell!==w.bgCell&&(e.fillStyle=$.bgCell,e.fillRect(E,k,1e4,R)),M&&(e.fillStyle=$.bgHeader,e.fillRect(E,k,1e4,R)),F&&(e.fillStyle=$.accentLight,e.fillRect(E,k,1e4,R))}),e.restore())})}function Ia(e,t,n,o,i,l,u,r,s){var a;let d=!1;for(const v of t)if(!v.sticky){d=u(v.sourceIndex);break}const h=(a=s.horizontalBorderColor)!==null&&a!==void 0?a:s.borderColor,g=s.borderColor,m=d?jo(t):0;let f;if(m!==0&&(f=Pr(g,s.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=f,e.stroke()),i>0){const v=g===h&&f!==void 0?f:Pr(h,s.bgCell),C=bo(l,i,r);e.beginPath(),e.moveTo(0,o-C+.5),e.lineTo(n,o-C+.5),e.strokeStyle=v,e.stroke()}}const Lu=(e,t,n)=>{let o=0,i=t,l=0,u=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;for(const r of e)o=Math.min(o,r.x-1),i=Math.max(i,r.x+r.width+1),l=Math.min(l,r.y-1),u=Math.max(u,r.y+r.height+1)}return{minX:o,maxX:i,minY:l,maxY:u}};function Ha(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f){const v=f.bgCell,{minX:C,maxX:p,minY:w,maxY:b}=Lu(r,l,u),x=[],E=u-bo(m,g,a);let H=s,B=n,S=0;for(;H+i<E;){const z=H+i,F=a(B);if(z>=w&&z<=b-1){const M=d==null?void 0:d(B),G=M==null?void 0:M.bgCell;G!==void 0&&G!==v&&B>=m-g&&x.push({x:C,y:z,w:p-C,h:F,color:G})}H+=F,B<m-g&&(S=H),B++}let D=0;const k=Math.min(E,b)-S;if(k>0)for(let z=0;z<t.length;z++){var I;const F=t[z];if(F.width===0)continue;const M=F.sticky?D:D+o,G=(I=F.themeOverride)===null||I===void 0?void 0:I.bgCell;G!==void 0&&G!==v&&M>=C&&M<=p&&h(z+1)&&x.push({x:M,y:S,w:F.width,h:k,color:G}),D+=F.width}if(x.length===0)return;let R;e.beginPath();for(let z=x.length-1;z>=0;z--){const F=x[z];R===void 0?R=F.color:F.color!==R&&(e.fillStyle=R,e.fill(),e.beginPath(),R=F.color),e.rect(F.x,F.y,F.w,F.h)}R!==void 0&&(e.fillStyle=R,e.fill()),e.beginPath()}function Xr(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C){var p;let w=arguments.length>17&&arguments[17]!==void 0?arguments[17]:!1;if(s!==void 0){e.beginPath(),e.save(),e.rect(0,0,l,u);for(const M of s)e.rect(M.x+1,M.y+1,M.width-1,M.height-1);e.clip("evenodd")}const b=(p=C.horizontalBorderColor)!==null&&p!==void 0?p:C.borderColor,x=C.borderColor,{minX:E,maxX:H,minY:B,maxY:S}=Lu(r,l,u),D=[];e.beginPath();let k=.5;for(let M=0;M<t.length;M++){const G=t[M];if(G.width===0)continue;k+=G.width;const $=G.sticky?k:k+o;$>=E&&$<=H&&m(M+1)&&D.push({x1:$,y1:Math.max(a,B),x2:$,y2:Math.min(u,S),color:x})}let I=u+.5;for(let M=v-f;M<v;M++){const G=h(M);I-=G,D.push({x1:E,y1:I,x2:H,y2:I,color:b})}if(w!==!0){let M=d+.5,G=n;const $=I;for(;M+i<$;){const le=M+i;if(le>=B&&le<=S-1){var R,z;const Y=g==null?void 0:g(G);D.push({x1:E,y1:le,x2:H,y2:le,color:(R=(z=Y==null?void 0:Y.horizontalBorderColor)!==null&&z!==void 0?z:Y==null?void 0:Y.borderColor)!==null&&R!==void 0?R:b})}M+=h(G),G++}}const F=Ks(D,M=>M.color);for(const M of Object.keys(F)){e.strokeStyle=M;for(const G of F[M])e.moveTo(G.x1,G.y1),e.lineTo(G.x2,G.y2);e.stroke(),e.beginPath()}s!==void 0&&e.restore()}function Ta(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C,p,w){const b=[];e.imageSmoothingEnabled=!1;const x=Math.min(i.cellYOffset,u),E=Math.max(i.cellYOffset,u);let H=0;if(typeof p=="number")H+=(E-x)*p;else for(let F=x;F<E;F++)H+=p(F);u>i.cellYOffset&&(H=-H),H+=s-i.translateY;const B=Math.min(i.cellXOffset,l),S=Math.max(i.cellXOffset,l);let D=0;for(let F=B;F<S;F++)D+=v[F].width;l>i.cellXOffset&&(D=-D),D+=r-i.translateX;const k=jo(C);if(D!==0&&H!==0)return{regions:[]};const I=a>0?bo(g,a,p):0,R=d-k-Math.abs(D),z=h-m-I-Math.abs(H)-1;if(R>150&&z>150){const F={sx:0,sy:0,sw:d*f,sh:h*f,dx:0,dy:0,dw:d*f,dh:h*f};if(H>0?(F.sy=(m+1)*f,F.sh=z*f,F.dy=(H+m+1)*f,F.dh=z*f,b.push({x:0,y:m,width:d,height:H+1})):H<0&&(F.sy=(-H+m+1)*f,F.sh=z*f,F.dy=(m+1)*f,F.dh=z*f,b.push({x:0,y:h+H-I,width:d,height:-H+I})),D>0?(F.sx=k*f,F.sw=R*f,F.dx=(D+k)*f,F.dw=R*f,b.push({x:k-1,y:0,width:D+2,height:h})):D<0&&(F.sx=(k-D)*f,F.sw=R*f,F.dx=k*f,F.dw=R*f,b.push({x:d+D,y:0,width:-D,height:h})),e.setTransform(1,0,0,1,0,0),w){if(k>0&&D!==0&&H===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const M=k*f,G=h*f;e.drawImage(t,0,0,M,G,0,0,M,G)}if(I>0&&D===0&&H!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const M=(h-I)*f,G=d*f,$=I*f;e.drawImage(t,0,M,G,$,0,M,G,$)}}e.drawImage(t,F.sx,F.sy,F.sw,F.sh,F.dx,F.dy,F.dw,F.dh),e.scale(f,f)}return e.imageSmoothingEnabled=!0,{regions:b}}function za(e,t,n,o,i,l,u,r,s,a){const d=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||co(s,n,o,i,r,(h,g,m,f)=>{if(h.sourceIndex===a){const v=Math.max(g,f)+1;return d.push({x:v,y:0,width:l-v,height:u}),!0}}),d}function Pa(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],l=t.mappedColumns[o];if(Yo(i,l))continue;if(n!==void 0||i.width===l.width)return!1;const{width:u,...r}=i,{width:s,...a}=l;if(!Yo(r,a))return!1;n=o}return n===void 0?!0:n}return!0}function Kr(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C,p){const w=f==null?void 0:f.filter(D=>D.style!=="no-outline");if(w===void 0||w.length===0)return;const b=jo(r),x=bo(m,g,h),E=[s,0,r.length,m-g],H=[b,0,t,n-x],B=w.map(D=>{var k;const I=D.range,R=(k=D.style)!==null&&k!==void 0?k:"dashed";return Fa(I,E,t,n,H).map(z=>{const F=z.rect,M=Xl(F.x,F.y,t,n,d,a+d,o,i,l,u,m,s,g,r,h,C,p),G=F.width===1&&F.height===1?M:Xl(F.x+F.width-1,F.y+F.height-1,t,n,d,a+d,o,i,l,u,m,s,g,r,h,C,p);return F.x+F.width>=r.length&&(G.width-=1),F.y+F.height>=m&&(G.height-=1),{color:D.color,style:R,clip:z.clip,rect:xa({x:M.x,y:M.y,width:G.x+G.width-M.x,height:G.y+G.height-M.y},t,n,8)}})}),S=()=>{e.lineWidth=1;let D=!1;for(const k of B)for(const I of k)if((I==null?void 0:I.rect)!==void 0&&gi(0,0,t,n,I.rect.x,I.rect.y,I.rect.width,I.rect.height)){const R=D,z=!Ea(I.clip,I.rect);e.beginPath(),z&&(e.save(),e.rect(I.clip.x,I.clip.y,I.clip.width,I.clip.height),e.clip()),I.style==="dashed"&&!D?(e.setLineDash([5,3]),D=!0):(I.style==="solid"||I.style==="solid-outline")&&D&&(e.setLineDash([]),D=!1),e.strokeStyle=I.style==="solid-outline"?rn(rn(I.color,v.borderColor),v.bgCell):ao(I.color,1),e.closePath(),e.strokeRect(I.rect.x+.5,I.rect.y+.5,I.rect.width-1,I.rect.height-1),z&&(e.restore(),D=R)}D&&e.setLineDash([])};return S(),S}function Yr(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function Tl(e,t,n,o,i,l,u,r,s,a,d,h,g,m,f,v,C){var p;if(d.current===void 0)return;const w=v!==!1&&v!==void 0;if(!w)return;const b=typeof v=="object"?{..._i,...v}:_i,x=d.current.range,E=d.current.cell,H=[x.x+x.width-1,x.y+x.height-1];if(E[1]>=C&&H[1]>=C||!u.some($=>$.sourceIndex===E[0]||$.sourceIndex===H[0]))return;const[S,D]=d.current.cell,k=g(d.current.cell),I=(p=k.span)!==null&&p!==void 0?p:[S,S],R=D>=C-m,z=m>0&&!R?bo(C,m,h)-1:0,F=H[1];let M;if(co(u,o,i,l,a,($,le,Y,ne,se)=>{if($.sticky&&S>$.sourceIndex)return;const X=$.sourceIndex<I[0],oe=$.sourceIndex>I[1],ae=$.sourceIndex===H[0];if(!(!ae&&(X||oe)))return nl(se,Y,n,C,h,m,f,void 0,(de,pe,W)=>{if(pe!==D&&pe!==F)return;let me=le,O=$.width;if(k.span!==void 0){const q=Iu(k.span,le,de,$.width,W,$,r),he=$.sticky?q[0]:q[1];he!==void 0&&(me=he.x,O=he.width)}return pe===F&&ae&&w&&(M=()=>{var q,he;ne>me&&!$.sticky&&(e.beginPath(),e.rect(ne,0,t-ne,n),e.clip());const K=b.size,re=K/2,ke=me+O+b.offsetX-re+.5,J=de+W+b.offsetY-re+.5;e.beginPath(),b.shape==="circle"?e.arc(ke+re,J+re,re,0,Math.PI*2):e.rect(ke,J,K,K),e.fillStyle=(q=(he=$.themeOverride)===null||he===void 0?void 0:he.accentColor)!==null&&q!==void 0?q:s.accentColor,e.fill(),b.outline>0&&(e.lineWidth=b.outline,e.strokeStyle=s.bgCell,b.shape==="circle"?(e.beginPath(),e.arc(ke+re,J+re,re+b.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(ke-b.outline/2,J-b.outline/2,K+b.outline,K+b.outline))}),M!==void 0}),M!==void 0}),M===void 0)return;const G=()=>{var $;e.save(),e.beginPath(),e.rect(0,a,t,n-a-z),e.clip(),($=M)===null||$===void 0||$(),e.restore()};return G(),G}function La(e,t,n,o,i,l,u,r,s){s===void 0||s.size===0||(e.beginPath(),co(t,r,l,u,i,(a,d,h,g)=>{const m=Math.max(0,g-d),f=d+m+1,v=a.width-m-1;s.has([a.sourceIndex,-1])&&e.rect(f,o,v,i-o)}),e.clip())}function Oa(e,t,n,o,i,l,u,r,s,a){let d=0;return co(e,l,o,i,n,(h,g,m,f,v)=>(nl(v,m,t,u,r,s,a,void 0,(C,p,w,b)=>{b||(d=Math.max(p,d))}),!0)),d}function Vr(e,t){var n,o;const{canvasCtx:i,headerCanvasCtx:l,width:u,height:r,cellXOffset:s,cellYOffset:a,translateX:d,translateY:h,mappedColumns:g,enableGroups:m,freezeColumns:f,dragAndDropState:v,theme:C,drawFocus:p,headerHeight:w,groupHeaderHeight:b,groupLevels:x,groupHeaderHeights:E,disabledRows:H,rowHeight:B,verticalBorder:S,overrideCursor:D,isResizing:k,selection:I,fillHandle:R,freezeTrailingRows:z,rows:F,getCellContent:M,getGroupDetails:G,getRowThemeOverride:$,isFocused:le,drawHeaderCallback:Y,prelightCells:ne,drawCellCallback:se,highlightRegions:X,resizeCol:oe,imageLoader:ae,lastBlitData:de,hoverValues:pe,hyperWrapping:W,hoverInfo:me,spriteManager:O,maxScaleFactor:ve,hasAppendRow:q,touchMode:he,enqueue:K,renderStateProvider:re,getCellRenderer:ke,renderStrategy:J,bufferACtx:Be,bufferBCtx:Ve,damage:ce,minimumCellWidth:T,resizeIndicator:ie}=e;if(u===0||r===0)return;const ge=J==="double-buffer",_=Math.min(ve,Math.ceil((n=window.devicePixelRatio)!==null&&n!==void 0?n:1)),Me=J!=="direct"&&Pa(e,t),Se=i.canvas;(Se.width!==u*_||Se.height!==r*_)&&(Se.width=u*_,Se.height=r*_,Se.style.width=u+"px",Se.style.height=r+"px");const Fe=l.canvas,Ie=E.reduce((Pe,St)=>Pe+St,0),fe=w+Ie,Ee=fe+1;(Fe.width!==u*_||Fe.height!==Ee*_)&&(Fe.width=u*_,Fe.height=Ee*_,Fe.style.width=u+"px",Fe.style.height=Ee+"px");const Te=Be.canvas,We=Ve.canvas;ge&&(Te.width!==u*_||Te.height!==r*_)&&(Te.width=u*_,Te.height=r*_,de.current!==void 0&&(de.current.aBufferScroll=void 0)),ge&&(We.width!==u*_||We.height!==r*_)&&(We.width=u*_,We.height=r*_,de.current!==void 0&&(de.current.bBufferScroll=void 0));const Ce=de.current;if(Me===!0&&s===(Ce==null?void 0:Ce.cellXOffset)&&a===(Ce==null?void 0:Ce.cellYOffset)&&d===(Ce==null?void 0:Ce.translateX)&&h===(Ce==null?void 0:Ce.translateY))return;let Ke=null;ge&&(Ke=i);const tt=l;let Ue;ge?ce!==void 0?Ue=(Ce==null?void 0:Ce.lastBuffer)==="b"?Ve:Be:Ue=(Ce==null?void 0:Ce.lastBuffer)==="b"?Be:Ve:Ue=i;const Qe=Ue.canvas,ct=ge?Qe===Te?We:Te:Se,ft=typeof B=="number"?()=>B:B;tt.save(),Ue.save(),tt.beginPath(),Ue.beginPath(),tt.textBaseline="middle",Ue.textBaseline="middle",_!==1&&(tt.scale(_,_),Ue.scale(_,_));const _e=$l(g,s,u,v,d);let ht=[];const Le=p&&((o=I.current)===null||o===void 0?void 0:o.cell[1])===a&&h===0;let lt=!1;if(X!==void 0){for(const Pe of X)if(Pe.style!=="no-outline"&&Pe.range.y===a&&h===0){lt=!0;break}}const Mt=()=>{var Pe,St;tt.fillStyle=C.bgHeader,tt.fillRect(0,0,u,fe+1),Sa(tt,_e,g,m,me,u,d,w,b,v,k,I,C,O,pe,S,G,ce,Y,he,x,E),Xr(tt,_e,a,d,h,u,r,void 0,void 0,Ie,fe,ft,$,S,z,F,C,!0),tt.beginPath(),tt.moveTo(0,Ee-.5),tt.lineTo(u,Ee-.5),tt.strokeStyle=rn((Pe=(St=C.headerBottomBorderColor)!==null&&St!==void 0?St:C.horizontalBorderColor)!==null&&Pe!==void 0?Pe:C.borderColor,C.bgHeader),tt.stroke(),lt&&Kr(tt,u,r,s,a,d,h,g,f,w,Ie,B,z,F,X,C,x,E),Le&&Tl(tt,u,r,a,d,h,_e,g,C,fe,I,ft,M,z,q,R,F)};if(ce!==void 0){const Pe=_e[_e.length-1].sourceIndex+1,St=ce.hasItemInRegion([{x:s,y:-2,width:Pe,height:2},{x:s,y:a,width:Pe,height:300},{x:0,y:a,width:f,height:300},{x:0,y:-2,width:f,height:2},{x:s,y:F-z,width:Pe,height:z,when:z>0}]),Bt=Vt=>{Gr(Vt,_e,g,r,fe,d,h,a,F,ft,M,G,$,H,le,p,z,q,ht,ce,I,ne,X,ae,O,pe,me,se,W,C,K,re,ke,D,T);const mn=I.current;R!==!1&&R!==void 0&&p&&mn!==void 0&&ce.has(bu(mn.range))&&Tl(Vt,u,r,a,d,h,_e,g,C,fe,I,ft,M,z,q,R,F)};St&&(Bt(Ue),Ke!==null&&(Ke.save(),Ke.scale(_,_),Ke.textBaseline="middle",Bt(Ke),Ke.restore()),ce.hasHeader()&&(La(tt,_e,u,Ie,fe,d,h,a,ce),Mt())),Ue.restore(),tt.restore();return}if((Me!==!0||s!==(Ce==null?void 0:Ce.cellXOffset)||a!==(Ce==null?void 0:Ce.cellYOffset)||d!==(Ce==null?void 0:Ce.translateX)||h!==(Ce==null?void 0:Ce.translateY)||Le!==(Ce==null?void 0:Ce.mustDrawFocusOnHeader)||lt!==(Ce==null?void 0:Ce.mustDrawHighlightRingsOnHeader))&&Mt(),Me===!0){ln(ct!==void 0&&Ce!==void 0);const{regions:Pe}=Ta(Ue,ct,ct===Te?Ce.aBufferScroll:Ce.bBufferScroll,ct===Te?Ce.bBufferScroll:Ce.aBufferScroll,Ce,s,a,d,h,z,u,r,F,fe,_,g,_e,B,ge);ht=Pe}else Me!==!1&&(ln(Ce!==void 0),ht=za(Ce,s,a,d,h,u,r,fe,_e,Me));Ia(Ue,_e,u,r,z,F,S,ft,C);const At=Kr(Ue,u,r,s,a,d,h,g,f,w,Ie,B,z,F,X,C,x,E),bt=p?Tl(Ue,u,r,a,d,h,_e,g,C,fe,I,ft,M,z,q,R,F):void 0;if(Ue.fillStyle=C.bgCell,ht.length>0){Ue.beginPath();for(const Pe of ht)Ue.rect(Pe.x,Pe.y,Pe.width,Pe.height);Ue.clip(),Ue.fill(),Ue.beginPath()}else Ue.fillRect(0,0,u,r);const Lt=Gr(Ue,_e,g,r,fe,d,h,a,F,ft,M,G,$,H,le,p,z,q,ht,ce,I,ne,X,ae,O,pe,me,se,W,C,K,re,ke,D,T);Ba(Ue,_e,g,u,r,fe,d,h,a,F,ft,$,I.rows,H,z,q,ht,ce,C),Ha(Ue,_e,a,d,h,u,r,ht,fe,ft,$,S,z,F,C),Xr(Ue,_e,a,d,h,u,r,ht,Lt,Ie,fe,ft,$,S,z,F,C),At==null||At(),bt==null||bt(),k&&ie!=="none"&&co(_e,0,d,0,fe,(Pe,St)=>{if(Pe.sourceIndex===oe){var Bt;if(Yr(tt,St+Pe.width,0,fe+1,rn((Bt=C.resizeIndicatorColor)!==null&&Bt!==void 0?Bt:C.accentLight,C.bgHeader)),ie==="full"){var Vt;Yr(Ue,St+Pe.width,fe,r,rn((Vt=C.resizeIndicatorColor)!==null&&Vt!==void 0?Vt:C.accentLight,C.bgCell))}return!0}return!1}),Ke!==null&&(Ke.fillStyle=C.bgCell,Ke.fillRect(0,0,u,r),Ke.drawImage(Ue.canvas,0,0));const wt=Oa(_e,r,fe,d,h,a,F,ft,z,q);ae==null||ae.setWindow({x:s,y:a,width:_e.length,height:wt-a},f,Array.from({length:z},(Pe,St)=>F-1-St));const Zt=Ce!==void 0&&(s!==Ce.cellXOffset||d!==Ce.translateX),dn=Ce!==void 0&&(a!==Ce.cellYOffset||h!==Ce.translateY);de.current={cellXOffset:s,cellYOffset:a,translateX:d,translateY:h,mustDrawFocusOnHeader:Le,mustDrawHighlightRingsOnHeader:lt,lastBuffer:ge?Qe===Te?"a":"b":void 0,aBufferScroll:Qe===Te?[Zt,dn]:Ce==null?void 0:Ce.aBufferScroll,bBufferScroll:Qe===We?[Zt,dn]:Ce==null?void 0:Ce.bBufferScroll},Ue.restore(),tt.restore()}const Wa=80;function Na(e){const t=e-1;return t*t*t+1}class Ga{constructor(t){this.callback=void 0,this.currentHoveredItem=void 0,this.leavingItems=[],this.lastAnimationTime=void 0,this.addToLeavingItems=n=>{this.leavingItems.some(i=>ci(i.item,n.item))||this.leavingItems.push(n)},this.removeFromLeavingItems=n=>{var o;const i=this.leavingItems.find(l=>ci(l.item,n));return this.leavingItems=this.leavingItems.filter(l=>l!==i),(o=i==null?void 0:i.hoverAmount)!==null&&o!==void 0?o:0},this.cleanUpLeavingElements=()=>{this.leavingItems=this.leavingItems.filter(n=>n.hoverAmount>0)},this.shouldStep=()=>{const n=this.leavingItems.length>0,o=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return n||o},this.getAnimatingItems=()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(n=>({...n,hoverAmount:Na(n.hoverAmount)})),this.step=n=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=n;else{const i=(n-this.lastAnimationTime)/Wa;for(const u of this.leavingItems)u.hoverAmount=vn(u.hoverAmount-i,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=vn(this.currentHoveredItem.hoverAmount+i,0,1));const l=this.getAnimatingItems();this.callback(l),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=n,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0},this.setHovered=n=>{var o;if(!ci((o=this.currentHoveredItem)===null||o===void 0?void 0:o.item,n)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),n!==void 0){const i=this.removeFromLeavingItems(n);this.currentHoveredItem={item:n,hoverAmount:i}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}},this.callback=t}}class $a{constructor(t){this.fn=void 0,this.val=void 0,this.fn=t}get value(){var t;return(t=this.val)!==null&&t!==void 0?t:this.val=this.fn()}}function ir(e){return new $a(e)}const Xa=ir(()=>window.navigator.userAgent.includes("Firefox")),Qi=ir(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),ol=ir(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Ka(e){const t=c.useRef([]),n=c.useRef(0),o=c.useRef(e);o.current=e;const i=c.useCallback(()=>{const l=()=>window.requestAnimationFrame(u),u=()=>{const r=t.current.map(nr);t.current=[],o.current(new Ko(r)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?l:u)},[]);return c.useCallback(l=>{t.current.length===0&&i();const u=yn(l[0],l[1]);t.current.includes(u)||t.current.push(u)},[i])}const ro="header",bn="group-header",el="out-of-bounds";var Xo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Xo||(Xo={}));function Ou(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Ya=(e,t)=>{var n;if(e.kind===te.Custom)return e.copyData;const o=t==null?void 0:t(e);return(n=o==null?void 0:o.getAccessibilityString(e))!==null&&n!==void 0?n:""},Va=(e,t)=>{var n,o,i,l,u,r,s,a,d,h,g;const{width:m,height:f,accessibilityHeight:v,columns:C,cellXOffset:p,cellYOffset:w,headerHeight:b,fillHandle:x=!1,groupHeaderHeight:E,groupLevels:H,groupHeaderHeights:B,rowHeight:S,rows:D,getCellContent:k,getRowThemeOverride:I,onHeaderMenuClick:R,onHeaderIndicatorClick:z,enableGroups:F,isFilling:M,onCanvasFocused:G,onCanvasBlur:$,isFocused:le,selection:Y,freezeColumns:ne,onContextMenu:se,freezeTrailingRows:X,fixedShadowX:oe=!0,fixedShadowY:ae=!0,drawFocusRing:de,onMouseDown:pe,onMouseUp:W,onMouseMoveRaw:me,onMouseMove:O,onItemHovered:ve,dragAndDropState:q,firstColAccessible:he,onKeyDown:K,onKeyUp:re,highlightRegions:ke,canvasRef:J,onDragStart:Be,onDragEnd:Ve,eventTargetRef:ce,isResizing:T,resizeColumn:ie,isDragging:ge,isDraggable:_=!1,allowResize:Me,disabledRows:Se,hasAppendRow:Fe,getGroupDetails:Ie,theme:fe,prelightCells:Ee,headerIcons:Te,verticalBorder:We,drawCell:Ce,drawHeader:Ke,onCellFocused:tt,onDragOverCell:Ue,onDrop:Qe,onDragLeave:ct,imageWindowLoader:ft,smoothScrollX:_e=!1,smoothScrollY:ht=!1,experimental:Le,getCellRenderer:lt,resizeIndicator:Mt="full"}=e,At=(n=e.translateX)!==null&&n!==void 0?n:0,bt=(o=e.translateY)!==null&&o!==void 0?o:0,Lt=Math.max(ne,Math.min(C.length-1,p)),wt=c.useRef(null),Zt=c.useRef((i=Le==null?void 0:Le.eventTarget)!==null&&i!==void 0?i:window),dn=Zt.current,Pe=ft,St=c.useRef(),[Bt,Vt]=c.useState(!1),mn=c.useRef([]),In=c.useRef(),[en,Hn]=c.useState(),[Yt,Jt]=c.useState(),Ne=c.useRef(null),[Ct,rt]=c.useState(),[Gt,Kt]=c.useState(!1),gt=c.useRef(Gt);gt.current=Gt;const Yn=c.useMemo(()=>new pa(Te,()=>{$t.current=void 0,fo.current()}),[Te]),il=F?B.reduce((P,V)=>P+V,0):0,Vn=b+il,Un=c.useRef(-1),_o=((l=Le==null?void 0:Le.enableFirefoxRescaling)!==null&&l!==void 0?l:!1)&&Xa.value,Rt=((u=Le==null?void 0:Le.enableSafariRescaling)!==null&&u!==void 0?u:!1)&&Qi.value;c.useLayoutEffect(()=>{window.devicePixelRatio===1||!_o&&!Rt||(Un.current!==-1&&Vt(!0),window.clearTimeout(Un.current),Un.current=window.setTimeout(()=>{Vt(!1),Un.current=-1},200))},[w,Lt,At,bt,_o,Rt]);const vt=xd(C,ne),Zo=c.useMemo(()=>oe?jo(vt,q):0,[vt,q,oe]),Tt=c.useCallback((P,V,be)=>{const De=P.getBoundingClientRect();if(V>=vt.length||be>=D)return;const we=De.width/m,Re=Xl(V,be,m,f,E,Vn,Lt,w,At,bt,D,ne,X,vt,S,H,B);return we!==1&&(Re.x*=we,Re.y*=we,Re.width*=we,Re.height*=we),Re.x+=De.x,Re.y+=De.y,Re},[m,f,E,Vn,Lt,w,At,bt,D,ne,X,vt,S,H,B]),zt=c.useCallback((P,V,be,De)=>{const we=P.getBoundingClientRect(),Re=we.width/m,Oe=(V-we.left)/Re,nt=(be-we.top)/Re,ye=5,xt=$l(vt,Lt,m,void 0,At);let Xe=0,$e=0;const Ft=typeof PointerEvent<"u"&&De instanceof PointerEvent&&De.pointerType==="mouse"||typeof MouseEvent<"u"&&De instanceof MouseEvent,U=typeof PointerEvent<"u"&&De instanceof PointerEvent&&De.pointerType==="touch"||typeof TouchEvent<"u"&&De instanceof TouchEvent;Ft&&(Xe=De.button,$e=De.buttons);const ot=Sd(Oe,xt,At),Ye=Rd(nt,f,F,b,E,D,S,w,bt,X,H,B),jt=(De==null?void 0:De.shiftKey)===!0,Ht=(De==null?void 0:De.ctrlKey)===!0,hn=(De==null?void 0:De.metaKey)===!0,En=[Oe<0?-1:m<Oe?1:0,nt<Vn?-1:f<nt?1:0];let tn;if(ot===-1||nt<0||Oe<0||Ye===void 0||Oe>m||nt>f){const dt=Oe>m?1:Oe<0?-1:0,xe=nt>f?1:nt<0?-1:0;let Xt=dt*2,nn=xe*2;dt===0&&(Xt=ot===-1?Xo.EndPadding:Xo.Center),xe===0&&(nn=Ye===void 0?Xo.EndPadding:Xo.Center);let on=!1;if(ot===-1&&Ye===-1){const pn=Tt(P,vt.length-1,-1);ln(pn!==void 0),on=V<pn.x+pn.width+ye}const vo=Oe>m&&Oe<m+Nl()||nt>f&&nt<f+Nl();tn={kind:el,location:[ot!==-1?ot:Oe<0?0:vt.length-1,Ye??D-1],region:[Xt,nn],shiftKey:jt,ctrlKey:Ht,metaKey:hn,isEdge:on,isTouch:U,button:Xe,buttons:$e,scrollEdge:En,isMaybeScrollbar:vo}}else if(Ye<=-1){let dt=Tt(P,ot,Ye);ln(dt!==void 0);let xe=dt!==void 0&&dt.x+dt.width-V<=ye;const Xt=F&&Ye<=-2,nn=Xt?-(Ye+2):void 0,on=ot-1;V-dt.x<=ye&&on>=0?(xe=!0,dt=Tt(P,on,Ye),ln(dt!==void 0),tn={kind:Xt?bn:ro,location:[on,Ye],bounds:dt,group:yo(vt[on].group,nn),isEdge:xe,shiftKey:jt,ctrlKey:Ht,metaKey:hn,isTouch:U,localEventX:V-dt.x,localEventY:be-dt.y,button:Xe,buttons:$e,scrollEdge:En}):tn={kind:Xt?bn:ro,group:yo(vt[ot].group,nn),location:[ot,Ye],bounds:dt,isEdge:xe,shiftKey:jt,ctrlKey:Ht,metaKey:hn,isTouch:U,localEventX:V-dt.x,localEventY:be-dt.y,button:Xe,buttons:$e,scrollEdge:En}}else{const dt=Tt(P,ot,Ye);ln(dt!==void 0);const xe=dt!==void 0&&dt.x+dt.width-V<ye;let Xt=!1;if(x!==!1&&x!==void 0&&Y.current!==void 0){const on=typeof x=="object"?{..._i,...x}:_i,vo=on.size,pn=vo/2,On=bu(Y.current.range),Jn=Tt(P,On[0],On[1]);if(Jn!==void 0){const hl=Jn.x+Jn.width+on.offsetX-pn+.5,gl=Jn.y+Jn.height+on.offsetY-pn+.5;Xt=Math.abs(hl-V)<vo&&Math.abs(gl-be)<vo}}tn={kind:"cell",location:[ot,Ye],bounds:dt,isEdge:xe,shiftKey:jt,ctrlKey:Ht,isFillHandle:Xt,metaKey:hn,isTouch:U,localEventX:V-dt.x,localEventY:be-dt.y,button:Xe,buttons:$e,scrollEdge:En}}return tn},[m,vt,Lt,At,f,F,b,E,D,S,w,bt,X,Tt,x,Y,Vn,H,B]),[Ut]=en??[],vi=c.useRef(()=>{}),jn=c.useRef(en);jn.current=en;const[an,cn]=c.useMemo(()=>{const P=document.createElement("canvas"),V=document.createElement("canvas");return P.style.display="none",P.style.opacity="0",P.style.position="fixed",V.style.display="none",V.style.opacity="0",V.style.position="fixed",[P.getContext("2d",{alpha:!1}),V.getContext("2d",{alpha:!1})]},[]);c.useLayoutEffect(()=>{if(!(an===null||cn===null))return document.documentElement.append(an.canvas),document.documentElement.append(cn.canvas),()=>{an.canvas.remove(),cn.canvas.remove()}},[an,cn]);const Tn=c.useMemo(()=>new Ld,[]),xo=_o&&Bt?1:Rt&&Bt?2:5,mi=(Le==null?void 0:Le.disableMinimumCellWidth)===!0?1:10,$t=c.useRef(),Fo=c.useRef(null),Do=c.useRef(null),ko=c.useCallback(()=>{var P,V,be;const De=wt.current,we=Ne.current;if(De===null||we===null||(Fo.current===null&&(Fo.current=De.getContext("2d",{alpha:!1}),De.width=0,De.height=0),Do.current===null&&(Do.current=we.getContext("2d",{alpha:!1}),we.width=0,we.height=0),Fo.current===null||Do.current===null||an===null||cn===null))return;let Re=!1;const Oe=xt=>{Re=!0,rt(xt)},nt=$t.current,ye={headerCanvasCtx:Do.current,canvasCtx:Fo.current,bufferACtx:an,bufferBCtx:cn,width:m,height:f,cellXOffset:Lt,cellYOffset:w,translateX:Math.round(At),translateY:Math.round(bt),mappedColumns:vt,enableGroups:F,freezeColumns:ne,dragAndDropState:q,theme:fe,headerHeight:b,groupHeaderHeight:E,groupLevels:H,groupHeaderHeights:B,disabledRows:Se??Je.empty(),rowHeight:S,verticalBorder:We,isResizing:T,resizeCol:ie,isFocused:le,selection:Y,fillHandle:x,drawCellCallback:Ce,hasAppendRow:Fe,overrideCursor:Oe,maxScaleFactor:xo,freezeTrailingRows:X,rows:D,drawFocus:de,getCellContent:k,getGroupDetails:Ie??(xt=>({name:xt})),getRowThemeOverride:I,drawHeaderCallback:Ke,prelightCells:Ee,highlightRegions:ke,imageLoader:Pe,lastBlitData:In,damage:St.current,hoverValues:mn.current,hoverInfo:jn.current,spriteManager:Yn,scrolling:Bt,hyperWrapping:(P=Le==null?void 0:Le.hyperWrapping)!==null&&P!==void 0?P:!1,touchMode:Gt,enqueue:vi.current,renderStateProvider:Tn,renderStrategy:(V=Le==null?void 0:Le.renderStrategy)!==null&&V!==void 0?V:Qi.value?"double-buffer":"single-buffer",getCellRenderer:lt,minimumCellWidth:mi,resizeIndicator:Mt};ye.damage===void 0?($t.current=ye,Vr(ye,nt)):Vr(ye,void 0),!Re&&(ye.damage===void 0||ye.damage.has(jn==null||(be=jn.current)===null||be===void 0?void 0:be[0]))&&rt(void 0)},[an,cn,m,f,Lt,w,At,bt,vt,F,ne,q,fe,b,E,H,B,Se,S,We,T,Fe,ie,le,Y,x,X,D,de,xo,k,Ie,I,Ce,Ke,Ee,ke,Pe,Yn,Bt,Le==null?void 0:Le.hyperWrapping,Le==null?void 0:Le.renderStrategy,Gt,Tn,lt,mi,Mt]),fo=c.useRef(ko);c.useLayoutEffect(()=>{ko(),fo.current=ko},[ko]),c.useLayoutEffect(()=>{(async()=>{var V;((V=document)===null||V===void 0||(V=V.fonts)===null||V===void 0?void 0:V.ready)!==void 0&&(await document.fonts.ready,$t.current=void 0,fo.current())})()},[]);const qn=c.useCallback(P=>{St.current=P,fo.current(),St.current=void 0},[]),ll=Ka(qn);vi.current=ll;const wi=c.useCallback(P=>{qn(new Ko(P.map(V=>V.cell)))},[qn]);Pe.setCallback(qn);const[Jo,rl]=c.useState(!1),[zn,_n]=Ut??[],ul=zn!==void 0&&_n===-1&&zn>=0&&zn<vt.length&&vt[zn].headerRowMarkerDisabled!==!0,sl=zn!==void 0&&_n===-2;let pi=!1,Ci=!1,So=Ct;if(So===void 0&&zn!==void 0&&_n!==void 0&&_n>-1&&_n<D){const P=k([zn,_n],!0);pi=P.kind===Nt.NewRow||P.kind===Nt.Marker&&P.markerKind!=="number",Ci=P.kind===te.Boolean&&jl(P),So=P.cursor}const yi=ge?"grabbing":(Yt??!1)||T?"col-resize":Jo||M?"crosshair":So!==void 0?So:ul||pi||Ci||sl?"pointer":"default",Ro=c.useMemo(()=>({contain:"strict",display:"block",cursor:yi}),[yi]),bi=c.useRef("default"),Qo=ce==null?void 0:ce.current;Qo!=null&&bi.current!==Ro.cursor&&(Qo.style.cursor=bi.current=Ro.cursor);const Mo=c.useCallback((P,V,be,De)=>{if(Ie===void 0)return;const we=Ie(P);if(we.actions!==void 0){const Re=or(V,we.actions);for(const[Oe,nt]of Re.entries())if(uo(nt,be+V.x,De+nt.y))return we.actions[Oe]}},[Ie]),Pn=c.useCallback((P,V,be,De)=>{const we=vt[V];if(!ge&&!T&&!(Yt??!1)){const Re=Tt(P,V,-1);ln(Re!==void 0);const Oe=zu(void 0,we,Re.x,Re.y,Re.width,Re.height,fe,Zl(we.title)==="rtl");if(we.hasMenu===!0&&Oe.menuBounds!==void 0&&uo(Oe.menuBounds,be,De))return{area:"menu",bounds:Oe.menuBounds};if(we.indicatorIcon!==void 0&&Oe.indicatorIconBounds!==void 0&&uo(Oe.indicatorIconBounds,be,De))return{area:"indicator",bounds:Oe.indicatorIconBounds}}},[vt,Tt,Yt,ge,T,fe]),ei=c.useRef(0),Zn=c.useRef(),Ao=c.useRef(!1),Bo=c.useCallback(P=>{const V=wt.current,be=ce==null?void 0:ce.current;if(V===null||P.target!==V&&P.target!==be)return;Ao.current=!0;const De=P.clientX,we=P.clientY;if(P.target===be&&be!==null){const Oe=be.getBoundingClientRect();if(De>Oe.right||we>Oe.bottom)return}const Re=zt(V,De,we,P);Zn.current=Re.location,Re.isTouch&&(ei.current=Date.now()),gt.current!==Re.isTouch&&Kt(Re.isTouch),!(Re.kind===ro&&Pn(V,Re.location[0],De,we)!==void 0)&&(Re.kind===bn&&Mo(Re.group,Re.bounds,Re.localEventX,Re.localEventY)!==void 0||(pe==null||pe(Re),!Re.isTouch&&_!==!0&&_!==Re.kind&&Re.button<3&&Re.button!==1&&P.preventDefault()))},[ce,_,zt,Mo,Pn,pe]);qt("pointerdown",Bo,dn,!1);const Io=c.useRef(0),ti=c.useCallback(P=>{const V=Io.current;Io.current=Date.now();const be=wt.current;if(Ao.current=!1,W===void 0||be===null)return;const De=ce==null?void 0:ce.current,we=P.target!==be&&P.target!==De,Re=P.clientX,Oe=P.clientY,nt=P.pointerType==="mouse"?P.button<3:!0;let ye=zt(be,Re,Oe,P);ye.isTouch&&ei.current!==0&&Date.now()-ei.current>500&&(ye={...ye,isLongTouch:!0}),V!==0&&Date.now()-V<(ye.isTouch?1e3:500)&&(ye={...ye,isDoubleClick:!0}),gt.current!==ye.isTouch&&Kt(ye.isTouch),!we&&P.cancelable&&nt&&P.preventDefault();const[xt]=ye.location,Xe=Pn(be,xt,Re,Oe);if(ye.kind===ro&&Xe!==void 0){var $e,Ft;(ye.button!==0||(($e=Zn.current)===null||$e===void 0?void 0:$e[0])!==xt||((Ft=Zn.current)===null||Ft===void 0?void 0:Ft[1])!==-1)&&W(ye,!0);return}else if(ye.kind===bn){const U=Mo(ye.group,ye.bounds,ye.localEventX,ye.localEventY);if(U!==void 0){ye.button===0&&U.onClick(ye);return}}W(ye,we)},[W,ce,zt,Pn,Mo]);qt("pointerup",ti,dn,!1);const Ei=c.useCallback(P=>{const V=wt.current;if(V===null)return;const be=ce==null?void 0:ce.current,De=P.target!==V&&P.target!==be;let we,Re,Oe=!0;P instanceof MouseEvent?(we=P.clientX,Re=P.clientY,Oe=P.button<3):(we=P.changedTouches[0].clientX,Re=P.changedTouches[0].clientY);const nt=zt(V,we,Re,P);gt.current!==nt.isTouch&&Kt(nt.isTouch),!De&&P.cancelable&&Oe&&P.preventDefault();const[ye]=nt.location;if(nt.kind===ro){var xt,Xe;const $e=Pn(V,ye,we,Re);$e!==void 0&&nt.button===0&&((xt=Zn.current)===null||xt===void 0?void 0:xt[0])===ye&&((Xe=Zn.current)===null||Xe===void 0?void 0:Xe[1])===-1&&($e.area==="menu"?R==null||R(ye,$e.bounds):$e.area==="indicator"&&(z==null||z(ye,$e.bounds)))}},[ce,zt,Pn,R,z]);qt("click",Ei,dn,!1);const Ge=c.useCallback(P=>{const V=wt.current,be=ce==null?void 0:ce.current;if(V===null||P.target!==V&&P.target!==be||se===void 0)return;const De=zt(V,P.clientX,P.clientY,P);se(De,()=>{P.cancelable&&P.preventDefault()})},[ce,zt,se]);qt("contextmenu",Ge,(r=ce==null?void 0:ce.current)!==null&&r!==void 0?r:null,!1);const xi=c.useCallback(P=>{St.current=new Ko(P.map(V=>V.item)),mn.current=P,fo.current(),St.current=void 0},[]),ho=c.useMemo(()=>new Ga(xi),[xi]),fn=c.useRef(ho);fn.current=ho,c.useLayoutEffect(()=>{const P=fn.current;if(Ut===void 0||Ut[1]<0){P.setHovered(Ut);return}const V=k(Ut,!0),be=lt(V),De=be===void 0&&V.kind===te.Custom||(be==null?void 0:be.needsHover)!==void 0&&(typeof be.needsHover=="boolean"?be.needsHover:be.needsHover(V));P.setHovered(De?Ut:void 0)},[k,lt,Ut]);const wn=c.useRef(),ni=c.useCallback(P=>{const V=wt.current;if(V===null)return;const be=ce==null?void 0:ce.current,De=P.target!==V&&P.target!==be,we=zt(V,P.clientX,P.clientY,P);if(we.kind!=="out-of-bounds"&&De&&!Ao.current&&!we.isTouch)return;const Re=(ye,xt)=>{Hn(Xe=>Xe===ye||(Xe==null?void 0:Xe[0][0])===(ye==null?void 0:ye[0][0])&&(Xe==null?void 0:Xe[0][1])===(ye==null?void 0:ye[0][1])&&((Xe==null?void 0:Xe[1][0])===(ye==null?void 0:ye[1][0])&&(Xe==null?void 0:Xe[1][1])===(ye==null?void 0:ye[1][1])||!xt)?Xe:ye)};if(!Ou(we,wn.current))rt(void 0),ve==null||ve(we),Re(we.kind===el?void 0:[we.location,[we.localEventX,we.localEventY]],!0),wn.current=we;else if(we.kind==="cell"||we.kind===ro||we.kind===bn){let ye=!1,xt=!0;if(we.kind==="cell"){var Oe;const $e=k(we.location),Ft=(Oe=lt($e))===null||Oe===void 0?void 0:Oe.needsHoverPosition;xt=Ft??$e.kind===te.Custom,ye=xt}else ye=!0;const Xe=[we.location,[we.localEventX,we.localEventY]];Re(Xe,xt),jn.current=Xe,ye&&qn(new Ko([we.location]))}const nt=we.location[0]>=(he?0:1);Jt(we.kind===ro&&we.isEdge&&nt&&Me===!0),rl(we.kind==="cell"&&we.isFillHandle),me==null||me(P),O(we)},[ce,zt,he,Me,me,O,ve,k,lt,qn]);qt("pointermove",ni,dn,!0);const Fi=c.useCallback(P=>{const V=wt.current;if(V===null)return;let be,De;Y.current!==void 0&&(be=Tt(V,Y.current.cell[0],Y.current.cell[1]),De=Y.current.cell),K==null||K({bounds:be,stopPropagation:()=>P.stopPropagation(),preventDefault:()=>P.preventDefault(),cancel:()=>{},ctrlKey:P.ctrlKey,metaKey:P.metaKey,shiftKey:P.shiftKey,altKey:P.altKey,key:P.key,keyCode:P.keyCode,rawEvent:P,location:De})},[K,Y,Tt]),Di=c.useCallback(P=>{const V=wt.current;if(V===null)return;let be,De;Y.current!==void 0&&(be=Tt(V,Y.current.cell[0],Y.current.cell[1]),De=Y.current.cell),re==null||re({bounds:be,stopPropagation:()=>P.stopPropagation(),preventDefault:()=>P.preventDefault(),cancel:()=>{},ctrlKey:P.ctrlKey,metaKey:P.metaKey,shiftKey:P.shiftKey,altKey:P.altKey,key:P.key,keyCode:P.keyCode,rawEvent:P,location:De})},[re,Y,Tt]),ki=c.useCallback(P=>{if(wt.current=P,J!==void 0&&(J.current=P),Le!=null&&Le.eventTarget)Zt.current=Le.eventTarget;else if(P===null)Zt.current=window;else{const V=P.getRootNode();V===document&&(Zt.current=window),Zt.current=V}},[J,Le==null?void 0:Le.eventTarget]),dl=c.useCallback(P=>{const V=wt.current;if(V===null||_===!1||T){P.preventDefault();return}let be,De;const we=zt(V,P.clientX,P.clientY);if(_!==!0&&we.kind!==_){P.preventDefault();return}const Re=(Ft,U)=>{be=Ft,De=U};let Oe,nt,ye;const xt=(Ft,U,ot)=>{Oe=Ft,nt=U,ye=ot};let Xe=!1;if(Be==null||Be({...we,setData:Re,setDragImage:xt,preventDefault:()=>Xe=!0,defaultPrevented:()=>Xe}),!Xe&&be!==void 0&&De!==void 0&&P.dataTransfer!==null)if(P.dataTransfer.setData(be,De),P.dataTransfer.effectAllowed="copyLink",Oe!==void 0&&nt!==void 0&&ye!==void 0)P.dataTransfer.setDragImage(Oe,nt,ye);else{const[Ft,U]=we.location;if(U!==void 0){var $e;const ot=document.createElement("canvas"),Ye=Tt(V,Ft,U);ln(Ye!==void 0);const jt=Math.ceil(($e=window.devicePixelRatio)!==null&&$e!==void 0?$e:1);ot.width=Ye.width*jt,ot.height=Ye.height*jt;const Ht=ot.getContext("2d");Ht!==null&&(Ht.scale(jt,jt),Ht.textBaseline="middle",U===-1?(Ht.font=fe.headerFontFull,Ht.fillStyle=fe.bgHeader,Ht.fillRect(0,0,ot.width,ot.height),Pu(Ht,0,0,Ye.width,Ye.height,vt[Ft],!1,fe,!1,void 0,void 0,!1,0,Yn,Ke,!1)):(Ht.font=fe.baseFontFull,Ht.fillStyle=fe.bgCell,Ht.fillRect(0,0,ot.width,ot.height),Tu(Ht,k([Ft,U]),0,U,!1,!1,0,0,Ye.width,Ye.height,!1,fe,fe.bgCell,Pe,Yn,1,void 0,!1,0,void 0,void 0,void 0,Tn,lt,()=>{},0))),ot.style.left="-100%",ot.style.position="absolute",ot.style.width=`${Ye.width}px`,ot.style.height=`${Ye.height}px`,document.body.append(ot),P.dataTransfer.setDragImage(ot,Ye.width/2,Ye.height/2),window.setTimeout(()=>{ot.remove()},0)}}else P.preventDefault()},[_,T,zt,Be,Tt,fe,vt,Yn,Ke,k,Pe,Tn,lt]);qt("dragstart",dl,(s=ce==null?void 0:ce.current)!==null&&s!==void 0?s:null,!1,!1);const Ho=c.useRef(),To=c.useCallback(P=>{var V;const be=wt.current;if(Qe!==void 0&&P.preventDefault(),be===null||Ue===void 0)return;const De=zt(be,P.clientX,P.clientY),[we,Re]=De.location,Oe=we-(he?0:1),[nt,ye]=(V=Ho.current)!==null&&V!==void 0?V:[];(nt!==Oe||ye!==Re)&&(Ho.current=[Oe,Re],Ue([Oe,Re],P.dataTransfer))},[he,zt,Ue,Qe]);qt("dragover",To,(a=ce==null?void 0:ce.current)!==null&&a!==void 0?a:null,!1,!1);const al=c.useCallback(()=>{Ho.current=void 0,Ve==null||Ve()},[Ve]);qt("dragend",al,(d=ce==null?void 0:ce.current)!==null&&d!==void 0?d:null,!1,!1);const Si=c.useCallback(P=>{const V=wt.current;if(V===null||Qe===void 0)return;P.preventDefault();const be=zt(V,P.clientX,P.clientY),[De,we]=be.location,Re=De-(he?0:1);Qe([Re,we],P.dataTransfer)},[he,zt,Qe]);qt("drop",Si,(h=ce==null?void 0:ce.current)!==null&&h!==void 0?h:null,!1,!1);const Ri=c.useCallback(()=>{ct==null||ct()},[ct]);qt("dragleave",Ri,(g=ce==null?void 0:ce.current)!==null&&g!==void 0?g:null,!1,!1);const Mi=c.useRef(Y);Mi.current=Y;const go=c.useRef(null),zo=c.useCallback(P=>{if(!(wt.current===null||!wt.current.contains(document.activeElement))){if(P===null&&Mi.current.current!==void 0){var V;J==null||(V=J.current)===null||V===void 0||V.focus({preventScroll:!0})}else P!==null&&P.focus({preventScroll:!0});go.current=P}},[J]);c.useImperativeHandle(t,()=>({focus:()=>{const P=go.current;if(P===null||!document.contains(P)){var V;J==null||(V=J.current)===null||V===void 0||V.focus({preventScroll:!0})}else P.focus({preventScroll:!0})},getBounds:(P,V)=>{if(!(J===void 0||J.current===null))return Tt(J.current,P??0,V??-1)},damage:wi,getMouseArgsForPosition:(P,V,be)=>{if(!(J===void 0||J.current===null))return zt(J.current,P,V,be)}}),[J,wi,Tt,zt]);const Ln=c.useRef(),oi=Js(()=>{var P,V,be,De;if(m<50||(Le==null?void 0:Le.disableAccessibilityTree)===!0)return null;let we=$l(vt,Lt,m,q,At);const Re=he?0:-1;!he&&((P=we[0])===null||P===void 0?void 0:P.sourceIndex)===0&&(we=we.slice(1));const[Oe,nt]=(V=(be=Y.current)===null||be===void 0?void 0:be.cell)!==null&&V!==void 0?V:[],ye=(De=Y.current)===null||De===void 0?void 0:De.range,xt=we.map($e=>$e.sourceIndex),Xe=po(w,Math.min(D,w+v));return Oe!==void 0&&nt!==void 0&&!(xt.includes(Oe)&&Xe.includes(nt))&&zo(null),c.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":D+1,"aria-multiselectable":"true","aria-colcount":vt.length+Re},c.createElement("thead",{role:"rowgroup"},c.createElement("tr",{role:"row","aria-rowindex":1},we.map($e=>c.createElement("th",{role:"columnheader","aria-selected":Y.columns.hasIndex($e.sourceIndex),"aria-colindex":$e.sourceIndex+1+Re,tabIndex:-1,onFocus:Ft=>{if(Ft.target!==go.current)return tt==null?void 0:tt([$e.sourceIndex,-1])},key:$e.sourceIndex},$e.title)))),c.createElement("tbody",{role:"rowgroup"},Xe.map($e=>c.createElement("tr",{role:"row","aria-selected":Y.rows.hasIndex($e),key:$e,"aria-rowindex":$e+2},we.map(Ft=>{const U=Ft.sourceIndex,ot=yn(U,$e),Ye=Oe===U&&nt===$e,jt=ye!==void 0&&U>=ye.x&&U<ye.x+ye.width&&$e>=ye.y&&$e<ye.y+ye.height,Ht=`glide-cell-${U}-${$e}`,hn=[U,$e],En=k(hn,!0);return c.createElement("td",{key:ot,role:"gridcell","aria-colindex":U+1+Re,"aria-selected":jt,"aria-readonly":Co(En)||!so(En),id:Ht,"data-testid":Ht,onClick:()=>{const tn=J==null?void 0:J.current;if(tn!=null)return K==null?void 0:K({bounds:Tt(tn,U,$e),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:hn})},onFocusCapture:tn=>{var dt,xe;if(!(tn.target===go.current||((dt=Ln.current)===null||dt===void 0?void 0:dt[0])===U&&((xe=Ln.current)===null||xe===void 0?void 0:xe[1])===$e))return Ln.current=hn,tt==null?void 0:tt(hn)},ref:Ye?zo:void 0,tabIndex:-1},Ya(En,lt))})))))},[m,vt,Lt,q,At,D,w,v,Y,zo,k,J,K,Tt,tt],200),Po=ne===0||!oe?0:Lt>ne?1:vn(-At/100,0,1),cl=-w*32+bt,st=ae?vn(-cl/100,0,1):0,Ai=c.useMemo(()=>{if(!Po&&!st)return null;const P={position:"absolute",top:0,left:Zo,width:m-Zo,height:f,opacity:Po,pointerEvents:"none",transition:_e?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},V={position:"absolute",top:Vn,left:0,width:m,height:f,opacity:st,pointerEvents:"none",transition:ht?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return c.createElement(c.Fragment,null,Po>0&&c.createElement("div",{id:"shadow-x",style:P}),st>0&&c.createElement("div",{id:"shadow-y",style:V}))},[Po,st,Zo,m,_e,Vn,f,ht]),fl=c.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return c.createElement(c.Fragment,null,c.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:-1,onKeyDown:Fi,onKeyUp:Di,onFocus:G,onBlur:$,ref:ki,style:Ro},oi),c.createElement("canvas",{ref:Ne,style:fl}),Ai)},Ua=c.memo(c.forwardRef(Va));function ai(e,t,n,o){var i;return vn(Math.round(t-((i=e.growOffset)!==null&&i!==void 0?i:0)),Math.ceil(n),Math.floor(o))}const ja=e=>{var t;const[n,o]=c.useState(),[i,l]=c.useState(),[u,r]=c.useState(),[s,a]=c.useState(),[d,h]=c.useState(!1),[g,m]=c.useState(),[f,v]=c.useState(),[C,p]=c.useState(),[w,b]=c.useState(!1),[x,E]=c.useState(),{onHeaderMenuClick:H,onHeaderIndicatorClick:B,getCellContent:S,onColumnMoved:D,onColumnResize:k,onColumnResizeStart:I,onColumnResizeEnd:R,gridRef:z,maxColumnWidth:F,minColumnWidth:M,onRowMoved:G,lockColumns:$,onColumnProposeMove:le,onMouseDown:Y,onMouseUp:ne,onItemHovered:se,onDragStart:X,canvasRef:oe}=e,ae=((t=k??R)!==null&&t!==void 0?t:I)!==void 0,{columns:de,selection:pe}=e,W=pe.columns,me=c.useCallback(T=>{const[ie,ge]=T.location;u!==void 0&&s!==ie&&ie>=$?(h(!0),a(ie)):f!==void 0&&ge!==void 0?(b(!0),p(Math.max(0,ge))):i===void 0&&!d&&!w&&(se==null||se(T))},[u,f,s,se,$,i,d,w]),O=D!==void 0,ve=c.useCallback(T=>{if(T.button===0){const[_,Me]=T.location;if(T.kind==="out-of-bounds"&&T.isEdge&&ae){var ie;const Se=z==null||(ie=z.current)===null||ie===void 0?void 0:ie.getBounds(de.length-1,-1);Se!==void 0&&(o(Se.x),l(de.length-1))}else if(T.kind==="header"&&_>=$){const Se=oe==null?void 0:oe.current;if(T.isEdge&&ae&&Se){var ge;o(T.bounds.x),l(_);const Ie=Se.getBoundingClientRect().width/Se.offsetWidth,fe=T.bounds.width/Ie;I==null||I(de[_],fe,_,fe+((ge=de[_].growOffset)!==null&&ge!==void 0?ge:0))}else T.kind==="header"&&O&&(m(T.bounds.x),r(_))}else T.kind==="cell"&&$>0&&_===0&&Me!==void 0&&G!==void 0&&(E(T.bounds.y),v(Me))}Y==null||Y(T)},[Y,ae,$,G,z,de,O,I,oe]),q=c.useCallback((T,ie)=>{d||w||H==null||H(T,ie)},[d,w,H]),he=c.useCallback((T,ie)=>{d||w||B==null||B(T,ie)},[d,w,B]),K=c.useRef(-1),re=c.useCallback(()=>{K.current=-1,v(void 0),p(void 0),E(void 0),b(!1),r(void 0),a(void 0),m(void 0),h(!1),l(void 0),o(void 0)},[]),ke=c.useCallback((T,ie)=>{if(T.button===0){if(i!==void 0){var ge;if((W==null?void 0:W.hasIndex(i))===!0)for(const Fe of W){var _;if(Fe===i)continue;const Ie=de[Fe],fe=ai(Ie,K.current,M,F);k==null||k(Ie,fe,Fe,fe+((_=Ie.growOffset)!==null&&_!==void 0?_:0))}const Se=ai(de[i],K.current,M,F);if(R==null||R(de[i],Se,i,Se+((ge=de[i].growOffset)!==null&&ge!==void 0?ge:0)),W.hasIndex(i))for(const Fe of W){var Me;if(Fe===i)continue;const Ie=de[Fe],fe=ai(Ie,K.current,M,F);R==null||R(Ie,fe,Fe,fe+((Me=Ie.growOffset)!==null&&Me!==void 0?Me:0))}}re(),u!==void 0&&s!==void 0&&(le==null?void 0:le(u,s))!==!1&&(D==null||D(u,s)),f!==void 0&&C!==void 0&&(G==null||G(f,C))}ne==null||ne(T,ie)},[ne,i,u,s,f,C,W,R,de,M,F,k,D,G,re,le]),J=c.useMemo(()=>{if(!(u===void 0||s===void 0)&&u!==s&&(le==null?void 0:le(u,s))!==!1)return{src:u,dest:s}},[u,s,le]),Be=c.useCallback(T=>{const ie=oe==null?void 0:oe.current;if(u!==void 0&&g!==void 0)Math.abs(T.clientX-g)>20&&h(!0);else if(f!==void 0&&x!==void 0)Math.abs(T.clientY-x)>20&&b(!0);else if(i!==void 0&&n!==void 0&&ie){var ge;const Se=ie.getBoundingClientRect().width/ie.offsetWidth,Fe=(T.clientX-n)/Se,Ie=de[i],fe=ai(Ie,Fe,M,F);if(k==null||k(Ie,fe,i,fe+((ge=Ie.growOffset)!==null&&ge!==void 0?ge:0)),K.current=Fe,(W==null?void 0:W.first())===i)for(const Ee of W){var _;if(Ee===i)continue;const Te=de[Ee],We=ai(Te,K.current,M,F);k==null||k(Te,We,Ee,We+((_=Te.growOffset)!==null&&_!==void 0?_:0))}}},[u,g,f,x,i,n,de,M,F,k,W,oe]),Ve=c.useCallback((T,ie)=>{if(f===void 0||C===void 0)return S(T,ie);let[ge,_]=T;return _===C?_=f:(_>C&&(_-=1),_>=f&&(_+=1)),S([ge,_],ie)},[f,C,S]),ce=c.useCallback(T=>{X==null||X(T),T.defaultPrevented()||re()},[re,X]);return c.createElement(Ua,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:i,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:Ve,isResizing:i!==void 0,onHeaderMenuClick:q,onHeaderIndicatorClick:he,isDragging:d,onItemHovered:me,onDragStart:ce,onMouseDown:ve,allowResize:ae,onMouseUp:ke,dragAndDropState:J,onMouseMoveRaw:Be,ref:z})};function qa(e){const t=c.useRef(null),[n,o]=c.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return c.useLayoutEffect(()=>{const i=u=>{for(const r of u){const{width:s,height:a}=r&&r.contentRect||{};o(d=>d.width===s&&d.height===a?d:{width:s,height:a})}},l=new window.ResizeObserver(i);return t.current&&l.observe(t.current,void 0),()=>{l.disconnect()}},[t.current]),{ref:t,...n}}const _a=(e,t,n)=>{const o=c.useRef(null),i=c.useRef(null),l=c.useRef(null),u=c.useRef(0),r=c.useRef(t);r.current=t;const s=n.current;c.useEffect(()=>{const a=()=>{if(i.current===!1&&s!==null){var g,m;const f=[s.scrollLeft,s.scrollTop];if(((g=l.current)===null||g===void 0?void 0:g[0])===f[0]&&((m=l.current)===null||m===void 0?void 0:m[1])===f[1])if(u.current>10){l.current=null,i.current=null;return}else u.current++;else u.current=0,r.current(f[0],f[1]),l.current=f;o.current=window.setTimeout(a,8.333333333333334)}},d=()=>{i.current=!0,l.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},h=g=>{g.touches.length===0&&(i.current=!1,u.current=0,o.current=window.setTimeout(a,8.333333333333334))};if(e&&s!==null){const g=s;return g.addEventListener("touchstart",d),g.addEventListener("touchend",h),()=>{g.removeEventListener("touchstart",d),g.removeEventListener("touchend",h),o.current!==null&&window.clearTimeout(o.current)}}},[e,s])},Za=()=>e=>e.isSafari?"scroll":"auto",Ja=_t("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Za()]}}),Qa=33554400,ec=5e6;function tc(e){const t=sn.c(3),[n,o]=c.useState(!1),i=typeof window>"u"?null:window,l=c.useRef(0);let u;t[0]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{window.clearTimeout(l.current),o(!0)},t[0]=u):u=t[0],qt("touchstart",u,i,!0,!1);let r;return t[1]!==e?(r=s=>{s.touches.length===0&&(l.current=window.setTimeout(()=>o(!1),e))},t[1]=e,t[2]=r):r=t[2],qt("touchend",r,i,!0,!1),n}const nc=e=>{var t,n,o,i;const{children:l,clientHeight:u,scrollHeight:r,scrollWidth:s,update:a,draggable:d,className:h,preventDiagonalScrolling:g=!1,paddingBottom:m=0,paddingRight:f=0,rightElement:v,rightElementProps:C,kineticScrollPerfHack:p=!1,scrollRef:w,initialSize:b}=e,x=[],E=(t=C==null?void 0:C.sticky)!==null&&t!==void 0?t:!1,H=(n=C==null?void 0:C.fill)!==null&&n!==void 0?n:!1,B=c.useRef(0),S=c.useRef(0),D=c.useRef(null),k=typeof window>"u"?1:window.devicePixelRatio,I=c.useRef(k);c.useEffect(()=>{if(I.current!==k){B.current=0,S.current=0,I.current=k;const O=D.current;O!==null&&Y.current(O.scrollLeft,O.scrollTop)}},[k]);const R=c.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),z=c.useRef(null),F=tc(200),[M,G]=c.useState(!0),$=c.useRef(0);c.useLayoutEffect(()=>{if(!M||F||R.current.lockDirection===void 0)return;const O=D.current;if(O===null)return;const[ve,q]=R.current.lockDirection;ve!==void 0?O.scrollLeft=ve:q!==void 0&&(O.scrollTop=q),R.current.lockDirection=void 0},[F,M]);const le=c.useCallback((O,ve)=>{var q,he,K,re;const ke=D.current;if(ke===null)return;ve=ve??ke.scrollTop,O=O??ke.scrollLeft;const J=R.current.scrollTop,Be=R.current.scrollLeft,Ve=O-Be,ce=ve-J;F&&Ve!==0&&ce!==0&&(Math.abs(Ve)>3||Math.abs(ce)>3)&&g&&R.current.lockDirection===void 0&&(R.current.lockDirection=Math.abs(Ve)<Math.abs(ce)?[Be,void 0]:[void 0,J]);const T=R.current.lockDirection;O=(q=T==null?void 0:T[0])!==null&&q!==void 0?q:O,ve=(he=T==null?void 0:T[1])!==null&&he!==void 0?he:ve,R.current.scrollLeft=O,R.current.scrollTop=ve;const ie=ke.clientWidth,ge=ke.clientHeight,_=ve,Me=S.current-_,Se=ke.scrollHeight-ge;S.current=_;let Fe;if(Se>0&&r>ke.scrollHeight+5)if(Math.abs(Me)>2e3||_===0||_===Se){const Ie=Math.max(0,Math.min(1,_/Se)),fe=r-ge;Fe=Ie*fe,B.current=Fe}else B.current-=Me,Fe=B.current;else Fe=_,B.current=Fe;Fe=Math.max(0,Math.min(Fe,r-ge)),B.current=Fe,T!==void 0&&(window.clearTimeout($.current),G(!1),$.current=window.setTimeout(()=>G(!0),200)),a({x:O,y:Fe,width:ie-f,height:ge-m,paddingRight:(K=(re=z.current)===null||re===void 0?void 0:re.clientWidth)!==null&&K!==void 0?K:0})},[m,f,r,a,g,F]);_a(p&&Qi.value,le,D);const Y=c.useRef(le);Y.current=le;const ne=c.useRef(),se=c.useRef(!1);c.useLayoutEffect(()=>{se.current?le():se.current=!0},[le,m,f]);const X=c.useCallback(O=>{D.current=O,w!==void 0&&(w.current=O)},[w]);let oe=0,ae=0;const de=Math.min(r,Qa);for(x.push(c.createElement("div",{key:oe++,style:{width:s,height:0}}));ae<de;){const O=Math.min(ec,de-ae);x.push(c.createElement("div",{key:oe++,style:{width:0,height:O}})),ae+=O}const{ref:pe,width:W,height:me}=qa(b);return typeof window<"u"&&(((o=ne.current)===null||o===void 0?void 0:o.height)!==me||((i=ne.current)===null||i===void 0?void 0:i.width)!==W)&&(window.setTimeout(()=>Y.current(),0),ne.current={width:W,height:me}),(W??0)===0||(me??0)===0?c.createElement("div",{ref:pe}):c.createElement("div",{ref:pe},c.createElement(Ja,{isSafari:Qi.value},c.createElement("div",{className:"dvn-underlay"},l),c.createElement("div",{ref:X,style:ne.current,draggable:d,onDragStart:O=>{d||(O.stopPropagation(),O.preventDefault())},className:"dvn-scroller "+(h??""),onScroll:()=>le()},c.createElement("div",{className:"dvn-scroll-inner"+(v===void 0?" dvn-hidden":"")},c.createElement("div",{className:"dvn-stack"},x),v!==void 0&&c.createElement(c.Fragment,null,!H&&c.createElement("div",{className:"dvn-spacer"}),c.createElement("div",{ref:z,style:{height:me,maxHeight:u-Math.ceil(k%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:f,flexGrow:H?1:void 0,right:E?f??0:void 0,pointerEvents:"auto"}},v))))))},oc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:i,groupHeaderHeight:l,enableGroups:u,freezeColumns:r,experimental:s,nonGrowWidth:a,clientSize:d,className:h,onVisibleRegionChanged:g,scrollRef:m,preventDiagonalScrolling:f,rightElement:v,rightElementProps:C,overscrollX:p,overscrollY:w,initialSize:b,smoothScrollX:x=!1,smoothScrollY:E=!1,isDraggable:H}=e,{paddingRight:B,paddingBottom:S}=s??{},[D,k]=d,I=c.useRef(),R=c.useRef(),z=c.useRef(),F=c.useRef(),M=a+Math.max(0,p??0);let G=u?i+l:i;if(typeof o=="number")G+=n*o;else for(let ne=0;ne<n;ne++)G+=o(ne);w!==void 0&&(G+=w);const $=c.useRef(),le=c.useCallback(()=>{var ne,se;if($.current===void 0)return;const X={...$.current};let oe=0,ae=X.x<0?-X.x:0,de=0,pe=0;X.x=X.x<0?0:X.x;let W=0;for(let re=0;re<r;re++)W+=t[re].width;for(const re of t){const ke=oe-W;if(X.x>=ke+re.width)oe+=re.width,pe++,de++;else if(X.x>ke)oe+=re.width,x?ae+=ke-X.x:pe++,de++;else if(X.x+X.width>ke)oe+=re.width,de++;else break}let me=0,O=0,ve=0;if(typeof o=="number")E?(O=Math.floor(X.y/o),me=O*o-X.y):O=Math.ceil(X.y/o),ve=Math.ceil(X.height/o)+O,me<0&&ve++;else{let re=0;for(let ke=0;ke<n;ke++){const J=o(ke),Be=re+(E?0:J/2);if(X.y>=re+J)re+=J,O++,ve++;else if(X.y>Be)re+=J,E?me+=Be-X.y:O++,ve++;else if(X.y+X.height>J/2+re)re+=J,ve++;else break}}O=Math.max(0,Math.min(O,n-1)),ve=Math.max(O,Math.min(ve,n));const q={x:pe,y:O,width:de-pe,height:ve-O},he=I.current;if(he===void 0||he.y!==q.y||he.x!==q.x||he.height!==q.height||he.width!==q.width||R.current!==ae||z.current!==me||X.width!==((ne=F.current)===null||ne===void 0?void 0:ne[0])||X.height!==((se=F.current)===null||se===void 0?void 0:se[1])){var K;g==null||g({x:pe,y:O,width:de-pe,height:ve-O},X.width,X.height,(K=X.paddingRight)!==null&&K!==void 0?K:0,ae,me),I.current=q,R.current=ae,z.current=me,F.current=[X.width,X.height]}},[t,o,n,g,r,x,E]),Y=c.useCallback(ne=>{$.current=ne,le()},[le]);return c.useEffect(()=>{le()},[le]),c.createElement(nc,{scrollRef:m,className:h,kineticScrollPerfHack:s==null?void 0:s.kineticScrollPerfHack,preventDiagonalScrolling:f,draggable:H===!0||typeof H=="string",scrollWidth:M+(B??0),scrollHeight:G+(S??0),clientHeight:k,rightElement:v,paddingBottom:S,paddingRight:B,rightElementProps:C,update:Y,initialSize:b},c.createElement(ja,{eventTargetRef:m,width:D,height:k,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},ic=_t("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),lc=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),rc=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),uc=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),sc=10,dc=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:i,searchInputRef:l,searchValue:u,searchResults:r,onSearchValueChange:s,getCellsForSelection:a,onSearchResultsChanged:d,showSearch:h=!1,onSearchClose:g}=e,[m]=c.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[f,v]=c.useState(""),C=u??f,p=c.useCallback(se=>{v(se),s==null||s(se)},[s]),[w,b]=c.useState(),x=c.useRef(w);x.current=w,c.useEffect(()=>{r!==void 0&&(r.length>0?b(se=>{var X;return{rowsSearched:o,results:r.length,selectedIndex:(X=se==null?void 0:se.selectedIndex)!==null&&X!==void 0?X:-1}}):b(void 0))},[o,r]);const E=c.useRef();E.current===void 0&&(E.current=new AbortController);const H=c.useRef(),[B,S]=c.useState([]),D=r??B,k=c.useCallback(()=>{H.current!==void 0&&(window.cancelAnimationFrame(H.current),H.current=void 0),E.current!==void 0&&E.current.abort(),E.current=new AbortController},[]),I=c.useRef(n);I.current=n;const R=c.useCallback(se=>{const X=new RegExp(se.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let oe=I.current,ae=Math.min(10,o),de=0;b(void 0),S([]);const pe=[],W=async()=>{var me,O;if(a===void 0)return;const ve=performance.now(),q=o-de;let he=a({x:0,y:oe,width:i.length,height:Math.min(ae,q,o-oe)},E.current.signal);typeof he=="function"&&(he=await he());let K=!1;for(const[ce,T]of he.entries())for(const[ie,ge]of T.entries()){let _;switch(ge.kind){case te.Text:case te.Number:_=ge.displayData;break;case te.Uri:case te.Markdown:_=ge.data;break;case te.Boolean:_=typeof ge.data=="boolean"?ge.data.toString():void 0;break;case te.Image:case te.Bubble:_=ge.data.join("🐳");break;case te.Custom:_=ge.copyData;break}_!==void 0&&X.test(_)&&(pe.push([ie,ce+oe]),K=!0)}const re=performance.now();K&&S([...pe]),de+=he.length,ln(de<=o);const ke=(me=(O=x.current)===null||O===void 0?void 0:O.selectedIndex)!==null&&me!==void 0?me:-1;b({results:pe.length,rowsSearched:de,selectedIndex:ke}),d==null||d(pe,ke),oe+ae>=o?oe=0:oe+=ae;const J=re-ve,Be=Math.max(J,1),Ve=sc/Be;ae=Math.ceil(ae*Ve),de<o&&pe.length<1e3&&(H.current=window.requestAnimationFrame(W))};k(),H.current=window.requestAnimationFrame(W)},[k,i.length,a,d,o]),z=c.useCallback(()=>{var se;g==null||g(),b(void 0),S([]),d==null||d([],-1),k(),t==null||(se=t.current)===null||se===void 0||se.focus()},[k,t,g,d]),F=c.useCallback(se=>{p(se.target.value),r===void 0&&(se.target.value===""?(b(void 0),S([]),k()):R(se.target.value))},[R,k,p,r]);c.useEffect(()=>{l.current!==null&&(p(""),b(void 0),B.length>0&&(S([]),d==null||d([],-1)),h?l.current.focus({preventScroll:!0}):k())},[h,l]);const M=c.useCallback(se=>{var X;if(se==null||(X=se.stopPropagation)===null||X===void 0||X.call(se),w===void 0||w.results===0)return;const oe=(w.selectedIndex+1)%w.results;b({...w,selectedIndex:oe}),d==null||d(D,oe)},[w,d,D]),G=c.useCallback(se=>{var X;if(se==null||(X=se.stopPropagation)===null||X===void 0||X.call(se),w===void 0||w.results===0)return;let oe=(w.selectedIndex-1)%w.results;oe<0&&(oe+=w.results),b({...w,selectedIndex:oe}),d==null||d(D,oe)},[d,D,w]),$=c.useCallback(se=>{(se.ctrlKey||se.metaKey)&&se.nativeEvent.code==="KeyF"||se.key==="Escape"?(z(),se.stopPropagation(),se.preventDefault()):se.key==="Enter"&&(se.shiftKey?G():M())},[z,M,G]);c.useEffect(()=>()=>{k()},[k]);const[le,Y]=c.useState(!1);c.useEffect(()=>{if(h)Y(!0);else{const se=setTimeout(()=>Y(!1),150);return()=>clearTimeout(se)}},[h]);const ne=c.useMemo(()=>{var se,X,oe;if(!h&&!le)return null;let ae;w!==void 0&&(ae=w.results>=1e3?"over 1000":`${w.results} result${w.results!==1?"s":""}`,w.selectedIndex>=0&&(ae=`${w.selectedIndex+1} of ${ae}`));const de=me=>{me.stopPropagation()},W={width:`${o>0?Math.floor(((se=w==null?void 0:w.rowsSearched)!==null&&se!==void 0?se:0)/o*100):0}%`};return c.createElement(ic,{className:"gdg-search-bar"+(h?"":" out"),onMouseDown:de,onMouseMove:de,onMouseUp:de,onClick:de},c.createElement("div",{className:"gdg-search-bar-inner"},c.createElement("input",{id:m,"aria-hidden":!h,"data-testid":"search-input",ref:l,onChange:F,value:C,tabIndex:h?void 0:-1,onKeyDownCapture:$}),c.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!h,tabIndex:h?void 0:-1,onClick:G,disabled:((X=w==null?void 0:w.results)!==null&&X!==void 0?X:0)===0},lc),c.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!h,tabIndex:h?void 0:-1,onClick:M,disabled:((oe=w==null?void 0:w.results)!==null&&oe!==void 0?oe:0)===0},rc),g!==void 0&&c.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!h,"data-testid":"search-close-button",tabIndex:h?void 0:-1,onClick:z},uc)),w!==void 0?c.createElement(c.Fragment,null,c.createElement("div",{className:"gdg-search-status"},c.createElement("div",{"data-testid":"search-result-area"},ae)),c.createElement("div",{className:"gdg-search-progress",style:W})):c.createElement("div",{className:"gdg-search-status"},c.createElement("label",{htmlFor:m},"Type to search")))},[h,le,w,o,m,l,F,C,$,G,M,g,z]);return c.createElement(c.Fragment,null,c.createElement(oc,{prelightCells:D,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),ne)},ac=()=>e=>Math.max(16,e.targetHeight-10),cc=_t("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[ac(),"px"]}}),fc=e=>{const t=sn.c(37),{bounds:n,group:o,onClose:i,canvasBounds:l,onFinish:u}=e,[r,s]=Xn.useState(o);let a;if(t[0]!==n.height||t[1]!==n.width||t[2]!==n.x||t[3]!==n.y||t[4]!==l.left||t[5]!==l.top||t[6]!==i||t[7]!==u||t[8]!==r){const d=n.x-l.left+1,h=n.y-l.top,g=n.width-2;let m;t[10]!==n.height||t[11]!==d||t[12]!==h||t[13]!==g?(m={position:"absolute",left:d,top:h,width:g,height:n.height},t[10]=n.height,t[11]=d,t[12]=h,t[13]=g,t[14]=m):m=t[14];let f;t[15]===Symbol.for("react.memo_cache_sentinel")?(f="gdg-g1tqibwd",t[15]=f):f=t[15];let v;t[16]!==i||t[17]!==m?(v={style:m,className:f,onClickOutside:i},t[16]=i,t[17]=m,t[18]=v):v=t[18];let C;if(t[19]!==n.height||t[20]!==i||t[21]!==u||t[22]!==r){let p;t[24]!==r?(p=E=>E.target.setSelectionRange(0,r.length),t[24]=r,t[25]=p):p=t[25];let w;t[26]===Symbol.for("react.memo_cache_sentinel")?(w=E=>s(E.target.value),t[26]=w):w=t[26];let b;t[27]!==i||t[28]!==u||t[29]!==r?(b=E=>{E.key==="Enter"?u(r):E.key==="Escape"&&i()},t[27]=i,t[28]=u,t[29]=r,t[30]=b):b=t[30];let x;t[31]!==n.height||t[32]!==i||t[33]!==b||t[34]!==p||t[35]!==r?(x={targetHeight:n.height,"data-testid":"group-rename-input",value:r,onBlur:i,onFocus:p,onChange:w,onKeyDown:b,autoFocus:!0},t[31]=n.height,t[32]=i,t[33]=b,t[34]=p,t[35]=r,t[36]=x):x=t[36],C=Xn.createElement(cc,x),t[19]=n.height,t[20]=i,t[21]=u,t[22]=r,t[23]=C}else C=t[23];a=Xn.createElement(hu,v,C),t[0]=n.height,t[1]=n.width,t[2]=n.x,t[3]=n.y,t[4]=l.left,t[5]=l.top,t[6]=i,t[7]=u,t[8]=r,t[9]=a}else a=t[9];return a};function hc(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function je(e,t,n){const o=Wu(e,t);return o&&(n.didMatch=!0),o}function Wu(e,t){if(e.length===0)return!1;if(e.includes("|")){const s=e.split("|");for(const a of s)if(Wu(a,t))return!0;return!1}let n=!1,o=!1,i=!1,l=!1;const u=e.split("+"),r=u.pop();if(!hc(r,t))return!1;if(u[0]==="any")return!0;for(const s of u)switch(s){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":i=!0;break;case"meta":l=!0;break;case"primary":ol.value?l=!0:n=!0;break}return t.altKey===i&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===l}function gc(e){var t,n;if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case te.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Ul?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case te.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case te.Image:case te.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case te.Drilldown:return{formatted:e.data.map(o=>o.text),rawValue:e.data.map(o=>o.text),format:"string-array"};case te.Text:return{formatted:(t=e.displayData)!==null&&t!==void 0?t:e.data,rawValue:e.data,format:"string"};case te.Uri:return{formatted:(n=e.displayData)!==null&&n!==void 0?n:e.data,rawValue:e.data,format:"url"};case te.Markdown:case te.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case te.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case te.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case te.Protected:return{formatted:"************",rawValue:"",format:"string"};default:hi()}}function vc(e,t){return e.map((o,i)=>{const l=t[i];return o.map(u=>u.span!==void 0&&u.span[0]!==l?{formatted:"",rawValue:"",format:"string"}:gc(u))})}function Ur(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function mc(e){const t=[];for(const i of e){const l=[];for(const u of i)if(u.format==="url"){var n,o;l.push((n=(o=u.rawValue)===null||o===void 0?void 0:o.toString())!==null&&n!==void 0?n:"")}else u.format==="string-array"?l.push(u.formatted.map(r=>Ur(r,!0)).join(",")):l.push(u.doNotEscape===!0?u.formatted:Ur(u.formatted,!1));t.push(l.join("	"))}return t.join(`
`)}function zl(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function jr(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function wc(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function pc(e){const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const i of e){t.push("<tr>");for(const l of i){const u=`gdg-format="${l.format}"`;if(l.format==="url")t.push(`<td ${u}><a href="${l.rawValue}">${zl(l.formatted)}</a></td>`);else if(l.format==="string-array")t.push(`<td ${u}><ol>${l.formatted.map((r,s)=>`<li gdg-raw-value=${jr(l.rawValue[s])}>`+zl(r)+"</li>").join("")}</ol></td>`);else{var n,o;t.push(`<td gdg-raw-value=${jr((n=(o=l.rawValue)===null||o===void 0?void 0:o.toString())!==null&&n!==void 0?n:"")} ${u}>${zl(l.formatted)}</td>`)}}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function Cc(e,t){const n=vc(e,t),o=mc(n),i=pc(n);return{textPlain:o,textHtml:i}}function qr(e){const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let l;for(;o.length>0;){const C=o.pop();if(C===void 0)break;if(C instanceof HTMLTableElement||C.nodeName==="TBODY")o.push(...[...C.children].reverse());else if(C instanceof HTMLTableRowElement)l!==void 0&&i.push(l),l=[],o.push(...[...C.children].reverse());else if(C instanceof HTMLTableCellElement){var u;const p=C.cloneNode(!0),b=p.children.length===1&&p.children[0].nodeName==="P"?p.children[0]:null,x=(b==null?void 0:b.children.length)===1&&b.children[0].nodeName==="FONT",E=p.querySelectorAll("br");for(const S of E)S.replaceWith(`
`);const H=p.getAttribute("gdg-raw-value"),B=(u=p.getAttribute("gdg-format"))!==null&&u!==void 0?u:"string";if(p.querySelector("a")!==null){var r,s,a,d;(r=l)===null||r===void 0||r.push({rawValue:(s=(a=p.querySelector("a"))===null||a===void 0?void 0:a.getAttribute("href"))!==null&&s!==void 0?s:"",formatted:(d=p.textContent)!==null&&d!==void 0?d:"",format:B})}else if(p.querySelector("ol")!==null){var h;const S=p.querySelectorAll("li");(h=l)===null||h===void 0||h.push({rawValue:[...S].map(D=>{var k;return(k=D.getAttribute("gdg-raw-value"))!==null&&k!==void 0?k:""}),formatted:[...S].map(D=>{var k;return(k=D.textContent)!==null&&k!==void 0?k:""}),format:"string-array"})}else if(H!==null){var g,m;(g=l)===null||g===void 0||g.push({rawValue:wc(H),formatted:(m=p.textContent)!==null&&m!==void 0?m:"",format:B})}else{var f,v;let S=(f=p.textContent)!==null&&f!==void 0?f:"";x&&(S=S.replace(/\n(?!\n)/g,"")),(v=l)===null||v===void 0||v.push({rawValue:S??"",formatted:S??"",format:B})}}}return l!==void 0&&i.push(l),i}function yc(e,t,n,o,i){const l=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let u=!1;do{var r,s;if(((r=e)===null||r===void 0?void 0:r.current)===void 0)break;const d=(s=e.current)===null||s===void 0?void 0:s.range,h=[];if(d.width>2){const f=t({x:d.x,y:d.y,width:1,height:d.height},i.signal);if(typeof f=="function")return l;h.push(...f);const v=t({x:d.x+d.width-1,y:d.y,width:1,height:d.height},i.signal);if(typeof v=="function")return l;h.push(...v)}else{const f=t({x:d.x,y:d.y,width:d.width,height:d.height},i.signal);if(typeof f=="function")return l;h.push(...f)}let g=d.x-n,m=d.x+d.width-1-n;for(const f of h)for(const v of f)v.span!==void 0&&(g=Math.min(v.span[0],g),m=Math.max(v.span[1],m));if(g===d.x-n&&m===d.x+d.width-1-n)u=!0;else{var a;e={current:{cell:(a=e.current.cell)!==null&&a!==void 0?a:[0,0],range:{x:g+n,y:d.y,width:m-g+1,height:d.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}}while(!u);return e}function _r(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function bc(e){let t;(function(r){r[r.None=0]="None",r[r.inString=1]="inString",r[r.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,l=t.None;e=e.replace(/\r\n/g,`
`);let u=0;for(const r of e){switch(l){case t.None:r==="	"||r===`
`?(o.push(e.slice(i,u)),i=u+1,r===`
`&&(n.push(o),o=[])):r==='"'&&(l=t.inString);break;case t.inString:r==='"'&&(l=t.inStringPostQuote);break;case t.inStringPostQuote:r==='"'?l=t.inString:((r==="	"||r===`
`)&&(o.push(_r(e.slice(i,u))),i=u+1,r===`
`&&(n.push(o),o=[])),l=t.None);break}u++}return i<e.length&&o.push(_r(e.slice(i,e.length))),n.push(o),n.map(r=>r.map(s=>({rawValue:s,formatted:s,format:"string"})))}function Zr(e,t,n){var o;const i=Cc(e,t),l=s=>{var a;(a=window.navigator.clipboard)===null||a===void 0||a.writeText(s)},u=(s,a)=>{var d;return((d=window.navigator.clipboard)===null||d===void 0?void 0:d.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([s],{type:"text/plain"}),"text/html":new Blob([a],{type:"text/html"})})]),!0)},r=(s,a)=>{try{var d,h;if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");n==null||(d=n.clipboardData)===null||d===void 0||d.setData("text/plain",s),n==null||(h=n.clipboardData)===null||h===void 0||h.setData("text/html",a)}catch{u(s,a)||l(s)}};((o=window.navigator.clipboard)===null||o===void 0?void 0:o.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?r(i.textPlain,i.textHtml):l(i.textPlain),n==null||n.preventDefault()}function lr(e){return e!==!0}function Ec(e){const{state:t,keybindings:n,overlayOpen:o,columnSelect:i,rowSelect:l,rangeSelect:u,editOnType:r,trapFocus:s,showTrailingBlankRow:a,columnsInLength:d,rowGroupingNavBehavior:h,mapper:g,onKeyDownIn:m,onSelectionCleared:f,onCellActivated:v,onDelete:C,getCellContent:p,setSelectedColumns:w,setSelectedRows:b,setShowSearchInner:x,searchInputRef:E,adjustSelection:H,updateSelectedCell:B,deleteRange:S,fillDown:D,fillRight:k,appendRow:I,getCustomNewRowTargetColumn:R,scrollToRef:z}=e,{gridSelection:F,gridRef:M,visibleRegionRef:G,rowMarkerOffset:$,rows:le,setGridSelection:Y,getMangledCellContent:ne,mangledOnCellsEdited:se,setOverlay:X,reselect:oe,focus:ae}=t,de=W=>{const me=()=>{W.stopPropagation(),W.preventDefault()},O={didMatch:!1},{bounds:ve}=W,q=F.columns,he=F.rows,K=n;if(!o&&je(K.clear,W,O)){var re,ke;const Ee=(re=(ke=F.current)===null||ke===void 0?void 0:ke.cell)!==null&&re!==void 0?re:[$,0];Y({columns:Je.empty(),rows:Je.empty(),current:{cell:Ee,range:{x:Ee[0],y:Ee[1],width:1,height:1},rangeStack:[]}},!1),f==null||f(),ae()}else if(!o&&je(K.selectAll,W,O)){var J,Be;Y({columns:Je.empty(),rows:Je.empty(),current:{cell:(J=(Be=F.current)===null||Be===void 0?void 0:Be.cell)!==null&&J!==void 0?J:[$,0],range:{x:$,y:0,width:d,height:le},rangeStack:[]}},!1)}else if(je(K.search,W,O)){var Ve;E==null||(Ve=E.current)===null||Ve===void 0||Ve.focus({preventScroll:!0}),x(!0)}else if(je(K.delete,W,O)){var ce;const Ee=(ce=C==null?void 0:C(F))!==null&&ce!==void 0?ce:!0;if(Ee!==!1){const Te=Ee===!0?F:Ee;if(Te.current!==void 0){S(Te.current.range);for(const We of Te.current.rangeStack)S(We)}for(const We of Te.rows)S({x:$,y:We,width:d,height:1});for(const We of Te.columns)S({x:We,y:0,width:1,height:le})}}if(O.didMatch)return me(),!0;if(F.current===void 0)return!1;let[T,ie]=F.current.cell;const[,ge]=F.current.cell;let _=!1,Me=!1;if(je(K.scrollToSelectedCell,W,O))z.current(T-$,ie);else if(i!=="none"&&je(K.selectColumn,W,O))q.hasIndex(T)?w(q.remove(T),void 0,!0):i==="single"?w(Je.fromSingleSelection(T),void 0,!0):w(void 0,T,!0);else if(l!=="none"&&je(K.selectRow,W,O))he.hasIndex(ie)?b(he.remove(ie),void 0,!0):l==="single"?b(Je.fromSingleSelection(ie),void 0,!0):b(void 0,ie,!0);else if(!o&&ve!==void 0&&je(K.activateCell,W,O))if(ie===le&&a)window.setTimeout(()=>{const Ee=R(T);I(Ee??T)},0);else{const Ee={inputType:"keyboard",key:W.key},Te=ne([T,ie]);if(Te.kind===te.Boolean&&Te.readonly!==!0){var Se;v==null||v([T-$,ie],Ee),se([{location:[T,ie],value:{...Te,data:lr(Te.data)}}]),(Se=M.current)===null||Se===void 0||Se.damage([{cell:[T,ie]}])}else v==null||v([T-$,ie],Ee),oe(ve,Ee)}else F.current.range.height>1&&je(K.downFill,W,O)?D():F.current.range.width>1&&je(K.rightFill,W,O)?k():je(K.goToNextPage,W,O)?ie+=Math.max(1,G.current.height-4):je(K.goToPreviousPage,W,O)?ie-=Math.max(1,G.current.height-4):je(K.goToFirstCell,W,O)?(X(void 0),ie=0,T=0):je(K.goToLastCell,W,O)?(X(void 0),ie=Number.MAX_SAFE_INTEGER,T=Number.MAX_SAFE_INTEGER):je(K.selectToFirstCell,W,O)?(X(void 0),H([-2,-2])):je(K.selectToLastCell,W,O)?(X(void 0),H([2,2])):o?(je(K.closeOverlay,W,O)&&X(void 0),je(K.acceptOverlayDown,W,O)&&(X(void 0),ie++),je(K.acceptOverlayUp,W,O)&&(X(void 0),ie--),je(K.acceptOverlayLeft,W,O)&&(X(void 0),T--),je(K.acceptOverlayRight,W,O)&&(X(void 0),T++)):(je(K.goDownCell,W,O)?ie+=1:je(K.goUpCell,W,O)?ie-=1:je(K.goRightCell,W,O)?T+=1:je(K.goLeftCell,W,O)?T-=1:je(K.goDownCellRetainSelection,W,O)?(ie+=1,_=!0):je(K.goUpCellRetainSelection,W,O)?(ie-=1,_=!0):je(K.goRightCellRetainSelection,W,O)?(T+=1,_=!0):je(K.goLeftCellRetainSelection,W,O)?(T-=1,_=!0):je(K.goToLastRow,W,O)?ie=le-1:je(K.goToFirstRow,W,O)?ie=Number.MIN_SAFE_INTEGER:je(K.goToLastColumn,W,O)?T=Number.MAX_SAFE_INTEGER:je(K.goToFirstColumn,W,O)?T=Number.MIN_SAFE_INTEGER:(u==="rect"||u==="multi-rect")&&(je(K.selectGrowDown,W,O)?H([0,1]):je(K.selectGrowUp,W,O)?H([0,-1]):je(K.selectGrowRight,W,O)?H([1,0]):je(K.selectGrowLeft,W,O)?H([-1,0]):je(K.selectToLastRow,W,O)?H([0,2]):je(K.selectToFirstRow,W,O)?H([0,-2]):je(K.selectToLastColumn,W,O)?H([2,0]):je(K.selectToFirstColumn,W,O)&&H([-2,0])),Me=O.didMatch);if(h!==void 0&&h!=="normal"&&ie!==ge){const Ee=h==="skip-up"||h==="skip"||h==="block",Te=h==="skip-down"||h==="skip"||h==="block",We=ie<ge;if(We&&Ee){for(;ie>=0&&g(ie).isGroupHeader;)ie--;ie<0&&(ie=ge)}else if(!We&&Te){for(;ie<le&&g(ie).isGroupHeader;)ie++;ie>=le&&(ie=ge)}}const Ie=B(T,ie,!1,_),fe=O.didMatch;return fe&&(Ie||!Me||s)&&me(),fe};return{handleFixedKeybindings:de,onKeyDown:W=>{let me=!1;if(m!==void 0&&m({...W,...W.location&&{location:[W.location[0]-$,W.location[1]]},cancel:()=>{me=!0}}),me||de(W)||F.current===void 0)return;const[O,ve]=F.current.cell,q=G.current,he=W.keyCode===229,K=r&&!W.metaKey&&!W.ctrlKey&&W.key.length===1&&/[!-~\xA1-\xAC\xAE-\u0377\u037A-\u037F\u0384-\u038A\u038C\u038E-\u03A1\u03A3-\u052F\u0531-\u0556\u0559-\u058A\u058D-\u058F\u0591-\u05C7\u05D0-\u05EA\u05EF-\u05F4\u0606-\u061B\u061D-\u06DC\u06DE-\u070D\u0710-\u074A\u074D-\u07B1\u07C0-\u07FA\u07FD-\u082D\u0830-\u083E\u0840-\u085B\u085E\u0860-\u086A\u0870-\u088E\u0897-\u08E1\u08E3-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A76\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AF1\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BFA\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C77-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4F\u0D54-\u0D63\u0D66-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2-\u0DF4\u0E01-\u0E3A\u0E3F-\u0E5B\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00-\u0F47\u0F49-\u0F6C\u0F71-\u0F97\u0F99-\u0FBC\u0FBE-\u0FCC\u0FCE-\u0FDA\u1000-\u10C5\u10C7\u10CD\u10D0-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u137C\u1380-\u1399\u13A0-\u13F5\u13F8-\u13FD\u1400-\u167F\u1681-\u169C\u16A0-\u16F8\u1700-\u1715\u171F-\u1736\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17DD\u17E0-\u17E9\u17F0-\u17F9\u1800-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1940\u1944-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u19DE-\u1A1B\u1A1E-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA0-\u1AAD\u1AB0-\u1ACE\u1B00-\u1B4C\u1B4E-\u1BF3\u1BFC-\u1C37\u1C3B-\u1C49\u1C4D-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CC7\u1CD0-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FC4\u1FC6-\u1FD3\u1FD6-\u1FDB\u1FDD-\u1FEF\u1FF2-\u1FF4\u1FF6-\u1FFE\u2010-\u2027\u2030-\u205E\u2070\u2071\u2074-\u208E\u2090-\u209C\u20A0-\u20C0\u20D0-\u20F0\u2100-\u218B\u2190-\u2429\u2440-\u244A\u2460-\u2B73\u2B76-\u2B95\u2B97-\u2CF3\u2CF9-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D70\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2E5D\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3001-\u303F\u3041-\u3096\u3099-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\u31E5\u31EF-\u321E\u3220-\uA48C\uA490-\uA4C6\uA4D0-\uA62B\uA640-\uA6F7\uA700-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA82C\uA830-\uA839\uA840-\uA877\uA880-\uA8C5\uA8CE-\uA8D9\uA8E0-\uA953\uA95F-\uA97C\uA980-\uA9CD\uA9CF-\uA9D9\uA9DE-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA5C-\uAAC2\uAADB-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB6B\uAB70-\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBC2\uFBD3-\uFD8F\uFD92-\uFDC7\uFDCF\uFDF0-\uFE19\uFE20-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE74\uFE76-\uFEFC\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10100}-\u{10102}\u{10107}-\u{10133}\u{10137}-\u{1018E}\u{10190}-\u{1019C}\u{101A0}\u{101D0}-\u{101FD}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{102E0}-\u{102FB}\u{10300}-\u{10323}\u{1032D}-\u{1034A}\u{10350}-\u{1037A}\u{10380}-\u{1039D}\u{1039F}-\u{103C3}\u{103C8}-\u{103D5}\u{10400}-\u{1049D}\u{104A0}-\u{104A9}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{1056F}-\u{1057A}\u{1057C}-\u{1058A}\u{1058C}-\u{10592}\u{10594}\u{10595}\u{10597}-\u{105A1}\u{105A3}-\u{105B1}\u{105B3}-\u{105B9}\u{105BB}\u{105BC}\u{105C0}-\u{105F3}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10780}-\u{10785}\u{10787}-\u{107B0}\u{107B2}-\u{107BA}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10857}-\u{1089E}\u{108A7}-\u{108AF}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{108FB}-\u{1091B}\u{1091F}-\u{10939}\u{1093F}\u{10980}-\u{109B7}\u{109BC}-\u{109CF}\u{109D2}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A38}-\u{10A3A}\u{10A3F}-\u{10A48}\u{10A50}-\u{10A58}\u{10A60}-\u{10A9F}\u{10AC0}-\u{10AE6}\u{10AEB}-\u{10AF6}\u{10B00}-\u{10B35}\u{10B39}-\u{10B55}\u{10B58}-\u{10B72}\u{10B78}-\u{10B91}\u{10B99}-\u{10B9C}\u{10BA9}-\u{10BAF}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10CFA}-\u{10D27}\u{10D30}-\u{10D39}\u{10D40}-\u{10D65}\u{10D69}-\u{10D85}\u{10D8E}\u{10D8F}\u{10E60}-\u{10E7E}\u{10E80}-\u{10EA9}\u{10EAB}-\u{10EAD}\u{10EB0}\u{10EB1}\u{10EC2}-\u{10EC4}\u{10EFC}-\u{10F27}\u{10F30}-\u{10F59}\u{10F70}-\u{10F89}\u{10FB0}-\u{10FCB}\u{10FE0}-\u{10FF6}\u{11000}-\u{1104D}\u{11052}-\u{11075}\u{1107F}-\u{110BC}\u{110BE}-\u{110C2}\u{110D0}-\u{110E8}\u{110F0}-\u{110F9}\u{11100}-\u{11134}\u{11136}-\u{11147}\u{11150}-\u{11176}\u{11180}-\u{111DF}\u{111E1}-\u{111F4}\u{11200}-\u{11211}\u{11213}-\u{11241}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A9}\u{112B0}-\u{112EA}\u{112F0}-\u{112F9}\u{11300}-\u{11303}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133B}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11350}\u{11357}\u{1135D}-\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11380}-\u{11389}\u{1138B}\u{1138E}\u{11390}-\u{113B5}\u{113B7}-\u{113C0}\u{113C2}\u{113C5}\u{113C7}-\u{113CA}\u{113CC}-\u{113D5}\u{113D7}\u{113D8}\u{113E1}\u{113E2}\u{11400}-\u{1145B}\u{1145D}-\u{11461}\u{11480}-\u{114C7}\u{114D0}-\u{114D9}\u{11580}-\u{115B5}\u{115B8}-\u{115DD}\u{11600}-\u{11644}\u{11650}-\u{11659}\u{11660}-\u{1166C}\u{11680}-\u{116B9}\u{116C0}-\u{116C9}\u{116D0}-\u{116E3}\u{11700}-\u{1171A}\u{1171D}-\u{1172B}\u{11730}-\u{11746}\u{11800}-\u{1183B}\u{118A0}-\u{118F2}\u{118FF}-\u{11906}\u{11909}\u{1190C}-\u{11913}\u{11915}\u{11916}\u{11918}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{11946}\u{11950}-\u{11959}\u{119A0}-\u{119A7}\u{119AA}-\u{119D7}\u{119DA}-\u{119E4}\u{11A00}-\u{11A47}\u{11A50}-\u{11AA2}\u{11AB0}-\u{11AF8}\u{11B00}-\u{11B09}\u{11BC0}-\u{11BE1}\u{11BF0}-\u{11BF9}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C36}\u{11C38}-\u{11C45}\u{11C50}-\u{11C6C}\u{11C70}-\u{11C8F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D47}\u{11D50}-\u{11D59}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D98}\u{11DA0}-\u{11DA9}\u{11EE0}-\u{11EF8}\u{11F00}-\u{11F10}\u{11F12}-\u{11F3A}\u{11F3E}-\u{11F5A}\u{11FB0}\u{11FC0}-\u{11FF1}\u{11FFF}-\u{12399}\u{12400}-\u{1246E}\u{12470}-\u{12474}\u{12480}-\u{12543}\u{12F90}-\u{12FF2}\u{13000}-\u{1342F}\u{13440}-\u{13455}\u{13460}-\u{143FA}\u{14400}-\u{14646}\u{16100}-\u{16139}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16A60}-\u{16A69}\u{16A6E}-\u{16ABE}\u{16AC0}-\u{16AC9}\u{16AD0}-\u{16AED}\u{16AF0}-\u{16AF5}\u{16B00}-\u{16B45}\u{16B50}-\u{16B59}\u{16B5B}-\u{16B61}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16D40}-\u{16D79}\u{16E40}-\u{16E9A}\u{16F00}-\u{16F4A}\u{16F4F}-\u{16F87}\u{16F8F}-\u{16F9F}\u{16FE0}-\u{16FE4}\u{16FF0}\u{16FF1}\u{17000}-\u{187F7}\u{18800}-\u{18CD5}\u{18CFF}-\u{18D08}\u{1AFF0}-\u{1AFF3}\u{1AFF5}-\u{1AFFB}\u{1AFFD}\u{1AFFE}\u{1B000}-\u{1B122}\u{1B132}\u{1B150}-\u{1B152}\u{1B155}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1BC9C}-\u{1BC9F}\u{1CC00}-\u{1CCF9}\u{1CD00}-\u{1CEB3}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1CF50}-\u{1CFC3}\u{1D000}-\u{1D0F5}\u{1D100}-\u{1D126}\u{1D129}-\u{1D172}\u{1D17B}-\u{1D1EA}\u{1D200}-\u{1D245}\u{1D2C0}-\u{1D2D3}\u{1D2E0}-\u{1D2F3}\u{1D300}-\u{1D356}\u{1D360}-\u{1D378}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D7CB}\u{1D7CE}-\u{1DA8B}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1DF00}-\u{1DF1E}\u{1DF25}-\u{1DF2A}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E030}-\u{1E06D}\u{1E08F}\u{1E100}-\u{1E12C}\u{1E130}-\u{1E13D}\u{1E140}-\u{1E149}\u{1E14E}\u{1E14F}\u{1E290}-\u{1E2AE}\u{1E2C0}-\u{1E2F9}\u{1E2FF}\u{1E4D0}-\u{1E4F9}\u{1E5D0}-\u{1E5FA}\u{1E5FF}\u{1E7E0}-\u{1E7E6}\u{1E7E8}-\u{1E7EB}\u{1E7ED}\u{1E7EE}\u{1E7F0}-\u{1E7FE}\u{1E800}-\u{1E8C4}\u{1E8C7}-\u{1E8D6}\u{1E900}-\u{1E94B}\u{1E950}-\u{1E959}\u{1E95E}\u{1E95F}\u{1EC71}-\u{1ECB4}\u{1ED01}-\u{1ED3D}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{1EEF0}\u{1EEF1}\u{1F000}-\u{1F02B}\u{1F030}-\u{1F093}\u{1F0A0}-\u{1F0AE}\u{1F0B1}-\u{1F0BF}\u{1F0C1}-\u{1F0CF}\u{1F0D1}-\u{1F0F5}\u{1F100}-\u{1F1AD}\u{1F1E6}-\u{1F202}\u{1F210}-\u{1F23B}\u{1F240}-\u{1F248}\u{1F250}\u{1F251}\u{1F260}-\u{1F265}\u{1F300}-\u{1F6D7}\u{1F6DC}-\u{1F6EC}\u{1F6F0}-\u{1F6FC}\u{1F700}-\u{1F776}\u{1F77B}-\u{1F7D9}\u{1F7E0}-\u{1F7EB}\u{1F7F0}\u{1F800}-\u{1F80B}\u{1F810}-\u{1F847}\u{1F850}-\u{1F859}\u{1F860}-\u{1F887}\u{1F890}-\u{1F8AD}\u{1F8B0}-\u{1F8BB}\u{1F8C0}\u{1F8C1}\u{1F900}-\u{1FA53}\u{1FA60}-\u{1FA6D}\u{1FA70}-\u{1FA7C}\u{1FA80}-\u{1FA89}\u{1FA8F}-\u{1FAC6}\u{1FACE}-\u{1FADC}\u{1FADF}-\u{1FAE9}\u{1FAF0}-\u{1FAF8}\u{1FB00}-\u{1FB92}\u{1FB94}-\u{1FBF9}\u{20000}-\u{2A6DF}\u{2A700}-\u{2B739}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2EBF0}-\u{2EE5D}\u{2F800}-\u{2FA1D}\u{30000}-\u{3134A}\u{31350}-\u{323AF}\u{E0100}-\u{E01EF}]/u.test(W.key);if((he||K)&&W.bounds!==void 0&&so(p([O-$,Math.max(0,Math.min(ve,le-1))]))){if((!a||ve!==le)&&(q.y>ve||ve>q.y+q.height||q.x>O||O>q.x+q.width))return;if(W.stopPropagation(),W.preventDefault(),he){const re={inputType:"keyboard",key:""};v==null||v([O-$,ve],re),oe(W.bounds,re,"")}else{const re={inputType:"keyboard",key:W.key};v==null||v([O-$,ve],re),oe(W.bounds,re,W.key)}}}}}function xc(e,t,n,o,i,l,u){const r=sn.c(24);let s;r[0]!==o||r[1]!==e||r[2]!==n||r[3]!==l||r[4]!==u||r[5]!==i||r[6]!==t?(s=(v,C,p,w)=>{var b,x;(l==="cell"||l==="multi-cell")&&v!==void 0&&(v={...v,range:{x:v.cell[0],y:v.cell[1],width:1,height:1}}),!u&&v!==void 0&&v.range.width>1&&(v={...v,range:{...v.range,width:1,x:v.cell[0]}});const E=n==="mixed"&&(p||w==="drag")||n==="additive",H=(o==="mixed"||o==="additive")&&E,B=p||(i==="mixed"||i==="additive")&&E;let S={current:v===void 0?void 0:{...v,rangeStack:w==="drag"?(b=(x=e.current)===null||x===void 0?void 0:x.rangeStack)!==null&&b!==void 0?b:[]:[]},columns:H?e.columns:Je.empty(),rows:B?e.rows:Je.empty()};p&&(l==="multi-rect"||l==="multi-cell")&&S.current!==void 0&&e.current!==void 0&&(S={...S,current:{...S.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(S,C)},r[0]=o,r[1]=e,r[2]=n,r[3]=l,r[4]=u,r[5]=i,r[6]=t,r[7]=s):s=r[7];const a=s;let d;r[8]!==o||r[9]!==e||r[10]!==n||r[11]!==i||r[12]!==t?(d=(v,C,p)=>{v=v??e.rows,C!==void 0&&(v=v.add(C));let w;if(i==="exclusive"&&v.length>0)w={current:void 0,columns:Je.empty(),rows:v};else{const b=p&&n==="mixed"||n==="additive",x=p&&o==="mixed"||o==="additive";w={current:b?e.current:void 0,columns:x?e.columns:Je.empty(),rows:v}}t(w,!1)},r[8]=o,r[9]=e,r[10]=n,r[11]=i,r[12]=t,r[13]=d):d=r[13];const h=d;let g;r[14]!==o||r[15]!==e||r[16]!==n||r[17]!==i||r[18]!==t?(g=(v,C,p)=>{v=v??e.columns,C!==void 0&&(v=v.add(C));let w;if(o==="exclusive"&&v.length>0)w={current:void 0,rows:Je.empty(),columns:v};else{const b=p&&n==="mixed"||n==="additive",x=p&&i==="mixed"||i==="additive";w={current:b?e.current:void 0,rows:x?e.rows:Je.empty(),columns:v}}t(w,!1)},r[14]=o,r[15]=e,r[16]=n,r[17]=i,r[18]=t,r[19]=g):g=r[19];const m=g;let f;return r[20]!==a||r[21]!==m||r[22]!==h?(f=[a,h,m],r[20]=a,r[21]=m,r[22]=h,r[23]=f):f=r[23],f}function Fc(e,t,n,o,i){const u=e!==void 0?a=>{var d;if(e===!0){const h=[];for(let g=a.y;g<a.y+a.height;g++){const m=[];for(let f=a.x;f<a.x+a.width;f++)f<0||g>=i?m.push({kind:te.Loading,allowOverlay:!1}):m.push(t([f,g]));h.push(m)}return h}return(d=e==null?void 0:e(a,o.signal))!==null&&d!==void 0?d:[]}:void 0;return[e!==void 0?a=>{if(u===void 0)return[];const d={...a,x:a.x-n};if(d.x<0){d.x=0,d.width--;const h=u(d,o.signal);return typeof h=="function"?async()=>(await h()).map(g=>[{kind:te.Loading,allowOverlay:!1},...g]):h.map(g=>[{kind:te.Loading,allowOverlay:!1},...g])}return u(d,o.signal)}:void 0,u]}function Jr(e){return typeof e=="string"?e:`${e}px`}const Dc=()=>e=>e.innerWidth,kc=()=>e=>e.innerHeight,Sc=_t("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Dc()],"wmyidgi-1":[kc()]}}),Rc=e=>{const{inWidth:t,inHeight:n,children:o,...i}=e;return c.createElement(Sc,{innerHeight:Jr(n),innerWidth:Jr(t),...i},o)},Mc=2,Ac=1300;function Bc(e,t,n){const o=sn.c(8),i=Xn.useRef(0);let l;o[0]!==e?(l=e??[0,0],o[0]=e,o[1]=l):l=o[1];const[u,r]=l;let s,a;o[2]!==n||o[3]!==t||o[4]!==u||o[5]!==r?(s=()=>{if(u===0&&r===0){i.current=0;return}let d=!1,h=0;const g=m=>{if(!d){if(h===0)h=m;else{var f;const v=m-h;i.current=Math.min(1,i.current+v/Ac);const C=i.current**1.618*v*Mc;(f=t.current)===null||f===void 0||f.scrollBy(u*C,r*C),h=m,n==null||n()}window.requestAnimationFrame(g)}};return window.requestAnimationFrame(g),()=>{d=!0}},a=[t,u,r,n],o[2]=n,o[3]=t,o[4]=u,o[5]=r,o[6]=s,o[7]=a):(s=o[6],a=o[7]),Xn.useEffect(s,a)}function Ic(e){const t=sn.c(38),{state:n,keybindings:o,getCellsForSelection:i,coercePasteValue:l,onPaste:u,copyHeaders:r,columnsIn:s,onDelete:a,deleteRange:d,safeWindow:h}=e,{gridSelection:g,gridRef:m,scrollRef:f,canvasRef:v,abortControllerRef:C,rowMarkerOffset:p,mangledCols:w,mangledRows:b,rows:x,getMangledCellContent:E,mangledOnCellsEdited:H,getCellRenderer:B}=n;let S;t[0]!==v||t[1]!==l||t[2]!==B||t[3]!==E||t[4]!==m||t[5]!==g||t[6]!==o.paste||t[7]!==w||t[8]!==H||t[9]!==b||t[10]!==u||t[11]!==p||t[12]!==x||t[13]!==f?(S=async M=>{var G,$;if(!o.paste)return;const le=function(O,ve,q,he){var K,re;const ke=typeof q=="object"?(K=q==null?void 0:q.join(`
`))!==null&&K!==void 0?K:"":(re=q==null?void 0:q.toString())!==null&&re!==void 0?re:"";if(!Co(O)&&so(O)&&O.readonly!==!0){const Ve=l==null?void 0:l(ke,O);if(Ve!==void 0&&Kn(Ve))return{location:ve,value:Ve};const ce=B(O);if(ce===void 0)return;if(ce.kind===te.Custom){var J;ln(O.kind===te.Custom);const T=(J=ce.onPaste)===null||J===void 0?void 0:J.call(ce,ke,O.data);return T===void 0?void 0:{location:ve,value:{...O,data:T}}}else{var Be;const T=(Be=ce.onPaste)===null||Be===void 0?void 0:Be.call(ce,ke,O,{formatted:he,formattedString:typeof he=="string"?he:he==null?void 0:he.join(`
`),rawValue:q});return T===void 0?void 0:(ln(T.kind===O.kind),{location:ve,value:T})}}},Y=g.columns,ne=g.rows,se=((G=f.current)===null||G===void 0?void 0:G.contains(document.activeElement))===!0||(($=v.current)===null||$===void 0?void 0:$.contains(document.activeElement))===!0;let X;if(g.current!==void 0)X=[g.current.range.x,g.current.range.y];else if(Y.length===1){var oe;X=[(oe=Y.first())!==null&&oe!==void 0?oe:0,0]}else if(ne.length===1){var ae;X=[p,(ae=ne.first())!==null&&ae!==void 0?ae:0]}if(se&&X!==void 0){var de;let me,O;if(navigator.clipboard.read!==void 0){const K=await navigator.clipboard.read();for(const re of K){if(re.types.includes("text/html")){const J=await(await re.getType("text/html")).text(),Be=qr(J);if(Be!==void 0){me=Be;break}}re.types.includes("text/plain")&&(O=await(await re.getType("text/plain")).text())}}else if(navigator.clipboard.readText!==void 0)O=await navigator.clipboard.readText();else if(M!==void 0&&(M==null?void 0:M.clipboardData)!==null){if(M.clipboardData.types.includes("text/html")){const K=M.clipboardData.getData("text/html");me=qr(K)}me===void 0&&M.clipboardData.types.includes("text/plain")&&(O=M.clipboardData.getData("text/plain"))}else return;const[ve,q]=X,he=[];do{if(u===void 0){var pe,W;const K=E(X),re=(pe=O??((W=me)===null||W===void 0?void 0:W.map(Wc).join("	")))!==null&&pe!==void 0?pe:"",ke=le(K,X,re,void 0);ke!==void 0&&he.push(ke);break}if(me===void 0){if(O===void 0)return;me=bc(O)}if(u===!1||typeof u=="function"&&(u==null?void 0:u([X[0]-p,X[1]],me.map(Lc)))!==!0)return;for(const[K,re]of me.entries()){if(K+q>=x)break;for(const[ke,J]of re.entries()){const Be=[ke+ve,K+q],[Ve,ce]=Be;if(Ve>=w.length||ce>=b)continue;const T=E(Be),ie=le(T,Be,J.rawValue,J.formatted);ie!==void 0&&he.push(ie)}}}while(!1);H(he),(de=m.current)===null||de===void 0||de.damage(he.map(Pc))}},t[0]=v,t[1]=l,t[2]=B,t[3]=E,t[4]=m,t[5]=g,t[6]=o.paste,t[7]=w,t[8]=H,t[9]=b,t[10]=u,t[11]=p,t[12]=x,t[13]=f,t[14]=S):S=t[14];const D=S;qt("paste",D,h,!1,!0);let k;t[15]!==C||t[16]!==v||t[17]!==s||t[18]!==r||t[19]!==i||t[20]!==g||t[21]!==o.copy||t[22]!==p||t[23]!==x||t[24]!==f?(k=async(M,G)=>{var $,le;if(!o.copy)return;const Y=G===!0||(($=f.current)===null||$===void 0?void 0:$.contains(document.activeElement))===!0||((le=v.current)===null||le===void 0?void 0:le.contains(document.activeElement))===!0,ne=g.columns,se=g.rows,X=(oe,ae)=>{if(!r)Zr(oe,ae,M);else{const de=ae.map(pe=>({kind:te.Text,data:s[pe].title,displayData:s[pe].title,allowOverlay:!1}));Zr([de,...oe],ae,M)}};if(Y&&i!==void 0){if(g.current!==void 0){let oe=i(g.current.range,C.current.signal);typeof oe!="object"&&(oe=await oe()),X(oe,po(g.current.range.x-p,g.current.range.x+g.current.range.width-p))}else if(se!==void 0&&se.length>0){const ae=[...se].map(de=>{const pe=i({x:p,y:de,width:s.length,height:1},C.current.signal);return typeof pe=="object"?pe[0]:pe().then(zc)});if(ae.some(Tc)){const de=await Promise.all(ae);X(de,po(s.length))}else X(ae,po(s.length))}else if(ne.length>0){const oe=[],ae=[];for(const de of ne){let pe=i({x:de,y:0,width:1,height:x},C.current.signal);typeof pe!="object"&&(pe=await pe()),oe.push(pe),ae.push(de-p)}if(oe.length===1)X(oe[0],ae);else{const de=oe.reduce(Hc);X(de,ae)}}}},t[15]=C,t[16]=v,t[17]=s,t[18]=r,t[19]=i,t[20]=g,t[21]=o.copy,t[22]=p,t[23]=x,t[24]=f,t[25]=k):k=t[25];const I=k;qt("copy",I,h,!1,!1);let R;t[26]!==v||t[27]!==d||t[28]!==g||t[29]!==o.cut||t[30]!==I||t[31]!==a||t[32]!==f?(R=async M=>{var G,$;if(!(!o.cut||!(((G=f.current)===null||G===void 0?void 0:G.contains(document.activeElement))===!0||(($=v.current)===null||$===void 0?void 0:$.contains(document.activeElement))===!0))&&(await I(M),g.current!==void 0)){let Y={current:{cell:g.current.cell,range:g.current.range,rangeStack:[]},rows:Je.empty(),columns:Je.empty()};const ne=a==null?void 0:a(Y);if(ne===!1||(Y=ne===void 0||ne===!0?Y:ne,Y.current===void 0))return;d(Y.current.range)}},t[26]=v,t[27]=d,t[28]=g,t[29]=o.cut,t[30]=I,t[31]=a,t[32]=f,t[33]=R):R=t[33];const z=R;qt("cut",z,h,!1,!1);let F;return t[34]!==I||t[35]!==z||t[36]!==D?(F={onCopy:I,onCut:z,onPasteInternal:D},t[34]=I,t[35]=z,t[36]=D,t[37]=F):F=t[37],F}function Hc(e,t){return e.map((n,o)=>[...n,...t[o]])}function Tc(e){return e instanceof Promise}function zc(e){return e[0]}function Pc(e){return{cell:e.location}}function Lc(e){return e.map(Oc)}function Oc(e){var t,n;return(t=(n=e.rawValue)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""}function Wc(e){return e.map(Nc).join("	")}function Nc(e){return e.rawValue}function Gc(e){let{rowHeight:t,headerHeight:n,groupHeaderHeight:o,theme:i,overscrollX:l,overscrollY:u,scaleToRem:r,remSize:s}=e;const[a,d,h,g,m,f]=((v,C,p)=>{if(!r||s===16)return[t,n,o,i,l,u];const w=s/16,b=t,x=mu();return[typeof b=="number"?b*w:E=>Math.ceil(b(E)*w),Math.ceil(n*w),Math.ceil(o*w),{...i,headerIconSize:((v=i==null?void 0:i.headerIconSize)!==null&&v!==void 0?v:x.headerIconSize)*w,cellHorizontalPadding:((C=i==null?void 0:i.cellHorizontalPadding)!==null&&C!==void 0?C:x.cellHorizontalPadding)*w,cellVerticalPadding:((p=i==null?void 0:i.cellVerticalPadding)!==null&&p!==void 0?p:x.cellVerticalPadding)*w},Math.ceil((l??0)*w),Math.ceil((u??0)*w)]})();return{rowHeight:a,headerHeight:d,groupHeaderHeight:h,theme:g,overscrollX:m,overscrollY:f}}const oo={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function qe(e,t){return e===!0?t:e===!1?"":e}function Qr(e){const t=ol.value;return{activateCell:qe(e.activateCell," |Enter|shift+Enter"),clear:qe(e.clear,"any+Escape"),closeOverlay:qe(e.closeOverlay,"any+Escape"),acceptOverlayDown:qe(e.acceptOverlayDown,"Enter"),acceptOverlayUp:qe(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:qe(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:qe(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:qe(e.delete,t?"Backspace|Delete":"Delete"),downFill:qe(e.downFill,"primary+_68"),scrollToSelectedCell:qe(e.scrollToSelectedCell,"primary+Enter"),goDownCell:qe(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:qe(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:qe(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:qe(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:qe(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:qe(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:qe(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:qe(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:qe(e.goToFirstCell,"primary+Home"),goToFirstColumn:qe(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:qe(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:qe(e.goToLastCell,"primary+End"),goToLastColumn:qe(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:qe(e.goToLastRow,"primary+ArrowDown"),goToNextPage:qe(e.goToNextPage,"PageDown"),goToPreviousPage:qe(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:qe(e.rightFill,"primary+_82"),search:qe(e.search,"primary+f"),selectAll:qe(e.selectAll,"primary+a"),selectColumn:qe(e.selectColumn,"ctrl+ "),selectGrowDown:qe(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:qe(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:qe(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:qe(e.selectGrowUp,"shift+ArrowUp"),selectRow:qe(e.selectRow,"shift+ "),selectToFirstCell:qe(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:qe(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:qe(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:qe(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:qe(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:qe(e.selectToLastRow,"primary+shift+ArrowDown")}}function $c(e){const t=sn.c(9),n=od(e);let o;e:{var i,l,u,r,s,a,d,h,g,m,f,v;if(n===void 0){let B;t[0]===Symbol.for("react.memo_cache_sentinel")?(B=Qr(oo),t[0]=B):B=t[0],o=B;break e}const C=(i=(l=n==null?void 0:n.goToNextPage)!==null&&l!==void 0?l:n==null?void 0:n.pageDown)!==null&&i!==void 0?i:oo.goToNextPage,p=(u=(r=n==null?void 0:n.goToPreviousPage)!==null&&r!==void 0?r:n==null?void 0:n.pageUp)!==null&&u!==void 0?u:oo.goToPreviousPage,w=(s=(a=n==null?void 0:n.goToFirstCell)!==null&&a!==void 0?a:n==null?void 0:n.first)!==null&&s!==void 0?s:oo.goToFirstCell,b=(d=(h=n==null?void 0:n.goToLastCell)!==null&&h!==void 0?h:n==null?void 0:n.last)!==null&&d!==void 0?d:oo.goToLastCell,x=(g=(m=n==null?void 0:n.selectToFirstCell)!==null&&m!==void 0?m:n==null?void 0:n.first)!==null&&g!==void 0?g:oo.selectToFirstCell,E=(f=(v=n==null?void 0:n.selectToLastCell)!==null&&v!==void 0?v:n==null?void 0:n.last)!==null&&f!==void 0?f:oo.selectToLastCell;let H;if(t[1]!==n||t[2]!==C||t[3]!==p||t[4]!==w||t[5]!==b||t[6]!==x||t[7]!==E){const B={...n,goToNextPage:C,goToPreviousPage:p,goToFirstCell:w,goToLastCell:b,selectToFirstCell:x,selectToLastCell:E};H=Qr({...oo,...B}),t[1]=n,t[2]=C,t[3]=p,t[4]=w,t[5]=b,t[6]=x,t[7]=E,t[8]=H}else H=t[8];o=H}return o}function Xc(e){function t(o,i,l){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:i,path:l};const u={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:i,path:l};return o.subGroups!==void 0&&(u.subGroups=o.subGroups.map((r,s)=>t(r,i+1,[...l,s])).sort((r,s)=>r.headerIndex-s.headerIndex)),u}return e.map((o,i)=>t(o,0,[i])).sort((o,i)=>o.headerIndex-i.headerIndex)}function rr(e,t){const n=[];function o(r,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=s!==null?s-r.headerIndex:t-r.headerIndex;if(r.subGroups!==void 0&&(d=r.subGroups[0].headerIndex-r.headerIndex),d--,n.push({rowIndex:-1,headerIndex:r.headerIndex,contentIndex:-1,skip:a,isCollapsed:r.isCollapsed,depth:r.depth,path:r.path,rows:d}),r.subGroups)for(let h=0;h<r.subGroups.length;h++){const g=h<r.subGroups.length-1?r.subGroups[h+1].headerIndex:s;o(r.subGroups[h],g,a||r.isCollapsed)}}const i=Xc(e.groups);for(let r=0;r<i.length;r++){const s=r<i.length-1?i[r+1].headerIndex:null;o(i[r],s)}let l=0,u=0;for(const r of n)r.contentIndex=u,u+=r.rows,r.rowIndex=l,l+=r.isCollapsed?1:r.rows+1;return n.filter(r=>r.skip===!1).map(r=>{const{skip:s,...a}=r;return a})}function Vl(e,t){if(t===void 0||rr.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Kc(e,t,n,o){const i=e===void 0?void 0:rr(e,t),l=i==null?void 0:i.reduce((d,h)=>(d[h.rowIndex]=h,d),{}),u=i===void 0?t:i.reduce((d,h)=>d+(h.isCollapsed?1:h.rows+1),0),r=e===void 0||typeof n=="number"&&e.height===n?n:d=>l!=null&&l[d]?e.height:typeof n=="number"?n:n(d),s=d=>{if(i===void 0)return d;let h=d;for(const g of i){if(h===0)return;if(h--,!g.isCollapsed){if(h<g.rows)return g.contentIndex+h;h-=g.rows}}return d},a=lo(o??(e==null?void 0:e.themeOverride),d=>{if(e===void 0)return o==null?void 0:o(d,d,d);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:h,contentIndex:g,groupIndex:m}=Vl(d,i);return h?e.themeOverride:o==null?void 0:o(d,m,g)});return e===void 0?{rowHeight:r,rows:t,rowNumberMapper:s,getRowThemeOverride:a}:{rowHeight:r,rows:u,rowNumberMapper:s,getRowThemeOverride:a}}function Yc(e,t){const n=sn.c(7);let o;n[0]!==e||n[1]!==t?(o=e===void 0?void 0:rr(e,t),n[0]=e,n[1]=t,n[2]=o):o=n[2];const i=o;let l;n[3]!==i?(l=s=>{if(typeof s=="number")return Vl(s,i);const a=Vl(s[1],i);return{...a,originalIndex:[s[0],a.originalIndex]}},n[3]=i,n[4]=l):l=n[4];const u=l;let r;return n[5]!==u?(r={getRowGroupingForPath:Gu,updateRowGroupingByPath:Nu,mapper:u},n[5]=u,n[6]=r):r=n[6],r}function Nu(e,t,n){const[o,...i]=t;return i[0]===-1?e.map((l,u)=>u===o?{...l,...n}:l):e.map((l,u)=>{var r;return u===o?{...l,subGroups:Nu((r=l.subGroups)!==null&&r!==void 0?r:[],i,n)}:l})}function Gu(e,t){var n;const[o,...i]=t;return i[0]===-1?e[o]:Gu((n=e[o].subGroups)!==null&&n!==void 0?n:[],i)}function Vc(e,t){const[n]=c.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const i=n.value;i!==o&&(n.value=o,n.callback(o,i))}}}));return n.callback=t,n.facade}function Uc(e,t,n,o,i){var l,u,r,s;const[a,d]=[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],h={x:o.current.x,y:a,width:(l=o.current.width)!==null&&l!==void 0?l:1,height:(u=o.current.height)!==null&&u!==void 0?u:1,ty:d},[g,m,f]=nd(h),v=c.useRef(i);v.current=i;const C=Vc(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),p=((r=g.height)!==null&&r!==void 0?r:1)>1;c.useLayoutEffect(()=>{if(t!==void 0&&C.current!==null&&p){if(C.current.scrollTop===t)return;C.current.scrollTop=t,C.current.scrollTop!==t&&f(),v.current()}},[t,p,f,C]);const w=((s=g.width)!==null&&s!==void 0?s:1)>1;return c.useLayoutEffect(()=>{if(e!==void 0&&C.current!==null&&w){if(C.current.scrollLeft===e)return;C.current.scrollLeft=e,C.current.scrollLeft!==e&&f(),v.current()}},[e,w,f,C]),{visibleRegion:g,setVisibleRegion:m,scrollRef:C}}const jc=_t("textarea")({name:"GhostInputBox",class:"gdg-g1wsindo",propsAsIs:!1}),qc=(e,t)=>{const{onInput:n,onCompositionStart:o,onCompositionEnd:i,onKeyDown:l,onKeyUp:u,onFocus:r,onBlur:s,disabled:a=!1}=e,d=c.useRef(null),h=c.useRef(!1),g=c.useRef({width:0,height:0}),m=c.useCallback(()=>{const b=d.current;if(!b||b.style.opacity==="0")return;const x=g.current.width,E=g.current.height;b.style.width=`${x}px`,b.style.height=`${E}px`;const H=Math.max(x,b.scrollWidth+2),B=Math.max(E,b.scrollHeight+2);b.style.width=`${H}px`,b.style.height=`${B}px`},[]);c.useImperativeHandle(t,()=>({focus:()=>{var b;(b=d.current)===null||b===void 0||b.focus({preventScroll:!0})},blur:()=>{var b;(b=d.current)===null||b===void 0||b.blur()},clear:()=>{d.current&&(d.current.value="",d.current.setSelectionRange(0,0))},getValue:()=>{var b,x;return(b=(x=d.current)===null||x===void 0?void 0:x.value)!==null&&b!==void 0?b:""},setValue:b=>{if(d.current){d.current.value=b;const x=b.length;d.current.setSelectionRange(x,x)}},setPosition:(b,x,E,H)=>{const B=d.current;B&&(g.current={width:E,height:H},B.style.left=`${b}px`,B.style.top=`${x}px`,B.style.width=`${E}px`,B.style.height=`${H}px`)},setVisible:b=>{const x=d.current;x&&(b?(x.style.opacity="1",x.style.pointerEvents="auto",x.style.zIndex="10000"):(x.style.left="-9999px",x.style.top="0",x.style.width="1px",x.style.height="1px",x.style.opacity="0",x.style.pointerEvents="none",x.style.zIndex="0"))}}));const f=c.useCallback(b=>{const x=b.currentTarget;n(x.value,h.current),m()},[n,m]),v=c.useCallback(()=>{h.current=!0,o()},[o]),C=c.useCallback(b=>{h.current=!1,i(b.currentTarget.value)},[i]),p=c.useCallback(b=>{l(b)},[l]),w=c.useCallback(b=>{u==null||u(b)},[u]);return c.createElement(jc,{ref:d,defaultValue:"",tabIndex:a?-1:0,disabled:a,onInput:f,onCompositionStart:v,onCompositionEnd:C,onKeyDown:p,onKeyUp:w,onFocus:r,onBlur:s,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},_c=c.memo(c.forwardRef(qc)),Zc=e=>{};function Jc(e){const{state:t,onKeyDown:n,onFinishEditing:o,onKeyUpIn:i,onCellActivated:l,setIsFocused:u}=e,{gridSelection:r,overlayRef:s,ghostInputRef:a,ghostInputVisibleRef:d,gridRef:h,rowMarkerOffset:g,getMangledCellContent:m,reselect:f}=t;return{onGhostInput:(E,H)=>{if(s.current===void 0&&!H&&E.length>0&&E.trim().length>0&&r.current!==void 0){const[S,D]=r.current.cell,k=m([S,D]);if(k.kind===te.Custom){const I=k.data,R=I==null?void 0:I.kind;if(R!=="number-cell"&&R!=="date-picker-cell")return}if(k.allowOverlay&&so(k)&&k.readonly!==!0){var B;const I=(B=h.current)===null||B===void 0?void 0:B.getBounds(S,D);if(I!==void 0){const R={inputType:"keyboard",key:E};l==null||l([S-g,D],R),f(I,R,E)}}}},onGhostCompositionStart:()=>{var E;if(r.current===void 0)return;const[H,B]=r.current.cell,S=(E=s.current)===null||E===void 0?void 0:E.cell;if(S!==void 0&&(S[0]!==H||S[1]!==B)){var D,k;(D=a.current)===null||D===void 0||D.clear(),(k=a.current)===null||k===void 0||k.setVisible(!1),t.setGhostInputVisible(!1),s.current=void 0,t.setOverlay(void 0)}if(s.current===void 0){const z=m([H,B]);if(z.kind===te.Custom){const F=z.data,M=F==null?void 0:F.kind;if(M!=="number-cell"&&M!=="date-picker-cell")return}if(z.allowOverlay&&so(z)&&z.readonly!==!0){var I;const F=(I=h.current)===null||I===void 0?void 0:I.getBounds(H,B);if(F!==void 0){var R;(R=a.current)===null||R===void 0||R.clear();const M={inputType:"keyboard",key:""};l==null||l([H-g,B],M),f(F,M,"")}}}},onGhostCompositionEnd:Zc,onGhostKeyDown:E=>{var H,B;if(E.nativeEvent.isComposing)return;if(s.current!==void 0&&d.current){const R=E.key;if(s.current.content.kind===te.Custom){(R==="Enter"||R==="Tab"||R==="Escape")&&(E.preventDefault(),E.stopPropagation());return}if(R==="Escape"){E.preventDefault(),E.stopPropagation(),o(void 0,[0,0]);return}if(R==="Enter"&&!E.shiftKey){E.preventDefault(),E.stopPropagation(),o(void 0,[0,1]);return}if(R==="Tab"){E.preventDefault(),E.stopPropagation(),o(void 0,E.shiftKey?[-1,0]:[1,0]);return}}{const R=E.key;if(R.length===1&&!E.ctrlKey&&!E.metaKey&&!E.altKey)if(R===" "&&r.current!==void 0){const F=r.current.cell,M=m(F);if(!(M.kind===te.Boolean&&M.readonly!==!0))return}else return}if(s.current!==void 0&&d.current){const R=E.key;if(R==="Backspace"||R==="Delete"||(R==="ArrowLeft"||R==="ArrowRight"||R==="ArrowUp"||R==="ArrowDown"||R==="Home"||R==="End"))return}const S=(H=r.current)===null||H===void 0?void 0:H.cell,D=S!==void 0?(B=h.current)===null||B===void 0?void 0:B.getBounds(S[0],S[1]):void 0;let k=!1;const I={bounds:D,cancel:()=>{k=!0},stopPropagation:()=>E.stopPropagation(),preventDefault:()=>E.preventDefault(),ctrlKey:E.ctrlKey,metaKey:E.metaKey,shiftKey:E.shiftKey,altKey:E.altKey,key:E.key,keyCode:E.keyCode,rawEvent:E,location:S};n(I),k&&(E.preventDefault(),E.stopPropagation())},onGhostKeyUp:E=>{var H,B;const S=(H=r.current)===null||H===void 0?void 0:H.cell,k={bounds:S!==void 0?(B=h.current)===null||B===void 0?void 0:B.getBounds(S[0],S[1]):void 0,cancel:()=>{},stopPropagation:()=>E.stopPropagation(),preventDefault:()=>E.preventDefault(),ctrlKey:E.ctrlKey,metaKey:E.metaKey,shiftKey:E.shiftKey,altKey:E.altKey,key:E.key,keyCode:E.keyCode,rawEvent:E,location:S};i==null||i(k)},onGhostFocus:()=>{u(!0)},onGhostBlur:()=>{u(!1)}}}function Qc(e){const{state:t,mouseState:n,setMouseState:o,fillHighlightRegion:i,setFillHighlightRegion:l,setScrollDir:u,handleSelect:r,onMouseMove:s,onCellClicked:a,onCellActivated:d,onCellContextMenu:h,onHeaderContextMenu:g,onGroupHeaderContextMenu:m,onHeaderClicked:f,onGroupHeaderClicked:v,onColumnResize:C,onFillPattern:p,cellActivationBehavior:w,columnSelect:b,columnSelectionMode:x,columns:E,groupLevels:H,mergedTheme:B,minColumnWidth:S,maxColumnWidth:D,themeForCell:k,getCellsForSelection:I,setSelectedColumns:R,visibleRegion:z,lastMouseSelectLocation:F}=e,{gridSelection:M,gridRef:G,visibleRegionRef:$,abortControllerRef:le,rowMarkerOffset:Y,mangledCols:ne,rows:se,setGridSelection:X,getMangledCellContent:oe,mangledOnCellsEdited:ae,reselect:de,focus:pe,getCellRenderer:W}=t,me=c.useRef(!1),O=c.useRef(z),ve=c.useRef(void 0),q=c.useRef(!1),he=T=>{if(q.current=!1,O.current=$.current,T.button!==0&&T.button!==1){ve.current=void 0;return}const ie=performance.now();ve.current={button:T.button,time:ie,location:T.location},(T==null?void 0:T.kind)==="header"&&(me.current=!0);const ge=T.kind==="cell"&&T.isFillHandle;!ge&&T.kind!=="cell"&&T.isEdge||(o({previousSelection:M,fillHandle:ge}),F.current=void 0,!T.isTouch&&T.button===0&&!ge?r(T):!T.isTouch&&T.button===1&&(F.current=T.location))},K=T=>{if(T.kind!==bn||b!=="multi")return;const ie=ol.value?T.metaKey:T.ctrlKey,[ge,_]=T.location,Me=M.columns;if(ge<Y)return;const Se=ne[ge];let Fe=ge,Ie=ge;const fe=_<=-2?-(_+2):0,Ee=(Te,We)=>H>1?Zi(Te,We,fe,H):Cu(Te,We);for(let Te=ge-1;Te>=Y&&Ee(Se.group,ne[Te].group);Te--)Fe--;for(let Te=ge+1;Te<ne.length&&Ee(Se.group,ne[Te].group);Te++)Ie++;if(pe(),ie||T.isTouch||x==="multi")if(Me.hasAll([Fe,Ie+1])){let Te=Me;for(let We=Fe;We<=Ie;We++)Te=Te.remove(We);R(Te,void 0,ie)}else R(void 0,[Fe,Ie+1],ie);else R(Je.fromSingleSelection([Fe,Ie+1]),void 0,ie)},re=async T=>{if(I!==void 0&&C!==void 0){const ie=$.current.y,ge=$.current.height;let _=I({x:T,y:ie,width:1,height:Math.min(ge,se-ie)},le.current.signal);typeof _!="object"&&(_=await _());const Me=E[T-Y],Fe=document.createElement("canvas").getContext("2d",{alpha:!1});if(Fe!==null){Fe.font=B.baseFontFull;const Ie=Mu(Fe,B,Me,0,_,S,D,!1,W);C==null||C(Me,Ie.width,T,Ie.width)}}},ke=async(T,ie)=>{var ge,_;const Me=(ge=T.current)===null||ge===void 0?void 0:ge.range;if(Me===void 0||I===void 0||ie.current===void 0)return;const Se=ie.current.range;if(p!==void 0){let Ee=!1;if(p({fillDestination:{...Se,x:Se.x-Y},patternSource:{...Me,x:Me.x-Y},preventDefault:()=>Ee=!0}),Ee)return}let Fe=I(Me,le.current.signal);typeof Fe!="object"&&(Fe=await Fe());const Ie=Fe,fe=[];for(let Ee=0;Ee<Se.width;Ee++)for(let Te=0;Te<Se.height;Te++){const We=[Se.x+Ee,Se.y+Te];if(yu(We,Me))continue;const Ce=Ie[Te%Me.height][Ee%Me.width];Co(Ce)||!so(Ce)||fe.push({location:We,value:{...Ce}})}ae(fe),(_=G.current)===null||_===void 0||_.damage(fe.map(Ee=>({cell:Ee.location})))};return{onMouseDown:he,onMouseUp:(T,ie)=>{var ge,_;const Me=n;if(o(void 0),l(void 0),u(void 0),me.current=!1,ie)return;if((Me==null?void 0:Me.fillHandle)===!0&&M.current!==void 0&&((ge=Me.previousSelection)===null||ge===void 0?void 0:ge.current)!==void 0){if(i===void 0)return;const Ke={...M,current:{...M.current,range:Hu(Me.previousSelection.current.range,i)}};ke(Me.previousSelection,Ke),X(Ke,!0);return}const[Se,Fe]=T.location,[Ie,fe]=(_=F.current)!==null&&_!==void 0?_:[],Ee=()=>{q.current=!0},Te=Ke=>{const tt=Ke.isTouch||Ie===Se&&fe===Fe;if(tt&&(a==null||a([Se-Y,Fe],{...Ke,preventDefault:Ee})),Ke.button===1)return!q.current;if(!q.current){var Ue;const _e=oe(T.location),ht=W(_e);if(ht!==void 0&&ht.onClick!==void 0&&tt){const lt=ht.onClick({...Ke,cell:_e,posX:Ke.localEventX,posY:Ke.localEventY,bounds:Ke.bounds,theme:k(_e,T.location),preventDefault:Ee});if(lt!==void 0&&!Co(lt)&&Kn(lt)){var Qe;ae([{location:Ke.location,value:lt}]),(Qe=G.current)===null||Qe===void 0||Qe.damage([{cell:Ke.location}])}}if(q.current||M.current===void 0)return!1;let Le=!1;switch((Ue=_e.activationBehaviorOverride)!==null&&Ue!==void 0?Ue:w){case"double-click":case"second-click":{var ct;if((Me==null||(ct=Me.previousSelection)===null||ct===void 0||(ct=ct.current)===null||ct===void 0?void 0:ct.cell)===void 0)break;const[lt,Mt]=M.current.cell,[At,bt]=Me.previousSelection.current.cell;Le=Se===lt&&Se===At&&Fe===Mt&&Fe===bt&&(Ke.isDoubleClick===!0||w==="second-click");break}case"single-click":{Le=!0;break}}if(Le){var ft;const Mt={inputType:"pointer",pointerActivation:Ke.isDoubleClick===!0?"double-click":(ft=_e.activationBehaviorOverride)!==null&&ft!==void 0?ft:w,pointerType:Ke.isTouch?"touch":"mouse"};return d==null||d([Se-Y,Fe],Mt),de(Ke.bounds,Mt),!0}}return!1},We=T.location[0]-Y;if(T.isTouch){const Ke=$.current,tt=O.current;if(Ke.x!==tt.x||Ke.y!==tt.y)return;if(T.isLongTouch===!0){var Ce;if(T.kind==="cell"&&ci((Ce=M.current)===null||Ce===void 0?void 0:Ce.cell,T.location)){h==null||h([We,T.location[1]],{...T,preventDefault:Ee});return}else if(T.kind==="header"&&M.columns.hasIndex(Se)){g==null||g(We,{...T,preventDefault:Ee});return}else if(T.kind===bn){if(We<0)return;m==null||m(We,{...T,preventDefault:Ee});return}}T.kind==="cell"?Te(T)||r(T):T.kind===bn?v==null||v(We,{...T,preventDefault:Ee}):(T.kind===ro&&(f==null||f(We,{...T,preventDefault:Ee})),r(T));return}if(T.kind==="header"){if(We<0)return;T.isEdge?T.isDoubleClick===!0&&re(Se):T.button===0&&Se===Ie&&Fe===fe&&(f==null||f(We,{...T,preventDefault:Ee}))}if(T.kind===bn){if(We<0)return;T.button===0&&Se===Ie&&Fe===fe&&(v==null||v(We,{...T,preventDefault:Ee}),q.current||K(T))}T.kind==="cell"&&(T.button===0||T.button===1)&&Te(T),F.current=void 0},onMouseMoveImpl:T=>{const ie={...T,location:[T.location[0]-Y,T.location[1]]};s==null||s(ie),n!==void 0&&T.buttons===0&&(o(void 0),l(void 0),u(void 0),me.current=!1),u(ge=>{var _,Me;return me.current?[T.scrollEdge[0],0]:T.scrollEdge[0]===(ge==null?void 0:ge[0])&&T.scrollEdge[1]===ge[1]?ge:n===void 0||((_=(Me=ve.current)===null||Me===void 0?void 0:Me.location[0])!==null&&_!==void 0?_:0)<Y?void 0:T.scrollEdge})},handleGroupHeaderSelection:K,normalSizeColumn:re,fillDown:()=>{if(M.current===void 0||M.current.range.height<=1)return;const T={...M,current:{...M.current,range:{...M.current.range,height:1}}};ke(T,M)},fillRight:()=>{if(M.current===void 0||M.current.range.width<=1)return;const T={...M,current:{...M.current,range:{...M.current.range,width:1}}};ke(T,M)},mouseDownData:ve,isActivelyDraggingHeader:me}}const e0=c.lazy(async()=>await ou(()=>Promise.resolve().then(()=>Ed),void 0,import.meta.url));let t0=0;function n0(e){return Vs(Ar(Ar(e).filter(t=>t.span!==void 0).map(t=>{var n,o,i,l;return po(((n=(o=t.span)===null||o===void 0?void 0:o[0])!==null&&n!==void 0?n:0)+1,((i=(l=t.span)===null||l===void 0?void 0:l[1])!==null&&i!==void 0?i:0)+1)})))}function Vi(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const io={kind:te.Loading,allowOverlay:!1},Pl={columns:Je.empty(),rows:Je.empty(),current:void 0},o0=(e,t)=>{var n,o,i,l,u,r,s,a,d,h,g,m,f,v,C,p;const[w,b]=c.useState(Pl),[x,E]=c.useState(),H=c.useRef(null),B=c.useRef(null),[S,D]=c.useState(),[k,I]=c.useState(),R=c.useRef(void 0),z=c.useRef(null),[F,M]=c.useState(!1),G=c.useRef(F);G.current=F;const $=c.useRef(x);$.current=x;const le=typeof window>"u"?null:window,{imageEditorOverride:Y,getRowThemeOverride:ne,markdownDivCreateNode:se,width:X,height:oe,columns:ae,rows:de,getCellContent:pe,onCellClicked:W,onCellActivated:me,onFillPattern:O,onFinishedEditing:ve,coercePasteValue:q,drawHeader:he,drawCell:K,editorBloom:re,onHeaderClicked:ke,onColumnProposeMove:J,rangeSelectionColumnSpanning:Be=!0,spanRangeBehavior:Ve="default",onGroupHeaderClicked:ce,onCellContextMenu:T,className:ie,onHeaderContextMenu:ge,getCellsForSelection:_,onGroupHeaderContextMenu:Me,onGroupHeaderRenamed:Se,onCellEdited:Fe,onCellsEdited:Ie,onSearchResultsChanged:fe,searchResults:Ee,onSearchValueChange:Te,searchValue:We,onKeyDown:Ce,onKeyUp:Ke,keybindings:tt,editOnType:Ue=!0,onRowAppended:Qe,onColumnAppended:ct,onColumnMoved:ft,validateCell:_e,highlightRegions:ht,rangeSelect:Le="rect",columnSelect:lt="multi",rowSelect:Mt="multi",rangeSelectionBlending:At="exclusive",columnSelectionBlending:bt="exclusive",rowSelectionBlending:Lt="exclusive",onDelete:wt,onDragStart:Zt,onMouseMove:dn,onPaste:Pe,copyHeaders:St=!1,freezeColumns:Bt=0,cellActivationBehavior:Vt="second-click",rowSelectionMode:mn="auto",columnSelectionMode:In="auto",onHeaderMenuClick:en,onHeaderIndicatorClick:Hn,getGroupDetails:Yt,rowGrouping:Jt,onSearchClose:Ne,onItemHovered:Ct,onSelectionCleared:rt,showSearch:Gt,onVisibleRegionChanged:Kt,gridSelection:gt,onGridSelectionChange:Yn,minColumnWidth:il=50,maxColumnWidth:Vn=500,maxColumnAutoWidth:Un,provideEditor:_o,trailingRowOptions:Rt,freezeTrailingRows:vt=0,allowedFillDirections:Zo="orthogonal",scrollOffsetX:Tt,scrollOffsetY:zt,verticalBorder:Ut,onDragOverCell:vi,onDrop:jn,onColumnResize:an,onColumnResizeEnd:cn,onColumnResizeStart:Tn,customRenderers:xo,fillHandle:mi,experimental:$t,fixedShadowX:Fo,fixedShadowY:Do,headerIcons:ko,imageWindowLoader:fo,initialSize:qn,isDraggable:ll,onDragLeave:wi,onRowMoved:Jo,overscrollX:rl,overscrollY:zn,preventDiagonalScrolling:_n,rightElement:ul,rightElementProps:sl,trapFocus:pi=!1,smoothScrollX:Ci,smoothScrollY:So,scaleToRem:ur=!1,rowHeight:yi=34,headerHeight:Ro=36,groupHeaderHeight:bi=Ro,theme:Qo,isOutsideClick:Mo,renderers:Pn,resizeIndicator:ei,scrollToActiveCell:Zn=!0,drawFocusRing:Ao=!0,portalElementRef:Bo,onRowStatus:Io,onRowId:ti}=e,Ei=Ao==="no-editor"?x===void 0:Ao,Ge=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,xi=(n=Ge==null?void 0:Ge.rowNumber)!==null&&n!==void 0?n:!1;let ho=(o=(i=Ge==null?void 0:Ge.kind)!==null&&i!==void 0?i:e.rowMarkers)!==null&&o!==void 0?o:"none",fn=xi;(ho==="both"||ho==="checkbox-and-number")&&(ho="checkbox",fn=!0);const wn=ho,ni=(l=Ge==null?void 0:Ge.width)!==null&&l!==void 0?l:e.rowMarkerWidth,Fi=(u=(r=Ge==null?void 0:Ge.startIndex)!==null&&r!==void 0?r:e.rowMarkerStartIndex)!==null&&u!==void 0?u:1,Di=(s=Ge==null?void 0:Ge.theme)!==null&&s!==void 0?s:e.rowMarkerTheme,ki=Ge==null?void 0:Ge.headerTheme,dl=Ge==null?void 0:Ge.headerAlwaysVisible,Ho=Mt!=="multi"||(Ge==null?void 0:Ge.headerDisabled)===!0,To=(a=Ge==null?void 0:Ge.checkboxStyle)!==null&&a!==void 0?a:"square",al=(d=Ge==null?void 0:Ge.rowStatus)!==null&&d!==void 0?d:!1,Si=(h=Ge==null?void 0:Ge.rowStatusWidth)!==null&&h!==void 0?h:40,Ri=Ge==null?void 0:Ge.rowStatusTheme,Mi=(g=Ge==null?void 0:Ge.rowId)!==null&&g!==void 0?g:!1,go=(m=Ge==null?void 0:Ge.rowIdWidth)!==null&&m!==void 0?m:80,zo=Ge==null?void 0:Ge.rowIdTheme,Ln=Math.max(il,20),oi=Math.max(Vn,Ln),Po=Math.max(Un??oi,Ln),cl=typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),{rows:st,rowNumberMapper:Ai,rowHeight:fl,getRowThemeOverride:P}=Kc(Jt,de,yi,ne),V=Number.parseFloat(cl.fontSize),{rowHeight:be,headerHeight:De,groupHeaderHeight:we,theme:Re,overscrollX:Oe,overscrollY:nt}=Gc({groupHeaderHeight:bi,headerHeight:Ro,overscrollX:rl,overscrollY:zn,remSize:V,rowHeight:fl,scaleToRem:ur,theme:Qo}),ye=$c(tt),xt=ni??(de>1e4?48:de>1e3?44:de>100?36:32),Xe=wn!=="none",$e=al===!0,Ft=Mi===!0,U=(Xe?fn?2:1:0)+($e?1:0)+(Ft?1:0),ot=(Xe?(fn?2:1)*xt:0)+($e?Si:0)+(Ft?go:0),Ye=Rt!==void 0,jt=(Rt==null?void 0:Rt.sticky)===!0,[Ht,hn]=c.useState(!1),En=Gt??Ht,tn=()=>{Ne!==void 0?Ne():hn(!1)},dt=gt===void 0?void 0:Vi(gt,U),xe=dt??w,Xt=c.useRef(new AbortController);c.useEffect(()=>()=>Xt==null?void 0:Xt.current.abort(),[]);const[nn,on]=Fc(_,pe,U,Xt.current,st),vo=(y,A,L)=>{if(_e===void 0)return!0;const N=[y[0]-U,y[1]];return _e==null?void 0:_e(N,A,L)},pn=c.useRef(gt),On=(y,A)=>{A&&(y=yc(y,nn,U,Ve,Xt.current)),Yn!==void 0?(pn.current=Vi(y,-U),Yn(pn.current)):b(y)},Jn=lo(an,(y,A,L,N)=>{an==null||an(ae[L-U],A,L-U,N)}),hl=lo(cn,(y,A,L,N)=>{cn==null||cn(ae[L-U],A,L-U,N)}),gl=lo(Tn,(y,A,L,N)=>{Tn==null||Tn(ae[L-U],A,L-U,N)}),Ku=lo(he,(y,A)=>{var L;return(L=he==null?void 0:he({...y,columnIndex:y.columnIndex-U},A))!==null&&L!==void 0?L:!1}),Yu=lo(K,(y,A)=>{var L;return(L=K==null?void 0:K({...y,col:y.col-U},A))!==null&&L!==void 0?L:!1}),sr=y=>{if(wt!==void 0){const A=wt(Vi(y,-U));return typeof A=="boolean"?A:Vi(A,U)}return!0},[Wn,xn,Fn]=xc(xe,On,At,bt,Lt,Le,Be),Dn=An(mu(),Re),[vl,Vu]=c.useState([0,0,0]),Uu=(()=>{if(Pn===void 0)return{};const y={};for(const A of Pn)y[A.kind]=A;return y})(),Qn=y=>y.kind!==te.Custom?Uu[y.kind]:xo==null?void 0:xo.find(A=>A.isMatch(y));let{sizedColumns:Lo,nonGrowWidth:dr}=Wd(ae,st,on,vl[0]-ot-vl[2],Ln,Po,Dn,Qn,Xt.current);dr+=ot;const ii=(()=>{let y=0;for(const A of Lo)A.group!==void 0&&(typeof A.group=="string"?y=Math.max(y,1):y=Math.max(y,A.group.length));return y})(),ar=ii>0,cr=ii===0?[]:Array(ii).fill(we),ju=cr.reduce((y,A)=>y+A,0),ml=De+ju,fr=xe.rows.length,qu=wn==="none"?void 0:fr===0?!1:fr===st?!0:void 0,Pt=(()=>{const y=[];return wn!=="none"&&(fn&&y.push({title:"",width:xt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Di,rowMarker:To,rowMarkerChecked:!1,headerRowMarkerTheme:ki,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),y.push({title:"",width:xt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Di,rowMarker:To,rowMarkerChecked:qu,headerRowMarkerTheme:ki,headerRowMarkerAlwaysVisible:dl,headerRowMarkerDisabled:Ho})),$e&&y.push({title:"",width:Si,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Ri}),Ft&&y.push({title:"ID",width:go,icon:void 0,hasMenu:!1,style:"normal",themeOverride:zo}),[...y,...Lo]})(),eo=c.useRef({height:1,width:1,x:0,y:0}),Bi=c.useRef(!1),{setVisibleRegion:_u,visibleRegion:mo,scrollRef:kt}=Uc(Tt,zt,be,eo,()=>Bi.current=!0);eo.current=mo;const Zu=mo.x+U,wl=mo.y,Qt=c.useRef(null),kn=y=>{if(y===!0){var A;(A=z.current)===null||A===void 0||A.focus()}else window.requestAnimationFrame(()=>{var L;(L=z.current)===null||L===void 0||L.focus()})},Sn=Ye?st+1:st,Ii=y=>{const A=U===0?y:y.map(N=>({...N,location:[N.location[0]-U,N.location[1]]})),L=Ie==null?void 0:Ie(A);if(L!==!0)for(const N of A)Fe==null||Fe(N.location,N.value);return L},[Hi,hr]=c.useState(),li=xe.current!==void 0&&xe.current.range.width*xe.current.range.height>1?xe.current.range:void 0,Oo=Ei?(f=xe.current)===null||f===void 0?void 0:f.cell:void 0,pl=Oo==null?void 0:Oo[0],Cl=Oo==null?void 0:Oo[1],Ju=((y,A)=>{if((ht===void 0||ht.length===0)&&((y=(A=li??pl)!==null&&A!==void 0?A:Cl)!==null&&y!==void 0?y:Hi)===void 0)return;const L=[];if(ht!==void 0)for(const N of ht){const Q=Pt.length-N.range.x-U;Q>0&&L.push({color:N.color,range:{...N.range,x:N.range.x+U,width:Math.min(Q,N.range.width)},style:N.style})}return Hi!==void 0&&L.push({color:ao(Dn.accentColor,0),range:Hi,style:"dashed"}),li!==void 0&&L.push({color:ao(Dn.accentColor,.5),range:li,style:"solid-outline"}),pl!==void 0&&Cl!==void 0&&L.push({color:Dn.accentColor,range:{x:pl,y:Cl,width:1,height:1},style:"solid-outline"}),L.length>0?L:void 0})(),gr=c.useRef(Pt);gr.current=Pt;const Wo=function(y){let[A,L]=y,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const Q=Ye&&L===Sn-1;let j=0,ue=-1,Z=-1,ee=-1,He=-1;if(Xe&&fn&&(ue=j++),Xe&&(Z=j++),$e&&(ee=j++),Ft&&(He=j++),A===ue){var ze;if(Q)return io;const It=Ai(L);return It===void 0?io:{kind:Nt.Marker,allowOverlay:!1,checkboxStyle:To,checked:!1,markerKind:"number",row:Fi+It,drawHandle:!1,cursor:void 0,disabled:((ze=e.disabledRows)===null||ze===void 0?void 0:ze.call(e,L))===!0}}if(A===Z){var et;if(Q)return io;const It=Ai(L);if(It===void 0)return io;let Wt;return fn?Wt=wn==="checkbox-visible"?"checkbox-visible":"checkbox":wn==="clickable-number"?Wt="number":Wt=wn,{kind:Nt.Marker,allowOverlay:!1,checkboxStyle:To,checked:(xe==null?void 0:xe.rows.hasIndex(L))===!0,markerKind:Wt,row:Fi+It,drawHandle:Jo!==void 0,cursor:fn?void 0:wn==="clickable-number"?"pointer":void 0,disabled:((et=e.disabledRows)===null||et===void 0?void 0:et.call(e,L))===!0}}if(A===ee){if(Q)return io;const It=Io==null?void 0:Io(L);return{kind:Nt.RowStatus,allowOverlay:!1,status:It,themeOverride:Ri}}if(A===He){if(Q)return io;const It=ti==null?void 0:ti(L);return{kind:Nt.RowId,allowOverlay:!1,rowId:It,themeOverride:zo}}if(Q){var Et,mt;const Wt=A===U&&(Et=Rt==null?void 0:Rt.hint)!==null&&Et!==void 0?Et:"",yt=gr.current[A];if((yt==null||(mt=yt.trailingRowOptions)===null||mt===void 0?void 0:mt.disabled)===!0)return io;{var Ze,Ae,at,pt;const Mn=(Ze=yt==null||(Ae=yt.trailingRowOptions)===null||Ae===void 0?void 0:Ae.hint)!==null&&Ze!==void 0?Ze:Wt,Cn=(at=yt==null||(pt=yt.trailingRowOptions)===null||pt===void 0?void 0:pt.addIcon)!==null&&at!==void 0?at:Rt==null?void 0:Rt.addIcon;return{kind:Nt.NewRow,hint:Mn,allowOverlay:!1,icon:Cn}}}else{const It=A-U;if(N||($t==null?void 0:$t.strict)===!0){var it,ut,gn;const yt=eo.current,Mn=yt.x>It||It>yt.x+yt.width||yt.y>L||L>yt.y+yt.height||L>=El.current,Cn=It===((it=yt.extras)===null||it===void 0||(it=it.selected)===null||it===void 0?void 0:it[0])&&L===((ut=yt.extras)===null||ut===void 0?void 0:ut.selected[1]);let Gn=!1;if(((gn=yt.extras)===null||gn===void 0?void 0:gn.freezeRegions)!==void 0){for(const $o of yt.extras.freezeRegions)if(uo($o,It,L)){Gn=!0;break}}if(Mn&&!Cn&&!Gn)return io}let Wt=pe([It,L]);return U!==0&&Wt.span!==void 0&&(Wt={...Wt,span:[Wt.span[0]+U,Wt.span[1]+U]}),Wt}},vr=y=>{var A;let L=(A=Yt==null?void 0:Yt(y))!==null&&A!==void 0?A:{name:y};if(Se!==void 0&&y!==""){var N;L={icon:L.icon,name:L.name,overrideTheme:L.overrideTheme,actions:[...(N=L.actions)!==null&&N!==void 0?N:[],{title:"Rename",icon:"renameIcon",onClick:Q=>Sl({group:L.name,bounds:Q.bounds})}]}}return L},mr=y=>{var A;const[L,N]=y.cell,Q=Pt[L],j=(Q==null?void 0:Q.group)!==void 0?(A=vr(Q.group))===null||A===void 0?void 0:A.overrideTheme:void 0,ue=Q==null?void 0:Q.themeOverride,Z=P==null?void 0:P(N);E({...y,theme:An(Dn,j,ue,Z,y.content.themeOverride)})},Qu=(y,A,L)=>{if(xe.current===void 0)return;const[N,Q]=xe.current.cell,j=Wo([N,Q]);if(j.kind!==te.Boolean&&j.allowOverlay){let mt=j;if(L!==void 0)switch(mt.kind){case te.Number:{const at=js(()=>L==="-"?-0:Number.parseFloat(L),0);mt={...mt,data:Number.isNaN(at)?0:at};break}case te.Text:case te.Markdown:case te.Uri:mt={...mt,data:L};break}mr({target:y,content:mt,initialValue:L,cell:[N,Q],highlight:L===void 0,forceEditMode:L!==void 0,activation:A});const Ze=mt.kind===te.Custom;if(L!==void 0&&!Ze){var ue,Z;if((ue=z.current)===null||ue===void 0||ue.setPosition(y.x,y.y,y.width,y.height),L.length>0){var ee;(ee=z.current)===null||ee===void 0||ee.setValue(L)}(Z=z.current)===null||Z===void 0||Z.setVisible(!0),M(!0)}else if(Ze&&L!==void 0){var He,ze,et;(He=z.current)===null||He===void 0||He.clear(),(ze=z.current)===null||ze===void 0||ze.setVisible(!1),(et=z.current)===null||et===void 0||et.blur(),M(!1)}}else if(j.kind===te.Boolean&&A.inputType==="keyboard"&&j.readonly!==!0){var Et;Ii([{location:xe.current.cell,value:{...j,data:lr(j.data)}}]),(Et=Qt.current)===null||Et===void 0||Et.damage([{cell:xe.current.cell}])}},wr=(y,A)=>{var L;const N=(L=Qt.current)===null||L===void 0?void 0:L.getBounds(y,A);if(N===void 0||kt.current===null)return;const Q=Wo([y,A]);Q.allowOverlay&&mr({target:N,content:Q,initialValue:void 0,highlight:!0,cell:[y,A],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},Ot=function(y,A){let L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"both",N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,Q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:void 0;if(kt.current!==null){const ee=Qt.current,He=B.current,ze=typeof y!="number"?y.unit==="cell"?y.amount:void 0:y,et=typeof A!="number"?A.unit==="cell"?A.amount:void 0:A,Et=typeof y!="number"&&y.unit==="px"?y.amount:void 0,mt=typeof A!="number"&&A.unit==="px"?A.amount:void 0;if(ee!==null&&He!==null){let Ze={x:0,y:0,width:0,height:0},Ae=0,at=0;if(ze!==void 0||et!==void 0){var ue;if(Ze=(ue=ee.getBounds((ze??0)+U,et??0))!==null&&ue!==void 0?ue:Ze,Ze.width===0||Ze.height===0)return}const pt=He.getBoundingClientRect(),it=pt.width/He.offsetWidth;if(Et!==void 0&&(Ze={...Ze,x:Et-pt.left-kt.current.scrollLeft,width:1}),mt!==void 0&&(Ze={...Ze,y:mt+pt.top-kt.current.scrollTop,height:1}),Ze!==void 0){const ut={x:Ze.x-N,y:Ze.y-Q,width:Ze.width+2*N,height:Ze.height+2*Q};let gn=0;for(let Bl=0;Bl<Bt;Bl++)gn+=Lo[Bl].width;let It=0;const Wt=vt+(jt?1:0);Wt>0&&(It=bo(Sn,Wt,be));let yt=gn*it+pt.left+ot*it,Mn=pt.right,Cn=pt.top+ml*it,Gn=pt.bottom-It*it;const $o=Ze.width+N*2;switch(j==null?void 0:j.hAlign){case"start":Mn=yt+$o;break;case"end":yt=Mn-$o;break;case"center":yt=Math.floor((yt+Mn)/2)-$o/2,Mn=yt+$o;break}const Gi=Ze.height+Q*2;switch(j==null?void 0:j.vAlign){case"start":Gn=Cn+Gi;break;case"end":Cn=Gn-Gi;break;case"center":Cn=Math.floor((Cn+Gn)/2)-Gi/2,Gn=Cn+Gi;break}if(yt>ut.x?Ae=ut.x-yt:Mn<ut.x+ut.width&&(Ae=ut.x+ut.width-Mn),Cn>ut.y?at=ut.y-Cn:Gn<ut.y+ut.height&&(at=ut.y+ut.height-Gn),L==="vertical"||typeof y=="number"&&y<Bt?Ae=0:(L==="horizontal"||typeof A=="number"&&A>=Sn-Wt)&&(at=0),Ae!==0||at!==0){var Z;it!==1&&(Ae/=it,at/=it),kt.current.scrollTo({left:Ae+kt.current.scrollLeft,top:at+kt.current.scrollTop,behavior:(Z=j==null?void 0:j.behavior)!==null&&Z!==void 0?Z:"auto"})}}}}},Ti=c.useRef(Ot);Ti.current=Ot;const yl=c.useRef(wr),bl=c.useRef(pe);yl.current=wr,bl.current=pe;const El=c.useRef(st);El.current=st;const pr=c.useRef(Pt.length);pr.current=Pt.length;const ri=async function(y){var A,L,N;let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,j=arguments.length>2?arguments[2]:void 0;const ue=Pt[y],Z=(A=(L=ue==null||(N=ue.trailingRowOptions)===null||N===void 0?void 0:N.onRowAppended)!==null&&L!==void 0?L:Qe)===null||A===void 0?void 0:A();let ee,He=!0;Z!==void 0&&(ee=await Z,ee==="top"&&(He=!1),typeof ee=="number"&&(He=!1));let ze=0;const et=()=>{if(El.current<=st){ze<500&&window.setTimeout(et,ze),ze=50+ze*2;return}const Et=typeof ee=="number"?ee:He?st:0;Ti.current(y-U,Et,"both",0,20,j?{behavior:j}:void 0),Wn({cell:[y,Et],range:{x:y,y:Et,width:1,height:1}},!1,!1,"edit");const mt=bl.current([y-U,Et]);mt.allowOverlay&&so(mt)&&mt.readonly!==!0&&Q&&window.setTimeout(()=>{yl.current(y,Et)},0)};et()},xl=async function(y){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const L=ct==null?void 0:ct();let N,Q=!0;L!==void 0&&(N=await L,N==="left"&&(Q=!1),typeof N=="number"&&(Q=!1));let j=0;const ue=()=>{if(pr.current<=Pt.length){j<500&&window.setTimeout(ue,j),j=50+j*2;return}const Z=typeof N=="number"?N:Q?Pt.length:0;Ot(Z-U,y),Wn({cell:[Z,y],range:{x:Z,y,width:1,height:1}},!1,!1,"edit");const ee=bl.current([Z-U,y]);ee.allowOverlay&&so(ee)&&ee.readonly!==!0&&A&&window.setTimeout(()=>{yl.current(Z,y)},0)};ue()},Fl=y=>{var A,L;const N=(A=(L=Lo[y])===null||L===void 0||(L=L.trailingRowOptions)===null||L===void 0?void 0:L.targetColumn)!==null&&A!==void 0?A:Rt==null?void 0:Rt.targetColumn;if(typeof N=="number")return N+(Xe?1:0);if(typeof N=="object"){const Q=ae.indexOf(N);if(Q>=0)return Q+(Xe?1:0)}},to=c.useRef(void 0),No=c.useRef(void 0),Dl=(y,A)=>{var L;const[N,Q]=A;return An(Dn,(L=Pt[N])===null||L===void 0?void 0:L.themeOverride,P==null?void 0:P(Q),y.themeOverride)},{mapper:kl}=Yc(Jt,de),Cr=Jt==null?void 0:Jt.navigationBehavior,zi=c.useRef(void 0),es=y=>{var A,L;const N=ol.value?y.metaKey:y.ctrlKey,Q=N&&Mt==="multi",[j,ue]=y.location,Z=xe.columns,ee=xe.rows,[He,ze]=(A=(L=xe.current)===null||L===void 0?void 0:L.cell)!==null&&A!==void 0?A:[];if(y.kind==="cell"){if(No.current=void 0,zi.current=[j,ue],j===(fn?1:0)&&Xe){if(Ye===!0&&ue===st||wn==="number"||Mt==="none")return;const Ae=Wo(y.location);if(Ae.kind!==Nt.Marker||Ae.disabled===!0)return;if(Jo!==void 0){var et;const it=Qn(Ae);ln((it==null?void 0:it.kind)===Nt.Marker);const ut=it==null||(et=it.onClick)===null||et===void 0?void 0:et.call(it,{...y,cell:Ae,posX:y.localEventX,posY:y.localEventY,bounds:y.bounds,theme:Dl(Ae,y.location),preventDefault:()=>{}});if(ut===void 0||ut.checked===Ae.checked)return}E(void 0),kn();const at=ee.hasIndex(ue),pt=to.current;if(Mt==="multi"&&(y.shiftKey||y.isLongTouch===!0)&&pt!==void 0&&ee.hasIndex(pt)){const it=[Math.min(pt,ue),Math.max(pt,ue)+1];Q||mn==="multi"?xn(void 0,it,!0):xn(Je.fromSingleSelection(it),void 0,Q)}else Mt==="multi"&&(Q||y.isTouch||mn==="multi")?at?xn(ee.remove(ue),void 0,!0):(xn(void 0,ue,!0),to.current=ue):at&&ee.length===1?xn(Je.empty(),void 0,N):(xn(Je.fromSingleSelection(ue),void 0,N),to.current=ue)}else if(j>=U&&Ye&&ue===st){const Ae=Fl(j);ri(Ae??j)}else if(He!==j||ze!==ue){var Et;const Ae=Wo(y.location),at=Qn(Ae);if((at==null?void 0:at.onSelect)!==void 0){let ut=!1;if(at.onSelect({...y,cell:Ae,posX:y.localEventX,posY:y.localEventY,bounds:y.bounds,preventDefault:()=>ut=!0,theme:Dl(Ae,y.location)}),ut)return}if(Cr==="block"&&kl(ue).isGroupHeader)return;const pt=jt&&ue===st,it=jt&&xe!==void 0&&((Et=xe.current)===null||Et===void 0?void 0:Et.cell[1])===st;if((y.shiftKey||y.isLongTouch===!0)&&He!==void 0&&ze!==void 0&&xe.current!==void 0&&!it){if(pt)return;const ut=Math.min(j,He),gn=Math.max(j,He),It=Math.min(ue,ze),Wt=Math.max(ue,ze);Wn({...xe.current,range:{x:ut,y:It,width:gn-ut+1,height:Wt-It+1}},!0,N,"click"),to.current=void 0,kn()}else{const ut=xe.rows.length>0;Wn({cell:[j,ue],range:{x:j,y:ue,width:1,height:1}},!0,N||ut,"click"),to.current=void 0,E(void 0),kn()}}}else if(y.kind==="header")if(zi.current=[j,ue],E(void 0),Xe&&j===(fn?1:0))to.current=void 0,No.current=void 0,!Ho&&Mt==="multi"&&(ee.length!==st?xn(Je.fromSingleSelection([0,st]),void 0,N):xn(Je.empty(),void 0,N),kn());else{const Ze=No.current;if(lt==="multi"&&(y.shiftKey||y.isLongTouch===!0)&&Ze!==void 0&&Z.hasIndex(Ze)){const Ae=[Math.min(Ze,j),Math.max(Ze,j)+1];N||y.isTouch||In==="multi"?Fn(void 0,Ae,N):Fn(Je.fromSingleSelection(Ae),void 0,N)}else lt==="multi"&&(N||y.isTouch||In==="multi")?(Z.hasIndex(j)?Fn(Z.remove(j),void 0,N):Fn(void 0,j,N),No.current=j):lt!=="none"&&(Z.hasIndex(j)?Fn(Z.remove(j),void 0,N):Fn(Je.fromSingleSelection(j),void 0,N),No.current=j);to.current=void 0,kn()}else y.kind===bn?zi.current=[j,ue]:y.kind===el&&!y.isMaybeScrollbar&&(On(Pl,!1),E(void 0),kn(),rt==null||rt(),to.current=void 0,No.current=void 0)},Pi={gridSelection:xe,overlay:x,gridRef:Qt,ghostInputRef:z,overlayRef:$,ghostInputVisibleRef:G,scrollRef:kt,canvasRef:B,visibleRegionRef:eo,abortControllerRef:Xt,rowMarkerOffset:U,mangledCols:Pt,mangledRows:Sn,rows:st,setGridSelection:On,getMangledCellContent:Wo,mangledOnCellsEdited:Ii,setOverlay:E,focus:kn,setGhostInputVisible:M,reselect:Qu,getCellRenderer:Qn},{onMouseDown:ts,onMouseUp:ns,onMouseMoveImpl:os,normalSizeColumn:yr,fillDown:is,fillRight:ls,mouseDownData:Nn,isActivelyDraggingHeader:rs}=Qc({state:Pi,mouseState:S,setMouseState:D,fillHighlightRegion:Hi,setFillHighlightRegion:hr,setScrollDir:I,handleSelect:es,onMouseMove:dn,onCellClicked:W,onCellActivated:me,onCellContextMenu:T,onHeaderContextMenu:ge,onGroupHeaderContextMenu:Me,onHeaderClicked:ke,onGroupHeaderClicked:ce,onColumnResize:Jn,onFillPattern:O,cellActivationBehavior:Vt,columnSelect:lt,columnSelectionMode:In,columns:Lo,groupLevels:ii,mergedTheme:Dn,minColumnWidth:Ln,maxColumnWidth:oi,themeForCell:Dl,getCellsForSelection:nn,setSelectedColumns:Fn,visibleRegion:mo,lastMouseSelectLocation:zi}),[Li,Sl]=c.useState(),us=(y,A)=>{en==null||en(y-U,A)},ss=(y,A)=>{Hn==null||Hn(y-U,A)};c.useEffect(()=>{if(x===void 0)return;const y=N=>{const Q=[];let j=N.parentElement;for(;j&&j!==document.documentElement;){const ue=window.getComputedStyle(j),Z=ue.overflow+ue.overflowY+ue.overflowX;(Z.includes("scroll")||Z.includes("auto"))&&Q.push(j),j=j.parentElement}return Q},A=N=>{const Q=N.target;kt.current&&!kt.current.contains(Q)&&E(void 0)},L=[];if(kt.current){const N=y(kt.current);L.push(...N)}return L.forEach(N=>{N.addEventListener("scroll",A)}),window.addEventListener("scroll",A),document.addEventListener("scroll",A,!0),()=>{L.forEach(N=>{N.removeEventListener("scroll",A)}),window.removeEventListener("scroll",A),document.removeEventListener("scroll",A,!0)}},[x,E,kt]);const Rn=xe==null||(v=xe.current)===null||v===void 0?void 0:v.cell,ds=(y,A,L,N,Q,j)=>{if(Bi.current=!1,x!==void 0){const ze=eo.current;(ze.x!==y.x||ze.y!==y.y)&&E(void 0)}let ue=Rn;ue!==void 0&&(ue=[ue[0]-U,ue[1]]);const Z=Bt===0?void 0:{x:0,y:y.y,width:Bt,height:y.height},ee=[];Z!==void 0&&ee.push(Z),vt>0&&(ee.push({x:y.x-U,y:st-vt,width:y.width,height:vt}),Bt>0&&ee.push({x:0,y:st-vt,width:Bt,height:vt}));const He={x:y.x-U,y:y.y,width:y.width,height:Ye&&y.y+y.height>=st?y.height-1:y.height,tx:Q,ty:j,extras:{selected:ue,freezeRegion:Z,freezeRegions:ee}};eo.current=He,_u(He),Vu([A,L,N]),Kt==null||Kt(He,He.tx,He.ty,He.extras)},as=lo(J,(y,A)=>(J==null?void 0:J(y-U,A-U))!==!1),cs=lo(ft,(y,A)=>{ft==null||ft(y-U,A-U),lt!=="none"&&Fn(Je.fromSingleSelection(A),void 0,!0)}),Rl=c.useRef(!1),fs=y=>{if(y.location[0]===0&&U>0){y.preventDefault();return}Zt==null||Zt({...y,location:[y.location[0]-U,y.location[1]]}),y.defaultPrevented()||(Rl.current=!0),D(void 0)},hs=()=>{Rl.current=!1},gs=Jt==null?void 0:Jt.selectionBehavior,br=y=>{if(gs!=="block-spanning")return;const{isGroupHeader:A,path:L,groupRows:N}=kl(y);if(A)return[y,y];const Q=L[L.length-1],j=y-Q,ue=y+N-Q-1;return[j,ue]},Ml=c.useRef(void 0),Er=y=>{var A,L;if(!Ou(y,Ml.current)&&(Ml.current=y,!((Nn==null||(A=Nn.current)===null||A===void 0?void 0:A.button)!==void 0&&Nn.current.button>=1))){if(y.buttons!==0&&S!==void 0&&((L=Nn.current)===null||L===void 0?void 0:L.location[0])===0&&U===1&&Mt==="multi"&&S.previousSelection&&!S.previousSelection.rows.hasIndex(Nn.current.location[1])&&xe.rows.hasIndex(Nn.current.location[1])){const Q=Math.min(Nn.current.location[1],y.location[1]),j=Math.max(Nn.current.location[1],y.location[1])+1;xn(Je.fromSingleSelection([Q,j]),void 0,!1)}else if(y.buttons!==0&&S!==void 0&&xe.current!==void 0&&!Rl.current&&!rs.current&&(Le==="rect"||Le==="multi-rect")){var N;const[Q,j]=xe.current.cell;let[ue,Z]=y.location;if(Z<0&&(Z=eo.current.y),S.fillHandle===!0&&((N=S.previousSelection)===null||N===void 0?void 0:N.current)!==void 0){const ee=S.previousSelection.current.range;Z=Math.min(Z,Ye?st-1:st);const He=ba(ee,ue,Z,Zo);hr(He)}else{if(Ye&&j===st)return;if(Ye&&Z===st)if(y.kind===el)Z--;else return;ue=Math.max(ue,U);const ze=br(j);Z=ze===void 0?Z:vn(Z,ze[0],ze[1]);const et=ue-Q,Et=Z-j,mt={x:et>=0?Q:ue,y:Et>=0?j:Z,width:Math.abs(et)+1,height:Math.abs(Et)+1};Wn({...xe.current,range:mt},!0,!1,"drag")}}Ct==null||Ct({...y,location:[y.location[0]-U,y.location[1]]})}};Bc(k,kt,()=>{const y=Ml.current;if(y===void 0)return;const[A,L]=y.scrollEdge;let[N,Q]=y.location;const j=eo.current;if(A===-1){var ue,Z;N=(ue=(Z=j.extras)===null||Z===void 0||(Z=Z.freezeRegion)===null||Z===void 0?void 0:Z.x)!==null&&ue!==void 0?ue:j.x}else A===1&&(N=j.x+j.width);L===-1?Q=Math.max(0,j.y):L===1&&(Q=Math.min(st-1,j.y+j.height)),N=vn(N,0,Pt.length-1),Q=vn(Q,0,st-1),Er({...y,location:[N,Q]})});const vs=y=>{var A;if(xe.current===void 0)return;const[L,N]=y,[Q,j]=xe.current.cell,ue=xe.current.range;let Z=ue.x,ee=ue.x+ue.width,He=ue.y,ze=ue.y+ue.height;const[et,Et]=(A=br(j))!==null&&A!==void 0?A:[0,st-1],mt=Et+1;if(N!==0)switch(N){case 2:{ze=mt,He=j,Ot(0,ze,"vertical");break}case-2:{He=et,ze=j+1,Ot(0,He,"vertical");break}case 1:{He<j?(He++,Ot(0,He,"vertical")):(ze=Math.min(mt,ze+1),Ot(0,ze,"vertical"));break}case-1:{ze>j+1?(ze--,Ot(0,ze,"vertical")):(He=Math.max(et,He-1),Ot(0,He,"vertical"));break}default:hi()}if(L!==0)if(L===2)ee=Pt.length,Z=Q,Ot(ee-1-U,0,"horizontal");else if(L===-2)Z=U,ee=Q+1,Ot(Z-U,0,"horizontal");else{let Ze=[];if(nn!==void 0){const Ae=nn({x:Z,y:He,width:ee-Z-U,height:ze-He},Xt.current.signal);typeof Ae=="object"&&(Ze=n0(Ae))}if(L===1){let Ae=!1;if(Z<Q){if(Ze.length>0){const at=po(Z+1,Q+1).find(pt=>!Ze.includes(pt-U));at!==void 0&&(Z=at,Ae=!0)}else Z++,Ae=!0;Ae&&Ot(Z,0,"horizontal")}Ae||(ee=Math.min(Pt.length,ee+1),Ot(ee-1-U,0,"horizontal"))}else if(L===-1){let Ae=!1;if(ee>Q+1){if(Ze.length>0){const at=po(ee-1,Q,-1).find(pt=>!Ze.includes(pt-U));at!==void 0&&(ee=at,Ae=!0)}else ee--,Ae=!0;Ae&&Ot(ee-U,0,"horizontal")}Ae||(Z=Math.max(U,Z-1),Ot(Z-U,0,"horizontal"))}else hi()}Wn({cell:xe.current.cell,range:{x:Z,y:He,width:ee-Z,height:ze-He}},!0,!1,"keyboard-select")},Al=c.useRef(Zn);Al.current=Zn;const Oi=(y,A,L,N)=>{const Q=Sn-(L?0:1);y=vn(y,U,Lo.length-1+U),A=vn(A,0,Q);const j=Rn==null?void 0:Rn[0],ue=Rn==null?void 0:Rn[1];if(y===j&&A===ue)return!1;if(N&&xe.current!==void 0){const Z=[...xe.current.rangeStack];(xe.current.range.width>1||xe.current.range.height>1)&&Z.push(xe.current.range),On({...xe,current:{cell:[y,A],range:{x:y,y:A,width:1,height:1},rangeStack:Z}},!0)}else Wn({cell:[y,A],range:{x:y,y:A,width:1,height:1}},!0,!1,"keyboard-nav");return R.current!==void 0&&R.current[0]===y&&R.current[1]===A&&(R.current=void 0),Al.current&&Ot(y-U,A,"both",0,20),!0},xr=(y,A)=>{var L,N,Q,j,ue;const Z=$.current;G.current;let ee=y;const He=(L=(N=z.current)===null||N===void 0?void 0:N.getValue())!==null&&L!==void 0?L:"",ze=(Z==null||(Q=Z.content)===null||Q===void 0?void 0:Q.kind)===te.Custom;if((Z==null?void 0:Z.cell)!==void 0&&He.length>0&&Z.content!==void 0&&!ze){const Ae=Z.content;if(Ae.kind===te.Text)ee={...Ae,data:He,displayData:He};else if(Ae.kind===te.Number){const at=Number.parseFloat(He),pt=Number.isNaN(at)?0:at;ee={...Ae,data:pt,displayData:pt.toLocaleString()}}else Ae.kind===te.Uri?ee={...Ae,data:He,displayData:He}:Ae.kind===te.Markdown&&(ee={...Ae,data:He})}else ze&&(ee=y);if(ee!==void 0&&He.length===0)if(ee.kind===te.Text&&ee.data!==ee.displayData)ee={...ee,displayData:ee.data};else if(ee.kind===te.Number){const Ae=ee.data!==void 0?ee.data.toLocaleString():"0";ee.displayData!==Ae&&(ee={...ee,displayData:Ae})}else ee.kind===te.Uri&&ee.data!==ee.displayData&&(ee={...ee,displayData:ee.data});const et=Z==null?void 0:Z.content,Et=()=>{if(ee===void 0||et===void 0)return!1;if(ee.kind!==et.kind)return!0;switch(ee.kind){case te.Text:case te.Uri:case te.Markdown:return ee.data!==et.data;case te.Number:return ee.data!==et.data;case te.Boolean:return ee.data!==et.data;default:return!0}};(Z==null?void 0:Z.cell)!==void 0&&ee!==void 0&&Kn(ee)&&Et()&&(Ii([{location:Z.cell,value:ee}]),window.requestAnimationFrame(()=>{var Ae;(Ae=Qt.current)===null||Ae===void 0||Ae.damage([{cell:Z.cell}])})),(j=z.current)===null||j===void 0||j.clear(),(ue=z.current)===null||ue===void 0||ue.setVisible(!1),M(!1),kn(!0),$.current=void 0,E(void 0);const[mt,Ze]=A;if(xe.current!==void 0&&(mt!==0||Ze!==0)){const Ae=xe.current.cell[1]===Sn-1;if(Ae&&Ze===1){ve==null||ve(y,[0,0]);return}const at=xe.current.cell[0]===Pt.length-1&&y!==void 0;let pt=!0;if(Ae&&Ze===1&&Qe!==void 0){pt=!1;const it=xe.current.cell[0]+mt,ut=Fl(it);ri(ut??it,!1)}if(at&&mt===1&&ct!==void 0){pt=!1;const it=xe.current.cell[1]+Ze;xl(it,!1)}if(pt){const it=vn(xe.current.cell[0]+mt,U,Pt.length-1),ut=vn(xe.current.cell[1]+Ze,0,Sn-1);Oi(it,ut,Ae,!1),window.requestAnimationFrame(()=>{var gn;(gn=z.current)===null||gn===void 0||gn.focus()})}}ve==null||ve(y,A)},[ms]=c.useState(()=>`gdg-overlay-${t0++}`),Fr=y=>{var A;kn();const L=[];for(let ue=y.x;ue<y.x+y.width;ue++)for(let Z=y.y;Z<y.y+y.height;Z++){const ee=pe([ue-U,Z]);if(!ee.allowOverlay&&ee.kind!==te.Boolean)continue;let He;if(ee.kind===te.Custom){var N;const ze=Qn(ee),et=ze==null||(N=ze.provideEditor)===null||N===void 0?void 0:N.call(ze,{...ee,location:[ue-U,Z]});if((ze==null?void 0:ze.onDelete)!==void 0)He=ze.onDelete(ee);else if(uu(et)){var Q;He=et==null||(Q=et.deletedValue)===null||Q===void 0?void 0:Q.call(et,ee)}}else if(Kn(ee)&&ee.allowOverlay||ee.kind===te.Boolean){var j;const ze=Qn(ee);He=ze==null||(j=ze.onDelete)===null||j===void 0?void 0:j.call(ze,ee)}He!==void 0&&!Co(He)&&Kn(He)&&L.push({location:[ue,Z],value:He})}Ii(L),(A=Qt.current)===null||A===void 0||A.damage(L.map(ue=>({cell:ue.location})))},ws=x!==void 0,{onKeyDown:Go}=Ec({state:Pi,keybindings:ye,overlayOpen:ws,columnSelect:lt,rowSelect:Mt,rangeSelect:Le,editOnType:Ue,trapFocus:pi,showTrailingBlankRow:Ye,columnsInLength:ae.length,rowGroupingNavBehavior:Cr,mapper:kl,onKeyDownIn:Ce,onSelectionCleared:rt,onCellActivated:me,onDelete:sr,getCellContent:pe,setSelectedColumns:Fn,setSelectedRows:xn,setShowSearchInner:hn,searchInputRef:H,adjustSelection:vs,updateSelectedCell:Oi,deleteRange:Fr,fillDown:is,fillRight:ls,appendRow:ri,getCustomNewRowTargetColumn:Fl,scrollToRef:Ti}),[ps,Dr]=c.useState(!1),kr=c.useRef(lu(y=>{Dr(y)},5)),{onGhostInput:Cs,onGhostCompositionStart:ys,onGhostCompositionEnd:bs,onGhostKeyDown:Es,onGhostKeyUp:xs,onGhostFocus:Fs,onGhostBlur:Ds}=Jc({state:Pi,onKeyDown:Go,onFinishEditing:xr,onKeyUpIn:Ke,onCellActivated:me,setIsFocused:Dr}),ks=(y,A)=>{const L=y.location[0]-U;if(y.kind==="header"&&(ge==null||ge(L,{...y,preventDefault:A})),y.kind===bn){if(L<0)return;Me==null||Me(L,{...y,preventDefault:A})}if(y.kind==="cell"){const[N,Q]=y.location;T==null||T([L,Q],{...y,preventDefault:A}),Fd(xe,y.location)||Oi(N,Q,!1,!1)}},{onCopy:Sr,onPasteInternal:Rr}=Ic({state:Pi,keybindings:ye,getCellsForSelection:nn,coercePasteValue:q,onPaste:Pe,copyHeaders:St,columnsIn:ae,onDelete:sr,deleteRange:Fr,safeWindow:le}),Ss=(y,A)=>{if(fe!==void 0){U!==0&&(y=y.map(Q=>[Q[0]-U,Q[1]])),fe(y,A);return}if(y.length===0||A===-1)return;const[L,N]=y[A];R.current!==void 0&&R.current[0]===L&&R.current[1]===N||(R.current=[L,N],Oi(L,N,!1,!1))},[Wi,Ni]=(C=gt==null||(p=gt.current)===null||p===void 0?void 0:p.cell)!==null&&C!==void 0?C:[];c.useLayoutEffect(()=>{var y,A;Al.current&&!Bi.current&&Wi!==void 0&&Ni!==void 0&&(Wi!==((y=pn.current)===null||y===void 0||(y=y.current)===null||y===void 0?void 0:y.cell[0])||Ni!==((A=pn.current)===null||A===void 0||(A=A.current)===null||A===void 0?void 0:A.cell[1]))&&Ti.current(Wi,Ni),Bi.current=!1},[Wi,Ni]);const Mr=xe.current!==void 0&&(xe.current.cell[0]>=Pt.length||xe.current.cell[1]>=Sn);c.useLayoutEffect(()=>{Mr&&On(Pl,!1)},[Mr,On]);const Rs=Ye===!0&&(Rt==null?void 0:Rt.tint)===!0?Je.fromSingleSelection(Sn-1):Je.empty(),Ms=y=>{var A;return typeof Ut=="boolean"?Ut:(A=Ut==null?void 0:Ut(y-U))!==null&&A!==void 0?A:!0},As=Li===void 0||B.current===null?null:c.createElement(fc,{bounds:Li.bounds,group:Li.group,canvasBounds:B.current.getBoundingClientRect(),onClose:()=>Sl(void 0),onFinish:y=>{Sl(void 0),Se==null||Se(Li.group,y)}}),Bs=Math.min(Pt.length,Bt+U);c.useImperativeHandle(t,()=>({appendRow:(y,A)=>ri(y+U,A),appendColumn:(y,A)=>xl(y,A),updateCells:y=>{var A;return U!==0&&(y=y.map(L=>({cell:[L.cell[0]+U,L.cell[1]]}))),(A=Qt.current)===null||A===void 0?void 0:A.damage(y)},getBounds:(y,A)=>{var L;if(!((B==null?void 0:B.current)===null||(kt==null?void 0:kt.current)===null)){if(y===void 0&&A===void 0){const N=B.current.getBoundingClientRect(),Q=N.width/kt.current.clientWidth;return{x:N.x-kt.current.scrollLeft*Q,y:N.y-kt.current.scrollTop*Q,width:kt.current.scrollWidth*Q,height:kt.current.scrollHeight*Q}}return(L=Qt.current)===null||L===void 0?void 0:L.getBounds((y??0)+U,A)}},focus:()=>{var y;return(y=Qt.current)===null||y===void 0?void 0:y.focus()},emit:async y=>{switch(y){case"delete":Go({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Go({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Go({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Sr(void 0,!0);break;case"paste":await Rr();break}},scrollTo:Ot,remeasureColumns:y=>{for(const A of y)yr(A+U)},getMouseArgsForPosition:(y,A,L)=>{if((Qt==null?void 0:Qt.current)===null)return;const N=Qt.current.getMouseArgsForPosition(y,A,L);if(N!==void 0)return{...N,location:[N.location[0]-U,N.location[1]]}}}),[ri,xl,yr,kt,Sr,Go,Rr,U,Ot]);const[Is,Hs]=Rn??[],Ts=y=>{const[A,L]=y;if(L===-1){lt!=="none"&&(Fn(Je.fromSingleSelection(A),void 0,!1),kn());return}Is===A&&Hs===L||(Wn({cell:y,range:{x:A,y:L,width:1,height:1}},!0,!1,"keyboard-nav"),Ot(A,L))},zs=()=>{kr.current(!0),xe.current===void 0&&xe.columns.length===0&&xe.rows.length===0&&S===void 0&&Wn({cell:[U,wl],range:{x:U,y:wl,width:1,height:1}},!0,!1,"keyboard-select")},Ps=()=>{kr.current(!1)},[Ls,Os]=(y=>{let A;const L=(y=$t==null?void 0:$t.scrollbarWidthOverride)!==null&&y!==void 0?y:Nl(),N=st+(Ye?1:0);if(typeof be=="number")A=ml+N*be;else{let j=0;const ue=Math.min(N,10);for(let Z=0;Z<ue;Z++)j+=be(Z);j=Math.floor(j/ue),A=ml+N*j}A+=L;const Q=Pt.reduce((j,ue)=>ue.width+j,0)+L;return[`${Math.min(1e5,Q)}px`,`${Math.min(1e5,A)}px`]})(),Ws=gu(Dn);return c.createElement(Jl.Provider,{value:Dn},c.createElement(Rc,{style:Ws,className:ie,inWidth:X??Ls,inHeight:oe??Os},c.createElement(dc,{fillHandle:mi,drawFocusRing:Ei,experimental:$t,fixedShadowX:Fo,fixedShadowY:Do,getRowThemeOverride:P,headerIcons:ko,imageWindowLoader:fo,initialSize:qn,isDraggable:ll,onDragLeave:wi,onRowMoved:Jo,overscrollX:Oe,overscrollY:nt,preventDiagonalScrolling:_n,rightElement:ul,rightElementProps:sl,smoothScrollX:Ci,smoothScrollY:So,className:ie,enableGroups:ar,onCanvasFocused:zs,onCanvasBlur:Ps,canvasRef:B,onContextMenu:ks,theme:Dn,cellXOffset:Zu,cellYOffset:wl,accessibilityHeight:mo.height,onDragEnd:hs,columns:Pt,nonGrowWidth:dr,drawHeader:Ku,onColumnProposeMove:as,drawCell:Yu,disabledRows:Rs,freezeColumns:Bs,lockColumns:U,firstColAccessible:U===0,getCellContent:Wo,minColumnWidth:Ln,maxColumnWidth:oi,searchInputRef:H,showSearch:En,onSearchClose:tn,highlightRegions:Ju,getCellsForSelection:nn,getGroupDetails:vr,headerHeight:De,isFocused:ps,groupHeaderHeight:ar?we:0,groupLevels:ii,groupHeaderHeights:cr,freezeTrailingRows:vt+(Ye&&(Rt==null?void 0:Rt.sticky)===!0?1:0),hasAppendRow:Ye,onColumnResize:Jn,onColumnResizeEnd:hl,onColumnResizeStart:gl,onCellFocused:Ts,onColumnMoved:cs,onDragStart:fs,onHeaderMenuClick:us,onHeaderIndicatorClick:ss,onItemHovered:Er,isFilling:(S==null?void 0:S.fillHandle)===!0,onMouseMove:os,onKeyDown:Go,onKeyUp:Ke,onMouseDown:ts,onMouseUp:ns,onDragOverCell:vi,onDrop:jn,onSearchResultsChanged:Ss,onVisibleRegionChanged:ds,clientSize:vl,rowHeight:be,searchResults:Ee,searchValue:We,onSearchValueChange:Te,rows:Sn,scrollRef:kt,selection:xe,translateX:mo.tx,translateY:mo.ty,verticalBorder:Ms,gridRef:Qt,getCellRenderer:Qn,resizeIndicator:ei}),As,x!==void 0&&c.createElement(c.Suspense,{fallback:null},c.createElement(e0,{...x,validateCell:vo,bloom:re,id:ms,getCellRenderer:Qn,className:($t==null?void 0:$t.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:_o,imageEditorOverride:Y,portalElementRef:Bo,onFinishEditing:xr,markdownDivCreateNode:se,isOutsideClick:Mo,customEventTarget:$t==null?void 0:$t.eventTarget,isGhostMode:F}))),(y=>{const A=(y=Bo==null?void 0:Bo.current)!==null&&y!==void 0?y:document.getElementById("portal");return A===null?null:iu.createPortal(c.createElement(_c,{ref:z,onInput:Cs,onCompositionStart:ys,onCompositionEnd:bs,onKeyDown:Es,onKeyUp:xs,onFocus:Fs,onBlur:Ds}),A)})())},i0=c.forwardRef(o0);function eu(e){var t,n;const{cell:o,posX:i,posY:l,bounds:u,theme:r}=e,{width:s,height:a,x:d,y:h}=u,g=(t=o.maxSize)!==null&&t!==void 0?t:r.checkboxMaxSize,m=Math.floor(u.y+a/2),f=au(g,a,r.cellVerticalPadding),v=du((n=o.contentAlign)!==null&&n!==void 0?n:"center",d,s,r.cellHorizontalPadding,f),C=su(v,m,f),p=cu(d+i,h+l,C);return jl(o)&&p}const l0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"false"},kind:te.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>{var t,n;return r0(e,e.cell.data,jl(e.cell),(t=e.cell.maxSize)!==null&&t!==void 0?t:e.theme.checkboxMaxSize,(n=e.cell.hoverEffectIntensity)!==null&&n!==void 0?n:.35)},onDelete:e=>({...e,data:!1}),onSelect:e=>{eu(e)&&e.preventDefault()},onClick:e=>{if(eu(e))return{...e.cell,data:lr(e.cell.data)}},onPaste:(e,t)=>{let n=ji;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Ul),n===t.data?void 0:{...t,data:n}}};function r0(e,t,n,o,i){if(!n&&t===ji)return;const{ctx:l,hoverAmount:u,theme:r,rect:s,highlighted:a,hoverX:d,hoverY:h,cell:{contentAlign:g}}=e,{x:m,y:f,width:v,height:C}=s;let p=!1;if(i>0){let w=n?1-i+i*u:.4;if(t===ji&&(w*=u),w===0)return;w<1&&(p=!0,l.globalAlpha=w)}Ji(l,r,t,m,f,v,C,a,d,h,o,g),p&&(l.globalAlpha=1)}const u0=_t("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),s0=e=>{const t=sn.c(9),{bubbles:n}=e,{isGhostMode:o}=c.useContext(qo);let i;if(t[0]!==n||t[1]!==o){let l;t[3]!==n?(l=n.map(d0),t[3]=n,t[4]=l):l=t[4];let u;if(t[5]!==o){const r=!o;let s;t[7]!==r?(s={className:"gdg-input",autoFocus:r},t[7]=r,t[8]=s):s=t[8],u=c.createElement("textarea",s),t[5]=o,t[6]=u}else u=t[6];i=c.createElement(u0,null,l,u),t[0]=n,t[1]=o,t[2]=i}else i=t[2];return i};function d0(e,t){return c.createElement("div",{key:t,className:"boe-bubble"},e)}const a0={getAccessibilityString:e=>fu(e.data),kind:te.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((i,l)=>e.measureText(l).width+i+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>c0(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return c.createElement(s0,{bubbles:t.data})},onPaste:()=>{}};function c0(e,t){const{rect:n,theme:o,ctx:i,highlighted:l}=e,{x:u,y:r,width:s,height:a}=n;let d=u+o.cellHorizontalPadding;const h=[];for(const m of t){if(d>u+s)break;const f=Eo(m,i,o.baseFontFull).width;h.push({x:d,width:f}),d+=f+o.bubblePadding*2+o.bubbleMargin}i.beginPath();for(const m of h){var g;Bn(i,m.x,r+(a-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,(g=o.roundingRadius)!==null&&g!==void 0?g:o.bubbleHeight/2)}i.fillStyle=l?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[m,f]of h.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[m],f.x+o.bubblePadding,r+a/2+un(i,o))}const f0=_t("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),h0=e=>{const{drilldowns:t}=e;return c.createElement(f0,null,t.map((n,o)=>c.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&c.createElement("img",{src:n.img}),c.createElement("div",null,n.text))))},g0={getAccessibilityString:e=>fu(e.data.map(t=>t.text)),kind:te.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+n.bubblePadding*2+n.bubbleMargin+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>m0(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return c.createElement(h0,{drilldowns:t.data})},onPaste:()=>{}},Ll={};function v0(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),l=5,u=n-l*2,r=4,s=n*i,a=o+l,d=o*3,h=(d+l*2)*i,g=`${e},${t},${i},${n}`;if(Ll[g]!==void 0)return{el:Ll[g],height:s,width:h,middleWidth:r*i,sideWidth:a*i,padding:l*i,dpr:i};const m=document.createElement("canvas"),f=m.getContext("2d");return f===null?null:(m.width=h,m.height=s,f.scale(i,i),Ll[g]=m,f.beginPath(),Bn(f,l,l,d,u,o),f.shadowColor="rgba(24, 25, 34, 0.4)",f.shadowBlur=1,f.fillStyle=e,f.fill(),f.shadowColor="rgba(24, 25, 34, 0.3)",f.shadowOffsetY=1,f.shadowBlur=5,f.fillStyle=e,f.fill(),f.shadowOffsetY=0,f.shadowBlur=0,f.shadowBlur=0,f.beginPath(),Bn(f,l+.5,l+.5,d,u,o),f.strokeStyle=t,f.lineWidth=1,f.stroke(),{el:m,height:s,width:h,sideWidth:a*i,middleWidth:o*i,padding:l*i,dpr:i})}function m0(e,t){var n;const{rect:o,theme:i,ctx:l,imageLoader:u,col:r,row:s}=e,{x:a,width:d}=o,h=i.baseFontFull,g=ku(l,h),m=Math.min(o.height,Math.max(16,Math.ceil(g*i.lineHeight)*2)),f=Math.floor(o.y+(o.height-m)/2),v=m-10,C=i.bubblePadding,p=i.bubbleMargin;let w=a+i.cellHorizontalPadding;const b=(n=i.roundingRadius)!==null&&n!==void 0?n:6,x=v0(i.bgCell,i.drilldownBorder,m,b),E=[];for(const B of t){if(w>a+d)break;const D=Eo(B.text,l,h).width;let k=0;B.img!==void 0&&u.loadOrGetImage(B.img,r,s)!==void 0&&(k=v-8+4);const I=D+k+C*2;E.push({x:w,width:I}),w+=I+p}if(x!==null){const{el:B,height:S,middleWidth:D,sideWidth:k,width:I,dpr:R,padding:z}=x,F=k/R,M=z/R;for(const G of E){const $=Math.floor(G.x),le=Math.floor(G.width),Y=le-(F-M)*2;l.imageSmoothingEnabled=!1,l.drawImage(B,0,0,k,S,$-M,f,F,m),Y>0&&l.drawImage(B,k,0,D,S,$+(F-M),f,Y,m),l.drawImage(B,I-k,0,k,S,$+le-(F-M),f,F,m),l.imageSmoothingEnabled=!0}}l.beginPath();for(const[B,S]of E.entries()){const D=t[B];let k=S.x+C;if(D.img!==void 0){const I=u.loadOrGetImage(D.img,r,s);if(I!==void 0){var H;const R=v-8;let z=0,F=0,M=I.width,G=I.height;M>G?(z+=(M-G)/2,M=G):G>M&&(F+=(G-M)/2,G=M),l.beginPath(),Bn(l,k,f+m/2-R/2,R,R,(H=i.roundingRadius)!==null&&H!==void 0?H:3),l.save(),l.clip(),l.drawImage(I,z,F,M,G,k,f+m/2-R/2,R,R),l.restore(),k+=R+4}}l.beginPath(),l.fillStyle=i.textBubble,l.fillText(D.text,k,f+m/2+un(l,i))}}const w0={getAccessibilityString:e=>e.data.join(", "),kind:te.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>{var t,n,o;return p0(e,(t=e.cell.displayData)!==null&&t!==void 0?t:e.cell.data,(n=(o=e.cell.rounding)!==null&&o!==void 0?o:e.theme.roundingRadius)!==null&&n!==void 0?n:4,e.cell.contentAlign)},measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??id;return c.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:l=>{n({...t,data:[l]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,l)=>i===t.data[l])))return{...t,data:o}}},Ol=4;function p0(e,t,n,o){const{rect:i,col:l,row:u,theme:r,ctx:s,imageLoader:a}=e,{x:d,y:h,height:g,width:m}=i,f=g-r.cellVerticalPadding*2,v=[];let C=0;for(let w=0;w<t.length;w++){const b=t[w];if(b.length===0)continue;const x=a.loadOrGetImage(b,l,u);if(x!==void 0){v[w]=x;const E=x.width*(f/x.height);C+=E+Ol}}if(C===0)return;C-=Ol;let p=d+r.cellHorizontalPadding;o==="right"?p=Math.floor(d+m-r.cellHorizontalPadding-C):o==="center"&&(p=Math.floor(d+m/2-C/2));for(const w of v){if(w===void 0)continue;const b=w.width*(f/w.height);n>0&&(s.beginPath(),Bn(s,p,h+r.cellVerticalPadding,b,f,n),s.save(),s.clip()),s.drawImage(w,p,h+r.cellVerticalPadding,b,f),n>0&&s.restore(),p+=b+Ol}}function C0(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const y0={getAccessibilityString:()=>"",kind:te.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{var t,n;const{cell:o,col:i,row:l,ctx:u,rect:r,theme:s}=e;if(o.skeletonWidth===void 0||o.skeletonWidth===0)return;let a=o.skeletonWidth;o.skeletonWidthVariability!==void 0&&o.skeletonWidthVariability>0&&(a+=Math.round(C0(i,l)*o.skeletonWidthVariability));const d=s.cellHorizontalPadding;a+d*2>=r.width&&(a=r.width-d*2-1);const h=(t=o.skeletonHeight)!==null&&t!==void 0?t:Math.min(18,r.height-2*s.cellVerticalPadding);Bn(u,r.x+d,r.y+(r.height-h)/2,a,h,(n=s.roundingRadius)!==null&&n!==void 0?n:3),u.fillStyle=ao(s.textDark,.1),u.fill()},onPaste:()=>{}},b0=()=>e=>e.targetWidth,tu=_t("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[b0(),"px"]}}),E0=e=>{const t=sn.c(52),{value:n,onChange:o,forceEditMode:i,createNode:l,targetRect:u,onFinish:r,validatedSelection:s}=e,{isGhostMode:a}=c.useContext(qo),d=n.data,h=n.readonly===!0,[g,m]=c.useState(d===""||i);let f;t[0]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{m(x0)},t[0]=f):f=t[0];const v=f,C=d?"gdg-ml-6":"";if(g){let w;if(t[1]!==C||t[2]!==a||t[3]!==d||t[4]!==o||t[5]!==r||t[6]!==u.width||t[7]!==s||t[8]!==n){const b=u.width-20;let x;t[10]!==b?(x={targetWidth:b},t[10]=b,t[11]=x):x=t[11];let E;if(t[12]!==a||t[13]!==d||t[14]!==o||t[15]!==s){const B=!a;let S;t[17]!==d||t[18]!==o||t[19]!==B||t[20]!==s?(S={autoFocus:B,highlight:!1,validatedSelection:s,value:d,onKeyDown:F0,onChange:o},t[17]=d,t[18]=o,t[19]=B,t[20]=s,t[21]=S):S=t[21],E=c.createElement(Ql,S),t[12]=a,t[13]=d,t[14]=o,t[15]=s,t[16]=E}else E=t[16];let H;if(t[22]!==C||t[23]!==r||t[24]!==n){const B=`gdg-edit-icon gdg-checkmark-hover ${C}`;let S;t[26]!==r||t[27]!==n?(S=()=>r(n),t[26]=r,t[27]=n,t[28]=S):S=t[28];let D;t[29]!==B||t[30]!==S?(D={className:B,onClick:S},t[29]=B,t[30]=S,t[31]=D):D=t[31];let k;t[32]===Symbol.for("react.memo_cache_sentinel")?(k=c.createElement(Zs,null),t[32]=k):k=t[32],H=c.createElement("div",D,k),t[22]=C,t[23]=r,t[24]=n,t[25]=H}else H=t[25];w=c.createElement(tu,x,E,H),t[1]=C,t[2]=a,t[3]=d,t[4]=o,t[5]=r,t[6]=u.width,t[7]=s,t[8]=n,t[9]=w}else w=t[9];return w}let p;if(t[33]!==C||t[34]!==l||t[35]!==a||t[36]!==d||t[37]!==h||t[38]!==u.width){let w;t[40]!==u.width?(w={targetWidth:u.width},t[40]=u.width,t[41]=w):w=t[41];let b;t[42]!==l||t[43]!==d?(b=c.createElement(rd,{contents:d,createNode:l}),t[42]=l,t[43]=d,t[44]=b):b=t[44];let x;t[45]!==C||t[46]!==h?(x=!h&&c.createElement(c.Fragment,null,c.createElement("div",{className:"spacer"}),c.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${C}`,onClick:v},c.createElement(_l,null))),t[45]=C,t[46]=h,t[47]=x):x=t[47];let E;if(t[48]!==a){const H=!a;let B;t[50]!==H?(B={className:"gdg-md-edit-textarea gdg-input",autoFocus:H},t[50]=H,t[51]=B):B=t[51],E=c.createElement("textarea",B),t[48]=a,t[49]=E}else E=t[49];p=c.createElement(tu,w,b,x,E),t[33]=C,t[34]=l,t[35]=a,t[36]=d,t[37]=h,t[38]=u.width,t[39]=p}else p=t[39];return p};function x0(e){return!e}function F0(e){e.key==="Enter"&&e.stopPropagation()}const D0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""},kind:te.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:tl,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>$n(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:l,forceEditMode:u,validatedSelection:r}=e;return c.createElement(E0,{onFinish:i,targetRect:o,value:n,validatedSelection:r,onChange:s=>t({...n,data:s.target.value}),forceEditMode:u,createNode:l})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},k0={getAccessibilityString:e=>e.row.toString(),kind:Nt.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:S0,measure:()=>44,draw:e=>M0(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e;if(n.disabled===!0)return;const{width:l,height:u}=t,r=n.drawHandle?7+(l-7)/2:l/2,s=u/2;if(Math.abs(o-r)<=10&&Math.abs(i-s)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function S0(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,l=t??{};return(l==null?void 0:l.font)!==i&&(n.font=i,l.font=i),l.deprep=R0,n.textAlign="center",l}function R0(e){const{ctx:t}=e;t.textAlign="start"}function M0(e,t,n,o,i,l,u){if(u){const{ctx:C,rect:p,theme:w}=e,{x:b,y:x,width:E,height:H}=p,B=o==="checkbox"?"checkbox-visible":o;if(B!=="number"&&(C.globalAlpha=n?1:.4,Ji(C,w,n,i?b+7:b,x,i?E-7:E,H,!1,-20,-20,w.checkboxMaxSize,"center",l,!0),C.globalAlpha=1),B==="number"||B==="both"&&!n){const S=t.toString(),D=w.markerFontFull,k=b+E/2;C.fillStyle="#cccccc",C.font=D,C.fillText(S,k,x+H/2+un(C,D))}if(i){C.globalAlpha=.4,C.beginPath();for(const S of[3,6])for(const D of[-5,-1,3])C.rect(b+S,x+H/2+D,2,2);C.fillStyle="#cccccc",C.fill(),C.beginPath(),C.globalAlpha=1}return}const{ctx:r,rect:s,hoverAmount:a,theme:d}=e,{x:h,y:g,width:m,height:f}=s,v=n?1:o==="checkbox-visible"?.6+.4*a:a;if(o!=="number"&&v>0){r.globalAlpha=v;const C=7*(n?a:1);if(Ji(r,d,n,i?h+C:h,g,i?m-C:m,f,!0,void 0,void 0,d.checkboxMaxSize,"center",l,u),i){r.globalAlpha=a,r.beginPath();for(const p of[3,6])for(const w of[-5,-1,3])r.rect(h+p,g+f/2+w,2,2);r.fillStyle=d.textLight,r.fill(),r.beginPath()}r.globalAlpha=1}if(o==="number"||o==="both"&&!n){const C=t.toString(),p=d.markerFontFull,w=h+m/2;o==="both"&&a!==0&&(r.globalAlpha=1-a),r.fillStyle=d.textLight,r.font=p,r.fillText(C,w,g+f/2+un(r,p)),a!==0&&(r.globalAlpha=1)}}const A0={getAccessibilityString:()=>"",kind:Nt.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>B0(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function B0(e,t,n){const{ctx:o,rect:i,hoverAmount:l,theme:u,spriteManager:r}=e,{x:s,y:a,width:d,height:h}=i;o.beginPath(),o.globalAlpha=l,o.rect(s+1,a+1,d,h-2),o.fillStyle=u.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let m=0;if(n!==void 0){const v=h-8,C=s+8/2,p=a+8/2;r.drawSprite(n,"normal",o,C,p,v,u,g?1:l),m=v}else{m=24;const f=12,v=g?f:l*f,C=g?0:(1-l)*f*.5,p=u.cellHorizontalPadding+4;v>0&&(o.moveTo(s+p+C,a+h/2),o.lineTo(s+p+C+v,a+h/2),o.moveTo(s+p+C+v*.5,a+h/2-v*.5),o.lineTo(s+p+C+v*.5,a+h/2+v*.5),o.lineWidth=2,o.strokeStyle=u.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=u.textMedium,o.fillText(t,m+s+u.cellHorizontalPadding+.5,a+h/2+un(o,u)),o.beginPath()}function $u(e,t,n,o,i,l,u){var r,s,a;e.textBaseline="alphabetic";const d=I0(e,i,o,t,(r=n==null?void 0:n.fullSize)!==null&&r!==void 0?r:!1);e.beginPath(),Bn(e,d.x,d.y,d.width,d.height,(s=t.roundingRadius)!==null&&s!==void 0?s:4),e.globalAlpha=l,e.fillStyle=(a=n==null?void 0:n.bgColor)!==null&&a!==void 0?a:ao(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",u==null||u("text")}function I0(e,t,n,o,i){const l=o.cellHorizontalPadding,u=o.cellVerticalPadding;if(i)return{x:t.x+l/2,y:t.y+u/2+1,width:t.width-l,height:t.height-u-1};const r=Eo(n,e,o.baseFontFull,"alphabetic"),s=t.height-u,a=Math.min(s,r.actualBoundingBoxAscent*2.5);return{x:t.x+l/2,y:t.y+(t.height-a)/2+1,width:r.width+l*3,height:a-1}}const H0=c.lazy(async()=>await ou(()=>import("./number-overlay-editor-B2Uwr3VQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),T0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""},kind:te.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:tl,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:l,overrideCursor:u}=e,{hoverEffect:r,displayData:s,hoverEffectTheme:a}=n;r===!0&&t>0&&$u(o,i,a,s,l,t,u),$n(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,onFinishedEditing:o,value:i,validatedSelection:l}=e;return c.createElement(c.Suspense,{fallback:null},c.createElement(H0,{highlight:t,disabled:i.readonly===!0,value:i.data,fixedDecimals:i.fixedDecimals,allowNegative:i.allowNegative,thousandSeparator:i.thousandSeparator,decimalSeparator:i.decimalSeparator,validatedSelection:l,onChange:u=>{var r;return n({...i,data:Number.isNaN((r=u.floatValue)!==null&&r!==void 0?r:0)?0:u.floatValue})},onKeyDown:u=>{u.key==="Enter"&&!u.shiftKey?(u.preventDefault(),o(i,[0,1])):u.key==="Tab"?(u.preventDefault(),o(i,[u.shiftKey?-1:1,0])):u.key==="Escape"&&(u.preventDefault(),o(void 0,[0,0]))}}))},onPaste:(e,t,n)=>{var o;const i=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(i)||t.data===i))return{...t,data:i,displayData:(o=n.formattedString)!==null&&o!==void 0?o:t.displayData}}},z0={getAccessibilityString:()=>"",measure:()=>108,kind:te.Protected,needsHover:!1,needsHoverPosition:!1,draw:P0,onPaste:()=>{}};function P0(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:l,height:u}=o;t.beginPath();const r=2.5;let s=i+n.cellHorizontalPadding+r;const a=l+u/2,d=Math.cos(Tr(30))*r,h=Math.sin(Tr(30))*r;for(let g=0;g<12;g++)t.moveTo(s,a-r),t.lineTo(s,a+r),t.moveTo(s+d,a-h),t.lineTo(s-d,a+h),t.moveTo(s-d,a-h),t.lineTo(s+d,a+h),s+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const L0={getAccessibilityString:e=>{var t;return(t=e.rowId)!==null&&t!==void 0?t:""},kind:Nt.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>{var o;return Eo((o=t.rowId)!==null&&o!==void 0?o:"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2},draw:e=>{const{ctx:t,rect:n,cell:o,theme:i}=e,l=o.rowId;if(!l)return;t.fillStyle=i.textDark,t.font=i.baseFontStyle,t.textAlign="left";const u=n.x+i.cellHorizontalPadding,r=n.y+n.height/2;t.fillText(l,u,r+un(t,i))},onClick:()=>{},onPaste:()=>{}},O0={getAccessibilityString:e=>{var t;return(t=e.rowId)!==null&&t!==void 0?t:""},kind:Nt.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:W0,measure:()=>80,draw:e=>G0(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function W0(e,t){const{ctx:n}=e,o="12px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=N0,n.textAlign="left",i}function N0(e){const{ctx:t}=e;t.textAlign="start"}function G0(e,t){if(!t)return;const{ctx:n,rect:o,theme:i}=e,{x:l,y:u,height:r}=o;n.fillStyle=i.textDark,n.font="12px sans-serif";const s=l+8,a=u+r/2;n.fillText(t,s,a+un(n,n.font))}const $0={getAccessibilityString:e=>{var t;return(t=e.status)!==null&&t!==void 0?t:""},kind:Nt.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:X0,measure:()=>40,draw:e=>Y0(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function X0(e,t){const{ctx:n}=e,o="bold 14px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=K0,n.textAlign="center",i}function K0(e){const{ctx:t}=e;t.textAlign="start"}function Y0(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:i,y:l,width:u,height:r}=o,s={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=s[t],n.font="bold 14px sans-serif";const a=i+u/2,d=l+r/2;n.fillText(t,a,d+un(n,n.font))}const V0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""},kind:te.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:tl,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:l,theme:u,overrideCursor:r}=e,{displayData:s,contentAlign:a,hoverEffect:d,allowWrapping:h,hoverEffectTheme:g}=t;d===!0&&n>0&&$u(i,u,g,s,l,n,r),$n(e,s,a,h,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const l of o)i=Math.max(i,e.measureText(l).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:l}=t;return c.createElement(Ql,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:l,onChange:u=>o({...i,data:u.target.value})})}}),onPaste:(e,t,n)=>{var o;return e===t.data?void 0:{...t,data:e,displayData:(o=n.formattedString)!==null&&o!==void 0?o:t.displayData}}},U0=_t("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),j0=e=>{const t=sn.c(27),{uri:n,onChange:o,forceEditMode:i,readonly:l,validatedSelection:u,preview:r}=e,{isGhostMode:s}=c.useContext(qo),[a,d]=c.useState(!l&&(n===""||i));let h;t[0]===Symbol.for("react.memo_cache_sentinel")?(h=()=>{d(!0)},t[0]=h):h=t[0];const g=h;if(a){let f;if(t[1]!==s||t[2]!==o||t[3]!==n||t[4]!==u){const v=!s;let C;t[6]!==o||t[7]!==v||t[8]!==n||t[9]!==u?(C={validatedSelection:u,highlight:!0,autoFocus:v,value:n,onChange:o},t[6]=o,t[7]=v,t[8]=n,t[9]=u,t[10]=C):C=t[10],f=c.createElement(Ql,C),t[1]=s,t[2]=o,t[3]=n,t[4]=u,t[5]=f}else f=t[5];return f}let m;if(t[11]!==s||t[12]!==r||t[13]!==l||t[14]!==n){let f;if(t[16]!==r||t[17]!==n){let p;t[19]!==n?(p={className:"gdg-link-area",href:n,target:"_blank",rel:"noopener noreferrer"},t[19]=n,t[20]=p):p=t[20],f=c.createElement("a",p,r),t[16]=r,t[17]=n,t[18]=f}else f=t[18];let v;t[21]!==l?(v=!l&&c.createElement("div",{className:"gdg-edit-icon",onClick:g},c.createElement(_l,null)),t[21]=l,t[22]=v):v=t[22];let C;if(t[23]!==s){const p=!s;let w;t[25]!==p?(w={className:"gdg-input",autoFocus:p},t[25]=p,t[26]=w):w=t[26],C=c.createElement("textarea",w),t[23]=s,t[24]=C}else C=t[24];m=c.createElement(U0,null,f,v,C),t[11]=s,t[12]=r,t[13]=l,t[14]=n,t[15]=m}else m=t[15];return m};function Xu(e,t,n,o){let i=n.cellHorizontalPadding;const l=t.height/2-e.actualBoundingBoxAscent/2,u=e.width,r=e.actualBoundingBoxAscent;return o==="right"?i=t.width-u-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-u/2),{x:i,y:l,width:u,height:r}}function nu(e){var t;const{cell:n,bounds:o,posX:i,posY:l,theme:u}=e,r=(t=n.displayData)!==null&&t!==void 0?t:n.data;if(n.hoverEffect!==!0||n.onClickUri===void 0)return!1;const s=Fu(r,u.baseFontFull);if(s===void 0)return!1;const a=Xu(s,o,u,n.contentAlign);return uo({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},i,l)}const q0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""},kind:te.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:tl,draw:e=>{var t;const{cell:n,theme:o,overrideCursor:i,hoverX:l,hoverY:u,rect:r,ctx:s}=e,a=(t=n.displayData)!==null&&t!==void 0?t:n.data,d=n.hoverEffect===!0;if(i!==void 0&&d&&l!==void 0&&u!==void 0){const h=Eo(a,s,o.baseFontFull),g=Xu(h,r,o,n.contentAlign),{x:m,y:f,width:v,height:C}=g;if(l>=m-4&&l<=m-4+v+8&&u>=f-4&&u<=f-4+C+8){const p=un(s,o.baseFontFull);i("pointer");const w=5,b=f-p;s.beginPath(),s.moveTo(r.x+m,Math.floor(r.y+b+C+w)+.5),s.lineTo(r.x+m+v,Math.floor(r.y+b+C+w)+.5),s.strokeStyle=o.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,$n({...e,rect:{...r,x:r.x-1}},a,n.contentAlign),$n({...e,rect:{...r,x:r.x-2}},a,n.contentAlign),$n({...e,rect:{...r,x:r.x+1}},a,n.contentAlign),$n({...e,rect:{...r,x:r.x+2}},a,n.contentAlign),s.restore()}}s.fillStyle=d?o.linkColor:o.textDark,$n(e,a,n.contentAlign)},onSelect:e=>{nu(e)&&e.preventDefault()},onClick:e=>{const{cell:t}=e;if(nu(e)){var o;(o=t.onClickUri)===null||o===void 0||o.call(t,e)}},measure:(e,t,n)=>{var o;return e.measureText((o=t.displayData)!==null&&o!==void 0?o:t.data).width+n.cellHorizontalPadding*2},onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{var n;const{onChange:o,value:i,forceEditMode:l,validatedSelection:u}=t;return c.createElement(j0,{forceEditMode:i.readonly!==!0&&(l||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:i.data,preview:(n=i.displayData)!==null&&n!==void 0?n:i.data,validatedSelection:u,readonly:i.readonly===!0,onChange:r=>o({...i,data:r.target.value})})},onPaste:(e,t,n)=>{var o;return e===t.data?void 0:{...t,data:e,displayData:(o=n.formattedString)!==null&&o!==void 0?o:t.displayData}}},_0=[k0,A0,$0,O0,l0,a0,g0,w0,y0,D0,T0,z0,L0,V0,q0],Wl=[];class Z0 extends Ru{constructor(){super(...arguments),this.imageLoaded=()=>{},this.loadedLocations=[],this.cache={},this.sendLoaded=Ys(()=>{this.imageLoaded(new Ko(this.loadedLocations)),this.loadedLocations=[]},20),this.clearOutOfWindow=()=>{const t=Object.keys(this.cache);for(const n of t){const o=this.cache[n];let i=!1;for(let l=0;l<o.cells.length;l++){const u=o.cells[l];if(this.isInWindow(u)){i=!0;break}}i?o.cells=o.cells.filter(this.isInWindow):(o.cancel(),delete this.cache[n])}}}setCallback(t){this.imageLoaded=t}loadImage(t,n,o,i){var l;let u=!1;const r=(l=Wl.pop())!==null&&l!==void 0?l:new Image;let s=!1;const a={img:void 0,cells:[yn(n,o)],url:t,cancel:()=>{s||(s=!0,Wl.length<12?Wl.unshift(r):u||(r.src=""))}},d=new Promise(h=>r.addEventListener("load",()=>h(null)));requestAnimationFrame(async()=>{try{r.src=t,await d,await r.decode();const h=this.cache[i];if(h!==void 0&&!s){h.img=r;for(const g of h.cells)this.loadedLocations.push(nr(g));u=!0,this.sendLoaded()}}catch{a.cancel()}}),this.cache[i]=a}loadOrGetImage(t,n,o){const i=t,l=this.cache[i];if(l!==void 0){const u=yn(n,o);return l.cells.includes(u)||l.cells.push(u),l.img}else this.loadImage(t,n,o,i)}}const J0=(e,t)=>{const n=c.useMemo(()=>({...ma,...e.headerIcons}),[e.headerIcons]),o=c.useMemo(()=>{var l;return(l=e.renderers)!==null&&l!==void 0?l:_0},[e.renderers]),i=c.useMemo(()=>{var l;return(l=e.imageWindowLoader)!==null&&l!==void 0?l:new Z0},[e.imageWindowLoader]);return c.createElement(i0,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:i})},ff=c.forwardRef(J0);export{ff as D,te as G,Ql as a,ku as b,rn as c,cf as d,df as e,uf as f,un as g,Kn as h,sf as i,Ir as j,qo as k,Eo as m,Uo as p,Bn as r,af as u};
