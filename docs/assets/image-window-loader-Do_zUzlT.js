const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-DQUGT01Y.js","./iframe-BOh-v4G6.js","./preload-helper-C1FmrZbK.js","./marked.esm-DySb2lzn.js","./react-number-format.es-DCWFGTsi.js","./number-overlay-editor-DjcVbkae.css"])))=>i.map(i=>d[i]);
var $i=Object.defineProperty;var _i=(e,t,n)=>t in e?$i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ee=(e,t,n)=>_i(e,typeof t!="symbol"?t+"":t,n);import{r as y,R as rn}from"./iframe-BOh-v4G6.js";import{h as Ui,g as qi,k as Vi,v as ji,l as Ki,m as kn,r as Gi,j as Ji,t as Qi}from"./throttle-C-j8h0WW.js";import{s as gt,a as Zi}from"./marked.esm-DySb2lzn.js";import{_ as er}from"./preload-helper-C1FmrZbK.js";function Vo(e="This should not happen"){throw new Error(e)}function ht(e,t="Assertion failed"){if(!e)return Vo(t)}function Jn(e,t){return Vo(t??"Hell froze over")}function cl(e,t){try{return e()}catch{return t}}const So=Object.prototype.hasOwnProperty;function _t(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&_t(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(So.call(e,n)&&++o&&!So.call(t,n)||!(n in t)||!_t(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Sn=null,Qn=void 0;var ae=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(ae||{}),tr=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp",e))(tr||{}),_n=(e=>(e.Triangle="triangle",e.Dots="dots",e))(_n||{});function dl(e){return"width"in e&&typeof e.width=="number"}async function ul(e){return typeof e=="object"?e:await e()}function nr(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function fl(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function jo(e){return e.kind==="marker"||e.kind==="new-row"||e.kind==="row-status"}function or(e){if(!nr(e)||e.kind==="image")return!1;switch(e.kind){case"text":case"number":case"markdown":case"uri":case"custom":case"boolean":return e.readonly!==!0;default:Jn(e,"A cell was passed with an invalid kind")}}function hl(e){return Ui(e,"editor")}function Zn(e){return!(e.readonly??!1)}var Ct=(e=>(e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id",e))(Ct||{});const Cn={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Wn(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Co;const _e=class _e{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new _e(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Wn([...this.items,n]);return new _e(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const c=[];s<o&&c.push([s,o]),i<a&&c.push([i,a]),n.splice(r,1,...c)}}return new _e(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};ee(_e,"create",t=>new _e(Wn(t))),ee(_e,"empty",()=>Co??(Co=new _e([]))),ee(_e,"fromSingleSelection",t=>_e.empty().add(t)),ee(_e,"fromArray",t=>{if(t.length===0)return _e.empty();const n=t.map(i=>[i,i+1]),o=Wn(n);return new _e(o)});let Un=_e;function at(e,t,n,o,i=!1){const r=y.useRef();r.current=t,y.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var c;(c=r.current)==null||c.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function gl(e,t){return e===void 0?void 0:t}const ir=Math.PI;function Mo(e){return e*ir/180}const Ko=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Go=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},Jo=(e,t,n)=>Math.min(e,t-n*2),Qo=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,eo=e=>{const t=e.fgColor??"currentColor";return y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),y.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},rr=e=>{const t=e.fgColor??"currentColor";return y.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function sr(e,t,n){const[o,i]=y.useState(e),r=y.useRef(!0);y.useEffect(()=>()=>{r.current=!1},[]);const l=y.useRef(qi(s=>{r.current&&i(s)},n));return y.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const lr="֑-߿יִ-﷽ﹰ-ﻼ",ar="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",cr=new RegExp("^[^"+ar+"]*["+lr+"]");function to(e){return cr.test(e)?"rtl":"not-rtl"}let vn;function Io(){if(typeof document>"u")return 0;if(vn!==void 0)return vn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),vn=n-o,vn}const Ht=Symbol();function ml(e){const t=y.useRef([Ht,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=y.useState(e),[,i]=y.useState(),r=y.useCallback(s=>{const a=t.current[0];a!==Ht&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Ht&&i({}),o(c=>typeof s=="function"?s(a===Ht?c:a):s),t.current[0]=Ht)},[]),l=y.useCallback(()=>{t.current[0]=Ht,i({})},[]);return[t.current[0]===Ht?n:t.current[0],r,l]}function Zo(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function bl(e){const t=y.useRef(e);return _t(e,t.current)||(t.current=e),t.current}function dr(e,t){return rn.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function yl(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(wn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function qn(e,t){return(e??"")===(t??"")}function ur(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function fr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function wn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ei(e){return[e.x+e.width-1,e.y+e.height-1]}function Eo(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[c,u]=t.span;return c>=o&&c<=i||u>=o&&c<=i||c<o&&u>i}function hr(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&Eo(e,t,r)&&i++;for(const l of n.current.rangeStack)Eo(e,t,l)&&i++;return i}function ti(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function Ut(e,t){let n=0;const o=ti(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Vt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function Vn(e,t,n,o,i){const r=ti(e,o),l=[];for(const c of r)if(c.sticky)l.push(c);else break;if(l.length>0)for(const c of l)n-=c.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let c=t;c<s;c++){const u=r[c];u.sticky||l.push(u)}return l}function gr(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function mr(e,t,n,o,i,r,l,s,a,c){const u=o+i;if(n&&e<=i)return-2;if(e<=u)return-1;let g=t;for(let d=0;d<c;d++){const h=r-1-d,b=typeof l=="number"?l:l(h);if(g-=b,e>=g)return h}const m=r-c,f=e-(a??0);if(typeof l=="number"){const d=Math.floor((f-u)/l)+s;return d>=m?void 0:d}else{let d=u;for(let h=s;h<m;h++){const b=l(h);if(f<=d+b)return h;d+=b}return}}let xn=0,on={};const br=typeof window>"u";async function yr(){var e;br||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,xn=0,on={},ji())}yr();function ni(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Tt(e,t,n,o="middle"){const i=ni(e,t,o,n);let r=on[i];return r===void 0&&(r=t.measureText(e),on[i]=r,xn++),xn>1e4&&(on={},xn=0),r}function oi(e,t){const n=ni(e,void 0,"middle",t);return on[n]}function Ze(e,t){return typeof t!="string"&&(t=t.baseFontFull),vr(e,t)}function Fo(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Bo=[];function vr(e,t){for(const r of Bo)if(r.key===t)return r.val;const n=Fo(e,"alphabetic"),i=-(Fo(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Bo.push({key:t,val:i}),i}function pr(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let c=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(c=n-t,c<u)){const g=1-c/u;l.globalAlpha=g,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return c<u}function In(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function ii(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function ri(e,t){const n=Tt("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function wr(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function xr(e,t,n,o,i,r,l,s,a,c){const u=s.baseFontFull,g=Vi(e,t,u,i-s.cellHorizontalPadding*2,c??!1),m=ri(e,u),f=s.lineHeight*m,d=m+f*(g.length-1),h=d+s.cellVerticalPadding>r;h&&(e.save(),e.rect(n,o,i,r),e.clip());const b=o+r/2-d/2;let w=Math.max(o+s.cellVerticalPadding,b);for(const v of g)if(ii(e,v,n,w,i,m,l,s,a),w+=f,w>o+r)break;h&&e.restore()}function St(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:c,width:u,height:g}=l;o=o??!1,o||(t=wr(t,u));const m=Ze(r,s),f=to(t)==="rtl";if(n===void 0&&f&&(n="right"),f&&(r.direction="rtl"),t.length>0){let d=!1;n==="right"?(r.textAlign="right",d=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,d=!0),o?xr(r,t,a,c,u,g,m,s,n,i):ii(r,t,a,c,u,g,m,s,n),d&&(r.textAlign="start"),f&&(r.direction="inherit")}}function ct(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function kr(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Sr(e,t,n){const o=function(s,a){const c=a.x-s.x,u=a.y-s.y,g=Math.sqrt(c*c+u*u),m=c/g,f=u/g;return{x:c,y:a.y-s.y,len:g,nx:m,ny:f,ang:Math.atan2(f,m)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const c=t[(s+1)%r],u=o(a,l),g=o(a,c),m=u.nx*g.ny-u.ny*g.nx,f=u.nx*g.nx-u.ny*-g.ny;let d=Math.asin(m<-1?-1:m>1?1:m),h=1,b=!1;f<0?d<0?d=Math.PI+d:(d=Math.PI-d,h=-1,b=!0):d>0&&(h=-1,b=!0),i=a.radius!==void 0?a.radius:n;const w=d/2;let v=Math.abs(Math.cos(w)*i/Math.sin(w)),M;v>Math.min(u.len/2,g.len/2)?(v=Math.min(u.len/2,g.len/2),M=Math.abs(v*Math.sin(w)/Math.cos(w))):M=i;let E=a.x+g.nx*v,A=a.y+g.ny*v;E+=-g.ny*M*h,A+=g.nx*M*h,e.arc(E,A,M,u.ang+Math.PI/2*h,g.ang-Math.PI/2*h,b),l=a,a=c}e.closePath()}function jn(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d){const h={x:0,y:r+c,width:0,height:0};if(e>=f.length||t>=u||t<-2||e<0)return h;const b=r-i;if(e>=g){const w=l>e?-1:1,v=Ut(f);h.x+=v+a;for(let M=l;M!==e;M+=w)h.x+=f[w===1?M:M-1].width*w}else for(let w=0;w<e;w++)h.x+=f[w].width;if(h.width=f[e].width+1,t===-1)h.y=i,h.height=b;else if(t===-2){h.y=0,h.height=i;let w=e;const v=f[e].group,M=f[e].sticky;for(;w>0&&qn(f[w-1].group,v)&&f[w-1].sticky===M;){const A=f[w-1];h.x-=A.width,h.width+=A.width,w--}let E=e;for(;E+1<f.length&&qn(f[E+1].group,v)&&f[E+1].sticky===M;){const A=f[E+1];h.width+=A.width,E++}if(!M){const A=Ut(f),C=h.x-A;C<0&&(h.x-=C,h.width+=C),h.x+h.width>n&&(h.width=n-h.x)}}else if(t>=u-m){let w=u-t;for(h.y=o;w>0;){const v=t+w-1;h.height=typeof d=="number"?d:d(v),h.y-=h.height,w--}h.height+=1}else{const w=s>t?-1:1;if(typeof d=="number"){const v=t-s;h.y+=v*d}else for(let v=s;v!==t;v+=w)h.y+=d(v)*w;h.height=(typeof d=="number"?d:d(t))+1}return h}const no=1<<21;function tt(e,t){return(t+2)*no+e}function si(e){return e%no}function oo(e){return Math.floor(e/no)-2}function io(e){const t=si(e),n=oo(e);return[t,n]}class li{constructor(){ee(this,"visibleWindow",{x:0,y:0,width:0,height:0});ee(this,"freezeCols",0);ee(this,"freezeRows",[]);ee(this,"isInWindow",t=>{const n=si(t),o=oo(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&_t(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Cr extends li{constructor(){super(...arguments);ee(this,"cache",new Map);ee(this,"setValue",(n,o)=>{this.cache.set(tt(n[0],n[1]),o)});ee(this,"getValue",n=>this.cache.get(tt(n[0],n[1])));ee(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Yt{constructor(t=[]){ee(this,"cells");this.cells=new Set(t.map(n=>tt(n[0],n[1])))}add(t){this.cells.add(tt(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(tt(t[0],t[1]))}remove(t){this.cells.delete(tt(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(oo(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(tt(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield io(t)}}function Mr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Ir{constructor(t,n){ee(this,"spriteMap",new Map);ee(this,"headerIcons");ee(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[c,u]=Mr(n,s),g=l*Math.ceil(window.devicePixelRatio),m=`${c}_${u}_${g}_${t}`;let f=this.spriteMap.get(m);if(f===void 0){const d=this.headerIcons[t];if(d===void 0)return;f=document.createElement("canvas");const h=f.getContext("2d");if(h===null)return;const b=new Image;b.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(d({fgColor:u,bgColor:c}))}`,this.spriteMap.set(m,f);const w=b.decode();if(w===void 0)return;this.inFlight++,w.then(()=>{h.drawImage(b,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(f,0,0,g,g,i,r,l,l),a<1&&(o.globalAlpha=1)}}const zn={};let kt=null;function Er(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Kn(e){const t=e.toLowerCase().trim();if(zn[t]!==void 0)return zn[t];kt=kt||Er(),kt.style.color="#000",kt.style.color=t;const n=getComputedStyle(kt).color;kt.style.color="#fff",kt.style.color=t;const o=getComputedStyle(kt).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),zn[t]=i,i}function ln(e,t){const[n,o,i]=Kn(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Po=new Map;function Ao(e,t){const n=`${e}-${t}`,o=Po.get(n);if(o!==void 0)return o;const i=Ge(e,t);return Po.set(n,i),i}function Ge(e,t){if(t===void 0)return e;const[n,o,i,r]=Kn(e);if(r===1)return e;const[l,s,a,c]=Kn(t),u=r+c*(1-r),g=(r*n+c*l*(1-r))/u,m=(r*o+c*s*(1-r))/u,f=(r*i+c*a*(1-r))/u;return`rgba(${g}, ${m}, ${f}, ${u})`}function ai(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function En(e,t,n,o,i,r,l,s,a){s=s??t;let c=t,u=e;const g=o-r;let m=!1;for(;c<n&&u<g;){const f=i(u);if(c+f>s&&a(c,u,f,!1,l&&u===o-1)===!0){m=!0;break}c+=f,u++}if(!m){c=n;for(let f=0;f<r;f++){u=o-1-f;const d=i(u);c-=d,a(c,u,d,!0,l&&u===o-1)}}}function Mt(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const c of e){const u=c.sticky?s:l+n;if(r(c,u,a,c.sticky?0:s,t)===!0)break;l+=c.width,s+=c.sticky?c.width:0}}function ci(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let c=s+1,u=a.width;for(a.sticky&&(l+=u);c<e.length&&qn(e[c].group,a.group)&&e[c].sticky===e[s].sticky;){const h=e[c];u+=h.width,c++,s++,h.sticky&&(l+=h.width)}const g=a.sticky?0:n,m=r+g,f=a.sticky?0:Math.max(0,l-m),d=Math.min(u-f,t-(m+f));i([a.sourceIndex,e[c-1].sourceIndex],a.group??"",m+f,0,d,o),r+=u}}function di(e,t,n,o,i,r,l){var m;const[s,a]=e;let c,u;const g=((m=l.find(f=>!f.sticky))==null?void 0:m.sourceIndex)??0;if(a>g){const f=Math.max(s,g);let d=t,h=o;for(let b=r.sourceIndex-1;b>=f;b--)d-=l[b].width,h+=l[b].width;for(let b=r.sourceIndex+1;b<=a;b++)h+=l[b].width;u={x:d,y:n,width:h,height:i}}if(g>s){const f=Math.min(a,g-1);let d=t,h=o;for(let b=r.sourceIndex-1;b>=s;b--)d-=l[b].width,h+=l[b].width;for(let b=r.sourceIndex+1;b<=f;b++)h+=l[b].width;c={x:d,y:n,width:h,height:i}}return[c,u]}function vl(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ui={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function pl(){return ui}const Fr=rn.createContext(ui);function wl(){return rn.useContext(Fr)}function qt(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=Ge(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function xl(e,t,n,o){if(o==="any")return Br(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),fr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function sn(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function $t(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Br(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Pr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Ar(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,c=e.x+e.width-l,u=r-e.y,g=e.y+e.height-s,m=a>0?e.x+Math.floor(a/o)*o:e.x,f=c>0?e.x+e.width-Math.floor(c/o)*o:e.x+e.width,d=u>0?e.y+Math.floor(u/o)*o:e.y,h=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:m,y:d,width:f-m,height:h-d}}function Dr(e,t,n,o,i){const[r,l,s,a]=t,[c,u,g,m]=i,{x:f,y:d,width:h,height:b}=e,w=[];if(h<=0||b<=0)return w;const v=f+h,M=d+b,E=f<r,A=d<l,C=f+h>s,P=d+b>a,T=f>=r&&f<s||v>r&&v<=s||f<r&&v>s,S=d>=l&&d<a||M>l&&M<=a||d<l&&M>a;if(T&&S){const B=Math.max(f,r),I=Math.max(d,l),x=Math.min(v,s),k=Math.min(M,a);w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:c,y:u,width:g-c+1,height:m-u+1}})}if(E&&A){const B=f,I=d,x=Math.min(v,r),k=Math.min(M,l);w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:0,y:0,width:c+1,height:u+1}})}if(A&&T){const B=Math.max(f,r),I=d,x=Math.min(v,s),k=Math.min(M,l);w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:c,y:0,width:g-c+1,height:u+1}})}if(A&&C){const B=Math.max(f,s),I=d,x=v,k=Math.min(M,l);w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(E&&S){const B=f,I=Math.max(d,l),x=Math.min(v,r),k=Math.min(M,a);w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:0,y:u,width:c+1,height:m-u+1}})}if(C&&S){const B=Math.max(f,s),I=Math.max(d,l),x=v,k=Math.min(M,a);w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:g,y:u,width:n-g+1,height:m-u+1}})}if(E&&P){const B=f,I=Math.max(d,a),x=Math.min(v,r),k=M;w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:0,y:m,width:c+1,height:o-m+1}})}if(P&&T){const B=Math.max(f,r),I=Math.max(d,a),x=Math.min(v,s),k=M;w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:c,y:m,width:g-c+1,height:o-m+1}})}if(C&&P){const B=Math.max(f,s),I=Math.max(d,a),x=v,k=M;w.push({rect:{x:B,y:I,width:x-B,height:k-I},clip:{x:g,y:m,width:n-g+1,height:o-m+1}})}return w}const Hr={kind:ae.Loading,allowOverlay:!1};function Do(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h,b,w,v,M,E,A,C,P,T,S,D,B,I,x,k,_,O,oe,j){let te=(M==null?void 0:M.size)??Number.MAX_SAFE_INTEGER;const ce=performance.now();let me=x.baseFontFull;e.font=me;const Ne={ctx:e},J=[0,0],Be=b>0?Vt(a,b,c):0;let Me,Y;const de=new Yt,Oe=new Set,Je=ai(v);if(Mt(t,s,r,l,i,(q,xe,Qe,ze,Xe)=>{const be=Math.max(0,ze-xe),mt=xe+be,nt=i+1,Ue=q.width-be,re=o-i-1;if(v.length>0){let Pe=!1;for(let R=0;R<v.length;R++){const N=v[R];if(sn(mt,nt,Ue,re,N.x,N.y,N.width,N.height)){Pe=!0;break}}if(!Pe)return}const qe=()=>{e.save(),e.beginPath(),e.rect(mt,nt,Ue,re),e.clip()},Re=E.columns.hasIndex(q.sourceIndex),Ve=g(q.group??"").overrideTheme,fe=q.themeOverride===void 0&&Ve===void 0?x:qt(x,Ve,q.themeOverride),Te=fe.baseFontFull;Te!==me&&(me=Te,e.font=Te),qe();let ke;return En(Xe,Qe,o,a,c,b,w,Je,(Pe,R,N,se,ne)=>{var Ft,vt,ut;if(R<0)return;if(J[0]=q.sourceIndex,J[1]=R,de.has(J)){te--;return}if(M!==void 0&&!M.has(J))return;if(v.length>0){let U=!1;for(let ye=0;ye<v.length;ye++){const ue=v[ye];if(sn(xe,Pe,q.width,N,ue.x,ue.y,ue.width,ue.height)){U=!0;break}}if(!U)return}const Ae=E.rows.hasIndex(R),We=f.hasIndex(R),K=R<a?u(J):Hr;let V=xe,Se=q.width,Le=Pe,Ee=N,je=!1,et=!1;if(K.rowspan!==void 0){const[U,ye]=K.rowspan,ue=`${q.sourceIndex}|${U}`;if(Oe.has(ue)){te--;return}else{let ie=Pe;for(let Q=U;Q<R;Q++)ie-=c(Q);let Ke=0;for(let Q=U;Q<ye;Q++)Ke+=c(Q);if(ie<nt+re&&ie+Ke>nt){Le=ie,Ee=Ke,Oe.add(ue);for(let Q=U;Q<ye;Q++)Q!==R&&de.add([q.sourceIndex,Q]);je=!0}else{Oe.add(ue);for(let Q=U;Q<ye;Q++)de.add([q.sourceIndex,Q]);te--;return}}}if(K.span!==void 0){const[U,ye]=K.span,ue=`${R},${U},${ye},${q.sticky}`;if(Y===void 0&&(Y=new Set),Y.has(ue)){te--;return}else{const ie=di(K.span,xe,Pe,q.width,N,q,n),Ke=q.sticky?ie[0]:ie[1];!q.sticky&&ie[0]!==void 0&&(et=!0),Ke!==void 0&&(V=Ke.x,Se=Ke.width,Y.add(ue),je=!0)}}if(je){e.restore(),ke=void 0,e.save(),e.beginPath();const U=Math.max(0,ze-V);e.rect(V+U,Le,Se-U,Ee),Me===void 0&&(Me=[]),Me.push({x:V+U,y:Le,width:Se-U,height:Ee}),e.clip()}const dt=m==null?void 0:m(R),It=ne&&((Ft=q.trailingRowOptions)==null?void 0:Ft.themeOverride)!==void 0?(vt=q.trailingRowOptions)==null?void 0:vt.themeOverride:void 0,Ye=K.themeOverride===void 0&&dt===void 0&&It===void 0?fe:qt(fe,dt,It,K.themeOverride);e.beginPath();const ot=ur(J,K,E);let $e=hr(J,K,E,h);const bt=K.span!==void 0&&E.columns.some(U=>K.span!==void 0&&U>=K.span[0]&&U<=K.span[1]);ot&&!d&&h?$e=0:ot&&h&&($e=Math.max($e,1)),bt&&$e++,ot||(Ae&&$e++,Re&&!ne&&$e++);const Ce=K.kind===ae.Protected?Ye.bgCellMedium:Ye.bgCell;let he;if((se||Ce!==x.bgCell)&&(he=Ge(Ce,he)),$e>0||We){We&&(he=Ge(Ye.bgHeader,he));for(let U=0;U<$e;U++)he=Ge(Ye.accentLight,he)}else if(A!==void 0){for(const U of A)if(U[0]===q.sourceIndex&&U[1]===R){he=Ge(Ye.bgSearchResult,he);break}}if(C!==void 0)for(let U=0;U<C.length;U++){const ye=C[U],ue=ye.range;ye.style!=="solid-outline"&&ue.x<=q.sourceIndex&&q.sourceIndex<ue.x+ue.width&&ue.y<=R&&R<ue.y+ue.height&&(he=Ge(ye.color,he))}let Et=!1;if(M!==void 0){const U=Pe+1,ue=(se?U+N-1:Math.min(U+N-1,o-Be))-U;(ue!==N-1||V+1<=ze)&&(Et=!0,e.save(),e.beginPath(),e.rect(V+1,U,Se-1,ue),e.clip()),he=he===void 0?Ye.bgCell:Ge(he,Ye.bgCell)}const it=q.sourceIndex===n.length-1,rt=R===a-1;he!==void 0&&(e.fillStyle=he,ke!==void 0&&(ke.fillStyle=he),M!==void 0?e.fillRect(V+1,Le+1,Se-(it?2:1),Ee-(rt?2:1)):e.fillRect(V,Le,Se,Ee)),K.style==="faded"&&(e.globalAlpha=.6);let yt;for(let U=0;U<S.length;U++){const ye=S[U];if(ye.item[0]===q.sourceIndex&&ye.item[1]===R){yt=ye;break}}if(Se>j&&!et){const U=Ye.baseFontFull;U!==me&&(e.font=U,me=U);let ye=0;if(K.rowspan!==void 0){const ue=K.rowSpanPosition??"top";if(ue==="top")ye=N/2-Ee/2;else if(ue==="bottom"){const[ie,Ke]=K.rowspan,Q=c(Ke-1);ye=Ee/2-Q/2}}ke=fi(e,K,q.sourceIndex,R,it,rt,V,Le,Se,Ee,$e>0,Ye,he??Ye.bgCell,P,T,(yt==null?void 0:yt.hoverAmount)??0,D,I,ce,B,ke,k,_,O,oe,ye)}return Et&&e.restore(),K.style==="faded"&&(e.globalAlpha=1),te--,je&&(e.restore(),(ut=ke==null?void 0:ke.deprep)==null||ut.call(ke,Ne),ke=void 0,qe(),me=Te,e.font=Te),te<=0}),e.restore(),te<=0}),Me!==void 0)return Me}const Qt=[0,0],Zt={x:0,y:0,width:0,height:0},Ln=[void 0,()=>{}];let Gn=!1;function Rr(){Gn=!0}function fi(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h,b,w,v,M,E,A,C,P,T,S){var O,oe;let D,B;b!==void 0&&b[0][0]===n&&b[0][1]===o&&(D=b[1][0],B=b[1][1]);let I;Qt[0]=n,Qt[1]=o,Zt.x=l,Zt.y=s,Zt.width=a,Zt.height=c,Ln[0]=C.getValue(Qt),Ln[1]=j=>C.setValue(Qt,j),Gn=!1;const x={ctx:e,theme:g,col:n,row:o,cell:t,rect:Zt,highlighted:u,cellFillColor:m,hoverAmount:h,frameTime:v,hoverX:D,drawState:Ln,hoverY:B,imageLoader:f,spriteManager:d,hyperWrapping:w,overrideCursor:D!==void 0?T:void 0,requestAnimationFrame:Rr},k=pr(x,t.lastUpdated,v,E,i,r),_=P(t);if(_!==void 0){(E==null?void 0:E.renderer)!==_&&((O=E==null?void 0:E.deprep)==null||O.call(E,x),E=void 0);const j=(oe=_.drawPrep)==null?void 0:oe.call(_,x,E);e.save(),e.translate(0,S),M!==void 0&&!jo(x.cell)?M(x,()=>_.draw(x,t)):_.draw(x,t),e.restore(),I=j===void 0?void 0:{deprep:j==null?void 0:j.deprep,fillStyle:j==null?void 0:j.fillStyle,font:j==null?void 0:j.font,renderer:_}}return(k||Gn)&&(A==null||A(Qt)),I}function Mn(e,t,n,o,i,r,l,s,a=-20,c=-20,u=void 0,g="center",m="square",f=!1){const d=Math.floor(i+l/2),h=m==="circle"?1e4:t.roundingRadius??4;let b=Jo(u??t.checkboxMaxSize,l,t.cellVerticalPadding),w=b/2;const v=Go(g,o,r,t.cellHorizontalPadding,b),M=Ko(v,d,b),E=Qo(o+a,i+c,M);switch(n){case!0:{e.beginPath(),ct(e,v-b/2,d-b/2,b,b,h),m==="circle"&&(w*=.8,b*=.8),e.fillStyle=f?t.bgCellMedium:s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(v-w+b/4.23,d-w+b/1.97),e.lineTo(v-w+b/2.42,d-w+b/1.44),e.lineTo(v-w+b/1.29,d-w+b/3.25),e.strokeStyle=f?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Sn:case!1:{e.beginPath(),ct(e,v-b/2+.5,d-b/2+.5,b-1,b-1,h),e.lineWidth=1,e.strokeStyle=f?t.textLight:E?t.textDark:t.textMedium,e.stroke();break}case Qn:{e.beginPath(),ct(e,v-b/2,d-b/2,b,b,h),e.fillStyle=f?t.bgCellMedium:E?t.textMedium:t.textLight,e.fill(),m==="circle"&&(w*=.8,b*=.8),e.beginPath(),e.moveTo(v-b/3,d),e.lineTo(v+b/3,d),e.strokeStyle=f?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Jn()}}function Tr(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h,b,w,v){var S,D,B,I;const M=l+s;if(M<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,i,M);const E=(S=o==null?void 0:o[0])==null?void 0:S[0],A=(D=o==null?void 0:o[0])==null?void 0:D[1],C=(B=o==null?void 0:o[1])==null?void 0:B[0],P=(I=o==null?void 0:o[1])==null?void 0:I[1],T=g.headerFontFull;e.font=T,Mt(t,0,r,0,M,(x,k,_,O)=>{var Oe;if(b!==void 0&&!b.has([x.sourceIndex,-1]))return;const oe=Math.max(0,O-k);e.save(),e.beginPath(),e.rect(k+oe,s,x.width-oe,l),e.clip();const j=h(x.group??"").overrideTheme,te=x.themeOverride===void 0&&j===void 0?g:qt(g,j,x.themeOverride);te.bgHeader!==g.bgHeader&&(e.fillStyle=te.bgHeader,e.fill()),te!==g&&(e.font=te.headerFontFull);const ce=u.columns.hasIndex(x.sourceIndex),me=a!==void 0||c||x.headerRowMarkerDisabled===!0,Ne=!me&&A===-1&&E===x.sourceIndex,J=me?0:((Oe=f.find(Je=>Je.item[0]===x.sourceIndex&&Je.item[1]===-1))==null?void 0:Oe.hoverAmount)??0,Be=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===x.sourceIndex,Me=ce?te.accentColor:Be?te.bgHeaderHasFocus:te.bgHeader,Y=n?s:0,de=x.sourceIndex===0?0:1;ce?(e.fillStyle=Me,e.fillRect(k+de,Y,x.width-de,l)):(Be||J>0)&&(e.beginPath(),e.rect(k+de,Y,x.width-de,l),Be&&(e.fillStyle=te.bgHeaderHasFocus,e.fill()),J>0&&(e.globalAlpha=J,e.fillStyle=te.bgHeaderHovered,e.fill(),e.globalAlpha=1)),mi(e,k,Y,x.width,l,x,ce,te,Ne,Ne?C:void 0,Ne?P:void 0,Be,J,m,w,v),e.restore()}),n&&Wr(e,t,i,r,s,o,g,m,f,d,h,b)}function Wr(e,t,n,o,i,r,l,s,a,c,u,g){const[f,d]=(r==null?void 0:r[0])??[];let h=0;ci(t,n,o,i,(b,w,v,M,E,A)=>{if(g!==void 0&&!g.hasItemInRectangle({x:b[0],y:-2,width:b[1]-b[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(v,M,E,A),e.clip();const C=u(w),P=(C==null?void 0:C.overrideTheme)===void 0?l:qt(l,C.overrideTheme),T=d===-2&&f!==void 0&&f>=b[0]&&f<=b[1],S=T?P.bgGroupHeaderHovered??P.bgHeaderHovered:P.bgGroupHeader??P.bgHeader;if(S!==l.bgHeader&&(e.fillStyle=S,e.fill()),e.fillStyle=P.textGroupHeader??P.textHeader,C!==void 0){let D=v;if(C.icon!==void 0&&(s.drawSprite(C.icon,"normal",e,D+8,(i-20)/2,20,P),D+=26),e.fillText(C.name,D+8,i/2+Ze(e,l.headerFontFull)),C.actions!==void 0&&T){const B=hi({x:v,y:M,width:E,height:A},C.actions);e.beginPath();const I=B[0].x-10,x=v+E-I;e.rect(I,0,x,i);const k=e.createLinearGradient(I,0,I+x,0),_=ln(S,0);k.addColorStop(0,_),k.addColorStop(10/x,S),k.addColorStop(1,S),e.fillStyle=k,e.fill(),e.globalAlpha=.6;const[O,oe]=(r==null?void 0:r[1])??[-1,-1];for(let j=0;j<C.actions.length;j++){const te=C.actions[j],ce=B[j],me=$t(ce,O+v,oe);me&&(e.globalAlpha=1),s.drawSprite(te.icon,"normal",e,ce.x+ce.width/2-10,ce.y+ce.height/2-10,20,P),me&&(e.globalAlpha=.6)}e.globalAlpha=1}}v!==0&&c(b[0])&&(e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),h=v+E}),e.beginPath(),e.moveTo(h+.5,0),e.lineTo(h+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}const pn=30;function zr(e,t,n,o,i){return{x:e+n-pn,y:Math.max(t,t+o/2-pn/2),width:pn,height:Math.min(pn,o)}}function hi(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function en(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function gi(e,t,n,o,i,r,l,s){var P;const a=l.cellHorizontalPadding,c=l.headerIconSize,u=zr(n,o,i,r);let g=n+a;const m=t.icon===void 0?void 0:{x:g,y:o+(r-c)/2,width:c,height:c},f=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(g+=Math.ceil(c*1.3));const d=e===void 0?((P=oi(t.title,l.headerFontFull))==null?void 0:P.width)??0:Tt(t.title,e,l.headerFontFull).width,h=t.hasMenu===!0?35:0,b=t.indicatorIcon!==void 0?c+a:0,w=d+b,v=i-(m!==void 0?Math.ceil(c*1.3)+a:a)-h-a,M=n+(m!==void 0?Math.ceil(c*1.3)+a:a)+(v-w)/2,E={x:Math.max(g,M),y:o,width:d,height:r};let A;t.indicatorIcon!==void 0&&(A={x:E.x+d+a,y:o+(r-c)/2,width:c,height:c});const C=n+i/2;return{menuBounds:en(u,C,s),iconBounds:en(m,C,s),iconOverlayBounds:en(f,C,s),textBounds:en(E,C,s),indicatorIconBounds:en(A,C,s)}}function Ho(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const v=r.rowMarkerChecked;v!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const M=r.headerRowMarkerTheme!==void 0?qt(s,r.headerRowMarkerTheme):s;Mn(e,M,v,t,n,o,i,!1,void 0,void 0,s.checkboxMaxSize,"center",r.rowMarker),v!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const b=l?s.textHeaderSelected:s.textHeader,w=r.hasMenu===!0&&(a||f&&l)&&h.menuBounds!==void 0;if(r.icon!==void 0&&h.iconBounds!==void 0){let v=l?"selected":"normal";r.style==="highlight"&&(v=l?"selected":"special"),m.drawSprite(r.icon,v,e,h.iconBounds.x,h.iconBounds.y,h.iconBounds.width,s),r.overlayIcon!==void 0&&h.iconOverlayBounds!==void 0&&m.drawSprite(r.overlayIcon,l?"selected":"special",e,h.iconOverlayBounds.x,h.iconOverlayBounds.y,h.iconOverlayBounds.width,s)}if(w&&o>35){const M=d?35:o-35,E=d?35*.7:o-35*.7,A=M/o,C=E/o,P=e.createLinearGradient(t,0,t+o,0),T=ln(b,0);P.addColorStop(d?1:0,b),P.addColorStop(A,b),P.addColorStop(C,T),P.addColorStop(d?0:1,T),e.fillStyle=P}else e.fillStyle=b;if(d&&(e.textAlign="right"),h.textBounds!==void 0&&e.fillText(r.title,d?h.textBounds.x+h.textBounds.width:h.textBounds.x,n+i/2+Ze(e,s.headerFontFull)),d&&(e.textAlign="left"),r.indicatorIcon!==void 0&&h.indicatorIconBounds!==void 0&&(!w||!sn(h.menuBounds.x,h.menuBounds.y,h.menuBounds.width,h.menuBounds.height,h.indicatorIconBounds.x,h.indicatorIconBounds.y,h.indicatorIconBounds.width,h.indicatorIconBounds.height))){let v=l?"selected":"normal";r.style==="highlight"&&(v=l?"selected":"special"),m.drawSprite(r.indicatorIcon,v,e,h.indicatorIconBounds.x,h.indicatorIconBounds.y,h.indicatorIconBounds.width,s)}if(w&&h.menuBounds!==void 0){const v=h.menuBounds,M=c!==void 0&&u!==void 0&&$t(v,c+t,u+n);if(M||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===_n.Triangle){e.beginPath();const E=v.x+v.width/2-5.5,A=v.y+v.height/2-3;Sr(e,[{x:E,y:A},{x:E+11,y:A},{x:E+5.5,y:A+6}],1),e.fillStyle=b,e.fill()}else if(r.menuIcon===_n.Dots){e.beginPath();const E=v.x+v.width/2,A=v.y+v.height/2;kr(e,E,A),e.fillStyle=b,e.fill()}else{const E=v.x+(v.width-s.headerIconSize)/2,A=v.y+(v.height-s.headerIconSize)/2;m.drawSprite(r.menuIcon,"normal",e,E,A,s.headerIconSize,s)}M||(e.globalAlpha=1)}}function mi(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h){const b=to(r.title)==="rtl",w=gi(e,r,t,n,o,i,s,b);d!==void 0?d({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:m,isHovered:a,hasSelectedCell:g,spriteManager:f,menuBounds:(w==null?void 0:w.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:c,hoverY:u},()=>Ho(e,t,n,o,i,r,l,s,a,c,u,m,f,h,b,w)):Ho(e,t,n,o,i,r,l,s,a,c,u,m,f,h,b,w)}function Lr(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h,b,w,v){if(w!==void 0||t[t.length-1]!==n[t.length-1])return;const M=ai(b);Mt(t,a,l,s,r,(E,A,C,P,T)=>{if(E!==t[t.length-1])return;A+=E.width;const S=Math.max(A,P);S>o||(e.save(),e.beginPath(),e.rect(S,r+1,1e4,i-r-1),e.clip(),En(T,C,i,c,u,d,h,M,(D,B,I,x)=>{if(!x&&b.length>0&&!b.some(j=>sn(A,D,1e4,I,j.x,j.y,j.width,j.height)))return;const k=m.hasIndex(B),_=f.hasIndex(B);e.beginPath();const O=g==null?void 0:g(B),oe=O===void 0?v:qt(v,O);oe.bgCell!==v.bgCell&&(e.fillStyle=oe.bgCell,e.fillRect(A,D,1e4,I)),_&&(e.fillStyle=oe.bgHeader,e.fillRect(A,D,1e4,I)),k&&(e.fillStyle=oe.accentLight,e.fillRect(A,D,1e4,I))}),e.restore())})}function Nr(e,t,n,o,i,r,l,s,a){let c=!1;for(const d of t)if(!d.sticky){c=l(d.sourceIndex);break}const u=a.horizontalBorderColor??a.borderColor,g=a.borderColor,m=c?Ut(t):0;let f;if(m!==0&&(f=Ao(g,a.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=f,e.stroke()),i>0){const d=g===u&&f!==void 0?f:Ao(u,a.bgCell),h=Vt(r,i,s);e.beginPath(),e.moveTo(0,o-h+.5),e.lineTo(n,o-h+.5),e.strokeStyle=d,e.stroke()}}const bi=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function Or(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d){var I;const h=d.bgCell,{minX:b,maxX:w,minY:v,maxY:M}=bi(s,r,l),E=[],A=l-Vt(f,m,c);let C=a,P=n,T=0;for(;C+i<A;){const x=C+i,k=c(P);if(x>=v&&x<=M-1){const _=u==null?void 0:u(P),O=_==null?void 0:_.bgCell;O!==void 0&&O!==h&&P>=f-m&&E.push({x:b,y:x,w:w-b,h:k,color:O})}C+=k,P<f-m&&(T=C),P++}let S=0;const D=Math.min(A,M)-T;if(D>0)for(let x=0;x<t.length;x++){const k=t[x];if(k.width===0)continue;const _=k.sticky?S:S+o,O=(I=k.themeOverride)==null?void 0:I.bgCell;O!==void 0&&O!==h&&_>=b&&_<=w&&g(x+1)&&E.push({x:_,y:T,w:k.width,h:D,color:O}),S+=k.width}if(E.length===0)return;let B;e.beginPath();for(let x=E.length-1;x>=0;x--){const k=E[x];B===void 0?B=k.color:k.color!==B&&(e.fillStyle=B,e.fill(),e.beginPath(),B=k.color),e.rect(k.x,k.y,k.w,k.h)}B!==void 0&&(e.fillStyle=B,e.fill()),e.beginPath()}function Ro(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h,b,w=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const I of a)e.rect(I.x+1,I.y+1,I.width-1,I.height-1);e.clip("evenodd")}const v=b.horizontalBorderColor??b.borderColor,M=b.borderColor,{minX:E,maxX:A,minY:C,maxY:P}=bi(s,r,l),T=[];e.beginPath();let S=.5;for(let I=0;I<t.length;I++){const x=t[I];if(x.width===0)continue;S+=x.width;const k=x.sticky?S:S+o;k>=E&&k<=A&&f(I+1)&&T.push({x1:k,y1:Math.max(c,C),x2:k,y2:Math.min(l,P),color:M})}let D=l+.5;for(let I=h-d;I<h;I++){const x=g(I);D-=x,T.push({x1:E,y1:D,x2:A,y2:D,color:v})}if(w!==!0){let I=u+.5,x=n;const k=D;for(;I+i<k;){const _=I+i;if(_>=C&&_<=P-1){const O=m==null?void 0:m(x);T.push({x1:E,y1:_,x2:A,y2:_,color:(O==null?void 0:O.horizontalBorderColor)??(O==null?void 0:O.borderColor)??v})}I+=g(x),x++}}const B=Ki(T,I=>I.color);for(const I of Object.keys(B)){e.strokeStyle=I;for(const x of B[I])e.moveTo(x.x1,x.y1),e.lineTo(x.x2,x.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function Xr(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h,b,w,v){const M=[];e.imageSmoothingEnabled=!1;const E=Math.min(i.cellYOffset,l),A=Math.max(i.cellYOffset,l);let C=0;if(typeof w=="number")C+=(A-E)*w;else for(let k=E;k<A;k++)C+=w(k);l>i.cellYOffset&&(C=-C),C+=a-i.translateY;const P=Math.min(i.cellXOffset,r),T=Math.max(i.cellXOffset,r);let S=0;for(let k=P;k<T;k++)S+=h[k].width;r>i.cellXOffset&&(S=-S),S+=s-i.translateX;const D=Ut(b);if(S!==0&&C!==0)return{regions:[]};const B=c>0?Vt(m,c,w):0,I=u-D-Math.abs(S),x=g-f-B-Math.abs(C)-1;if(I>150&&x>150){const k={sx:0,sy:0,sw:u*d,sh:g*d,dx:0,dy:0,dw:u*d,dh:g*d};if(C>0?(k.sy=(f+1)*d,k.sh=x*d,k.dy=(C+f+1)*d,k.dh=x*d,M.push({x:0,y:f,width:u,height:C+1})):C<0&&(k.sy=(-C+f+1)*d,k.sh=x*d,k.dy=(f+1)*d,k.dh=x*d,M.push({x:0,y:g+C-B,width:u,height:-C+B})),S>0?(k.sx=D*d,k.sw=I*d,k.dx=(S+D)*d,k.dw=I*d,M.push({x:D-1,y:0,width:S+2,height:g})):S<0&&(k.sx=(D-S)*d,k.sw=I*d,k.dx=D*d,k.dw=I*d,M.push({x:u+S,y:0,width:-S,height:g})),e.setTransform(1,0,0,1,0,0),v){if(D>0&&S!==0&&C===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const _=D*d,O=g*d;e.drawImage(t,0,0,_,O,0,0,_,O)}if(B>0&&S===0&&C!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const _=(g-B)*d,O=u*d,oe=B*d;e.drawImage(t,0,_,O,oe,0,_,O,oe)}}e.drawImage(t,k.sx,k.sy,k.sw,k.sh,k.dx,k.dy,k.dw,k.dh),e.scale(d,d)}return e.imageSmoothingEnabled=!0,{regions:M}}function Yr(e,t,n,o,i,r,l,s,a,c){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||Mt(a,n,o,i,s,(g,m,f,d)=>{if(g.sourceIndex===c){const h=Math.max(m,d)+1;return u.push({x:h,y:0,width:r-h,height:l}),!0}}),u}function $r(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(_t(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...c}=r;if(!_t(s,c))return!1;n=o}return n===void 0?!0:n}return!0}function To(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h){const b=d==null?void 0:d.filter(P=>P.style!=="no-outline");if(b===void 0||b.length===0)return;const w=Ut(s),v=Vt(f,m,g),M=[a,0,s.length,f-m],E=[w,0,t,n-v],A=b.map(P=>{const T=P.range,S=P.style??"dashed";return Dr(T,M,t,n,E).map(D=>{const B=D.rect,I=jn(B.x,B.y,t,n,u,c+u,o,i,r,l,f,a,m,s,g),x=B.width===1&&B.height===1?I:jn(B.x+B.width-1,B.y+B.height-1,t,n,u,c+u,o,i,r,l,f,a,m,s,g);return B.x+B.width>=s.length&&(x.width-=1),B.y+B.height>=f&&(x.height-=1),{color:P.color,style:S,clip:D.clip,rect:Ar({x:I.x,y:I.y,width:x.x+x.width-I.x,height:x.y+x.height-I.y},t,n,8)}})}),C=()=>{e.lineWidth=1;let P=!1;for(const T of A)for(const S of T)if((S==null?void 0:S.rect)!==void 0&&sn(0,0,t,n,S.rect.x,S.rect.y,S.rect.width,S.rect.height)){const D=P,B=!Pr(S.clip,S.rect);e.beginPath(),B&&(e.save(),e.rect(S.clip.x,S.clip.y,S.clip.width,S.clip.height),e.clip()),S.style==="dashed"&&!P?(e.setLineDash([5,3]),P=!0):(S.style==="solid"||S.style==="solid-outline")&&P&&(e.setLineDash([]),P=!1),e.strokeStyle=S.style==="solid-outline"?Ge(Ge(S.color,h.borderColor),h.bgCell):ln(S.color,1),e.closePath(),e.strokeRect(S.rect.x+.5,S.rect.y+.5,S.rect.width-1,S.rect.height-1),B&&(e.restore(),P=D)}P&&e.setLineDash([])};return C(),C}function Wo(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function Nn(e,t,n,o,i,r,l,s,a,c,u,g,m,f,d,h,b){if(u.current===void 0)return;const w=h!==!1&&h!==void 0;if(!w)return;const v=typeof h=="object"?{...Cn,...h}:Cn,M=u.current.range,E=u.current.cell,A=[M.x+M.width-1,M.y+M.height-1];if(E[1]>=b&&A[1]>=b||!l.some(O=>O.sourceIndex===E[0]||O.sourceIndex===A[0]))return;const[P,T]=u.current.cell,S=m(u.current.cell),D=S.span??[P,P],B=T>=b-f,I=f>0&&!B?Vt(b,f,g)-1:0,x=A[1];let k;if(Mt(l,o,i,r,c,(O,oe,j,te,ce)=>{if(O.sticky&&P>O.sourceIndex)return;const me=O.sourceIndex<D[0],Ne=O.sourceIndex>D[1],J=O.sourceIndex===A[0];if(!(!J&&(me||Ne)))return En(ce,j,n,b,g,f,d,void 0,(Be,Me,Y)=>{if(Me!==T&&Me!==x)return;let de=oe,Oe=O.width;if(S.span!==void 0){const q=di(S.span,oe,Be,O.width,Y,O,s),xe=O.sticky?q[0]:q[1];xe!==void 0&&(de=xe.x,Oe=xe.width)}return Me===x&&J&&w&&(k=()=>{var Xe;te>de&&!O.sticky&&(e.beginPath(),e.rect(te,0,t-te,n),e.clip());const q=v.size,xe=q/2,Qe=de+Oe+v.offsetX-xe+.5,ze=Be+Y+v.offsetY-xe+.5;e.beginPath(),v.shape==="circle"?e.arc(Qe+xe,ze+xe,xe,0,Math.PI*2):e.rect(Qe,ze,q,q),e.fillStyle=((Xe=O.themeOverride)==null?void 0:Xe.accentColor)??a.accentColor,e.fill(),v.outline>0&&(e.lineWidth=v.outline,e.strokeStyle=a.bgCell,v.shape==="circle"?(e.beginPath(),e.arc(Qe+xe,ze+xe,xe+v.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(Qe-v.outline/2,ze-v.outline/2,q+v.outline,q+v.outline))}),k!==void 0}),k!==void 0}),k===void 0)return;const _=()=>{e.save(),e.beginPath(),e.rect(0,c,t,n-c-I),e.clip(),k==null||k(),e.restore()};return _(),_}function _r(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),ci(t,n,r,o,(c,u,g,m,f,d)=>{a.hasItemInRectangle({x:c[0],y:-2,width:c[1]-c[0]+1,height:1})&&e.rect(g,m,f,d)}),Mt(t,s,r,l,i,(c,u,g,m)=>{const f=Math.max(0,m-u),d=u+f+1,h=c.width-f-1;a.has([c.sourceIndex,-1])&&e.rect(d,o,h,i-o)}),e.clip())}function Ur(e,t,n,o,i,r,l,s,a,c){let u=0;return Mt(e,r,o,i,n,(g,m,f,d,h)=>(En(h,f,t,l,s,a,c,void 0,(b,w,v,M)=>{M||(u=Math.max(w,u))}),!0)),u}function zo(e,t){var bt;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mappedColumns:u,enableGroups:g,freezeColumns:m,dragAndDropState:f,theme:d,drawFocus:h,headerHeight:b,groupHeaderHeight:w,disabledRows:v,rowHeight:M,verticalBorder:E,overrideCursor:A,isResizing:C,selection:P,fillHandle:T,freezeTrailingRows:S,rows:D,getCellContent:B,getGroupDetails:I,getRowThemeOverride:x,isFocused:k,drawHeaderCallback:_,prelightCells:O,drawCellCallback:oe,highlightRegions:j,resizeCol:te,imageLoader:ce,lastBlitData:me,hoverValues:Ne,hyperWrapping:J,hoverInfo:Be,spriteManager:Me,maxScaleFactor:Y,hasAppendRow:de,touchMode:Oe,enqueue:Je,renderStateProvider:q,getCellRenderer:xe,renderStrategy:Qe,bufferACtx:ze,bufferBCtx:Xe,damage:be,minimumCellWidth:mt,resizeIndicator:nt}=e;if(i===0||r===0)return;const Ue=Qe==="double-buffer",re=Math.min(Y,Math.ceil(window.devicePixelRatio??1)),qe=Qe!=="direct"&&$r(e,t),Re=n.canvas;(Re.width!==i*re||Re.height!==r*re)&&(Re.width=i*re,Re.height=r*re,Re.style.width=i+"px",Re.style.height=r+"px");const Ve=o.canvas,fe=g?w+b:b,Te=fe+1;(Ve.width!==i*re||Ve.height!==Te*re)&&(Ve.width=i*re,Ve.height=Te*re,Ve.style.width=i+"px",Ve.style.height=Te+"px");const ke=ze.canvas,Pe=Xe.canvas;Ue&&(ke.width!==i*re||ke.height!==r*re)&&(ke.width=i*re,ke.height=r*re,me.current!==void 0&&(me.current.aBufferScroll=void 0)),Ue&&(Pe.width!==i*re||Pe.height!==r*re)&&(Pe.width=i*re,Pe.height=r*re,me.current!==void 0&&(me.current.bBufferScroll=void 0));const R=me.current;if(qe===!0&&l===(R==null?void 0:R.cellXOffset)&&s===(R==null?void 0:R.cellYOffset)&&a===(R==null?void 0:R.translateX)&&c===(R==null?void 0:R.translateY))return;let N=null;Ue&&(N=n);const se=o;let ne;Ue?be!==void 0?ne=(R==null?void 0:R.lastBuffer)==="b"?Xe:ze:ne=(R==null?void 0:R.lastBuffer)==="b"?ze:Xe:ne=n;const Ae=ne.canvas,We=Ue?Ae===ke?Pe:ke:Re,K=typeof M=="number"?()=>M:M;se.save(),ne.save(),se.beginPath(),ne.beginPath(),se.textBaseline="middle",ne.textBaseline="middle",re!==1&&(se.scale(re,re),ne.scale(re,re));const V=Vn(u,l,i,f,a);let Se=[];const Le=h&&((bt=P.current)==null?void 0:bt.cell[1])===s&&c===0;let Ee=!1;if(j!==void 0){for(const Ce of j)if(Ce.style!=="no-outline"&&Ce.range.y===s&&c===0){Ee=!0;break}}const je=()=>{Tr(se,V,g,Be,i,a,b,w,f,C,P,d,Me,Ne,E,I,be,_,Oe),Ro(se,V,s,a,c,i,r,void 0,void 0,w,fe,K,x,E,S,D,d,!0),se.beginPath(),se.moveTo(0,Te-.5),se.lineTo(i,Te-.5),se.strokeStyle=Ge(d.headerBottomBorderColor??d.horizontalBorderColor??d.borderColor,d.bgHeader),se.stroke(),Ee&&To(se,i,r,l,s,a,c,u,m,b,w,M,S,D,j,d),Le&&Nn(se,i,r,s,a,c,V,u,d,fe,P,K,B,S,de,T,D)};if(be!==void 0){const Ce=V[V.length-1].sourceIndex+1,he=be.hasItemInRegion([{x:l,y:-2,width:Ce,height:2},{x:l,y:s,width:Ce,height:300},{x:0,y:s,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:l,y:D-S,width:Ce,height:S,when:S>0}]),Et=it=>{Do(it,V,u,r,fe,a,c,s,D,K,B,I,x,v,k,h,S,de,Se,be,P,O,j,ce,Me,Ne,Be,oe,J,d,Je,q,xe,A,mt);const rt=P.current;T!==!1&&T!==void 0&&h&&rt!==void 0&&be.has(ei(rt.range))&&Nn(it,i,r,s,a,c,V,u,d,fe,P,K,B,S,de,T,D)};he&&(Et(ne),N!==null&&(N.save(),N.scale(re,re),N.textBaseline="middle",Et(N),N.restore()),be.hasHeader()&&(_r(se,V,i,w,fe,a,c,s,be),je())),ne.restore(),se.restore();return}if((qe!==!0||l!==(R==null?void 0:R.cellXOffset)||a!==(R==null?void 0:R.translateX)||Le!==(R==null?void 0:R.mustDrawFocusOnHeader)||Ee!==(R==null?void 0:R.mustDrawHighlightRingsOnHeader))&&je(),qe===!0){ht(We!==void 0&&R!==void 0);const{regions:Ce}=Xr(ne,We,We===ke?R.aBufferScroll:R.bBufferScroll,We===ke?R.bBufferScroll:R.aBufferScroll,R,l,s,a,c,S,i,r,D,fe,re,u,V,M,Ue);Se=Ce}else qe!==!1&&(ht(R!==void 0),Se=Yr(R,l,s,a,c,i,r,fe,V,qe));Nr(ne,V,i,r,S,D,E,K,d);const et=To(ne,i,r,l,s,a,c,u,m,b,w,M,S,D,j,d),dt=h?Nn(ne,i,r,s,a,c,V,u,d,fe,P,K,B,S,de,T,D):void 0;if(ne.fillStyle=d.bgCell,Se.length>0){ne.beginPath();for(const Ce of Se)ne.rect(Ce.x,Ce.y,Ce.width,Ce.height);ne.clip(),ne.fill(),ne.beginPath()}else ne.fillRect(0,0,i,r);const It=Do(ne,V,u,r,fe,a,c,s,D,K,B,I,x,v,k,h,S,de,Se,be,P,O,j,ce,Me,Ne,Be,oe,J,d,Je,q,xe,A,mt);Lr(ne,V,u,i,r,fe,a,c,s,D,K,x,P.rows,v,S,de,Se,be,d),Or(ne,V,s,a,c,i,r,Se,fe,K,x,E,S,D,d),Ro(ne,V,s,a,c,i,r,Se,It,w,fe,K,x,E,S,D,d),et==null||et(),dt==null||dt(),C&&nt!=="none"&&Mt(V,0,a,0,fe,(Ce,he)=>Ce.sourceIndex===te?(Wo(se,he+Ce.width,0,fe+1,Ge(d.resizeIndicatorColor??d.accentLight,d.bgHeader)),nt==="full"&&Wo(ne,he+Ce.width,fe,r,Ge(d.resizeIndicatorColor??d.accentLight,d.bgCell)),!0):!1),N!==null&&(N.fillStyle=d.bgCell,N.fillRect(0,0,i,r),N.drawImage(ne.canvas,0,0));const Ye=Ur(V,r,fe,a,c,s,D,K,S,de);ce==null||ce.setWindow({x:l,y:s,width:V.length,height:Ye-s},m,Array.from({length:S},(Ce,he)=>D-1-he));const ot=R!==void 0&&(l!==R.cellXOffset||a!==R.translateX),$e=R!==void 0&&(s!==R.cellYOffset||c!==R.translateY);me.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mustDrawFocusOnHeader:Le,mustDrawHighlightRingsOnHeader:Ee,lastBuffer:Ue?Ae===ke?"a":"b":void 0,aBufferScroll:Ae===ke?[ot,$e]:R==null?void 0:R.aBufferScroll,bBufferScroll:Ae===Pe?[ot,$e]:R==null?void 0:R.bBufferScroll},ne.restore(),se.restore()}const qr=80;function Vr(e){const t=e-1;return t*t*t+1}class jr{constructor(t){ee(this,"currentHoveredItem");ee(this,"leavingItems",[]);ee(this,"lastAnimationTime");ee(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>wn(o.item,t.item))||this.leavingItems.push(t)});ee(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>wn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});ee(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});ee(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});ee(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Vr(t.hoverAmount)})));ee(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/qr;for(const r of this.leavingItems)r.hoverAmount=kn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=kn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});ee(this,"setHovered",t=>{var n;if(!wn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Kr{constructor(t){ee(this,"fn");ee(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function ro(e){return new Kr(e)}const Gr=ro(()=>window.navigator.userAgent.includes("Firefox")),Lo=ro(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),kl=ro(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Jr(e){const t=y.useRef([]),n=y.useRef(0),o=y.useRef(e);o.current=e;const i=y.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(io);t.current=[],o.current(new Yt(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return y.useCallback(r=>{t.current.length===0&&i();const l=tt(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const Rt="header",tn="group-header",No="out-of-bounds";var nn=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(nn||{});function Qr(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Zr=(e,t)=>{if(e.kind===ae.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},es=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:c=!1,groupHeaderHeight:u,rowHeight:g,rows:m,getCellContent:f,getRowThemeOverride:d,onHeaderMenuClick:h,onHeaderIndicatorClick:b,enableGroups:w,isFilling:v,onCanvasFocused:M,onCanvasBlur:E,isFocused:A,selection:C,freezeColumns:P,onContextMenu:T,freezeTrailingRows:S,fixedShadowX:D=!0,fixedShadowY:B=!0,drawFocusRing:I,onMouseDown:x,onMouseUp:k,onMouseMoveRaw:_,onMouseMove:O,onItemHovered:oe,dragAndDropState:j,firstColAccessible:te,onKeyDown:ce,onKeyUp:me,highlightRegions:Ne,canvasRef:J,onDragStart:Be,onDragEnd:Me,eventTargetRef:Y,isResizing:de,resizeColumn:Oe,isDragging:Je,isDraggable:q=!1,allowResize:xe,disabledRows:Qe,hasAppendRow:ze,getGroupDetails:Xe,theme:be,prelightCells:mt,headerIcons:nt,verticalBorder:Ue,drawCell:re,drawHeader:qe,onCellFocused:Re,onDragOverCell:Ve,onDrop:fe,onDragLeave:Te,imageWindowLoader:ke,smoothScrollX:Pe=!1,smoothScrollY:R=!1,experimental:N,getCellRenderer:se,resizeIndicator:ne="full"}=e,Ae=e.translateX??0,We=e.translateY??0,K=Math.max(P,Math.min(r.length-1,l)),V=y.useRef(null),Se=y.useRef((N==null?void 0:N.eventTarget)??window),Le=Se.current,Ee=ke,je=y.useRef(),[et,dt]=y.useState(!1),It=y.useRef([]),Ye=y.useRef(),[ot,$e]=y.useState(),[bt,Ce]=y.useState(),he=y.useRef(null),[Et,it]=y.useState(),[rt,yt]=y.useState(!1),Ft=y.useRef(rt);Ft.current=rt;const vt=y.useMemo(()=>new Ir(nt,()=>{cn.current=void 0,jt.current()}),[nt]),ut=w?u+a:a,U=y.useRef(-1),ye=((N==null?void 0:N.enableFirefoxRescaling)??!1)&&Gr.value,ue=((N==null?void 0:N.enableSafariRescaling)??!1)&&Lo.value;y.useLayoutEffect(()=>{window.devicePixelRatio===1||!ye&&!ue||(U.current!==-1&&dt(!0),window.clearTimeout(U.current),U.current=window.setTimeout(()=>{dt(!1),U.current=-1},200))},[s,K,Ae,We,ye,ue]);const ie=dr(r,P),Ke=y.useMemo(()=>D?Ut(ie,j):0,[ie,j,D]),Q=y.useCallback((p,F,z)=>{const L=p.getBoundingClientRect();if(F>=ie.length||z>=m)return;const H=L.width/n,W=jn(F,z,n,o,u,ut,K,s,Ae,We,m,P,S,ie,g);return H!==1&&(W.x*=H,W.y*=H,W.width*=H,W.height*=H),W.x+=L.x,W.y+=L.y,W},[n,o,u,ut,K,s,Ae,We,m,P,S,ie,g]),De=y.useCallback((p,F,z,L)=>{const H=p.getBoundingClientRect(),W=H.width/n,G=(F-H.left)/W,Z=(z-H.top)/W,X=5,He=Vn(ie,K,n,void 0,Ae);let $=0,le=0;const pe=typeof PointerEvent<"u"&&L instanceof PointerEvent&&L.pointerType==="mouse"||typeof MouseEvent<"u"&&L instanceof MouseEvent,ve=typeof PointerEvent<"u"&&L instanceof PointerEvent&&L.pointerType==="touch"||typeof TouchEvent<"u"&&L instanceof TouchEvent;pe&&($=L.button,le=L.buttons);const we=gr(G,He,Ae),Ie=mr(Z,o,w,a,u,m,g,s,We,S),Fe=(L==null?void 0:L.shiftKey)===!0,ft=(L==null?void 0:L.ctrlKey)===!0,pt=(L==null?void 0:L.metaKey)===!0,st=[G<0?-1:n<G?1:0,Z<ut?-1:o<Z?1:0];let wt;if(we===-1||Z<0||G<0||Ie===void 0||G>n||Z>o){const ge=G>n?1:G<0?-1:0,xt=Z>o?1:Z<0?-1:0;let lt=ge*2,Tn=xt*2;ge===0&&(lt=we===-1?nn.EndPadding:nn.Center),xt===0&&(Tn=Ie===void 0?nn.EndPadding:nn.Center);let Ot=!1;if(we===-1&&Ie===-1){const Xt=Q(p,ie.length-1,-1);ht(Xt!==void 0),Ot=F<Xt.x+Xt.width+X}const Gt=G>n&&G<n+Io()||Z>o&&Z<o+Io();wt={kind:No,location:[we!==-1?we:G<0?0:ie.length-1,Ie??m-1],region:[lt,Tn],shiftKey:Fe,ctrlKey:ft,metaKey:pt,isEdge:Ot,isTouch:ve,button:$,buttons:le,scrollEdge:st,isMaybeScrollbar:Gt}}else if(Ie<=-1){let ge=Q(p,we,Ie);ht(ge!==void 0);let xt=ge!==void 0&&ge.x+ge.width-F<=X;const lt=we-1;F-ge.x<=X&&lt>=0?(xt=!0,ge=Q(p,lt,Ie),ht(ge!==void 0),wt={kind:w&&Ie===-2?tn:Rt,location:[lt,Ie],bounds:ge,group:ie[lt].group??"",isEdge:xt,shiftKey:Fe,ctrlKey:ft,metaKey:pt,isTouch:ve,localEventX:F-ge.x,localEventY:z-ge.y,button:$,buttons:le,scrollEdge:st}):wt={kind:w&&Ie===-2?tn:Rt,group:ie[we].group??"",location:[we,Ie],bounds:ge,isEdge:xt,shiftKey:Fe,ctrlKey:ft,metaKey:pt,isTouch:ve,localEventX:F-ge.x,localEventY:z-ge.y,button:$,buttons:le,scrollEdge:st}}else{const ge=Q(p,we,Ie);ht(ge!==void 0);const xt=ge!==void 0&&ge.x+ge.width-F<X;let lt=!1;if(c!==!1&&c!==void 0&&C.current!==void 0){const Ot=typeof c=="object"?{...Cn,...c}:Cn,Gt=Ot.size,Xt=Gt/2,ko=ei(C.current.range),Jt=Q(p,ko[0],ko[1]);if(Jt!==void 0){const Xi=Jt.x+Jt.width+Ot.offsetX-Xt+.5,Yi=Jt.y+Jt.height+Ot.offsetY-Xt+.5;lt=Math.abs(Xi-F)<Gt&&Math.abs(Yi-z)<Gt}}wt={kind:"cell",location:[we,Ie],bounds:ge,isEdge:xt,shiftKey:Fe,ctrlKey:ft,isFillHandle:lt,metaKey:pt,isTouch:ve,localEventX:F-ge.x,localEventY:z-ge.y,button:$,buttons:le,scrollEdge:st}}return wt},[n,ie,K,Ae,o,w,a,u,m,g,s,We,S,Q,c,C,ut]),[Bt]=ot??[],lo=y.useRef(()=>{}),Wt=y.useRef(ot);Wt.current=ot;const[Pt,At]=y.useMemo(()=>{const p=document.createElement("canvas"),F=document.createElement("canvas");return p.style.display="none",p.style.opacity="0",p.style.position="fixed",F.style.display="none",F.style.opacity="0",F.style.position="fixed",[p.getContext("2d",{alpha:!1}),F.getContext("2d",{alpha:!1})]},[]);y.useLayoutEffect(()=>{if(!(Pt===null||At===null))return document.documentElement.append(Pt.canvas),document.documentElement.append(At.canvas),()=>{Pt.canvas.remove(),At.canvas.remove()}},[Pt,At]);const an=y.useMemo(()=>new Cr,[]),ao=ye&&et?1:ue&&et?2:5,co=(N==null?void 0:N.disableMinimumCellWidth)===!0?1:10,cn=y.useRef(),dn=y.useRef(null),un=y.useRef(null),fn=y.useCallback(()=>{var G;const p=V.current,F=he.current;if(p===null||F===null||(dn.current===null&&(dn.current=p.getContext("2d",{alpha:!1}),p.width=0,p.height=0),un.current===null&&(un.current=F.getContext("2d",{alpha:!1}),F.width=0,F.height=0),dn.current===null||un.current===null||Pt===null||At===null))return;let z=!1;const L=Z=>{z=!0,it(Z)},H=cn.current,W={headerCanvasCtx:un.current,canvasCtx:dn.current,bufferACtx:Pt,bufferBCtx:At,width:n,height:o,cellXOffset:K,cellYOffset:s,translateX:Math.round(Ae),translateY:Math.round(We),mappedColumns:ie,enableGroups:w,freezeColumns:P,dragAndDropState:j,theme:be,headerHeight:a,groupHeaderHeight:u,disabledRows:Qe??Un.empty(),rowHeight:g,verticalBorder:Ue,isResizing:de,resizeCol:Oe,isFocused:A,selection:C,fillHandle:c,drawCellCallback:re,hasAppendRow:ze,overrideCursor:L,maxScaleFactor:ao,freezeTrailingRows:S,rows:m,drawFocus:I,getCellContent:f,getGroupDetails:Xe??(Z=>({name:Z})),getRowThemeOverride:d,drawHeaderCallback:qe,prelightCells:mt,highlightRegions:Ne,imageLoader:Ee,lastBlitData:Ye,damage:je.current,hoverValues:It.current,hoverInfo:Wt.current,spriteManager:vt,scrolling:et,hyperWrapping:(N==null?void 0:N.hyperWrapping)??!1,touchMode:rt,enqueue:lo.current,renderStateProvider:an,renderStrategy:(N==null?void 0:N.renderStrategy)??(Lo.value?"double-buffer":"single-buffer"),getCellRenderer:se,minimumCellWidth:co,resizeIndicator:ne};W.damage===void 0?(cn.current=W,zo(W,H)):zo(W,void 0),!z&&(W.damage===void 0||W.damage.has((G=Wt==null?void 0:Wt.current)==null?void 0:G[0]))&&it(void 0)},[Pt,At,n,o,K,s,Ae,We,ie,w,P,j,be,a,u,Qe,g,Ue,de,ze,Oe,A,C,c,S,m,I,ao,f,Xe,d,re,qe,mt,Ne,Ee,vt,et,N==null?void 0:N.hyperWrapping,N==null?void 0:N.renderStrategy,rt,an,se,co,ne]),jt=y.useRef(fn);y.useLayoutEffect(()=>{fn(),jt.current=fn},[fn]),y.useLayoutEffect(()=>{(async()=>{var F;((F=document==null?void 0:document.fonts)==null?void 0:F.ready)!==void 0&&(await document.fonts.ready,cn.current=void 0,jt.current())})()},[]);const zt=y.useCallback(p=>{je.current=p,jt.current(),je.current=void 0},[]),pi=Jr(zt);lo.current=pi;const uo=y.useCallback(p=>{zt(new Yt(p.map(F=>F.cell)))},[zt]);Ee.setCallback(zt);const[wi,xi]=y.useState(!1),[Dt,Lt]=Bt??[],ki=Dt!==void 0&&Lt===-1&&Dt>=0&&Dt<ie.length&&ie[Dt].headerRowMarkerDisabled!==!0,Si=Dt!==void 0&&Lt===-2;let fo=!1,ho=!1,hn=Et;if(hn===void 0&&Dt!==void 0&&Lt!==void 0&&Lt>-1&&Lt<m){const p=f([Dt,Lt],!0);fo=p.kind===Ct.NewRow||p.kind===Ct.Marker&&p.markerKind!=="number",ho=p.kind===ae.Boolean&&Zn(p),hn=p.cursor}const go=Je?"grabbing":(bt??!1)||de?"col-resize":wi||v?"crosshair":hn!==void 0?hn:ki||fo||ho||Si?"pointer":"default",Fn=y.useMemo(()=>({contain:"strict",display:"block",cursor:go}),[go]),mo=y.useRef("default"),Bn=Y==null?void 0:Y.current;Bn!=null&&mo.current!==Fn.cursor&&(Bn.style.cursor=mo.current=Fn.cursor);const gn=y.useCallback((p,F,z,L)=>{if(Xe===void 0)return;const H=Xe(p);if(H.actions!==void 0){const W=hi(F,H.actions);for(const[G,Z]of W.entries())if($t(Z,z+F.x,L+Z.y))return H.actions[G]}},[Xe]),Nt=y.useCallback((p,F,z,L)=>{const H=ie[F];if(!Je&&!de&&!(bt??!1)){const W=Q(p,F,-1);ht(W!==void 0);const G=gi(void 0,H,W.x,W.y,W.width,W.height,be,to(H.title)==="rtl");if(H.hasMenu===!0&&G.menuBounds!==void 0&&$t(G.menuBounds,z,L))return{area:"menu",bounds:G.menuBounds};if(H.indicatorIcon!==void 0&&G.indicatorIconBounds!==void 0&&$t(G.indicatorIconBounds,z,L))return{area:"indicator",bounds:G.indicatorIconBounds}}},[ie,Q,bt,Je,de,be]),Pn=y.useRef(0),Kt=y.useRef(),An=y.useRef(!1),Ci=y.useCallback(p=>{const F=V.current,z=Y==null?void 0:Y.current;if(F===null||p.target!==F&&p.target!==z)return;An.current=!0;const L=p.clientX,H=p.clientY;if(p.target===z&&z!==null){const G=z.getBoundingClientRect();if(L>G.right||H>G.bottom)return}const W=De(F,L,H,p);Kt.current=W.location,W.isTouch&&(Pn.current=Date.now()),Ft.current!==W.isTouch&&yt(W.isTouch),!(W.kind===Rt&&Nt(F,W.location[0],L,H)!==void 0)&&(W.kind===tn&&gn(W.group,W.bounds,W.localEventX,W.localEventY)!==void 0||(x==null||x(W),!W.isTouch&&q!==!0&&q!==W.kind&&W.button<3&&W.button!==1&&p.preventDefault()))},[Y,q,De,gn,Nt,x]);at("pointerdown",Ci,Le,!1);const bo=y.useRef(0),Mi=y.useCallback(p=>{var le,pe;const F=bo.current;bo.current=Date.now();const z=V.current;if(An.current=!1,k===void 0||z===null)return;const L=Y==null?void 0:Y.current,H=p.target!==z&&p.target!==L,W=p.clientX,G=p.clientY,Z=p.pointerType==="mouse"?p.button<3:!0;let X=De(z,W,G,p);X.isTouch&&Pn.current!==0&&Date.now()-Pn.current>500&&(X={...X,isLongTouch:!0}),F!==0&&Date.now()-F<(X.isTouch?1e3:500)&&(X={...X,isDoubleClick:!0}),Ft.current!==X.isTouch&&yt(X.isTouch),!H&&p.cancelable&&Z&&p.preventDefault();const[He]=X.location,$=Nt(z,He,W,G);if(X.kind===Rt&&$!==void 0){(X.button!==0||((le=Kt.current)==null?void 0:le[0])!==He||((pe=Kt.current)==null?void 0:pe[1])!==-1)&&k(X,!0);return}else if(X.kind===tn){const ve=gn(X.group,X.bounds,X.localEventX,X.localEventY);if(ve!==void 0){X.button===0&&ve.onClick(X);return}}k(X,H)},[k,Y,De,Nt,gn]);at("pointerup",Mi,Le,!1);const Ii=y.useCallback(p=>{var He,$;const F=V.current;if(F===null)return;const z=Y==null?void 0:Y.current,L=p.target!==F&&p.target!==z;let H,W,G=!0;p instanceof MouseEvent?(H=p.clientX,W=p.clientY,G=p.button<3):(H=p.changedTouches[0].clientX,W=p.changedTouches[0].clientY);const Z=De(F,H,W,p);Ft.current!==Z.isTouch&&yt(Z.isTouch),!L&&p.cancelable&&G&&p.preventDefault();const[X]=Z.location;if(Z.kind===Rt){const le=Nt(F,X,H,W);le!==void 0&&Z.button===0&&((He=Kt.current)==null?void 0:He[0])===X&&(($=Kt.current)==null?void 0:$[1])===-1&&(le.area==="menu"?h==null||h(X,le.bounds):le.area==="indicator"&&(b==null||b(X,le.bounds)))}},[Y,De,Nt,h,b]);at("click",Ii,Le,!1);const Ei=y.useCallback(p=>{const F=V.current,z=Y==null?void 0:Y.current;if(F===null||p.target!==F&&p.target!==z||T===void 0)return;const L=De(F,p.clientX,p.clientY,p);T(L,()=>{p.cancelable&&p.preventDefault()})},[Y,De,T]);at("contextmenu",Ei,(Y==null?void 0:Y.current)??null,!1);const yo=y.useCallback(p=>{je.current=new Yt(p.map(F=>F.item)),It.current=p,jt.current(),je.current=void 0},[]),vo=y.useMemo(()=>new jr(yo),[yo]),po=y.useRef(vo);po.current=vo,y.useLayoutEffect(()=>{const p=po.current;if(Bt===void 0||Bt[1]<0){p.setHovered(Bt);return}const F=f(Bt,!0),z=se(F),L=z===void 0&&F.kind===ae.Custom||(z==null?void 0:z.needsHover)!==void 0&&(typeof z.needsHover=="boolean"?z.needsHover:z.needsHover(F));p.setHovered(L?Bt:void 0)},[f,se,Bt]);const wo=y.useRef(),Fi=y.useCallback(p=>{var Z;const F=V.current;if(F===null)return;const z=Y==null?void 0:Y.current,L=p.target!==F&&p.target!==z,H=De(F,p.clientX,p.clientY,p);if(H.kind!=="out-of-bounds"&&L&&!An.current&&!H.isTouch)return;const W=(X,He)=>{$e($=>$===X||($==null?void 0:$[0][0])===(X==null?void 0:X[0][0])&&($==null?void 0:$[0][1])===(X==null?void 0:X[0][1])&&(($==null?void 0:$[1][0])===(X==null?void 0:X[1][0])&&($==null?void 0:$[1][1])===(X==null?void 0:X[1][1])||!He)?$:X)};if(!Qr(H,wo.current))it(void 0),oe==null||oe(H),W(H.kind===No?void 0:[H.location,[H.localEventX,H.localEventY]],!0),wo.current=H;else if(H.kind==="cell"||H.kind===Rt||H.kind===tn){let X=!1,He=!0;if(H.kind==="cell"){const le=f(H.location);He=((Z=se(le))==null?void 0:Z.needsHoverPosition)??le.kind===ae.Custom,X=He}else X=!0;const $=[H.location,[H.localEventX,H.localEventY]];W($,He),Wt.current=$,X&&zt(new Yt([H.location]))}const G=H.location[0]>=(te?0:1);Ce(H.kind===Rt&&H.isEdge&&G&&xe===!0),xi(H.kind==="cell"&&H.isFillHandle),_==null||_(p),O(H)},[Y,De,te,xe,_,O,oe,f,se,zt]);at("pointermove",Fi,Le,!0);const Bi=y.useCallback(p=>{const F=V.current;if(F===null)return;let z,L;C.current!==void 0&&(z=Q(F,C.current.cell[0],C.current.cell[1]),L=C.current.cell),ce==null||ce({bounds:z,stopPropagation:()=>p.stopPropagation(),preventDefault:()=>p.preventDefault(),cancel:()=>{},ctrlKey:p.ctrlKey,metaKey:p.metaKey,shiftKey:p.shiftKey,altKey:p.altKey,key:p.key,keyCode:p.keyCode,rawEvent:p,location:L})},[ce,C,Q]),Pi=y.useCallback(p=>{const F=V.current;if(F===null)return;let z,L;C.current!==void 0&&(z=Q(F,C.current.cell[0],C.current.cell[1]),L=C.current.cell),me==null||me({bounds:z,stopPropagation:()=>p.stopPropagation(),preventDefault:()=>p.preventDefault(),cancel:()=>{},ctrlKey:p.ctrlKey,metaKey:p.metaKey,shiftKey:p.shiftKey,altKey:p.altKey,key:p.key,keyCode:p.keyCode,rawEvent:p,location:L})},[me,C,Q]),Ai=y.useCallback(p=>{if(V.current=p,J!==void 0&&(J.current=p),N!=null&&N.eventTarget)Se.current=N.eventTarget;else if(p===null)Se.current=window;else{const F=p.getRootNode();F===document&&(Se.current=window),Se.current=F}},[J,N==null?void 0:N.eventTarget]),Di=y.useCallback(p=>{const F=V.current;if(F===null||q===!1||de){p.preventDefault();return}let z,L;const H=De(F,p.clientX,p.clientY);if(q!==!0&&H.kind!==q){p.preventDefault();return}const W=(le,pe)=>{z=le,L=pe};let G,Z,X;const He=(le,pe,ve)=>{G=le,Z=pe,X=ve};let $=!1;if(Be==null||Be({...H,setData:W,setDragImage:He,preventDefault:()=>$=!0,defaultPrevented:()=>$}),!$&&z!==void 0&&L!==void 0&&p.dataTransfer!==null)if(p.dataTransfer.setData(z,L),p.dataTransfer.effectAllowed="copyLink",G!==void 0&&Z!==void 0&&X!==void 0)p.dataTransfer.setDragImage(G,Z,X);else{const[le,pe]=H.location;if(pe!==void 0){const ve=document.createElement("canvas"),we=Q(F,le,pe);ht(we!==void 0);const Ie=Math.ceil(window.devicePixelRatio??1);ve.width=we.width*Ie,ve.height=we.height*Ie;const Fe=ve.getContext("2d");Fe!==null&&(Fe.scale(Ie,Ie),Fe.textBaseline="middle",pe===-1?(Fe.font=be.headerFontFull,Fe.fillStyle=be.bgHeader,Fe.fillRect(0,0,ve.width,ve.height),mi(Fe,0,0,we.width,we.height,ie[le],!1,be,!1,void 0,void 0,!1,0,vt,qe,!1)):(Fe.font=be.baseFontFull,Fe.fillStyle=be.bgCell,Fe.fillRect(0,0,ve.width,ve.height),fi(Fe,f([le,pe]),0,pe,!1,!1,0,0,we.width,we.height,!1,be,be.bgCell,Ee,vt,1,void 0,!1,0,void 0,void 0,void 0,an,se,()=>{},0))),ve.style.left="-100%",ve.style.position="absolute",ve.style.width=`${we.width}px`,ve.style.height=`${we.height}px`,document.body.append(ve),p.dataTransfer.setDragImage(ve,we.width/2,we.height/2),window.setTimeout(()=>{ve.remove()},0)}}else p.preventDefault()},[q,de,De,Be,Q,be,ie,vt,qe,f,Ee,an,se]);at("dragstart",Di,(Y==null?void 0:Y.current)??null,!1,!1);const Dn=y.useRef(),Hi=y.useCallback(p=>{const F=V.current;if(fe!==void 0&&p.preventDefault(),F===null||Ve===void 0)return;const z=De(F,p.clientX,p.clientY),[L,H]=z.location,W=L-(te?0:1),[G,Z]=Dn.current??[];(G!==W||Z!==H)&&(Dn.current=[W,H],Ve([W,H],p.dataTransfer))},[te,De,Ve,fe]);at("dragover",Hi,(Y==null?void 0:Y.current)??null,!1,!1);const Ri=y.useCallback(()=>{Dn.current=void 0,Me==null||Me()},[Me]);at("dragend",Ri,(Y==null?void 0:Y.current)??null,!1,!1);const Ti=y.useCallback(p=>{const F=V.current;if(F===null||fe===void 0)return;p.preventDefault();const z=De(F,p.clientX,p.clientY),[L,H]=z.location,W=L-(te?0:1);fe([W,H],p.dataTransfer)},[te,De,fe]);at("drop",Ti,(Y==null?void 0:Y.current)??null,!1,!1);const Wi=y.useCallback(()=>{Te==null||Te()},[Te]);at("dragleave",Wi,(Y==null?void 0:Y.current)??null,!1,!1);const xo=y.useRef(C);xo.current=C;const mn=y.useRef(null),Hn=y.useCallback(p=>{var F;V.current===null||!V.current.contains(document.activeElement)||(p===null&&xo.current.current!==void 0?(F=J==null?void 0:J.current)==null||F.focus({preventScroll:!0}):p!==null&&p.focus({preventScroll:!0}),mn.current=p)},[J]);y.useImperativeHandle(t,()=>({focus:()=>{var F;const p=mn.current;p===null||!document.contains(p)?(F=J==null?void 0:J.current)==null||F.focus({preventScroll:!0}):p.focus({preventScroll:!0})},getBounds:(p,F)=>{if(!(J===void 0||J.current===null))return Q(J.current,p??0,F??-1)},damage:uo,getMouseArgsForPosition:(p,F,z)=>{if(!(J===void 0||J.current===null))return De(J.current,p,F,z)}}),[J,uo,Q,De]);const Rn=y.useRef(),zi=sr(()=>{var Z,X,He;if(n<50||(N==null?void 0:N.disableAccessibilityTree)===!0)return null;let p=Vn(ie,K,n,j,Ae);const F=te?0:-1;!te&&((Z=p[0])==null?void 0:Z.sourceIndex)===0&&(p=p.slice(1));const[z,L]=((X=C.current)==null?void 0:X.cell)??[],H=(He=C.current)==null?void 0:He.range,W=p.map($=>$.sourceIndex),G=Gi(s,Math.min(m,s+i));return z!==void 0&&L!==void 0&&!(W.includes(z)&&G.includes(L))&&Hn(null),y.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":ie.length+F},y.createElement("thead",{role:"rowgroup"},y.createElement("tr",{role:"row","aria-rowindex":1},p.map($=>y.createElement("th",{role:"columnheader","aria-selected":C.columns.hasIndex($.sourceIndex),"aria-colindex":$.sourceIndex+1+F,tabIndex:-1,onFocus:le=>{if(le.target!==mn.current)return Re==null?void 0:Re([$.sourceIndex,-1])},key:$.sourceIndex},$.title)))),y.createElement("tbody",{role:"rowgroup"},G.map($=>y.createElement("tr",{role:"row","aria-selected":C.rows.hasIndex($),key:$,"aria-rowindex":$+2},p.map(le=>{const pe=le.sourceIndex,ve=tt(pe,$),we=z===pe&&L===$,Ie=H!==void 0&&pe>=H.x&&pe<H.x+H.width&&$>=H.y&&$<H.y+H.height,Fe=`glide-cell-${pe}-${$}`,ft=[pe,$],pt=f(ft,!0);return y.createElement("td",{key:ve,role:"gridcell","aria-colindex":pe+1+F,"aria-selected":Ie,"aria-readonly":jo(pt)||!or(pt),id:Fe,"data-testid":Fe,onClick:()=>{const st=J==null?void 0:J.current;if(st!=null)return ce==null?void 0:ce({bounds:Q(st,pe,$),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:ft})},onFocusCapture:st=>{var wt,ge;if(!(st.target===mn.current||((wt=Rn.current)==null?void 0:wt[0])===pe&&((ge=Rn.current)==null?void 0:ge[1])===$))return Rn.current=ft,Re==null?void 0:Re(ft)},ref:we?Hn:void 0,tabIndex:-1},Zr(pt,se))})))))},[n,ie,K,j,Ae,m,s,i,C,Hn,f,J,ce,Q,Re],200),bn=P===0||!D?0:K>P?1:kn(-Ae/100,0,1),Li=-s*32+We,yn=B?kn(-Li/100,0,1):0,Ni=y.useMemo(()=>{if(!bn&&!yn)return null;const p={position:"absolute",top:0,left:Ke,width:n-Ke,height:o,opacity:bn,pointerEvents:"none",transition:Pe?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},F={position:"absolute",top:ut,left:0,width:n,height:o,opacity:yn,pointerEvents:"none",transition:R?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return y.createElement(y.Fragment,null,bn>0&&y.createElement("div",{id:"shadow-x",style:p}),yn>0&&y.createElement("div",{id:"shadow-y",style:F}))},[bn,yn,Ke,n,Pe,ut,o,R]),Oi=y.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return y.createElement(y.Fragment,null,y.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Bi,onKeyUp:Pi,onFocus:M,onBlur:E,ref:Ai,style:Fn},zi),y.createElement("canvas",{ref:he,style:Oi}),Ni)},Sl=y.memo(y.forwardRef(es));function ts(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case ae.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Qn?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case ae.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case ae.Image:case ae.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case ae.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case ae.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case ae.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case ae.Markdown:case ae.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case ae.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case ae.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case ae.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Jn()}}function ns(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:ts(l))})}function Oo(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function os(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>Oo(l,!0)).join(",")):i.push(r.doNotEscape===!0?r.formatted:Oo(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function On(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Xo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function is(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function rs(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${On(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${Xo(i.rawValue[s])}>`+On(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Xo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${On(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function ss(e,t){const n=ns(e,t),o=os(n),i=rs(n);return{textPlain:o,textHtml:i}}function Cl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),u=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=a.querySelectorAll("br");for(const h of m)h.replaceWith(`
`);const f=a.getAttribute("gdg-raw-value"),d=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:d});else if(a.querySelector("ol")!==null){const h=a.querySelectorAll("li");r==null||r.push({rawValue:[...h].map(b=>b.getAttribute("gdg-raw-value")??""),formatted:[...h].map(b=>b.textContent??""),format:"string-array"})}else if(f!==null)r==null||r.push({rawValue:is(f),formatted:a.textContent??"",format:d});else{let h=a.textContent??"";g&&(h=h.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:h??"",formatted:h??"",format:d})}}}return r!==void 0&&i.push(r),i}function Ml(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,c=[];if(a.width>2){const m=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof m=="function")return r;c.push(...m);const f=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof f=="function")return r;c.push(...f)}else{const m=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof m=="function")return r;c.push(...m)}let u=a.x-n,g=a.x+a.width-1-n;for(const m of c)for(const f of m)f.span!==void 0&&(u=Math.min(f.span[0],u),g=Math.max(f.span[1],g));u===a.x-n&&g===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:a.y,width:g-u+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function Yo(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Il(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push(Yo(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push(Yo(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function El(e,t,n){var s;const o=ss(e,t),i=a=>{var c;(c=window.navigator.clipboard)==null||c.writeText(a)},r=(a,c)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([c],{type:"text/html"})})]),!0)},l=(a,c)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",a),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",c)}catch{r(a,c)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function ls(e){return e!==!0}function $o(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:c}=i,u=t.maxSize??r.checkboxMaxSize,g=Math.floor(i.y+s/2),m=Jo(u,s,r.cellVerticalPadding),f=Go(t.contentAlign??"center",a,l,r.cellHorizontalPadding,m),d=Ko(f,g,m),h=Qo(a+n,c+o,d);return Zn(t)&&h}const as={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:ae.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>cs(e,e.cell.data,Zn(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{$o(e)&&e.preventDefault()},onClick:e=>{if($o(e))return{...e.cell,data:ls(e.cell.data)}},onPaste:(e,t)=>{let n=Sn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Qn),n===t.data?void 0:{...t,data:n}}};function cs(e,t,n,o,i){if(!n&&t===Sn)return;const{ctx:r,hoverAmount:l,theme:s,rect:a,highlighted:c,hoverX:u,hoverY:g,cell:{contentAlign:m}}=e,{x:f,y:d,width:h,height:b}=a;let w=!1;if(i>0){let v=n?1-i+i*l:.4;if(t===Sn&&(v*=l),v===0)return;v<1&&(w=!0,r.globalAlpha=v)}Mn(r,s,t,f,d,h,b,c,u,g,o,m),w&&(r.globalAlpha=1)}const ds=gt("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),us=e=>{const{bubbles:t}=e;return y.createElement(ds,null,t.map((n,o)=>y.createElement("div",{key:o,className:"boe-bubble"},n)),y.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},fs={getAccessibilityString:e=>Zo(e.data),kind:ae.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((i,r)=>e.measureText(r).width+i+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>hs(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return y.createElement(us,{bubbles:t.data})},onPaste:()=>{}};function hs(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:c}=n;let u=l+o.cellHorizontalPadding;const g=[];for(const m of t){if(u>l+a)break;const f=Tt(m,i,o.baseFontFull).width;g.push({x:u,width:f}),u+=f+o.bubblePadding*2+o.bubbleMargin}i.beginPath();for(const m of g)ct(i,m.x,s+(c-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[m,f]of g.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[m],f.x+o.bubblePadding,s+c/2+Ze(i,o))}const gs=gt("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),ms=e=>{const{drilldowns:t}=e;return y.createElement(gs,null,t.map((n,o)=>y.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&y.createElement("img",{src:n.img}),y.createElement("div",null,n.text))))},bs={getAccessibilityString:e=>Zo(e.data.map(t=>t.text)),kind:ae.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+n.bubblePadding*2+n.bubbleMargin+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>vs(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return y.createElement(ms,{drilldowns:t.data})},onPaste:()=>{}},Xn={};function ys(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,c=o+r,u=o*3,g=(u+r*2)*i,m=`${e},${t},${i},${n}`;if(Xn[m]!==void 0)return{el:Xn[m],height:a,width:g,middleWidth:s*i,sideWidth:c*i,padding:r*i,dpr:i};const f=document.createElement("canvas"),d=f.getContext("2d");return d===null?null:(f.width=g,f.height=a,d.scale(i,i),Xn[m]=f,d.beginPath(),ct(d,r,r,u,l,o),d.shadowColor="rgba(24, 25, 34, 0.4)",d.shadowBlur=1,d.fillStyle=e,d.fill(),d.shadowColor="rgba(24, 25, 34, 0.3)",d.shadowOffsetY=1,d.shadowBlur=5,d.fillStyle=e,d.fill(),d.shadowOffsetY=0,d.shadowBlur=0,d.shadowBlur=0,d.beginPath(),ct(d,r+.5,r+.5,u,l,o),d.strokeStyle=t,d.lineWidth=1,d.stroke(),{el:f,height:a,width:g,sideWidth:c*i,middleWidth:o*i,padding:r*i,dpr:i})}function vs(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:c}=n,u=o.baseFontFull,g=ri(i,u),m=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),f=Math.floor(n.y+(n.height-m)/2),d=m-10,h=o.bubblePadding,b=o.bubbleMargin;let w=a+o.cellHorizontalPadding;const v=o.roundingRadius??6,M=ys(o.bgCell,o.drilldownBorder,m,v),E=[];for(const A of t){if(w>a+c)break;const P=Tt(A.text,i,u).width;let T=0;A.img!==void 0&&r.loadOrGetImage(A.img,l,s)!==void 0&&(T=d-8+4);const S=P+T+h*2;E.push({x:w,width:S}),w+=S+b}if(M!==null){const{el:A,height:C,middleWidth:P,sideWidth:T,width:S,dpr:D,padding:B}=M,I=T/D,x=B/D;for(const k of E){const _=Math.floor(k.x),O=Math.floor(k.width),oe=O-(I-x)*2;i.imageSmoothingEnabled=!1,i.drawImage(A,0,0,T,C,_-x,f,I,m),oe>0&&i.drawImage(A,T,0,P,C,_+(I-x),f,oe,m),i.drawImage(A,S-T,0,T,C,_+O-(I-x),f,I,m),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[A,C]of E.entries()){const P=t[A];let T=C.x+h;if(P.img!==void 0){const S=r.loadOrGetImage(P.img,l,s);if(S!==void 0){const D=d-8;let B=0,I=0,x=S.width,k=S.height;x>k?(B+=(x-k)/2,x=k):k>x&&(I+=(k-x)/2,k=x),i.beginPath(),ct(i,T,f+m/2-D/2,D,D,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(S,B,I,x,k,T,f+m/2-D/2,D,D),i.restore(),T+=D+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(P.text,T,f+m/2+Ze(i,o))}}const ps=gt("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),ws=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return y.createElement(ps,{"data-testid":"GDG-default-image-overlay-editor"},y.createElement(Ji.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},r.map(s=>{const a=(i==null?void 0:i(s))??y.createElement("img",{draggable:!1,src:s});return y.createElement("div",{className:"gdg-centering-container",key:s},a)})),n&&o&&y.createElement("button",{className:"gdg-edit-icon",onClick:o},y.createElement(eo,null)))},xs={getAccessibilityString:e=>e.data.join(", "),kind:ae.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>ks(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??ws;return y.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},Yn=4;function ks(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:c}=e,{x:u,y:g,height:m,width:f}=i,d=m-s.cellVerticalPadding*2,h=[];let b=0;for(let v=0;v<t.length;v++){const M=t[v];if(M.length===0)continue;const E=c.loadOrGetImage(M,r,l);if(E!==void 0){h[v]=E;const A=E.width*(d/E.height);b+=A+Yn}}if(b===0)return;b-=Yn;let w=u+s.cellHorizontalPadding;o==="right"?w=Math.floor(u+f-s.cellHorizontalPadding-b):o==="center"&&(w=Math.floor(u+f/2-b/2));for(const v of h){if(v===void 0)continue;const M=v.width*(d/v.height);n>0&&(a.beginPath(),ct(a,w,g+s.cellVerticalPadding,M,d,n),a.save(),a.clip()),a.drawImage(v,w,g+s.cellVerticalPadding,M,d),n>0&&a.restore(),w+=M+Yn}}function Ss(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Cs={getAccessibilityString:()=>"",kind:ae.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Ss(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding;s+a*2>=r.width&&(s=r.width-a*2-1);const c=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);ct(i,r.x+a,r.y+(r.height-c)/2,s,c,l.roundingRadius??3),i.fillStyle=ln(l.textDark,.1),i.fill()},onPaste:()=>{}},Ms=gt("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Is extends rn.PureComponent{constructor(){super(...arguments);ee(this,"targetElement",null);ee(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=Zi(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const u=document.createElement("template");u.innerHTML=l,a=u.content}n.append(a);const c=n.getElementsByTagName("a");for(const u of c)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),rn.createElement(Ms,{ref:this.containerRefHook})}}const Es=gt("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Fs=gt("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Bs=gt("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let _o=0;const so=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,...s}=e,{onChange:a,className:c}=s,u=y.useRef(null),g=n??"";ht(a!==void 0,"GrowingEntry must be a controlled input area");const[m]=y.useState(()=>"input-box-"+(_o=(_o+1)%1e7));y.useEffect(()=>{const d=u.current;if(d===null||d.disabled)return;const h=g.toString().length;d.focus(),d.setSelectionRange(i?0:h,h)},[]),y.useLayoutEffect(()=>{var d;if(l!==void 0){const h=typeof l=="number"?[l,null]:l;(d=u.current)==null||d.setSelectionRange(h[0],h[1])}},[l]);const f=y.useCallback(d=>{d.key==="Enter"&&d.shiftKey&&r===!0||o==null||o(d)},[r,o]);return y.createElement(Bs,{className:"gdg-growing-entry"},y.createElement(Fs,{className:c},g+`
`),y.createElement(Es,{...s,className:(c??"")+" gdg-input",id:m,ref:u,onKeyDown:f,value:g,placeholder:t,dir:"auto"}))},Ps=()=>e=>e.targetWidth,Uo=gt("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Ps(),"px"]}}),As=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,a=t.data,c=t.readonly===!0,[u,g]=y.useState(a===""||o),m=y.useCallback(()=>{g(d=>!d)},[]),f=a?"gdg-ml-6":"";return u?y.createElement(Uo,{targetWidth:r.width-20},y.createElement(so,{autoFocus:!0,highlight:!1,validatedSelection:s,value:a,onKeyDown:d=>{d.key==="Enter"&&d.stopPropagation()},onChange:n}),y.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${f}`,onClick:()=>l(t)},y.createElement(rr,null))):y.createElement(Uo,{targetWidth:r.width},y.createElement(Is,{contents:a,createNode:i}),!c&&y.createElement(y.Fragment,null,y.createElement("div",{className:"spacer"}),y.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${f}`,onClick:m},y.createElement(eo,null))),y.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Ds={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:In,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>St(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return y.createElement(As,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Hs={getAccessibilityString:e=>e.row.toString(),kind:Ct.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:Rs,measure:()=>44,draw:e=>Ws(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e;if(n.disabled===!0)return;const{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function Rs(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=Ts,n.textAlign="center",r}function Ts(e){const{ctx:t}=e;t.textAlign="start"}function Ws(e,t,n,o,i,r,l){if(l){const{ctx:b,rect:w,theme:v}=e,{x:M,y:E,width:A,height:C}=w,P=o==="checkbox"?"checkbox-visible":o;if(P!=="number"&&(b.globalAlpha=n?1:.4,Mn(b,v,n,i?M+7:M,E,i?A-7:A,C,!1,-20,-20,v.checkboxMaxSize,"center",r,!0),b.globalAlpha=1),P==="number"||P==="both"&&!n){const T=t.toString(),S=v.markerFontFull,D=M+A/2;b.fillStyle="#cccccc",b.font=S,b.fillText(T,D,E+C/2+Ze(b,S))}if(i){b.globalAlpha=.4,b.beginPath();for(const T of[3,6])for(const S of[-5,-1,3])b.rect(M+T,E+C/2+S,2,2);b.fillStyle="#cccccc",b.fill(),b.beginPath(),b.globalAlpha=1}return}const{ctx:s,rect:a,hoverAmount:c,theme:u}=e,{x:g,y:m,width:f,height:d}=a,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){s.globalAlpha=h;const b=7*(n?c:1);if(Mn(s,u,n,i?g+b:g,m,i?f-b:f,d,!0,void 0,void 0,u.checkboxMaxSize,"center",r,l),i){s.globalAlpha=c,s.beginPath();for(const w of[3,6])for(const v of[-5,-1,3])s.rect(g+w,m+d/2+v,2,2);s.fillStyle=u.textLight,s.fill(),s.beginPath()}s.globalAlpha=1}if(o==="number"||o==="both"&&!n){const b=t.toString(),w=u.markerFontFull,v=g+f/2;o==="both"&&c!==0&&(s.globalAlpha=1-c),s.fillStyle=u.textLight,s.font=w,s.fillText(b,v,m+d/2+Ze(s,w)),c!==0&&(s.globalAlpha=1)}}const zs={getAccessibilityString:()=>"",kind:Ct.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Ls(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Ls(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:c,width:u,height:g}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,c+1,u,g-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let f=0;if(n!==void 0){const h=g-8,b=a+8/2,w=c+8/2;s.drawSprite(n,"normal",o,b,w,h,l,m?1:r),f=h}else{f=24;const d=12,h=m?d:r*d,b=m?0:(1-r)*d*.5,w=l.cellHorizontalPadding+4;h>0&&(o.moveTo(a+w+b,c+g/2),o.lineTo(a+w+b+h,c+g/2),o.moveTo(a+w+b+h*.5,c+g/2-h*.5),o.lineTo(a+w+b+h*.5,c+g/2+h*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,f+a+l.cellHorizontalPadding+.5,c+g/2+Ze(o,l)),o.beginPath()}function yi(e,t,n,o,i,r,l){e.textBaseline="alphabetic";const s=Ns(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),ct(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??ln(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function Ns(e,t,n,o,i){const r=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+l/2+1,width:t.width-r,height:t.height-l-1};const s=Tt(n,e,o.baseFontFull,"alphabetic"),a=t.height-l,c=Math.min(a,s.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-c)/2+1,width:s.width+r*3,height:c-1}}const Os=y.lazy(async()=>await er(()=>import("./number-overlay-editor-DQUGT01Y.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),Xs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:In,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:l}=e,{hoverEffect:s,displayData:a,hoverEffectTheme:c}=n;s===!0&&t>0&&yi(o,i,c,a,r,t,l),St(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:i}=e;return y.createElement(y.Suspense,{fallback:null},y.createElement(Os,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:i,onChange:r=>n({...o,data:Number.isNaN(r.floatValue??0)?0:r.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},Ys={getAccessibilityString:()=>"",measure:()=>108,kind:ae.Protected,needsHover:!1,needsHoverPosition:!1,draw:$s,onPaste:()=>{}};function $s(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const c=r+l/2,u=Math.cos(Mo(30))*s,g=Math.sin(Mo(30))*s;for(let m=0;m<12;m++)t.moveTo(a,c-s),t.lineTo(a,c+s),t.moveTo(a+u,c-g),t.lineTo(a-u,c+g),t.moveTo(a-u,c-g),t.lineTo(a+u,c+g),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const _s={getAccessibilityString:e=>e.rowId??"",kind:Ct.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>Tt(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:i}=e,r=o.rowId;if(!r)return;t.fillStyle=i.textDark,t.font=i.baseFontStyle,t.textAlign="left";const l=n.x+i.cellHorizontalPadding,s=n.y+n.height/2;t.fillText(r,l,s+Ze(t,i))},onClick:()=>{},onPaste:()=>{}},Us={getAccessibilityString:e=>e.rowId??"",kind:Ct.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:qs,measure:()=>80,draw:e=>js(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function qs(e,t){const{ctx:n}=e,o="12px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=Vs,n.textAlign="left",i}function Vs(e){const{ctx:t}=e;t.textAlign="start"}function js(e,t){if(!t)return;const{ctx:n,rect:o,theme:i}=e,{x:r,y:l,height:s}=o;n.fillStyle=i.textDark,n.font="12px sans-serif";const a=r+8,c=l+s/2;n.fillText(t,a,c+Ze(n,n.font))}const Ks={getAccessibilityString:e=>e.status??"",kind:Ct.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:Gs,measure:()=>40,draw:e=>Qs(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function Gs(e,t){const{ctx:n}=e,o="bold 14px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=Js,n.textAlign="center",i}function Js(e){const{ctx:t}=e;t.textAlign="start"}function Qs(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:i,y:r,width:l,height:s}=o,a={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=a[t],n.font="bold 14px sans-serif";const c=i+l/2,u=r+s/2;n.fillText(t,c,u+Ze(n,n.font))}const Zs={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:In,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:c,hoverEffect:u,allowWrapping:g,hoverEffectTheme:m}=t;u===!0&&n>0&&yi(i,l,m,a,r,n,s),St(e,a,c,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return y.createElement(so,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},el=gt("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),tl=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,[s,a]=y.useState(!i&&(t===""||o)),c=y.useCallback(()=>{a(!0)},[]);return s?y.createElement(so,{validatedSelection:r,highlight:!0,autoFocus:!0,value:t,onChange:n}):y.createElement(el,null,y.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!i&&y.createElement("div",{className:"gdg-edit-icon",onClick:c},y.createElement(eo,null)),y.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function vi(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}function qo(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=oi(l,r.baseFontFull);if(s===void 0)return!1;const a=vi(s,n,r,t.contentAlign);return $t({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)}const nl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ae.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:In,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,c=t.hoverEffect===!0;if(o!==void 0&&c&&i!==void 0&&r!==void 0){const u=Tt(a,s,n.baseFontFull),g=vi(u,l,n,t.contentAlign),{x:m,y:f,width:d,height:h}=g;if(i>=m-4&&i<=m-4+d+8&&r>=f-4&&r<=f-4+h+8){const b=Ze(s,n.baseFontFull);o("pointer");const w=5,v=f-b;s.beginPath(),s.moveTo(l.x+m,Math.floor(l.y+v+h+w)+.5),s.lineTo(l.x+m+d,Math.floor(l.y+v+h+w)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,St({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),St({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),St({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),St({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=c?n.linkColor:n.textDark,St(e,a,t.contentAlign)},onSelect:e=>{qo(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;qo(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return y.createElement(tl,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Fl=[Hs,zs,Ks,Us,as,fs,bs,xs,Cs,Ds,Xs,Ys,_s,Zs,nl],$n=[];class Bl extends li{constructor(){super(...arguments);ee(this,"imageLoaded",()=>{});ee(this,"loadedLocations",[]);ee(this,"cache",{});ee(this,"sendLoaded",Qi(()=>{this.imageLoaded(new Yt(this.loadedLocations)),this.loadedLocations=[]},20));ee(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=$n.pop()??new Image;let a=!1;const c={img:void 0,cells:[tt(o,i)],url:n,cancel:()=>{a||(a=!0,$n.length<12?$n.unshift(s):l||(s.src=""))}},u=new Promise(g=>s.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const g=this.cache[r];if(g!==void 0&&!a){g.img=s;for(const m of g.cells)this.loadedLocations.push(io(m));l=!0,this.sendLoaded()}}catch{c.cancel()}}),this.cache[r]=c}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=tt(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}export{Fl as A,Br as B,Un as C,wn as D,Rt as E,Qr as F,ae as G,xl as H,Ct as I,Jn as J,hl as K,yl as L,Cl as M,Il as N,Io as O,vl as P,El as Q,Bl as R,Sl as S,Fr as T,Lo as U,Gr as V,fl as W,tr as a,at as b,ht as c,dl as d,kl as e,bl as f,pl as g,ml as h,nr as i,Ml as j,qt as k,ln as l,Hs as m,cl as n,Vt as o,$t as p,tn as q,ul as r,No as s,ls as t,wl as u,qn as v,gl as w,fr as x,jo as y,or as z};
