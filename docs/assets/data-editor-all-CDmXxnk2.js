const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-D2cYrmn0.js","./iframe-wuTHgR8b.js","./preload-helper-C1FmrZbK.js","./index-Cl13P-xN.js","./marked.esm-semV_bLq.js","./throttle-D_inFnPf.js","./flatten-C618VRh1.js","./number-overlay-editor-B6rL0Mbq.js","./react-number-format.es-CFhYV0QZ.js"])))=>i.map(i=>d[i]);
var Us=Object.defineProperty;var Vs=(e,t,n)=>t in e?Us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var $e=(e,t,n)=>Vs(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as xt}from"./iframe-wuTHgR8b.js";import{_ as Tl}from"./preload-helper-C1FmrZbK.js";import{h as qs,g as Al,j as js,k as Zs,v as Js,l as Qs,m as ln,r as fo,t as ea}from"./throttle-D_inFnPf.js";import{u as ta,f as rl}from"./flatten-C618VRh1.js";import{s as en,a as na}from"./marked.esm-semV_bLq.js";function zl(e="This should not happen"){throw new Error(e)}function Jt(e,t="Assertion failed"){if(!e)return zl(t)}function sr(e,t){return zl(t??"Hell froze over")}function oa(e,t){try{return e()}catch{return t}}const il=Object.prototype.hasOwnProperty;function No(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&No(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(il.call(e,n)&&++o&&!il.call(t,n)||!(n in t)||!No(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Lr=null,Hi=void 0;var oe;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(oe||(oe={}));var ll;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(ll||(ll={}));var Wr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Wr||(Wr={}));function Fr(e){return"width"in e&&typeof e.width=="number"}async function sl(e){return typeof e=="object"?e:await e()}function Lo(e){return!(e.kind===oe.Loading||e.kind===oe.Bubble||e.kind===oe.RowID||e.kind===oe.Protected||e.kind===oe.Drilldown)}function Eu(e){return!(e.kind===oe.Loading||e.kind===oe.Bubble||e.kind===oe.RowID||e.kind===oe.Protected||e.kind===oe.Drilldown||e.kind===oe.Boolean||e.kind===oe.Image||e.kind===oe.Custom)}function $o(e){return e.kind===sn.Marker||e.kind===sn.NewRow}function Wo(e){if(!Lo(e)||e.kind===oe.Image)return!1;switch(e.kind){case oe.Text:case oe.Number:case oe.Markdown:case oe.Uri:case oe.Custom:case oe.Boolean:return e.readonly!==!0;default:sr(e,"A cell was passed with an invalid kind")}}function ra(e){return qs(e,"editor")}function Ti(e){return!(e.readonly??!1)}var sn;(function(e){e.NewRow="new-row",e.Marker="marker"})(sn||(sn={}));const $r={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function bi(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let al;const Vt=class Vt{constructor(t){$e(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Vt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=bi([...this.items,n]);return new Vt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[l,c]=a;if(l<=r&&o<=c){const f=[];l<o&&f.push([l,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new Vt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};$e(Vt,"create",t=>new Vt(bi(t))),$e(Vt,"empty",()=>al??(al=new Vt([]))),$e(Vt,"fromSingleSelection",t=>Vt.empty().add(t)),$e(Vt,"fromArray",t=>{if(t.length===0)return Vt.empty();const n=t.map(r=>[r,r+1]),o=bi(n);return new Vt(o)});let it=Vt;const ia=en("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Gt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,l=c=>{var f;(f=i.current)==null||f.call(a,c)};return a.addEventListener(e,l,{passive:o,capture:r}),()=>{a.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function jn(e,t){return e===void 0?void 0:t}const la=Math.PI;function cl(e){return e*la/180}const Pl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Bl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Ll=(e,t,n)=>Math.min(e,t-n*2),Wl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Ai=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},sa=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function aa(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const a=s.useRef(Al(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const ca="֑-߿יִ-﷽ﹰ-ﻼ",da="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",ua=new RegExp("^[^"+da+"]*["+ca+"]");function zi(e){return ua.test(e)?"rtl":"not-rtl"}let Hr;function Mi(){if(typeof document>"u")return 0;if(Hr!==void 0)return Hr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Hr=n-o,Hr}const uo=Symbol();function fa(e){const t=s.useRef([uo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const c=t.current[0];c!==uo&&(l=typeof l=="function"?l(c):l,l===c)||(c!==uo&&r({}),o(f=>typeof l=="function"?l(c===uo?f:c):l),t.current[0]=uo)},[]),a=s.useCallback(()=>{t.current[0]=uo,r({})},[]);return[t.current[0]===uo?n:t.current[0],i,a]}function $l(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ha(e){const t=s.useRef(e);return No(e,t.current)||(t.current=e),t.current}const ga=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const a=i.length>1;return s.createElement(ia,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(js.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(l=>{const c=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},c)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Ai,null)))},ma=en("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class wa extends xt.PureComponent{constructor(){super(...arguments);$e(this,"targetElement",null);$e(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=na(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let c=i==null?void 0:i(a);if(c===void 0){const u=document.createElement("template");u.innerHTML=a,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),xt.createElement(ma,{ref:this.containerRefHook})}}const ba=en("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),ya=en("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),pa=en("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let dl=0;const Yr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...l}=e,{onChange:c,className:f}=l,u=s.useRef(null),g=n??"";Jt(c!==void 0,"GrowingEntry must be a controlled input area");const[w]=s.useState(()=>"input-box-"+(dl=(dl+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const m=g.toString().length;h.focus(),h.setSelectionRange(r?0:m,m)},[]),s.useLayoutEffect(()=>{var h;if(a!==void 0){const m=typeof a=="number"?[a,null]:a;(h=u.current)==null||h.setSelectionRange(m[0],m[1])}},[a]);const b=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(pa,{className:"gdg-growing-entry"},s.createElement(ya,{className:f},g+`
`),s.createElement(ba,{...l,className:(f??"")+" gdg-input",id:w,ref:u,onKeyDown:b,value:g,placeholder:t,dir:"auto"}))},yi={};let Vn=null;function va(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Xo(e){const t=e.toLowerCase().trim();if(yi[t]!==void 0)return yi[t];Vn=Vn||va(),Vn.style.color="#000",Vn.style.color=t;const n=getComputedStyle(Vn).color;Vn.style.color="#fff",Vn.style.color=t;const o=getComputedStyle(Vn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),yi[t]=r,r}function go(e,t){const[n,o,r]=Xo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const ul=new Map;function fl(e,t){const n=`${e}-${t}`,o=ul.get(n);if(o!==void 0)return o;const r=Qt(e,t);return ul.set(n,r),r}function Qt(e,t){if(t===void 0)return e;const[n,o,r,i]=Xo(e);if(i===1)return e;const[a,l,c,f]=Xo(t),u=i+f*(1-i),g=(i*n+f*a*(1-i))/u,w=(i*o+f*l*(1-i))/u,b=(i*r+f*c*(1-i))/u;return`rgba(${g}, ${w}, ${b}, ${u})`}function Iu(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,a]=Xo(e),[l,c,f,u]=Xo(t),g=o*a,w=r*a,b=i*a,h=l*u,m=c*u,x=f*u,C=n,p=1-n,I=a*p+u*C;if(I===0)return"rgba(0, 0, 0, 0)";const N=Math.floor((g*p+h*C)/I),P=Math.floor((w*p+m*C)/I),A=Math.floor((b*p+x*C)/I);return`rgba(${N}, ${P}, ${A}, ${I})`}function Du(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=Xo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Ca(e,t){return xt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder})),[e,t])}function xa(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(rr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function ar(e,t){return(e??"")===(t??"")}function ka(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Ol(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function rr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Nl(e){return[e.x+e.width-1,e.y+e.height-1]}function hl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[l,c]=e;if(c<i||c>a)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Sa(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&hl(e,t,i)&&r++;for(const a of n.current.rangeStack)hl(e,t,a)&&r++;return r}function Xl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function Yo(e,t){let n=0;const o=Xl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function Jn(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Ri(e,t,n,o,r){const i=Xl(e,o),a=[];for(const f of i)if(f.sticky)a.push(f);else break;if(a.length>0)for(const f of a)n-=f.width;let l=t,c=r??0;for(;c<=n&&l<i.length;)c+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||a.push(u)}return a}function Ma(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Ra(e,t,n,o,r,i,a,l,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let g=t;for(let h=0;h<f;h++){const m=i-1-h,x=typeof a=="number"?a:a(m);if(g-=x,e>=g)return m}const w=i-f,b=e-(c??0);if(typeof a=="number"){const h=Math.floor((b-u)/a)+l;return h>=w?void 0:h}else{let h=u;for(let m=l;m<w;m++){const x=a(m);if(b<=h+x)return m;h+=x}return}}let Br=0,ir={};const Ea=typeof window>"u";async function Ia(){var e;Ea||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Br=0,ir={},Js())}Ia();function Yl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Go(e,t,n,o="middle"){const r=Yl(e,t,o,n);let i=ir[r];return i===void 0&&(i=t.measureText(e),ir[r]=i,Br++),Br>1e4&&(ir={},Br=0),i}function Gl(e,t){const n=Yl(e,void 0,"middle",t);return ir[n]}function Qn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Da(e,t)}function gl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const ml=[];function Da(e,t){for(const i of ml)if(i.key===t)return i.val;const n=gl(e,"alphabetic"),r=-(gl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return ml.push({key:t,val:r}),r}function Fa(e,t,n,o,r,i){const{ctx:a,rect:l,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const g=1-f/u;a.globalAlpha=g,a.fillStyle=c.bgSearchResult,a.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function dr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function Fu(e,t,n,o,r){const{rect:i,ctx:a,theme:l}=e;a.fillStyle=l.textDark,Sn({ctx:a,rect:i,theme:l},t,n,o,r)}function _l(e,t,n,o,r,i,a,l,c){c==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+a):c==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+a)}function Kl(e,t){const n=Go("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Ha(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Ta(e,t,n,o,r,i,a,l,c,f){const u=l.baseFontFull,g=Zs(e,t,u,r-l.cellHorizontalPadding*2,f??!1),w=Kl(e,u),b=l.lineHeight*w,h=w+b*(g.length-1),m=h+l.cellVerticalPadding>i;m&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let C=Math.max(o+l.cellVerticalPadding,x);for(const p of g)if(_l(e,p,n,C,r,w,a,l,c),C+=b,C>o+i)break;m&&e.restore()}function Sn(e,t,n,o,r){const{ctx:i,rect:a,theme:l}=e,{x:c,y:f,width:u,height:g}=a;o=o??!1,o||(t=Ha(t,u));const w=Qn(i,l),b=zi(t)==="rtl";if(n===void 0&&b&&(n="right"),b&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Ta(i,t,c,f,u,g,w,l,n,r):_l(i,t,c,f,u,g,w,l,n),h&&(i.textAlign="start"),b&&(i.direction="inherit")}}function Mn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Aa(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function za(e,t,n){const o=function(l,c){const f=c.x-l.x,u=c.y-l.y,g=Math.sqrt(f*f+u*u),w=f/g,b=u/g;return{x:f,y:c.y-l.y,len:g,nx:w,ny:b,ang:Math.atan2(b,w)}};let r;const i=t.length;let a=t[i-1];for(let l=0;l<i;l++){let c=t[l%i];const f=t[(l+1)%i],u=o(c,a),g=o(c,f),w=u.nx*g.ny-u.ny*g.nx,b=u.nx*g.nx-u.ny*-g.ny;let h=Math.asin(w<-1?-1:w>1?1:w),m=1,x=!1;b<0?h<0?h=Math.PI+h:(h=Math.PI-h,m=-1,x=!0):h>0&&(m=-1,x=!0),r=c.radius!==void 0?c.radius:n;const C=h/2;let p=Math.abs(Math.cos(C)*r/Math.sin(C)),I;p>Math.min(u.len/2,g.len/2)?(p=Math.min(u.len/2,g.len/2),I=Math.abs(p*Math.sin(C)/Math.cos(C))):I=r;let N=c.x+g.nx*p,P=c.y+g.ny*p;N+=-g.ny*I*m,P+=g.nx*I*m,e.arc(N,P,I,u.ang+Math.PI/2*m,g.ang-Math.PI/2*m,x),a=c,c=f}e.closePath()}function Ei(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h){const m={x:0,y:i+f,width:0,height:0};if(e>=b.length||t>=u||t<-2||e<0)return m;const x=i-r;if(e>=g){const C=a>e?-1:1,p=Yo(b);m.x+=p+c;for(let I=a;I!==e;I+=C)m.x+=b[C===1?I:I-1].width*C}else for(let C=0;C<e;C++)m.x+=b[C].width;if(m.width=b[e].width+1,t===-1)m.y=r,m.height=x;else if(t===-2){m.y=0,m.height=r;let C=e;const p=b[e].group,I=b[e].sticky;for(;C>0&&ar(b[C-1].group,p)&&b[C-1].sticky===I;){const P=b[C-1];m.x-=P.width,m.width+=P.width,C--}let N=e;for(;N+1<b.length&&ar(b[N+1].group,p)&&b[N+1].sticky===I;){const P=b[N+1];m.width+=P.width,N++}if(!I){const P=Yo(b),A=m.x-P;A<0&&(m.x-=A,m.width+=A),m.x+m.width>n&&(m.width=n-m.x)}}else if(t>=u-w){let C=u-t;for(m.y=o;C>0;){const p=t+C-1;m.height=typeof h=="number"?h:h(p),m.y-=m.height,C--}m.height+=1}else{const C=l>t?-1:1;if(typeof h=="number"){const p=t-l;m.y+=p*h}else for(let p=l;p!==t;p+=C)m.y+=h(p)*C;m.height=(typeof h=="number"?h:h(t))+1}return m}const Pi=1<<21;function bn(e,t){return(t+2)*Pi+e}function Ul(e){return e%Pi}function Bi(e){return Math.floor(e/Pi)-2}function Li(e){const t=Ul(e),n=Bi(e);return[t,n]}class Vl{constructor(){$e(this,"visibleWindow",{x:0,y:0,width:0,height:0});$e(this,"freezeCols",0);$e(this,"freezeRows",[]);$e(this,"isInWindow",t=>{const n=Ul(t),o=Bi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&No(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Pa extends Vl{constructor(){super(...arguments);$e(this,"cache",new Map);$e(this,"setValue",(n,o)=>{this.cache.set(bn(n[0],n[1]),o)});$e(this,"getValue",n=>this.cache.get(bn(n[0],n[1])));$e(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class lr{constructor(t=[]){$e(this,"cells");this.cells=new Set(t.map(n=>bn(n[0],n[1])))}add(t){this.cells.add(bn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(bn(t[0],t[1]))}remove(t){this.cells.delete(bn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Bi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(bn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Li(t)}}function Ba(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const ql={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function jl(){return ql}const Zl=xt.createContext(ql);function Hu(){return xt.useContext(Zl)}function Bn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=Qt(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Ii=150;function La(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Ii}function Jl(e,t,n,o,r,i,a,l,c){let f=0;const u=r===void 0?[]:r.map(b=>{const h=La(e,b[o],t,c);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let b=0;for(const m of u)b+=m;const h=b/u.length;for(let m=0;m<u.length;m++)u[m]>=h*2?u[m]=0:f=Math.max(f,u[m])}const g=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=g;const w=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(f)));return{...n,width:w}}function Wa(e,t,n,o,r,i,a,l,c){const f=s.useRef(t),u=s.useRef(n),g=s.useRef(a);f.current=t,u.current=n,g.current=a;const[w,b]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const p=document.createElement("canvas");return p.style.display="none",p.style.opacity="0",p.style.position="fixed",[p,p.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(w&&document.documentElement.append(w),()=>{w==null||w.remove()}),[w]);const h=s.useRef({}),m=s.useRef(),[x,C]=s.useState();return s.useLayoutEffect(()=>{const p=u.current;if(p===void 0||e.every(Fr))return;let I=Math.max(1,10-Math.floor(e.length/1e4)),N=0;I<f.current&&I>1&&(I--,N=1);const P={x:0,y:0,width:e.length,height:Math.min(f.current,I)},A={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const K=p(P,c.signal),R=N>0?p(A,c.signal):void 0;let O;typeof K=="object"?O=K:O=await sl(K),R!==void 0&&(typeof R=="object"?O=[...O,...R]:O=[...O,...await sl(R)]),m.current=e,C(O)})()},[c.signal,e]),s.useMemo(()=>{let I=e.every(Fr)?e:b===null?e.map(L=>Fr(L)?L:{...L,width:Ii}):(b.font=g.current.baseFontFull,e.map((L,K)=>{if(Fr(L))return L;if(h.current[L.id]!==void 0)return{...L,width:h.current[L.id]};if(x===void 0||m.current!==e||L.id===void 0)return{...L,width:Ii};const R=Jl(b,a,L,K,x,r,i,!0,l);return h.current[L.id]=R.width,R})),N=0,P=0;const A=[];for(const[L,K]of I.entries())N+=K.width,K.grow!==void 0&&K.grow>0&&(P+=K.grow,A.push(L));if(N<o&&A.length>0){const L=[...I],K=o-N;let R=K;for(let O=0;O<A.length;O++){const $=A[O],Y=(I[$].grow??0)/P,E=O===A.length-1?R:Math.min(R,Math.floor(K*Y));L[$]={...I[$],growOffset:E,width:I[$].width+E},R-=E}I=L}return{sizedColumns:I,nonGrowWidth:N}},[o,e,b,x,a,r,i,l])}const yt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',$a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Oa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Na=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Ql=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Ga=e=>{const t=e.bgColor;return`${yt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},_a=Ql,Ka=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${yt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`${yt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},uc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},fc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},hc={headerRowID:$a,headerNumber:Na,headerCode:Oa,headerString:Xa,headerBoolean:Ya,headerAudioUri:_a,headerVideoUri:Ka,headerEmoji:Ua,headerImage:Va,headerUri:Ql,headerPhone:qa,headerMarkdown:ja,headerDate:Za,headerTime:Ja,headerEmail:Qa,headerReference:ec,headerIfThenElse:tc,headerSingleValue:nc,headerLookup:oc,headerTextTemplate:rc,headerMath:ic,headerRollup:lc,headerJoinStrings:sc,headerSplitString:ac,headerGeoDistance:cc,headerArray:dc,rowOwnerOverlay:uc,protectedColumnOverlay:fc,renameIcon:Ga};function gc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class mc{constructor(t,n){$e(this,"onSettled");$e(this,"spriteMap",new Map);$e(this,"headerIcons");$e(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,l,c=1){const[f,u]=gc(n,l),g=a*Math.ceil(window.devicePixelRatio),w=`${f}_${u}_${g}_${t}`;let b=this.spriteMap.get(w);if(b===void 0){const h=this.headerIcons[t];if(h===void 0)return;b=document.createElement("canvas");const m=b.getContext("2d");if(m===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(w,b);const C=x.decode();if(C===void 0)return;this.inFlight++,C.then(()=>{m.drawImage(x,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(b,0,0,g,g,r,i,a,a),c<1&&(o.globalAlpha=1)}}function es(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Gr(e,t,n,o,r,i,a,l,c){l=l??t;let f=t,u=e;const g=o-i;let w=!1;for(;f<n&&u<g;){const b=r(u);if(f+b>l&&c(f,u,b,!1,a&&u===o-1)===!0){w=!0;break}f+=b,u++}if(!w){f=n;for(let b=0;b<i;b++){u=o-1-b;const h=r(u);f-=h,c(f,u,h,!0,a&&u===o-1)}}}function eo(e,t,n,o,r,i){let a=0,l=0;const c=r+o;for(const f of e){const u=f.sticky?l:a+n;if(i(f,u,c,f.sticky?0:l,t)===!0)break;a+=f.width,l+=f.sticky?f.width:0}}function ts(e,t,n,o,r){let i=0,a=0;for(let l=0;l<e.length;l++){const c=e[l];let f=l+1,u=c.width;for(c.sticky&&(a+=u);f<e.length&&ar(e[f].group,c.group)&&e[f].sticky===e[l].sticky;){const m=e[f];u+=m.width,f++,l++,m.sticky&&(a+=m.width)}const g=c.sticky?0:n,w=i+g,b=c.sticky?0:Math.max(0,a-w),h=Math.min(u-b,t-(w+b));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",w+b,0,h,o),i+=u}}function ns(e,t,n,o,r,i,a){var w;const[l,c]=e;let f,u;const g=((w=a.find(b=>!b.sticky))==null?void 0:w.sourceIndex)??0;if(c>g){const b=Math.max(l,g);let h=t,m=o;for(let x=i.sourceIndex-1;x>=b;x--)h-=a[x].width,m+=a[x].width;for(let x=i.sourceIndex+1;x<=c;x++)m+=a[x].width;u={x:h,y:n,width:m,height:r}}if(g>l){const b=Math.min(c,g-1);let h=t,m=o;for(let x=i.sourceIndex-1;x>=l;x--)h-=a[x].width,m+=a[x].width;for(let x=i.sourceIndex+1;x<=b;x++)m+=a[x].width;f={x:h,y:n,width:m,height:r}}return[f,u]}function wc(e,t,n,o){if(o==="any")return os(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Ol([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,l=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return c===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===a?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function cr(e,t,n,o,r,i,a,l){return e<=r+a&&r<=e+n&&t<=i+l&&i<=t+o}function ho(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function os(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function bc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function yc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,l=n+4,c=r-e.x,f=e.x+e.width-a,u=i-e.y,g=e.y+e.height-l,w=c>0?e.x+Math.floor(c/o)*o:e.x,b=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,m=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:w,y:h,width:b-w,height:m-h}}function pc(e,t,n,o,r){const[i,a,l,c]=t,[f,u,g,w]=r,{x:b,y:h,width:m,height:x}=e,C=[];if(m<=0||x<=0)return C;const p=b+m,I=h+x,N=b<i,P=h<a,A=b+m>l,L=h+x>c,K=b>=i&&b<l||p>i&&p<=l||b<i&&p>l,R=h>=a&&h<c||I>a&&I<=c||h<a&&I>c;if(K&&R){const $=Math.max(b,i),Y=Math.max(h,a),E=Math.min(p,l),M=Math.min(I,c);C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:f,y:u,width:g-f+1,height:w-u+1}})}if(N&&P){const $=b,Y=h,E=Math.min(p,i),M=Math.min(I,a);C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:0,y:0,width:f+1,height:u+1}})}if(P&&K){const $=Math.max(b,i),Y=h,E=Math.min(p,l),M=Math.min(I,a);C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:f,y:0,width:g-f+1,height:u+1}})}if(P&&A){const $=Math.max(b,l),Y=h,E=p,M=Math.min(I,a);C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(N&&R){const $=b,Y=Math.max(h,a),E=Math.min(p,i),M=Math.min(I,c);C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:0,y:u,width:f+1,height:w-u+1}})}if(A&&R){const $=Math.max(b,l),Y=Math.max(h,a),E=p,M=Math.min(I,c);C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:g,y:u,width:n-g+1,height:w-u+1}})}if(N&&L){const $=b,Y=Math.max(h,c),E=Math.min(p,i),M=I;C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:0,y:w,width:f+1,height:o-w+1}})}if(L&&K){const $=Math.max(b,i),Y=Math.max(h,c),E=Math.min(p,l),M=I;C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:f,y:w,width:g-f+1,height:o-w+1}})}if(A&&L){const $=Math.max(b,l),Y=Math.max(h,c),E=p,M=I;C.push({rect:{x:$,y:Y,width:E-$,height:M-Y},clip:{x:g,y:w,width:n-g+1,height:o-w+1}})}return C}const vc={kind:oe.Loading,allowOverlay:!1};function wl(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m,x,C,p,I,N,P,A,L,K,R,O,$,Y,E,M,ie,q,J,Ce){let de=(I==null?void 0:I.size)??Number.MAX_SAFE_INTEGER;const j=performance.now();let G=E.baseFontFull;e.font=G;const se={ctx:e},Z=[0,0],ce=x>0?Jn(c,x,f):0;let De,U;const re=es(p);return eo(t,l,i,a,r,(ge,Le,Xe,tt,st)=>{const Re=Math.max(0,tt-Le),Ae=Le+Re,Fe=r+1,ht=ge.width-Re,gt=o-r-1;if(p.length>0){let je=!1;for(let Ye=0;Ye<p.length;Ye++){const Ze=p[Ye];if(cr(Ae,Fe,ht,gt,Ze.x,Ze.y,Ze.width,Ze.height)){je=!0;break}}if(!je)return}const dt=()=>{e.save(),e.beginPath(),e.rect(Ae,Fe,ht,gt),e.clip()},Q=N.columns.hasIndex(ge.sourceIndex),me=g(ge.group??"").overrideTheme,ke=ge.themeOverride===void 0&&me===void 0?E:Bn(E,me,ge.themeOverride),Ee=ke.baseFontFull;Ee!==G&&(G=Ee,e.font=Ee),dt();let be;return Gr(st,Xe,o,c,f,x,C,re,(je,Ye,Ze,le,ye)=>{var Ke,Ht,qt;if(Ye<0||(Z[0]=ge.sourceIndex,Z[1]=Ye,I!==void 0&&!I.has(Z)))return;if(p.length>0){let et=!1;for(let Dt=0;Dt<p.length;Dt++){const at=p[Dt];if(cr(Le,je,ge.width,Ze,at.x,at.y,at.width,at.height)){et=!0;break}}if(!et)return}const Ge=N.rows.hasIndex(Ye),_e=b.hasIndex(Ye),Qe=Ye<c?u(Z):vc;let mt=Le,ot=ge.width,Pe=!1,kt=!1;if(Qe.span!==void 0){const[et,Dt]=Qe.span,at=`${Ye},${et},${Dt},${ge.sticky}`;if(U===void 0&&(U=new Set),U.has(at)){de--;return}else{const tn=ns(Qe.span,Le,je,ge.width,Ze,ge,n),Nt=ge.sticky?tn[0]:tn[1];if(!ge.sticky&&tn[0]!==void 0&&(kt=!0),Nt!==void 0){mt=Nt.x,ot=Nt.width,U.add(at),e.restore(),be=void 0,e.save(),e.beginPath();const Kt=Math.max(0,tt-Nt.x);e.rect(Nt.x+Kt,je,Nt.width-Kt,Ze),De===void 0&&(De=[]),De.push({x:Nt.x+Kt,y:je,width:Nt.width-Kt,height:Ze}),e.clip(),Pe=!0}}}const Ft=w==null?void 0:w(Ye),Lt=ye&&((Ke=ge.trailingRowOptions)==null?void 0:Ke.themeOverride)!==void 0?(Ht=ge.trailingRowOptions)==null?void 0:Ht.themeOverride:void 0,vt=Qe.themeOverride===void 0&&Ft===void 0&&Lt===void 0?ke:Bn(ke,Ft,Lt,Qe.themeOverride);e.beginPath();const It=ka(Z,Qe,N);let Bt=Sa(Z,Qe,N,m);const an=Qe.span!==void 0&&N.columns.some(et=>Qe.span!==void 0&&et>=Qe.span[0]&&et<=Qe.span[1]);It&&!h&&m?Bt=0:It&&m&&(Bt=Math.max(Bt,1)),an&&Bt++,It||(Ge&&Bt++,Q&&!ye&&Bt++);const _t=Qe.kind===oe.Protected?vt.bgCellMedium:vt.bgCell;let lt;if((le||_t!==E.bgCell)&&(lt=Qt(_t,lt)),Bt>0||_e){_e&&(lt=Qt(vt.bgHeader,lt));for(let et=0;et<Bt;et++)lt=Qt(vt.accentLight,lt)}else if(P!==void 0){for(const et of P)if(et[0]===ge.sourceIndex&&et[1]===Ye){lt=Qt(vt.bgSearchResult,lt);break}}if(A!==void 0)for(let et=0;et<A.length;et++){const Dt=A[et],at=Dt.range;Dt.style!=="solid-outline"&&at.x<=ge.sourceIndex&&ge.sourceIndex<at.x+at.width&&at.y<=Ye&&Ye<at.y+at.height&&(lt=Qt(Dt.color,lt))}let Rn=!1;if(I!==void 0){const et=je+1,at=(le?et+Ze-1:Math.min(et+Ze-1,o-ce))-et;(at!==Ze-1||mt+1<=tt)&&(Rn=!0,e.save(),e.beginPath(),e.rect(mt+1,et,ot-1,at),e.clip()),lt=lt===void 0?vt.bgCell:Qt(lt,vt.bgCell)}const cn=ge.sourceIndex===n.length-1,wt=Ye===c-1;lt!==void 0&&(e.fillStyle=lt,be!==void 0&&(be.fillStyle=lt),I!==void 0?e.fillRect(mt+1,je+1,ot-(cn?2:1),Ze-(wt?2:1)):e.fillRect(mt,je,ot,Ze)),Qe.style==="faded"&&(e.globalAlpha=.6);let Wt;for(let et=0;et<R.length;et++){const Dt=R[et];if(Dt.item[0]===ge.sourceIndex&&Dt.item[1]===Ye){Wt=Dt;break}}if(ot>Ce&&!kt){const et=vt.baseFontFull;et!==G&&(e.font=et,G=et),be=rs(e,Qe,ge.sourceIndex,Ye,cn,wt,mt,je,ot,Ze,Bt>0,vt,lt??vt.bgCell,L,K,(Wt==null?void 0:Wt.hoverAmount)??0,O,Y,j,$,be,M,ie,q,J)}return Rn&&e.restore(),Qe.style==="faded"&&(e.globalAlpha=1),de--,Pe&&(e.restore(),(qt=be==null?void 0:be.deprep)==null||qt.call(be,se),be=void 0,dt(),G=Ee,e.font=Ee),de<=0}),e.restore(),de<=0}),De}const er=[0,0],tr={x:0,y:0,width:0,height:0},pi=[void 0,()=>{}];let Di=!1;function Cc(){Di=!0}function rs(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m,x,C,p,I,N,P,A,L,K){var ie,q;let R,O;x!==void 0&&x[0][0]===n&&x[0][1]===o&&(R=x[1][0],O=x[1][1]);let $;er[0]=n,er[1]=o,tr.x=a,tr.y=l,tr.width=c,tr.height=f,pi[0]=A.getValue(er),pi[1]=J=>A.setValue(er,J),Di=!1;const Y={ctx:e,theme:g,col:n,row:o,cell:t,rect:tr,highlighted:u,cellFillColor:w,hoverAmount:m,frameTime:p,hoverX:R,drawState:pi,hoverY:O,imageLoader:b,spriteManager:h,hyperWrapping:C,overrideCursor:R!==void 0?K:void 0,requestAnimationFrame:Cc},E=Fa(Y,t.lastUpdated,p,N,r,i),M=L(t);if(M!==void 0){(N==null?void 0:N.renderer)!==M&&((ie=N==null?void 0:N.deprep)==null||ie.call(N,Y),N=void 0);const J=(q=M.drawPrep)==null?void 0:q.call(M,Y,N);I!==void 0&&!$o(Y.cell)?I(Y,()=>M.draw(Y,t)):M.draw(Y,t),$=J===void 0?void 0:{deprep:J==null?void 0:J.deprep,fillStyle:J==null?void 0:J.fillStyle,font:J==null?void 0:J.font,renderer:M}}return(E||Di)&&(P==null||P(er)),$}function Wi(e,t,n,o,r,i,a,l,c=-20,f=-20,u=void 0,g="center",w="square"){const b=Math.floor(r+a/2),h=w==="circle"?1e4:t.roundingRadius??4;let m=Ll(u??t.checkboxMaxSize,a,t.cellVerticalPadding),x=m/2;const C=Bl(g,o,i,t.cellHorizontalPadding,m),p=Pl(C,b,m),I=Wl(o+c,r+f,p);switch(n){case!0:{e.beginPath(),Mn(e,C-m/2,b-m/2,m,m,h),w==="circle"&&(x*=.8,m*=.8),e.fillStyle=l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(C-x+m/4.23,b-x+m/1.97),e.lineTo(C-x+m/2.42,b-x+m/1.44),e.lineTo(C-x+m/1.29,b-x+m/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Lr:case!1:{e.beginPath(),Mn(e,C-m/2+.5,b-m/2+.5,m-1,m-1,h),e.lineWidth=1,e.strokeStyle=I?t.textDark:t.textMedium,e.stroke();break}case Hi:{e.beginPath(),Mn(e,C-m/2,b-m/2,m,m,h),e.fillStyle=I?t.textMedium:t.textLight,e.fill(),w==="circle"&&(x*=.8,m*=.8),e.beginPath(),e.moveTo(C-m/3,b),e.lineTo(C+m/3,b),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:sr()}}function xc(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m,x,C,p){var R,O,$,Y;const I=a+l;if(I<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,r,I);const N=(R=o==null?void 0:o[0])==null?void 0:R[0],P=(O=o==null?void 0:o[0])==null?void 0:O[1],A=($=o==null?void 0:o[1])==null?void 0:$[0],L=(Y=o==null?void 0:o[1])==null?void 0:Y[1],K=g.headerFontFull;e.font=K,eo(t,0,i,0,I,(E,M,ie,q)=>{var ge;if(x!==void 0&&!x.has([E.sourceIndex,-1]))return;const J=Math.max(0,q-M);e.save(),e.beginPath(),e.rect(M+J,l,E.width-J,a),e.clip();const Ce=m(E.group??"").overrideTheme,de=E.themeOverride===void 0&&Ce===void 0?g:Bn(g,Ce,E.themeOverride);de.bgHeader!==g.bgHeader&&(e.fillStyle=de.bgHeader,e.fill()),de!==g&&(e.font=de.headerFontFull);const j=u.columns.hasIndex(E.sourceIndex),G=c!==void 0||f||E.headerRowMarkerDisabled===!0,se=!G&&P===-1&&N===E.sourceIndex,Z=G?0:((ge=b.find(Le=>Le.item[0]===E.sourceIndex&&Le.item[1]===-1))==null?void 0:ge.hoverAmount)??0,ce=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===E.sourceIndex,De=j?de.accentColor:ce?de.bgHeaderHasFocus:de.bgHeader,U=n?l:0,re=E.sourceIndex===0?0:1;j?(e.fillStyle=De,e.fillRect(M+re,U,E.width-re,a)):(ce||Z>0)&&(e.beginPath(),e.rect(M+re,U,E.width-re,a),ce&&(e.fillStyle=de.bgHeaderHasFocus,e.fill()),Z>0&&(e.globalAlpha=Z,e.fillStyle=de.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ss(e,M,U,E.width,a,E,j,de,se,se?A:void 0,se?L:void 0,ce,Z,w,C,p),e.restore()}),n&&kc(e,t,r,i,l,o,g,w,b,h,m,x)}function kc(e,t,n,o,r,i,a,l,c,f,u,g){const[b,h]=(i==null?void 0:i[0])??[];let m=0;ts(t,n,o,r,(x,C,p,I,N,P)=>{if(g!==void 0&&!g.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(p,I,N,P),e.clip();const A=u(C),L=(A==null?void 0:A.overrideTheme)===void 0?a:Bn(a,A.overrideTheme),K=h===-2&&b!==void 0&&b>=x[0]&&b<=x[1],R=K?L.bgGroupHeaderHovered??L.bgHeaderHovered:L.bgGroupHeader??L.bgHeader;if(R!==a.bgHeader&&(e.fillStyle=R,e.fill()),e.fillStyle=L.textGroupHeader??L.textHeader,A!==void 0){let O=p;if(A.icon!==void 0&&(l.drawSprite(A.icon,"normal",e,O+8,(r-20)/2,20,L),O+=26),e.fillText(A.name,O+8,r/2+Qn(e,a.headerFontFull)),A.actions!==void 0&&K){const $=is({x:p,y:I,width:N,height:P},A.actions);e.beginPath();const Y=$[0].x-10,E=p+N-Y;e.rect(Y,0,E,r);const M=e.createLinearGradient(Y,0,Y+E,0),ie=go(R,0);M.addColorStop(0,ie),M.addColorStop(10/E,R),M.addColorStop(1,R),e.fillStyle=M,e.fill(),e.globalAlpha=.6;const[q,J]=(i==null?void 0:i[1])??[-1,-1];for(let Ce=0;Ce<A.actions.length;Ce++){const de=A.actions[Ce],j=$[Ce],G=ho(j,q+p,J);G&&(e.globalAlpha=1),l.drawSprite(de.icon,"normal",e,j.x+j.width/2-10,j.y+j.height/2-10,20,L),G&&(e.globalAlpha=.6)}e.globalAlpha=1}}p!==0&&f(x[0])&&(e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),m=p+N}),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const Tr=30;function Sc(e,t,n,o,r){return{x:e+n-Tr,y:Math.max(t,t+o/2-Tr/2),width:Tr,height:Math.min(Tr,o)}}function is(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function nr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ls(e,t,n,o,r,i,a,l){var C;const c=a.cellHorizontalPadding,f=a.headerIconSize,u=Sc(n,o,r,i);let g=n+c;const w=t.icon===void 0?void 0:{x:g,y:o+(i-f)/2,width:f,height:f},b=w===void 0||t.overlayIcon===void 0?void 0:{x:w.x+9,y:w.y+6,width:18,height:18};w!==void 0&&(g+=Math.ceil(f*1.3));const h={x:g,y:o,width:r-g,height:i};let m;if(t.indicatorIcon!==void 0){const p=e===void 0?((C=Gl(t.title,a.headerFontFull))==null?void 0:C.width)??0:Go(t.title,e,a.headerFontFull).width;h.width=p,g+=p+c,m={x:g,y:o+(i-f)/2,width:f,height:f}}const x=n+r/2;return{menuBounds:nr(u,x,l),iconBounds:nr(w,x,l),iconOverlayBounds:nr(b,x,l),textBounds:nr(h,x,l),indicatorIconBounds:nr(m,x,l)}}function bl(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const p=i.rowMarkerChecked;p!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const I=i.headerRowMarkerTheme!==void 0?Bn(l,i.headerRowMarkerTheme):l;Wi(e,I,p,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),p!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=a?l.textHeaderSelected:l.textHeader,C=i.hasMenu===!0&&(c||b&&a)&&m.menuBounds!==void 0;if(i.icon!==void 0&&m.iconBounds!==void 0){let p=a?"selected":"normal";i.style==="highlight"&&(p=a?"selected":"special"),w.drawSprite(i.icon,p,e,m.iconBounds.x,m.iconBounds.y,m.iconBounds.width,l),i.overlayIcon!==void 0&&m.iconOverlayBounds!==void 0&&w.drawSprite(i.overlayIcon,a?"selected":"special",e,m.iconOverlayBounds.x,m.iconOverlayBounds.y,m.iconOverlayBounds.width,l)}if(C&&o>35){const I=h?35:o-35,N=h?35*.7:o-35*.7,P=I/o,A=N/o,L=e.createLinearGradient(t,0,t+o,0),K=go(x,0);L.addColorStop(h?1:0,x),L.addColorStop(P,x),L.addColorStop(A,K),L.addColorStop(h?0:1,K),e.fillStyle=L}else e.fillStyle=x;if(h&&(e.textAlign="right"),m.textBounds!==void 0&&e.fillText(i.title,h?m.textBounds.x+m.textBounds.width:m.textBounds.x,n+r/2+Qn(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&m.indicatorIconBounds!==void 0&&(!C||!cr(m.menuBounds.x,m.menuBounds.y,m.menuBounds.width,m.menuBounds.height,m.indicatorIconBounds.x,m.indicatorIconBounds.y,m.indicatorIconBounds.width,m.indicatorIconBounds.height))){let p=a?"selected":"normal";i.style==="highlight"&&(p=a?"selected":"special"),w.drawSprite(i.indicatorIcon,p,e,m.indicatorIconBounds.x,m.indicatorIconBounds.y,m.indicatorIconBounds.width,l)}if(C&&m.menuBounds!==void 0){const p=m.menuBounds,I=f!==void 0&&u!==void 0&&ho(p,f+t,u+n);if(I||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Wr.Triangle){e.beginPath();const N=p.x+p.width/2-5.5,P=p.y+p.height/2-3;za(e,[{x:N,y:P},{x:N+11,y:P},{x:N+5.5,y:P+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===Wr.Dots){e.beginPath();const N=p.x+p.width/2,P=p.y+p.height/2;Aa(e,N,P),e.fillStyle=x,e.fill()}else{const N=p.x+(p.width-l.headerIconSize)/2,P=p.y+(p.height-l.headerIconSize)/2;w.drawSprite(i.menuIcon,"normal",e,N,P,l.headerIconSize,l)}I||(e.globalAlpha=1)}}function ss(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m){const x=zi(i.title)==="rtl",C=ls(e,i,t,n,o,r,l,x);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:w,isHovered:c,hasSelectedCell:g,spriteManager:b,menuBounds:(C==null?void 0:C.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>bl(e,t,n,o,r,i,a,l,c,f,u,w,b,m,x,C)):bl(e,t,n,o,r,i,a,l,c,f,u,w,b,m,x,C)}function Mc(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m,x,C,p){if(C!==void 0||t[t.length-1]!==n[t.length-1])return;const I=es(x);eo(t,c,a,l,i,(N,P,A,L,K)=>{if(N!==t[t.length-1])return;P+=N.width;const R=Math.max(P,L);R>o||(e.save(),e.beginPath(),e.rect(R,i+1,1e4,r-i-1),e.clip(),Gr(K,A,r,f,u,h,m,I,(O,$,Y,E)=>{if(!E&&x.length>0&&!x.some(Ce=>cr(P,O,1e4,Y,Ce.x,Ce.y,Ce.width,Ce.height)))return;const M=w.hasIndex($),ie=b.hasIndex($);e.beginPath();const q=g==null?void 0:g($),J=q===void 0?p:Bn(p,q);J.bgCell!==p.bgCell&&(e.fillStyle=J.bgCell,e.fillRect(P,O,1e4,Y)),ie&&(e.fillStyle=J.bgHeader,e.fillRect(P,O,1e4,Y)),M&&(e.fillStyle=J.accentLight,e.fillRect(P,O,1e4,Y))}),e.restore())})}function Rc(e,t,n,o,r,i,a,l,c){let f=!1;for(const h of t)if(!h.sticky){f=a(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,g=c.borderColor,w=f?Yo(t):0;let b;if(w!==0&&(b=fl(g,c.bgCell),e.beginPath(),e.moveTo(w+.5,0),e.lineTo(w+.5,o),e.strokeStyle=b,e.stroke()),r>0){const h=g===u&&b!==void 0?b:fl(u,c.bgCell),m=Jn(i,r,l);e.beginPath(),e.moveTo(0,o-m+.5),e.lineTo(n,o-m+.5),e.strokeStyle=h,e.stroke()}}const as=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),a=Math.max(a,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function Ec(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h){var Y;const m=h.bgCell,{minX:x,maxX:C,minY:p,maxY:I}=as(l,i,a),N=[],P=a-Jn(b,w,f);let A=c,L=n,K=0;for(;A+r<P;){const E=A+r,M=f(L);if(E>=p&&E<=I-1){const ie=u==null?void 0:u(L),q=ie==null?void 0:ie.bgCell;q!==void 0&&q!==m&&L>=b-w&&N.push({x,y:E,w:C-x,h:M,color:q})}A+=M,L<b-w&&(K=A),L++}let R=0;const O=Math.min(P,I)-K;if(O>0)for(let E=0;E<t.length;E++){const M=t[E];if(M.width===0)continue;const ie=M.sticky?R:R+o,q=(Y=M.themeOverride)==null?void 0:Y.bgCell;q!==void 0&&q!==m&&ie>=x&&ie<=C&&g(E+1)&&N.push({x:ie,y:K,w:M.width,h:O,color:q}),R+=M.width}if(N.length===0)return;let $;e.beginPath();for(let E=N.length-1;E>=0;E--){const M=N[E];$===void 0?$=M.color:M.color!==$&&(e.fillStyle=$,e.fill(),e.beginPath(),$=M.color),e.rect(M.x,M.y,M.w,M.h)}$!==void 0&&(e.fillStyle=$,e.fill()),e.beginPath()}function yl(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m,x,C=!1,p){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const E of c)e.rect(E.x+1,E.y+1,E.width-1,E.height-1);e.clip("evenodd")}const I=x.horizontalBorderColor??x.borderColor,N=x.borderColor,{minX:P,maxX:A,minY:L,maxY:K}=as(l,i,a),R=[];e.beginPath();let O=.5;for(let E=0;E<t.length;E++){const M=t[E];if(M.width===0)continue;O+=M.width;const ie=M.sticky?O:O+o;if(ie>=P&&ie<=A&&b(E+1))if(p){let q=u+.5,J=n;const Ce=a-Jn(m,h,g);for(;q+r<Ce&&J<m;){const j=q+r,G=g(J);if(j>=L&&j<=K-1){const se=p([M.sourceIndex,J]),Z=E<t.length-1?p([t[E+1].sourceIndex,J]):void 0;(se==null?void 0:se.borderRight)!==!1&&(Z==null?void 0:Z.borderLeft)!==!1&&R.push({x1:ie,y1:j,x2:ie,y2:j+G,color:N})}q+=G,J++}let de=a+.5;for(let j=m-h;j<m;j++){const G=g(j);de-=G;const se=p([M.sourceIndex,j]),Z=E<t.length-1?p([t[E+1].sourceIndex,j]):void 0;(se==null?void 0:se.borderRight)!==!1&&(Z==null?void 0:Z.borderLeft)!==!1&&R.push({x1:ie,y1:de,x2:ie,y2:de+G,color:N})}}else R.push({x1:ie,y1:Math.max(f,L),x2:ie,y2:Math.min(a,K),color:N})}let $=a+.5;for(let E=m-h;E<m;E++){const M=g(E);$-=M,R.push({x1:P,y1:$,x2:A,y2:$,color:I})}if(C!==!0){let E=u+.5,M=n;const ie=$;for(;E+r<ie;){const q=E+r;if(q>=L&&q<=K-1){const J=w==null?void 0:w(M),Ce=(J==null?void 0:J.horizontalBorderColor)??(J==null?void 0:J.borderColor)??I;if(p){let de=.5;for(let j=0;j<t.length;j++){const G=t[j];if(G.width===0)continue;const se=G.sticky?de:de+o,Z=se+G.width;if(Z>=P&&se<=A){let ce=!0;const De=p([G.sourceIndex,M]);if(G.rowGroupBorder===!0&&m>1){const U=p([G.sourceIndex,M-1]);"data"in De&&"data"in U&&De.data===U.data&&(ce=!1)}else{const U=M+1<m?p([G.sourceIndex,M+1]):void 0;ce=(De==null?void 0:De.borderBottom)!==!1&&(U==null?void 0:U.borderTop)!==!1}ce&&R.push({x1:Math.max(se,P),y1:q,x2:Math.min(Z,A),y2:q,color:Ce})}de+=G.width}}else R.push({x1:P,y1:q,x2:A,y2:q,color:Ce})}E+=g(M),M++}}const Y=Qs(R,E=>E.color);for(const E of Object.keys(Y)){e.strokeStyle=E;for(const M of Y[E])e.moveTo(M.x1,M.y1),e.lineTo(M.x2,M.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function Ic(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m,x,C,p){const I=[];e.imageSmoothingEnabled=!1;const N=Math.min(r.cellYOffset,a),P=Math.max(r.cellYOffset,a);let A=0;if(typeof C=="number")A+=(P-N)*C;else for(let M=N;M<P;M++)A+=C(M);a>r.cellYOffset&&(A=-A),A+=c-r.translateY;const L=Math.min(r.cellXOffset,i),K=Math.max(r.cellXOffset,i);let R=0;for(let M=L;M<K;M++)R+=m[M].width;i>r.cellXOffset&&(R=-R),R+=l-r.translateX;const O=Yo(x);if(R!==0&&A!==0)return{regions:[]};const $=f>0?Jn(w,f,C):0,Y=u-O-Math.abs(R),E=g-b-$-Math.abs(A)-1;if(Y>150&&E>150){const M={sx:0,sy:0,sw:u*h,sh:g*h,dx:0,dy:0,dw:u*h,dh:g*h};if(A>0?(M.sy=(b+1)*h,M.sh=E*h,M.dy=(A+b+1)*h,M.dh=E*h,I.push({x:0,y:b,width:u,height:A+1})):A<0&&(M.sy=(-A+b+1)*h,M.sh=E*h,M.dy=(b+1)*h,M.dh=E*h,I.push({x:0,y:g+A-$,width:u,height:-A+$})),R>0?(M.sx=O*h,M.sw=Y*h,M.dx=(R+O)*h,M.dw=Y*h,I.push({x:O-1,y:0,width:R+2,height:g})):R<0&&(M.sx=(O-R)*h,M.sw=Y*h,M.dx=O*h,M.dw=Y*h,I.push({x:u+R,y:0,width:-R,height:g})),e.setTransform(1,0,0,1,0,0),p){if(O>0&&R!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ie=O*h,q=g*h;e.drawImage(t,0,0,ie,q,0,0,ie,q)}if($>0&&R===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ie=(g-$)*h,q=u*h,J=$*h;e.drawImage(t,0,ie,q,J,0,ie,q,J)}}e.drawImage(t,M.sx,M.sy,M.sw,M.sh,M.dx,M.dy,M.dw,M.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:I}}function Dc(e,t,n,o,r,i,a,l,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||eo(c,n,o,r,l,(g,w,b,h)=>{if(g.sourceIndex===f){const m=Math.max(w,h)+1;return u.push({x:m,y:0,width:i-m,height:a}),!0}}),u}function Fc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(No(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...l}=r,{width:c,...f}=i;if(!No(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function pl(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m){const x=h==null?void 0:h.filter(L=>L.style!=="no-outline");if(x===void 0||x.length===0)return;const C=Yo(l),p=Jn(b,w,g),I=[c,0,l.length,b-w],N=[C,0,t,n-p],P=x.map(L=>{const K=L.range,R=L.style??"dashed";return pc(K,I,t,n,N).map(O=>{const $=O.rect,Y=Ei($.x,$.y,t,n,u,f+u,o,r,i,a,b,c,w,l,g),E=$.width===1&&$.height===1?Y:Ei($.x+$.width-1,$.y+$.height-1,t,n,u,f+u,o,r,i,a,b,c,w,l,g);return $.x+$.width>=l.length&&(E.width-=1),$.y+$.height>=b&&(E.height-=1),{color:L.color,style:R,clip:O.clip,rect:yc({x:Y.x,y:Y.y,width:E.x+E.width-Y.x,height:E.y+E.height-Y.y},t,n,8)}})}),A=()=>{e.lineWidth=1;let L=!1;for(const K of P)for(const R of K)if((R==null?void 0:R.rect)!==void 0&&cr(0,0,t,n,R.rect.x,R.rect.y,R.rect.width,R.rect.height)){const O=L,$=!bc(R.clip,R.rect);e.beginPath(),$&&(e.save(),e.rect(R.clip.x,R.clip.y,R.clip.width,R.clip.height),e.clip()),R.style==="dashed"&&!L?(e.setLineDash([5,3]),L=!0):(R.style==="solid"||R.style==="solid-outline")&&L&&(e.setLineDash([]),L=!1),e.strokeStyle=R.style==="solid-outline"?Qt(Qt(R.color,m.borderColor),m.bgCell):go(R.color,1),e.closePath(),e.strokeRect(R.rect.x+.5,R.rect.y+.5,R.rect.width-1,R.rect.height-1),$&&(e.restore(),L=O)}L&&e.setLineDash([])};return A(),A}function vl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function vi(e,t,n,o,r,i,a,l,c,f,u,g,w,b,h,m,x){if(u.current===void 0)return;const C=m!==!1&&m!==void 0;if(!C)return;const p=typeof m=="object"?{...$r,...m}:$r,I=u.current.range,N=u.current.cell,P=[I.x+I.width-1,I.y+I.height-1];if(N[1]>=x&&P[1]>=x||!a.some(q=>q.sourceIndex===N[0]||q.sourceIndex===P[0]))return;const[L,K]=u.current.cell,R=w(u.current.cell),O=R.span??[L,L],$=K>=x-b,Y=b>0&&!$?Jn(x,b,g)-1:0,E=P[1];let M;if(eo(a,o,r,i,f,(q,J,Ce,de,j)=>{if(q.sticky&&L>q.sourceIndex)return;const G=q.sourceIndex<O[0],se=q.sourceIndex>O[1],Z=q.sourceIndex===P[0];if(!(!Z&&(G||se)))return Gr(j,Ce,n,x,g,b,h,void 0,(ce,De,U)=>{if(De!==K&&De!==E)return;let re=J,ge=q.width;if(R.span!==void 0){const Xe=ns(R.span,J,ce,q.width,U,q,l),tt=q.sticky?Xe[0]:Xe[1];tt!==void 0&&(re=tt.x,ge=tt.width)}return De===E&&Z&&C&&(M=()=>{var Ae;de>re&&!q.sticky&&(e.beginPath(),e.rect(de,0,t-de,n),e.clip());const Xe=p.size,tt=Xe/2,st=re+ge+p.offsetX-tt+.5,Re=ce+U+p.offsetY-tt+.5;e.beginPath(),p.shape==="circle"?e.arc(st+tt,Re+tt,tt,0,Math.PI*2):e.rect(st,Re,Xe,Xe),e.fillStyle=((Ae=q.themeOverride)==null?void 0:Ae.accentColor)??c.accentColor,e.fill(),p.outline>0&&(e.lineWidth=p.outline,e.strokeStyle=c.bgCell,p.shape==="circle"?(e.beginPath(),e.arc(st+tt,Re+tt,tt+p.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(st-p.outline/2,Re-p.outline/2,Xe+p.outline,Xe+p.outline))}),M!==void 0}),M!==void 0}),M===void 0)return;const ie=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-Y),e.clip(),M==null||M(),e.restore()};return ie(),ie}function Hc(e,t,n,o,r,i,a,l,c){c===void 0||c.size===0||(e.beginPath(),ts(t,n,i,o,(f,u,g,w,b,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(g,w,b,h)}),eo(t,l,i,a,r,(f,u,g,w)=>{const b=Math.max(0,w-u),h=u+b+1,m=f.width-b-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,m,r-o)}),e.clip())}function Tc(e,t,n,o,r,i,a,l,c,f){let u=0;return eo(e,i,o,r,n,(g,w,b,h,m)=>(Gr(m,b,t,a,l,c,f,void 0,(x,C,p,I)=>{I||(u=Math.max(C,u))}),!0)),u}function Cl(e,t){var cn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:l,translateX:c,translateY:f,mappedColumns:u,enableGroups:g,freezeColumns:w,dragAndDropState:b,theme:h,drawFocus:m,headerHeight:x,groupHeaderHeight:C,disabledRows:p,rowHeight:I,verticalBorder:N,overrideCursor:P,isResizing:A,selection:L,fillHandle:K,freezeTrailingRows:R,rows:O,getCellContent:$,getGroupDetails:Y,getRowThemeOverride:E,isFocused:M,drawHeaderCallback:ie,prelightCells:q,drawCellCallback:J,highlightRegions:Ce,resizeCol:de,imageLoader:j,lastBlitData:G,hoverValues:se,hyperWrapping:Z,hoverInfo:ce,spriteManager:De,maxScaleFactor:U,hasAppendRow:re,touchMode:ge,enqueue:Le,renderStateProvider:Xe,getCellRenderer:tt,renderStrategy:st,bufferACtx:Re,bufferBCtx:Ae,damage:Fe,minimumCellWidth:ht,resizeIndicator:gt}=e;if(r===0||i===0)return;const dt=st==="double-buffer",Q=Math.min(U,Math.ceil(window.devicePixelRatio??1)),me=st!=="direct"&&Fc(e,t),ke=n.canvas;(ke.width!==r*Q||ke.height!==i*Q)&&(ke.width=r*Q,ke.height=i*Q,ke.style.width=r+"px",ke.style.height=i+"px");const Ee=o.canvas,be=g?C+x:x,je=be+1;(Ee.width!==r*Q||Ee.height!==je*Q)&&(Ee.width=r*Q,Ee.height=je*Q,Ee.style.width=r+"px",Ee.style.height=je+"px");const Ye=Re.canvas,Ze=Ae.canvas;dt&&(Ye.width!==r*Q||Ye.height!==i*Q)&&(Ye.width=r*Q,Ye.height=i*Q,G.current!==void 0&&(G.current.aBufferScroll=void 0)),dt&&(Ze.width!==r*Q||Ze.height!==i*Q)&&(Ze.width=r*Q,Ze.height=i*Q,G.current!==void 0&&(G.current.bBufferScroll=void 0));const le=G.current;if(me===!0&&a===(le==null?void 0:le.cellXOffset)&&l===(le==null?void 0:le.cellYOffset)&&c===(le==null?void 0:le.translateX)&&f===(le==null?void 0:le.translateY))return;let ye=null;dt&&(ye=n);const Ge=o;let _e;dt?Fe!==void 0?_e=(le==null?void 0:le.lastBuffer)==="b"?Ae:Re:_e=(le==null?void 0:le.lastBuffer)==="b"?Re:Ae:_e=n;const Qe=_e.canvas,mt=dt?Qe===Ye?Ze:Ye:ke,ot=typeof I=="number"?()=>I:I;Ge.save(),_e.save(),Ge.beginPath(),_e.beginPath(),Ge.textBaseline="middle",_e.textBaseline="middle",Q!==1&&(Ge.scale(Q,Q),_e.scale(Q,Q));const Pe=Ri(u,a,r,b,c);let kt=[];const Ft=m&&((cn=L.current)==null?void 0:cn.cell[1])===l&&f===0;let Lt=!1;if(Ce!==void 0){for(const wt of Ce)if(wt.style!=="no-outline"&&wt.range.y===l&&f===0){Lt=!0;break}}const vt=()=>{xc(Ge,Pe,g,ce,r,c,x,C,b,A,L,h,De,se,N,Y,Fe,ie,ge),yl(Ge,Pe,l,c,f,r,i,void 0,void 0,C,be,ot,E,N,R,O,h,!0,$),Ge.beginPath(),Ge.moveTo(0,je-.5),Ge.lineTo(r,je-.5),Ge.strokeStyle=Qt(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),Ge.stroke(),Lt&&pl(Ge,r,i,a,l,c,f,u,w,x,C,I,R,O,Ce,h),Ft&&vi(Ge,r,i,l,c,f,Pe,u,h,be,L,ot,$,R,re,K,O)};if(Fe!==void 0){const wt=Pe[Pe.length-1].sourceIndex+1,Wt=Fe.hasItemInRegion([{x:a,y:-2,width:wt,height:2},{x:a,y:l,width:wt,height:300},{x:0,y:l,width:w,height:300},{x:0,y:-2,width:w,height:2},{x:a,y:O-R,width:wt,height:R,when:R>0}]),Ke=Ht=>{wl(Ht,Pe,u,i,be,c,f,l,O,ot,$,Y,E,p,M,m,R,re,kt,Fe,L,q,Ce,j,De,se,ce,J,Z,h,Le,Xe,tt,P,ht);const qt=L.current;K!==!1&&K!==void 0&&m&&qt!==void 0&&Fe.has(Nl(qt.range))&&vi(Ht,r,i,l,c,f,Pe,u,h,be,L,ot,$,R,re,K,O)};Wt&&(Ke(_e),ye!==null&&(ye.save(),ye.scale(Q,Q),ye.textBaseline="middle",Ke(ye),ye.restore()),Fe.hasHeader()&&(Hc(Ge,Pe,r,C,be,c,f,l,Fe),vt())),_e.restore(),Ge.restore();return}if((me!==!0||a!==(le==null?void 0:le.cellXOffset)||c!==(le==null?void 0:le.translateX)||Ft!==(le==null?void 0:le.mustDrawFocusOnHeader)||Lt!==(le==null?void 0:le.mustDrawHighlightRingsOnHeader))&&vt(),me===!0){Jt(mt!==void 0&&le!==void 0);const{regions:wt}=Ic(_e,mt,mt===Ye?le.aBufferScroll:le.bBufferScroll,mt===Ye?le.bBufferScroll:le.aBufferScroll,le,a,l,c,f,R,r,i,O,be,Q,u,Pe,I,dt);kt=wt}else me!==!1&&(Jt(le!==void 0),kt=Dc(le,a,l,c,f,r,i,be,Pe,me));Rc(_e,Pe,r,i,R,O,N,ot,h);const It=pl(_e,r,i,a,l,c,f,u,w,x,C,I,R,O,Ce,h),Bt=m?vi(_e,r,i,l,c,f,Pe,u,h,be,L,ot,$,R,re,K,O):void 0;if(_e.fillStyle=h.bgCell,kt.length>0){_e.beginPath();for(const wt of kt)_e.rect(wt.x,wt.y,wt.width,wt.height);_e.clip(),_e.fill(),_e.beginPath()}else _e.fillRect(0,0,r,i);const an=wl(_e,Pe,u,i,be,c,f,l,O,ot,$,Y,E,p,M,m,R,re,kt,Fe,L,q,Ce,j,De,se,ce,J,Z,h,Le,Xe,tt,P,ht);Mc(_e,Pe,u,r,i,be,c,f,l,O,ot,E,L.rows,p,R,re,kt,Fe,h),Ec(_e,Pe,l,c,f,r,i,kt,be,ot,E,N,R,O,h),yl(_e,Pe,l,c,f,r,i,kt,an,C,be,ot,E,N,R,O,h,!1,$),It==null||It(),Bt==null||Bt(),A&&gt!=="none"&&eo(Pe,0,c,0,be,(wt,Wt)=>wt.sourceIndex===de?(vl(Ge,Wt+wt.width,0,be+1,Qt(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),gt==="full"&&vl(_e,Wt+wt.width,be,i,Qt(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),ye!==null&&(ye.fillStyle=h.bgCell,ye.fillRect(0,0,r,i),ye.drawImage(_e.canvas,0,0));const _t=Tc(Pe,i,be,c,f,l,O,ot,R,re);j==null||j.setWindow({x:a,y:l,width:Pe.length,height:_t-l},w,Array.from({length:R},(wt,Wt)=>O-1-Wt));const lt=le!==void 0&&(a!==le.cellXOffset||c!==le.translateX),Rn=le!==void 0&&(l!==le.cellYOffset||f!==le.translateY);G.current={cellXOffset:a,cellYOffset:l,translateX:c,translateY:f,mustDrawFocusOnHeader:Ft,mustDrawHighlightRingsOnHeader:Lt,lastBuffer:dt?Qe===Ye?"a":"b":void 0,aBufferScroll:Qe===Ye?[lt,Rn]:le==null?void 0:le.aBufferScroll,bBufferScroll:Qe===Ze?[lt,Rn]:le==null?void 0:le.bBufferScroll},_e.restore(),Ge.restore()}const Ac=80;function zc(e){const t=e-1;return t*t*t+1}class Pc{constructor(t){$e(this,"callback");$e(this,"currentHoveredItem");$e(this,"leavingItems",[]);$e(this,"lastAnimationTime");$e(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>rr(o.item,t.item))||this.leavingItems.push(t)});$e(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>rr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});$e(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});$e(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});$e(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:zc(t.hoverAmount)})));$e(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Ac;for(const i of this.leavingItems)i.hoverAmount=ln(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=ln(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});$e(this,"setHovered",t=>{var n;if(!rr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Bc{constructor(t){$e(this,"fn");$e(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function $i(e){return new Bc(e)}const Lc=$i(()=>window.navigator.userAgent.includes("Firefox")),Or=$i(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Nr=$i(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Wc(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const l=t.current.map(Li);t.current=[],o.current(new lr(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return s.useCallback(i=>{t.current.length===0&&r();const a=bn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const Zn="header",wn="group-header",Xr="out-of-bounds";var Oo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Oo||(Oo={}));function cs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const $c=(e,t)=>{if(e.kind===oe.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Oc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:l,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:g,rows:w,getCellContent:b,getRowThemeOverride:h,onHeaderMenuClick:m,onHeaderIndicatorClick:x,enableGroups:C,isFilling:p,onCanvasFocused:I,onCanvasBlur:N,isFocused:P,selection:A,freezeColumns:L,onContextMenu:K,freezeTrailingRows:R,fixedShadowX:O=!0,fixedShadowY:$=!0,drawFocusRing:Y,onMouseDown:E,onMouseUp:M,onMouseMoveRaw:ie,onMouseMove:q,onItemHovered:J,dragAndDropState:Ce,firstColAccessible:de,onKeyDown:j,onKeyUp:G,highlightRegions:se,canvasRef:Z,onDragStart:ce,onDragEnd:De,eventTargetRef:U,isResizing:re,resizeColumn:ge,isDragging:Le,isDraggable:Xe=!1,allowResize:tt,disabledRows:st,hasAppendRow:Re,getGroupDetails:Ae,theme:Fe,prelightCells:ht,headerIcons:gt,verticalBorder:dt,drawCell:Q,drawHeader:me,onCellFocused:ke,onDragOverCell:Ee,onDrop:be,onDragLeave:je,imageWindowLoader:Ye,smoothScrollX:Ze=!1,smoothScrollY:le=!1,experimental:ye,getCellRenderer:Ge,resizeIndicator:_e="full"}=e,Qe=e.translateX??0,mt=e.translateY??0,ot=Math.max(L,Math.min(i.length-1,a)),Pe=s.useRef(null),kt=s.useRef((ye==null?void 0:ye.eventTarget)??window),Ft=kt.current,Lt=Ye,vt=s.useRef(),[It,Bt]=s.useState(!1),an=s.useRef([]),_t=s.useRef(),[lt,Rn]=s.useState(),[cn,wt]=s.useState(),Wt=s.useRef(null),[Ke,Ht]=s.useState(),[qt,et]=s.useState(!1),Dt=s.useRef(qt);Dt.current=qt;const at=s.useMemo(()=>new mc(gt,()=>{wo.current=void 0,to.current()}),[gt]),tn=C?u+c:c,Nt=s.useRef(-1),Kt=((ye==null?void 0:ye.enableFirefoxRescaling)??!1)&&Lc.value,En=((ye==null?void 0:ye.enableSafariRescaling)??!1)&&Or.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!Kt&&!En||(Nt.current!==-1&&Bt(!0),window.clearTimeout(Nt.current),Nt.current=window.setTimeout(()=>{Bt(!1),Nt.current=-1},200))},[l,ot,Qe,mt,Kt,En]);const ut=Ca(i,L),Ln=s.useMemo(()=>O?Yo(ut,Ce):0,[ut,Ce,O]),Tt=s.useCallback((S,X,ue)=>{const fe=S.getBoundingClientRect();if(X>=ut.length||ue>=w)return;const te=fe.width/n,ne=Ei(X,ue,n,o,u,tn,ot,l,Qe,mt,w,L,R,ut,g);return te!==1&&(ne.x*=te,ne.y*=te,ne.width*=te,ne.height*=te),ne.x+=fe.x,ne.y+=fe.y,ne},[n,o,u,tn,ot,l,Qe,mt,w,L,R,ut,g]),Ue=s.useCallback((S,X,ue,fe)=>{const te=S.getBoundingClientRect(),ne=te.width/n,Me=(X-te.left)/ne,Ve=(ue-te.top)/ne,we=5,At=Ri(ut,ot,n,void 0,Qe);let pe=0,qe=0;const ze=typeof PointerEvent<"u"&&fe instanceof PointerEvent&&fe.pointerType==="mouse"||typeof MouseEvent<"u"&&fe instanceof MouseEvent,Be=typeof PointerEvent<"u"&&fe instanceof PointerEvent&&fe.pointerType==="touch"||typeof TouchEvent<"u"&&fe instanceof TouchEvent;ze&&(pe=fe.button,qe=fe.buttons);const He=Ma(Me,At,Qe),Je=Ra(Ve,o,C,c,u,w,g,l,mt,R),St=(fe==null?void 0:fe.shiftKey)===!0,un=(fe==null?void 0:fe.ctrlKey)===!0,fn=(fe==null?void 0:fe.metaKey)===!0,bt=[Me<0?-1:n<Me?1:0,Ve<tn?-1:o<Ve?1:0];let Rt;if(He===-1||Ve<0||Me<0||Je===void 0||Me>n||Ve>o){const ct=Me>n?1:Me<0?-1:0,nn=Ve>o?1:Ve<0?-1:0;let $t=ct*2,Do=nn*2;ct===0&&($t=He===-1?Oo.EndPadding:Oo.Center),nn===0&&(Do=Je===void 0?Oo.EndPadding:Oo.Center);let zn=!1;if(He===-1&&Je===-1){const zt=Tt(S,ut.length-1,-1);Jt(zt!==void 0),zn=X<zt.x+zt.width+we}const We=Me>n&&Me<n+Mi()||Ve>o&&Ve<o+Mi();Rt={kind:Xr,location:[He!==-1?He:Me<0?0:ut.length-1,Je??w-1],region:[$t,Do],shiftKey:St,ctrlKey:un,metaKey:fn,isEdge:zn,isTouch:Be,button:pe,buttons:qe,scrollEdge:bt,isMaybeScrollbar:We}}else if(Je<=-1){let ct=Tt(S,He,Je);Jt(ct!==void 0);let nn=ct!==void 0&&ct.x+ct.width-X<=we;const $t=He-1;X-ct.x<=we&&$t>=0?(nn=!0,ct=Tt(S,$t,Je),Jt(ct!==void 0),Rt={kind:C&&Je===-2?wn:Zn,location:[$t,Je],bounds:ct,group:ut[$t].group??"",isEdge:nn,shiftKey:St,ctrlKey:un,metaKey:fn,isTouch:Be,localEventX:X-ct.x,localEventY:ue-ct.y,button:pe,buttons:qe,scrollEdge:bt}):Rt={kind:C&&Je===-2?wn:Zn,group:ut[He].group??"",location:[He,Je],bounds:ct,isEdge:nn,shiftKey:St,ctrlKey:un,metaKey:fn,isTouch:Be,localEventX:X-ct.x,localEventY:ue-ct.y,button:pe,buttons:qe,scrollEdge:bt}}else{const ct=Tt(S,He,Je);Jt(ct!==void 0);const nn=ct!==void 0&&ct.x+ct.width-X<we;let $t=!1;if(f!==!1&&f!==void 0&&A.current!==void 0){const zn=typeof f=="object"?{...$r,...f}:$r,We=zn.size,zt=We/2,io=Nl(A.current.range),Gn=Tt(S,io[0],io[1]);if(Gn!==void 0){const Pn=Gn.x+Gn.width+zn.offsetX-zt+.5,rt=Gn.y+Gn.height+zn.offsetY-zt+.5;$t=Math.abs(Pn-X)<We&&Math.abs(rt-ue)<We}}Rt={kind:"cell",location:[He,Je],bounds:ct,isEdge:nn,shiftKey:St,ctrlKey:un,isFillHandle:$t,metaKey:fn,isTouch:Be,localEventX:X-ct.x,localEventY:ue-ct.y,button:pe,buttons:qe,scrollEdge:bt}}return Rt},[n,ut,ot,Qe,o,C,c,u,w,g,l,mt,R,Tt,f,A,tn]),[In]=lt??[],ur=s.useRef(()=>{}),Wn=s.useRef(lt);Wn.current=lt;const[Dn,Fn]=s.useMemo(()=>{const S=document.createElement("canvas"),X=document.createElement("canvas");return S.style.display="none",S.style.opacity="0",S.style.position="fixed",X.style.display="none",X.style.opacity="0",X.style.position="fixed",[S.getContext("2d",{alpha:!1}),X.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Dn===null||Fn===null))return document.documentElement.append(Dn.canvas),document.documentElement.append(Fn.canvas),()=>{Dn.canvas.remove(),Fn.canvas.remove()}},[Dn,Fn]);const mo=s.useMemo(()=>new Pa,[]),fr=Kt&&It?1:En&&It?2:5,$n=(ye==null?void 0:ye.disableMinimumCellWidth)===!0?1:10,wo=s.useRef(),bo=s.useRef(null),yo=s.useRef(null),po=s.useCallback(()=>{var Me;const S=Pe.current,X=Wt.current;if(S===null||X===null||(bo.current===null&&(bo.current=S.getContext("2d",{alpha:!1}),S.width=0,S.height=0),yo.current===null&&(yo.current=X.getContext("2d",{alpha:!1}),X.width=0,X.height=0),bo.current===null||yo.current===null||Dn===null||Fn===null))return;let ue=!1;const fe=Ve=>{ue=!0,Ht(Ve)},te=wo.current,ne={headerCanvasCtx:yo.current,canvasCtx:bo.current,bufferACtx:Dn,bufferBCtx:Fn,width:n,height:o,cellXOffset:ot,cellYOffset:l,translateX:Math.round(Qe),translateY:Math.round(mt),mappedColumns:ut,enableGroups:C,freezeColumns:L,dragAndDropState:Ce,theme:Fe,headerHeight:c,groupHeaderHeight:u,disabledRows:st??it.empty(),rowHeight:g,verticalBorder:dt,isResizing:re,resizeCol:ge,isFocused:P,selection:A,fillHandle:f,drawCellCallback:Q,hasAppendRow:Re,overrideCursor:fe,maxScaleFactor:fr,freezeTrailingRows:R,rows:w,drawFocus:Y,getCellContent:b,getGroupDetails:Ae??(Ve=>({name:Ve})),getRowThemeOverride:h,drawHeaderCallback:me,prelightCells:ht,highlightRegions:se,imageLoader:Lt,lastBlitData:_t,damage:vt.current,hoverValues:an.current,hoverInfo:Wn.current,spriteManager:at,scrolling:It,hyperWrapping:(ye==null?void 0:ye.hyperWrapping)??!1,touchMode:qt,enqueue:ur.current,renderStateProvider:mo,renderStrategy:(ye==null?void 0:ye.renderStrategy)??(Or.value?"double-buffer":"single-buffer"),getCellRenderer:Ge,minimumCellWidth:$n,resizeIndicator:_e};ne.damage===void 0?(wo.current=ne,Cl(ne,te)):Cl(ne,void 0),!ue&&(ne.damage===void 0||ne.damage.has((Me=Wn==null?void 0:Wn.current)==null?void 0:Me[0]))&&Ht(void 0)},[Dn,Fn,n,o,ot,l,Qe,mt,ut,C,L,Ce,Fe,c,u,st,g,dt,re,Re,ge,P,A,f,R,w,Y,fr,b,Ae,h,Q,me,ht,se,Lt,at,It,ye==null?void 0:ye.hyperWrapping,ye==null?void 0:ye.renderStrategy,qt,mo,Ge,$n,_e]),to=s.useRef(po);s.useLayoutEffect(()=>{po(),to.current=po},[po]),s.useLayoutEffect(()=>{(async()=>{var X;((X=document==null?void 0:document.fonts)==null?void 0:X.ready)!==void 0&&(await document.fonts.ready,wo.current=void 0,to.current())})()},[]);const Hn=s.useCallback(S=>{vt.current=S,to.current(),vt.current=void 0},[]),_r=Wc(Hn);ur.current=_r;const hr=s.useCallback(S=>{Hn(new lr(S.map(X=>X.cell)))},[Hn]);Lt.setCallback(Hn);const[Kr,Ur]=s.useState(!1),[yn,On]=In??[],Vr=yn!==void 0&&On===-1&&yn>=0&&yn<ut.length&&ut[yn].headerRowMarkerDisabled!==!0,qr=yn!==void 0&&On===-2;let vo=!1,gr=!1,no=Ke;if(no===void 0&&yn!==void 0&&On!==void 0&&On>-1&&On<w){const S=b([yn,On],!0);vo=S.kind===sn.NewRow||S.kind===sn.Marker&&S.markerKind!=="number",gr=S.kind===oe.Boolean&&Ti(S),no=S.cursor}const mr=Le?"grabbing":(cn??!1)||re?"col-resize":Kr||p?"crosshair":no!==void 0?no:Vr||vo||gr||qr?"pointer":"default",Co=s.useMemo(()=>({contain:"strict",display:"block",cursor:mr}),[mr]),ft=s.useRef("default"),Xt=U==null?void 0:U.current;Xt!=null&&ft.current!==Co.cursor&&(Xt.style.cursor=ft.current=Co.cursor);const xo=s.useCallback((S,X,ue,fe)=>{if(Ae===void 0)return;const te=Ae(S);if(te.actions!==void 0){const ne=is(X,te.actions);for(const[Me,Ve]of ne.entries())if(ho(Ve,ue+X.x,fe+Ve.y))return te.actions[Me]}},[Ae]),Tn=s.useCallback((S,X,ue,fe)=>{const te=ut[X];if(!Le&&!re&&!(cn??!1)){const ne=Tt(S,X,-1);Jt(ne!==void 0);const Me=ls(void 0,te,ne.x,ne.y,ne.width,ne.height,Fe,zi(te.title)==="rtl");if(te.hasMenu===!0&&Me.menuBounds!==void 0&&ho(Me.menuBounds,ue,fe))return{area:"menu",bounds:Me.menuBounds};if(te.indicatorIcon!==void 0&&Me.indicatorIconBounds!==void 0&&ho(Me.indicatorIconBounds,ue,fe))return{area:"indicator",bounds:Me.indicatorIconBounds}}},[ut,Tt,cn,Le,re,Fe]),ko=s.useRef(0),Nn=s.useRef(),So=s.useRef(!1),Mo=s.useCallback(S=>{const X=Pe.current,ue=U==null?void 0:U.current;if(X===null||S.target!==X&&S.target!==ue)return;So.current=!0;const fe=S.clientX,te=S.clientY;if(S.target===ue&&ue!==null){const Me=ue.getBoundingClientRect();if(fe>Me.right||te>Me.bottom)return}const ne=Ue(X,fe,te,S);Nn.current=ne.location,ne.isTouch&&(ko.current=Date.now()),Dt.current!==ne.isTouch&&et(ne.isTouch),!(ne.kind===Zn&&Tn(X,ne.location[0],fe,te)!==void 0)&&(ne.kind===wn&&xo(ne.group,ne.bounds,ne.localEventX,ne.localEventY)!==void 0||(E==null||E(ne),!ne.isTouch&&Xe!==!0&&Xe!==ne.kind&&ne.button<3&&ne.button!==1&&S.preventDefault()))},[U,Xe,Ue,xo,Tn,E]);Gt("pointerdown",Mo,Ft,!1);const oo=s.useRef(0),Xn=s.useCallback(S=>{var qe,ze;const X=oo.current;oo.current=Date.now();const ue=Pe.current;if(So.current=!1,M===void 0||ue===null)return;const fe=U==null?void 0:U.current,te=S.target!==ue&&S.target!==fe,ne=S.clientX,Me=S.clientY,Ve=S.pointerType==="mouse"?S.button<3:!0;let we=Ue(ue,ne,Me,S);we.isTouch&&ko.current!==0&&Date.now()-ko.current>500&&(we={...we,isLongTouch:!0}),X!==0&&Date.now()-X<(we.isTouch?1e3:500)&&(we={...we,isDoubleClick:!0}),Dt.current!==we.isTouch&&et(we.isTouch),!te&&S.cancelable&&Ve&&S.preventDefault();const[At]=we.location,pe=Tn(ue,At,ne,Me);if(we.kind===Zn&&pe!==void 0){(we.button!==0||((qe=Nn.current)==null?void 0:qe[0])!==At||((ze=Nn.current)==null?void 0:ze[1])!==-1)&&M(we,!0);return}else if(we.kind===wn){const Be=xo(we.group,we.bounds,we.localEventX,we.localEventY);if(Be!==void 0){we.button===0&&Be.onClick(we);return}}M(we,te)},[M,U,Ue,Tn,xo]);Gt("pointerup",Xn,Ft,!1);const Ro=s.useCallback(S=>{var At,pe;const X=Pe.current;if(X===null)return;const ue=U==null?void 0:U.current,fe=S.target!==X&&S.target!==ue;let te,ne,Me=!0;S instanceof MouseEvent?(te=S.clientX,ne=S.clientY,Me=S.button<3):(te=S.changedTouches[0].clientX,ne=S.changedTouches[0].clientY);const Ve=Ue(X,te,ne,S);Dt.current!==Ve.isTouch&&et(Ve.isTouch),!fe&&S.cancelable&&Me&&S.preventDefault();const[we]=Ve.location;if(Ve.kind===Zn){const qe=Tn(X,we,te,ne);qe!==void 0&&Ve.button===0&&((At=Nn.current)==null?void 0:At[0])===we&&((pe=Nn.current)==null?void 0:pe[1])===-1&&(qe.area==="menu"?m==null||m(we,qe.bounds):qe.area==="indicator"&&(x==null||x(we,qe.bounds)))}},[U,Ue,Tn,m,x]);Gt("click",Ro,Ft,!1);const Zr=s.useCallback(S=>{const X=Pe.current,ue=U==null?void 0:U.current;if(X===null||S.target!==X&&S.target!==ue||K===void 0)return;const fe=Ue(X,S.clientX,S.clientY,S);K(fe,()=>{S.cancelable&&S.preventDefault()})},[U,Ue,K]);Gt("contextmenu",Zr,(U==null?void 0:U.current)??null,!1);const _o=s.useCallback(S=>{vt.current=new lr(S.map(X=>X.item)),an.current=S,to.current(),vt.current=void 0},[]),Se=s.useMemo(()=>new Pc(_o),[_o]),Ko=s.useRef(Se);Ko.current=Se,s.useLayoutEffect(()=>{const S=Ko.current;if(In===void 0||In[1]<0){S.setHovered(In);return}const X=b(In,!0),ue=Ge(X),fe=ue===void 0&&X.kind===oe.Custom||(ue==null?void 0:ue.needsHover)!==void 0&&(typeof ue.needsHover=="boolean"?ue.needsHover:ue.needsHover(X));S.setHovered(fe?In:void 0)},[b,Ge,In]);const wr=s.useRef(),dn=s.useCallback(S=>{var Ve;const X=Pe.current;if(X===null)return;const ue=U==null?void 0:U.current,fe=S.target!==X&&S.target!==ue,te=Ue(X,S.clientX,S.clientY,S);if(te.kind!=="out-of-bounds"&&fe&&!So.current&&!te.isTouch)return;const ne=(we,At)=>{Rn(pe=>pe===we||(pe==null?void 0:pe[0][0])===(we==null?void 0:we[0][0])&&(pe==null?void 0:pe[0][1])===(we==null?void 0:we[0][1])&&((pe==null?void 0:pe[1][0])===(we==null?void 0:we[1][0])&&(pe==null?void 0:pe[1][1])===(we==null?void 0:we[1][1])||!At)?pe:we)};if(!cs(te,wr.current))Ht(void 0),J==null||J(te),ne(te.kind===Xr?void 0:[te.location,[te.localEventX,te.localEventY]],!0),wr.current=te;else if(te.kind==="cell"||te.kind===Zn||te.kind===wn){let we=!1,At=!0;if(te.kind==="cell"){const qe=b(te.location);At=((Ve=Ge(qe))==null?void 0:Ve.needsHoverPosition)??qe.kind===oe.Custom,we=At}else we=!0;const pe=[te.location,[te.localEventX,te.localEventY]];ne(pe,At),Wn.current=pe,we&&Hn(new lr([te.location]))}const Me=te.location[0]>=(de?0:1);wt(te.kind===Zn&&te.isEdge&&Me&&tt===!0),Ur(te.kind==="cell"&&te.isFillHandle),ie==null||ie(S),q(te)},[U,Ue,de,tt,ie,q,J,b,Ge,Hn]);Gt("pointermove",dn,Ft,!0);const Jr=s.useCallback(S=>{const X=Pe.current;if(X===null)return;let ue,fe;A.current!==void 0&&(ue=Tt(X,A.current.cell[0],A.current.cell[1]),fe=A.current.cell),j==null||j({bounds:ue,stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),cancel:()=>{},ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:fe})},[j,A,Tt]),pn=s.useCallback(S=>{const X=Pe.current;if(X===null)return;let ue,fe;A.current!==void 0&&(ue=Tt(X,A.current.cell[0],A.current.cell[1]),fe=A.current.cell),G==null||G({bounds:ue,stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),cancel:()=>{},ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:fe})},[G,A,Tt]),Uo=s.useCallback(S=>{if(Pe.current=S,Z!==void 0&&(Z.current=S),ye!=null&&ye.eventTarget)kt.current=ye.eventTarget;else if(S===null)kt.current=window;else{const X=S.getRootNode();X===document&&(kt.current=window),kt.current=X}},[Z,ye==null?void 0:ye.eventTarget]),br=s.useCallback(S=>{const X=Pe.current;if(X===null||Xe===!1||re){S.preventDefault();return}let ue,fe;const te=Ue(X,S.clientX,S.clientY);if(Xe!==!0&&te.kind!==Xe){S.preventDefault();return}const ne=(qe,ze)=>{ue=qe,fe=ze};let Me,Ve,we;const At=(qe,ze,Be)=>{Me=qe,Ve=ze,we=Be};let pe=!1;if(ce==null||ce({...te,setData:ne,setDragImage:At,preventDefault:()=>pe=!0,defaultPrevented:()=>pe}),!pe&&ue!==void 0&&fe!==void 0&&S.dataTransfer!==null)if(S.dataTransfer.setData(ue,fe),S.dataTransfer.effectAllowed="copyLink",Me!==void 0&&Ve!==void 0&&we!==void 0)S.dataTransfer.setDragImage(Me,Ve,we);else{const[qe,ze]=te.location;if(ze!==void 0){const Be=document.createElement("canvas"),He=Tt(X,qe,ze);Jt(He!==void 0);const Je=Math.ceil(window.devicePixelRatio??1);Be.width=He.width*Je,Be.height=He.height*Je;const St=Be.getContext("2d");St!==null&&(St.scale(Je,Je),St.textBaseline="middle",ze===-1?(St.font=Fe.headerFontFull,St.fillStyle=Fe.bgHeader,St.fillRect(0,0,Be.width,Be.height),ss(St,0,0,He.width,He.height,ut[qe],!1,Fe,!1,void 0,void 0,!1,0,at,me,!1)):(St.font=Fe.baseFontFull,St.fillStyle=Fe.bgCell,St.fillRect(0,0,Be.width,Be.height),rs(St,b([qe,ze]),0,ze,!1,!1,0,0,He.width,He.height,!1,Fe,Fe.bgCell,Lt,at,1,void 0,!1,0,void 0,void 0,void 0,mo,Ge,()=>{}))),Be.style.left="-100%",Be.style.position="absolute",Be.style.width=`${He.width}px`,Be.style.height=`${He.height}px`,document.body.append(Be),S.dataTransfer.setDragImage(Be,He.width/2,He.height/2),window.setTimeout(()=>{Be.remove()},0)}}else S.preventDefault()},[Xe,re,Ue,ce,Tt,Fe,ut,at,me,b,Lt,mo,Ge]);Gt("dragstart",br,(U==null?void 0:U.current)??null,!1,!1);const Eo=s.useRef(),Qr=s.useCallback(S=>{const X=Pe.current;if(be!==void 0&&S.preventDefault(),X===null||Ee===void 0)return;const ue=Ue(X,S.clientX,S.clientY),[fe,te]=ue.location,ne=fe-(de?0:1),[Me,Ve]=Eo.current??[];(Me!==ne||Ve!==te)&&(Eo.current=[ne,te],Ee([ne,te],S.dataTransfer))},[de,Ue,Ee,be]);Gt("dragover",Qr,(U==null?void 0:U.current)??null,!1,!1);const ei=s.useCallback(()=>{Eo.current=void 0,De==null||De()},[De]);Gt("dragend",ei,(U==null?void 0:U.current)??null,!1,!1);const vn=s.useCallback(S=>{const X=Pe.current;if(X===null||be===void 0)return;S.preventDefault();const ue=Ue(X,S.clientX,S.clientY),[fe,te]=ue.location,ne=fe-(de?0:1);be([ne,te],S.dataTransfer)},[de,Ue,be]);Gt("drop",vn,(U==null?void 0:U.current)??null,!1,!1);const Yn=s.useCallback(()=>{je==null||je()},[je]);Gt("dragleave",Yn,(U==null?void 0:U.current)??null,!1,!1);const jt=s.useRef(A);jt.current=A;const D=s.useRef(null),pt=s.useCallback(S=>{var X;Pe.current===null||!Pe.current.contains(document.activeElement)||(S===null&&jt.current.current!==void 0?(X=Z==null?void 0:Z.current)==null||X.focus({preventScroll:!0}):S!==null&&S.focus({preventScroll:!0}),D.current=S)},[Z]);s.useImperativeHandle(t,()=>({focus:()=>{var X;const S=D.current;S===null||!document.contains(S)?(X=Z==null?void 0:Z.current)==null||X.focus({preventScroll:!0}):S.focus({preventScroll:!0})},getBounds:(S,X)=>{if(!(Z===void 0||Z.current===null))return Tt(Z.current,S??0,X??-1)},damage:hr,getMouseArgsForPosition:(S,X,ue)=>{if(!(Z===void 0||Z.current===null))return Ue(Z.current,S,X,ue)}}),[Z,hr,Tt,Ue]);const An=s.useRef(),ti=aa(()=>{var Ve,we,At;if(n<50||(ye==null?void 0:ye.disableAccessibilityTree)===!0)return null;let S=Ri(ut,ot,n,Ce,Qe);const X=de?0:-1;!de&&((Ve=S[0])==null?void 0:Ve.sourceIndex)===0&&(S=S.slice(1));const[ue,fe]=((we=A.current)==null?void 0:we.cell)??[],te=(At=A.current)==null?void 0:At.range,ne=S.map(pe=>pe.sourceIndex),Me=fo(l,Math.min(w,l+r));return ue!==void 0&&fe!==void 0&&!(ne.includes(ue)&&Me.includes(fe))&&pt(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":w+1,"aria-multiselectable":"true","aria-colcount":ut.length+X},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},S.map(pe=>s.createElement("th",{role:"columnheader","aria-selected":A.columns.hasIndex(pe.sourceIndex),"aria-colindex":pe.sourceIndex+1+X,tabIndex:-1,onFocus:qe=>{if(qe.target!==D.current)return ke==null?void 0:ke([pe.sourceIndex,-1])},key:pe.sourceIndex},pe.title)))),s.createElement("tbody",{role:"rowgroup"},Me.map(pe=>s.createElement("tr",{role:"row","aria-selected":A.rows.hasIndex(pe),key:pe,"aria-rowindex":pe+2},S.map(qe=>{const ze=qe.sourceIndex,Be=bn(ze,pe),He=ue===ze&&fe===pe,Je=te!==void 0&&ze>=te.x&&ze<te.x+te.width&&pe>=te.y&&pe<te.y+te.height,St=`glide-cell-${ze}-${pe}`,un=[ze,pe],fn=b(un,!0);return s.createElement("td",{key:Be,role:"gridcell","aria-colindex":ze+1+X,"aria-selected":Je,"aria-readonly":$o(fn)||!Wo(fn),id:St,"data-testid":St,onClick:()=>{const bt=Z==null?void 0:Z.current;if(bt!=null)return j==null?void 0:j({bounds:Tt(bt,ze,pe),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:un})},onFocusCapture:bt=>{var Rt,ct;if(!(bt.target===D.current||((Rt=An.current)==null?void 0:Rt[0])===ze&&((ct=An.current)==null?void 0:ct[1])===pe))return An.current=un,ke==null?void 0:ke(un)},ref:He?pt:void 0,tabIndex:-1},$c(fn,Ge))})))))},[n,ut,ot,Ce,Qe,w,l,r,A,pt,b,Z,j,Tt,ke],200),ro=L===0||!O?0:ot>L?1:ln(-Qe/100,0,1),ni=-l*32+mt,Io=$?ln(-ni/100,0,1):0,Ni=s.useMemo(()=>{if(!ro&&!Io)return null;const S={position:"absolute",top:0,left:Ln,width:n-Ln,height:o,opacity:ro,pointerEvents:"none",transition:Ze?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},X={position:"absolute",top:tn,left:0,width:n,height:o,opacity:Io,pointerEvents:"none",transition:le?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,ro>0&&s.createElement("div",{id:"shadow-x",style:S}),Io>0&&s.createElement("div",{id:"shadow-y",style:X}))},[ro,Io,Ln,n,Ze,tn,o,le]),B=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Jr,onKeyUp:pn,onFocus:I,onBlur:N,ref:Uo,style:Co},ti),s.createElement("canvas",{ref:Wt,style:B}),Ni)},Nc=s.memo(s.forwardRef(Oc));function or(e,t,n,o){return ln(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Xc=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,a]=s.useState(),[l,c]=s.useState(),[f,u]=s.useState(!1),[g,w]=s.useState(),[b,h]=s.useState(),[m,x]=s.useState(),[C,p]=s.useState(!1),[I,N]=s.useState(),{onHeaderMenuClick:P,onHeaderIndicatorClick:A,getCellContent:L,onColumnMoved:K,onColumnResize:R,onColumnResizeStart:O,onColumnResizeEnd:$,gridRef:Y,maxColumnWidth:E,minColumnWidth:M,onRowMoved:ie,lockColumns:q,onColumnProposeMove:J,onMouseDown:Ce,onMouseUp:de,onItemHovered:j,onDragStart:G,canvasRef:se}=e,Z=(R??$??O)!==void 0,{columns:ce,selection:De}=e,U=De.columns,re=s.useCallback(Q=>{const[me,ke]=Q.location;i!==void 0&&l!==me&&me>=q?(u(!0),c(me)):b!==void 0&&ke!==void 0?(p(!0),x(Math.max(0,ke))):o===void 0&&!f&&!C&&(j==null||j(Q))},[i,b,l,j,q,o,f,C]),ge=K!==void 0,Le=s.useCallback(Q=>{var me;if(Q.button===0){const[ke,Ee]=Q.location;if(Q.kind==="out-of-bounds"&&Q.isEdge&&Z){const be=(me=Y==null?void 0:Y.current)==null?void 0:me.getBounds(ce.length-1,-1);be!==void 0&&(n(be.x),r(ce.length-1))}else if(Q.kind==="header"&&ke>=q){const be=se==null?void 0:se.current;if(Q.isEdge&&Z&&be){n(Q.bounds.x),r(ke);const Ye=be.getBoundingClientRect().width/be.offsetWidth,Ze=Q.bounds.width/Ye;O==null||O(ce[ke],Ze,ke,Ze+(ce[ke].growOffset??0))}else Q.kind==="header"&&ge&&(w(Q.bounds.x),a(ke))}else Q.kind==="cell"&&q>0&&ke===0&&Ee!==void 0&&ie!==void 0&&(N(Q.bounds.y),h(Ee))}Ce==null||Ce(Q)},[Ce,Z,q,ie,Y,ce,ge,O,se]),Xe=s.useCallback((Q,me)=>{f||C||P==null||P(Q,me)},[f,C,P]),tt=s.useCallback((Q,me)=>{f||C||A==null||A(Q,me)},[f,C,A]),st=s.useRef(-1),Re=s.useCallback(()=>{st.current=-1,h(void 0),x(void 0),N(void 0),p(!1),a(void 0),c(void 0),w(void 0),u(!1),r(void 0),n(void 0)},[]),Ae=s.useCallback((Q,me)=>{if(Q.button===0){if(o!==void 0){if((U==null?void 0:U.hasIndex(o))===!0)for(const Ee of U){if(Ee===o)continue;const be=ce[Ee],je=or(be,st.current,M,E);R==null||R(be,je,Ee,je+(be.growOffset??0))}const ke=or(ce[o],st.current,M,E);if($==null||$(ce[o],ke,o,ke+(ce[o].growOffset??0)),U.hasIndex(o))for(const Ee of U){if(Ee===o)continue;const be=ce[Ee],je=or(be,st.current,M,E);$==null||$(be,je,Ee,je+(be.growOffset??0))}}Re(),i!==void 0&&l!==void 0&&(J==null?void 0:J(i,l))!==!1&&(K==null||K(i,l)),b!==void 0&&m!==void 0&&(ie==null||ie(b,m))}de==null||de(Q,me)},[de,o,i,l,b,m,U,$,ce,M,E,R,K,ie,Re,J]),Fe=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(J==null?void 0:J(i,l))!==!1)return{src:i,dest:l}},[i,l,J]),ht=s.useCallback(Q=>{const me=se==null?void 0:se.current;if(i!==void 0&&g!==void 0)Math.abs(Q.clientX-g)>20&&u(!0);else if(b!==void 0&&I!==void 0)Math.abs(Q.clientY-I)>20&&p(!0);else if(o!==void 0&&t!==void 0&&me){const Ee=me.getBoundingClientRect().width/me.offsetWidth,be=(Q.clientX-t)/Ee,je=ce[o],Ye=or(je,be,M,E);if(R==null||R(je,Ye,o,Ye+(je.growOffset??0)),st.current=be,(U==null?void 0:U.first())===o)for(const Ze of U){if(Ze===o)continue;const le=ce[Ze],ye=or(le,st.current,M,E);R==null||R(le,ye,Ze,ye+(le.growOffset??0))}}},[i,g,b,I,o,t,ce,M,E,R,U,se]),gt=s.useCallback((Q,me)=>{if(b===void 0||m===void 0)return L(Q,me);let[ke,Ee]=Q;return Ee===m?Ee=b:(Ee>m&&(Ee-=1),Ee>=b&&(Ee+=1)),L([ke,Ee],me)},[b,m,L]),dt=s.useCallback(Q=>{G==null||G(Q),Q.defaultPrevented()||Re()},[Re,G]);return s.createElement(Nc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:gt,isResizing:o!==void 0,onHeaderMenuClick:Xe,onHeaderIndicatorClick:tt,isDragging:f,onItemHovered:re,onDragStart:dt,onMouseDown:Le,allowResize:Z,onMouseUp:Ae,dragAndDropState:Fe,onMouseMoveRaw:ht,ref:Y})};function Yc(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=a=>{for(const l of a){const{width:c,height:f}=l&&l.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Gc=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),a=s.useRef(0),l=s.useRef(t);l.current=t;const c=n.current;s.useEffect(()=>{const f=()=>{var w,b;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((w=i.current)==null?void 0:w[0])===h[0]&&((b=i.current)==null?void 0:b[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},g=w=>{w.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const w=c;return w.addEventListener("touchstart",u),w.addEventListener("touchend",g),()=>{w.removeEventListener("touchstart",u),w.removeEventListener("touchend",g),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},_c=()=>e=>e.isSafari?"scroll":"auto",Kc=en("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[_c()]}}),Uc=33554400,Vc=5e6;function qc(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Gt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Gt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const jc=e=>{var De,U;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:l,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:g,rightElementProps:w,kineticScrollPerfHack:b=!1,scrollRef:h,initialSize:m}=e,x=[],C=(w==null?void 0:w.sticky)??!1,p=(w==null?void 0:w.fill)??!1,I=s.useRef(0),N=s.useRef(0),P=s.useRef(null),A=typeof window>"u"?1:window.devicePixelRatio,L=s.useRef(A);s.useEffect(()=>{if(L.current!==A){I.current=0,N.current=0,L.current=A;const re=P.current;re!==null&&ie.current(re.scrollLeft,re.scrollTop)}},[A]);const K=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),R=s.useRef(null),O=qc(200),[$,Y]=s.useState(!0),E=s.useRef(0);s.useLayoutEffect(()=>{if(!$||O||K.current.lockDirection===void 0)return;const re=P.current;if(re===null)return;const[ge,Le]=K.current.lockDirection;ge!==void 0?re.scrollLeft=ge:Le!==void 0&&(re.scrollTop=Le),K.current.lockDirection=void 0},[O,$]);const M=s.useCallback((re,ge)=>{var ke;const Le=P.current;if(Le===null)return;ge=ge??Le.scrollTop,re=re??Le.scrollLeft;const Xe=K.current.scrollTop,tt=K.current.scrollLeft,st=re-tt,Re=ge-Xe;O&&st!==0&&Re!==0&&(Math.abs(st)>3||Math.abs(Re)>3)&&c&&K.current.lockDirection===void 0&&(K.current.lockDirection=Math.abs(st)<Math.abs(Re)?[tt,void 0]:[void 0,Xe]);const Ae=K.current.lockDirection;re=(Ae==null?void 0:Ae[0])??re,ge=(Ae==null?void 0:Ae[1])??ge,K.current.scrollLeft=re,K.current.scrollTop=ge;const Fe=Le.clientWidth,ht=Le.clientHeight,gt=ge,dt=N.current-gt,Q=Le.scrollHeight-ht;N.current=gt;let me;if(Q>0&&o>Le.scrollHeight+5)if(Math.abs(dt)>2e3||gt===0||gt===Q){const Ee=Math.max(0,Math.min(1,gt/Q)),be=o-ht;me=Ee*be,I.current=me}else I.current-=dt,me=I.current;else me=gt,I.current=me;me=Math.max(0,Math.min(me,o-ht)),I.current=me,Ae!==void 0&&(window.clearTimeout(E.current),Y(!1),E.current=window.setTimeout(()=>Y(!0),200)),i({x:re,y:me,width:Fe-u,height:ht-f,paddingRight:((ke=R.current)==null?void 0:ke.clientWidth)??0})},[f,u,o,i,c,O]);Gc(b&&Or.value,M,P);const ie=s.useRef(M);ie.current=M;const q=s.useRef(),J=s.useRef(!1);s.useLayoutEffect(()=>{J.current?M():J.current=!0},[M,f,u]);const Ce=s.useCallback(re=>{P.current=re,h!==void 0&&(h.current=re)},[h]);let de=0,j=0;const G=Math.min(o,Uc);for(x.push(s.createElement("div",{key:de++,style:{width:r,height:0}}));j<G;){const re=Math.min(Vc,G-j);x.push(s.createElement("div",{key:de++,style:{width:0,height:re}})),j+=re}const{ref:se,width:Z,height:ce}=Yc(m);return typeof window<"u"&&(((De=q.current)==null?void 0:De.height)!==ce||((U=q.current)==null?void 0:U.width)!==Z)&&(window.setTimeout(()=>ie.current(),0),q.current={width:Z,height:ce}),(Z??0)===0||(ce??0)===0?s.createElement("div",{ref:se}):s.createElement("div",{ref:se},s.createElement(Kc,{isSafari:Or.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:Ce,style:q.current,draggable:a,onDragStart:re=>{a||(re.stopPropagation(),re.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>M()},s.createElement("div",{className:"dvn-scroll-inner"+(g===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},x),g!==void 0&&s.createElement(s.Fragment,null,!p&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:R,style:{height:ce,maxHeight:n-Math.ceil(A%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:p?1:void 0,right:C?u??0:void 0,pointerEvents:"auto"}},g))))))},Zc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:l,experimental:c,nonGrowWidth:f,clientSize:u,className:g,onVisibleRegionChanged:w,scrollRef:b,preventDiagonalScrolling:h,rightElement:m,rightElementProps:x,overscrollX:C,overscrollY:p,initialSize:I,smoothScrollX:N=!1,smoothScrollY:P=!1,isDraggable:A}=e,{paddingRight:L,paddingBottom:K}=c??{},[R,O]=u,$=s.useRef(),Y=s.useRef(),E=s.useRef(),M=s.useRef(),ie=f+Math.max(0,C??0);let q=a?r+i:r;if(typeof o=="number")q+=n*o;else for(let j=0;j<n;j++)q+=o(j);p!==void 0&&(q+=p);const J=s.useRef(),Ce=s.useCallback(()=>{var tt,st;if(J.current===void 0)return;const j={...J.current};let G=0,se=j.x<0?-j.x:0,Z=0,ce=0;j.x=j.x<0?0:j.x;let De=0;for(let Re=0;Re<l;Re++)De+=t[Re].width;for(const Re of t){const Ae=G-De;if(j.x>=Ae+Re.width)G+=Re.width,ce++,Z++;else if(j.x>Ae)G+=Re.width,N?se+=Ae-j.x:ce++,Z++;else if(j.x+j.width>Ae)G+=Re.width,Z++;else break}let U=0,re=0,ge=0;if(typeof o=="number")P?(re=Math.floor(j.y/o),U=re*o-j.y):re=Math.ceil(j.y/o),ge=Math.ceil(j.height/o)+re,U<0&&ge++;else{let Re=0;for(let Ae=0;Ae<n;Ae++){const Fe=o(Ae),ht=Re+(P?0:Fe/2);if(j.y>=Re+Fe)Re+=Fe,re++,ge++;else if(j.y>ht)Re+=Fe,P?U+=ht-j.y:re++,ge++;else if(j.y+j.height>Fe/2+Re)Re+=Fe,ge++;else break}}re=Math.max(0,Math.min(re,n-1)),ge=Math.max(re,Math.min(ge,n));const Le={x:ce,y:re,width:Z-ce,height:ge-re},Xe=$.current;(Xe===void 0||Xe.y!==Le.y||Xe.x!==Le.x||Xe.height!==Le.height||Xe.width!==Le.width||Y.current!==se||E.current!==U||j.width!==((tt=M.current)==null?void 0:tt[0])||j.height!==((st=M.current)==null?void 0:st[1]))&&(w==null||w({x:ce,y:re,width:Z-ce,height:ge-re},j.width,j.height,j.paddingRight??0,se,U),$.current=Le,Y.current=se,E.current=U,M.current=[j.width,j.height])},[t,o,n,w,l,N,P]),de=s.useCallback(j=>{J.current=j,Ce()},[Ce]);return s.useEffect(()=>{Ce()},[Ce]),s.createElement(jc,{scrollRef:b,className:g,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:A===!0||typeof A=="string",scrollWidth:ie+(L??0),scrollHeight:q+(K??0),clientHeight:O,rightElement:m,paddingBottom:K,paddingRight:L,rightElementProps:x,update:de,initialSize:I},s.createElement(Xc,{eventTargetRef:b,width:R,height:O,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Jc=en("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Qc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),ed=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),td=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),nd=10,od=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:l,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:g=!1,onSearchClose:w}=e,[b]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,m]=s.useState(""),x=a??h,C=s.useCallback(G=>{m(G),c==null||c(G)},[c]),[p,I]=s.useState(),N=s.useRef(p);N.current=p,s.useEffect(()=>{l!==void 0&&(l.length>0?I(G=>({rowsSearched:o,results:l.length,selectedIndex:(G==null?void 0:G.selectedIndex)??-1})):I(void 0))},[o,l]);const P=s.useRef();P.current===void 0&&(P.current=new AbortController);const A=s.useRef(),[L,K]=s.useState([]),R=l??L,O=s.useCallback(()=>{A.current!==void 0&&(window.cancelAnimationFrame(A.current),A.current=void 0),P.current!==void 0&&P.current.abort(),P.current=new AbortController},[]),$=s.useRef(n);$.current=n;const Y=s.useCallback(G=>{const se=new RegExp(G.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let Z=$.current,ce=Math.min(10,o),De=0;I(void 0),K([]);const U=[],re=async()=>{var gt;if(f===void 0)return;const ge=performance.now(),Le=o-De;let Xe=f({x:0,y:Z,width:r.length,height:Math.min(ce,Le,o-Z)},P.current.signal);typeof Xe=="function"&&(Xe=await Xe());let tt=!1;for(const[dt,Q]of Xe.entries())for(const[me,ke]of Q.entries()){let Ee;switch(ke.kind){case oe.Text:case oe.Number:Ee=ke.displayData;break;case oe.Uri:case oe.Markdown:Ee=ke.data;break;case oe.Boolean:Ee=typeof ke.data=="boolean"?ke.data.toString():void 0;break;case oe.Image:case oe.Bubble:Ee=ke.data.join("🐳");break;case oe.Custom:Ee=ke.copyData;break}Ee!==void 0&&se.test(Ee)&&(U.push([me,dt+Z]),tt=!0)}const st=performance.now();tt&&K([...U]),De+=Xe.length,Jt(De<=o);const Re=((gt=N.current)==null?void 0:gt.selectedIndex)??-1;I({results:U.length,rowsSearched:De,selectedIndex:Re}),u==null||u(U,Re),Z+ce>=o?Z=0:Z+=ce;const Ae=st-ge,Fe=Math.max(Ae,1),ht=nd/Fe;ce=Math.ceil(ce*ht),De<o&&U.length<1e3&&(A.current=window.requestAnimationFrame(re))};O(),A.current=window.requestAnimationFrame(re)},[O,r.length,f,u,o]),E=s.useCallback(()=>{var G;w==null||w(),I(void 0),K([]),u==null||u([],-1),O(),(G=t==null?void 0:t.current)==null||G.focus()},[O,t,w,u]),M=s.useCallback(G=>{C(G.target.value),l===void 0&&(G.target.value===""?(I(void 0),K([]),O()):Y(G.target.value))},[Y,O,C,l]);s.useEffect(()=>{i.current!==null&&(C(""),I(void 0),L.length>0&&(K([]),u==null||u([],-1)),g?i.current.focus({preventScroll:!0}):O())},[g,i]);const ie=s.useCallback(G=>{var Z;if((Z=G==null?void 0:G.stopPropagation)==null||Z.call(G),p===void 0||p.results===0)return;const se=(p.selectedIndex+1)%p.results;I({...p,selectedIndex:se}),u==null||u(R,se)},[p,u,R]),q=s.useCallback(G=>{var Z;if((Z=G==null?void 0:G.stopPropagation)==null||Z.call(G),p===void 0||p.results===0)return;let se=(p.selectedIndex-1)%p.results;se<0&&(se+=p.results),I({...p,selectedIndex:se}),u==null||u(R,se)},[u,R,p]),J=s.useCallback(G=>{(G.ctrlKey||G.metaKey)&&G.nativeEvent.code==="KeyF"||G.key==="Escape"?(E(),G.stopPropagation(),G.preventDefault()):G.key==="Enter"&&(G.shiftKey?q():ie())},[E,ie,q]);s.useEffect(()=>()=>{O()},[O]);const[Ce,de]=s.useState(!1);s.useEffect(()=>{if(g)de(!0);else{const G=setTimeout(()=>de(!1),150);return()=>clearTimeout(G)}},[g]);const j=s.useMemo(()=>{if(!g&&!Ce)return null;let G;p!==void 0&&(G=p.results>=1e3?"over 1000":`${p.results} result${p.results!==1?"s":""}`,p.selectedIndex>=0&&(G=`${p.selectedIndex+1} of ${G}`));const se=De=>{De.stopPropagation()},ce={width:`${o>0?Math.floor(((p==null?void 0:p.rowsSearched)??0)/o*100):0}%`};return s.createElement(Jc,{className:"gdg-search-bar"+(g?"":" out"),onMouseDown:se,onMouseMove:se,onMouseUp:se,onClick:se},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:b,"aria-hidden":!g,"data-testid":"search-input",ref:i,onChange:M,value:x,tabIndex:g?void 0:-1,onKeyDownCapture:J}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:q,disabled:((p==null?void 0:p.results)??0)===0},Qc),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:ie,disabled:((p==null?void 0:p.results)??0)===0},ed),w!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!g,"data-testid":"search-close-button",tabIndex:g?void 0:-1,onClick:E},td)),p!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},G)),s.createElement("div",{className:"gdg-search-progress",style:ce})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:b},"Type to search")))},[g,Ce,p,o,b,i,M,x,J,q,ie,w,E]);return s.createElement(s.Fragment,null,s.createElement(Zc,{prelightCells:R,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),j)};class rd extends s.PureComponent{constructor(){super(...arguments);$e(this,"wrapperRef",s.createRef());$e(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const id=()=>e=>Math.max(16,e.targetHeight-10),ld=en("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[id(),"px"]}}),sd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,l]=xt.useState(n);return xt.createElement(rd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},xt.createElement(ld,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,a.length),onChange:c=>l(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(a):c.key==="Escape"&&o()},autoFocus:!0}))};function ad(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Oe(e,t,n){const o=ds(e,t);return o&&(n.didMatch=!0),o}function ds(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(ds(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),l=a.pop();if(!ad(l,t))return!1;if(a[0]==="any")return!0;for(const c of a)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Nr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function cd(e,t,n,o,r,i,a){const l=xt.useCallback((u,g,w,b)=>{var I;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!a&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(w||b==="drag")||n==="additive",m=(o==="mixed"||o==="additive")&&h,x=(r==="mixed"||r==="additive")&&h;let C={current:u===void 0?void 0:{...u,rangeStack:b==="drag"?((I=e.current)==null?void 0:I.rangeStack)??[]:[]},columns:m?e.columns:it.empty(),rows:x?e.rows:it.empty()};w&&(i==="multi-rect"||i==="multi-cell")&&C.current!==void 0&&e.current!==void 0&&(C={...C,current:{...C.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(C,g)},[o,e,n,i,a,r,t]),c=xt.useCallback((u,g,w)=>{u=u??e.rows,g!==void 0&&(u=u.add(g));let b;if(r==="exclusive"&&u.length>0)b={current:void 0,columns:it.empty(),rows:u};else{const h=w&&n==="mixed"||n==="additive",m=w&&o==="mixed"||o==="additive";b={current:h?e.current:void 0,columns:m?e.columns:it.empty(),rows:u}}t(b,!1)},[o,e,n,r,t]),f=xt.useCallback((u,g,w)=>{u=u??e.columns,g!==void 0&&(u=u.add(g));let b;if(o==="exclusive"&&u.length>0)b={current:void 0,rows:it.empty(),columns:u};else{const h=w&&n==="mixed"||n==="additive",m=w&&r==="mixed"||r==="additive";b={current:h?e.current:void 0,rows:m?e.rows:it.empty(),columns:u}}t(b,!1)},[o,e,n,r,t]);return[l,c,f]}function dd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let g=f.y;g<f.y+f.height;g++){const w=[];for(let b=f.x;b<f.x+f.width;b++)b<0||g>=r?w.push({kind:oe.Loading,allowOverlay:!1}):w.push(t([b,g]));u.push(w)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,l=s.useCallback(f=>{if(a===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const g=a(u,o.signal);return typeof g=="function"?async()=>(await g()).map(w=>[{kind:oe.Loading,allowOverlay:!1},...w]):g.map(w=>[{kind:oe.Loading,allowOverlay:!1},...w])}return a(u,o.signal)},[o.signal,a,n]);return[e!==void 0?l:void 0,a]}function ud(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case oe.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Hi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case oe.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case oe.Image:case oe.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case oe.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case oe.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case oe.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case oe.Markdown:case oe.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case oe.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case oe.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case oe.Protected:return{formatted:"************",rawValue:"",format:"string"};default:sr()}}function fd(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:ud(a))})}function xl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function hd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>xl(a,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:xl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Ci(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function kl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function gd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function md(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Ci(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,l)=>`<li gdg-raw-value=${kl(r.rawValue[l])}>`+Ci(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${kl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Ci(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function wd(e,t){const n=fd(e,t),o=hd(n),r=md(n);return{textPlain:o,textHtml:r}}function Sl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const c=l.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",w=c.querySelectorAll("br");for(const m of w)m.replaceWith(`
`);const b=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((a=c.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const m=c.querySelectorAll("li");i==null||i.push({rawValue:[...m].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...m].map(x=>x.textContent??""),format:"string-array"})}else if(b!==null)i==null||i.push({rawValue:gd(b),formatted:c.textContent??"",format:h});else{let m=c.textContent??"";g&&(m=m.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:m??"",formatted:m??"",format:h})}}}return i!==void 0&&r.push(i),r}function bd(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(l=e.current)==null?void 0:l.range,f=[];if(c.width>2){const w=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w);const b=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof b=="function")return i;f.push(...b)}else{const w=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w)}let u=c.x-n,g=c.x+c.width-1-n;for(const w of f)for(const b of w)b.span!==void 0&&(u=Math.min(b.span[0],u),g=Math.max(b.span[1],g));u===c.x-n&&g===c.x+c.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:g-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function Ml(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function yd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,a)),r=a+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Ml(e.slice(r,a))),r=a+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(Ml(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Rl(e,t,n){var l;const o=wd(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},a=(c,f)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",f)}catch{i(c,f)||r(c)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function us(e){return e!==!0}function El(e){return typeof e=="string"?e:`${e}px`}const pd=()=>e=>e.innerWidth,vd=()=>e=>e.innerHeight,Cd=en("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[pd()],"wmyidgi-1":[vd()]}}),xd=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(Cd,{innerHeight:El(n),innerWidth:El(t),...r},o)},kd=2,Sd=1300;function Md(e,t,n){const o=xt.useRef(0),[r,i]=e??[0,0];xt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,l=0;const c=f=>{var u;if(!a){if(l===0)l=f;else{const g=f-l;o.current=Math.min(1,o.current+g/Sd);const w=o.current**1.618*g*kd;(u=t.current)==null||u.scrollBy(r*w,i*w),l=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{a=!0}},[t,r,i,n])}function Rd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:l}){const[c,f,u,g,w,b]=xt.useMemo(()=>{if(!a||l===16)return[e,t,n,o,r,i];const h=l/16,m=e,x=jl();return[typeof m=="number"?m*h:C=>Math.ceil(m(C)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,a,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:g,overscrollX:w,overscrollY:b}}const qn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Ne(e,t){return e===!0?t:e===!1?"":e}function Il(e){const t=Nr.value;return{activateCell:Ne(e.activateCell," |Enter|shift+Enter"),clear:Ne(e.clear,"any+Escape"),closeOverlay:Ne(e.closeOverlay,"any+Escape"),acceptOverlayDown:Ne(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Ne(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Ne(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Ne(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Ne(e.delete,t?"Backspace|Delete":"Delete"),downFill:Ne(e.downFill,"primary+_68"),scrollToSelectedCell:Ne(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Ne(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Ne(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Ne(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Ne(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Ne(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Ne(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Ne(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Ne(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Ne(e.goToFirstCell,"primary+Home"),goToFirstColumn:Ne(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Ne(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Ne(e.goToLastCell,"primary+End"),goToLastColumn:Ne(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Ne(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Ne(e.goToNextPage,"PageDown"),goToPreviousPage:Ne(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Ne(e.rightFill,"primary+_82"),search:Ne(e.search,"primary+f"),selectAll:Ne(e.selectAll,"primary+a"),selectColumn:Ne(e.selectColumn,"ctrl+ "),selectGrowDown:Ne(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Ne(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Ne(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Ne(e.selectGrowUp,"shift+ArrowUp"),selectRow:Ne(e.selectRow,"shift+ "),selectToFirstCell:Ne(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Ne(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Ne(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Ne(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Ne(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Ne(e.selectToLastRow,"primary+shift+ArrowDown")}}function Ed(e){const t=ha(e);return xt.useMemo(()=>{if(t===void 0)return Il(qn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??qn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??qn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??qn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??qn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??qn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??qn.selectToLastCell};return Il({...qn,...n})},[t])}function Id(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const a={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(a.subGroups=o.subGroups.map((l,c)=>t(l,r+1,[...i,c])).sort((l,c)=>l.headerIndex-c.headerIndex)),a}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Oi(e,t){const n=[];function o(l,c,f=!1){let u=c!==null?c-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let g=0;g<l.subGroups.length;g++){const w=g<l.subGroups.length-1?l.subGroups[g+1].headerIndex:c;o(l.subGroups[g],w,f||l.isCollapsed)}}const r=Id(e.groups);for(let l=0;l<r.length;l++){const c=l<r.length-1?r[l+1].headerIndex:null;o(r[l],c)}let i=0,a=0;for(const l of n)l.contentIndex=a,a+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:c,...f}=l;return f})}function Fi(e,t){if(t===void 0||Oi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Dd(e,t,n,o){const r=xt.useMemo(()=>e===void 0?void 0:Oi(e,t),[e,t]),i=xt.useMemo(()=>r==null?void 0:r.reduce((u,g)=>(u[g.rowIndex]=g,u),{}),[r]),a=xt.useMemo(()=>r===void 0?t:r.reduce((u,g)=>u+(g.isCollapsed?1:g.rows+1),0),[r,t]),l=xt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),c=xt.useCallback(u=>{if(r===void 0)return u;let g=u;for(const w of r){if(g===0)return;if(g--,!w.isCollapsed){if(g<w.rows)return w.contentIndex+g;g-=w.rows}}return u},[r]),f=jn(o??(e==null?void 0:e.themeOverride),xt.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:g,contentIndex:w,groupIndex:b}=Fi(u,r);return g?e.themeOverride:o==null?void 0:o(u,b,w)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:c,getRowThemeOverride:f}:{rowHeight:l,rows:a,rowNumberMapper:c,getRowThemeOverride:f}}function Fd(e,t){const n=xt.useMemo(()=>e===void 0?void 0:Oi(e,t),[e,t]);return{getRowGroupingForPath:hs,updateRowGroupingByPath:fs,mapper:xt.useCallback(o=>{if(typeof o=="number")return Fi(o,n);const r=Fi(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function fs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,a)=>a===o?{...i,...n}:i):e.map((i,a)=>a===o?{...i,subGroups:fs(i.subGroups??[],r,n)}:i)}function hs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:hs(e[n].subGroups??[],o)}function Hd(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Td(e,t,n,o,r){const[i,a]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:a}),[o,a,i]),[c,f,u]=fa(l),g=s.useRef(r);g.current=r;const w=Hd(null,m=>{m!==null&&t!==void 0?m.scrollTop=t:m!==null&&e!==void 0&&(m.scrollLeft=e)}),b=(c.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&w.current!==null&&b){if(w.current.scrollTop===t)return;w.current.scrollTop=t,w.current.scrollTop!==t&&u(),g.current()}},[t,b,u,w]);const h=(c.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&w.current!==null&&h){if(w.current.scrollLeft===e)return;w.current.scrollLeft=e,w.current.scrollLeft!==e&&u(),g.current()}},[e,h,u,w]),{visibleRegion:c,setVisibleRegion:f,scrollRef:w}}const Ad=s.lazy(async()=>await Tl(()=>import("./data-grid-overlay-editor-D2cYrmn0.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let zd=0;function Pd(e){return ta(rl(rl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return fo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Ar(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const zr={kind:oe.Loading,allowOverlay:!1},Pr={columns:it.empty(),rows:it.empty(),current:void 0},Bd=(e,t)=>{var tl,nl,ol;const[n,o]=s.useState(Pr),[r,i]=s.useState(),a=s.useRef(null),l=s.useRef(null),[c,f]=s.useState(),u=s.useRef(),g=typeof window>"u"?null:window,{imageEditorOverride:w,getRowThemeOverride:b,markdownDivCreateNode:h,width:m,height:x,columns:C,rows:p,getCellContent:I,onCellClicked:N,onCellActivated:P,onFillPattern:A,onFinishedEditing:L,coercePasteValue:K,drawHeader:R,drawCell:O,editorBloom:$,onHeaderClicked:Y,onColumnProposeMove:E,rangeSelectionColumnSpanning:M=!0,spanRangeBehavior:ie="default",onGroupHeaderClicked:q,onCellContextMenu:J,className:Ce,onHeaderContextMenu:de,getCellsForSelection:j,onGroupHeaderContextMenu:G,onGroupHeaderRenamed:se,onCellEdited:Z,onCellsEdited:ce,onSearchResultsChanged:De,searchResults:U,onSearchValueChange:re,searchValue:ge,onKeyDown:Le,onKeyUp:Xe,keybindings:tt,editOnType:st=!0,onRowAppended:Re,onColumnAppended:Ae,onColumnMoved:Fe,validateCell:ht,highlightRegions:gt,rangeSelect:dt="rect",columnSelect:Q="multi",rowSelect:me="multi",rangeSelectionBlending:ke="exclusive",columnSelectionBlending:Ee="exclusive",rowSelectionBlending:be="exclusive",onDelete:je,onDragStart:Ye,onMouseMove:Ze,onPaste:le,copyHeaders:ye=!1,freezeColumns:Ge=0,cellActivationBehavior:_e="second-click",rowSelectionMode:Qe="auto",columnSelectionMode:mt="auto",onHeaderMenuClick:ot,onHeaderIndicatorClick:Pe,getGroupDetails:kt,rowGrouping:Ft,onSearchClose:Lt,onItemHovered:vt,onSelectionCleared:It,showSearch:Bt,onVisibleRegionChanged:an,gridSelection:_t,onGridSelectionChange:lt,minColumnWidth:Rn=50,maxColumnWidth:cn=500,maxColumnAutoWidth:wt,provideEditor:Wt,trailingRowOptions:Ke,freezeTrailingRows:Ht=0,allowedFillDirections:qt="orthogonal",scrollOffsetX:et,scrollOffsetY:Dt,verticalBorder:at,onDragOverCell:tn,onDrop:Nt,onColumnResize:Kt,onColumnResizeEnd:En,onColumnResizeStart:ut,customRenderers:Ln,fillHandle:Tt,experimental:Ue,fixedShadowX:In,fixedShadowY:ur,headerIcons:Wn,imageWindowLoader:Dn,initialSize:Fn,isDraggable:mo,onDragLeave:fr,onRowMoved:$n,overscrollX:wo,overscrollY:bo,preventDiagonalScrolling:yo,rightElement:po,rightElementProps:to,trapFocus:Hn=!1,smoothScrollX:_r,smoothScrollY:hr,scaleToRem:Kr=!1,rowHeight:Ur=34,headerHeight:yn=36,groupHeaderHeight:On=yn,theme:Vr,isOutsideClick:qr,renderers:vo,resizeIndicator:gr,scrollToActiveCell:no=!0,drawFocusRing:jr=!0,portalElementRef:mr}=e,Co=jr==="no-editor"?r===void 0:jr,ft=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Xt=(ft==null?void 0:ft.kind)??e.rowMarkers??"none",xo=(ft==null?void 0:ft.width)??e.rowMarkerWidth,Tn=(ft==null?void 0:ft.startIndex)??e.rowMarkerStartIndex??1,ko=(ft==null?void 0:ft.theme)??e.rowMarkerTheme,Nn=ft==null?void 0:ft.headerTheme,So=ft==null?void 0:ft.headerAlwaysVisible,Mo=me!=="multi"||(ft==null?void 0:ft.headerDisabled)===!0,oo=(ft==null?void 0:ft.checkboxStyle)??"square",Xn=Math.max(Rn,20),Ro=Math.max(cn,Xn),Zr=Math.max(wt??Ro,Xn),_o=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Se,rowNumberMapper:Ko,rowHeight:wr,getRowThemeOverride:dn}=Dd(Ft,p,Ur,b),Jr=s.useMemo(()=>Number.parseFloat(_o.fontSize),[_o]),{rowHeight:pn,headerHeight:Uo,groupHeaderHeight:br,theme:Eo,overscrollX:Qr,overscrollY:ei}=Rd({groupHeaderHeight:On,headerHeight:yn,overscrollX:wo,overscrollY:bo,remSize:Jr,rowHeight:wr,scaleToRem:Kr,theme:Vr}),vn=Ed(tt),Yn=xo??(p>1e4?48:p>1e3?44:p>100?36:32),jt=Xt!=="none",D=jt?1:0,pt=Ke!==void 0,An=(Ke==null?void 0:Ke.sticky)===!0,[ti,ro]=s.useState(!1),ni=Bt??ti,Io=s.useCallback(()=>{Lt!==void 0?Lt():ro(!1)},[Lt]),B=s.useMemo(()=>_t===void 0?void 0:Ar(_t,D),[_t,D])??n,S=s.useRef();S.current===void 0&&(S.current=new AbortController),s.useEffect(()=>()=>S==null?void 0:S.current.abort(),[]);const[X,ue]=dd(j,I,D,S.current,Se),fe=s.useCallback((d,y,v)=>{if(ht===void 0)return!0;const k=[d[0]-D,d[1]];return ht==null?void 0:ht(k,y,v)},[D,ht]),te=s.useRef(_t),ne=s.useCallback((d,y)=>{y&&(d=bd(d,X,D,ie,S.current)),lt!==void 0?(te.current=Ar(d,-D),lt(te.current)):o(d)},[lt,X,D,ie]),Me=jn(Kt,s.useCallback((d,y,v,k)=>{Kt==null||Kt(C[v-D],y,v-D,k)},[Kt,D,C])),Ve=jn(En,s.useCallback((d,y,v,k)=>{En==null||En(C[v-D],y,v-D,k)},[En,D,C])),we=jn(ut,s.useCallback((d,y,v,k)=>{ut==null||ut(C[v-D],y,v-D,k)},[ut,D,C])),At=jn(R,s.useCallback((d,y)=>(R==null?void 0:R({...d,columnIndex:d.columnIndex-D},y))??!1,[R,D])),pe=jn(O,s.useCallback((d,y)=>(O==null?void 0:O({...d,col:d.col-D},y))??!1,[O,D])),qe=s.useCallback(d=>{if(je!==void 0){const y=je(Ar(d,-D));return typeof y=="boolean"?y:Ar(y,D)}return!0},[je,D]),[ze,Be,He]=cd(B,ne,ke,Ee,be,dt,M),Je=s.useMemo(()=>Bn(jl(),Eo),[Eo]),[St,un]=s.useState([0,0,0]),fn=s.useMemo(()=>{if(vo===void 0)return{};const d={};for(const y of vo)d[y.kind]=y;return d},[vo]),bt=s.useCallback(d=>d.kind!==oe.Custom?fn[d.kind]:Ln==null?void 0:Ln.find(y=>y.isMatch(d)),[Ln,fn]);let{sizedColumns:Rt,nonGrowWidth:ct}=Wa(C,Se,ue,St[0]-(D===0?0:Yn)-St[2],Xn,Zr,Je,bt,S.current);Xt!=="none"&&(ct+=Yn);const nn=s.useMemo(()=>Rt.some(d=>d.group!==void 0),[Rt]),$t=nn?Uo+br:Uo,Do=B.rows.length,zn=Xt==="none"?void 0:Do===0?!1:Do===Se?!0:void 0,We=s.useMemo(()=>Xt==="none"?Rt:[{title:"",width:Yn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:ko,rowMarker:oo,rowMarkerChecked:zn,headerRowMarkerTheme:Nn,headerRowMarkerAlwaysVisible:So,headerRowMarkerDisabled:Mo},...Rt],[Xt,Rt,Yn,ko,oo,zn,Nn,So,Mo]),zt=s.useRef({height:1,width:1,x:0,y:0}),io=s.useRef(!1),{setVisibleRegion:Gn,visibleRegion:Pn,scrollRef:rt}=Td(et,Dt,pn,zt,()=>io.current=!0);zt.current=Pn;const ws=Pn.x+D,yr=Pn.y,Et=s.useRef(null),Yt=s.useCallback(d=>{var y;d===!0?(y=Et.current)==null||y.focus():window.requestAnimationFrame(()=>{var v;(v=Et.current)==null||v.focus()})},[]),Ot=pt?Se+1:Se,on=s.useCallback(d=>{const y=D===0?d:d.map(k=>({...k,location:[k.location[0]-D,k.location[1]]})),v=ce==null?void 0:ce(y);if(v!==!0)for(const k of y)Z==null||Z(k.location,k.value);return v},[Z,ce,D]),[lo,oi]=s.useState(),pr=B.current!==void 0&&B.current.range.width*B.current.range.height>1?B.current.range:void 0,Fo=Co?(tl=B.current)==null?void 0:tl.cell:void 0,vr=Fo==null?void 0:Fo[0],Cr=Fo==null?void 0:Fo[1],bs=s.useMemo(()=>{if((gt===void 0||gt.length===0)&&(pr??vr??Cr??lo)===void 0)return;const d=[];if(gt!==void 0)for(const y of gt){const v=We.length-y.range.x-D;v>0&&d.push({color:y.color,range:{...y.range,x:y.range.x+D,width:Math.min(v,y.range.width)},style:y.style})}return lo!==void 0&&d.push({color:go(Je.accentColor,0),range:lo,style:"dashed"}),pr!==void 0&&d.push({color:go(Je.accentColor,.5),range:pr,style:"solid-outline"}),vr!==void 0&&Cr!==void 0&&d.push({color:Je.accentColor,range:{x:vr,y:Cr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[lo,pr,vr,Cr,gt,We.length,Je.accentColor,D]),Xi=s.useRef(We);Xi.current=We;const Zt=s.useCallback(([d,y],v=!1)=>{var W,H,F,z,_,ee,ae;const k=pt&&y===Ot-1;if(d===0&&jt){if(k)return zr;const V=Ko(y);return V===void 0?zr:{kind:sn.Marker,allowOverlay:!1,checkboxStyle:oo,checked:(B==null?void 0:B.rows.hasIndex(y))===!0,markerKind:Xt==="clickable-number"?"number":Xt,row:Tn+V,drawHandle:$n!==void 0,cursor:Xt==="clickable-number"?"pointer":void 0}}else if(k){const xe=d===D?(Ke==null?void 0:Ke.hint)??"":"",he=Xi.current[d];if(((W=he==null?void 0:he.trailingRowOptions)==null?void 0:W.disabled)===!0)return zr;{const Te=((H=he==null?void 0:he.trailingRowOptions)==null?void 0:H.hint)??xe,Ie=((F=he==null?void 0:he.trailingRowOptions)==null?void 0:F.addIcon)??(Ke==null?void 0:Ke.addIcon);return{kind:sn.NewRow,hint:Te,allowOverlay:!1,icon:Ie}}}else{const V=d-D;if(v||(Ue==null?void 0:Ue.strict)===!0){const he=zt.current,Te=he.x>V||V>he.x+he.width||he.y>y||y>he.y+he.height||y>=si.current,Ie=V===((_=(z=he.extras)==null?void 0:z.selected)==null?void 0:_[0])&&y===((ee=he.extras)==null?void 0:ee.selected[1]);let ve=!1;if(((ae=he.extras)==null?void 0:ae.freezeRegions)!==void 0){for(const nt of he.extras.freezeRegions)if(ho(nt,V,y)){ve=!0;break}}if(Te&&!Ie&&!ve)return zr}let xe=I([V,y]);return D!==0&&xe.span!==void 0&&(xe={...xe,span:[xe.span[0]+D,xe.span[1]+D]}),xe}},[pt,Ot,jt,Ko,oo,B==null?void 0:B.rows,Xt,Tn,$n,D,Ke==null?void 0:Ke.hint,Ke==null?void 0:Ke.addIcon,Ue==null?void 0:Ue.strict,I]),ri=s.useCallback(d=>{let y=(kt==null?void 0:kt(d))??{name:d};return se!==void 0&&d!==""&&(y={icon:y.icon,name:y.name,overrideTheme:y.overrideTheme,actions:[...y.actions??[],{title:"Rename",icon:"renameIcon",onClick:v=>ci({group:y.name,bounds:v.bounds})}]}),y},[kt,se]),Ho=s.useCallback(d=>{var F;const[y,v]=d.cell,k=We[y],T=(k==null?void 0:k.group)!==void 0?(F=ri(k.group))==null?void 0:F.overrideTheme:void 0,W=k==null?void 0:k.themeOverride,H=dn==null?void 0:dn(v);i({...d,theme:Bn(Je,T,W,H,d.content.themeOverride)})},[dn,We,ri,Je]),To=s.useCallback((d,y,v)=>{var H;if(B.current===void 0)return;const[k,T]=B.current.cell,W=Zt([k,T]);if(W.kind!==oe.Boolean&&W.allowOverlay){let F=W;if(v!==void 0)switch(F.kind){case oe.Number:{const z=oa(()=>v==="-"?-0:Number.parseFloat(v),0);F={...F,data:Number.isNaN(z)?0:z};break}case oe.Text:case oe.Markdown:case oe.Uri:F={...F,data:v};break}Ho({target:d,content:F,initialValue:v,cell:[k,T],highlight:v===void 0,forceEditMode:v!==void 0,activation:y})}else W.kind===oe.Boolean&&y.inputType==="keyboard"&&W.readonly!==!0&&(on([{location:B.current.cell,value:{...W,data:us(W.data)}}]),(H=Et.current)==null||H.damage([{cell:B.current.cell}]))},[Zt,B,on,Ho]),Yi=s.useCallback((d,y)=>{var T;const v=(T=Et.current)==null?void 0:T.getBounds(d,y);if(v===void 0||rt.current===null)return;const k=Zt([d,y]);k.allowOverlay&&Ho({target:v,content:k,initialValue:void 0,highlight:!0,cell:[d,y],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Zt,rt,Ho]),Mt=s.useCallback((d,y,v="both",k=0,T=0,W=void 0)=>{if(rt.current!==null){const H=Et.current,F=l.current,z=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,_=typeof y!="number"?y.unit==="cell"?y.amount:void 0:y,ee=typeof d!="number"&&d.unit==="px"?d.amount:void 0,ae=typeof y!="number"&&y.unit==="px"?y.amount:void 0;if(H!==null&&F!==null){let V={x:0,y:0,width:0,height:0},xe=0,he=0;if((z!==void 0||_!==void 0)&&(V=H.getBounds((z??0)+D,_??0)??V,V.width===0||V.height===0))return;const Te=F.getBoundingClientRect(),Ie=Te.width/F.offsetWidth;if(ee!==void 0&&(V={...V,x:ee-Te.left-rt.current.scrollLeft,width:1}),ae!==void 0&&(V={...V,y:ae+Te.top-rt.current.scrollTop,height:1}),V!==void 0){const ve={x:V.x-k,y:V.y-T,width:V.width+2*k,height:V.height+2*T};let nt=0;for(let wi=0;wi<Ge;wi++)nt+=Rt[wi].width;let Ct=0;const Pt=Ht+(An?1:0);Pt>0&&(Ct=Jn(Ot,Pt,pn));let Ut=nt*Ie+Te.left+D*Yn*Ie,xn=Te.right,mn=Te.top+$t*Ie,kn=Te.bottom-Ct*Ie;const Ir=V.width+k*2;switch(W==null?void 0:W.hAlign){case"start":xn=Ut+Ir;break;case"end":Ut=xn-Ir;break;case"center":Ut=Math.floor((Ut+xn)/2)-Ir/2,xn=Ut+Ir;break}const Dr=V.height+T*2;switch(W==null?void 0:W.vAlign){case"start":kn=mn+Dr;break;case"end":mn=kn-Dr;break;case"center":mn=Math.floor((mn+kn)/2)-Dr/2,kn=mn+Dr;break}Ut>ve.x?xe=ve.x-Ut:xn<ve.x+ve.width&&(xe=ve.x+ve.width-xn),mn>ve.y?he=ve.y-mn:kn<ve.y+ve.height&&(he=ve.y+ve.height-kn),v==="vertical"||typeof d=="number"&&d<Ge?xe=0:(v==="horizontal"||typeof y=="number"&&y>=Ot-Pt)&&(he=0),(xe!==0||he!==0)&&(Ie!==1&&(xe/=Ie,he/=Ie),rt.current.scrollTo({left:xe+rt.current.scrollLeft,top:he+rt.current.scrollTop,behavior:(W==null?void 0:W.behavior)??"auto"}))}}}},[D,Ht,Yn,rt,$t,Ge,Rt,Ot,An,pn]),ii=s.useRef(Yi),li=s.useRef(I);ii.current=Yi,li.current=I;const si=s.useRef(Se);si.current=Se;const Gi=s.useRef(We.length);Gi.current=We.length;const _n=s.useCallback(async(d,y=!0,v)=>{var _;const k=We[d];if(((_=k==null?void 0:k.trailingRowOptions)==null?void 0:_.disabled)===!0)return;const T=Re==null?void 0:Re();let W,H=!0;T!==void 0&&(W=await T,W==="top"&&(H=!1),typeof W=="number"&&(H=!1));let F=0;const z=()=>{if(si.current<=Se){F<500&&window.setTimeout(z,F),F=50+F*2;return}const ee=typeof W=="number"?W:H?Se:0;Er.current(d-D,ee,"both",0,0,v?{behavior:v}:void 0),ze({cell:[d,ee],range:{x:d,y:ee,width:1,height:1}},!1,!1,"edit");const ae=li.current([d-D,ee]);ae.allowOverlay&&Wo(ae)&&ae.readonly!==!0&&y&&window.setTimeout(()=>{ii.current(d,ee)},0)};z()},[We,Re,D,Se,ze]),xr=s.useCallback(async(d,y=!0)=>{const v=Ae==null?void 0:Ae();let k,T=!0;v!==void 0&&(k=await v,k==="left"&&(T=!1),typeof k=="number"&&(T=!1));let W=0;const H=()=>{if(Gi.current<=We.length){W<500&&window.setTimeout(H,W),W=50+W*2;return}const F=typeof k=="number"?k:T?We.length:0;Mt(F-D,d),ze({cell:[F,d],range:{x:F,y:d,width:1,height:1}},!1,!1,"edit");const z=li.current([F-D,d]);z.allowOverlay&&Wo(z)&&z.readonly!==!0&&y&&window.setTimeout(()=>{ii.current(F,d)},0)};H()},[We,Ae,D,Mt,ze]),Ao=s.useCallback(d=>{var v,k;const y=((k=(v=Rt[d])==null?void 0:v.trailingRowOptions)==null?void 0:k.targetColumn)??(Ke==null?void 0:Ke.targetColumn);if(typeof y=="number")return y+(jt?1:0);if(typeof y=="object"){const T=C.indexOf(y);if(T>=0)return T+(jt?1:0)}},[Rt,C,jt,Ke==null?void 0:Ke.targetColumn]),Kn=s.useRef(),zo=s.useRef(),Vo=s.useCallback((d,y)=>{var T;const[v,k]=y;return Bn(Je,(T=We[v])==null?void 0:T.themeOverride,dn==null?void 0:dn(k),d.themeOverride)},[dn,We,Je]),{mapper:so}=Fd(Ft,p),hn=Ft==null?void 0:Ft.navigationBehavior,qo=s.useCallback(d=>{var _,ee,ae;const y=Nr.value?d.metaKey:d.ctrlKey,v=y&&me==="multi",[k,T]=d.location,W=B.columns,H=B.rows,[F,z]=((_=B.current)==null?void 0:_.cell)??[];if(d.kind==="cell"){if(zo.current=void 0,ao.current=[k,T],k===0&&jt){if(pt===!0&&T===Se||Xt==="number"||me==="none")return;const V=Zt(d.location);if(V.kind!==sn.Marker)return;if($n!==void 0){const Te=bt(V);Jt((Te==null?void 0:Te.kind)===sn.Marker);const Ie=(ee=Te==null?void 0:Te.onClick)==null?void 0:ee.call(Te,{...d,cell:V,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Vo(V,d.location),preventDefault:()=>{}});if(Ie===void 0||Ie.checked===V.checked)return}i(void 0),Yt();const xe=H.hasIndex(T),he=Kn.current;if(me==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&he!==void 0&&H.hasIndex(he)){const Te=[Math.min(he,T),Math.max(he,T)+1];v||Qe==="multi"?Be(void 0,Te,!0):Be(it.fromSingleSelection(Te),void 0,v)}else me==="multi"&&(v||d.isTouch||Qe==="multi")?xe?Be(H.remove(T),void 0,!0):(Be(void 0,T,!0),Kn.current=T):xe&&H.length===1?Be(it.empty(),void 0,y):(Be(it.fromSingleSelection(T),void 0,y),Kn.current=T)}else if(k>=D&&pt&&T===Se){const V=Ao(k);_n(V??k)}else if(F!==k||z!==T){const V=Zt(d.location),xe=bt(V);if((xe==null?void 0:xe.onSelect)!==void 0){let Ie=!1;if(xe.onSelect({...d,cell:V,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>Ie=!0,theme:Vo(V,d.location)}),Ie)return}if(hn==="block"&&so(T).isGroupHeader)return;const he=An&&T===Se,Te=An&&B!==void 0&&((ae=B.current)==null?void 0:ae.cell[1])===Se;if((d.shiftKey||d.isLongTouch===!0)&&F!==void 0&&z!==void 0&&B.current!==void 0&&!Te){if(he)return;const Ie=Math.min(k,F),ve=Math.max(k,F),nt=Math.min(T,z),Ct=Math.max(T,z);ze({...B.current,range:{x:Ie,y:nt,width:ve-Ie+1,height:Ct-nt+1}},!0,y,"click"),Kn.current=void 0,Yt()}else ze({cell:[k,T],range:{x:k,y:T,width:1,height:1}},!0,y,"click"),Kn.current=void 0,i(void 0),Yt()}}else if(d.kind==="header")if(ao.current=[k,T],i(void 0),jt&&k===0)Kn.current=void 0,zo.current=void 0,!Mo&&me==="multi"&&(H.length!==Se?Be(it.fromSingleSelection([0,Se]),void 0,y):Be(it.empty(),void 0,y),Yt());else{const V=zo.current;if(Q==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&V!==void 0&&W.hasIndex(V)){const xe=[Math.min(V,k),Math.max(V,k)+1];y||d.isTouch||mt==="multi"?He(void 0,xe,y):He(it.fromSingleSelection(xe),void 0,y)}else Q==="multi"&&(y||d.isTouch||mt==="multi")?(W.hasIndex(k)?He(W.remove(k),void 0,y):He(void 0,k,y),zo.current=k):Q!=="none"&&(W.hasIndex(k)?He(W.remove(k),void 0,y):He(it.fromSingleSelection(k),void 0,y),zo.current=k);Kn.current=void 0,Yt()}else d.kind===wn?ao.current=[k,T]:d.kind===Xr&&!d.isMaybeScrollbar&&(ne(Pr,!1),i(void 0),Yt(),It==null||It(),Kn.current=void 0,zo.current=void 0)},[me,Q,B,jt,D,pt,Se,Xt,Zt,$n,Yt,Qe,mt,bt,Vo,Be,Ao,_n,hn,so,An,ze,Mo,He,ne,It]),jo=s.useRef(!1),ao=s.useRef(),_i=s.useRef(Pn),rn=s.useRef(),ys=s.useCallback(d=>{if(Po.current=!1,_i.current=zt.current,d.button!==0&&d.button!==1){rn.current=void 0;return}const y=performance.now();rn.current={button:d.button,time:y,location:d.location},(d==null?void 0:d.kind)==="header"&&(jo.current=!0);const v=d.kind==="cell"&&d.isFillHandle;!v&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:B,fillHandle:v}),ao.current=void 0,!d.isTouch&&d.button===0&&!v?qo(d):!d.isTouch&&d.button===1&&(ao.current=d.location))},[B,qo]),[ai,ci]=s.useState(),Ki=s.useCallback(d=>{if(d.kind!==wn||Q!=="multi")return;const y=Nr.value?d.metaKey:d.ctrlKey,[v]=d.location,k=B.columns;if(v<D)return;const T=We[v];let W=v,H=v;for(let F=v-1;F>=D&&ar(T.group,We[F].group);F--)W--;for(let F=v+1;F<We.length&&ar(T.group,We[F].group);F++)H++;if(Yt(),y||d.isTouch||mt==="multi")if(k.hasAll([W,H+1])){let F=k;for(let z=W;z<=H;z++)F=F.remove(z);He(F,void 0,y)}else He(void 0,[W,H+1],y);else He(it.fromSingleSelection([W,H+1]),void 0,y)},[Q,Yt,B.columns,We,D,He,mt]),Po=s.useRef(!1),kr=s.useCallback(async d=>{if(X!==void 0&&Me!==void 0){const y=zt.current.y,v=zt.current.height;let k=X({x:d,y,width:1,height:Math.min(v,Se-y)},S.current.signal);typeof k!="object"&&(k=await k());const T=Rt[d-D],H=document.createElement("canvas").getContext("2d",{alpha:!1});if(H!==null){H.font=Je.baseFontFull;const F=Jl(H,Je,T,0,k,Xn,Ro,!1,bt);Me==null||Me(T,F.width,d,F.width)}}},[Rt,X,Ro,Je,Xn,Me,D,Se,bt]),[ps,di]=s.useState(),Bo=s.useCallback(async(d,y)=>{var F,z;const v=(F=d.current)==null?void 0:F.range;if(v===void 0||X===void 0||y.current===void 0)return;const k=y.current.range;if(A!==void 0){let _=!1;if(A({fillDestination:{...k,x:k.x-D},patternSource:{...v,x:v.x-D},preventDefault:()=>_=!0}),_)return}let T=X(v,S.current.signal);typeof T!="object"&&(T=await T());const W=T,H=[];for(let _=0;_<k.width;_++)for(let ee=0;ee<k.height;ee++){const ae=[k.x+_,k.y+ee];if(Ol(ae,v))continue;const V=W[ee%v.height][_%v.width];$o(V)||!Wo(V)||H.push({location:ae,value:{...V}})}on(H),(z=Et.current)==null||z.damage(H.map(_=>({cell:_.location})))},[X,on,A,D]),Ui=s.useCallback(()=>{if(B.current===void 0||B.current.range.width<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,width:1}}};Bo(d,B)},[Bo,B]),Vi=s.useCallback(()=>{if(B.current===void 0||B.current.range.height<=1)return;const d={...B,current:{...B.current,range:{...B.current.range,height:1}}};Bo(d,B)},[Bo,B]),vs=s.useCallback((d,y)=>{var ee,ae;const v=c;if(f(void 0),oi(void 0),di(void 0),jo.current=!1,y)return;if((v==null?void 0:v.fillHandle)===!0&&B.current!==void 0&&((ee=v.previousSelection)==null?void 0:ee.current)!==void 0){if(lo===void 0)return;const V={...B,current:{...B.current,range:os(v.previousSelection.current.range,lo)}};Bo(v.previousSelection,V),ne(V,!0);return}const[k,T]=d.location,[W,H]=ao.current??[],F=()=>{Po.current=!0},z=V=>{var he,Te,Ie;const xe=V.isTouch||W===k&&H===T;if(xe&&(N==null||N([k-D,T],{...V,preventDefault:F})),V.button===1)return!Po.current;if(!Po.current){const ve=Zt(d.location),nt=bt(ve);if(nt!==void 0&&nt.onClick!==void 0&&xe){const Pt=nt.onClick({...V,cell:ve,posX:V.localEventX,posY:V.localEventY,bounds:V.bounds,theme:Vo(ve,d.location),preventDefault:F});Pt!==void 0&&!$o(Pt)&&Lo(Pt)&&(on([{location:V.location,value:Pt}]),(he=Et.current)==null||he.damage([{cell:V.location}]))}if(Po.current||B.current===void 0)return!1;let Ct=!1;switch(ve.activationBehaviorOverride??_e){case"double-click":case"second-click":{if(((Ie=(Te=v==null?void 0:v.previousSelection)==null?void 0:Te.current)==null?void 0:Ie.cell)===void 0)break;const[Pt,Ut]=B.current.cell,[xn,mn]=v.previousSelection.current.cell;Ct=k===Pt&&k===xn&&T===Ut&&T===mn&&(V.isDoubleClick===!0||_e==="second-click");break}case"single-click":{Ct=!0;break}}if(Ct){const Ut={inputType:"pointer",pointerActivation:V.isDoubleClick===!0?"double-click":ve.activationBehaviorOverride??_e,pointerType:V.isTouch?"touch":"mouse"};return P==null||P([k-D,T],Ut),To(V.bounds,Ut),!0}}return!1},_=d.location[0]-D;if(d.isTouch){const V=zt.current,xe=_i.current;if(V.x!==xe.x||V.y!==xe.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&rr((ae=B.current)==null?void 0:ae.cell,d.location)){J==null||J([_,d.location[1]],{...d,preventDefault:F});return}else if(d.kind==="header"&&B.columns.hasIndex(k)){de==null||de(_,{...d,preventDefault:F});return}else if(d.kind===wn){if(_<0)return;G==null||G(_,{...d,preventDefault:F});return}}d.kind==="cell"?z(d)||qo(d):d.kind===wn?q==null||q(_,{...d,preventDefault:F}):(d.kind===Zn&&(Y==null||Y(_,{...d,preventDefault:F})),qo(d));return}if(d.kind==="header"){if(_<0)return;d.isEdge?d.isDoubleClick===!0&&kr(k):d.button===0&&k===W&&T===H&&(Y==null||Y(_,{...d,preventDefault:F}))}if(d.kind===wn){if(_<0)return;d.button===0&&k===W&&T===H&&(q==null||q(_,{...d,preventDefault:F}),Po.current||Ki(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&z(d),ao.current=void 0},[c,B,D,lo,Bo,ne,N,Zt,bt,_e,Vo,on,P,To,J,de,G,qo,q,Y,kr,Ki]),Cs=s.useCallback(d=>{const y={...d,location:[d.location[0]-D,d.location[1]]};Ze==null||Ze(y),c!==void 0&&d.buttons===0&&(f(void 0),oi(void 0),di(void 0),jo.current=!1),di(v=>{var k;return jo.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(v==null?void 0:v[0])&&d.scrollEdge[1]===v[1]?v:c===void 0||(((k=rn.current)==null?void 0:k.location[0])??0)<D?void 0:d.scrollEdge})},[c,Ze,D]),xs=s.useCallback((d,y)=>{ot==null||ot(d-D,y)},[ot,D]),ks=s.useCallback((d,y)=>{Pe==null||Pe(d-D,y)},[Pe,D]);s.useEffect(()=>{if(r===void 0)return;const d=k=>{const T=[];let W=k.parentElement;for(;W&&W!==document.documentElement;){const H=window.getComputedStyle(W),F=H.overflow+H.overflowY+H.overflowX;(F.includes("scroll")||F.includes("auto"))&&T.push(W),W=W.parentElement}return T},y=k=>{const T=k.target;rt.current&&!rt.current.contains(T)&&i(void 0)},v=[];if(rt.current){const k=d(rt.current);v.push(...k)}return v.forEach(k=>{k.addEventListener("scroll",y)}),window.addEventListener("scroll",y),document.addEventListener("scroll",y,!0),()=>{v.forEach(k=>{k.removeEventListener("scroll",y)}),window.removeEventListener("scroll",y),document.removeEventListener("scroll",y,!0)}},[r,i,rt]);const Cn=(nl=B==null?void 0:B.current)==null?void 0:nl.cell,Ss=s.useCallback((d,y,v,k,T,W)=>{if(io.current=!1,r!==void 0){const ee=zt.current;(ee.x!==d.x||ee.y!==d.y)&&i(void 0)}let H=Cn;H!==void 0&&(H=[H[0]-D,H[1]]);const F=Ge===0?void 0:{x:0,y:d.y,width:Ge,height:d.height},z=[];F!==void 0&&z.push(F),Ht>0&&(z.push({x:d.x-D,y:Se-Ht,width:d.width,height:Ht}),Ge>0&&z.push({x:0,y:Se-Ht,width:Ge,height:Ht}));const _={x:d.x-D,y:d.y,width:d.width,height:pt&&d.y+d.height>=Se?d.height-1:d.height,tx:T,ty:W,extras:{selected:H,freezeRegion:F,freezeRegions:z}};zt.current=_,Gn(_),un([y,v,k]),an==null||an(_,_.tx,_.ty,_.extras)},[Cn,r,D,pt,Se,Ge,Ht,i,Gn,an]),Ms=jn(E,s.useCallback((d,y)=>(E==null?void 0:E(d-D,y-D))!==!1,[E,D])),Rs=jn(Fe,s.useCallback((d,y)=>{Fe==null||Fe(d-D,y-D),Q!=="none"&&He(it.fromSingleSelection(y),void 0,!0)},[Q,Fe,D,He])),ui=s.useRef(!1),Es=s.useCallback(d=>{if(d.location[0]===0&&D>0){d.preventDefault();return}Ye==null||Ye({...d,location:[d.location[0]-D,d.location[1]]}),d.defaultPrevented()||(ui.current=!0),f(void 0)},[Ye,D]),Is=s.useCallback(()=>{ui.current=!1},[]),qi=Ft==null?void 0:Ft.selectionBehavior,Sr=s.useCallback(d=>{if(qi!=="block-spanning")return;const{isGroupHeader:y,path:v,groupRows:k}=so(d);if(y)return[d,d];const T=v[v.length-1],W=d-T,H=d+k-T-1;return[W,H]},[so,qi]),fi=s.useRef(),hi=s.useCallback(d=>{var y,v,k;if(!cs(d,fi.current)&&(fi.current=d,!(((y=rn==null?void 0:rn.current)==null?void 0:y.button)!==void 0&&rn.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((v=rn.current)==null?void 0:v.location[0])===0&&D===1&&me==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(rn.current.location[1])&&B.rows.hasIndex(rn.current.location[1])){const T=Math.min(rn.current.location[1],d.location[1]),W=Math.max(rn.current.location[1],d.location[1])+1;Be(it.fromSingleSelection([T,W]),void 0,!1)}else if(d.buttons!==0&&c!==void 0&&B.current!==void 0&&!ui.current&&!jo.current&&(dt==="rect"||dt==="multi-rect")){const[T,W]=B.current.cell;let[H,F]=d.location;if(F<0&&(F=zt.current.y),c.fillHandle===!0&&((k=c.previousSelection)==null?void 0:k.current)!==void 0){const z=c.previousSelection.current.range;F=Math.min(F,pt?Se-1:Se);const _=wc(z,H,F,qt);oi(_)}else{if(pt&&W===Se)return;if(pt&&F===Se)if(d.kind===Xr)F--;else return;H=Math.max(H,D);const ee=Sr(W);F=ee===void 0?F:ln(F,ee[0],ee[1]);const ae=H-T,V=F-W,xe={x:ae>=0?T:H,y:V>=0?W:F,width:Math.abs(ae)+1,height:Math.abs(V)+1};ze({...B.current,range:xe},!0,!1,"drag")}}vt==null||vt({...d,location:[d.location[0]-D,d.location[1]]})}},[c,D,me,B,dt,vt,Be,pt,Se,qt,Sr,ze]),Ds=s.useCallback(()=>{var H,F;const d=fi.current;if(d===void 0)return;const[y,v]=d.scrollEdge;let[k,T]=d.location;const W=zt.current;y===-1?k=((F=(H=W.extras)==null?void 0:H.freezeRegion)==null?void 0:F.x)??W.x:y===1&&(k=W.x+W.width),v===-1?T=Math.max(0,W.y):v===1&&(T=Math.min(Se-1,W.y+W.height)),k=ln(k,0,We.length-1),T=ln(T,0,Se-1),hi({...d,location:[k,T]})},[We.length,hi,Se]);Md(ps,rt,Ds);const gn=s.useCallback(d=>{if(B.current===void 0)return;const[y,v]=d,[k,T]=B.current.cell,W=B.current.range;let H=W.x,F=W.x+W.width,z=W.y,_=W.y+W.height;const[ee,ae]=Sr(T)??[0,Se-1],V=ae+1;if(v!==0)switch(v){case 2:{_=V,z=T,Mt(0,_,"vertical");break}case-2:{z=ee,_=T+1,Mt(0,z,"vertical");break}case 1:{z<T?(z++,Mt(0,z,"vertical")):(_=Math.min(V,_+1),Mt(0,_,"vertical"));break}case-1:{_>T+1?(_--,Mt(0,_,"vertical")):(z=Math.max(ee,z-1),Mt(0,z,"vertical"));break}default:sr()}if(y!==0)if(y===2)F=We.length,H=k,Mt(F-1-D,0,"horizontal");else if(y===-2)H=D,F=k+1,Mt(H-D,0,"horizontal");else{let xe=[];if(X!==void 0){const he=X({x:H,y:z,width:F-H-D,height:_-z},S.current.signal);typeof he=="object"&&(xe=Pd(he))}if(y===1){let he=!1;if(H<k){if(xe.length>0){const Te=fo(H+1,k+1).find(Ie=>!xe.includes(Ie-D));Te!==void 0&&(H=Te,he=!0)}else H++,he=!0;he&&Mt(H,0,"horizontal")}he||(F=Math.min(We.length,F+1),Mt(F-1-D,0,"horizontal"))}else if(y===-1){let he=!1;if(F>k+1){if(xe.length>0){const Te=fo(F-1,k,-1).find(Ie=>!xe.includes(Ie-D));Te!==void 0&&(F=Te,he=!0)}else F--,he=!0;he&&Mt(F-D,0,"horizontal")}he||(H=Math.max(D,H-1),Mt(H-D,0,"horizontal"))}else sr()}ze({cell:B.current.cell,range:{x:H,y:z,width:F-H,height:_-z}},!0,!1,"keyboard-select")},[X,Sr,B,We.length,D,Se,Mt,ze]),gi=s.useRef(no);gi.current=no;const Un=s.useCallback((d,y,v,k)=>{const T=Ot-(v?0:1);d=ln(d,D,Rt.length-1+D),y=ln(y,0,T);const W=Cn==null?void 0:Cn[0],H=Cn==null?void 0:Cn[1];if(d===W&&y===H)return!1;if(k&&B.current!==void 0){const F=[...B.current.rangeStack];(B.current.range.width>1||B.current.range.height>1)&&F.push(B.current.range),ne({...B,current:{cell:[d,y],range:{x:d,y,width:1,height:1},rangeStack:F}},!0)}else ze({cell:[d,y],range:{x:d,y,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===y&&(u.current=void 0),gi.current&&Mt(d-D,y),!0},[Ot,D,Rt.length,Cn,B,Mt,ne,ze]),Fs=s.useCallback((d,y)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&Lo(d)&&(on([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var T;(T=Et.current)==null||T.damage([{cell:r.cell}])})),Yt(!0),i(void 0);const[v,k]=y;if(B.current!==void 0&&(v!==0||k!==0)){const T=B.current.cell[1]===Ot-1&&d!==void 0,W=B.current.cell[0]===We.length-1&&d!==void 0;let H=!0;if(T&&k===1&&Re!==void 0){H=!1;const F=B.current.cell[0]+v,z=Ao(F);_n(z??F,!1)}if(W&&v===1&&Ae!==void 0){H=!1;const F=B.current.cell[1]+k;xr(F,!1)}if(H){const F=ln(B.current.cell[0]+v,0,We.length-1),z=ln(B.current.cell[1]+k,0,Ot-1);Un(F,z,T,!1),v===0&&k===1&&window.setTimeout(()=>{var ee;const _=I([F-D,z]);if(Wo(_)){const ae=(ee=Et.current)==null?void 0:ee.getBounds(F,z);if(ae&&_.allowOverlay){Et.current&&Et.current.focus();const V={current:{cell:[F,z],range:{x:F,y:z,width:1,height:1},rangeStack:[]},columns:it.empty(),rows:it.empty()};lt==null||lt(V);const xe={inputType:"keyboard",key:"Enter"};P==null||P([F-D,z],xe),Ho({target:ae,content:_,initialValue:void 0,cell:[F,z],highlight:!0,forceEditMode:!0,activation:xe})}}},50)}}L==null||L(d,y)},[r==null?void 0:r.cell,Yt,B,L,on,Ot,Un,We.length,_n,xr,Re,Ae,Ao,Et,I,D,P,To,Ho]),Hs=s.useMemo(()=>`gdg-overlay-${zd++}`,[]),co=s.useCallback(d=>{var v,k,T,W;Yt();const y=[];for(let H=d.x;H<d.x+d.width;H++)for(let F=d.y;F<d.y+d.height;F++){const z=I([H-D,F]);if(!z.allowOverlay&&z.kind!==oe.Boolean)continue;let _;if(z.kind===oe.Custom){const ee=bt(z),ae=(v=ee==null?void 0:ee.provideEditor)==null?void 0:v.call(ee,{...z,location:[H-D,F]});(ee==null?void 0:ee.onDelete)!==void 0?_=ee.onDelete(z):ra(ae)&&(_=(k=ae==null?void 0:ae.deletedValue)==null?void 0:k.call(ae,z))}else if(Lo(z)&&z.allowOverlay||z.kind===oe.Boolean){const ee=bt(z);_=(T=ee==null?void 0:ee.onDelete)==null?void 0:T.call(ee,z)}_!==void 0&&!$o(_)&&Lo(_)&&y.push({location:[H,F],value:_})}on(y),(W=Et.current)==null||W.damage(y.map(H=>({cell:H.location})))},[Yt,I,bt,on,D]),Zo=r!==void 0,ji=s.useCallback(d=>{var Te,Ie;const y=()=>{d.stopPropagation(),d.preventDefault()},v={didMatch:!1},{bounds:k}=d,T=B.columns,W=B.rows,H=vn;if(!Zo&&Oe(H.clear,d,v))ne(Pr,!1),It==null||It();else if(!Zo&&Oe(H.selectAll,d,v))ne({columns:it.empty(),rows:it.empty(),current:{cell:((Te=B.current)==null?void 0:Te.cell)??[D,0],range:{x:D,y:0,width:C.length,height:Se},rangeStack:[]}},!1);else if(Oe(H.search,d,v))(Ie=a==null?void 0:a.current)==null||Ie.focus({preventScroll:!0}),ro(!0);else if(Oe(H.delete,d,v)){const ve=(qe==null?void 0:qe(B))??!0;if(ve!==!1){const nt=ve===!0?B:ve;if(nt.current!==void 0){co(nt.current.range);for(const Ct of nt.current.rangeStack)co(Ct)}for(const Ct of nt.rows)co({x:D,y:Ct,width:C.length,height:1});for(const Ct of nt.columns)co({x:Ct,y:0,width:1,height:Se})}}if(v.didMatch)return y(),!0;if(B.current===void 0)return!1;let[F,z]=B.current.cell;const[,_]=B.current.cell;let ee=!1,ae=!1;if(Oe(H.scrollToSelectedCell,d,v))Er.current(F-D,z);else if(Q!=="none"&&Oe(H.selectColumn,d,v))T.hasIndex(F)?He(T.remove(F),void 0,!0):Q==="single"?He(it.fromSingleSelection(F),void 0,!0):He(void 0,F,!0);else if(me!=="none"&&Oe(H.selectRow,d,v))W.hasIndex(z)?Be(W.remove(z),void 0,!0):me==="single"?Be(it.fromSingleSelection(z),void 0,!0):Be(void 0,z,!0);else if(!Zo&&k!==void 0&&Oe(H.activateCell,d,v))if(z===Se&&pt)window.setTimeout(()=>{const ve=Ao(F);_n(ve??F)},0);else{const ve={inputType:"keyboard",key:d.key};P==null||P([F-D,z],ve),To(k,ve)}else B.current.range.height>1&&Oe(H.downFill,d,v)?Vi():B.current.range.width>1&&Oe(H.rightFill,d,v)?Ui():Oe(H.goToNextPage,d,v)?z+=Math.max(1,zt.current.height-4):Oe(H.goToPreviousPage,d,v)?z-=Math.max(1,zt.current.height-4):Oe(H.goToFirstCell,d,v)?(i(void 0),z=0,F=0):Oe(H.goToLastCell,d,v)?(i(void 0),z=Number.MAX_SAFE_INTEGER,F=Number.MAX_SAFE_INTEGER):Oe(H.selectToFirstCell,d,v)?(i(void 0),gn([-2,-2])):Oe(H.selectToLastCell,d,v)?(i(void 0),gn([2,2])):Zo?(Oe(H.closeOverlay,d,v)&&i(void 0),Oe(H.acceptOverlayDown,d,v)&&(i(void 0),z++),Oe(H.acceptOverlayUp,d,v)&&(i(void 0),z--),Oe(H.acceptOverlayLeft,d,v)&&(i(void 0),F--),Oe(H.acceptOverlayRight,d,v)&&(i(void 0),F++)):(Oe(H.goDownCell,d,v)?z+=1:Oe(H.goUpCell,d,v)?z-=1:Oe(H.goRightCell,d,v)?F+=1:Oe(H.goLeftCell,d,v)?F-=1:Oe(H.goDownCellRetainSelection,d,v)?(z+=1,ee=!0):Oe(H.goUpCellRetainSelection,d,v)?(z-=1,ee=!0):Oe(H.goRightCellRetainSelection,d,v)?(F+=1,ee=!0):Oe(H.goLeftCellRetainSelection,d,v)?(F-=1,ee=!0):Oe(H.goToLastRow,d,v)?z=Se-1:Oe(H.goToFirstRow,d,v)?z=Number.MIN_SAFE_INTEGER:Oe(H.goToLastColumn,d,v)?F=Number.MAX_SAFE_INTEGER:Oe(H.goToFirstColumn,d,v)?F=Number.MIN_SAFE_INTEGER:(dt==="rect"||dt==="multi-rect")&&(Oe(H.selectGrowDown,d,v)?gn([0,1]):Oe(H.selectGrowUp,d,v)?gn([0,-1]):Oe(H.selectGrowRight,d,v)?gn([1,0]):Oe(H.selectGrowLeft,d,v)?gn([-1,0]):Oe(H.selectToLastRow,d,v)?gn([0,2]):Oe(H.selectToFirstRow,d,v)?gn([0,-2]):Oe(H.selectToLastColumn,d,v)?gn([2,0]):Oe(H.selectToFirstColumn,d,v)&&gn([-2,0])),ae=v.didMatch);if(hn!==void 0&&hn!=="normal"&&z!==_){const ve=hn==="skip-up"||hn==="skip"||hn==="block",nt=hn==="skip-down"||hn==="skip"||hn==="block",Ct=z<_;if(Ct&&ve){for(;z>=0&&so(z).isGroupHeader;)z--;z<0&&(z=_)}else if(!Ct&&nt){for(;z<Se&&so(z).isGroupHeader;)z++;z>=Se&&(z=_)}}const xe=Un(F,z,!1,ee),he=v.didMatch;return he&&(xe||!ae||Hn)&&y(),he},[hn,Zo,B,vn,Q,me,dt,D,so,Se,Un,ne,It,C.length,qe,Hn,co,He,Be,pt,Ao,_n,P,To,Vi,Ui,gn]),Jo=s.useCallback(d=>{let y=!1;Le!==void 0&&Le({...d,...d.location&&{location:[d.location[0]-D,d.location[1]]},cancel:()=>{y=!0}}),!y&&(ji(d)||B.current)},[st,Le,ji,B,I,D,Se,pt,P,To]),Ts=s.useCallback((d,y)=>{const v=d.location[0]-D;if(d.kind==="header"&&(de==null||de(v,{...d,preventDefault:y})),d.kind===wn){if(v<0)return;G==null||G(v,{...d,preventDefault:y})}if(d.kind==="cell"){const[k,T]=d.location;J==null||J([v,T],{...d,preventDefault:y}),xa(B,d.location)||Un(k,T,!1,!1)}},[B,J,G,de,D,Un]),mi=s.useCallback(async d=>{var H,F,z;if(!vn.paste)return;function y(_,ee,ae,V){var he,Te;const xe=typeof ae=="object"?(ae==null?void 0:ae.join(`
`))??"":(ae==null?void 0:ae.toString())??"";if(!$o(_)&&Wo(_)&&_.readonly!==!0){const Ie=K==null?void 0:K(xe,_);if(Ie!==void 0&&Lo(Ie))return{location:ee,value:Ie};const ve=bt(_);if(ve===void 0)return;if(ve.kind===oe.Custom){Jt(_.kind===oe.Custom);const nt=(he=ve.onPaste)==null?void 0:he.call(ve,xe,_.data);return nt===void 0?void 0:{location:ee,value:{..._,data:nt}}}else{const nt=(Te=ve.onPaste)==null?void 0:Te.call(ve,xe,_,{formatted:V,formattedString:typeof V=="string"?V:V==null?void 0:V.join(`
`),rawValue:ae});return nt===void 0?void 0:(Jt(nt.kind===_.kind),{location:ee,value:nt})}}}const v=B.columns,k=B.rows,T=((H=rt.current)==null?void 0:H.contains(document.activeElement))===!0||((F=l.current)==null?void 0:F.contains(document.activeElement))===!0;let W;if(B.current!==void 0?W=[B.current.range.x,B.current.range.y]:v.length===1?W=[v.first()??0,0]:k.length===1&&(W=[D,k.first()??0]),T&&W!==void 0){let _,ee;const ae="text/plain",V="text/html";if(navigator.clipboard.read!==void 0){const Ie=await navigator.clipboard.read();for(const ve of Ie){if(ve.types.includes(V)){const Ct=await(await ve.getType(V)).text(),Pt=Sl(Ct);if(Pt!==void 0){_=Pt;break}}ve.types.includes(ae)&&(ee=await(await ve.getType(ae)).text())}}else if(navigator.clipboard.readText!==void 0)ee=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(V)){const Ie=d.clipboardData.getData(V);_=Sl(Ie)}_===void 0&&d.clipboardData.types.includes(ae)&&(ee=d.clipboardData.getData(ae))}else return;const[xe,he]=W,Te=[];do{if(le===void 0){const Ie=Zt(W),ve=ee??(_==null?void 0:_.map(Ct=>Ct.map(Pt=>Pt.rawValue).join("	")).join("	"))??"",nt=y(Ie,W,ve,void 0);nt!==void 0&&Te.push(nt);break}if(_===void 0){if(ee===void 0)return;_=yd(ee)}if(le===!1||typeof le=="function"&&(le==null?void 0:le([W[0]-D,W[1]],_.map(Ie=>Ie.map(ve=>{var nt;return((nt=ve.rawValue)==null?void 0:nt.toString())??""}))))!==!0)return;for(const[Ie,ve]of _.entries()){if(Ie+he>=Se)break;for(const[nt,Ct]of ve.entries()){const Pt=[nt+xe,Ie+he],[Ut,xn]=Pt;if(Ut>=We.length||xn>=Ot)continue;const mn=Zt(Pt),kn=y(mn,Pt,Ct.rawValue,Ct.formatted);kn!==void 0&&Te.push(kn)}}}while(!1);on(Te),(z=Et.current)==null||z.damage(Te.map(Ie=>({cell:Ie.location})))}},[K,bt,Zt,B,vn.paste,rt,We.length,on,Ot,le,D,Se]);Gt("paste",mi,g,!1,!0);const Qo=s.useCallback(async(d,y)=>{var H,F;if(!vn.copy)return;const v=y===!0||((H=rt.current)==null?void 0:H.contains(document.activeElement))===!0||((F=l.current)==null?void 0:F.contains(document.activeElement))===!0,k=B.columns,T=B.rows,W=(z,_)=>{if(!ye)Rl(z,_,d);else{const ee=_.map(ae=>({kind:oe.Text,data:C[ae].title,displayData:C[ae].title,allowOverlay:!1}));Rl([ee,...z],_,d)}};if(v&&X!==void 0){if(B.current!==void 0){let z=X(B.current.range,S.current.signal);typeof z!="object"&&(z=await z()),W(z,fo(B.current.range.x-D,B.current.range.x+B.current.range.width-D))}else if(T!==void 0&&T.length>0){const _=[...T].map(ee=>{const ae=X({x:D,y:ee,width:C.length,height:1},S.current.signal);return typeof ae=="object"?ae[0]:ae().then(V=>V[0])});if(_.some(ee=>ee instanceof Promise)){const ee=await Promise.all(_);W(ee,fo(C.length))}else W(_,fo(C.length))}else if(k.length>0){const z=[],_=[];for(const ee of k){let ae=X({x:ee,y:0,width:1,height:Se},S.current.signal);typeof ae!="object"&&(ae=await ae()),z.push(ae),_.push(ee-D)}if(z.length===1)W(z[0],_);else{const ee=z.reduce((ae,V)=>ae.map((xe,he)=>[...xe,...V[he]]));W(ee,_)}}}},[C,X,B,vn.copy,D,rt,Se,ye]);Gt("copy",Qo,g,!1,!1);const As=s.useCallback(async d=>{var v,k;if(!(!vn.cut||!(((v=rt.current)==null?void 0:v.contains(document.activeElement))===!0||((k=l.current)==null?void 0:k.contains(document.activeElement))===!0))&&(await Qo(d),B.current!==void 0)){let T={current:{cell:B.current.cell,range:B.current.range,rangeStack:[]},rows:it.empty(),columns:it.empty()};const W=qe==null?void 0:qe(T);if(W===!1||(T=W===!0?T:W,T.current===void 0))return;co(T.current.range)}},[co,B,vn.cut,Qo,rt,qe]);Gt("cut",As,g,!1,!1);const zs=s.useCallback((d,y)=>{if(De!==void 0){D!==0&&(d=d.map(T=>[T[0]-D,T[1]])),De(d,y);return}if(d.length===0||y===-1)return;const[v,k]=d[y];u.current!==void 0&&u.current[0]===v&&u.current[1]===k||(u.current=[v,k],Un(v,k,!1,!1))},[De,D,Un]),[Mr,Rr]=((ol=_t==null?void 0:_t.current)==null?void 0:ol.cell)??[],Er=s.useRef(Mt);Er.current=Mt,s.useLayoutEffect(()=>{var d,y,v,k;gi.current&&!io.current&&Mr!==void 0&&Rr!==void 0&&(Mr!==((y=(d=te.current)==null?void 0:d.current)==null?void 0:y.cell[0])||Rr!==((k=(v=te.current)==null?void 0:v.current)==null?void 0:k.cell[1]))&&Er.current(Mr,Rr),io.current=!1},[Mr,Rr]);const Zi=B.current!==void 0&&(B.current.cell[0]>=We.length||B.current.cell[1]>=Ot);s.useLayoutEffect(()=>{Zi&&ne(Pr,!1)},[Zi,ne]);const Ps=s.useMemo(()=>pt===!0&&(Ke==null?void 0:Ke.tint)===!0?it.fromSingleSelection(Ot-1):it.empty(),[Ot,pt,Ke==null?void 0:Ke.tint]),Bs=s.useCallback(d=>typeof at=="boolean"?at:(at==null?void 0:at(d-D))??!0,[D,at]),Ls=s.useMemo(()=>{if(ai===void 0||l.current===null)return null;const{bounds:d,group:y}=ai,v=l.current.getBoundingClientRect();return s.createElement(sd,{bounds:d,group:y,canvasBounds:v,onClose:()=>ci(void 0),onFinish:k=>{ci(void 0),se==null||se(y,k)}})},[se,ai]),Ws=Math.min(We.length,Ge+(jt?1:0));s.useImperativeHandle(t,()=>({appendRow:(d,y)=>_n(d+D,y),appendColumn:(d,y)=>xr(d,y),updateCells:d=>{var y;return D!==0&&(d=d.map(v=>({cell:[v.cell[0]+D,v.cell[1]]}))),(y=Et.current)==null?void 0:y.damage(d)},getBounds:(d,y)=>{var v;if(!((l==null?void 0:l.current)===null||(rt==null?void 0:rt.current)===null)){if(d===void 0&&y===void 0){const k=l.current.getBoundingClientRect(),T=k.width/rt.current.clientWidth;return{x:k.x-rt.current.scrollLeft*T,y:k.y-rt.current.scrollTop*T,width:rt.current.scrollWidth*T,height:rt.current.scrollHeight*T}}return(v=Et.current)==null?void 0:v.getBounds((d??0)+D,y)}},focus:()=>{var d;return(d=Et.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Qo(void 0,!0);break;case"paste":await mi();break}},scrollTo:Mt,remeasureColumns:d=>{for(const y of d)kr(y+D)},getMouseArgsForPosition:(d,y,v)=>{if((Et==null?void 0:Et.current)===null)return;const k=Et.current.getMouseArgsForPosition(d,y,v);if(k!==void 0)return{...k,location:[k.location[0]-D,k.location[1]]}}}),[_n,xr,kr,rt,Qo,Jo,mi,D,Mt]);const[Ji,Qi]=Cn??[],$s=s.useCallback(d=>{const[y,v]=d;if(v===-1){Q!=="none"&&(He(it.fromSingleSelection(y),void 0,!1),Yt());return}Ji===y&&Qi===v||(ze({cell:d,range:{x:y,y:v,width:1,height:1}},!0,!1,"keyboard-nav"),Mt(y,v))},[Q,Yt,Mt,Ji,Qi,ze,He]),[Os,Ns]=s.useState(!1),el=s.useRef(Al(d=>{Ns(d)},5)),Xs=s.useCallback(()=>{el.current(!0),B.current===void 0&&B.columns.length===0&&B.rows.length===0&&c===void 0&&ze({cell:[D,yr],range:{x:D,y:yr,width:1,height:1}},!0,!1,"keyboard-select")},[yr,B,c,D,ze]),Ys=s.useCallback(()=>{el.current(!1)},[]),[Gs,_s]=s.useMemo(()=>{let d;const y=(Ue==null?void 0:Ue.scrollbarWidthOverride)??Mi(),v=Se+(pt?1:0);if(typeof pn=="number")d=$t+v*pn;else{let T=0;const W=Math.min(v,10);for(let H=0;H<W;H++)T+=pn(H);T=Math.floor(T/W),d=$t+v*T}d+=y;const k=We.reduce((T,W)=>W.width+T,0)+y;return[`${Math.min(1e5,k)}px`,`${Math.min(1e5,d)}px`]},[We,Ue==null?void 0:Ue.scrollbarWidthOverride,pn,Se,pt,$t]),Ks=s.useMemo(()=>Ba(Je),[Je]);return s.createElement(Zl.Provider,{value:Je},s.createElement(xd,{style:Ks,className:Ce,inWidth:m??Gs,inHeight:x??_s},s.createElement(od,{fillHandle:Tt,drawFocusRing:Co,experimental:Ue,fixedShadowX:In,fixedShadowY:ur,getRowThemeOverride:dn,headerIcons:Wn,imageWindowLoader:Dn,initialSize:Fn,isDraggable:mo,onDragLeave:fr,onRowMoved:$n,overscrollX:Qr,overscrollY:ei,preventDiagonalScrolling:yo,rightElement:po,rightElementProps:to,smoothScrollX:_r,smoothScrollY:hr,className:Ce,enableGroups:nn,onCanvasFocused:Xs,onCanvasBlur:Ys,canvasRef:l,onContextMenu:Ts,theme:Je,cellXOffset:ws,cellYOffset:yr,accessibilityHeight:Pn.height,onDragEnd:Is,columns:We,nonGrowWidth:ct,drawHeader:At,onColumnProposeMove:Ms,drawCell:pe,disabledRows:Ps,freezeColumns:Ws,lockColumns:D,firstColAccessible:D===0,getCellContent:Zt,minColumnWidth:Xn,maxColumnWidth:Ro,searchInputRef:a,showSearch:ni,onSearchClose:Io,highlightRegions:bs,getCellsForSelection:X,getGroupDetails:ri,headerHeight:Uo,isFocused:Os,groupHeaderHeight:nn?br:0,freezeTrailingRows:Ht+(pt&&(Ke==null?void 0:Ke.sticky)===!0?1:0),hasAppendRow:pt,onColumnResize:Me,onColumnResizeEnd:Ve,onColumnResizeStart:we,onCellFocused:$s,onColumnMoved:Rs,onDragStart:Es,onHeaderMenuClick:xs,onHeaderIndicatorClick:ks,onItemHovered:hi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:Cs,onKeyDown:Jo,onKeyUp:Xe,onMouseDown:ys,onMouseUp:vs,onDragOverCell:tn,onDrop:Nt,onSearchResultsChanged:zs,onVisibleRegionChanged:Ss,clientSize:St,rowHeight:pn,searchResults:U,searchValue:ge,onSearchValueChange:re,rows:Ot,scrollRef:rt,selection:B,translateX:Pn.tx,translateY:Pn.ty,verticalBorder:Bs,gridRef:Et,getCellRenderer:bt,resizeIndicator:gr}),Ls,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Ad,{...r,validateCell:fe,bloom:$,id:Hs,getCellRenderer:bt,className:(Ue==null?void 0:Ue.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Wt,imageEditorOverride:w,portalElementRef:mr,onFinishEditing:Fs,markdownDivCreateNode:h,isOutsideClick:qr,customEventTarget:Ue==null?void 0:Ue.eventTarget}))))},Ld=s.forwardRef(Bd);function Dl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:l,x:c,y:f}=r,u=t.maxSize??i.checkboxMaxSize,g=Math.floor(r.y+l/2),w=Ll(u,l,i.cellVerticalPadding),b=Bl(t.contentAlign??"center",c,a,i.cellHorizontalPadding,w),h=Pl(b,g,w),m=Wl(c+n,f+o,h);return Ti(t)&&m}const Wd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:oe.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>$d(e,e.cell.data,Ti(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Dl(e)&&e.preventDefault()},onClick:e=>{if(Dl(e))return{...e.cell,data:us(e.cell.data)}},onPaste:(e,t)=>{let n=Lr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Hi),n===t.data?void 0:{...t,data:n}}};function $d(e,t,n,o,r){if(!n&&t===Lr)return;const{ctx:i,hoverAmount:a,theme:l,rect:c,highlighted:f,hoverX:u,hoverY:g,cell:{contentAlign:w}}=e,{x:b,y:h,width:m,height:x}=c;let C=!1;if(r>0){let p=n?1-r+r*a:.4;if(t===Lr&&(p*=a),p===0)return;p<1&&(C=!0,i.globalAlpha=p)}Wi(i,l,t,b,h,m,x,f,u,g,o,w),C&&(i.globalAlpha=1)}const Od=en("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Nd=e=>{const{bubbles:t}=e;return s.createElement(Od,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Xd={getAccessibilityString:e=>$l(e.data),kind:oe.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Yd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Nd,{bubbles:t.data})},onPaste:()=>{}};function Yd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:l,width:c,height:f}=n;let u=a+o.cellHorizontalPadding;const g=[];for(const w of t){if(u>a+c)break;const b=Go(w,r,o.baseFontFull).width;g.push({x:u,width:b}),u+=b+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const w of g)Mn(r,w.x,l+(f-o.bubbleHeight)/2,w.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[w,b]of g.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[w],b.x+o.bubblePadding,l+f/2+Qn(r,o))}const Gd=en("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),_d=e=>{const{drilldowns:t}=e;return s.createElement(Gd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},Kd={getAccessibilityString:e=>$l(e.data.map(t=>t.text)),kind:oe.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Vd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(_d,{drilldowns:t.data})},onPaste:()=>{}},xi={};function Ud(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,l=4,c=n*r,f=o+i,u=o*3,g=(u+i*2)*r,w=`${e},${t},${r},${n}`;if(xi[w]!==void 0)return{el:xi[w],height:c,width:g,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const b=document.createElement("canvas"),h=b.getContext("2d");return h===null?null:(b.width=g,b.height=c,h.scale(r,r),xi[w]=b,h.beginPath(),Mn(h,i,i,u,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Mn(h,i+.5,i+.5,u,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:b,height:c,width:g,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Vd(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:l}=e,{x:c,width:f}=n,u=o.baseFontFull,g=Kl(r,u),w=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),b=Math.floor(n.y+(n.height-w)/2),h=w-10,m=o.bubblePadding,x=o.bubbleMargin;let C=c+o.cellHorizontalPadding;const p=o.roundingRadius??6,I=Ud(o.bgCell,o.drilldownBorder,w,p),N=[];for(const P of t){if(C>c+f)break;const L=Go(P.text,r,u).width;let K=0;P.img!==void 0&&i.loadOrGetImage(P.img,a,l)!==void 0&&(K=h-8+4);const R=L+K+m*2;N.push({x:C,width:R}),C+=R+x}if(I!==null){const{el:P,height:A,middleWidth:L,sideWidth:K,width:R,dpr:O,padding:$}=I,Y=K/O,E=$/O;for(const M of N){const ie=Math.floor(M.x),q=Math.floor(M.width),J=q-(Y-E)*2;r.imageSmoothingEnabled=!1,r.drawImage(P,0,0,K,A,ie-E,b,Y,w),J>0&&r.drawImage(P,K,0,L,A,ie+(Y-E),b,J,w),r.drawImage(P,R-K,0,K,A,ie+q-(Y-E),b,Y,w),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[P,A]of N.entries()){const L=t[P];let K=A.x+m;if(L.img!==void 0){const R=i.loadOrGetImage(L.img,a,l);if(R!==void 0){const O=h-8;let $=0,Y=0,E=R.width,M=R.height;E>M?($+=(E-M)/2,E=M):M>E&&(Y+=(M-E)/2,M=E),r.beginPath(),Mn(r,K,b+w/2-O/2,O,O,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(R,$,Y,E,M,K,b+w/2-O/2,O,O),r.restore(),K+=O+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(L.text,K,b+w/2+Qn(r,o))}}const qd={getAccessibilityString:e=>e.data.join(", "),kind:oe.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>jd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ga;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},ki=4;function jd(e,t,n,o){const{rect:r,col:i,row:a,theme:l,ctx:c,imageLoader:f}=e,{x:u,y:g,height:w,width:b}=r,h=w-l.cellVerticalPadding*2,m=[];let x=0;for(let p=0;p<t.length;p++){const I=t[p];if(I.length===0)continue;const N=f.loadOrGetImage(I,i,a);if(N!==void 0){m[p]=N;const P=N.width*(h/N.height);x+=P+ki}}if(x===0)return;x-=ki;let C=u+l.cellHorizontalPadding;o==="right"?C=Math.floor(u+b-l.cellHorizontalPadding-x):o==="center"&&(C=Math.floor(u+b/2-x/2));for(const p of m){if(p===void 0)continue;const I=p.width*(h/p.height);n>0&&(c.beginPath(),Mn(c,C,g+l.cellVerticalPadding,I,h,n),c.save(),c.clip()),c.drawImage(p,C,g+l.cellVerticalPadding,I,h),n>0&&c.restore(),C+=I+ki}}function Zd(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Jd={getAccessibilityString:()=>"",kind:oe.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(Zd(n,o)*t.skeletonWidthVariability));const c=a.cellHorizontalPadding;l+c*2>=i.width&&(l=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);Mn(r,i.x+c,i.y+(i.height-f)/2,l,f,a.roundingRadius??3),r.fillStyle=go(a.textDark,.1),r.fill()},onPaste:()=>{}},Qd=()=>e=>e.targetWidth,Fl=en("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[Qd(),"px"]}}),eu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:l}=e,c=t.data,f=t.readonly===!0,[u,g]=s.useState(c===""||o),w=s.useCallback(()=>{g(h=>!h)},[]),b=c?"gdg-ml-6":"";return u?s.createElement(Fl,{targetWidth:i.width-20},s.createElement(Yr,{autoFocus:!0,highlight:!1,validatedSelection:l,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${b}`,onClick:()=>a(t)},s.createElement(sa,null))):s.createElement(Fl,{targetWidth:i.width},s.createElement(wa,{contents:c,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${b}`,onClick:w},s.createElement(Ai,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},tu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:oe.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:dr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Sn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:l}=e;return s.createElement(eu,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:c=>t({...n,data:c.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},nu={getAccessibilityString:e=>e.row.toString(),kind:sn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:ou,measure:()=>44,draw:e=>iu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:a}=t,l=n.drawHandle?7+(i-7)/2:i/2,c=a/2;if(Math.abs(o-l)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function ou(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=ru,n.textAlign="center",i}function ru(e){const{ctx:t}=e;t.textAlign="start"}function iu(e,t,n,o,r,i){const{ctx:a,rect:l,hoverAmount:c,theme:f}=e,{x:u,y:g,width:w,height:b}=l,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){a.globalAlpha=h;const m=7*(n?c:1);if(Wi(a,f,n,r?u+m:u,g,r?w-m:w,b,!0,void 0,void 0,f.checkboxMaxSize,"center",i),r){a.globalAlpha=c,a.beginPath();for(const x of[3,6])for(const C of[-5,-1,3])a.rect(u+x,g+b/2+C,2,2);a.fillStyle=f.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const m=t.toString(),x=f.markerFontFull,C=u+w/2;o==="both"&&c!==0&&(a.globalAlpha=1-c),a.fillStyle=f.textLight,a.font=x,a.fillText(m,C,g+b/2+Qn(a,x)),c!==0&&(a.globalAlpha=1)}}const lu={getAccessibilityString:()=>"",kind:sn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>su(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function su(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:l}=e,{x:c,y:f,width:u,height:g}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,g-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const w=t!=="";let b=0;if(n!==void 0){const m=g-8,x=c+8/2,C=f+8/2;l.drawSprite(n,"normal",o,x,C,m,a,w?1:i),b=m}else{b=24;const h=12,m=w?h:i*h,x=w?0:(1-i)*h*.5,C=a.cellHorizontalPadding+4;m>0&&(o.moveTo(c+C+x,f+g/2),o.lineTo(c+C+x+m,f+g/2),o.moveTo(c+C+x+m*.5,f+g/2-m*.5),o.lineTo(c+C+x+m*.5,f+g/2+m*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,b+c+a.cellHorizontalPadding+.5,f+g/2+Qn(o,a)),o.beginPath()}function gs(e,t,n,o,r,i,a){e.textBaseline="alphabetic";const l=au(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Mn(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??go(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function au(e,t,n,o,r){const i=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+a/2+1,width:t.width-i,height:t.height-a-1};const l=Go(n,e,o.baseFontFull,"alphabetic"),c=t.height-a,f=Math.min(c,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const cu=s.lazy(async()=>await Tl(()=>import("./number-overlay-editor-B6rL0Mbq.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),du={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:oe.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:dr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:a}=e,{hoverEffect:l,displayData:c,hoverEffectTheme:f}=n;l===!0&&t>0&&gs(o,r,f,c,i,t,a),Sn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(cu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},uu={getAccessibilityString:()=>"",measure:()=>108,kind:oe.Protected,needsHover:!1,needsHoverPosition:!1,draw:fu,onPaste:()=>{}};function fu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const l=2.5;let c=r+n.cellHorizontalPadding+l;const f=i+a/2,u=Math.cos(cl(30))*l,g=Math.sin(cl(30))*l;for(let w=0;w<12;w++)t.moveTo(c,f-l),t.lineTo(c,f+l),t.moveTo(c+u,f-g),t.lineTo(c-u,f+g),t.moveTo(c-u,f-g),t.lineTo(c+u,f+g),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const hu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:oe.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>dr(e,t,e.theme.textLight),draw:e=>Sn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return xt.createElement(Yr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},gu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:oe.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:dr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:l}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:g,hoverEffectTheme:w}=t;u===!0&&n>0&&gs(r,a,w,c,i,n,l),Sn(e,c,f,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Yr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},mu=en("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),wu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[l,c]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{c(!0)},[]);return l?s.createElement(Yr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(mu,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Ai,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ms(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:l}}function Hl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=Gl(a,i.baseFontFull);if(l===void 0)return!1;const c=ms(l,n,i,t.contentAlign);return ho({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const bu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:oe.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:dr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:l}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Go(c,l,n.baseFontFull),g=ms(u,a,n,t.contentAlign),{x:w,y:b,width:h,height:m}=g;if(r>=w-4&&r<=w-4+h+8&&i>=b-4&&i<=b-4+m+8){const x=Qn(l,n.baseFontFull);o("pointer");const C=5,p=b-x;l.beginPath(),l.moveTo(a.x+w,Math.floor(a.y+p+m+C)+.5),l.lineTo(a.x+w+h,Math.floor(a.y+p+m+C)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Sn({...e,rect:{...a,x:a.x-1}},c,t.contentAlign),Sn({...e,rect:{...a,x:a.x-2}},c,t.contentAlign),Sn({...e,rect:{...a,x:a.x+1}},c,t.contentAlign),Sn({...e,rect:{...a,x:a.x+2}},c,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Sn(e,c,t.contentAlign)},onSelect:e=>{Hl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Hl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(wu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},yu=[nu,lu,Wd,Xd,Kd,qd,Jd,tu,du,uu,hu,gu,bu],Si=[];class pu extends Vl{constructor(){super(...arguments);$e(this,"imageLoaded",()=>{});$e(this,"loadedLocations",[]);$e(this,"cache",{});$e(this,"sendLoaded",ea(()=>{this.imageLoaded(new lr(this.loadedLocations)),this.loadedLocations=[]},20));$e(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const l=r.cells[a];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const l=Si.pop()??new Image;let c=!1;const f={img:void 0,cells:[bn(o,r)],url:n,cancel:()=>{c||(c=!0,Si.length<12?Si.unshift(l):a||(l.src=""))}},u=new Promise(g=>l.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const g=this.cache[i];if(g!==void 0&&!c){g.img=l;for(const w of g.cells)this.loadedLocations.push(Li(w));a=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const l=bn(o,r);return a.cells.includes(l)||a.cells.push(l),a.img}else this.loadImage(n,o,r,i)}}const vu=(e,t)=>{const n=s.useMemo(()=>({...hc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??yu,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new pu,[e.imageWindowLoader]);return s.createElement(Ld,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Tu=s.forwardRef(vu);export{rd as C,Tu as D,oe as G,Zl as T,Yr as a,Kl as b,Qt as c,Fu as d,Du as e,Eu as f,Qn as g,Lo as h,Iu as i,ll as j,$o as k,ra as l,Go as m,Ba as n,Xo as p,Mn as r,Hu as u};
