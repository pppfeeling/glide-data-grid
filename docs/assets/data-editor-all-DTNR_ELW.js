const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-BqJP74d_.js","./iframe-DDTcUdjc.js","./preload-helper-C1FmrZbK.js","./index-BiWZRF7Z.js","./image-window-loader-Ba2dfKLx.js","./throttle-C2-49NaF.js","./marked.esm-jmFFBRfF.js","./image-window-loader-DhbFCWIb.css","./flatten-BavRFQMS.js","./scrolling-data-grid-CqIwtj2o.js","./scrolling-data-grid-wZ406GJK.css","./data-grid-overlay-editor-Cmj_ecGQ.css"])))=>i.map(i=>d[i]);
var ii=Object.defineProperty;var si=(t,o,s)=>o in t?ii(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s;var Mn=(t,o,s)=>si(t,typeof o!="symbol"?o+"":o,s);import{r as l,R as me}from"./iframe-DDTcUdjc.js";import{_ as ci}from"./preload-helper-C1FmrZbK.js";import{G as ne,d as Yo,e as Bo,r as vr,f as qo,C as j,g as Mr,h as ai,w as mt,j as ui,k as di,m as Sn,l as wr,I as zt,p as fi,n as hi,t as gi,o as mi,q as Ot,s as Cr,v as vi,x as Xo,y as ao,z as wi,A as Ci,B as pi,D as bi,E as yi,F as pr,i as uo,H as xi,J as ki,K as br,L as Ri,b as Tn,M as Mi,N as Si,T as Ti,O as Ei,P as zi,Q as yr,R as Li,S as Hi}from"./image-window-loader-Ba2dfKLx.js";import{m as Lt,r as Ut,g as Ii}from"./throttle-C2-49NaF.js";import{u as Di,f as xr}from"./flatten-BavRFQMS.js";import{G as Ai}from"./scrolling-data-grid-CqIwtj2o.js";import{s as Hn}from"./marked.esm-jmFFBRfF.js";const te='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Fi=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}<rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},$i=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}<rect x="2" y="2" width="16" height="16" rx="4" fill="${s}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},Gi=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${s}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},Pi=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${s}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},Ki=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${s}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},Sr=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${s}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},Ni=t=>{const o=t.bgColor;return`${te}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Wi=Sr,Oi=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${s}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},Ui=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${s}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},Vi=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${s}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Bi=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${s}"/>
  </svg>`},Xi=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${s}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},_i=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${s}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},Yi=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${s}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},qi=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Zi=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${s}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${s}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},Ji=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${s}"/>
</svg>`},Qi=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},ji=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},es=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},ts=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},os=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${s}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},ns=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},rs=t=>{const o=t.fgColor,s=t.bgColor;return`
    ${te}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},ls=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${s}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},is=t=>{const o=t.fgColor,s=t.bgColor;return`${te}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${s}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},ss=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},cs=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},as=t=>(t.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${t.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),us=t=>(t.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${t.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),ds={headerRowID:Fi,headerNumber:Gi,headerCode:$i,headerString:Pi,headerBoolean:Ki,headerAudioUri:Wi,headerVideoUri:Oi,headerEmoji:Ui,headerImage:Vi,headerUri:Sr,headerPhone:Bi,headerMarkdown:Xi,headerDate:_i,headerTime:Yi,headerEmail:qi,headerReference:Zi,headerIfThenElse:Ji,headerSingleValue:Qi,headerLookup:ji,headerTextTemplate:es,headerMath:ts,headerRollup:os,headerJoinStrings:ns,headerSplitString:rs,headerGeoDistance:ls,headerArray:is,rowOwnerOverlay:ss,protectedColumnOverlay:cs,renameIcon:Ni,headerArrowDown:as,headerArrowUp:us},fs=Hn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),hs=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),gs=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),ms=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),vs=10,ws=t=>{const{canvasRef:o,cellYOffset:s,rows:f,columns:C,searchInputRef:k,searchValue:I,searchResults:b,onSearchValueChange:M,getCellsForSelection:z,onSearchResultsChanged:v,showSearch:R=!1,onSearchClose:S}=t,[W]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[B,Q]=l.useState(""),pe=I??B,X=l.useCallback(H=>{Q(H),M==null||M(H)},[M]),[D,V]=l.useState(),xe=l.useRef(D);xe.current=D,l.useEffect(()=>{b!==void 0&&(b.length>0?V(H=>({rowsSearched:f,results:b.length,selectedIndex:(H==null?void 0:H.selectedIndex)??-1})):V(void 0))},[f,b]);const oe=l.useRef();oe.current===void 0&&(oe.current=new AbortController);const ve=l.useRef(),[Z,re]=l.useState([]),le=b??Z,ee=l.useCallback(()=>{ve.current!==void 0&&(window.cancelAnimationFrame(ve.current),ve.current=void 0),oe.current!==void 0&&oe.current.abort(),oe.current=new AbortController},[]),Ye=l.useRef(s);Ye.current=s;const He=l.useCallback(H=>{const ce=new RegExp(H.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ge=Ye.current,De=Math.min(10,f),Ue=0;V(void 0),re([]);const wt=[],ho=async()=>{var rt;if(z===void 0)return;const Jo=performance.now(),Bt=f-Ue;let Ct=z({x:0,y:ge,width:C.length,height:Math.min(De,Bt,f-ge)},oe.current.signal);typeof Ct=="function"&&(Ct=await Ct());let go=!1;for(const[Ze,ke]of Ct.entries())for(const[Te,Je]of ke.entries()){let Qe;switch(Je.kind){case ne.Text:case ne.Number:Qe=Je.displayData;break;case ne.Uri:case ne.Markdown:Qe=Je.data;break;case ne.Boolean:Qe=typeof Je.data=="boolean"?Je.data.toString():void 0;break;case ne.Image:case ne.Bubble:Qe=Je.data.join("üê≥");break;case ne.Custom:Qe=Je.copyData;break}Qe!==void 0&&ce.test(Qe)&&(wt.push([Te,Ze+ge]),go=!0)}const Qo=performance.now();go&&re([...wt]),Ue+=Ct.length,Yo(Ue<=f);const qe=((rt=xe.current)==null?void 0:rt.selectedIndex)??-1;V({results:wt.length,rowsSearched:Ue,selectedIndex:qe}),v==null||v(wt,qe),ge+De>=f?ge=0:ge+=De;const nt=Qo-Jo,pt=Math.max(nt,1),bt=vs/pt;De=Math.ceil(De*bt),Ue<f&&wt.length<1e3&&(ve.current=window.requestAnimationFrame(ho))};ee(),ve.current=window.requestAnimationFrame(ho)},[ee,C.length,z,v,f]),Se=l.useCallback(()=>{var H;S==null||S(),V(void 0),re([]),v==null||v([],-1),ee(),(H=o==null?void 0:o.current)==null||H.focus()},[ee,o,S,v]),fo=l.useCallback(H=>{X(H.target.value),b===void 0&&(H.target.value===""?(V(void 0),re([]),ee()):He(H.target.value))},[He,ee,X,b]);l.useEffect(()=>{k.current!==null&&(X(""),V(void 0),Z.length>0&&(re([]),v==null||v([],-1)),R?k.current.focus({preventScroll:!0}):ee())},[R,k]);const vt=l.useCallback(H=>{var ge;if((ge=H==null?void 0:H.stopPropagation)==null||ge.call(H),D===void 0||D.results===0)return;const ce=(D.selectedIndex+1)%D.results;V({...D,selectedIndex:ce}),v==null||v(le,ce)},[D,v,le]),Ie=l.useCallback(H=>{var ge;if((ge=H==null?void 0:H.stopPropagation)==null||ge.call(H),D===void 0||D.results===0)return;let ce=(D.selectedIndex-1)%D.results;ce<0&&(ce+=D.results),V({...D,selectedIndex:ce}),v==null||v(le,ce)},[v,le,D]),We=l.useCallback(H=>{(H.ctrlKey||H.metaKey)&&H.nativeEvent.code==="KeyF"||H.key==="Escape"?(Se(),H.stopPropagation(),H.preventDefault()):H.key==="Enter"&&(H.shiftKey?Ie():vt())},[Se,vt,Ie]);l.useEffect(()=>()=>{ee()},[ee]);const[Vt,Oe]=l.useState(!1);l.useEffect(()=>{if(R)Oe(!0);else{const H=setTimeout(()=>Oe(!1),150);return()=>clearTimeout(H)}},[R]);const Zo=l.useMemo(()=>{if(!R&&!Vt)return null;let H;D!==void 0&&(H=D.results>=1e3?"over 1000":`${D.results} result${D.results!==1?"s":""}`,D.selectedIndex>=0&&(H=`${D.selectedIndex+1} of ${H}`));const ce=Ue=>{Ue.stopPropagation()},De={width:`${f>0?Math.floor(((D==null?void 0:D.rowsSearched)??0)/f*100):0}%`};return l.createElement(fs,{className:"gdg-search-bar"+(R?"":" out"),onMouseDown:ce,onMouseMove:ce,onMouseUp:ce,onClick:ce},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:W,"aria-hidden":!R,"data-testid":"search-input",ref:k,onChange:fo,value:pe,tabIndex:R?void 0:-1,onKeyDownCapture:We}),l.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!R,tabIndex:R?void 0:-1,onClick:Ie,disabled:((D==null?void 0:D.results)??0)===0},hs),l.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!R,tabIndex:R?void 0:-1,onClick:vt,disabled:((D==null?void 0:D.results)??0)===0},gs),S!==void 0&&l.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!R,"data-testid":"search-close-button",tabIndex:R?void 0:-1,onClick:Se},ms)),D!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},H)),l.createElement("div",{className:"gdg-search-progress",style:De})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:W},"Type to search")))},[R,Vt,D,f,W,k,fo,pe,We,Ie,vt,S,Se]);return l.createElement(l.Fragment,null,l.createElement(Ai,{prelightCells:le,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,groupLevels:t.groupLevels,groupHeaderHeights:t.groupHeaderHeights,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY,resizeIndicator:t.resizeIndicator}),Zo)};class Cs extends l.PureComponent{constructor(){super(...arguments);Mn(this,"wrapperRef",l.createRef());Mn(this,"clickOutside",s=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(s))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(s.target)){let f=s.target;for(;f!==null;){if(f.classList.contains("click-outside-ignore"))return;f=f.parentElement}this.props.onClickOutside()}})}componentDidMount(){const s=this.props.customEventTarget??document;s.addEventListener("pointerdown",this.clickOutside,!0),s.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const s=this.props.customEventTarget??document;s.removeEventListener("pointerdown",this.clickOutside,!0),s.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:s,isOutsideClick:f,customEventTarget:C,...k}=this.props;return l.createElement("div",{...k,ref:this.wrapperRef},this.props.children)}}const ps=()=>t=>Math.max(16,t.targetHeight-10),bs=Hn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[ps(),"px"]}}),ys=t=>{const{bounds:o,group:s,onClose:f,canvasBounds:C,onFinish:k}=t,[I,b]=me.useState(s);return me.createElement(Cs,{style:{position:"absolute",left:o.x-C.left+1,top:o.y-C.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:f},me.createElement(bs,{targetHeight:o.height,"data-testid":"group-rename-input",value:I,onBlur:f,onFocus:M=>M.target.setSelectionRange(0,I.length),onChange:M=>b(M.target.value),onKeyDown:M=>{M.key==="Enter"?k(I):M.key==="Escape"&&f()},autoFocus:!0}))},zn=150;function xs(t,o,s,f){var k;const C=f(o);return((k=C==null?void 0:C.measure)==null?void 0:k.call(C,t,o,s))??zn}function Tr(t,o,s,f,C,k,I,b,M){let z=0;const v=C===void 0?[]:C.map(W=>{const B=xs(t,W[f],o,M);return z=Math.max(z,B),B});if(v.length>5&&b){z=0;let W=0;for(const Q of v)W+=Q;const B=W/v.length;for(let Q=0;Q<v.length;Q++)v[Q]>=B*2?v[Q]=0:z=Math.max(z,v[Q])}const R=t.font;t.font=o.headerFontFull,z=Math.max(z,t.measureText(s.title).width+o.cellHorizontalPadding*2+(s.icon===void 0?0:28)),t.font=R;const S=Math.max(Math.ceil(k),Math.min(Math.floor(I),Math.ceil(z)));return{...s,width:S}}function ks(t,o,s,f,C,k,I,b,M){const z=l.useRef(o),v=l.useRef(s),R=l.useRef(I);z.current=o,v.current=s,R.current=I;const[S,W]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const D=document.createElement("canvas");return D.style.display="none",D.style.opacity="0",D.style.position="fixed",[D,D.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(S&&document.documentElement.append(S),()=>{S==null||S.remove()}),[S]);const B=l.useRef({}),Q=l.useRef(),[pe,X]=l.useState();return l.useLayoutEffect(()=>{const D=v.current;if(D===void 0||t.every(Bo))return;let V=Math.max(1,10-Math.floor(t.length/1e4)),xe=0;V<z.current&&V>1&&(V--,xe=1);const oe={x:0,y:0,width:t.length,height:Math.min(z.current,V)},ve={x:0,y:z.current-1,width:t.length,height:1};(async()=>{const re=D(oe,M.signal),le=xe>0?D(ve,M.signal):void 0;let ee;typeof re=="object"?ee=re:ee=await vr(re),le!==void 0&&(typeof le=="object"?ee=[...ee,...le]:ee=[...ee,...await vr(le)]),Q.current=t,X(ee)})()},[M.signal,t]),l.useMemo(()=>{let V=t.every(Bo)?t:W===null?t.map(Z=>Bo(Z)?Z:{...Z,width:zn}):(W.font=R.current.baseFontFull,t.map((Z,re)=>{if(Bo(Z))return Z;if(B.current[Z.id]!==void 0)return{...Z,width:B.current[Z.id]};if(pe===void 0||Q.current!==t||Z.id===void 0)return{...Z,width:zn};const le=Tr(W,I,Z,re,pe,C,k,!0,b);return B.current[Z.id]=le.width,le})),xe=0,oe=0;const ve=[];for(const[Z,re]of V.entries())xe+=re.width,re.grow!==void 0&&re.grow>0&&(oe+=re.grow,ve.push(Z));if(xe<f&&ve.length>0){const Z=[...V],re=f-xe;let le=re;for(let ee=0;ee<ve.length;ee++){const Ye=ve[ee],He=(V[Ye].grow??0)/oe,Se=ee===ve.length-1?le:Math.min(le,Math.floor(re*He));Z[Ye]={...V[Ye],growOffset:Se,width:V[Ye].width+Se},le-=Se}V=Z}return{sizedColumns:V,nonGrowWidth:xe}},[f,t,W,pe,I,C,k,b])}function Rs(t,o){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===o.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===o.keyCode:t===o.key}function P(t,o,s){const f=Er(t,o);return f&&(s.didMatch=!0),f}function Er(t,o){if(t.length===0)return!1;if(t.includes("|")){const M=t.split("|");for(const z of M)if(Er(z,o))return!0;return!1}let s=!1,f=!1,C=!1,k=!1;const I=t.split("+"),b=I.pop();if(!Rs(b,o))return!1;if(I[0]==="any")return!0;for(const M of I)switch(M){case"ctrl":s=!0;break;case"shift":f=!0;break;case"alt":C=!0;break;case"meta":k=!0;break;case"primary":qo.value?k=!0:s=!0;break}return o.altKey===C&&o.ctrlKey===s&&o.shiftKey===f&&o.metaKey===k}function Ms(t,o,s,f,C,k,I){const b=me.useCallback((v,R,S,W)=>{var V;(k==="cell"||k==="multi-cell")&&v!==void 0&&(v={...v,range:{x:v.cell[0],y:v.cell[1],width:1,height:1}}),!I&&v!==void 0&&v.range.width>1&&(v={...v,range:{...v.range,width:1,x:v.cell[0]}});const B=s==="mixed"&&(S||W==="drag")||s==="additive",Q=(f==="mixed"||f==="additive")&&B,pe=S||(C==="mixed"||C==="additive")&&B;let X={current:v===void 0?void 0:{...v,rangeStack:W==="drag"?((V=t.current)==null?void 0:V.rangeStack)??[]:[]},columns:Q?t.columns:j.empty(),rows:pe?t.rows:j.empty()};S&&(k==="multi-rect"||k==="multi-cell")&&X.current!==void 0&&t.current!==void 0&&(X={...X,current:{...X.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),o(X,R)},[f,t,s,k,I,C,o]),M=me.useCallback((v,R,S)=>{v=v??t.rows,R!==void 0&&(v=v.add(R));let W;if(C==="exclusive"&&v.length>0)W={current:void 0,columns:j.empty(),rows:v};else{const B=S&&s==="mixed"||s==="additive",Q=S&&f==="mixed"||f==="additive";W={current:B?t.current:void 0,columns:Q?t.columns:j.empty(),rows:v}}o(W,!1)},[f,t,s,C,o]),z=me.useCallback((v,R,S)=>{v=v??t.columns,R!==void 0&&(v=v.add(R));let W;if(f==="exclusive"&&v.length>0)W={current:void 0,rows:j.empty(),columns:v};else{const B=S&&s==="mixed"||s==="additive",Q=S&&C==="mixed"||C==="additive";W={current:B?t.current:void 0,rows:Q?t.rows:j.empty(),columns:v}}o(W,!1)},[f,t,s,C,o]);return[b,M,z]}function Ss(t,o,s,f,C){const k=l.useCallback(z=>{if(t===!0){const v=[];for(let R=z.y;R<z.y+z.height;R++){const S=[];for(let W=z.x;W<z.x+z.width;W++)W<0||R>=C?S.push({kind:ne.Loading,allowOverlay:!1}):S.push(o([W,R]));v.push(S)}return v}return(t==null?void 0:t(z,f.signal))??[]},[f.signal,o,t,C]),I=t!==void 0?k:void 0,b=l.useCallback(z=>{if(I===void 0)return[];const v={...z,x:z.x-s};if(v.x<0){v.x=0,v.width--;const R=I(v,f.signal);return typeof R=="function"?async()=>(await R()).map(S=>[{kind:ne.Loading,allowOverlay:!1},...S]):R.map(S=>[{kind:ne.Loading,allowOverlay:!1},...S])}return I(v,f.signal)},[f.signal,I,s]);return[t!==void 0?b:void 0,I]}function kr(t){return typeof t=="string"?t:`${t}px`}const Ts=()=>t=>t.innerWidth,Es=()=>t=>t.innerHeight,zs=Hn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[Ts()],"w2q57ts-1":[Es()]}}),Ls=t=>{const{inWidth:o,inHeight:s,children:f,...C}=t;return l.createElement(zs,{innerHeight:kr(s),innerWidth:kr(o),...C},f)},Hs=2,Is=1300;function Ds(t,o,s){const f=me.useRef(0),[C,k]=t??[0,0];me.useEffect(()=>{if(C===0&&k===0){f.current=0;return}let I=!1,b=0;const M=z=>{var v;if(!I){if(b===0)b=z;else{const R=z-b;f.current=Math.min(1,f.current+R/Is);const S=f.current**1.618*R*Hs;(v=o.current)==null||v.scrollBy(C*S,k*S),b=z,s==null||s()}window.requestAnimationFrame(M)}};return window.requestAnimationFrame(M),()=>{I=!0}},[o,C,k,s])}function As({rowHeight:t,headerHeight:o,groupHeaderHeight:s,theme:f,overscrollX:C,overscrollY:k,scaleToRem:I,remSize:b}){const[M,z,v,R,S,W]=me.useMemo(()=>{if(!I||b===16)return[t,o,s,f,C,k];const B=b/16,Q=t,pe=Mr();return[typeof Q=="number"?Q*B:X=>Math.ceil(Q(X)*B),Math.ceil(o*B),Math.ceil(s*B),{...f,headerIconSize:((f==null?void 0:f.headerIconSize)??pe.headerIconSize)*B,cellHorizontalPadding:((f==null?void 0:f.cellHorizontalPadding)??pe.cellHorizontalPadding)*B,cellVerticalPadding:((f==null?void 0:f.cellVerticalPadding)??pe.cellVerticalPadding)*B},Math.ceil((C??0)*B),Math.ceil((k??0)*B)]},[s,o,C,k,b,t,I,f]);return{rowHeight:M,headerHeight:z,groupHeaderHeight:v,theme:R,overscrollX:S,overscrollY:W}}const ht={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function K(t,o){return t===!0?o:t===!1?"":t}function Rr(t){const o=qo.value;return{activateCell:K(t.activateCell," |Enter|shift+Enter"),clear:K(t.clear,"any+Escape"),closeOverlay:K(t.closeOverlay,"any+Escape"),acceptOverlayDown:K(t.acceptOverlayDown,"Enter"),acceptOverlayUp:K(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:K(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:K(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:K(t.delete,o?"Backspace|Delete":"Delete"),downFill:K(t.downFill,"primary+_68"),scrollToSelectedCell:K(t.scrollToSelectedCell,"primary+Enter"),goDownCell:K(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:K(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:K(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:K(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:K(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:K(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:K(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:K(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:K(t.goToFirstCell,"primary+Home"),goToFirstColumn:K(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:K(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:K(t.goToLastCell,"primary+End"),goToLastColumn:K(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:K(t.goToLastRow,"primary+ArrowDown"),goToNextPage:K(t.goToNextPage,"PageDown"),goToPreviousPage:K(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:K(t.rightFill,"primary+_82"),search:K(t.search,"primary+f"),selectAll:K(t.selectAll,"primary+a"),selectColumn:K(t.selectColumn,"ctrl+ "),selectGrowDown:K(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:K(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:K(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:K(t.selectGrowUp,"shift+ArrowUp"),selectRow:K(t.selectRow,"shift+ "),selectToFirstCell:K(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:K(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:K(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:K(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:K(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:K(t.selectToLastRow,"primary+shift+ArrowDown")}}function Fs(t){const o=ai(t);return me.useMemo(()=>{if(o===void 0)return Rr(ht);const s={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??ht.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??ht.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??ht.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??ht.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??ht.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??ht.selectToLastCell};return Rr({...ht,...s})},[o])}function $s(t){function o(f,C,k){if(typeof f=="number")return{headerIndex:f,isCollapsed:!1,depth:C,path:k};const I={headerIndex:f.headerIndex,isCollapsed:f.isCollapsed,depth:C,path:k};return f.subGroups!==void 0&&(I.subGroups=f.subGroups.map((b,M)=>o(b,C+1,[...k,M])).sort((b,M)=>b.headerIndex-M.headerIndex)),I}return t.map((f,C)=>o(f,0,[C])).sort((f,C)=>f.headerIndex-C.headerIndex)}function In(t,o){const s=[];function f(b,M,z=!1){let v=M!==null?M-b.headerIndex:o-b.headerIndex;if(b.subGroups!==void 0&&(v=b.subGroups[0].headerIndex-b.headerIndex),v--,s.push({rowIndex:-1,headerIndex:b.headerIndex,contentIndex:-1,skip:z,isCollapsed:b.isCollapsed,depth:b.depth,path:b.path,rows:v}),b.subGroups)for(let R=0;R<b.subGroups.length;R++){const S=R<b.subGroups.length-1?b.subGroups[R+1].headerIndex:M;f(b.subGroups[R],S,z||b.isCollapsed)}}const C=$s(t.groups);for(let b=0;b<C.length;b++){const M=b<C.length-1?C[b+1].headerIndex:null;f(C[b],M)}let k=0,I=0;for(const b of s)b.contentIndex=I,I+=b.rows,b.rowIndex=k,k+=b.isCollapsed?1:b.rows+1;return s.filter(b=>b.skip===!1).map(b=>{const{skip:M,...z}=b;return z})}function Ln(t,o){if(o===void 0||In.length===0)return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1};let s=t;for(const f of o){if(s===0)return{path:[...f.path,-1],originalIndex:f.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:f.rows};if(f.isCollapsed)s--;else{if(s<=f.rows)return{path:[...f.path,s-1],originalIndex:f.headerIndex+s,isGroupHeader:!1,groupIndex:s-1,contentIndex:f.contentIndex+s-1,groupRows:f.rows};s=s-f.rows-1}}return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1}}function Gs(t,o,s,f){const C=me.useMemo(()=>t===void 0?void 0:In(t,o),[t,o]),k=me.useMemo(()=>C==null?void 0:C.reduce((v,R)=>(v[R.rowIndex]=R,v),{}),[C]),I=me.useMemo(()=>C===void 0?o:C.reduce((v,R)=>v+(R.isCollapsed?1:R.rows+1),0),[C,o]),b=me.useMemo(()=>t===void 0||typeof s=="number"&&t.height===s?s:v=>k!=null&&k[v]?t.height:typeof s=="number"?s:s(v),[k,t,s]),M=me.useCallback(v=>{if(C===void 0)return v;let R=v;for(const S of C){if(R===0)return;if(R--,!S.isCollapsed){if(R<S.rows)return S.contentIndex+R;R-=S.rows}}return v},[C]),z=mt(f??(t==null?void 0:t.themeOverride),me.useCallback(v=>{if(t===void 0)return f==null?void 0:f(v,v,v);if(f===void 0&&(t==null?void 0:t.themeOverride)===void 0)return;const{isGroupHeader:R,contentIndex:S,groupIndex:W}=Ln(v,C);return R?t.themeOverride:f==null?void 0:f(v,W,S)},[C,f,t]));return t===void 0?{rowHeight:b,rows:o,rowNumberMapper:M,getRowThemeOverride:z}:{rowHeight:b,rows:I,rowNumberMapper:M,getRowThemeOverride:z}}function Ps(t,o){const s=me.useMemo(()=>t===void 0?void 0:In(t,o),[t,o]);return{getRowGroupingForPath:Lr,updateRowGroupingByPath:zr,mapper:me.useCallback(f=>{if(typeof f=="number")return Ln(f,s);const C=Ln(f[1],s);return{...C,originalIndex:[f[0],C.originalIndex]}},[s])}}function zr(t,o,s){const[f,...C]=o;return C[0]===-1?t.map((k,I)=>I===f?{...k,...s}:k):t.map((k,I)=>I===f?{...k,subGroups:zr(k.subGroups??[],C,s)}:k)}function Lr(t,o){const[s,...f]=o;return f[0]===-1?t[s]:Lr(t[s].subGroups??[],f)}function Ks(t,o){const[s]=l.useState(()=>({value:t,callback:o,facade:{get current(){return s.value},set current(f){const C=s.value;C!==f&&(s.value=f,s.callback(f,C))}}}));return s.callback=o,s.facade}function Ns(t,o,s,f,C){const[k,I]=l.useMemo(()=>[o!==void 0&&typeof s=="number"?Math.floor(o/s):0,o!==void 0&&typeof s=="number"?-(o%s):0],[o,s]),b=l.useMemo(()=>({x:f.current.x,y:k,width:f.current.width??1,height:f.current.height??1,ty:I}),[f,I,k]),[M,z,v]=ui(b),R=l.useRef(C);R.current=C;const S=Ks(null,Q=>{Q!==null&&o!==void 0?Q.scrollTop=o:Q!==null&&t!==void 0&&(Q.scrollLeft=t)}),W=(M.height??1)>1;l.useLayoutEffect(()=>{if(o!==void 0&&S.current!==null&&W){if(S.current.scrollTop===o)return;S.current.scrollTop=o,S.current.scrollTop!==o&&v(),R.current()}},[o,W,v,S]);const B=(M.width??1)>1;return l.useLayoutEffect(()=>{if(t!==void 0&&S.current!==null&&B){if(S.current.scrollLeft===t)return;S.current.scrollLeft=t,S.current.scrollLeft!==t&&v(),R.current()}},[t,B,v,S]),{visibleRegion:M,setVisibleRegion:z,scrollRef:S}}const Ws=l.lazy(async()=>await ci(()=>import("./data-grid-overlay-editor-BqJP74d_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url));let Os=0;function Us(t){return Di(xr(xr(t).filter(o=>o.span!==void 0).map(o=>{var s,f;return Ut((((s=o.span)==null?void 0:s[0])??0)+1,(((f=o.span)==null?void 0:f[1])??0)+1)})))}function _o(t,o){return t===void 0||o===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+o,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+o},rangeStack:t.current.rangeStack.map(s=>({...s,x:s.x+o}))},rows:t.rows,columns:t.columns.offset(o)}}const gt={kind:ne.Loading,allowOverlay:!1},En={columns:j.empty(),rows:j.empty(),current:void 0},Vs=(t,o)=>{var hr,gr,mr;const[s,f]=l.useState(En),[C,k]=l.useState(),I=l.useRef(null),b=l.useRef(null),[M,z]=l.useState(),v=l.useRef(void 0),R=typeof window>"u"?null:window,{imageEditorOverride:S,getRowThemeOverride:W,markdownDivCreateNode:B,width:Q,height:pe,columns:X,rows:D,getCellContent:V,onCellClicked:xe,onCellActivated:oe,onFillPattern:ve,onFinishedEditing:Z,coercePasteValue:re,drawHeader:le,drawCell:ee,editorBloom:Ye,onHeaderClicked:He,onColumnProposeMove:Se,rangeSelectionColumnSpanning:fo=!0,spanRangeBehavior:vt="default",onGroupHeaderClicked:Ie,onCellContextMenu:We,className:Vt,onHeaderContextMenu:Oe,getCellsForSelection:Zo,onGroupHeaderContextMenu:H,onGroupHeaderRenamed:ce,onCellEdited:ge,onCellsEdited:De,onSearchResultsChanged:Ue,searchResults:wt,onSearchValueChange:ho,searchValue:Jo,onKeyDown:Bt,onKeyUp:Ct,keybindings:go,editOnType:Qo=!0,onRowAppended:qe,onColumnAppended:nt,onColumnMoved:pt,validateCell:bt,highlightRegions:rt,rangeSelect:Ze="rect",columnSelect:ke="multi",rowSelect:Te="multi",rangeSelectionBlending:Je="exclusive",columnSelectionBlending:Qe="exclusive",rowSelectionBlending:Hr="exclusive",onDelete:jo,onDragStart:mo,onMouseMove:vo,onPaste:yt,copyHeaders:Dn=!1,freezeColumns:je=0,cellActivationBehavior:wo="second-click",rowSelectionMode:en="auto",columnSelectionMode:Xt="auto",onHeaderMenuClick:Co,onHeaderIndicatorClick:po,getGroupDetails:bo,rowGrouping:lt,onSearchClose:tn,onItemHovered:yo,onSelectionCleared:it,showSearch:Ir,onVisibleRegionChanged:xo,gridSelection:xt,onGridSelectionChange:on,minColumnWidth:Dr=50,maxColumnWidth:Ar=500,maxColumnAutoWidth:Fr,provideEditor:$r,trailingRowOptions:Y,freezeTrailingRows:et=0,allowedFillDirections:An="orthogonal",scrollOffsetX:Gr,scrollOffsetY:Pr,verticalBorder:Ht,onDragOverCell:Kr,onDrop:Nr,onColumnResize:_t,onColumnResizeEnd:Yt,onColumnResizeStart:qt,customRenderers:ko,fillHandle:Wr,experimental:ue,fixedShadowX:Or,fixedShadowY:Ur,headerIcons:Vr,imageWindowLoader:Br,initialSize:Xr,isDraggable:_r,onDragLeave:Yr,onRowMoved:Zt,overscrollX:qr,overscrollY:Zr,preventDiagonalScrolling:Jr,rightElement:Qr,rightElementProps:jr,trapFocus:Fn=!1,smoothScrollX:el,smoothScrollY:tl,scaleToRem:ol=!1,rowHeight:nl=34,headerHeight:$n=36,groupHeaderHeight:rl=$n,theme:ll,isOutsideClick:il,renderers:nn,resizeIndicator:sl,scrollToActiveCell:Gn=!0,drawFocusRing:Pn=!0,portalElementRef:cl,isActivationOnEnter:It,onRowStatus:Ro,onRowId:Mo}=t,Kn=Pn==="no-editor"?C===void 0:Pn,$=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,al=($==null?void 0:$.rowNumber)??!1;let So=($==null?void 0:$.kind)??t.rowMarkers??"none",tt=al;(So==="both"||So==="checkbox-and-number")&&(So="checkbox",tt=!0);const Ae=So,ul=($==null?void 0:$.width)??t.rowMarkerWidth,rn=($==null?void 0:$.startIndex)??t.rowMarkerStartIndex??1,ln=($==null?void 0:$.theme)??t.rowMarkerTheme,sn=$==null?void 0:$.headerTheme,Nn=$==null?void 0:$.headerAlwaysVisible,To=Te!=="multi"||($==null?void 0:$.headerDisabled)===!0,Dt=($==null?void 0:$.checkboxStyle)??"square",dl=($==null?void 0:$.rowStatus)??!1,Wn=($==null?void 0:$.rowStatusWidth)??40,Eo=$==null?void 0:$.rowStatusTheme,fl=($==null?void 0:$.rowId)??!1,On=($==null?void 0:$.rowIdWidth)??80,zo=$==null?void 0:$.rowIdTheme,At=Math.max(Dr,20),Lo=Math.max(Ar,At),hl=Math.max(Fr??Lo,At),Un=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:F,rowNumberMapper:cn,rowHeight:gl,getRowThemeOverride:ot}=Gs(lt,D,nl,W),ml=l.useMemo(()=>Number.parseFloat(Un.fontSize),[Un]),{rowHeight:st,headerHeight:Vn,groupHeaderHeight:an,theme:Bn,overscrollX:vl,overscrollY:wl}=As({groupHeaderHeight:rl,headerHeight:$n,overscrollX:qr,overscrollY:Zr,remSize:ml,rowHeight:gl,scaleToRem:ol,theme:ll}),ct=Fs(go),kt=ul??(D>1e4?48:D>1e3?44:D>100?36:32),Xe=Ae!=="none",Jt=dl===!0,Qt=fl===!0,c=(Xe?tt?2:1:0)+(Jt?1:0)+(Qt?1:0),ae=Y!==void 0,jt=(Y==null?void 0:Y.sticky)===!0,[Cl,Xn]=l.useState(!1),pl=Ir??Cl,bl=l.useCallback(()=>{tn!==void 0?tn():Xn(!1)},[tn]),g=l.useMemo(()=>xt===void 0?void 0:_o(xt,c),[xt,c])??s,Fe=l.useRef(new AbortController);l.useEffect(()=>()=>Fe==null?void 0:Fe.current.abort(),[]);const[we,yl]=Ss(Zo,V,c,Fe.current,F),xl=l.useCallback((e,n,r)=>{if(bt===void 0)return!0;const i=[e[0]-c,e[1]];return bt==null?void 0:bt(i,n,r)},[c,bt]),Ho=l.useRef(xt),$e=l.useCallback((e,n)=>{n&&(e=di(e,we,c,vt,Fe.current)),on!==void 0?(Ho.current=_o(e,-c),on(Ho.current)):f(e)},[on,we,c,vt]),Ft=mt(_t,l.useCallback((e,n,r,i)=>{_t==null||_t(X[r-c],n,r-c,i)},[_t,c,X])),kl=mt(Yt,l.useCallback((e,n,r,i)=>{Yt==null||Yt(X[r-c],n,r-c,i)},[Yt,c,X])),Rl=mt(qt,l.useCallback((e,n,r,i)=>{qt==null||qt(X[r-c],n,r-c,i)},[qt,c,X])),Ml=mt(le,l.useCallback((e,n)=>(le==null?void 0:le({...e,columnIndex:e.columnIndex-c},n))??!1,[le,c])),Sl=mt(ee,l.useCallback((e,n)=>(ee==null?void 0:ee({...e,col:e.col-c},n))??!1,[ee,c])),at=l.useCallback(e=>{if(jo!==void 0){const n=jo(_o(e,-c));return typeof n=="boolean"?n:_o(n,c)}return!0},[jo,c]),[Ce,Re,de]=Ms(g,$e,Je,Qe,Hr,Ze,fo),be=l.useMemo(()=>Sn(Mr(),Bn),[Bn]),[un,Tl]=l.useState([0,0,0]),_n=l.useMemo(()=>{if(nn===void 0)return{};const e={};for(const n of nn)e[n.kind]=n;return e},[nn]),Me=l.useCallback(e=>e.kind!==ne.Custom?_n[e.kind]:ko==null?void 0:ko.find(n=>n.isMatch(e)),[ko,_n]);let{sizedColumns:Ge,nonGrowWidth:Yn}=ks(X,F,yl,un[0]-(c===0?0:kt)-un[2],At,hl,be,Me,Fe.current);Ae!=="none"&&(Yn+=kt);const eo=l.useMemo(()=>{let e=0;for(const n of Ge)n.group!==void 0&&(typeof n.group=="string"?e=Math.max(e,1):e=Math.max(e,n.group.length));return e},[Ge]),qn=eo>0,Zn=l.useMemo(()=>eo===0?[]:Array(eo).fill(an),[eo,an]),El=Zn.reduce((e,n)=>e+n,0),to=Vn+El,Jn=g.rows.length,Qn=Ae==="none"?void 0:Jn===0?!1:Jn===F?!0:void 0,O=l.useMemo(()=>{const e=[];return Ae!=="none"&&(tt&&e.push({title:"",width:kt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:ln,rowMarker:Dt,rowMarkerChecked:!1,headerRowMarkerTheme:sn,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),e.push({title:"",width:kt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:ln,rowMarker:Dt,rowMarkerChecked:Qn,headerRowMarkerTheme:sn,headerRowMarkerAlwaysVisible:Nn,headerRowMarkerDisabled:To})),Jt&&e.push({title:"",width:Wn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Eo}),Qt&&e.push({title:"ID",width:On,icon:void 0,hasMenu:!1,style:"normal",themeOverride:zo}),[...e,...Ge]},[Jt,Wn,Eo,Qt,On,zo,Ae,Ge,kt,ln,Dt,Qn,sn,Nn,To,tt]),ze=l.useRef({height:1,width:1,x:0,y:0}),Io=l.useRef(!1),{setVisibleRegion:jn,visibleRegion:Rt,scrollRef:q}=Ns(Gr,Pr,st,ze,()=>Io.current=!0);ze.current=Rt;const zl=Rt.x+c,Do=Rt.y,fe=l.useRef(null),ye=l.useCallback(e=>{var n;e===!0?(n=fe.current)==null||n.focus():window.requestAnimationFrame(()=>{var r;(r=fe.current)==null||r.focus()})},[]),he=ae?F+1:F,Pe=l.useCallback(e=>{const n=c===0?e:e.map(i=>({...i,location:[i.location[0]-c,i.location[1]]})),r=De==null?void 0:De(n);if(r!==!0)for(const i of n)ge==null||ge(i.location,i.value);return r},[ge,De,c]),[Mt,dn]=l.useState(),Ao=g.current!==void 0&&g.current.range.width*g.current.range.height>1?g.current.range:void 0,$t=Kn?(hr=g.current)==null?void 0:hr.cell:void 0,Fo=$t==null?void 0:$t[0],$o=$t==null?void 0:$t[1],Ll=l.useMemo(()=>{if((rt===void 0||rt.length===0)&&(Ao??Fo??$o??Mt)===void 0)return;const e=[];if(rt!==void 0)for(const n of rt){const r=O.length-n.range.x-c;r>0&&e.push({color:n.color,range:{...n.range,x:n.range.x+c,width:Math.min(r,n.range.width)},style:n.style})}return Mt!==void 0&&e.push({color:wr(be.accentColor,0),range:Mt,style:"dashed"}),Ao!==void 0&&e.push({color:wr(be.accentColor,.5),range:Ao,style:"solid-outline"}),Fo!==void 0&&$o!==void 0&&e.push({color:be.accentColor,range:{x:Fo,y:$o,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[Mt,Ao,Fo,$o,rt,O.length,be.accentColor,c]),er=l.useRef(O);er.current=O;const Le=l.useCallback(([e,n],r=!1)=>{var w,p,x,y,N,A,U,G,E;const i=ae&&n===he-1;let d=0,m=-1,u=-1,a=-1,h=-1;if(Xe&&tt&&(m=d++),Xe&&(u=d++),Jt&&(a=d++),Qt&&(h=d++),e===m){if(i)return gt;const L=cn(n);return L===void 0?gt:{kind:zt.Marker,allowOverlay:!1,checkboxStyle:Dt,checked:!1,markerKind:"number",row:rn+L,drawHandle:!1,cursor:void 0,disabled:((w=t.disabledRows)==null?void 0:w.call(t,n))===!0}}if(e===u){if(i)return gt;const L=cn(n);if(L===void 0)return gt;let _;return tt?_=Ae==="checkbox-visible"?"checkbox-visible":"checkbox":Ae==="clickable-number"?_="number":_=Ae,{kind:zt.Marker,allowOverlay:!1,checkboxStyle:Dt,checked:(g==null?void 0:g.rows.hasIndex(n))===!0,markerKind:_,row:rn+L,drawHandle:Zt!==void 0,cursor:tt?void 0:Ae==="clickable-number"?"pointer":void 0,disabled:((p=t.disabledRows)==null?void 0:p.call(t,n))===!0}}if(e===a){if(i)return gt;const L=Ro==null?void 0:Ro(n);return{kind:zt.RowStatus,allowOverlay:!1,status:L,themeOverride:Eo}}if(e===h){if(i)return gt;const L=Mo==null?void 0:Mo(n);return{kind:zt.RowId,allowOverlay:!1,rowId:L,themeOverride:zo}}if(i){const _=e===c?(Y==null?void 0:Y.hint)??"":"",T=er.current[e];if(((x=T==null?void 0:T.trailingRowOptions)==null?void 0:x.disabled)===!0)return gt;{const J=((y=T==null?void 0:T.trailingRowOptions)==null?void 0:y.hint)??_,se=((N=T==null?void 0:T.trailingRowOptions)==null?void 0:N.addIcon)??(Y==null?void 0:Y.addIcon);return{kind:zt.NewRow,hint:J,allowOverlay:!1,icon:se}}}else{const L=e-c;if(r||(ue==null?void 0:ue.strict)===!0){const T=ze.current,J=T.x>L||L>T.x+T.width||T.y>n||n>T.y+T.height||n>=mn.current,se=L===((U=(A=T.extras)==null?void 0:A.selected)==null?void 0:U[0])&&n===((G=T.extras)==null?void 0:G.selected[1]);let Ee=!1;if(((E=T.extras)==null?void 0:E.freezeRegions)!==void 0){for(const Ne of T.extras.freezeRegions)if(fi(Ne,L,n)){Ee=!0;break}}if(J&&!se&&!Ee)return gt}let _=V([L,n]);return c!==0&&_.span!==void 0&&(_={..._,span:[_.span[0]+c,_.span[1]+c]}),_}},[ae,he,Jt,Ro,Eo,Qt,Mo,zo,Xe,cn,Dt,g==null?void 0:g.rows,Ae,rn,Zt,c,Y==null?void 0:Y.hint,Y==null?void 0:Y.addIcon,ue==null?void 0:ue.strict,V,tt]),fn=l.useCallback(e=>{let n=(bo==null?void 0:bo(e))??{name:e};return ce!==void 0&&e!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:r=>wn({group:n.name,bounds:r.bounds})}]}),n},[bo,ce]),Gt=l.useCallback(e=>{var a;const[n,r]=e.cell,i=O[n],d=(i==null?void 0:i.group)!==void 0?(a=fn(i.group))==null?void 0:a.overrideTheme:void 0,m=i==null?void 0:i.themeOverride,u=ot==null?void 0:ot(r);k({...e,theme:Sn(be,d,m,u,e.content.themeOverride)})},[ot,O,fn,be]),oo=l.useCallback((e,n,r)=>{var u;if(g.current===void 0)return;const[i,d]=g.current.cell,m=Le([i,d]);if(m.kind!==ne.Boolean&&m.allowOverlay){let a=m;if(r!==void 0)switch(a.kind){case ne.Number:{const h=hi(()=>r==="-"?-0:Number.parseFloat(r),0);a={...a,data:Number.isNaN(h)?0:h};break}case ne.Text:case ne.Markdown:case ne.Uri:a={...a,data:r};break}Gt({target:e,content:a,initialValue:r,cell:[i,d],highlight:r===void 0,forceEditMode:r!==void 0,activation:n})}else m.kind===ne.Boolean&&n.inputType==="keyboard"&&m.readonly!==!0&&(Pe([{location:g.current.cell,value:{...m,data:gi(m.data)}}]),(u=fe.current)==null||u.damage([{cell:g.current.cell}]))},[Le,g,Pe,Gt]),tr=l.useCallback((e,n)=>{var d;const r=(d=fe.current)==null?void 0:d.getBounds(e,n);if(r===void 0||q.current===null)return;const i=Le([e,n]);i.allowOverlay&&Gt({target:r,content:i,initialValue:void 0,highlight:!0,cell:[e,n],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Le,q,Gt]),ie=l.useCallback((e,n,r="both",i=0,d=0,m=void 0)=>{if(q.current!==null){const u=fe.current,a=b.current,h=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,w=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,p=typeof e!="number"&&e.unit==="px"?e.amount:void 0,x=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(u!==null&&a!==null){let y={x:0,y:0,width:0,height:0},N=0,A=0;if((h!==void 0||w!==void 0)&&(y=u.getBounds((h??0)+c,w??0)??y,y.width===0||y.height===0))return;const U=a.getBoundingClientRect(),G=U.width/a.offsetWidth;if(p!==void 0&&(y={...y,x:p-U.left-q.current.scrollLeft,width:1}),x!==void 0&&(y={...y,y:x+U.top-q.current.scrollTop,height:1}),y!==void 0){const E={x:y.x-i,y:y.y-d,width:y.width+2*i,height:y.height+2*d};let L=0;for(let Rn=0;Rn<je;Rn++)L+=Ge[Rn].width;let _=0;const T=et+(jt?1:0);T>0&&(_=mi(he,T,st));let J=L*G+U.left+c*kt*G,se=U.right,Ee=U.top+to*G,Ne=U.bottom-_*G;const Uo=y.width+i*2;switch(m==null?void 0:m.hAlign){case"start":se=J+Uo;break;case"end":J=se-Uo;break;case"center":J=Math.floor((J+se)/2)-Uo/2,se=J+Uo;break}const Vo=y.height+d*2;switch(m==null?void 0:m.vAlign){case"start":Ne=Ee+Vo;break;case"end":Ee=Ne-Vo;break;case"center":Ee=Math.floor((Ee+Ne)/2)-Vo/2,Ne=Ee+Vo;break}J>E.x?N=E.x-J:se<E.x+E.width&&(N=E.x+E.width-se),Ee>E.y?A=E.y-Ee:Ne<E.y+E.height&&(A=E.y+E.height-Ne),r==="vertical"||typeof e=="number"&&e<je?N=0:(r==="horizontal"||typeof n=="number"&&n>=he-T)&&(A=0),(N!==0||A!==0)&&(G!==1&&(N/=G,A/=G),q.current.scrollTo({left:N+q.current.scrollLeft,top:A+q.current.scrollTop,behavior:(m==null?void 0:m.behavior)??"auto"}))}}}},[c,et,kt,q,to,je,Ge,he,jt,st]),hn=l.useRef(tr),gn=l.useRef(V);hn.current=tr,gn.current=V;const mn=l.useRef(F);mn.current=F;const or=l.useRef(O.length);or.current=O.length;const ut=l.useCallback(async(e,n=!0,r)=>{var w;const i=O[e];if(((w=i==null?void 0:i.trailingRowOptions)==null?void 0:w.disabled)===!0)return;const d=qe==null?void 0:qe();let m,u=!0;d!==void 0&&(m=await d,m==="top"&&(u=!1),typeof m=="number"&&(u=!1));let a=0;const h=()=>{if(mn.current<=F){a<500&&window.setTimeout(h,a),a=50+a*2;return}const p=typeof m=="number"?m:u?F:0;Oo.current(e-c,p,"both",0,20,r?{behavior:r}:void 0),Ce({cell:[e,p],range:{x:e,y:p,width:1,height:1}},!1,!1,"edit");const x=gn.current([e-c,p]);x.allowOverlay&&ao(x)&&x.readonly!==!0&&n&&window.setTimeout(()=>{hn.current(e,p)},0)};h()},[O,qe,c,F,Ce]),Go=l.useCallback(async(e,n=!0)=>{const r=nt==null?void 0:nt();let i,d=!0;r!==void 0&&(i=await r,i==="left"&&(d=!1),typeof i=="number"&&(d=!1));let m=0;const u=()=>{if(or.current<=O.length){m<500&&window.setTimeout(u,m),m=50+m*2;return}const a=typeof i=="number"?i:d?O.length:0;ie(a-c,e),Ce({cell:[a,e],range:{x:a,y:e,width:1,height:1}},!1,!1,"edit");const h=gn.current([a-c,e]);h.allowOverlay&&ao(h)&&h.readonly!==!0&&n&&window.setTimeout(()=>{hn.current(a,e)},0)};u()},[O,nt,c,ie,Ce]),Pt=l.useCallback(e=>{var r,i;const n=((i=(r=Ge[e])==null?void 0:r.trailingRowOptions)==null?void 0:i.targetColumn)??(Y==null?void 0:Y.targetColumn);if(typeof n=="number")return n+(Xe?1:0);if(typeof n=="object"){const d=X.indexOf(n);if(d>=0)return d+(Xe?1:0)}},[Ge,X,Xe,Y==null?void 0:Y.targetColumn]),dt=l.useRef(void 0),Kt=l.useRef(void 0),no=l.useCallback((e,n)=>{var d;const[r,i]=n;return Sn(be,(d=O[r])==null?void 0:d.themeOverride,ot==null?void 0:ot(i),e.themeOverride)},[ot,O,be]),{mapper:St}=Ps(lt,D),Ve=lt==null?void 0:lt.navigationBehavior,ro=l.useCallback(e=>{var w,p,x;const n=qo.value?e.metaKey:e.ctrlKey,r=n&&Te==="multi",[i,d]=e.location,m=g.columns,u=g.rows,[a,h]=((w=g.current)==null?void 0:w.cell)??[];if(e.kind==="cell"){if(Kt.current=void 0,Tt.current=[i,d],i===(tt?1:0)&&Xe){if(ae===!0&&d===F||Ae==="number"||Te==="none")return;const A=Le(e.location);if(A.kind!==zt.Marker||A.disabled===!0)return;if(Zt!==void 0){const E=Me(A);Yo((E==null?void 0:E.kind)===zt.Marker);const L=(p=E==null?void 0:E.onClick)==null?void 0:p.call(E,{...e,cell:A,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:no(A,e.location),preventDefault:()=>{}});if(L===void 0||L.checked===A.checked)return}k(void 0),ye();const U=u.hasIndex(d),G=dt.current;if(Te==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&G!==void 0&&u.hasIndex(G)){const E=[Math.min(G,d),Math.max(G,d)+1];r||en==="multi"?Re(void 0,E,!0):Re(j.fromSingleSelection(E),void 0,r)}else Te==="multi"&&(r||e.isTouch||en==="multi")?U?Re(u.remove(d),void 0,!0):(Re(void 0,d,!0),dt.current=d):U&&u.length===1?Re(j.empty(),void 0,n):(Re(j.fromSingleSelection(d),void 0,n),dt.current=d)}else if(i>=c&&ae&&d===F){const A=Pt(i);ut(A??i)}else if(a!==i||h!==d){const A=Le(e.location),U=Me(A);if((U==null?void 0:U.onSelect)!==void 0){let L=!1;if(U.onSelect({...e,cell:A,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>L=!0,theme:no(A,e.location)}),L)return}if(Ve==="block"&&St(d).isGroupHeader)return;const G=jt&&d===F,E=jt&&g!==void 0&&((x=g.current)==null?void 0:x.cell[1])===F;if((e.shiftKey||e.isLongTouch===!0)&&a!==void 0&&h!==void 0&&g.current!==void 0&&!E){if(G)return;const L=Math.min(i,a),_=Math.max(i,a),T=Math.min(d,h),J=Math.max(d,h);Ce({...g.current,range:{x:L,y:T,width:_-L+1,height:J-T+1}},!0,n,"click"),dt.current=void 0,ye()}else{const L=g.rows.length>0;Ce({cell:[i,d],range:{x:i,y:d,width:1,height:1}},!0,n||L,"click"),dt.current=void 0,k(void 0),ye()}}}else if(e.kind==="header")if(Tt.current=[i,d],k(void 0),Xe&&i===0)dt.current=void 0,Kt.current=void 0,!To&&Te==="multi"&&(u.length!==F?Re(j.fromSingleSelection([0,F]),void 0,n):Re(j.empty(),void 0,n),ye());else{const y=Kt.current;if(ke==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&y!==void 0&&m.hasIndex(y)){const N=[Math.min(y,i),Math.max(y,i)+1];n||e.isTouch||Xt==="multi"?de(void 0,N,n):de(j.fromSingleSelection(N),void 0,n)}else ke==="multi"&&(n||e.isTouch||Xt==="multi")?(m.hasIndex(i)?de(m.remove(i),void 0,n):de(void 0,i,n),Kt.current=i):ke!=="none"&&(m.hasIndex(i)?de(m.remove(i),void 0,n):de(j.fromSingleSelection(i),void 0,n),Kt.current=i);dt.current=void 0,ye()}else e.kind===Ot?Tt.current=[i,d]:e.kind===Cr&&!e.isMaybeScrollbar&&($e(En,!1),k(void 0),ye(),it==null||it(),dt.current=void 0,Kt.current=void 0)},[Te,ke,g,Xe,c,ae,F,Ae,Le,Zt,ye,en,Xt,Me,no,Re,Pt,ut,Ve,St,jt,Ce,To,de,$e,it]),lo=l.useRef(!1),Tt=l.useRef(void 0),nr=l.useRef(Rt),Ke=l.useRef(void 0),Hl=l.useCallback(e=>{if(Nt.current=!1,nr.current=ze.current,e.button!==0&&e.button!==1){Ke.current=void 0;return}const n=performance.now();Ke.current={button:e.button,time:n,location:e.location},(e==null?void 0:e.kind)==="header"&&(lo.current=!0);const r=e.kind==="cell"&&e.isFillHandle;!r&&e.kind!=="cell"&&e.isEdge||(z({previousSelection:g,fillHandle:r}),Tt.current=void 0,!e.isTouch&&e.button===0&&!r?ro(e):!e.isTouch&&e.button===1&&(Tt.current=e.location))},[g,ro]),[vn,wn]=l.useState(),rr=l.useCallback(e=>{if(e.kind!==Ot||ke!=="multi")return;const n=qo.value?e.metaKey:e.ctrlKey,[r,i]=e.location,d=g.columns;if(r<c)return;const m=O[r];let u=r,a=r;const h=i<=-2?-(i+2):0,w=Array.isArray(m.group)?m.group.length:1,p=(x,y)=>w>1?Ei(x,y,h,w):zi(x,y);for(let x=r-1;x>=c&&p(m.group,O[x].group);x--)u--;for(let x=r+1;x<O.length&&p(m.group,O[x].group);x++)a++;if(ye(),n||e.isTouch||Xt==="multi")if(d.hasAll([u,a+1])){let x=d;for(let y=u;y<=a;y++)x=x.remove(y);de(x,void 0,n)}else de(void 0,[u,a+1],n);else de(j.fromSingleSelection([u,a+1]),void 0,n)},[ke,ye,g.columns,O,c,de,Xt]),Nt=l.useRef(!1),Po=l.useCallback(async e=>{if(we!==void 0&&Ft!==void 0){const n=ze.current.y,r=ze.current.height;let i=we({x:e,y:n,width:1,height:Math.min(r,F-n)},Fe.current.signal);typeof i!="object"&&(i=await i());const d=Ge[e-c],u=document.createElement("canvas").getContext("2d",{alpha:!1});if(u!==null){u.font=be.baseFontFull;const a=Tr(u,be,d,0,i,At,Lo,!1,Me);Ft==null||Ft(d,a.width,e,a.width)}}},[Ge,we,Lo,be,At,Ft,c,F,Me]),[Il,Cn]=l.useState(),Wt=l.useCallback(async(e,n)=>{var a,h;const r=(a=e.current)==null?void 0:a.range;if(r===void 0||we===void 0||n.current===void 0)return;const i=n.current.range;if(ve!==void 0){let w=!1;if(ve({fillDestination:{...i,x:i.x-c},patternSource:{...r,x:r.x-c},preventDefault:()=>w=!0}),w)return}let d=we(r,Fe.current.signal);typeof d!="object"&&(d=await d());const m=d,u=[];for(let w=0;w<i.width;w++)for(let p=0;p<i.height;p++){const x=[i.x+w,i.y+p];if(vi(x,r))continue;const y=m[p%r.height][w%r.width];Xo(y)||!ao(y)||u.push({location:x,value:{...y}})}Pe(u),(h=fe.current)==null||h.damage(u.map(w=>({cell:w.location})))},[we,Pe,ve,c]),lr=l.useCallback(()=>{if(g.current===void 0||g.current.range.width<=1)return;const e={...g,current:{...g.current,range:{...g.current.range,width:1}}};Wt(e,g)},[Wt,g]),ir=l.useCallback(()=>{if(g.current===void 0||g.current.range.height<=1)return;const e={...g,current:{...g.current,range:{...g.current.range,height:1}}};Wt(e,g)},[Wt,g]),Dl=l.useCallback((e,n)=>{var p,x;const r=M;if(z(void 0),dn(void 0),Cn(void 0),lo.current=!1,n)return;if((r==null?void 0:r.fillHandle)===!0&&g.current!==void 0&&((p=r.previousSelection)==null?void 0:p.current)!==void 0){if(Mt===void 0)return;const y={...g,current:{...g.current,range:wi(r.previousSelection.current.range,Mt)}};Wt(r.previousSelection,y),$e(y,!0);return}const[i,d]=e.location,[m,u]=Tt.current??[],a=()=>{Nt.current=!0},h=y=>{var A,U,G;const N=y.isTouch||m===i&&u===d;if(N&&(xe==null||xe([i-c,d],{...y,preventDefault:a})),y.button===1)return!Nt.current;if(!Nt.current){const E=Le(e.location),L=Me(E);if(L!==void 0&&L.onClick!==void 0&&N){const T=L.onClick({...y,cell:E,posX:y.localEventX,posY:y.localEventY,bounds:y.bounds,theme:no(E,e.location),preventDefault:a});T!==void 0&&!Xo(T)&&uo(T)&&(Pe([{location:y.location,value:T}]),(A=fe.current)==null||A.damage([{cell:y.location}]))}if(Nt.current||g.current===void 0)return!1;let _=!1;switch(E.activationBehaviorOverride??wo){case"double-click":case"second-click":{if(((G=(U=r==null?void 0:r.previousSelection)==null?void 0:U.current)==null?void 0:G.cell)===void 0)break;const[T,J]=g.current.cell,[se,Ee]=r.previousSelection.current.cell;_=i===T&&i===se&&d===J&&d===Ee&&(y.isDoubleClick===!0||wo==="second-click");break}case"single-click":{_=!0;break}}if(_){const J={inputType:"pointer",pointerActivation:y.isDoubleClick===!0?"double-click":E.activationBehaviorOverride??wo,pointerType:y.isTouch?"touch":"mouse"};return oe==null||oe([i-c,d],J),oo(y.bounds,J),!0}}return!1},w=e.location[0]-c;if(e.isTouch){const y=ze.current,N=nr.current;if(y.x!==N.x||y.y!==N.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&Ci((x=g.current)==null?void 0:x.cell,e.location)){We==null||We([w,e.location[1]],{...e,preventDefault:a});return}else if(e.kind==="header"&&g.columns.hasIndex(i)){Oe==null||Oe(w,{...e,preventDefault:a});return}else if(e.kind===Ot){if(w<0)return;H==null||H(w,{...e,preventDefault:a});return}}e.kind==="cell"?h(e)||ro(e):e.kind===Ot?Ie==null||Ie(w,{...e,preventDefault:a}):(e.kind===pi&&(He==null||He(w,{...e,preventDefault:a})),ro(e));return}if(e.kind==="header"){if(w<0)return;e.isEdge?e.isDoubleClick===!0&&Po(i):e.button===0&&i===m&&d===u&&(He==null||He(w,{...e,preventDefault:a}))}if(e.kind===Ot){if(w<0)return;e.button===0&&i===m&&d===u&&(Ie==null||Ie(w,{...e,preventDefault:a}),Nt.current||rr(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&h(e),Tt.current=void 0},[M,g,c,Mt,Wt,$e,xe,Le,Me,wo,no,Pe,oe,oo,We,Oe,H,ro,Ie,He,Po,rr]),Al=l.useCallback(e=>{const n={...e,location:[e.location[0]-c,e.location[1]]};vo==null||vo(n),M!==void 0&&e.buttons===0&&(z(void 0),dn(void 0),Cn(void 0),lo.current=!1),Cn(r=>{var i;return lo.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(r==null?void 0:r[0])&&e.scrollEdge[1]===r[1]?r:M===void 0||(((i=Ke.current)==null?void 0:i.location[0])??0)<c?void 0:e.scrollEdge})},[M,vo,c]),Fl=l.useCallback((e,n)=>{Co==null||Co(e-c,n)},[Co,c]),$l=l.useCallback((e,n)=>{po==null||po(e-c,n)},[po,c]);l.useEffect(()=>{if(C===void 0)return;const e=i=>{const d=[];let m=i.parentElement;for(;m&&m!==document.documentElement;){const u=window.getComputedStyle(m),a=u.overflow+u.overflowY+u.overflowX;(a.includes("scroll")||a.includes("auto"))&&d.push(m),m=m.parentElement}return d},n=i=>{const d=i.target;q.current&&!q.current.contains(d)&&k(void 0)},r=[];if(q.current){const i=e(q.current);r.push(...i)}return r.forEach(i=>{i.addEventListener("scroll",n)}),window.addEventListener("scroll",n),document.addEventListener("scroll",n,!0),()=>{r.forEach(i=>{i.removeEventListener("scroll",n)}),window.removeEventListener("scroll",n),document.removeEventListener("scroll",n,!0)}},[C,k,q]);const _e=(gr=g==null?void 0:g.current)==null?void 0:gr.cell,Gl=l.useCallback((e,n,r,i,d,m)=>{if(Io.current=!1,C!==void 0){const p=ze.current;(p.x!==e.x||p.y!==e.y)&&k(void 0)}let u=_e;u!==void 0&&(u=[u[0]-c,u[1]]);const a=je===0?void 0:{x:0,y:e.y,width:je,height:e.height},h=[];a!==void 0&&h.push(a),et>0&&(h.push({x:e.x-c,y:F-et,width:e.width,height:et}),je>0&&h.push({x:0,y:F-et,width:je,height:et}));const w={x:e.x-c,y:e.y,width:e.width,height:ae&&e.y+e.height>=F?e.height-1:e.height,tx:d,ty:m,extras:{selected:u,freezeRegion:a,freezeRegions:h}};ze.current=w,jn(w),Tl([n,r,i]),xo==null||xo(w,w.tx,w.ty,w.extras)},[_e,C,c,ae,F,je,et,k,jn,xo]),Pl=mt(Se,l.useCallback((e,n)=>(Se==null?void 0:Se(e-c,n-c))!==!1,[Se,c])),Kl=mt(pt,l.useCallback((e,n)=>{pt==null||pt(e-c,n-c),ke!=="none"&&de(j.fromSingleSelection(n),void 0,!0)},[ke,pt,c,de])),pn=l.useRef(!1),Nl=l.useCallback(e=>{if(e.location[0]===0&&c>0){e.preventDefault();return}mo==null||mo({...e,location:[e.location[0]-c,e.location[1]]}),e.defaultPrevented()||(pn.current=!0),z(void 0)},[mo,c]),Wl=l.useCallback(()=>{pn.current=!1},[]),sr=lt==null?void 0:lt.selectionBehavior,Ko=l.useCallback(e=>{if(sr!=="block-spanning")return;const{isGroupHeader:n,path:r,groupRows:i}=St(e);if(n)return[e,e];const d=r[r.length-1],m=e-d,u=e+i-d-1;return[m,u]},[St,sr]),bn=l.useRef(void 0),yn=l.useCallback(e=>{var n,r,i;if(!bi(e,bn.current)&&(bn.current=e,!(((n=Ke==null?void 0:Ke.current)==null?void 0:n.button)!==void 0&&Ke.current.button>=1))){if(e.buttons!==0&&M!==void 0&&((r=Ke.current)==null?void 0:r.location[0])===0&&c===1&&Te==="multi"&&M.previousSelection&&!M.previousSelection.rows.hasIndex(Ke.current.location[1])&&g.rows.hasIndex(Ke.current.location[1])){const d=Math.min(Ke.current.location[1],e.location[1]),m=Math.max(Ke.current.location[1],e.location[1])+1;Re(j.fromSingleSelection([d,m]),void 0,!1)}else if(e.buttons!==0&&M!==void 0&&g.current!==void 0&&!pn.current&&!lo.current&&(Ze==="rect"||Ze==="multi-rect")){const[d,m]=g.current.cell;let[u,a]=e.location;if(a<0&&(a=ze.current.y),M.fillHandle===!0&&((i=M.previousSelection)==null?void 0:i.current)!==void 0){const h=M.previousSelection.current.range;a=Math.min(a,ae?F-1:F);const w=yi(h,u,a,An);dn(w)}else{if(ae&&m===F)return;if(ae&&a===F)if(e.kind===Cr)a--;else return;u=Math.max(u,c);const p=Ko(m);a=p===void 0?a:Lt(a,p[0],p[1]);const x=u-d,y=a-m,N={x:x>=0?d:u,y:y>=0?m:a,width:Math.abs(x)+1,height:Math.abs(y)+1};Ce({...g.current,range:N},!0,!1,"drag")}}yo==null||yo({...e,location:[e.location[0]-c,e.location[1]]})}},[M,c,Te,g,Ze,yo,Re,ae,F,An,Ko,Ce]),Ol=l.useCallback(()=>{var u,a;const e=bn.current;if(e===void 0)return;const[n,r]=e.scrollEdge;let[i,d]=e.location;const m=ze.current;n===-1?i=((a=(u=m.extras)==null?void 0:u.freezeRegion)==null?void 0:a.x)??m.x:n===1&&(i=m.x+m.width),r===-1?d=Math.max(0,m.y):r===1&&(d=Math.min(F-1,m.y+m.height)),i=Lt(i,0,O.length-1),d=Lt(d,0,F-1),yn({...e,location:[i,d]})},[O.length,yn,F]);Ds(Il,q,Ol);const Be=l.useCallback(e=>{if(g.current===void 0)return;const[n,r]=e,[i,d]=g.current.cell,m=g.current.range;let u=m.x,a=m.x+m.width,h=m.y,w=m.y+m.height;const[p,x]=Ko(d)??[0,F-1],y=x+1;if(r!==0)switch(r){case 2:{w=y,h=d,ie(0,w,"vertical");break}case-2:{h=p,w=d+1,ie(0,h,"vertical");break}case 1:{h<d?(h++,ie(0,h,"vertical")):(w=Math.min(y,w+1),ie(0,w,"vertical"));break}case-1:{w>d+1?(w--,ie(0,w,"vertical")):(h=Math.max(p,h-1),ie(0,h,"vertical"));break}default:pr()}if(n!==0)if(n===2)a=O.length,u=i,ie(a-1-c,0,"horizontal");else if(n===-2)u=c,a=i+1,ie(u-c,0,"horizontal");else{let N=[];if(we!==void 0){const A=we({x:u,y:h,width:a-u-c,height:w-h},Fe.current.signal);typeof A=="object"&&(N=Us(A))}if(n===1){let A=!1;if(u<i){if(N.length>0){const U=Ut(u+1,i+1).find(G=>!N.includes(G-c));U!==void 0&&(u=U,A=!0)}else u++,A=!0;A&&ie(u,0,"horizontal")}A||(a=Math.min(O.length,a+1),ie(a-1-c,0,"horizontal"))}else if(n===-1){let A=!1;if(a>i+1){if(N.length>0){const U=Ut(a-1,i,-1).find(G=>!N.includes(G-c));U!==void 0&&(a=U,A=!0)}else a--,A=!0;A&&ie(a-c,0,"horizontal")}A||(u=Math.max(c,u-1),ie(u-c,0,"horizontal"))}else pr()}Ce({cell:g.current.cell,range:{x:u,y:h,width:a-u,height:w-h}},!0,!1,"keyboard-select")},[we,Ko,g,O.length,c,F,ie,Ce]),xn=l.useRef(Gn);xn.current=Gn;const ft=l.useCallback((e,n,r,i)=>{const d=he-(r?0:1);e=Lt(e,c,Ge.length-1+c),n=Lt(n,0,d);const m=_e==null?void 0:_e[0],u=_e==null?void 0:_e[1];if(e===m&&n===u)return!1;if(i&&g.current!==void 0){const a=[...g.current.rangeStack];(g.current.range.width>1||g.current.range.height>1)&&a.push(g.current.range),$e({...g,current:{cell:[e,n],range:{x:e,y:n,width:1,height:1},rangeStack:a}},!0)}else Ce({cell:[e,n],range:{x:e,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return v.current!==void 0&&v.current[0]===e&&v.current[1]===n&&(v.current=void 0),xn.current&&ie(e-c,n,"both",0,20),!0},[he,c,Ge.length,_e,g,ie,$e,Ce]),Ul=l.useCallback((e,n)=>{(C==null?void 0:C.cell)!==void 0&&e!==void 0&&uo(e)&&(Pe([{location:C.cell,value:e}]),window.requestAnimationFrame(()=>{var d;(d=fe.current)==null||d.damage([{cell:C.cell}])})),ye(!0),k(void 0);const[r,i]=n;if(g.current!==void 0&&(r!==0||i!==0)){const d=g.current.cell[1]===he-1;if(d&&i===1){Z==null||Z(e,[0,0]);return}const m=g.current.cell[0]===O.length-1&&e!==void 0;let u=!0;if(d&&i===1&&qe!==void 0){u=!1;const a=g.current.cell[0]+r,h=Pt(a);ut(h??a,!1)}if(m&&r===1&&nt!==void 0){u=!1;const a=g.current.cell[1]+i;Go(a,!1)}if(u){let a=g.current.cell[0]+r,h=g.current.cell[1]+i,w=!1;It&&r===1&&i===0?a>=O.length?h>=he-1?(a=g.current.cell[0],h=g.current.cell[1],w=!1):(a=c,h+=1,w=!0):w=!0:(a=Lt(a,c,O.length-1),h=Lt(h,0,he-1),w=It===!0&&r===0&&i===1),ft(a,h,d,!1),w&&window.setTimeout(()=>{var x;const p=V([a-c,h]);if(ao(p)){const y=(x=fe.current)==null?void 0:x.getBounds(a,h);if(y&&p.allowOverlay){const N={inputType:"keyboard",key:"Enter"};oe==null||oe([a-c,h],N),Gt({target:y,content:p,initialValue:void 0,cell:[a,h],highlight:!0,forceEditMode:!0,activation:N})}}},50)}}Z==null||Z(e,n)},[C==null?void 0:C.cell,ye,g,Z,Pe,he,ft,O.length,ut,Go,qe,nt,Pt,V,c,oe,Gt,It]),Vl=l.useMemo(()=>`gdg-overlay-${Os++}`,[]),Et=l.useCallback(e=>{var r,i,d,m;ye();const n=[];for(let u=e.x;u<e.x+e.width;u++)for(let a=e.y;a<e.y+e.height;a++){const h=V([u-c,a]);if(!h.allowOverlay&&h.kind!==ne.Boolean)continue;let w;if(h.kind===ne.Custom){const p=Me(h),x=(r=p==null?void 0:p.provideEditor)==null?void 0:r.call(p,{...h,location:[u-c,a]});(p==null?void 0:p.onDelete)!==void 0?w=p.onDelete(h):xi(x)&&(w=(i=x==null?void 0:x.deletedValue)==null?void 0:i.call(x,h))}else if(uo(h)&&h.allowOverlay||h.kind===ne.Boolean){const p=Me(h);w=(d=p==null?void 0:p.onDelete)==null?void 0:d.call(p,h)}w!==void 0&&!Xo(w)&&uo(w)&&n.push({location:[u,a],value:w})}Pe(n),(m=fe.current)==null||m.damage(n.map(u=>({cell:u.location})))},[ye,V,Me,Pe,c]),io=C!==void 0,cr=l.useCallback(e=>{var E,L,_;const n=()=>{e.stopPropagation(),e.preventDefault()},r={didMatch:!1},{bounds:i}=e,d=g.columns,m=g.rows,u=ct;if(!io&&P(u.clear,e,r)){const T=((E=g.current)==null?void 0:E.cell)??[c,0];$e({columns:j.empty(),rows:j.empty(),current:{cell:T,range:{x:T[0],y:T[1],width:1,height:1},rangeStack:[]}},!1),it==null||it(),ye()}else if(!io&&P(u.selectAll,e,r))$e({columns:j.empty(),rows:j.empty(),current:{cell:((L=g.current)==null?void 0:L.cell)??[c,0],range:{x:c,y:0,width:X.length,height:F},rangeStack:[]}},!1);else if(P(u.search,e,r))(_=I==null?void 0:I.current)==null||_.focus({preventScroll:!0}),Xn(!0);else if(P(u.delete,e,r)){const T=(at==null?void 0:at(g))??!0;if(T!==!1){const J=T===!0?g:T;if(J.current!==void 0){Et(J.current.range);for(const se of J.current.rangeStack)Et(se)}for(const se of J.rows)Et({x:c,y:se,width:X.length,height:1});for(const se of J.columns)Et({x:se,y:0,width:1,height:F})}}if(r.didMatch)return n(),!0;if(g.current===void 0)return!1;let[a,h]=g.current.cell;const[,w]=g.current.cell;let p=!1,x=!1;if(P(u.scrollToSelectedCell,e,r))Oo.current(a-c,h);else if(ke!=="none"&&P(u.selectColumn,e,r))d.hasIndex(a)?de(d.remove(a),void 0,!0):ke==="single"?de(j.fromSingleSelection(a),void 0,!0):de(void 0,a,!0);else if(Te!=="none"&&P(u.selectRow,e,r))m.hasIndex(h)?Re(m.remove(h),void 0,!0):Te==="single"?Re(j.fromSingleSelection(h),void 0,!0):Re(void 0,h,!0);else if(!io&&i!==void 0&&P(u.activateCell,e,r))if(h===F&&ae)window.setTimeout(()=>{const T=Pt(a);ut(T??a)},0);else{const T={inputType:"keyboard",key:e.key};oe==null||oe([a-c,h],T),oo(i,T)}else if(g.current.range.height>1&&P(u.downFill,e,r))ir();else if(g.current.range.width>1&&P(u.rightFill,e,r))lr();else if(P(u.goToNextPage,e,r))h+=Math.max(1,ze.current.height-4);else if(P(u.goToPreviousPage,e,r))h-=Math.max(1,ze.current.height-4);else if(P(u.goToFirstCell,e,r))k(void 0),h=0,a=0;else if(P(u.goToLastCell,e,r))k(void 0),h=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER;else if(P(u.selectToFirstCell,e,r))k(void 0),Be([-2,-2]);else if(P(u.selectToLastCell,e,r))k(void 0),Be([2,2]);else if(io)P(u.closeOverlay,e,r)&&k(void 0),P(u.acceptOverlayDown,e,r)&&(k(void 0),h++),P(u.acceptOverlayUp,e,r)&&(k(void 0),h--),P(u.acceptOverlayLeft,e,r)&&(k(void 0),a--),P(u.acceptOverlayRight,e,r)&&(k(void 0),a++);else{if(P(u.goDownCell,e,r))h+=1;else if(P(u.goUpCell,e,r))h-=1;else if(P(u.goRightCell,e,r)){const T=e.key==="Tab"&&!e.shiftKey;if(It===!0&&T){const J=O.length-1;a>=J?h<he-1&&(a=c,h+=1):a+=1}else a+=1}else P(u.goLeftCell,e,r)?a-=1:P(u.goDownCellRetainSelection,e,r)?(h+=1,p=!0):P(u.goUpCellRetainSelection,e,r)?(h-=1,p=!0):P(u.goRightCellRetainSelection,e,r)?(a+=1,p=!0):P(u.goLeftCellRetainSelection,e,r)?(a-=1,p=!0):P(u.goToLastRow,e,r)?h=F-1:P(u.goToFirstRow,e,r)?h=Number.MIN_SAFE_INTEGER:P(u.goToLastColumn,e,r)?a=Number.MAX_SAFE_INTEGER:P(u.goToFirstColumn,e,r)?a=Number.MIN_SAFE_INTEGER:(Ze==="rect"||Ze==="multi-rect")&&(P(u.selectGrowDown,e,r)?Be([0,1]):P(u.selectGrowUp,e,r)?Be([0,-1]):P(u.selectGrowRight,e,r)?Be([1,0]):P(u.selectGrowLeft,e,r)?Be([-1,0]):P(u.selectToLastRow,e,r)?Be([0,2]):P(u.selectToFirstRow,e,r)?Be([0,-2]):P(u.selectToLastColumn,e,r)?Be([2,0]):P(u.selectToFirstColumn,e,r)&&Be([-2,0]));x=r.didMatch}if(Ve!==void 0&&Ve!=="normal"&&h!==w){const T=Ve==="skip-up"||Ve==="skip"||Ve==="block",J=Ve==="skip-down"||Ve==="skip"||Ve==="block",se=h<w;if(se&&T){for(;h>=0&&St(h).isGroupHeader;)h--;h<0&&(h=w)}else if(!se&&J){for(;h<F&&St(h).isGroupHeader;)h++;h>=F&&(h=w)}}const N=ft(a,h,!1,p),A=r.didMatch,U=e.key==="Tab";return A&&(N||!x||Fn||It===!0&&U)&&n(),A},[Ve,io,g,ct,ke,Te,Ze,c,St,F,ft,$e,it,X.length,at,Fn,Et,de,Re,ae,Pt,ut,oe,oo,ir,lr,Be,It,O.length,he]),so=l.useCallback(e=>{let n=!1;Bt!==void 0&&Bt({...e,...e.location&&{location:[e.location[0]-c,e.location[1]]},cancel:()=>{n=!0}}),!n&&(cr(e)||g.current)},[Qo,Bt,cr,g,V,c,F,ae,oe,oo]),Bl=l.useCallback((e,n)=>{const r=e.location[0]-c;if(e.kind==="header"&&(Oe==null||Oe(r,{...e,preventDefault:n})),e.kind===Ot){if(r<0)return;H==null||H(r,{...e,preventDefault:n})}if(e.kind==="cell"){const[i,d]=e.location;We==null||We([r,d],{...e,preventDefault:n}),ki(g,e.location)||ft(i,d,!1,!1)}},[g,We,H,Oe,c,ft]),kn=l.useCallback(async e=>{var u,a,h;if(!ct.paste)return;function n(w,p,x,y){var A,U;const N=typeof x=="object"?(x==null?void 0:x.join(`
`))??"":(x==null?void 0:x.toString())??"";if(!Xo(w)&&ao(w)&&w.readonly!==!0){const G=re==null?void 0:re(N,w);if(G!==void 0&&uo(G))return{location:p,value:G};const E=Me(w);if(E===void 0)return;if(E.kind===ne.Custom){Yo(w.kind===ne.Custom);const L=(A=E.onPaste)==null?void 0:A.call(E,N,w.data);return L===void 0?void 0:{location:p,value:{...w,data:L}}}else{const L=(U=E.onPaste)==null?void 0:U.call(E,N,w,{formatted:y,formattedString:typeof y=="string"?y:y==null?void 0:y.join(`
`),rawValue:x});return L===void 0?void 0:(Yo(L.kind===w.kind),{location:p,value:L})}}}const r=g.columns,i=g.rows,d=((u=q.current)==null?void 0:u.contains(document.activeElement))===!0||((a=b.current)==null?void 0:a.contains(document.activeElement))===!0;let m;if(g.current!==void 0?m=[g.current.range.x,g.current.range.y]:r.length===1?m=[r.first()??0,0]:i.length===1&&(m=[c,i.first()??0]),d&&m!==void 0){let w,p;const x="text/plain",y="text/html";if(navigator.clipboard.read!==void 0){const G=await navigator.clipboard.read();for(const E of G){if(E.types.includes(y)){const _=await(await E.getType(y)).text(),T=br(_);if(T!==void 0){w=T;break}}E.types.includes(x)&&(p=await(await E.getType(x)).text())}}else if(navigator.clipboard.readText!==void 0)p=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(y)){const G=e.clipboardData.getData(y);w=br(G)}w===void 0&&e.clipboardData.types.includes(x)&&(p=e.clipboardData.getData(x))}else return;const[N,A]=m,U=[];do{if(yt===void 0){const G=Le(m),E=p??(w==null?void 0:w.map(_=>_.map(T=>T.rawValue).join("	")).join("	"))??"",L=n(G,m,E,void 0);L!==void 0&&U.push(L);break}if(w===void 0){if(p===void 0)return;w=Ri(p)}if(yt===!1||typeof yt=="function"&&(yt==null?void 0:yt([m[0]-c,m[1]],w.map(G=>G.map(E=>{var L;return((L=E.rawValue)==null?void 0:L.toString())??""}))))!==!0)return;for(const[G,E]of w.entries()){if(G+A>=F)break;for(const[L,_]of E.entries()){const T=[L+N,G+A],[J,se]=T;if(J>=O.length||se>=he)continue;const Ee=Le(T),Ne=n(Ee,T,_.rawValue,_.formatted);Ne!==void 0&&U.push(Ne)}}}while(!1);Pe(U),(h=fe.current)==null||h.damage(U.map(G=>({cell:G.location})))}},[re,Me,Le,g,ct.paste,q,O.length,Pe,he,yt,c,F]);Tn("paste",kn,R,!1,!0);const co=l.useCallback(async(e,n)=>{var u,a;if(!ct.copy)return;const r=n===!0||((u=q.current)==null?void 0:u.contains(document.activeElement))===!0||((a=b.current)==null?void 0:a.contains(document.activeElement))===!0,i=g.columns,d=g.rows,m=(h,w)=>{if(!Dn)yr(h,w,e);else{const p=w.map(x=>({kind:ne.Text,data:X[x].title,displayData:X[x].title,allowOverlay:!1}));yr([p,...h],w,e)}};if(r&&we!==void 0){if(g.current!==void 0){let h=we(g.current.range,Fe.current.signal);typeof h!="object"&&(h=await h()),m(h,Ut(g.current.range.x-c,g.current.range.x+g.current.range.width-c))}else if(d!==void 0&&d.length>0){const w=[...d].map(p=>{const x=we({x:c,y:p,width:X.length,height:1},Fe.current.signal);return typeof x=="object"?x[0]:x().then(y=>y[0])});if(w.some(p=>p instanceof Promise)){const p=await Promise.all(w);m(p,Ut(X.length))}else m(w,Ut(X.length))}else if(i.length>0){const h=[],w=[];for(const p of i){let x=we({x:p,y:0,width:1,height:F},Fe.current.signal);typeof x!="object"&&(x=await x()),h.push(x),w.push(p-c)}if(h.length===1)m(h[0],w);else{const p=h.reduce((x,y)=>x.map((N,A)=>[...N,...y[A]]));m(p,w)}}}},[X,we,g,ct.copy,c,q,F,Dn]);Tn("copy",co,R,!1,!1);const Xl=l.useCallback(async e=>{var r,i;if(!(!ct.cut||!(((r=q.current)==null?void 0:r.contains(document.activeElement))===!0||((i=b.current)==null?void 0:i.contains(document.activeElement))===!0))&&(await co(e),g.current!==void 0)){let d={current:{cell:g.current.cell,range:g.current.range,rangeStack:[]},rows:j.empty(),columns:j.empty()};const m=at==null?void 0:at(d);if(m===!1||(d=m===!0?d:m,d.current===void 0))return;Et(d.current.range)}},[Et,g,ct.cut,co,q,at]);Tn("cut",Xl,R,!1,!1);const _l=l.useCallback((e,n)=>{if(Ue!==void 0){c!==0&&(e=e.map(d=>[d[0]-c,d[1]])),Ue(e,n);return}if(e.length===0||n===-1)return;const[r,i]=e[n];v.current!==void 0&&v.current[0]===r&&v.current[1]===i||(v.current=[r,i],ft(r,i,!1,!1))},[Ue,c,ft]),[No,Wo]=((mr=xt==null?void 0:xt.current)==null?void 0:mr.cell)??[],Oo=l.useRef(ie);Oo.current=ie,l.useLayoutEffect(()=>{var e,n,r,i;xn.current&&!Io.current&&No!==void 0&&Wo!==void 0&&(No!==((n=(e=Ho.current)==null?void 0:e.current)==null?void 0:n.cell[0])||Wo!==((i=(r=Ho.current)==null?void 0:r.current)==null?void 0:i.cell[1]))&&Oo.current(No,Wo),Io.current=!1},[No,Wo]);const ar=g.current!==void 0&&(g.current.cell[0]>=O.length||g.current.cell[1]>=he);l.useLayoutEffect(()=>{ar&&$e(En,!1)},[ar,$e]);const Yl=l.useMemo(()=>ae===!0&&(Y==null?void 0:Y.tint)===!0?j.fromSingleSelection(he-1):j.empty(),[he,ae,Y==null?void 0:Y.tint]),ql=l.useCallback(e=>typeof Ht=="boolean"?Ht:(Ht==null?void 0:Ht(e-c))??!0,[c,Ht]),Zl=l.useMemo(()=>{if(vn===void 0||b.current===null)return null;const{bounds:e,group:n}=vn,r=b.current.getBoundingClientRect();return l.createElement(ys,{bounds:e,group:n,canvasBounds:r,onClose:()=>wn(void 0),onFinish:i=>{wn(void 0),ce==null||ce(n,i)}})},[ce,vn]),Jl=Math.min(O.length,je+c);l.useImperativeHandle(o,()=>({appendRow:(e,n)=>ut(e+c,n),appendColumn:(e,n)=>Go(e,n),updateCells:e=>{var n;return c!==0&&(e=e.map(r=>({cell:[r.cell[0]+c,r.cell[1]]}))),(n=fe.current)==null?void 0:n.damage(e)},getBounds:(e,n)=>{var r;if(!((b==null?void 0:b.current)===null||(q==null?void 0:q.current)===null)){if(e===void 0&&n===void 0){const i=b.current.getBoundingClientRect(),d=i.width/q.current.clientWidth;return{x:i.x-q.current.scrollLeft*d,y:i.y-q.current.scrollTop*d,width:q.current.scrollWidth*d,height:q.current.scrollHeight*d}}return(r=fe.current)==null?void 0:r.getBounds((e??0)+c,n)}},focus:()=>{var e;return(e=fe.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":so({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":so({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":so({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await co(void 0,!0);break;case"paste":await kn();break}},scrollTo:ie,remeasureColumns:e=>{for(const n of e)Po(n+c)},getMouseArgsForPosition:(e,n,r)=>{if((fe==null?void 0:fe.current)===null)return;const i=fe.current.getMouseArgsForPosition(e,n,r);if(i!==void 0)return{...i,location:[i.location[0]-c,i.location[1]]}}}),[ut,Go,Po,q,co,so,kn,c,ie]);const[ur,dr]=_e??[],Ql=l.useCallback(e=>{const[n,r]=e;if(r===-1){ke!=="none"&&(de(j.fromSingleSelection(n),void 0,!1),ye());return}ur===n&&dr===r||(Ce({cell:e,range:{x:n,y:r,width:1,height:1}},!0,!1,"keyboard-nav"),ie(n,r))},[ke,ye,ie,ur,dr,Ce,de]),[jl,ei]=l.useState(!1),fr=l.useRef(Ii(e=>{ei(e)},5)),ti=l.useCallback(()=>{fr.current(!0),g.current===void 0&&g.columns.length===0&&g.rows.length===0&&M===void 0&&Ce({cell:[c,Do],range:{x:c,y:Do,width:1,height:1}},!0,!1,"keyboard-select")},[Do,g,M,c,Ce]),oi=l.useCallback(()=>{fr.current(!1)},[]),[ni,ri]=l.useMemo(()=>{let e;const n=(ue==null?void 0:ue.scrollbarWidthOverride)??Mi(),r=F+(ae?1:0);if(typeof st=="number")e=to+r*st;else{let d=0;const m=Math.min(r,10);for(let u=0;u<m;u++)d+=st(u);d=Math.floor(d/m),e=to+r*d}e+=n;const i=O.reduce((d,m)=>m.width+d,0)+n;return[`${Math.min(1e5,i)}px`,`${Math.min(1e5,e)}px`]},[O,ue==null?void 0:ue.scrollbarWidthOverride,st,F,ae,to]),li=l.useMemo(()=>Si(be),[be]);return l.createElement(Ti.Provider,{value:be},l.createElement(Ls,{style:li,className:Vt,inWidth:Q??ni,inHeight:pe??ri},l.createElement(ws,{fillHandle:Wr,drawFocusRing:Kn,experimental:ue,fixedShadowX:Or,fixedShadowY:Ur,getRowThemeOverride:ot,headerIcons:Vr,imageWindowLoader:Br,initialSize:Xr,isDraggable:_r,onDragLeave:Yr,onRowMoved:Zt,overscrollX:vl,overscrollY:wl,preventDiagonalScrolling:Jr,rightElement:Qr,rightElementProps:jr,smoothScrollX:el,smoothScrollY:tl,className:Vt,enableGroups:qn,onCanvasFocused:ti,onCanvasBlur:oi,canvasRef:b,onContextMenu:Bl,theme:be,cellXOffset:zl,cellYOffset:Do,accessibilityHeight:Rt.height,onDragEnd:Wl,columns:O,nonGrowWidth:Yn,drawHeader:Ml,onColumnProposeMove:Pl,drawCell:Sl,disabledRows:Yl,freezeColumns:Jl,lockColumns:c,firstColAccessible:c===0,getCellContent:Le,minColumnWidth:At,maxColumnWidth:Lo,searchInputRef:I,showSearch:pl,onSearchClose:bl,highlightRegions:Ll,getCellsForSelection:we,getGroupDetails:fn,headerHeight:Vn,isFocused:jl,groupHeaderHeight:qn?an:0,groupLevels:eo,groupHeaderHeights:Zn,freezeTrailingRows:et+(ae&&(Y==null?void 0:Y.sticky)===!0?1:0),hasAppendRow:ae,onColumnResize:Ft,onColumnResizeEnd:kl,onColumnResizeStart:Rl,onCellFocused:Ql,onColumnMoved:Kl,onDragStart:Nl,onHeaderMenuClick:Fl,onHeaderIndicatorClick:$l,onItemHovered:yn,isFilling:(M==null?void 0:M.fillHandle)===!0,onMouseMove:Al,onKeyDown:so,onKeyUp:Ct,onMouseDown:Hl,onMouseUp:Dl,onDragOverCell:Kr,onDrop:Nr,onSearchResultsChanged:_l,onVisibleRegionChanged:Gl,clientSize:un,rowHeight:st,searchResults:wt,searchValue:Jo,onSearchValueChange:ho,rows:he,scrollRef:q,selection:g,translateX:Rt.tx,translateY:Rt.ty,verticalBorder:ql,gridRef:fe,getCellRenderer:Me,resizeIndicator:sl}),Zl,C!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(Ws,{...C,validateCell:xl,bloom:Ye,id:Vl,getCellRenderer:Me,className:(ue==null?void 0:ue.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:$r,imageEditorOverride:S,portalElementRef:cl,onFinishEditing:Ul,markdownDivCreateNode:B,isOutsideClick:il,customEventTarget:ue==null?void 0:ue.eventTarget}))))},Bs=l.forwardRef(Vs),Xs=(t,o)=>{const s=l.useMemo(()=>({...ds,...t.headerIcons}),[t.headerIcons]),f=l.useMemo(()=>t.renderers??Li,[t.renderers]),C=l.useMemo(()=>t.imageWindowLoader??new Hi,[t.imageWindowLoader]);return l.createElement(Bs,{...t,renderers:f,headerIcons:s,ref:o,imageWindowLoader:C})},oc=l.forwardRef(Xs);export{Cs as C,oc as D,ht as k,Ps as u};
