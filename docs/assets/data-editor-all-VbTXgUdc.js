const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./image-window-loader-DtBhR23y.js","./iframe-CB3jNLId.js","./preload-helper-C1FmrZbK.js","./marked.esm-By-yLKzP.js","./marked-FY3qVesh.css","./index-B84JjiES.js","./image-window-loader-Bm61kU6i.css"])))=>i.map(i=>d[i]);
import{g as fn,r as c,R as je}from"./iframe-CB3jNLId.js";import{_ as Ci}from"./preload-helper-C1FmrZbK.js";import{r as yi}from"./index-B84JjiES.js";import{_ as mr,d as bi,e as xi,f as Ri,h as Si,j as Mi,k as ki,l as Ii,G as Z,n as ko,o as Ti,p as So,r as lr,q as To,s as Ht,C as Se,t as pr,b as ln,v as ir,w as Ei,x as Ut,y as Io,i as jt,z as sr,g as wr,B as zi,D as Rt,E as Di,F as Bt,H as Li,I as Hi,J as Fi,K as $i,L as Gi,M as Ki,N as sn,O as cr,P as Pi,Q as Ni,R as Wi,T as Ai,S as Oi,U as Vi,V as Bi,W as Ui,X as ar,Y as Dt,Z as Lt,$ as _i,a0 as Xi,a1 as Yi,a2 as qi,a3 as ur,A as Zi,a4 as Ji}from"./image-window-loader-DtBhR23y.js";import{G as ji}from"./scrolling-data-grid-xxMWlw8S.js";import{s as Eo}from"./marked.esm-By-yLKzP.js";function Qi(e,o,r,i){for(var u=e.length,g=r+(i?1:-1);i?g--:++g<u;)if(o(e[g],g,e))return g;return-1}var es=Qi;function ts(e){return e!==e}var os=ts;function ns(e,o,r){for(var i=r-1,u=e.length;++i<u;)if(e[i]===o)return i;return-1}var rs=ns,ls=es,is=os,ss=rs;function cs(e,o,r){return o===o?ss(e,o,r):ls(e,is,r)}var as=cs,us=as;function ds(e,o){var r=e==null?0:e.length;return!!r&&us(e,o,0)>-1}var fs=ds;function hs(e,o,r){for(var i=-1,u=e==null?0:e.length;++i<u;)if(r(o,e[i]))return!0;return!1}var gs=hs;function vs(){}var Cr=vs;const pa=fn(Cr);var cn=bi,ms=Cr,ps=mr,ws=1/0,Cs=cn&&1/ps(new cn([,-0]))[1]==ws?function(e){return new cn(e)}:ms,ys=Cs,bs=xi,xs=fs,Rs=gs,Ss=Ri,Ms=ys,ks=mr,Is=200;function Ts(e,o,r){var i=-1,u=xs,g=e.length,k=!0,f=[],m=f;if(r)k=!1,u=Rs;else if(g>=Is){var M=o?null:Ms(e);if(M)return ks(M);k=!1,u=Ss,m=new bs}else m=o?[]:f;e:for(;++i<g;){var s=e[i],d=o?o(s):s;if(s=r||s!==0?s:0,k&&d===d){for(var p=m.length;p--;)if(m[p]===d)continue e;o&&m.push(d),f.push(s)}else u(m,d,r)||(m!==f&&m.push(d),f.push(s))}return f}var Es=Ts,zs=Es;function Ds(e){return e&&e.length?zs(e):[]}var Ls=Ds;const Hs=fn(Ls);var dr=Si,Fs=ki,$s=Mi,fr=dr?dr.isConcatSpreadable:void 0;function Gs(e){return $s(e)||Fs(e)||!!(fr&&e&&e[fr])}var Ks=Gs,Ps=Ii,Ns=Ks;function yr(e,o,r,i,u){var g=-1,k=e.length;for(r||(r=Ns),u||(u=[]);++g<k;){var f=e[g];o>0&&r(f)?o>1?yr(f,o-1,r,i,u):Ps(u,f):i||(u[u.length]=f)}return u}var Ws=yr,As=Ws;function Os(e){var o=e==null?0:e.length;return o?As(e,1):[]}var Vs=Os;const hr=fn(Vs),ze='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Bs=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}<rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},Us=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}<rect x="2" y="2" width="16" height="16" rx="4" fill="${r}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},_s=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},Xs=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},Ys=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${r}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},br=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},qs=e=>{const o=e.bgColor;return`${ze}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Zs=br,Js=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},js=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},Qs=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},ec=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${r}"/>
  </svg>`},tc=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},oc=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},nc=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},rc=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},lc=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${r}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${r}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},ic=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${r}"/>
</svg>`},sc=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},cc=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},ac=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},uc=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},dc=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},fc=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},hc=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},gc=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},vc=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},mc=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},pc=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},wc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),Cc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),yc={headerRowID:Bs,headerNumber:_s,headerCode:Us,headerString:Xs,headerBoolean:Ys,headerAudioUri:Zs,headerVideoUri:Js,headerEmoji:js,headerImage:Qs,headerUri:br,headerPhone:ec,headerMarkdown:tc,headerDate:oc,headerTime:nc,headerEmail:rc,headerReference:lc,headerIfThenElse:ic,headerSingleValue:sc,headerLookup:cc,headerTextTemplate:ac,headerMath:uc,headerRollup:dc,headerJoinStrings:fc,headerSplitString:hc,headerGeoDistance:gc,headerArray:vc,rowOwnerOverlay:mc,protectedColumnOverlay:pc,renameIcon:qs,headerArrowDown:wc,headerArrowUp:Cc},bc=Eo("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),xc=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Rc=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Sc=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Mc=10,kc=e=>{const{canvasRef:o,cellYOffset:r,rows:i,columns:u,searchInputRef:g,searchValue:k,searchResults:f,onSearchValueChange:m,getCellsForSelection:M,onSearchResultsChanged:s,showSearch:d=!1,onSearchClose:p}=e,[I]=c.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[P,H]=c.useState(""),se=k??P,Me=c.useCallback(x=>{H(x),m==null||m(x)},[m]),[_,z]=c.useState(),ne=c.useRef(_);ne.current=_,c.useEffect(()=>{f!==void 0&&(f.length>0?z(x=>({rowsSearched:i,results:f.length,selectedIndex:(x==null?void 0:x.selectedIndex)??-1})):z(void 0))},[i,f]);const S=c.useRef();S.current===void 0&&(S.current=new AbortController);const O=c.useRef(),[F,V]=c.useState([]),oe=f??F,$=c.useCallback(()=>{O.current!==void 0&&(window.cancelAnimationFrame(O.current),O.current=void 0),S.current!==void 0&&S.current.abort(),S.current=new AbortController},[]),le=c.useRef(r);le.current=r;const B=c.useCallback(x=>{const Y=new RegExp(x.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let Re=le.current,De=Math.min(10,i),Ge=0;z(void 0),V([]);const be=[],v=async()=>{var Ze;if(M===void 0)return;const fe=performance.now(),E=i-Ge;let me=M({x:0,y:Re,width:u.length,height:Math.min(De,E,i-Re)},S.current.signal);typeof me=="function"&&(me=await me());let Le=!1;for(const[St,_t]of me.entries())for(const[C,we]of _t.entries()){let W;switch(we.kind){case Z.Text:case Z.Number:W=we.displayData;break;case Z.Uri:case Z.Markdown:W=we.data;break;case Z.Boolean:W=typeof we.data=="boolean"?we.data.toString():void 0;break;case Z.Image:case Z.Bubble:W=we.data.join("üê≥");break;case Z.Custom:W=we.copyData;break}W!==void 0&&Y.test(W)&&(be.push([C,St+Re]),Le=!0)}const Ue=performance.now();Le&&V([...be]),Ge+=me.length,ko(Ge<=i);const N=((Ze=ne.current)==null?void 0:Ze.selectedIndex)??-1;z({results:be.length,rowsSearched:Ge,selectedIndex:N}),s==null||s(be,N),Re+De>=i?Re=0:Re+=De;const re=Ue-fe,q=Math.max(re,1),ct=Mc/q;De=Math.ceil(De*ct),Ge<i&&be.length<1e3&&(O.current=window.requestAnimationFrame(v))};$(),O.current=window.requestAnimationFrame(v)},[$,u.length,M,s,i]),ce=c.useCallback(()=>{var x;p==null||p(),z(void 0),V([]),s==null||s([],-1),$(),(x=o==null?void 0:o.current)==null||x.focus()},[$,o,p,s]),G=c.useCallback(x=>{Me(x.target.value),f===void 0&&(x.target.value===""?(z(void 0),V([]),$()):B(x.target.value))},[B,$,Me,f]);c.useEffect(()=>{g.current!==null&&(Me(""),z(void 0),F.length>0&&(V([]),s==null||s([],-1)),d?g.current.focus({preventScroll:!0}):$())},[d,g]);const T=c.useCallback(x=>{var Re;if((Re=x==null?void 0:x.stopPropagation)==null||Re.call(x),_===void 0||_.results===0)return;const Y=(_.selectedIndex+1)%_.results;z({..._,selectedIndex:Y}),s==null||s(oe,Y)},[_,s,oe]),Ke=c.useCallback(x=>{var Re;if((Re=x==null?void 0:x.stopPropagation)==null||Re.call(x),_===void 0||_.results===0)return;let Y=(_.selectedIndex-1)%_.results;Y<0&&(Y+=_.results),z({..._,selectedIndex:Y}),s==null||s(oe,Y)},[s,oe,_]),ye=c.useCallback(x=>{(x.ctrlKey||x.metaKey)&&x.nativeEvent.code==="KeyF"||x.key==="Escape"?(ce(),x.stopPropagation(),x.preventDefault()):x.key==="Enter"&&(x.shiftKey?Ke():T())},[ce,T,Ke]);c.useEffect(()=>()=>{$()},[$]);const[ve,A]=c.useState(!1);c.useEffect(()=>{if(d)A(!0);else{const x=setTimeout(()=>A(!1),150);return()=>clearTimeout(x)}},[d]);const ie=c.useMemo(()=>{if(!d&&!ve)return null;let x;_!==void 0&&(x=_.results>=1e3?"over 1000":`${_.results} result${_.results!==1?"s":""}`,_.selectedIndex>=0&&(x=`${_.selectedIndex+1} of ${x}`));const Y=Ge=>{Ge.stopPropagation()},De={width:`${i>0?Math.floor(((_==null?void 0:_.rowsSearched)??0)/i*100):0}%`};return c.createElement(bc,{className:"gdg-search-bar"+(d?"":" out"),onMouseDown:Y,onMouseMove:Y,onMouseUp:Y,onClick:Y},c.createElement("div",{className:"gdg-search-bar-inner"},c.createElement("input",{id:I,"aria-hidden":!d,"data-testid":"search-input",ref:g,onChange:G,value:se,tabIndex:d?void 0:-1,onKeyDownCapture:ye}),c.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!d,tabIndex:d?void 0:-1,onClick:Ke,disabled:((_==null?void 0:_.results)??0)===0},xc),c.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!d,tabIndex:d?void 0:-1,onClick:T,disabled:((_==null?void 0:_.results)??0)===0},Rc),p!==void 0&&c.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!d,"data-testid":"search-close-button",tabIndex:d?void 0:-1,onClick:ce},Sc)),_!==void 0?c.createElement(c.Fragment,null,c.createElement("div",{className:"gdg-search-status"},c.createElement("div",{"data-testid":"search-result-area"},x)),c.createElement("div",{className:"gdg-search-progress",style:De})):c.createElement("div",{className:"gdg-search-status"},c.createElement("label",{htmlFor:I},"Type to search")))},[d,ve,_,i,I,g,G,se,ye,Ke,T,p,ce]);return c.createElement(c.Fragment,null,c.createElement(ji,{prelightCells:oe,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),ie)},Ic=()=>e=>Math.max(16,e.targetHeight-10),Tc=Eo("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Ic(),"px"]}}),Ec=e=>{const{bounds:o,group:r,onClose:i,canvasBounds:u,onFinish:g}=e,[k,f]=je.useState(r);return je.createElement(Ti,{style:{position:"absolute",left:o.x-u.left+1,top:o.y-u.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:i},je.createElement(Tc,{targetHeight:o.height,"data-testid":"group-rename-input",value:k,onBlur:i,onFocus:m=>m.target.setSelectionRange(0,k.length),onChange:m=>f(m.target.value),onKeyDown:m=>{m.key==="Enter"?g(k):m.key==="Escape"&&i()},autoFocus:!0}))},un=150;function zc(e,o,r,i){var g;const u=i(o);return((g=u==null?void 0:u.measure)==null?void 0:g.call(u,e,o,r))??un}function xr(e,o,r,i,u,g,k,f,m){let M=0;const s=u===void 0?[]:u.map(I=>{const P=zc(e,I[i],o,m);return M=Math.max(M,P),P});if(s.length>5&&f){M=0;let I=0;for(const H of s)I+=H;const P=I/s.length;for(let H=0;H<s.length;H++)s[H]>=P*2?s[H]=0:M=Math.max(M,s[H])}const d=e.font;e.font=o.headerFontFull,M=Math.max(M,e.measureText(r.title).width+o.cellHorizontalPadding*2+(r.icon===void 0?0:28)),e.font=d;const p=Math.max(Math.ceil(g),Math.min(Math.floor(k),Math.ceil(M)));return{...r,width:p}}function Dc(e,o,r,i,u,g,k,f,m){const M=c.useRef(o),s=c.useRef(r),d=c.useRef(k);M.current=o,s.current=r,d.current=k;const[p,I]=(()=>{if(typeof window>"u")return[null,null];const F=document.createElement("canvas");return F.style.display="none",F.style.opacity="0",F.style.position="fixed",[F,F.getContext("2d",{alpha:!1})]})();c.useLayoutEffect(()=>(p&&document.documentElement.append(p),()=>{p==null||p.remove()}),[p]);const P=c.useRef({}),H=c.useRef(),[se,Me]=c.useState();c.useLayoutEffect(()=>{const F=s.current;if(F===void 0||e.every(So))return;let V=Math.max(1,10-Math.floor(e.length/1e4)),oe=0;V<M.current&&V>1&&(V--,oe=1);const $={x:0,y:0,width:e.length,height:Math.min(M.current,V)},le={x:0,y:M.current-1,width:e.length,height:1};(async()=>{const ce=F($,m.signal),G=oe>0?F(le,m.signal):void 0;let T;typeof ce=="object"?T=ce:T=await lr(ce),G!==void 0&&(typeof G=="object"?T=[...T,...G]:T=[...T,...await lr(G)]),H.current=e,Me(T)})()},[m.signal,e]);let z=e.every(So)?e:I===null?e.map(F=>So(F)?F:{...F,width:un}):(I.font=d.current.baseFontFull,e.map((F,V)=>{if(So(F))return F;if(P.current[F.id]!==void 0)return{...F,width:P.current[F.id]};if(se===void 0||H.current!==e||F.id===void 0)return{...F,width:un};const oe=xr(I,k,F,V,se,u,g,!0,f);return P.current[F.id]=oe.width,oe})),ne=0,S=0;const O=[];for(const[F,V]of z.entries())ne+=V.width,V.grow!==void 0&&V.grow>0&&(S+=V.grow,O.push(F));if(ne<i&&O.length>0){const F=[...z],V=i-ne;let oe=V;for(let $=0;$<O.length;$++){const le=O[$],B=(z[le].grow??0)/S,ce=$===O.length-1?oe:Math.min(oe,Math.floor(V*B));F[le]={...z[le],growOffset:ce,width:z[le].width+ce},oe-=ce}z=F}return{sizedColumns:z,nonGrowWidth:ne}}function Lc(e,o){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===o.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===o.keyCode:e===o.key}function ee(e,o,r){const i=Rr(e,o);return i&&(r.didMatch=!0),i}function Rr(e,o){if(e.length===0)return!1;if(e.includes("|")){const m=e.split("|");for(const M of m)if(Rr(M,o))return!0;return!1}let r=!1,i=!1,u=!1,g=!1;const k=e.split("+"),f=k.pop();if(!Lc(f,o))return!1;if(k[0]==="any")return!0;for(const m of k)switch(m){case"ctrl":r=!0;break;case"shift":i=!0;break;case"alt":u=!0;break;case"meta":g=!0;break;case"primary":To.value?g=!0:r=!0;break}return o.altKey===u&&o.ctrlKey===r&&o.shiftKey===i&&o.metaKey===g}function Hc(e){const{state:o,keybindings:r,overlayOpen:i,columnSelect:u,rowSelect:g,rangeSelect:k,editOnType:f,trapFocus:m,showTrailingBlankRow:M,columnsInLength:s,rowGroupingNavBehavior:d,mapper:p,onKeyDownIn:I,onSelectionCleared:P,onCellActivated:H,onDelete:se,getCellContent:Me,setSelectedColumns:_,setSelectedRows:z,setShowSearchInner:ne,searchInputRef:S,adjustSelection:O,updateSelectedCell:F,deleteRange:V,fillDown:oe,fillRight:$,appendRow:le,getCustomNewRowTargetColumn:B,scrollToRef:ce}=e,{gridSelection:G,gridRef:T,visibleRegionRef:Ke,rowMarkerOffset:ye,rows:ve,setGridSelection:A,getMangledCellContent:ie,mangledOnCellsEdited:x,setOverlay:Y,reselect:Re,focus:De}=o,Ge=v=>{var W,de,Ee,Ve;const fe=()=>{v.stopPropagation(),v.preventDefault()},E={didMatch:!1},{bounds:me}=v,Le=G.columns,Ue=G.rows,N=r;if(!i&&ee(N.clear,v,E)){const Q=((W=G.current)==null?void 0:W.cell)??[ye,0];A({columns:Se.empty(),rows:Se.empty(),current:{cell:Q,range:{x:Q[0],y:Q[1],width:1,height:1},rangeStack:[]}},!1),P==null||P(),De()}else if(!i&&ee(N.selectAll,v,E))A({columns:Se.empty(),rows:Se.empty(),current:{cell:((de=G.current)==null?void 0:de.cell)??[ye,0],range:{x:ye,y:0,width:s,height:ve},rangeStack:[]}},!1);else if(ee(N.search,v,E))(Ee=S==null?void 0:S.current)==null||Ee.focus({preventScroll:!0}),ne(!0);else if(ee(N.delete,v,E)){const Q=(se==null?void 0:se(G))??!0;if(Q!==!1){const J=Q===!0?G:Q;if(J.current!==void 0){V(J.current.range);for(const Oe of J.current.rangeStack)V(Oe)}for(const Oe of J.rows)V({x:ye,y:Oe,width:s,height:1});for(const Oe of J.columns)V({x:Oe,y:0,width:1,height:ve})}}if(E.didMatch)return fe(),!0;if(G.current===void 0)return!1;let[re,q]=G.current.cell;const[,ct]=G.current.cell;let Ze=!1,St=!1;if(ee(N.scrollToSelectedCell,v,E))ce.current(re-ye,q);else if(u!=="none"&&ee(N.selectColumn,v,E))Le.hasIndex(re)?_(Le.remove(re),void 0,!0):u==="single"?_(Se.fromSingleSelection(re),void 0,!0):_(void 0,re,!0);else if(g!=="none"&&ee(N.selectRow,v,E))Ue.hasIndex(q)?z(Ue.remove(q),void 0,!0):g==="single"?z(Se.fromSingleSelection(q),void 0,!0):z(void 0,q,!0);else if(!i&&me!==void 0&&ee(N.activateCell,v,E))if(q===ve&&M)window.setTimeout(()=>{const Q=B(re);le(Q??re)},0);else{const Q={inputType:"keyboard",key:v.key},J=ie([re,q]);J.kind===Z.Boolean&&J.readonly!==!0?(H==null||H([re-ye,q],Q),x([{location:[re,q],value:{...J,data:pr(J.data)}}]),(Ve=T.current)==null||Ve.damage([{cell:[re,q]}])):(H==null||H([re-ye,q],Q),Re(me,Q))}else G.current.range.height>1&&ee(N.downFill,v,E)?oe():G.current.range.width>1&&ee(N.rightFill,v,E)?$():ee(N.goToNextPage,v,E)?q+=Math.max(1,Ke.current.height-4):ee(N.goToPreviousPage,v,E)?q-=Math.max(1,Ke.current.height-4):ee(N.goToFirstCell,v,E)?(Y(void 0),q=0,re=0):ee(N.goToLastCell,v,E)?(Y(void 0),q=Number.MAX_SAFE_INTEGER,re=Number.MAX_SAFE_INTEGER):ee(N.selectToFirstCell,v,E)?(Y(void 0),O([-2,-2])):ee(N.selectToLastCell,v,E)?(Y(void 0),O([2,2])):i?(ee(N.closeOverlay,v,E)&&Y(void 0),ee(N.acceptOverlayDown,v,E)&&(Y(void 0),q++),ee(N.acceptOverlayUp,v,E)&&(Y(void 0),q--),ee(N.acceptOverlayLeft,v,E)&&(Y(void 0),re--),ee(N.acceptOverlayRight,v,E)&&(Y(void 0),re++)):(ee(N.goDownCell,v,E)?q+=1:ee(N.goUpCell,v,E)?q-=1:ee(N.goRightCell,v,E)?re+=1:ee(N.goLeftCell,v,E)?re-=1:ee(N.goDownCellRetainSelection,v,E)?(q+=1,Ze=!0):ee(N.goUpCellRetainSelection,v,E)?(q-=1,Ze=!0):ee(N.goRightCellRetainSelection,v,E)?(re+=1,Ze=!0):ee(N.goLeftCellRetainSelection,v,E)?(re-=1,Ze=!0):ee(N.goToLastRow,v,E)?q=ve-1:ee(N.goToFirstRow,v,E)?q=Number.MIN_SAFE_INTEGER:ee(N.goToLastColumn,v,E)?re=Number.MAX_SAFE_INTEGER:ee(N.goToFirstColumn,v,E)?re=Number.MIN_SAFE_INTEGER:(k==="rect"||k==="multi-rect")&&(ee(N.selectGrowDown,v,E)?O([0,1]):ee(N.selectGrowUp,v,E)?O([0,-1]):ee(N.selectGrowRight,v,E)?O([1,0]):ee(N.selectGrowLeft,v,E)?O([-1,0]):ee(N.selectToLastRow,v,E)?O([0,2]):ee(N.selectToFirstRow,v,E)?O([0,-2]):ee(N.selectToLastColumn,v,E)?O([2,0]):ee(N.selectToFirstColumn,v,E)&&O([-2,0])),St=E.didMatch);if(d!==void 0&&d!=="normal"&&q!==ct){const Q=d==="skip-up"||d==="skip"||d==="block",J=d==="skip-down"||d==="skip"||d==="block",Oe=q<ct;if(Oe&&Q){for(;q>=0&&p(q).isGroupHeader;)q--;q<0&&(q=ct)}else if(!Oe&&J){for(;q<ve&&p(q).isGroupHeader;)q++;q>=ve&&(q=ct)}}const C=F(re,q,!1,Ze),we=E.didMatch;return we&&(C||!St||m)&&fe(),we};return{handleFixedKeybindings:Ge,onKeyDown:v=>{let fe=!1;if(I!==void 0&&I({...v,...v.location&&{location:[v.location[0]-ye,v.location[1]]},cancel:()=>{fe=!0}}),fe||Ge(v)||G.current===void 0)return;const[E,me]=G.current.cell,Le=Ke.current,Ue=v.keyCode===229,N=f&&!v.metaKey&&!v.ctrlKey&&v.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(v.key);if((Ue||N)&&v.bounds!==void 0&&Ht(Me([E-ye,Math.max(0,Math.min(me,ve-1))]))){if((!M||me!==ve)&&(Le.y>me||me>Le.y+Le.height||Le.x>E||E>Le.x+Le.width))return;if(v.stopPropagation(),v.preventDefault(),Ue){const re={inputType:"keyboard",key:""};H==null||H([E-ye,me],re),Re(v.bounds,re,"")}else{const re={inputType:"keyboard",key:v.key};H==null||H([E-ye,me],re),Re(v.bounds,re,v.key)}}}}}function Fc(e,o,r,i,u,g,k){const f=je.useCallback((s,d,p,I)=>{var z;(g==="cell"||g==="multi-cell")&&s!==void 0&&(s={...s,range:{x:s.cell[0],y:s.cell[1],width:1,height:1}}),!k&&s!==void 0&&s.range.width>1&&(s={...s,range:{...s.range,width:1,x:s.cell[0]}});const P=r==="mixed"&&(p||I==="drag")||r==="additive",H=(i==="mixed"||i==="additive")&&P,se=p||(u==="mixed"||u==="additive")&&P;let Me={current:s===void 0?void 0:{...s,rangeStack:I==="drag"?((z=e.current)==null?void 0:z.rangeStack)??[]:[]},columns:H?e.columns:Se.empty(),rows:se?e.rows:Se.empty()};p&&(g==="multi-rect"||g==="multi-cell")&&Me.current!==void 0&&e.current!==void 0&&(Me={...Me,current:{...Me.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),o(Me,d)},[i,e,r,g,k,u,o]),m=je.useCallback((s,d,p)=>{s=s??e.rows,d!==void 0&&(s=s.add(d));let I;if(u==="exclusive"&&s.length>0)I={current:void 0,columns:Se.empty(),rows:s};else{const P=p&&r==="mixed"||r==="additive",H=p&&i==="mixed"||i==="additive";I={current:P?e.current:void 0,columns:H?e.columns:Se.empty(),rows:s}}o(I,!1)},[i,e,r,u,o]),M=je.useCallback((s,d,p)=>{s=s??e.columns,d!==void 0&&(s=s.add(d));let I;if(i==="exclusive"&&s.length>0)I={current:void 0,rows:Se.empty(),columns:s};else{const P=p&&r==="mixed"||r==="additive",H=p&&u==="mixed"||u==="additive";I={current:P?e.current:void 0,rows:H?e.rows:Se.empty(),columns:s}}o(I,!1)},[i,e,r,u,o]);return[f,m,M]}function $c(e,o,r,i,u){const k=e!==void 0?M=>{if(e===!0){const s=[];for(let d=M.y;d<M.y+M.height;d++){const p=[];for(let I=M.x;I<M.x+M.width;I++)I<0||d>=u?p.push({kind:Z.Loading,allowOverlay:!1}):p.push(o([I,d]));s.push(p)}return s}return(e==null?void 0:e(M,i.signal))??[]}:void 0;return[e!==void 0?M=>{if(k===void 0)return[];const s={...M,x:M.x-r};if(s.x<0){s.x=0,s.width--;const d=k(s,i.signal);return typeof d=="function"?async()=>(await d()).map(p=>[{kind:Z.Loading,allowOverlay:!1},...p]):d.map(p=>[{kind:Z.Loading,allowOverlay:!1},...p])}return k(s,i.signal)}:void 0,k]}function gr(e){return typeof e=="string"?e:`${e}px`}const Gc=()=>e=>e.innerWidth,Kc=()=>e=>e.innerHeight,Pc=Eo("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[Gc()],"w2q57ts-1":[Kc()]}}),Nc=e=>{const{inWidth:o,inHeight:r,children:i,...u}=e;return c.createElement(Pc,{innerHeight:gr(r),innerWidth:gr(o),...u},i)},Wc=2,Ac=1300;function Oc(e,o,r){const i=je.useRef(0),[u,g]=e??[0,0];je.useEffect(()=>{if(u===0&&g===0){i.current=0;return}let k=!1,f=0;const m=M=>{var s;if(!k){if(f===0)f=M;else{const d=M-f;i.current=Math.min(1,i.current+d/Ac);const p=i.current**1.618*d*Wc;(s=o.current)==null||s.scrollBy(u*p,g*p),f=M,r==null||r()}window.requestAnimationFrame(m)}};return window.requestAnimationFrame(m),()=>{k=!0}},[o,u,g,r])}function Vc(e){const{state:o,keybindings:r,getCellsForSelection:i,coercePasteValue:u,onPaste:g,copyHeaders:k,columnsIn:f,onDelete:m,deleteRange:M,safeWindow:s}=e,{gridSelection:d,gridRef:p,scrollRef:I,canvasRef:P,abortControllerRef:H,rowMarkerOffset:se,mangledCols:Me,mangledRows:_,rows:z,getMangledCellContent:ne,mangledOnCellsEdited:S,getCellRenderer:O}=o,F=async $=>{var Ke,ye,ve;if(!r.paste)return;function le(A,ie,x,Y){var De,Ge;const Re=typeof x=="object"?(x==null?void 0:x.join(`
`))??"":(x==null?void 0:x.toString())??"";if(!Io(A)&&Ht(A)&&A.readonly!==!0){const be=u==null?void 0:u(Re,A);if(be!==void 0&&jt(be))return{location:ie,value:be};const v=O(A);if(v===void 0)return;if(v.kind===Z.Custom){ko(A.kind===Z.Custom);const fe=(De=v.onPaste)==null?void 0:De.call(v,Re,A.data);return fe===void 0?void 0:{location:ie,value:{...A,data:fe}}}else{const fe=(Ge=v.onPaste)==null?void 0:Ge.call(v,Re,A,{formatted:Y,formattedString:typeof Y=="string"?Y:Y==null?void 0:Y.join(`
`),rawValue:x});return fe===void 0?void 0:(ko(fe.kind===A.kind),{location:ie,value:fe})}}}const B=d.columns,ce=d.rows,G=((Ke=I.current)==null?void 0:Ke.contains(document.activeElement))===!0||((ye=P.current)==null?void 0:ye.contains(document.activeElement))===!0;let T;if(d.current!==void 0?T=[d.current.range.x,d.current.range.y]:B.length===1?T=[B.first()??0,0]:ce.length===1&&(T=[se,ce.first()??0]),G&&T!==void 0){let A,ie;const x="text/plain",Y="text/html";if(navigator.clipboard.read!==void 0){const be=await navigator.clipboard.read();for(const v of be){if(v.types.includes(Y)){const E=await(await v.getType(Y)).text(),me=ir(E);if(me!==void 0){A=me;break}}v.types.includes(x)&&(ie=await(await v.getType(x)).text())}}else if(navigator.clipboard.readText!==void 0)ie=await navigator.clipboard.readText();else if($!==void 0&&($==null?void 0:$.clipboardData)!==null){if($.clipboardData.types.includes(Y)){const be=$.clipboardData.getData(Y);A=ir(be)}A===void 0&&$.clipboardData.types.includes(x)&&(ie=$.clipboardData.getData(x))}else return;const[Re,De]=T,Ge=[];do{if(g===void 0){const be=ne(T),v=ie??(A==null?void 0:A.map(E=>E.map(me=>me.rawValue).join("	")).join("	"))??"",fe=le(be,T,v,void 0);fe!==void 0&&Ge.push(fe);break}if(A===void 0){if(ie===void 0)return;A=Ei(ie)}if(g===!1||typeof g=="function"&&(g==null?void 0:g([T[0]-se,T[1]],A.map(be=>be.map(v=>{var fe;return((fe=v.rawValue)==null?void 0:fe.toString())??""}))))!==!0)return;for(const[be,v]of A.entries()){if(be+De>=z)break;for(const[fe,E]of v.entries()){const me=[fe+Re,be+De],[Le,Ue]=me;if(Le>=Me.length||Ue>=_)continue;const N=ne(me),re=le(N,me,E.rawValue,E.formatted);re!==void 0&&Ge.push(re)}}}while(!1);S(Ge),(ve=p.current)==null||ve.damage(Ge.map(be=>({cell:be.location})))}};ln("paste",F,s,!1,!0);const V=async($,le)=>{var Ke,ye;if(!r.copy)return;const B=le===!0||((Ke=I.current)==null?void 0:Ke.contains(document.activeElement))===!0||((ye=P.current)==null?void 0:ye.contains(document.activeElement))===!0,ce=d.columns,G=d.rows,T=(ve,A)=>{if(!k)sr(ve,A,$);else{const ie=A.map(x=>({kind:Z.Text,data:f[x].title,displayData:f[x].title,allowOverlay:!1}));sr([ie,...ve],A,$)}};if(B&&i!==void 0){if(d.current!==void 0){let ve=i(d.current.range,H.current.signal);typeof ve!="object"&&(ve=await ve()),T(ve,Ut(d.current.range.x-se,d.current.range.x+d.current.range.width-se))}else if(G!==void 0&&G.length>0){const A=[...G].map(ie=>{const x=i({x:se,y:ie,width:f.length,height:1},H.current.signal);return typeof x=="object"?x[0]:x().then(Y=>Y[0])});if(A.some(ie=>ie instanceof Promise)){const ie=await Promise.all(A);T(ie,Ut(f.length))}else T(A,Ut(f.length))}else if(ce.length>0){const ve=[],A=[];for(const ie of ce){let x=i({x:ie,y:0,width:1,height:z},H.current.signal);typeof x!="object"&&(x=await x()),ve.push(x),A.push(ie-se)}if(ve.length===1)T(ve[0],A);else{const ie=ve.reduce((x,Y)=>x.map((Re,De)=>[...Re,...Y[De]]));T(ie,A)}}}};ln("copy",V,s,!1,!1);const oe=async $=>{var B,ce;if(!(!r.cut||!(((B=I.current)==null?void 0:B.contains(document.activeElement))===!0||((ce=P.current)==null?void 0:ce.contains(document.activeElement))===!0))&&(await V($),d.current!==void 0)){let G={current:{cell:d.current.cell,range:d.current.range,rangeStack:[]},rows:Se.empty(),columns:Se.empty()};const T=m==null?void 0:m(G);if(T===!1||(G=T===void 0||T===!0?G:T,G.current===void 0))return;M(G.current.range)}};return ln("cut",oe,s,!1,!1),{onCopy:V,onCut:oe,onPasteInternal:F}}function Bc({rowHeight:e,headerHeight:o,groupHeaderHeight:r,theme:i,overscrollX:u,overscrollY:g,scaleToRem:k,remSize:f}){const[m,M,s,d,p,I]=(()=>{if(!k||f===16)return[e,o,r,i,u,g];const P=f/16,H=e,se=wr();return[typeof H=="number"?H*P:Me=>Math.ceil(H(Me)*P),Math.ceil(o*P),Math.ceil(r*P),{...i,headerIconSize:((i==null?void 0:i.headerIconSize)??se.headerIconSize)*P,cellHorizontalPadding:((i==null?void 0:i.cellHorizontalPadding)??se.cellHorizontalPadding)*P,cellVerticalPadding:((i==null?void 0:i.cellVerticalPadding)??se.cellVerticalPadding)*P},Math.ceil((u??0)*P),Math.ceil((g??0)*P)]})();return{rowHeight:m,headerHeight:M,groupHeaderHeight:s,theme:d,overscrollX:p,overscrollY:I}}const bt={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function te(e,o){return e===!0?o:e===!1?"":e}function vr(e){const o=To.value;return{activateCell:te(e.activateCell," |Enter|shift+Enter"),clear:te(e.clear,"any+Escape"),closeOverlay:te(e.closeOverlay,"any+Escape"),acceptOverlayDown:te(e.acceptOverlayDown,"Enter"),acceptOverlayUp:te(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:te(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:te(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:te(e.delete,o?"Backspace|Delete":"Delete"),downFill:te(e.downFill,"primary+_68"),scrollToSelectedCell:te(e.scrollToSelectedCell,"primary+Enter"),goDownCell:te(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:te(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:te(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:te(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:te(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:te(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:te(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:te(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:te(e.goToFirstCell,"primary+Home"),goToFirstColumn:te(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:te(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:te(e.goToLastCell,"primary+End"),goToLastColumn:te(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:te(e.goToLastRow,"primary+ArrowDown"),goToNextPage:te(e.goToNextPage,"PageDown"),goToPreviousPage:te(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:te(e.rightFill,"primary+_82"),search:te(e.search,"primary+f"),selectAll:te(e.selectAll,"primary+a"),selectColumn:te(e.selectColumn,"ctrl+ "),selectGrowDown:te(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:te(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:te(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:te(e.selectGrowUp,"shift+ArrowUp"),selectRow:te(e.selectRow,"shift+ "),selectToFirstCell:te(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:te(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:te(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:te(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:te(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:te(e.selectToLastRow,"primary+shift+ArrowDown")}}function Uc(e){const o=zi(e);return je.useMemo(()=>{if(o===void 0)return vr(bt);const r={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??bt.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??bt.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??bt.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??bt.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??bt.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??bt.selectToLastCell};return vr({...bt,...r})},[o])}function _c(e){function o(i,u,g){if(typeof i=="number")return{headerIndex:i,isCollapsed:!1,depth:u,path:g};const k={headerIndex:i.headerIndex,isCollapsed:i.isCollapsed,depth:u,path:g};return i.subGroups!==void 0&&(k.subGroups=i.subGroups.map((f,m)=>o(f,u+1,[...g,m])).sort((f,m)=>f.headerIndex-m.headerIndex)),k}return e.map((i,u)=>o(i,0,[u])).sort((i,u)=>i.headerIndex-u.headerIndex)}function hn(e,o){const r=[];function i(f,m,M=!1){let s=m!==null?m-f.headerIndex:o-f.headerIndex;if(f.subGroups!==void 0&&(s=f.subGroups[0].headerIndex-f.headerIndex),s--,r.push({rowIndex:-1,headerIndex:f.headerIndex,contentIndex:-1,skip:M,isCollapsed:f.isCollapsed,depth:f.depth,path:f.path,rows:s}),f.subGroups)for(let d=0;d<f.subGroups.length;d++){const p=d<f.subGroups.length-1?f.subGroups[d+1].headerIndex:m;i(f.subGroups[d],p,M||f.isCollapsed)}}const u=_c(e.groups);for(let f=0;f<u.length;f++){const m=f<u.length-1?u[f+1].headerIndex:null;i(u[f],m)}let g=0,k=0;for(const f of r)f.contentIndex=k,k+=f.rows,f.rowIndex=g,g+=f.isCollapsed?1:f.rows+1;return r.filter(f=>f.skip===!1).map(f=>{const{skip:m,...M}=f;return M})}function dn(e,o){if(o===void 0||hn.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let r=e;for(const i of o){if(r===0)return{path:[...i.path,-1],originalIndex:i.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:i.rows};if(i.isCollapsed)r--;else{if(r<=i.rows)return{path:[...i.path,r-1],originalIndex:i.headerIndex+r,isGroupHeader:!1,groupIndex:r-1,contentIndex:i.contentIndex+r-1,groupRows:i.rows};r=r-i.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Xc(e,o,r,i){const u=e===void 0?void 0:hn(e,o),g=u==null?void 0:u.reduce((s,d)=>(s[d.rowIndex]=d,s),{}),k=u===void 0?o:u.reduce((s,d)=>s+(d.isCollapsed?1:d.rows+1),0),f=e===void 0||typeof r=="number"&&e.height===r?r:s=>g!=null&&g[s]?e.height:typeof r=="number"?r:r(s),m=s=>{if(u===void 0)return s;let d=s;for(const p of u){if(d===0)return;if(d--,!p.isCollapsed){if(d<p.rows)return p.contentIndex+d;d-=p.rows}}return s},M=Rt(i??(e==null?void 0:e.themeOverride),s=>{if(e===void 0)return i==null?void 0:i(s,s,s);if(i===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:d,contentIndex:p,groupIndex:I}=dn(s,u);return d?e.themeOverride:i==null?void 0:i(s,I,p)});return e===void 0?{rowHeight:f,rows:o,rowNumberMapper:m,getRowThemeOverride:M}:{rowHeight:f,rows:k,rowNumberMapper:m,getRowThemeOverride:M}}function Yc(e,o){const r=je.useMemo(()=>e===void 0?void 0:hn(e,o),[e,o]);return{getRowGroupingForPath:Mr,updateRowGroupingByPath:Sr,mapper:je.useCallback(i=>{if(typeof i=="number")return dn(i,r);const u=dn(i[1],r);return{...u,originalIndex:[i[0],u.originalIndex]}},[r])}}function Sr(e,o,r){const[i,...u]=o;return u[0]===-1?e.map((g,k)=>k===i?{...g,...r}:g):e.map((g,k)=>k===i?{...g,subGroups:Sr(g.subGroups??[],u,r)}:g)}function Mr(e,o){const[r,...i]=o;return i[0]===-1?e[r]:Mr(e[r].subGroups??[],i)}function qc(e,o){const[r]=c.useState(()=>({value:e,callback:o,facade:{get current(){return r.value},set current(i){const u=r.value;u!==i&&(r.value=i,r.callback(i,u))}}}));return r.callback=o,r.facade}function Zc(e,o,r,i,u){const[g,k]=[o!==void 0&&typeof r=="number"?Math.floor(o/r):0,o!==void 0&&typeof r=="number"?-(o%r):0],f={x:i.current.x,y:g,width:i.current.width??1,height:i.current.height??1,ty:k},[m,M,s]=Di(f),d=c.useRef(u);d.current=u;const p=qc(null,H=>{H!==null&&o!==void 0?H.scrollTop=o:H!==null&&e!==void 0&&(H.scrollLeft=e)}),I=(m.height??1)>1;c.useLayoutEffect(()=>{if(o!==void 0&&p.current!==null&&I){if(p.current.scrollTop===o)return;p.current.scrollTop=o,p.current.scrollTop!==o&&s(),d.current()}},[o,I,s,p]);const P=(m.width??1)>1;return c.useLayoutEffect(()=>{if(e!==void 0&&p.current!==null&&P){if(p.current.scrollLeft===e)return;p.current.scrollLeft=e,p.current.scrollLeft!==e&&s(),d.current()}},[e,P,s,p]),{visibleRegion:m,setVisibleRegion:M,scrollRef:p}}const Jc=Eo("textarea")({name:"GhostInputBox",class:"gxeqqyx",propsAsIs:!1}),jc=(e,o)=>{const{onInput:r,onCompositionStart:i,onCompositionEnd:u,onKeyDown:g,onKeyUp:k,onFocus:f,onBlur:m,disabled:M=!1}=e,s=c.useRef(null),d=c.useRef(!1),p=c.useRef({width:0,height:0}),I=c.useCallback(()=>{const z=s.current;if(!z||z.style.opacity==="0")return;const ne=p.current.width,S=p.current.height;z.style.width=`${ne}px`,z.style.height=`${S}px`;const O=Math.max(ne,z.scrollWidth+2),F=Math.max(S,z.scrollHeight+2);z.style.width=`${O}px`,z.style.height=`${F}px`},[]);c.useImperativeHandle(o,()=>({focus:()=>{var z;(z=s.current)==null||z.focus({preventScroll:!0})},blur:()=>{var z;(z=s.current)==null||z.blur()},clear:()=>{s.current&&(s.current.value="",s.current.setSelectionRange(0,0))},getValue:()=>{var z;return((z=s.current)==null?void 0:z.value)??""},setValue:z=>{if(s.current){s.current.value=z;const ne=z.length;s.current.setSelectionRange(ne,ne)}},setPosition:(z,ne,S,O)=>{const F=s.current;F&&(p.current={width:S,height:O},F.style.left=`${z}px`,F.style.top=`${ne}px`,F.style.width=`${S}px`,F.style.height=`${O}px`)},setVisible:z=>{const ne=s.current;ne&&(z?(ne.style.opacity="1",ne.style.pointerEvents="auto",ne.style.zIndex="10000"):(ne.style.left="-9999px",ne.style.top="0",ne.style.width="1px",ne.style.height="1px",ne.style.opacity="0",ne.style.pointerEvents="none",ne.style.zIndex="0"))}}));const P=c.useCallback(z=>{const ne=z.currentTarget;r(ne.value,d.current),I()},[r,I]),H=c.useCallback(()=>{d.current=!0,i()},[i]),se=c.useCallback(z=>{d.current=!1,u(z.currentTarget.value)},[u]),Me=c.useCallback(z=>{g(z)},[g]),_=c.useCallback(z=>{k==null||k(z)},[k]);return c.createElement(Jc,{ref:s,defaultValue:"",tabIndex:M?-1:0,disabled:M,onInput:P,onCompositionStart:H,onCompositionEnd:se,onKeyDown:Me,onKeyUp:_,onFocus:f,onBlur:m,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},Qc=c.memo(c.forwardRef(jc)),ea=e=>{};function ta(e){const{state:o,onKeyDown:r,onFinishEditing:i,onKeyUpIn:u,onCellActivated:g,setIsFocused:k}=e,{gridSelection:f,overlayRef:m,ghostInputRef:M,ghostInputVisibleRef:s,gridRef:d,rowMarkerOffset:p,getMangledCellContent:I,reselect:P}=o;return{onGhostInput:(S,O)=>{var F;if(m.current===void 0&&!O&&S.length>0&&S.trim().length>0&&f.current!==void 0){const[V,oe]=f.current.cell,$=I([V,oe]);if($.kind===Z.Custom){const le=$.data,B=le==null?void 0:le.kind;if(B!=="number-cell"&&B!=="date-picker-cell")return}if($.allowOverlay&&Ht($)&&$.readonly!==!0){const le=(F=d.current)==null?void 0:F.getBounds(V,oe);if(le!==void 0){const B={inputType:"keyboard",key:S};g==null||g([V-p,oe],B),P(le,B,S)}}}},onGhostCompositionStart:()=>{var V,oe,$,le,B;if(f.current===void 0)return;const[S,O]=f.current.cell,F=(V=m.current)==null?void 0:V.cell;if(F!==void 0&&(F[0]!==S||F[1]!==O)&&((oe=M.current)==null||oe.clear(),($=M.current)==null||$.setVisible(!1),o.setGhostInputVisible(!1),m.current=void 0,o.setOverlay(void 0)),m.current===void 0){const ce=I([S,O]);if(ce.kind===Z.Custom){const G=ce.data,T=G==null?void 0:G.kind;if(T!=="number-cell"&&T!=="date-picker-cell")return}if(ce.allowOverlay&&Ht(ce)&&ce.readonly!==!0){const G=(le=d.current)==null?void 0:le.getBounds(S,O);if(G!==void 0){(B=M.current)==null||B.clear();const T={inputType:"keyboard",key:""};g==null||g([S-p,O],T),P(G,T,"")}}}},onGhostCompositionEnd:ea,onGhostKeyDown:S=>{var $,le;if(S.nativeEvent.isComposing)return;if(m.current!==void 0&&s.current){const B=S.key;if(m.current.content.kind===Z.Custom){(B==="Enter"||B==="Tab"||B==="Escape")&&(S.preventDefault(),S.stopPropagation());return}if(B==="Escape"){S.preventDefault(),S.stopPropagation(),i(void 0,[0,0]);return}if(B==="Enter"&&!S.shiftKey){S.preventDefault(),S.stopPropagation(),i(void 0,[0,1]);return}if(B==="Tab"){S.preventDefault(),S.stopPropagation(),i(void 0,S.shiftKey?[-1,0]:[1,0]);return}}{const B=S.key;if(B.length===1&&!S.ctrlKey&&!S.metaKey&&!S.altKey)if(B===" "&&f.current!==void 0){const G=f.current.cell,T=I(G);if(!(T.kind===Z.Boolean&&T.readonly!==!0))return}else return}if(m.current!==void 0&&s.current){const B=S.key;if(B==="Backspace"||B==="Delete"||(B==="ArrowLeft"||B==="ArrowRight"||B==="ArrowUp"||B==="ArrowDown"||B==="Home"||B==="End"))return}const O=($=f.current)==null?void 0:$.cell,F=O!==void 0?(le=d.current)==null?void 0:le.getBounds(O[0],O[1]):void 0;let V=!1;const oe={bounds:F,cancel:()=>{V=!0},stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:O};r(oe),V&&(S.preventDefault(),S.stopPropagation())},onGhostKeyUp:S=>{var oe,$;const O=(oe=f.current)==null?void 0:oe.cell,V={bounds:O!==void 0?($=d.current)==null?void 0:$.getBounds(O[0],O[1]):void 0,cancel:()=>{},stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:O};u==null||u(V)},onGhostFocus:()=>{k(!0)},onGhostBlur:()=>{k(!1)}}}function oa(e){const{state:o,mouseState:r,setMouseState:i,fillHighlightRegion:u,setFillHighlightRegion:g,setScrollDir:k,handleSelect:f,onMouseMove:m,onCellClicked:M,onCellActivated:s,onCellContextMenu:d,onHeaderContextMenu:p,onGroupHeaderContextMenu:I,onHeaderClicked:P,onGroupHeaderClicked:H,onColumnResize:se,onFillPattern:Me,cellActivationBehavior:_,columnSelect:z,columnSelectionMode:ne,columns:S,groupLevels:O,mergedTheme:F,minColumnWidth:V,maxColumnWidth:oe,themeForCell:$,getCellsForSelection:le,setSelectedColumns:B,visibleRegion:ce,lastMouseSelectLocation:G}=e,{gridSelection:T,gridRef:Ke,visibleRegionRef:ye,abortControllerRef:ve,rowMarkerOffset:A,mangledCols:ie,rows:x,setGridSelection:Y,getMangledCellContent:Re,mangledOnCellsEdited:De,reselect:Ge,focus:be,getCellRenderer:v}=o,fe=c.useRef(!1),E=c.useRef(ce),me=c.useRef(void 0),Le=c.useRef(!1),Ue=C=>{if(Le.current=!1,E.current=ye.current,C.button!==0&&C.button!==1){me.current=void 0;return}const we=performance.now();me.current={button:C.button,time:we,location:C.location},(C==null?void 0:C.kind)==="header"&&(fe.current=!0);const W=C.kind==="cell"&&C.isFillHandle;!W&&C.kind!=="cell"&&C.isEdge||(i({previousSelection:T,fillHandle:W}),G.current=void 0,!C.isTouch&&C.button===0&&!W?f(C):!C.isTouch&&C.button===1&&(G.current=C.location))},N=C=>{if(C.kind!==Bt||z!=="multi")return;const we=To.value?C.metaKey:C.ctrlKey,[W,de]=C.location,Ee=T.columns;if(W<A)return;const Ve=ie[W];let Q=W,J=W;const Oe=de<=-2?-(de+2):0,He=(Fe,Be)=>O>1?Gi(Fe,Be,Oe,O):Ki(Fe,Be);for(let Fe=W-1;Fe>=A&&He(Ve.group,ie[Fe].group);Fe--)Q--;for(let Fe=W+1;Fe<ie.length&&He(Ve.group,ie[Fe].group);Fe++)J++;if(be(),we||C.isTouch||ne==="multi")if(Ee.hasAll([Q,J+1])){let Fe=Ee;for(let Be=Q;Be<=J;Be++)Fe=Fe.remove(Be);B(Fe,void 0,we)}else B(void 0,[Q,J+1],we);else B(Se.fromSingleSelection([Q,J+1]),void 0,we)},re=async C=>{if(le!==void 0&&se!==void 0){const we=ye.current.y,W=ye.current.height;let de=le({x:C,y:we,width:1,height:Math.min(W,x-we)},ve.current.signal);typeof de!="object"&&(de=await de());const Ee=S[C-A],Q=document.createElement("canvas").getContext("2d",{alpha:!1});if(Q!==null){Q.font=F.baseFontFull;const J=xr(Q,F,Ee,0,de,V,oe,!1,v);se==null||se(Ee,J.width,C,J.width)}}},q=async(C,we)=>{var J,Oe;const W=(J=C.current)==null?void 0:J.range;if(W===void 0||le===void 0||we.current===void 0)return;const de=we.current.range;if(Me!==void 0){let He=!1;if(Me({fillDestination:{...de,x:de.x-A},patternSource:{...W,x:W.x-A},preventDefault:()=>He=!0}),He)return}let Ee=le(W,ve.current.signal);typeof Ee!="object"&&(Ee=await Ee());const Ve=Ee,Q=[];for(let He=0;He<de.width;He++)for(let Fe=0;Fe<de.height;Fe++){const Be=[de.x+He,de.y+Fe];if($i(Be,W))continue;const ke=Ve[Fe%W.height][He%W.width];Io(ke)||!Ht(ke)||Q.push({location:Be,value:{...ke}})}De(Q),(Oe=Ke.current)==null||Oe.damage(Q.map(He=>({cell:He.location})))};return{onMouseDown:Ue,onMouseUp:(C,we)=>{var Fe,Be;const W=r;if(i(void 0),g(void 0),k(void 0),fe.current=!1,we)return;if((W==null?void 0:W.fillHandle)===!0&&T.current!==void 0&&((Fe=W.previousSelection)==null?void 0:Fe.current)!==void 0){if(u===void 0)return;const ke={...T,current:{...T.current,range:Li(W.previousSelection.current.range,u)}};q(W.previousSelection,ke),Y(ke,!0);return}const[de,Ee]=C.location,[Ve,Q]=G.current??[],J=()=>{Le.current=!0},Oe=ke=>{var Qt,eo,Qe;const Mt=ke.isTouch||Ve===de&&Q===Ee;if(Mt&&(M==null||M([de-A,Ee],{...ke,preventDefault:J})),ke.button===1)return!Le.current;if(!Le.current){const kt=Re(C.location),Ft=v(kt);if(Ft!==void 0&&Ft.onClick!==void 0&&Mt){const Je=Ft.onClick({...ke,cell:kt,posX:ke.localEventX,posY:ke.localEventY,bounds:ke.bounds,theme:$(kt,C.location),preventDefault:J});Je!==void 0&&!Io(Je)&&jt(Je)&&(De([{location:ke.location,value:Je}]),(Qt=Ke.current)==null||Qt.damage([{cell:ke.location}]))}if(Le.current||T.current===void 0)return!1;let It=!1;switch(kt.activationBehaviorOverride??_){case"double-click":case"second-click":{if(((Qe=(eo=W==null?void 0:W.previousSelection)==null?void 0:eo.current)==null?void 0:Qe.cell)===void 0)break;const[Je,ft]=T.current.cell,[Xt,et]=W.previousSelection.current.cell;It=de===Je&&de===Xt&&Ee===ft&&Ee===et&&(ke.isDoubleClick===!0||_==="second-click");break}case"single-click":{It=!0;break}}if(It){const ft={inputType:"pointer",pointerActivation:ke.isDoubleClick===!0?"double-click":kt.activationBehaviorOverride??_,pointerType:ke.isTouch?"touch":"mouse"};return s==null||s([de-A,Ee],ft),Ge(ke.bounds,ft),!0}}return!1},He=C.location[0]-A;if(C.isTouch){const ke=ye.current,Mt=E.current;if(ke.x!==Mt.x||ke.y!==Mt.y)return;if(C.isLongTouch===!0){if(C.kind==="cell"&&Hi((Be=T.current)==null?void 0:Be.cell,C.location)){d==null||d([He,C.location[1]],{...C,preventDefault:J});return}else if(C.kind==="header"&&T.columns.hasIndex(de)){p==null||p(He,{...C,preventDefault:J});return}else if(C.kind===Bt){if(He<0)return;I==null||I(He,{...C,preventDefault:J});return}}C.kind==="cell"?Oe(C)||f(C):C.kind===Bt?H==null||H(He,{...C,preventDefault:J}):(C.kind===Fi&&(P==null||P(He,{...C,preventDefault:J})),f(C));return}if(C.kind==="header"){if(He<0)return;C.isEdge?C.isDoubleClick===!0&&re(de):C.button===0&&de===Ve&&Ee===Q&&(P==null||P(He,{...C,preventDefault:J}))}if(C.kind===Bt){if(He<0)return;C.button===0&&de===Ve&&Ee===Q&&(H==null||H(He,{...C,preventDefault:J}),Le.current||N(C))}C.kind==="cell"&&(C.button===0||C.button===1)&&Oe(C),G.current=void 0},onMouseMoveImpl:C=>{const we={...C,location:[C.location[0]-A,C.location[1]]};m==null||m(we),r!==void 0&&C.buttons===0&&(i(void 0),g(void 0),k(void 0),fe.current=!1),k(W=>{var de;return fe.current?[C.scrollEdge[0],0]:C.scrollEdge[0]===(W==null?void 0:W[0])&&C.scrollEdge[1]===W[1]?W:r===void 0||(((de=me.current)==null?void 0:de.location[0])??0)<A?void 0:C.scrollEdge})},handleGroupHeaderSelection:N,normalSizeColumn:re,fillDown:()=>{if(T.current===void 0||T.current.range.height<=1)return;const C={...T,current:{...T.current,range:{...T.current.range,height:1}}};q(C,T)},fillRight:()=>{if(T.current===void 0||T.current.range.width<=1)return;const C={...T,current:{...T.current,range:{...T.current.range,width:1}}};q(C,T)},mouseDownData:me,isActivelyDraggingHeader:fe}}const na=c.lazy(async()=>await Ci(()=>import("./image-window-loader-DtBhR23y.js").then(e=>e.ad),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let ra=0;function la(e){return Hs(hr(hr(e).filter(o=>o.span!==void 0).map(o=>{var r,i;return Ut((((r=o.span)==null?void 0:r[0])??0)+1,(((i=o.span)==null?void 0:i[1])??0)+1)})))}function Mo(e,o){return e===void 0||o===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+o,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+o},rangeStack:e.current.rangeStack.map(r=>({...r,x:r.x+o}))},rows:e.rows,columns:e.columns.offset(o)}}const xt={kind:Z.Loading,allowOverlay:!1},an={columns:Se.empty(),rows:Se.empty(),current:void 0},ia=(e,o)=>{var or,nr,rr;const[r,i]=c.useState(an),[u,g]=c.useState(),k=c.useRef(null),f=c.useRef(null),[m,M]=c.useState(),[s,d]=c.useState(),p=c.useRef(void 0),I=c.useRef(null),[P,H]=c.useState(!1),se=c.useRef(P);se.current=P;const Me=c.useRef(u);Me.current=u;const _=typeof window>"u"?null:window,{imageEditorOverride:z,getRowThemeOverride:ne,markdownDivCreateNode:S,width:O,height:F,columns:V,rows:oe,getCellContent:$,onCellClicked:le,onCellActivated:B,onFillPattern:ce,onFinishedEditing:G,coercePasteValue:T,drawHeader:Ke,drawCell:ye,editorBloom:ve,onHeaderClicked:A,onColumnProposeMove:ie,rangeSelectionColumnSpanning:x=!0,spanRangeBehavior:Y="default",onGroupHeaderClicked:Re,onCellContextMenu:De,className:Ge,onHeaderContextMenu:be,getCellsForSelection:v,onGroupHeaderContextMenu:fe,onGroupHeaderRenamed:E,onCellEdited:me,onCellsEdited:Le,onSearchResultsChanged:Ue,searchResults:N,onSearchValueChange:re,searchValue:q,onKeyDown:ct,onKeyUp:Ze,keybindings:St,editOnType:_t=!0,onRowAppended:C,onColumnAppended:we,onColumnMoved:W,validateCell:de,highlightRegions:Ee,rangeSelect:Ve="rect",columnSelect:Q="multi",rowSelect:J="multi",rangeSelectionBlending:Oe="exclusive",columnSelectionBlending:He="exclusive",rowSelectionBlending:Fe="exclusive",onDelete:Be,onDragStart:ke,onMouseMove:Mt,onPaste:Qt,copyHeaders:eo=!1,freezeColumns:Qe=0,cellActivationBehavior:kt="second-click",rowSelectionMode:Ft="auto",columnSelectionMode:It="auto",onHeaderMenuClick:Je,onHeaderIndicatorClick:ft,getGroupDetails:Xt,rowGrouping:et,onSearchClose:zo,onItemHovered:Do,onSelectionCleared:to,showSearch:kr,onVisibleRegionChanged:Lo,gridSelection:$t,onGridSelectionChange:gn,minColumnWidth:Ir=50,maxColumnWidth:Tr=500,maxColumnAutoWidth:Er,provideEditor:zr,trailingRowOptions:We,freezeTrailingRows:Tt=0,allowedFillDirections:Dr="orthogonal",scrollOffsetX:Lr,scrollOffsetY:Hr,verticalBorder:Yt,onDragOverCell:Fr,onDrop:$r,onColumnResize:oo,onColumnResizeEnd:no,onColumnResizeStart:ro,customRenderers:Ho,fillHandle:Gr,experimental:Xe,fixedShadowX:Kr,fixedShadowY:Pr,headerIcons:Nr,imageWindowLoader:Wr,initialSize:Ar,isDraggable:Or,onDragLeave:Vr,onRowMoved:Fo,overscrollX:Br,overscrollY:Ur,preventDiagonalScrolling:_r,rightElement:Xr,rightElementProps:Yr,trapFocus:qr=!1,smoothScrollX:Zr,smoothScrollY:Jr,scaleToRem:jr=!1,rowHeight:Qr=34,headerHeight:vn=36,groupHeaderHeight:el=vn,theme:tl,isOutsideClick:ol,renderers:mn,resizeIndicator:nl,scrollToActiveCell:pn=!0,drawFocusRing:wn=!0,portalElementRef:lo,onRowStatus:$o,onRowId:Go}=e,Cn=wn==="no-editor"?u===void 0:wn,X=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,rl=(X==null?void 0:X.rowNumber)??!1;let io=(X==null?void 0:X.kind)??e.rowMarkers??"none",at=rl;(io==="both"||io==="checkbox-and-number")&&(io="checkbox",at=!0);const ht=io,ll=(X==null?void 0:X.width)??e.rowMarkerWidth,yn=(X==null?void 0:X.startIndex)??e.rowMarkerStartIndex??1,bn=(X==null?void 0:X.theme)??e.rowMarkerTheme,xn=X==null?void 0:X.headerTheme,il=X==null?void 0:X.headerAlwaysVisible,Rn=J!=="multi"||(X==null?void 0:X.headerDisabled)===!0,so=(X==null?void 0:X.checkboxStyle)??"square",sl=(X==null?void 0:X.rowStatus)??!1,Sn=(X==null?void 0:X.rowStatusWidth)??40,Mn=X==null?void 0:X.rowStatusTheme,cl=(X==null?void 0:X.rowId)??!1,kn=(X==null?void 0:X.rowIdWidth)??80,In=X==null?void 0:X.rowIdTheme,qt=Math.max(Ir,20),Ko=Math.max(Tr,qt),al=Math.max(Er??Ko,qt),ul=typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),{rows:Ie,rowNumberMapper:Tn,rowHeight:dl,getRowThemeOverride:Et}=Xc(et,oe,Qr,ne),fl=Number.parseFloat(ul.fontSize),{rowHeight:Gt,headerHeight:En,groupHeaderHeight:zn,theme:hl,overscrollX:gl,overscrollY:vl}=Bc({groupHeaderHeight:el,headerHeight:vn,overscrollX:Br,overscrollY:Ur,remSize:fl,rowHeight:dl,scaleToRem:jr,theme:tl}),Dn=Uc(St),Po=ll??(oe>1e4?48:oe>1e3?44:oe>100?36:32),gt=ht!=="none",co=sl===!0,ao=cl===!0,b=(gt?at?2:1:0)+(co?1:0)+(ao?1:0),No=(gt?(at?2:1)*Po:0)+(co?Sn:0)+(ao?kn:0),Ye=We!==void 0,Wo=(We==null?void 0:We.sticky)===!0,[ml,Ln]=c.useState(!1),pl=kr??ml,wl=()=>{zo!==void 0?zo():Ln(!1)},K=($t===void 0?void 0:Mo($t,b))??r,vt=c.useRef(new AbortController);c.useEffect(()=>()=>vt==null?void 0:vt.current.abort(),[]);const[Kt,Cl]=$c(v,$,b,vt.current,Ie),yl=(t,n,a)=>{if(de===void 0)return!0;const l=[t[0]-b,t[1]];return de==null?void 0:de(l,n,a)},uo=c.useRef($t),Pt=(t,n)=>{n&&(t=Vi(t,Kt,b,Y,vt.current)),gn!==void 0?(uo.current=Mo(t,-b),gn(uo.current)):i(t)},Hn=Rt(oo,(t,n,a,l)=>{oo==null||oo(V[a-b],n,a-b,l)}),bl=Rt(no,(t,n,a,l)=>{no==null||no(V[a-b],n,a-b,l)}),xl=Rt(ro,(t,n,a,l)=>{ro==null||ro(V[a-b],n,a-b,l)}),Rl=Rt(Ke,(t,n)=>(Ke==null?void 0:Ke({...t,columnIndex:t.columnIndex-b},n))??!1),Sl=Rt(ye,(t,n)=>(ye==null?void 0:ye({...t,col:t.col-b},n))??!1),Fn=t=>{if(Be!==void 0){const n=Be(Mo(t,-b));return typeof n=="boolean"?n:Mo(n,b)}return!0},[ut,tt,ot]=Fc(K,Pt,Oe,He,Fe,Ve,x),nt=sn(wr(),hl),[Ao,Ml]=c.useState([0,0,0]),kl=(()=>{if(mn===void 0)return{};const t={};for(const n of mn)t[n.kind]=n;return t})(),mt=t=>t.kind!==Z.Custom?kl[t.kind]:Ho==null?void 0:Ho.find(n=>n.isMatch(t));let{sizedColumns:Nt,nonGrowWidth:$n}=Dc(V,Ie,Cl,Ao[0]-No-Ao[2],qt,al,nt,mt,vt.current);$n+=No;const Zt=(()=>{let t=0;for(const n of Nt)n.group!==void 0&&(typeof n.group=="string"?t=Math.max(t,1):t=Math.max(t,n.group.length));return t})(),Gn=Zt>0,Kn=Zt===0?[]:Array(Zt).fill(zn),Il=Kn.reduce((t,n)=>t+n,0),Oo=En+Il,Pn=K.rows.length,Tl=ht==="none"?void 0:Pn===0?!1:Pn===Ie?!0:void 0,Ne=(()=>{const t=[];return ht!=="none"&&(at&&t.push({title:"",width:Po,icon:void 0,hasMenu:!1,style:"normal",themeOverride:bn,rowMarker:so,rowMarkerChecked:!1,headerRowMarkerTheme:xn,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),t.push({title:"",width:Po,icon:void 0,hasMenu:!1,style:"normal",themeOverride:bn,rowMarker:so,rowMarkerChecked:Tl,headerRowMarkerTheme:xn,headerRowMarkerAlwaysVisible:il,headerRowMarkerDisabled:Rn})),co&&t.push({title:"",width:Sn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Mn}),ao&&t.push({title:"ID",width:kn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:In}),[...t,...Nt]})(),pt=c.useRef({height:1,width:1,x:0,y:0}),fo=c.useRef(!1),{setVisibleRegion:El,visibleRegion:zt,scrollRef:$e}=Zc(Lr,Hr,Gt,pt,()=>fo.current=!0);pt.current=zt;const zl=zt.x+b,Vo=zt.y,_e=c.useRef(null),rt=t=>{var n;t===!0?(n=I.current)==null||n.focus():window.requestAnimationFrame(()=>{var a;(a=I.current)==null||a.focus()})},lt=Ye?Ie+1:Ie,ho=t=>{const n=b===0?t:t.map(l=>({...l,location:[l.location[0]-b,l.location[1]]})),a=Le==null?void 0:Le(n);if(a!==!0)for(const l of n)me==null||me(l.location,l.value);return a},[go,Nn]=c.useState(),Bo=K.current!==void 0&&K.current.range.width*K.current.range.height>1?K.current.range:void 0,Wt=Cn?(or=K.current)==null?void 0:or.cell:void 0,Uo=Wt==null?void 0:Wt[0],_o=Wt==null?void 0:Wt[1],Dl=(()=>{if((Ee===void 0||Ee.length===0)&&(Bo??Uo??_o??go)===void 0)return;const t=[];if(Ee!==void 0)for(const n of Ee){const a=Ne.length-n.range.x-b;a>0&&t.push({color:n.color,range:{...n.range,x:n.range.x+b,width:Math.min(a,n.range.width)},style:n.style})}return go!==void 0&&t.push({color:cr(nt.accentColor,0),range:go,style:"dashed"}),Bo!==void 0&&t.push({color:cr(nt.accentColor,.5),range:Bo,style:"solid-outline"}),Uo!==void 0&&_o!==void 0&&t.push({color:nt.accentColor,range:{x:Uo,y:_o,width:1,height:1},style:"solid-outline"}),t.length>0?t:void 0})(),Wn=c.useRef(Ne);Wn.current=Ne;const At=([t,n],a=!1)=>{var U,j,pe,ae,he,L,xe,Ce,ue;const l=Ye&&n===lt-1;let h=0,w=-1,y=-1,R=-1,D=-1;if(gt&&at&&(w=h++),gt&&(y=h++),co&&(R=h++),ao&&(D=h++),t===w){if(l)return xt;const ge=Tn(n);return ge===void 0?xt:{kind:Lt.Marker,allowOverlay:!1,checkboxStyle:so,checked:!1,markerKind:"number",row:yn+ge,drawHandle:!1,cursor:void 0,disabled:((U=e.disabledRows)==null?void 0:U.call(e,n))===!0}}if(t===y){if(l)return xt;const ge=Tn(n);if(ge===void 0)return xt;let Pe;return at?Pe=ht==="checkbox-visible"?"checkbox-visible":"checkbox":ht==="clickable-number"?Pe="number":Pe=ht,{kind:Lt.Marker,allowOverlay:!1,checkboxStyle:so,checked:(K==null?void 0:K.rows.hasIndex(n))===!0,markerKind:Pe,row:yn+ge,drawHandle:Fo!==void 0,cursor:at?void 0:ht==="clickable-number"?"pointer":void 0,disabled:((j=e.disabledRows)==null?void 0:j.call(e,n))===!0}}if(t===R){if(l)return xt;const ge=$o==null?void 0:$o(n);return{kind:Lt.RowStatus,allowOverlay:!1,status:ge,themeOverride:Mn}}if(t===D){if(l)return xt;const ge=Go==null?void 0:Go(n);return{kind:Lt.RowId,allowOverlay:!1,rowId:ge,themeOverride:In}}if(l){const Pe=t===b?(We==null?void 0:We.hint)??"":"",Te=Wn.current[t];if(((pe=Te==null?void 0:Te.trailingRowOptions)==null?void 0:pe.disabled)===!0)return xt;{const qe=((ae=Te==null?void 0:Te.trailingRowOptions)==null?void 0:ae.hint)??Pe,it=((he=Te==null?void 0:Te.trailingRowOptions)==null?void 0:he.addIcon)??(We==null?void 0:We.addIcon);return{kind:Lt.NewRow,hint:qe,allowOverlay:!1,icon:it}}}else{const ge=t-b;if(a||(Xe==null?void 0:Xe.strict)===!0){const Te=pt.current,qe=Te.x>ge||ge>Te.x+Te.width||Te.y>n||n>Te.y+Te.height||n>=qo.current,it=ge===((xe=(L=Te.extras)==null?void 0:L.selected)==null?void 0:xe[0])&&n===((Ce=Te.extras)==null?void 0:Ce.selected[1]);let st=!1;if(((ue=Te.extras)==null?void 0:ue.freezeRegions)!==void 0){for(const yt of Te.extras.freezeRegions)if(_i(yt,ge,n)){st=!0;break}}if(qe&&!it&&!st)return xt}let Pe=$([ge,n]);return b!==0&&Pe.span!==void 0&&(Pe={...Pe,span:[Pe.span[0]+b,Pe.span[1]+b]}),Pe}},An=t=>{let n=(Xt==null?void 0:Xt(t))??{name:t};return E!==void 0&&t!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:a=>en({group:n.name,bounds:a.bounds})}]}),n},On=t=>{var R;const[n,a]=t.cell,l=Ne[n],h=(l==null?void 0:l.group)!==void 0?(R=An(l.group))==null?void 0:R.overrideTheme:void 0,w=l==null?void 0:l.themeOverride,y=Et==null?void 0:Et(a);g({...t,theme:sn(nt,h,w,y,t.content.themeOverride)})},Ll=(t,n,a)=>{var y,R,D,U,j,pe,ae;if(K.current===void 0)return;const[l,h]=K.current.cell,w=At([l,h]);if(w.kind!==Z.Boolean&&w.allowOverlay){let he=w;if(a!==void 0)switch(he.kind){case Z.Number:{const Ce=Yi(()=>a==="-"?-0:Number.parseFloat(a),0);he={...he,data:Number.isNaN(Ce)?0:Ce};break}case Z.Text:case Z.Markdown:case Z.Uri:he={...he,data:a};break}On({target:t,content:he,initialValue:a,cell:[l,h],highlight:a===void 0,forceEditMode:a!==void 0,activation:n});const L=he.kind===Z.Custom;a!==void 0&&!L?((y=I.current)==null||y.setPosition(t.x,t.y,t.width,t.height),a.length>0&&((R=I.current)==null||R.setValue(a)),(D=I.current)==null||D.setVisible(!0),H(!0)):L&&a!==void 0&&((U=I.current)==null||U.clear(),(j=I.current)==null||j.setVisible(!1),(pe=I.current)==null||pe.blur(),H(!1))}else w.kind===Z.Boolean&&n.inputType==="keyboard"&&w.readonly!==!0&&(ho([{location:K.current.cell,value:{...w,data:pr(w.data)}}]),(ae=_e.current)==null||ae.damage([{cell:K.current.cell}]))},Vn=(t,n)=>{var h;const a=(h=_e.current)==null?void 0:h.getBounds(t,n);if(a===void 0||$e.current===null)return;const l=At([t,n]);l.allowOverlay&&On({target:a,content:l,initialValue:void 0,highlight:!0,cell:[t,n],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},Ae=(t,n,a="both",l=0,h=0,w=void 0)=>{if($e.current!==null){const y=_e.current,R=f.current,D=typeof t!="number"?t.unit==="cell"?t.amount:void 0:t,U=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,j=typeof t!="number"&&t.unit==="px"?t.amount:void 0,pe=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(y!==null&&R!==null){let ae={x:0,y:0,width:0,height:0},he=0,L=0;if((D!==void 0||U!==void 0)&&(ae=y.getBounds((D??0)+b,U??0)??ae,ae.width===0||ae.height===0))return;const xe=R.getBoundingClientRect(),Ce=xe.width/R.offsetWidth;if(j!==void 0&&(ae={...ae,x:j-xe.left-$e.current.scrollLeft,width:1}),pe!==void 0&&(ae={...ae,y:pe+xe.top-$e.current.scrollTop,height:1}),ae!==void 0){const ue={x:ae.x-l,y:ae.y-h,width:ae.width+2*l,height:ae.height+2*h};let ge=0;for(let rn=0;rn<Qe;rn++)ge+=Nt[rn].width;let Pe=0;const Te=Tt+(Wo?1:0);Te>0&&(Pe=Oi(lt,Te,Gt));let qe=ge*Ce+xe.left+No*Ce,it=xe.right,st=xe.top+Oo*Ce,yt=xe.bottom-Pe*Ce;const xo=ae.width+l*2;switch(w==null?void 0:w.hAlign){case"start":it=qe+xo;break;case"end":qe=it-xo;break;case"center":qe=Math.floor((qe+it)/2)-xo/2,it=qe+xo;break}const Ro=ae.height+h*2;switch(w==null?void 0:w.vAlign){case"start":yt=st+Ro;break;case"end":st=yt-Ro;break;case"center":st=Math.floor((st+yt)/2)-Ro/2,yt=st+Ro;break}qe>ue.x?he=ue.x-qe:it<ue.x+ue.width&&(he=ue.x+ue.width-it),st>ue.y?L=ue.y-st:yt<ue.y+ue.height&&(L=ue.y+ue.height-yt),a==="vertical"||typeof t=="number"&&t<Qe?he=0:(a==="horizontal"||typeof n=="number"&&n>=lt-Te)&&(L=0),(he!==0||L!==0)&&(Ce!==1&&(he/=Ce,L/=Ce),$e.current.scrollTo({left:he+$e.current.scrollLeft,top:L+$e.current.scrollTop,behavior:(w==null?void 0:w.behavior)??"auto"}))}}}},vo=c.useRef(Ae);vo.current=Ae;const Xo=c.useRef(Vn),Yo=c.useRef($);Xo.current=Vn,Yo.current=$;const qo=c.useRef(Ie);qo.current=Ie;const Bn=c.useRef(Ne.length);Bn.current=Ne.length;const Jt=async(t,n=!0,a)=>{var U,j;const l=Ne[t],h=(j=((U=l==null?void 0:l.trailingRowOptions)==null?void 0:U.onRowAppended)??C)==null?void 0:j();let w,y=!0;h!==void 0&&(w=await h,w==="top"&&(y=!1),typeof w=="number"&&(y=!1));let R=0;const D=()=>{if(qo.current<=Ie){R<500&&window.setTimeout(D,R),R=50+R*2;return}const pe=typeof w=="number"?w:y?Ie:0;vo.current(t-b,pe,"both",0,20,a?{behavior:a}:void 0),ut({cell:[t,pe],range:{x:t,y:pe,width:1,height:1}},!1,!1,"edit");const ae=Yo.current([t-b,pe]);ae.allowOverlay&&Ht(ae)&&ae.readonly!==!0&&n&&window.setTimeout(()=>{Xo.current(t,pe)},0)};D()},Zo=async(t,n=!0)=>{const a=we==null?void 0:we();let l,h=!0;a!==void 0&&(l=await a,l==="left"&&(h=!1),typeof l=="number"&&(h=!1));let w=0;const y=()=>{if(Bn.current<=Ne.length){w<500&&window.setTimeout(y,w),w=50+w*2;return}const R=typeof l=="number"?l:h?Ne.length:0;Ae(R-b,t),ut({cell:[R,t],range:{x:R,y:t,width:1,height:1}},!1,!1,"edit");const D=Yo.current([R-b,t]);D.allowOverlay&&Ht(D)&&D.readonly!==!0&&n&&window.setTimeout(()=>{Xo.current(R,t)},0)};y()},Jo=t=>{var a,l;const n=((l=(a=Nt[t])==null?void 0:a.trailingRowOptions)==null?void 0:l.targetColumn)??(We==null?void 0:We.targetColumn);if(typeof n=="number")return n+(gt?1:0);if(typeof n=="object"){const h=V.indexOf(n);if(h>=0)return h+(gt?1:0)}},wt=c.useRef(void 0),Ot=c.useRef(void 0),jo=(t,n)=>{var h;const[a,l]=n;return sn(nt,(h=Ne[a])==null?void 0:h.themeOverride,Et==null?void 0:Et(l),t.themeOverride)},{mapper:Qo}=Yc(et,oe),Un=et==null?void 0:et.navigationBehavior,mo=c.useRef(void 0),Hl=t=>{var U,j,pe;const n=To.value?t.metaKey:t.ctrlKey,a=n&&J==="multi",[l,h]=t.location,w=K.columns,y=K.rows,[R,D]=((U=K.current)==null?void 0:U.cell)??[];if(t.kind==="cell"){if(Ot.current=void 0,mo.current=[l,h],l===(at?1:0)&&gt){if(Ye===!0&&h===Ie||ht==="number"||J==="none")return;const L=At(t.location);if(L.kind!==Lt.Marker||L.disabled===!0)return;if(Fo!==void 0){const ue=mt(L);ko((ue==null?void 0:ue.kind)===Lt.Marker);const ge=(j=ue==null?void 0:ue.onClick)==null?void 0:j.call(ue,{...t,cell:L,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,theme:jo(L,t.location),preventDefault:()=>{}});if(ge===void 0||ge.checked===L.checked)return}g(void 0),rt();const xe=y.hasIndex(h),Ce=wt.current;if(J==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&Ce!==void 0&&y.hasIndex(Ce)){const ue=[Math.min(Ce,h),Math.max(Ce,h)+1];a||Ft==="multi"?tt(void 0,ue,!0):tt(Se.fromSingleSelection(ue),void 0,a)}else J==="multi"&&(a||t.isTouch||Ft==="multi")?xe?tt(y.remove(h),void 0,!0):(tt(void 0,h,!0),wt.current=h):xe&&y.length===1?tt(Se.empty(),void 0,n):(tt(Se.fromSingleSelection(h),void 0,n),wt.current=h)}else if(l>=b&&Ye&&h===Ie){const L=Jo(l);Jt(L??l)}else if(R!==l||D!==h){const L=At(t.location),xe=mt(L);if((xe==null?void 0:xe.onSelect)!==void 0){let ge=!1;if(xe.onSelect({...t,cell:L,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,preventDefault:()=>ge=!0,theme:jo(L,t.location)}),ge)return}if(Un==="block"&&Qo(h).isGroupHeader)return;const Ce=Wo&&h===Ie,ue=Wo&&K!==void 0&&((pe=K.current)==null?void 0:pe.cell[1])===Ie;if((t.shiftKey||t.isLongTouch===!0)&&R!==void 0&&D!==void 0&&K.current!==void 0&&!ue){if(Ce)return;const ge=Math.min(l,R),Pe=Math.max(l,R),Te=Math.min(h,D),qe=Math.max(h,D);ut({...K.current,range:{x:ge,y:Te,width:Pe-ge+1,height:qe-Te+1}},!0,n,"click"),wt.current=void 0,rt()}else{const ge=K.rows.length>0;ut({cell:[l,h],range:{x:l,y:h,width:1,height:1}},!0,n||ge,"click"),wt.current=void 0,g(void 0),rt()}}}else if(t.kind==="header")if(mo.current=[l,h],g(void 0),gt&&l===(at?1:0))wt.current=void 0,Ot.current=void 0,!Rn&&J==="multi"&&(y.length!==Ie?tt(Se.fromSingleSelection([0,Ie]),void 0,n):tt(Se.empty(),void 0,n),rt());else{const he=Ot.current;if(Q==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&he!==void 0&&w.hasIndex(he)){const L=[Math.min(he,l),Math.max(he,l)+1];n||t.isTouch||It==="multi"?ot(void 0,L,n):ot(Se.fromSingleSelection(L),void 0,n)}else Q==="multi"&&(n||t.isTouch||It==="multi")?(w.hasIndex(l)?ot(w.remove(l),void 0,n):ot(void 0,l,n),Ot.current=l):Q!=="none"&&(w.hasIndex(l)?ot(w.remove(l),void 0,n):ot(Se.fromSingleSelection(l),void 0,n),Ot.current=l);wt.current=void 0,rt()}else t.kind===Bt?mo.current=[l,h]:t.kind===ar&&!t.isMaybeScrollbar&&(Pt(an,!1),g(void 0),rt(),to==null||to(),wt.current=void 0,Ot.current=void 0)},po={gridSelection:K,overlay:u,gridRef:_e,ghostInputRef:I,overlayRef:Me,ghostInputVisibleRef:se,scrollRef:$e,canvasRef:f,visibleRegionRef:pt,abortControllerRef:vt,rowMarkerOffset:b,mangledCols:Ne,mangledRows:lt,rows:Ie,setGridSelection:Pt,getMangledCellContent:At,mangledOnCellsEdited:ho,setOverlay:g,focus:rt,setGhostInputVisible:H,reselect:Ll,getCellRenderer:mt},{onMouseDown:Fl,onMouseUp:$l,onMouseMoveImpl:Gl,normalSizeColumn:_n,fillDown:Kl,fillRight:Pl,mouseDownData:dt,isActivelyDraggingHeader:Nl}=oa({state:po,mouseState:m,setMouseState:M,fillHighlightRegion:go,setFillHighlightRegion:Nn,setScrollDir:d,handleSelect:Hl,onMouseMove:Mt,onCellClicked:le,onCellActivated:B,onCellContextMenu:De,onHeaderContextMenu:be,onGroupHeaderContextMenu:fe,onHeaderClicked:A,onGroupHeaderClicked:Re,onColumnResize:Hn,onFillPattern:ce,cellActivationBehavior:kt,columnSelect:Q,columnSelectionMode:It,columns:Nt,groupLevels:Zt,mergedTheme:nt,minColumnWidth:qt,maxColumnWidth:Ko,themeForCell:jo,getCellsForSelection:Kt,setSelectedColumns:ot,visibleRegion:zt,lastMouseSelectLocation:mo}),[wo,en]=c.useState(),Wl=(t,n)=>{Je==null||Je(t-b,n)},Al=(t,n)=>{ft==null||ft(t-b,n)};c.useEffect(()=>{if(u===void 0)return;const t=l=>{const h=[];let w=l.parentElement;for(;w&&w!==document.documentElement;){const y=window.getComputedStyle(w),R=y.overflow+y.overflowY+y.overflowX;(R.includes("scroll")||R.includes("auto"))&&h.push(w),w=w.parentElement}return h},n=l=>{const h=l.target;$e.current&&!$e.current.contains(h)&&g(void 0)},a=[];if($e.current){const l=t($e.current);a.push(...l)}return a.forEach(l=>{l.addEventListener("scroll",n)}),window.addEventListener("scroll",n),document.addEventListener("scroll",n,!0),()=>{a.forEach(l=>{l.removeEventListener("scroll",n)}),window.removeEventListener("scroll",n),document.removeEventListener("scroll",n,!0)}},[u,g,$e]);const Ct=(nr=K==null?void 0:K.current)==null?void 0:nr.cell,Ol=(t,n,a,l,h,w)=>{if(fo.current=!1,u!==void 0){const j=pt.current;(j.x!==t.x||j.y!==t.y)&&g(void 0)}let y=Ct;y!==void 0&&(y=[y[0]-b,y[1]]);const R=Qe===0?void 0:{x:0,y:t.y,width:Qe,height:t.height},D=[];R!==void 0&&D.push(R),Tt>0&&(D.push({x:t.x-b,y:Ie-Tt,width:t.width,height:Tt}),Qe>0&&D.push({x:0,y:Ie-Tt,width:Qe,height:Tt}));const U={x:t.x-b,y:t.y,width:t.width,height:Ye&&t.y+t.height>=Ie?t.height-1:t.height,tx:h,ty:w,extras:{selected:y,freezeRegion:R,freezeRegions:D}};pt.current=U,El(U),Ml([n,a,l]),Lo==null||Lo(U,U.tx,U.ty,U.extras)},Vl=Rt(ie,(t,n)=>(ie==null?void 0:ie(t-b,n-b))!==!1),Bl=Rt(W,(t,n)=>{W==null||W(t-b,n-b),Q!=="none"&&ot(Se.fromSingleSelection(n),void 0,!0)}),tn=c.useRef(!1),Ul=t=>{if(t.location[0]===0&&b>0){t.preventDefault();return}ke==null||ke({...t,location:[t.location[0]-b,t.location[1]]}),t.defaultPrevented()||(tn.current=!0),M(void 0)},_l=()=>{tn.current=!1},Xl=et==null?void 0:et.selectionBehavior,Xn=t=>{if(Xl!=="block-spanning")return;const{isGroupHeader:n,path:a,groupRows:l}=Qo(t);if(n)return[t,t];const h=a[a.length-1],w=t-h,y=t+l-h-1;return[w,y]},on=c.useRef(void 0),Yn=t=>{var n,a,l;if(!Bi(t,on.current)&&(on.current=t,!(((n=dt==null?void 0:dt.current)==null?void 0:n.button)!==void 0&&dt.current.button>=1))){if(t.buttons!==0&&m!==void 0&&((a=dt.current)==null?void 0:a.location[0])===0&&b===1&&J==="multi"&&m.previousSelection&&!m.previousSelection.rows.hasIndex(dt.current.location[1])&&K.rows.hasIndex(dt.current.location[1])){const h=Math.min(dt.current.location[1],t.location[1]),w=Math.max(dt.current.location[1],t.location[1])+1;tt(Se.fromSingleSelection([h,w]),void 0,!1)}else if(t.buttons!==0&&m!==void 0&&K.current!==void 0&&!tn.current&&!Nl.current&&(Ve==="rect"||Ve==="multi-rect")){const[h,w]=K.current.cell;let[y,R]=t.location;if(R<0&&(R=pt.current.y),m.fillHandle===!0&&((l=m.previousSelection)==null?void 0:l.current)!==void 0){const D=m.previousSelection.current.range;R=Math.min(R,Ye?Ie-1:Ie);const U=Ui(D,y,R,Dr);Nn(U)}else{if(Ye&&w===Ie)return;if(Ye&&R===Ie)if(t.kind===ar)R--;else return;y=Math.max(y,b);const j=Xn(w);R=j===void 0?R:Dt(R,j[0],j[1]);const pe=y-h,ae=R-w,he={x:pe>=0?h:y,y:ae>=0?w:R,width:Math.abs(pe)+1,height:Math.abs(ae)+1};ut({...K.current,range:he},!0,!1,"drag")}}Do==null||Do({...t,location:[t.location[0]-b,t.location[1]]})}};Oc(s,$e,()=>{var y,R;const t=on.current;if(t===void 0)return;const[n,a]=t.scrollEdge;let[l,h]=t.location;const w=pt.current;n===-1?l=((R=(y=w.extras)==null?void 0:y.freezeRegion)==null?void 0:R.x)??w.x:n===1&&(l=w.x+w.width),a===-1?h=Math.max(0,w.y):a===1&&(h=Math.min(Ie-1,w.y+w.height)),l=Dt(l,0,Ne.length-1),h=Dt(h,0,Ie-1),Yn({...t,location:[l,h]})});const Yl=t=>{if(K.current===void 0)return;const[n,a]=t,[l,h]=K.current.cell,w=K.current.range;let y=w.x,R=w.x+w.width,D=w.y,U=w.y+w.height;const[j,pe]=Xn(h)??[0,Ie-1],ae=pe+1;if(a!==0)switch(a){case 2:{U=ae,D=h,Ae(0,U,"vertical");break}case-2:{D=j,U=h+1,Ae(0,D,"vertical");break}case 1:{D<h?(D++,Ae(0,D,"vertical")):(U=Math.min(ae,U+1),Ae(0,U,"vertical"));break}case-1:{U>h+1?(U--,Ae(0,U,"vertical")):(D=Math.max(j,D-1),Ae(0,D,"vertical"));break}default:ur()}if(n!==0)if(n===2)R=Ne.length,y=l,Ae(R-1-b,0,"horizontal");else if(n===-2)y=b,R=l+1,Ae(y-b,0,"horizontal");else{let he=[];if(Kt!==void 0){const L=Kt({x:y,y:D,width:R-y-b,height:U-D},vt.current.signal);typeof L=="object"&&(he=la(L))}if(n===1){let L=!1;if(y<l){if(he.length>0){const xe=Ut(y+1,l+1).find(Ce=>!he.includes(Ce-b));xe!==void 0&&(y=xe,L=!0)}else y++,L=!0;L&&Ae(y,0,"horizontal")}L||(R=Math.min(Ne.length,R+1),Ae(R-1-b,0,"horizontal"))}else if(n===-1){let L=!1;if(R>l+1){if(he.length>0){const xe=Ut(R-1,l,-1).find(Ce=>!he.includes(Ce-b));xe!==void 0&&(R=xe,L=!0)}else R--,L=!0;L&&Ae(R-b,0,"horizontal")}L||(y=Math.max(b,y-1),Ae(y-b,0,"horizontal"))}else ur()}ut({cell:K.current.cell,range:{x:y,y:D,width:R-y,height:U-D}},!0,!1,"keyboard-select")},nn=c.useRef(pn);nn.current=pn;const Co=(t,n,a,l)=>{const h=lt-(a?0:1);t=Dt(t,b,Nt.length-1+b),n=Dt(n,0,h);const w=Ct==null?void 0:Ct[0],y=Ct==null?void 0:Ct[1];if(t===w&&n===y)return!1;if(l&&K.current!==void 0){const R=[...K.current.rangeStack];(K.current.range.width>1||K.current.range.height>1)&&R.push(K.current.range),Pt({...K,current:{cell:[t,n],range:{x:t,y:n,width:1,height:1},rangeStack:R}},!0)}else ut({cell:[t,n],range:{x:t,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return p.current!==void 0&&p.current[0]===t&&p.current[1]===n&&(p.current=void 0),nn.current&&Ae(t-b,n,"both",0,20),!0},qn=(t,n)=>{var j,pe,ae,he;const a=Me.current;se.current;let l=t;const h=((j=I.current)==null?void 0:j.getValue())??"",w=((pe=a==null?void 0:a.content)==null?void 0:pe.kind)===Z.Custom;if((a==null?void 0:a.cell)!==void 0&&h.length>0&&a.content!==void 0&&!w){const L=a.content;if(L.kind===Z.Text)l={...L,data:h,displayData:h};else if(L.kind===Z.Number){const xe=Number.parseFloat(h),Ce=Number.isNaN(xe)?0:xe;l={...L,data:Ce,displayData:Ce.toLocaleString()}}else L.kind===Z.Uri?l={...L,data:h,displayData:h}:L.kind===Z.Markdown&&(l={...L,data:h})}else w&&(l=t);if(l!==void 0&&h.length===0)if(l.kind===Z.Text&&l.data!==l.displayData)l={...l,displayData:l.data};else if(l.kind===Z.Number){const L=l.data!==void 0?l.data.toLocaleString():"0";l.displayData!==L&&(l={...l,displayData:L})}else l.kind===Z.Uri&&l.data!==l.displayData&&(l={...l,displayData:l.data});const y=a==null?void 0:a.content,R=()=>{if(l===void 0||y===void 0)return!1;if(l.kind!==y.kind)return!0;switch(l.kind){case Z.Text:case Z.Uri:case Z.Markdown:return l.data!==y.data;case Z.Number:return l.data!==y.data;case Z.Boolean:return l.data!==y.data;default:return!0}};(a==null?void 0:a.cell)!==void 0&&l!==void 0&&jt(l)&&R()&&(ho([{location:a.cell,value:l}]),window.requestAnimationFrame(()=>{var L;(L=_e.current)==null||L.damage([{cell:a.cell}])})),(ae=I.current)==null||ae.clear(),(he=I.current)==null||he.setVisible(!1),H(!1),rt(!0),Me.current=void 0,g(void 0);const[D,U]=n;if(K.current!==void 0&&(D!==0||U!==0)){const L=K.current.cell[1]===lt-1;if(L&&U===1){G==null||G(t,[0,0]);return}const xe=K.current.cell[0]===Ne.length-1&&t!==void 0;let Ce=!0;if(L&&U===1&&C!==void 0){Ce=!1;const ue=K.current.cell[0]+D,ge=Jo(ue);Jt(ge??ue,!1)}if(xe&&D===1&&we!==void 0){Ce=!1;const ue=K.current.cell[1]+U;Zo(ue,!1)}if(Ce){const ue=Dt(K.current.cell[0]+D,b,Ne.length-1),ge=Dt(K.current.cell[1]+U,0,lt-1);Co(ue,ge,L,!1),window.requestAnimationFrame(()=>{var Pe;(Pe=I.current)==null||Pe.focus()})}}G==null||G(t,n)},[ql]=c.useState(()=>`gdg-overlay-${ra++}`),Zn=t=>{var a,l,h,w;rt();const n=[];for(let y=t.x;y<t.x+t.width;y++)for(let R=t.y;R<t.y+t.height;R++){const D=$([y-b,R]);if(!D.allowOverlay&&D.kind!==Z.Boolean)continue;let U;if(D.kind===Z.Custom){const j=mt(D),pe=(a=j==null?void 0:j.provideEditor)==null?void 0:a.call(j,{...D,location:[y-b,R]});(j==null?void 0:j.onDelete)!==void 0?U=j.onDelete(D):qi(pe)&&(U=(l=pe==null?void 0:pe.deletedValue)==null?void 0:l.call(pe,D))}else if(jt(D)&&D.allowOverlay||D.kind===Z.Boolean){const j=mt(D);U=(h=j==null?void 0:j.onDelete)==null?void 0:h.call(j,D)}U!==void 0&&!Io(U)&&jt(U)&&n.push({location:[y,R],value:U})}ho(n),(w=_e.current)==null||w.damage(n.map(y=>({cell:y.location})))},Zl=u!==void 0,{onKeyDown:Vt}=Hc({state:po,keybindings:Dn,overlayOpen:Zl,columnSelect:Q,rowSelect:J,rangeSelect:Ve,editOnType:_t,trapFocus:qr,showTrailingBlankRow:Ye,columnsInLength:V.length,rowGroupingNavBehavior:Un,mapper:Qo,onKeyDownIn:ct,onSelectionCleared:to,onCellActivated:B,onDelete:Fn,getCellContent:$,setSelectedColumns:ot,setSelectedRows:tt,setShowSearchInner:Ln,searchInputRef:k,adjustSelection:Yl,updateSelectedCell:Co,deleteRange:Zn,fillDown:Kl,fillRight:Pl,appendRow:Jt,getCustomNewRowTargetColumn:Jo,scrollToRef:vo}),[Jl,Jn]=c.useState(!1),jn=c.useRef(Pi(t=>{Jn(t)},5)),{onGhostInput:jl,onGhostCompositionStart:Ql,onGhostCompositionEnd:ei,onGhostKeyDown:ti,onGhostKeyUp:oi,onGhostFocus:ni,onGhostBlur:ri}=ta({state:po,onKeyDown:Vt,onFinishEditing:qn,onKeyUpIn:Ze,onCellActivated:B,setIsFocused:Jn}),li=(t,n)=>{const a=t.location[0]-b;if(t.kind==="header"&&(be==null||be(a,{...t,preventDefault:n})),t.kind===Bt){if(a<0)return;fe==null||fe(a,{...t,preventDefault:n})}if(t.kind==="cell"){const[l,h]=t.location;De==null||De([a,h],{...t,preventDefault:n}),Xi(K,t.location)||Co(l,h,!1,!1)}},{onCopy:Qn,onPasteInternal:er}=Vc({state:po,keybindings:Dn,getCellsForSelection:Kt,coercePasteValue:T,onPaste:Qt,copyHeaders:eo,columnsIn:V,onDelete:Fn,deleteRange:Zn,safeWindow:_}),ii=(t,n)=>{if(Ue!==void 0){b!==0&&(t=t.map(h=>[h[0]-b,h[1]])),Ue(t,n);return}if(t.length===0||n===-1)return;const[a,l]=t[n];p.current!==void 0&&p.current[0]===a&&p.current[1]===l||(p.current=[a,l],Co(a,l,!1,!1))},[yo,bo]=((rr=$t==null?void 0:$t.current)==null?void 0:rr.cell)??[];c.useLayoutEffect(()=>{var t,n,a,l;nn.current&&!fo.current&&yo!==void 0&&bo!==void 0&&(yo!==((n=(t=uo.current)==null?void 0:t.current)==null?void 0:n.cell[0])||bo!==((l=(a=uo.current)==null?void 0:a.current)==null?void 0:l.cell[1]))&&vo.current(yo,bo),fo.current=!1},[yo,bo]);const tr=K.current!==void 0&&(K.current.cell[0]>=Ne.length||K.current.cell[1]>=lt);c.useLayoutEffect(()=>{tr&&Pt(an,!1)},[tr,Pt]);const si=Ye===!0&&(We==null?void 0:We.tint)===!0?Se.fromSingleSelection(lt-1):Se.empty(),ci=t=>typeof Yt=="boolean"?Yt:(Yt==null?void 0:Yt(t-b))??!0,ai=wo===void 0||f.current===null?null:c.createElement(Ec,{bounds:wo.bounds,group:wo.group,canvasBounds:f.current.getBoundingClientRect(),onClose:()=>en(void 0),onFinish:t=>{en(void 0),E==null||E(wo.group,t)}}),ui=Math.min(Ne.length,Qe+b);c.useImperativeHandle(o,()=>({appendRow:(t,n)=>Jt(t+b,n),appendColumn:(t,n)=>Zo(t,n),updateCells:t=>{var n;return b!==0&&(t=t.map(a=>({cell:[a.cell[0]+b,a.cell[1]]}))),(n=_e.current)==null?void 0:n.damage(t)},getBounds:(t,n)=>{var a;if(!((f==null?void 0:f.current)===null||($e==null?void 0:$e.current)===null)){if(t===void 0&&n===void 0){const l=f.current.getBoundingClientRect(),h=l.width/$e.current.clientWidth;return{x:l.x-$e.current.scrollLeft*h,y:l.y-$e.current.scrollTop*h,width:$e.current.scrollWidth*h,height:$e.current.scrollHeight*h}}return(a=_e.current)==null?void 0:a.getBounds((t??0)+b,n)}},focus:()=>{var t;return(t=_e.current)==null?void 0:t.focus()},emit:async t=>{switch(t){case"delete":Vt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Vt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Vt({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Qn(void 0,!0);break;case"paste":await er();break}},scrollTo:Ae,remeasureColumns:t=>{for(const n of t)_n(n+b)},getMouseArgsForPosition:(t,n,a)=>{if((_e==null?void 0:_e.current)===null)return;const l=_e.current.getMouseArgsForPosition(t,n,a);if(l!==void 0)return{...l,location:[l.location[0]-b,l.location[1]]}}}),[Jt,Zo,_n,$e,Qn,Vt,er,b,Ae]);const[di,fi]=Ct??[],hi=t=>{const[n,a]=t;if(a===-1){Q!=="none"&&(ot(Se.fromSingleSelection(n),void 0,!1),rt());return}di===n&&fi===a||(ut({cell:t,range:{x:n,y:a,width:1,height:1}},!0,!1,"keyboard-nav"),Ae(n,a))},gi=()=>{jn.current(!0),K.current===void 0&&K.columns.length===0&&K.rows.length===0&&m===void 0&&ut({cell:[b,Vo],range:{x:b,y:Vo,width:1,height:1}},!0,!1,"keyboard-select")},vi=()=>{jn.current(!1)},[mi,pi]=(()=>{let t;const n=(Xe==null?void 0:Xe.scrollbarWidthOverride)??Ni(),a=Ie+(Ye?1:0);if(typeof Gt=="number")t=Oo+a*Gt;else{let h=0;const w=Math.min(a,10);for(let y=0;y<w;y++)h+=Gt(y);h=Math.floor(h/w),t=Oo+a*h}t+=n;const l=Ne.reduce((h,w)=>w.width+h,0)+n;return[`${Math.min(1e5,l)}px`,`${Math.min(1e5,t)}px`]})(),wi=Wi(nt);return c.createElement(Ai.Provider,{value:nt},c.createElement(Nc,{style:wi,className:Ge,inWidth:O??mi,inHeight:F??pi},c.createElement(kc,{fillHandle:Gr,drawFocusRing:Cn,experimental:Xe,fixedShadowX:Kr,fixedShadowY:Pr,getRowThemeOverride:Et,headerIcons:Nr,imageWindowLoader:Wr,initialSize:Ar,isDraggable:Or,onDragLeave:Vr,onRowMoved:Fo,overscrollX:gl,overscrollY:vl,preventDiagonalScrolling:_r,rightElement:Xr,rightElementProps:Yr,smoothScrollX:Zr,smoothScrollY:Jr,className:Ge,enableGroups:Gn,onCanvasFocused:gi,onCanvasBlur:vi,canvasRef:f,onContextMenu:li,theme:nt,cellXOffset:zl,cellYOffset:Vo,accessibilityHeight:zt.height,onDragEnd:_l,columns:Ne,nonGrowWidth:$n,drawHeader:Rl,onColumnProposeMove:Vl,drawCell:Sl,disabledRows:si,freezeColumns:ui,lockColumns:b,firstColAccessible:b===0,getCellContent:At,minColumnWidth:qt,maxColumnWidth:Ko,searchInputRef:k,showSearch:pl,onSearchClose:wl,highlightRegions:Dl,getCellsForSelection:Kt,getGroupDetails:An,headerHeight:En,isFocused:Jl,groupHeaderHeight:Gn?zn:0,groupLevels:Zt,groupHeaderHeights:Kn,freezeTrailingRows:Tt+(Ye&&(We==null?void 0:We.sticky)===!0?1:0),hasAppendRow:Ye,onColumnResize:Hn,onColumnResizeEnd:bl,onColumnResizeStart:xl,onCellFocused:hi,onColumnMoved:Bl,onDragStart:Ul,onHeaderMenuClick:Wl,onHeaderIndicatorClick:Al,onItemHovered:Yn,isFilling:(m==null?void 0:m.fillHandle)===!0,onMouseMove:Gl,onKeyDown:Vt,onKeyUp:Ze,onMouseDown:Fl,onMouseUp:$l,onDragOverCell:Fr,onDrop:$r,onSearchResultsChanged:ii,onVisibleRegionChanged:Ol,clientSize:Ao,rowHeight:Gt,searchResults:N,searchValue:q,onSearchValueChange:re,rows:lt,scrollRef:$e,selection:K,translateX:zt.tx,translateY:zt.ty,verticalBorder:ci,gridRef:_e,getCellRenderer:mt,resizeIndicator:nl}),ai,u!==void 0&&c.createElement(c.Suspense,{fallback:null},c.createElement(na,{...u,validateCell:yl,bloom:ve,id:ql,getCellRenderer:mt,className:(Xe==null?void 0:Xe.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:zr,imageEditorOverride:z,portalElementRef:lo,onFinishEditing:qn,markdownDivCreateNode:S,isOutsideClick:ol,customEventTarget:Xe==null?void 0:Xe.eventTarget,isGhostMode:P}))),(()=>{const t=(lo==null?void 0:lo.current)??document.getElementById("portal");return t===null?null:yi.createPortal(c.createElement(Qc,{ref:I,onInput:jl,onCompositionStart:Ql,onCompositionEnd:ei,onKeyDown:ti,onKeyUp:oi,onFocus:ni,onBlur:ri}),t)})())},sa=c.forwardRef(ia),ca=(e,o)=>{const r=c.useMemo(()=>({...yc,...e.headerIcons}),[e.headerIcons]),i=c.useMemo(()=>e.renderers??Zi,[e.renderers]),u=c.useMemo(()=>e.imageWindowLoader??new Ji,[e.imageWindowLoader]);return c.createElement(sa,{...e,renderers:i,headerIcons:r,ref:o,imageWindowLoader:u})},wa=c.forwardRef(ca);export{wa as D,bt as k,pa as n,Yc as u};
