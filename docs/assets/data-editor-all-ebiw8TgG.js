const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-Dbz3weqL.js","./iframe-DelEik1u.js","./preload-helper-C1FmrZbK.js","./marked.esm-RnuSlOMI.js","./react-number-format.es-CF0K8sOF.js","./index-DDKwlnpI.js","./throttle-B8GU50-r.js","./flatten-C5fNT6Z1.js"])))=>i.map(i=>d[i]);
import{r as s,R as Un}from"./iframe-DelEik1u.js";import{_ as au}from"./preload-helper-C1FmrZbK.js";import{r as du}from"./index-DDKwlnpI.js";import{h as $s,g as cu,j as Gs,k as Xs,v as Ks,l as Ys,m as xn,r as Ro,t as Vs}from"./throttle-B8GU50-r.js";import{u as Us,f as Pr}from"./flatten-C5fNT6Z1.js";import{s as nn,a as js}from"./marked.esm-RnuSlOMI.js";function fu(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"This should not happen";throw new Error(e)}function vn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Assertion failed";if(!e)return fu(t)}function Fl(e,t){return fu(t??"Hell froze over")}function qs(e,t){try{return e()}catch{return t}}const Lr=Object.prototype.hasOwnProperty;function el(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&el(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Lr.call(e,n)&&++o&&!Lr.call(t,n)||!(n in t)||!el(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}var tl;const ii=null,Qi=void 0;var ie;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(ie||(ie={}));var Or;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(Or||(Or={}));var ri;(function(e){e.Triangle="triangle",e.Dots="dots"})(ri||(ri={}));function _l(e){return"width"in e&&typeof e.width=="number"}async function Wr(e){return typeof e=="object"?e:await e()}function jn(e){return!(e.kind===ie.Loading||e.kind===ie.Bubble||e.kind===ie.RowID||e.kind===ie.Protected||e.kind===ie.Drilldown)}function ff(e){return!(e.kind===ie.Loading||e.kind===ie.Bubble||e.kind===ie.RowID||e.kind===ie.Protected||e.kind===ie.Drilldown||e.kind===ie.Boolean||e.kind===ie.Image||e.kind===ie.Custom)}function Ao(e){return e.kind===$t.Marker||e.kind===$t.NewRow||e.kind===$t.RowStatus}function vo(e){if(!jn(e)||e.kind===ie.Image)return!1;switch(e.kind){case ie.Text:case ie.Number:case ie.Markdown:case ie.Uri:case ie.Custom:case ie.Boolean:return e.readonly!==!0;default:Fl(e,"A cell was passed with an invalid kind")}}function hu(e){return $s(e,"editor")}function _i(e){var t;return!((t=e.readonly)!==null&&t!==void 0&&t)}var $t;(function(e){e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id"})($t||($t={}));const ui={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function er(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,l){return o[0]-l[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const l=n[n.length-1];l[1]<o[0]?n.push([...o]):l[1]<o[1]&&(l[1]=o[1])}return n}let ei;class tt{constructor(t){this.items=void 0,this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new tt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=er([...this.items,n]);return new tt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],l=typeof t=="number"?t+1:t[1];for(const[i,u]of n.entries()){const[r,a]=u;if(r<=l&&o<=a){const d=[];r<o&&d.push([r,o]),l<a&&d.push([l,a]),n.splice(i,1,...d)}}return new tt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,l]=this.items[n];if(t>=o&&t<l)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],l=this.items[n];if(o[0]!==l[0]||o[1]!==l[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let l=n;l<o;l++)t.push(l);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}}tl=tt;tt.create=e=>new tl(er(e));tt.empty=()=>ei??(ei=new tl([]));tt.fromSingleSelection=e=>tl.empty().add(e);tt.fromArray=e=>{if(e.length===0)return tl.empty();const t=e.map(o=>[o,o+1]),n=er(t);return new tl(n)};const Zs=nn("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function tn(e,t,n,o){let l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const u=n,r=a=>{var d;(d=i.current)===null||d===void 0||d.call(u,a)};return u.addEventListener(e,r,{passive:o,capture:l}),()=>{u.removeEventListener(e,r,{capture:l})}},[e,n,o,l])}function fo(e,t){return e===void 0?void 0:t}const Js=Math.PI;function Nr(e){return e*Js/180}const gu=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),vu=(e,t,n,o,l)=>{switch(e){case"left":return Math.floor(t)+o+l/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-l/2}},mu=(e,t,n)=>Math.min(e,t-n*2),wu=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,tr=e=>{var t;const n=(t=e.fgColor)!==null&&t!==void 0?t:"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:n,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:n,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Qs=e=>{var t;const n=(t=e.fgColor)!==null&&t!==void 0?t:"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:n,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function _s(e,t,n){const[o,l]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const u=s.useRef(cu(r=>{i.current&&l(r)},n));return s.useLayoutEffect(()=>{i.current&&u.current(()=>e())},t),o}const ea="֑-߿יִ-﷽ﹰ-ﻼ",ta="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",na=new RegExp("^[^"+ta+"]*["+ea+"]");function nr(e){return na.test(e)?"rtl":"not-rtl"}let ti;function Yi(){if(typeof document>"u")return 0;if(ti!==void 0)return ti;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),ti=n-o,ti}const Mo=Symbol();function oa(e){const t=s.useRef([Mo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,l]=s.useState(),i=s.useCallback(r=>{const a=t.current[0];a!==Mo&&(r=typeof r=="function"?r(a):r,r===a)||(a!==Mo&&l({}),o(d=>typeof r=="function"?r(a===Mo?d:a):r),t.current[0]=Mo)},[]),u=s.useCallback(()=>{t.current[0]=Mo,l({})},[]);return[t.current[0]===Mo?n:t.current[0],i,u]}function pu(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function la(e){const t=s.useRef(e);return el(e,t.current)||(t.current=e),t.current}const ia=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:l}=e,i=t.filter(r=>r!=="");if(i.length===0)return null;const u=i.length>1;return s.createElement(Zs,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(Gs.Carousel,{showArrows:u,showThumbs:!1,swipeable:u,emulateTouch:u,infiniteLoop:u},i.map(r=>{var a;const d=(a=l==null?void 0:l(r))!==null&&a!==void 0?a:s.createElement("img",{draggable:!1,src:r});return s.createElement("div",{className:"gdg-centering-container",key:r},d)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(tr,null)))},ra=nn("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class ua extends Un.PureComponent{constructor(){super(...arguments),this.targetElement=null,this.containerRefHook=t=>{this.targetElement=t,this.renderMarkdownIntoDiv()}}renderMarkdownIntoDiv(){const{targetElement:t,props:n}=this;if(t===null)return;const{contents:o,createNode:l}=n,i=js(o),u=document.createRange();u.selectNodeContents(t),u.deleteContents();let r=l==null?void 0:l(i);if(r===void 0){const d=document.createElement("template");d.innerHTML=i,r=d.content}t.append(r);const a=t.getElementsByTagName("a");for(const d of a)d.target="_blank",d.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Un.createElement(ra,{ref:this.containerRefHook})}}const sa=nn("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),aa=nn("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),da=nn("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});class Cu extends s.PureComponent{constructor(){super(...arguments),this.wrapperRef=s.createRef(),this.clickOutside=t=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(t))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(t.target)){let n=t.target;for(;n!==null;){if(n.classList.contains("click-outside-ignore"))return;n=n.parentElement}this.props.onClickOutside()}}}componentDidMount(){var t;const n=(t=this.props.customEventTarget)!==null&&t!==void 0?t:document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){var t;const n=(t=this.props.customEventTarget)!==null&&t!==void 0?t:document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:t,isOutsideClick:n,customEventTarget:o,...l}=this.props;return s.createElement("div",{...l,ref:this.wrapperRef},this.props.children)}}const Li={};let so=null;function ca(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function nl(e){const t=e.toLowerCase().trim();if(Li[t]!==void 0)return Li[t];so=so||ca(),so.style.color="#000",so.style.color=t;const n=getComputedStyle(so).color;so.style.color="#fff",so.style.color=t;const o=getComputedStyle(so).color;if(o!==n)return[0,0,0,1];let l=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return l.length<4&&l.push(1),l=l.map(i=>Number.isNaN(i)?0:i),Li[t]=l,l}function mo(e,t){const[n,o,l]=nl(e);return`rgba(${n}, ${o}, ${l}, ${t})`}const $r=new Map;function Gr(e,t){const n=`${e}-${t}`,o=$r.get(n);if(o!==void 0)return o;const l=mn(e,t);return $r.set(n,l),l}function mn(e,t){if(t===void 0)return e;const[n,o,l,i]=nl(e);if(i===1)return e;const[u,r,a,d]=nl(t),c=i+d*(1-i),h=(i*n+d*u*(1-i))/c,v=(i*o+d*r*(1-i))/c,m=(i*l+d*a*(1-i))/c;return`rgba(${h}, ${v}, ${m}, ${c})`}function hf(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,l,i,u]=nl(e),[r,a,d,c]=nl(t),h=o*u,v=l*u,m=i*u,f=r*c,w=a*c,C=d*c,p=n,g=1-n,b=u*g+c*p;if(b===0)return"rgba(0, 0, 0, 0)";const k=Math.floor((h*g+f*p)/b),x=Math.floor((v*g+w*p)/b),M=Math.floor((m*g+C*p)/b);return`rgba(${k}, ${x}, ${M}, ${b})`}function gf(e){if(e==="transparent")return 0;function t(i){const u=i/255;return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}const[n,o,l]=nl(e);return .2126*t(n)+.7152*t(o)+.0722*t(l)}function bu(e){var t,n,o,l;return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":(t=e.textGroupHeader)!==null&&t!==void 0?t:e.textHeader,"--gdg-bg-group-header":(n=e.bgGroupHeader)!==null&&n!==void 0?n:e.bgHeader,"--gdg-bg-group-header-hovered":(o=e.bgGroupHeaderHovered)!==null&&o!==void 0?o:e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":(l=e.horizontalBorderColor)!==null&&l!==void 0?l:e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const yu={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function Eu(){return yu}const or=Un.createContext(yu);function vf(){return Un.useContext(or)}function On(e){const t={...e};for(var n=arguments.length,o=new Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];for(const i of o)if(i!==void 0)for(const u in i)i.hasOwnProperty(u)&&(u==="bgCell"?t[u]=mn(i[u],t[u]):t[u]=i[u]);return(t.headerFontFull===void 0||e.fontFamily!==t.fontFamily||e.headerFontStyle!==t.headerFontStyle)&&(t.headerFontFull=`${t.headerFontStyle} ${t.fontFamily}`),(t.baseFontFull===void 0||e.fontFamily!==t.fontFamily||e.baseFontStyle!==t.baseFontStyle)&&(t.baseFontFull=`${t.baseFontStyle} ${t.fontFamily}`),(t.markerFontFull===void 0||e.fontFamily!==t.fontFamily||e.markerFontStyle!==t.markerFontStyle)&&(t.markerFontFull=`${t.markerFontStyle} ${t.fontFamily}`),t}const fa=()=>e=>e.targetX,ha=()=>e=>e.targetY,ga=()=>e=>e.targetWidth,va=()=>e=>e.targetHeight,ma=()=>e=>e.targetY+10,wa=()=>e=>Math.max(0,(e.targetHeight-28)/2),pa=nn("div")({name:"DataGridOverlayEditorStyle",class:"gdg-d19meir1",propsAsIs:!1,vars:{"d19meir1-0":[ha(),"px"],"d19meir1-1":[fa(),"px"],"d19meir1-2":[ga(),"px"],"d19meir1-3":[va(),"px"],"d19meir1-4":[ma(),"px"],"d19meir1-5":[wa(),"px"]}});var ku={exports:{}},xu={};/**
 * @license React
 * react-compiler-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ca=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;xu.c=function(e){return Ca.H.useMemoCache(e)};ku.exports=xu;var jt=ku.exports;function ba(){const e=jt.c(2),[t,n]=s.useState(),o=t??void 0;let l;return e[0]!==o?(l=[o,n],e[0]=o,e[1]=l):l=e[1],l}function ya(){const e=jt.c(12),[t,n]=ba(),[o,l]=s.useState(0),[i,u]=s.useState(!0);let r,a;e[0]!==t?(r=()=>{if(t===void 0||!("IntersectionObserver"in window))return;const w=new IntersectionObserver(C=>{C.length!==0&&u(C[0].isIntersecting)},{threshold:1});return w.observe(t),()=>w.disconnect()},a=[t],e[0]=t,e[1]=r,e[2]=a):(r=e[1],a=e[2]),s.useLayoutEffect(r,a);let d,c;e[3]!==i||e[4]!==t?(d=()=>{if(i||t===void 0)return;let w;const C=()=>{const{right:p}=t.getBoundingClientRect();l(g=>Math.min(g+window.innerWidth-p-10,0)),w=requestAnimationFrame(C)};return w=requestAnimationFrame(C),()=>{w!==void 0&&cancelAnimationFrame(w)}},c=[t,i],e[3]=i,e[4]=t,e[5]=d,e[6]=c):(d=e[5],c=e[6]),s.useEffect(d,c);const h=`translateX(${o}px)`;let v;e[7]!==h?(v={transform:h},e[7]=h,e[8]=v):v=e[8];const m=v;let f;return e[9]!==n||e[10]!==m?(f={ref:n,style:m},e[9]=n,e[10]=m,e[11]=f):f=e[11],f}const ll=s.createContext({isGhostMode:!1,ghostValue:""}),Ea=e=>{var t,n,o;const{target:l,content:i,onFinishEditing:u,forceEditMode:r,initialValue:a,imageEditorOverride:d,markdownDivCreateNode:c,highlight:h,className:v,theme:m,id:f,cell:w,bloom:C,portalElementRef:p,validateCell:g,getCellRenderer:b,provideEditor:k,isOutsideClick:x,customEventTarget:M,activation:B,ghostValue:R,isGhostMode:F}=e,[D,I]=s.useState(r?i:void 0),T=s.useRef(D??i);T.current=D??i;const[z,E]=s.useState(()=>g===void 0?!0:!(jn(i)&&(g==null?void 0:g(w,i,T.current))===!1)),S=s.useCallback((te,Be)=>{u(z?te:void 0,Be)},[z,u]),W=s.useCallback(te=>{if(g!==void 0&&te!==void 0&&jn(te)){const Be=g(w,te,T.current);Be===!1?E(!1):(typeof Be=="object"&&(te=Be),E(!0))}I(te)},[w,g]),N=s.useRef(!1),J=s.useRef(void 0),G=s.useCallback(()=>{S(D,[0,0]),N.current=!0},[D,S]),j=s.useCallback((te,Be)=>{var Ye;console.log("[onEditorFinished] newValue:",te),console.log("[onEditorFinished] movement:",Be),console.log("[onEditorFinished] calling onFinishEditing"),S(te,(Ye=Be??J.current)!==null&&Ye!==void 0?Ye:[0,0]),console.log("[onEditorFinished] onFinishEditing called"),N.current=!0},[S]),_=s.useCallback(async te=>{if(te.nativeEvent.isComposing)return;let Be=!1;te.key==="Escape"?(te.stopPropagation(),te.preventDefault(),J.current=[0,0]):te.key==="Enter"&&!te.shiftKey?(te.stopPropagation(),te.preventDefault(),J.current=[0,1],Be=!0):te.key==="Tab"&&(te.stopPropagation(),te.preventDefault(),J.current=[te.shiftKey?-1:1,0],Be=!0),window.setTimeout(()=>{!N.current&&J.current!==void 0&&(S(Be?D:void 0,J.current),N.current=!0)},0)},[S,D]),Y=D??i,[V,ee]=s.useMemo(()=>{var te,Be;if(Ao(i))return[];const Ye={...i,location:w,activation:B},ce=k==null?void 0:k(Ye);return ce!==void 0?[ce,!1]:[(te=b(i))===null||te===void 0||(Be=te.provideEditor)===null||Be===void 0?void 0:Be.call(te,Ye),!1]},[w,i,b,k,B]),{ref:de,style:me}=ya();let $=!0,Ce,O=!0,ve;if(V!==void 0){$=V.disablePadding!==!0,O=V.disableStyling!==!0;const te=hu(V);te&&(ve=V.styleOverride);const Be=te?V.editor:V;Ce=s.createElement(Be,{portalElementRef:p,isHighlighted:h,activation:B,onChange:W,value:Y,initialValue:a,onFinishedEditing:j,validatedSelection:jn(Y)?Y.selectionRange:void 0,forceEditMode:r,target:l,imageEditorOverride:d,markdownDivCreateNode:c,isValid:z,theme:m})}ve={...ve,...me};const Q=s.useMemo(()=>({isGhostMode:F??!1,ghostValue:R??""}),[F,R]),he=(t=p==null?void 0:p.current)!==null&&t!==void 0?t:document.getElementById("portal");if(he===null)return console.error('Cannot open Data Grid overlay editor, because portal not found. Please, either provide a portalElementRef or add `<div id="portal" />` as the last child of your `<body>`.'),null;let U=O?"gdg-style":"gdg-unstyle";z||(U+=" gdg-invalid"),$&&(U+=" gdg-pad");const ae=(n=C==null?void 0:C[0])!==null&&n!==void 0?n:1,ke=(o=C==null?void 0:C[1])!==null&&o!==void 0?o:1;return du.createPortal(s.createElement(or.Provider,{value:m},s.createElement(ll.Provider,{value:Q},s.createElement(Cu,{style:bu(m),className:v,onClickOutside:G,isOutsideClick:x,customEventTarget:M},s.createElement(pa,{ref:de,id:f,className:U,style:F?{...ve,visibility:"hidden"}:ve,as:ee===!0?"label":void 0,targetX:l.x-ae,targetY:l.y-ke,targetWidth:l.width+ae*2,targetHeight:l.height+ke*2},s.createElement("div",{className:"gdg-clip-region",onKeyDown:_},Ce))))),he)},ka=Object.freeze(Object.defineProperty({__proto__:null,GhostModeContext:ll,default:Ea},Symbol.toStringTag,{value:"Module"}));let Xr=0;const lr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:l,altNewline:i,validatedSelection:u,autoFocus:r,...a}=e,{onChange:d,className:c}=a,h=s.useRef(null),{isGhostMode:v,ghostValue:m}=s.useContext(ll),f=v&&m?m:n??"";vn(d!==void 0,"GrowingEntry must be a controlled input area");const[w]=s.useState(()=>"input-box-"+(Xr=(Xr+1)%1e7));s.useEffect(()=>{if(v)return;const g=h.current;if(g===null||g.disabled)return;const b=f.toString().length;g.focus(),g.setSelectionRange(l?0:b,b)},[v]),s.useLayoutEffect(()=>{if(u!==void 0){var g;const b=typeof u=="number"?[u,null]:u;(g=h.current)===null||g===void 0||g.setSelectionRange(b[0],b[1])}},[u]);const C=s.useCallback(g=>{g.key==="Enter"&&g.shiftKey&&i===!0||o==null||o(g)},[i,o]),p=v?{visibility:"hidden"}:void 0;return s.createElement(da,{className:"gdg-growing-entry"},s.createElement(aa,{className:c},f+`
`),s.createElement(sa,{...a,className:(c??"")+" gdg-input",id:w,ref:h,onKeyDown:C,value:f,placeholder:t,dir:"auto",style:p}))};function xa(e,t){const n=jt.c(5);let o;if(n[0]!==e||n[1]!==t){let l;n[3]!==t?(l=(i,u)=>({group:i.group,grow:i.grow,hasMenu:i.hasMenu,icon:i.icon,id:i.id,menuIcon:i.menuIcon,overlayIcon:i.overlayIcon,sourceIndex:u,sticky:u<t,indicatorIcon:i.indicatorIcon,style:i.style,themeOverride:i.themeOverride,title:i.title,trailingRowOptions:i.trailingRowOptions,width:i.width,growOffset:i.growOffset,rowMarker:i.rowMarker,rowMarkerChecked:i.rowMarkerChecked,headerRowMarkerTheme:i.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:i.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:i.headerRowMarkerDisabled,rowGroupBorder:i.rowGroupBorder,required:i.required}),n[3]=t,n[4]=l):l=n[4],o=e.map(l),n[0]=e,n[1]=t,n[2]=o}else o=n[2];return o}function Fa(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(kl(e.current.cell,t))return!0;const l=[e.current.range,...e.current.rangeStack];for(const i of l)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function Bo(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Vi(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function Fu(e,t){const n=Bo(e),o=Bo(t);return n===o}function si(e,t,n,o){for(let u=0;u<=n;u++){var l,i;const r=(l=Vi(e,u,o))!==null&&l!==void 0?l:"",a=(i=Vi(t,u,o))!==null&&i!==void 0?i:"";if(r!==a)return!1}return!0}function Da(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Du(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function kl(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Su(e){return[e.x+e.width-1,e.y+e.height-1]}function Kr(e,t,n){const o=n.x,l=n.x+n.width-1,i=n.y,u=n.y+n.height-1,[r,a]=e;if(a<i||a>u)return!1;if(t.span===void 0)return r>=o&&r<=l;const[d,c]=t.span;return d>=o&&d<=l||c>=o&&d<=l||d<o&&c>l}function Sa(e,t,n,o){let l=0;if(n.current===void 0)return l;const i=n.current.range;(o||i.height*i.width>1)&&Kr(e,t,i)&&l++;for(const u of n.current.rangeStack)Kr(e,t,u)&&l++;return l}function Mu(e,t){let n=e;if(t!==void 0){let o=[...e];const l=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,l)):(o.splice(t.dest+1,0,l),o.splice(t.src,1)),o=o.map((i,u)=>({...i,sticky:e[u].sticky})),n=o}return n}function ol(e,t){let n=0;const o=Mu(e,t);for(let l=0;l<o.length;l++){const i=o[l];if(i.sticky)n+=i.width;else break}return n}function Io(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let l=e-t;l<e;l++)o+=n(l);return o}}function Ui(e,t,n,o,l){const i=Mu(e,o),u=[];for(const d of i)if(d.sticky)u.push(d);else break;if(u.length>0)for(const d of u)n-=d.width;let r=t,a=l??0;for(;a<=n&&r<i.length;)a+=i[r].width,r++;for(let d=t;d<r;d++){const c=i[d];c.sticky||u.push(c)}return u}function Ma(e,t,n){let o=0;for(const l of t){const i=l.sticky?o:o+(n??0);if(e<=i+l.width)return l.sourceIndex;o+=l.width}return-1}function Ra(e,t,n,o,l,i,u,r,a,d,c,h){const v=c??(n?1:0),m=h??(n?[l]:[]),f=m.reduce((k,x)=>k+x,0),w=o+f;if(n&&v>0){let k=0;for(let x=0;x<v;x++){var C;if(k+=(C=m[x])!==null&&C!==void 0?C:0,e<=k)return-(x+2)}}if(e<=w)return-1;let p=t;for(let k=0;k<d;k++){const x=i-1-k,M=typeof u=="number"?u:u(x);if(p-=M,e>=p)return x}const g=i-d,b=e-(a??0);if(typeof u=="number"){const k=Math.floor((b-w)/u)+r;return k>=g?void 0:k}else{let k=w;for(let x=r;x<g;x++){const M=u(x);if(b<=k+M)return x;k+=M}return}}let li=0,xl={};const Aa=typeof window>"u";async function Ba(){var e;Aa||((e=document)===null||e===void 0||(e=e.fonts)===null||e===void 0?void 0:e.ready)===void 0||(await document.fonts.ready,li=0,xl={},Ks())}Ba();function Ru(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Ho(e,t,n){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"middle";const l=Ru(e,t,o,n);let i=xl[l];return i===void 0&&(i=t.measureText(e),xl[l]=i,li++),li>1e4&&(xl={},li=0),i}function Au(e,t){const n=Ru(e,void 0,"middle",t);return xl[n]}function wn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Ia(e,t)}function Yr(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Vr=[];function Ia(e,t){for(const i of Vr)if(i.key===t)return i.val;const n=Yr(e,"alphabetic"),l=-(Yr(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Vr.push({key:t,val:l}),l}function Ha(e,t,n,o,l,i){const{ctx:u,rect:r,theme:a}=e;let d=Number.MAX_SAFE_INTEGER;const c=500;if(t!==void 0&&(d=n-t,d<c)){const h=1-d/c;u.globalAlpha=h,u.fillStyle=a.bgSearchResult,u.fillRect(r.x+1,r.y+1,r.width-(l?2:1),r.height-(i?2:1)),u.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return d<c}function fi(e,t,n){const{ctx:o,theme:l}=e,i=t??{},u=n??l.textDark;return u!==i.fillStyle&&(o.fillStyle=u,i.fillStyle=u),i}function mf(e,t,n,o,l){const{rect:i,ctx:u,theme:r}=e;u.fillStyle=r.textDark,Vn({ctx:u,rect:i,theme:r},t,n,o,l)}function Bu(e,t,n,o,l,i,u,r,a){a==="right"?e.fillText(t,n+l-(r.cellHorizontalPadding+.5),o+i/2+u):a==="center"?e.fillText(t,n+l/2,o+i/2+u):e.fillText(t,n+r.cellHorizontalPadding+.5,o+i/2+u)}function Iu(e,t){const n=Ho("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Ta(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function za(e,t,n,o,l,i,u,r,a,d){const c=r.baseFontFull,h=Xs(e,t,c,l-r.cellHorizontalPadding*2,d??!1),v=Iu(e,c),m=r.lineHeight*v,f=v+m*(h.length-1),w=f+r.cellVerticalPadding>i;w&&(e.save(),e.rect(n,o,l,i),e.clip());const C=o+i/2-f/2;let p=Math.max(o+r.cellVerticalPadding,C);for(const g of h)if(Bu(e,g,n,p,l,v,u,r,a),p+=m,p>o+i)break;w&&e.restore()}function Vn(e,t,n,o,l){const{ctx:i,rect:u,theme:r}=e,{x:a,y:d,width:c,height:h}=u;o=o??!1,o||(t=Ta(t,c));const v=wn(i,r),m=nr(t)==="rtl";if(n===void 0&&m&&(n="right"),m&&(i.direction="rtl"),t.length>0){let f=!1;n==="right"?(i.textAlign="right",f=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,f=!0),o?za(i,t,a,d,c,h,v,r,n,l):Bu(i,t,a,d,c,h,v,r,n),f&&(i.textAlign="start"),m&&(i.direction="inherit")}}function Wn(e,t,n,o,l,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,l/2,o/2)),tr:Math.max(0,Math.min(i.tr,l/2,o/2)),bl:Math.max(0,Math.min(i.bl,l/2,o/2)),br:Math.max(0,Math.min(i.br,l/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+l,t+o-i.br,n+l,i.br),e.arcTo(t,n+l,t,n+l-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Pa(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function La(e,t,n){const o=function(r,a){const d=a.x-r.x,c=a.y-r.y,h=Math.sqrt(d*d+c*c),v=d/h,m=c/h;return{x:d,y:a.y-r.y,len:h,nx:v,ny:m,ang:Math.atan2(m,v)}};let l;const i=t.length;let u=t[i-1];for(let r=0;r<i;r++){let a=t[r%i];const d=t[(r+1)%i],c=o(a,u),h=o(a,d),v=c.nx*h.ny-c.ny*h.nx,m=c.nx*h.nx-c.ny*-h.ny;let f=Math.asin(v<-1?-1:v>1?1:v),w=1,C=!1;m<0?f<0?f=Math.PI+f:(f=Math.PI-f,w=-1,C=!0):f>0&&(w=-1,C=!0),l=a.radius!==void 0?a.radius:n;const p=f/2;let g=Math.abs(Math.cos(p)*l/Math.sin(p)),b;g>Math.min(c.len/2,h.len/2)?(g=Math.min(c.len/2,h.len/2),b=Math.abs(g*Math.sin(p)/Math.cos(p))):b=l;let k=a.x+h.nx*g,x=a.y+h.ny*g;k+=-h.ny*b*w,x+=h.nx*b*w,e.arc(k,x,b,c.ang+Math.PI/2*w,h.ang-Math.PI/2*w,C),u=a,a=d}e.closePath()}function ji(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C){const p={x:0,y:i+d,width:0,height:0},g=w??(l>0?1:0),b=-(g+1);if(e>=m.length||t>=c||t<b||e<0)return p;const k=C??(l>0?[l]:[]),x=k.reduce((F,D)=>F+D,0),M=i-x;if(e>=h){const F=u>e?-1:1,D=ol(m);p.x+=D+a;for(let I=u;I!==e;I+=F)p.x+=m[F===1?I:I-1].width*F}else for(let F=0;F<e;F++)p.x+=m[F].width;if(p.width=m[e].width+1,t===-1)p.y=x,p.height=M;else if(t<=-2){var B;const F=-(t+2);let D=0;for(let S=0;S<F;S++){var R;D+=(R=k[S])!==null&&R!==void 0?R:0}p.y=D,p.height=(B=k[F])!==null&&B!==void 0?B:l;let I=e;const T=m[e].group,z=m[e].sticky;for(;I>0&&si(m[I-1].group,T,F,g)&&m[I-1].sticky===z;){const S=m[I-1];p.x-=S.width,p.width+=S.width,I--}let E=e;for(;E+1<m.length&&si(m[E+1].group,T,F,g)&&m[E+1].sticky===z;){const S=m[E+1];p.width+=S.width,E++}if(!z){const S=ol(m),W=p.x-S;W<0&&(p.x-=W,p.width+=W),p.x+p.width>n&&(p.width=n-p.x)}}else if(t>=c-v){let F=c-t;for(p.y=o;F>0;){const D=t+F-1;p.height=typeof f=="number"?f:f(D),p.y-=p.height,F--}p.height+=1}else{const F=r>t?-1:1;if(typeof f=="number"){const D=t-r;p.y+=D*f}else for(let D=r;D!==t;D+=F)p.y+=f(D)*F;p.height=(typeof f=="number"?f:f(t))+1}return p}const ir=1<<21;function Rn(e,t){return(t+2)*ir+e}function Hu(e){return e%ir}function rr(e){return Math.floor(e/ir)-2}function ur(e){const t=Hu(e),n=rr(e);return[t,n]}class Tu{constructor(){this.visibleWindow={x:0,y:0,width:0,height:0},this.freezeCols=0,this.freezeRows=[],this.isInWindow=t=>{const n=Hu(t),o=rr(t),l=this.visibleWindow,i=n>=l.x&&n<=l.x+l.width||n<this.freezeCols,u=o>=l.y&&o<=l.y+l.height||this.freezeRows.includes(o);return i&&u}}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&el(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Oa extends Tu{constructor(){super(...arguments),this.cache=new Map,this.setValue=(t,n)=>{this.cache.set(Rn(t[0],t[1]),n)},this.getValue=t=>this.cache.get(Rn(t[0],t[1])),this.clearOutOfWindow=()=>{for(const[t]of this.cache.entries())this.isInWindow(t)||this.cache.delete(t)}}}class _o{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.cells=void 0,this.cells=new Set(t.map(n=>Rn(n[0],n[1])))}add(t){this.cells.add(Rn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(Rn(t[0],t[1]))}remove(t){this.cells.delete(Rn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(rr(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(Rn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield ur(t)}}const qi=150;function Wa(e,t,n,o){var l,i;const u=o(t);return(l=u==null||(i=u.measure)===null||i===void 0?void 0:i.call(u,e,t,n))!==null&&l!==void 0?l:qi}function zu(e,t,n,o,l,i,u,r,a){let d=0;const c=l===void 0?[]:l.map(m=>{const f=Wa(e,m[o],t,a);return d=Math.max(d,f),f});if(c.length>5&&r){d=0;let m=0;for(const w of c)m+=w;const f=m/c.length;for(let w=0;w<c.length;w++)c[w]>=f*2?c[w]=0:d=Math.max(d,c[w])}const h=e.font;e.font=t.headerFontFull,d=Math.max(d,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=h;const v=Math.max(Math.ceil(i),Math.min(Math.floor(u),Math.ceil(d)));return{...n,width:v}}function Na(e,t,n,o,l,i,u,r,a){const d=s.useRef(t),c=s.useRef(n),h=s.useRef(u);d.current=t,c.current=n,h.current=u;const[v,m]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const g=document.createElement("canvas");return g.style.display="none",g.style.opacity="0",g.style.position="fixed",[g,g.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(v&&document.documentElement.append(v),()=>{v==null||v.remove()}),[v]);const f=s.useRef({}),w=s.useRef(),[C,p]=s.useState();return s.useLayoutEffect(()=>{const g=c.current;if(g===void 0||e.every(_l))return;let b=Math.max(1,10-Math.floor(e.length/1e4)),k=0;b<d.current&&b>1&&(b--,k=1);const x={x:0,y:0,width:e.length,height:Math.min(d.current,b)},M={x:0,y:d.current-1,width:e.length,height:1};(async()=>{const R=g(x,a.signal),F=k>0?g(M,a.signal):void 0;let D;typeof R=="object"?D=R:D=await Wr(R),F!==void 0&&(typeof F=="object"?D=[...D,...F]:D=[...D,...await Wr(F)]),w.current=e,p(D)})()},[a.signal,e]),s.useMemo(()=>{let b=e.every(_l)?e:m===null?e.map(R=>_l(R)?R:{...R,width:qi}):(m.font=h.current.baseFontFull,e.map((R,F)=>{if(_l(R))return R;if(f.current[R.id]!==void 0)return{...R,width:f.current[R.id]};if(C===void 0||w.current!==e||R.id===void 0)return{...R,width:qi};const D=zu(m,u,R,F,C,l,i,!0,r);return f.current[R.id]=D.width,D})),k=0,x=0;const M=[];for(const[R,F]of b.entries())k+=F.width,F.grow!==void 0&&F.grow>0&&(x+=F.grow,M.push(R));if(k<o&&M.length>0){const R=[...b],F=o-k;let D=F;for(let I=0;I<M.length;I++){var B;const T=M[I],z=((B=b[T].grow)!==null&&B!==void 0?B:0)/x,E=I===M.length-1?D:Math.min(D,Math.floor(F*z));R[T]={...b[T],growOffset:E,width:b[T].width+E},D-=E}b=R}return{sizedColumns:b,nonGrowWidth:k}},[o,e,m,C,u,l,i,r])}const St='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',$a=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Ga=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Ka=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},Pu=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Va=e=>{const t=e.bgColor;return`${St}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Ua=Pu,ja=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},_a=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},ed=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},td=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},nd=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},od=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},ld=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},id=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},rd=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},ud=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},sd=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},ad=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},dd=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},cd=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},fd=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},hd=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},gd=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},vd=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),md=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),wd={headerRowID:$a,headerNumber:Xa,headerCode:Ga,headerString:Ka,headerBoolean:Ya,headerAudioUri:Ua,headerVideoUri:ja,headerEmoji:qa,headerImage:Za,headerUri:Pu,headerPhone:Ja,headerMarkdown:Qa,headerDate:_a,headerTime:ed,headerEmail:td,headerReference:nd,headerIfThenElse:od,headerSingleValue:ld,headerLookup:id,headerTextTemplate:rd,headerMath:ud,headerRollup:sd,headerJoinStrings:ad,headerSplitString:dd,headerGeoDistance:cd,headerArray:fd,rowOwnerOverlay:hd,protectedColumnOverlay:gd,renameIcon:Va,headerArrowDown:vd,headerArrowUp:md};function pd(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Cd{constructor(t,n){this.onSettled=void 0,this.spriteMap=new Map,this.headerIcons=void 0,this.inFlight=0,this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,l,i,u,r){let a=arguments.length>7&&arguments[7]!==void 0?arguments[7]:1;const[d,c]=pd(n,r),h=u*Math.ceil(window.devicePixelRatio),v=`${d}_${c}_${h}_${t}`;let m=this.spriteMap.get(v);if(m===void 0){const f=this.headerIcons[t];if(f===void 0)return;m=document.createElement("canvas");const w=m.getContext("2d");if(w===null)return;const C=new Image;C.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(f({fgColor:c,bgColor:d}))}`,this.spriteMap.set(v,m);const p=C.decode();if(p===void 0)return;this.inFlight++,p.then(()=>{w.drawImage(C,0,0,h,h)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(m,0,0,h,h,l,i,u,u),a<1&&(o.globalAlpha=1)}}function Lu(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function hi(e,t,n,o,l,i,u,r,a){r=r??t;let d=t,c=e;const h=o-i;let v=!1;for(;d<n&&c<h;){const m=l(c);if(d+m>r&&a(d,c,m,!1,u&&c===o-1)===!0){v=!0;break}d+=m,c++}if(!v){d=n;for(let m=0;m<i;m++){c=o-1-m;const f=l(c);d-=f,a(d,c,f,!0,u&&c===o-1)}}}function wo(e,t,n,o,l,i){let u=0,r=0;const a=l+o;for(const d of e){const c=d.sticky?r:u+n;if(i(d,c,a,d.sticky?0:r,t)===!0)break;u+=d.width,r+=d.sticky?d.width:0}}function bd(e,t,n,o,l){let i=0,u=0;for(let r=0;r<e.length;r++){const a=e[r];let d=r+1,c=a.width;for(a.sticky&&(u+=c);d<e.length&&Fu(e[d].group,a.group)&&e[d].sticky===e[r].sticky;){const w=e[d];c+=w.width,d++,r++,w.sticky&&(u+=w.width)}const h=a.sticky?0:n,v=i+h,m=a.sticky?0:Math.max(0,u-v),f=Math.min(c-m,t-(v+m));l([a.sourceIndex,e[d-1].sourceIndex],Bo(a.group),v+m,0,f,o),i+=c}}function yd(e,t,n,o,l,i){if(l===0)return;const u=[];let r=0;for(let v=0;v<l;v++){var a;u.push(r),r+=(a=o[v])!==null&&a!==void 0?a:0}const d=[];let c=0;for(const v of e)d.push(c),c+=v.width;for(let v=0;v<l;v++){var h;const m=u[v],f=(h=o[v])!==null&&h!==void 0?h:0;let w=0,C=0;for(;C<e.length;){const p=e[C],g=Vi(p.group,v,l);if(g===void 0){p.sticky&&(w+=p.width),C++;continue}const b=d[C];let k=C+1,x=p.width;for(p.sticky&&(w+=p.width);k<e.length;){const D=e[k],I=si(D.group,p.group,v,l),T=D.sticky===p.sticky;if(!I||!T)break;x+=D.width,D.sticky&&(w+=D.width),k++}const M=p.sticky?0:n,B=b+M,R=p.sticky?0:Math.max(0,w-B),F=Math.min(x-R,t-(B+R));F>0&&i([p.sourceIndex,e[k-1].sourceIndex],g,B+R,m,F,f,v),C=k}}}function Ou(e,t,n,o,l,i,u){var r,a;const[d,c]=e;let h,v;const m=(r=(a=u.find(f=>!f.sticky))===null||a===void 0?void 0:a.sourceIndex)!==null&&r!==void 0?r:0;if(c>m){const f=Math.max(d,m);let w=t,C=o;for(let p=i.sourceIndex-1;p>=f;p--)w-=u[p].width,C+=u[p].width;for(let p=i.sourceIndex+1;p<=c;p++)C+=u[p].width;v={x:w,y:n,width:C,height:l}}if(m>d){const f=Math.min(c,m-1);let w=t,C=o;for(let p=i.sourceIndex-1;p>=d;p--)w-=u[p].width,C+=u[p].width;for(let p=i.sourceIndex+1;p<=f;p++)C+=u[p].width;h={x:w,y:n,width:C,height:l}}return[h,v]}function Ed(e,t,n,o){if(o==="any")return Wu(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Du([t,n],e))return;const l=t-e.x,i=e.x+e.width-t,u=n-e.y+1,r=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:l,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:u,o==="horizontal"?Number.MAX_SAFE_INTEGER:r);return a===r?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===u?{x:e.x,y:n,width:e.width,height:e.y-n}:a===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function Dl(e,t,n,o,l,i,u,r){return e<=l+u&&l<=e+n&&t<=i+r&&i<=t+o}function go(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Wu(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),l=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:l,height:i}}function kd(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function xd(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const l=-4,i=-4,u=t+4,r=n+4,a=l-e.x,d=e.x+e.width-u,c=i-e.y,h=e.y+e.height-r,v=a>0?e.x+Math.floor(a/o)*o:e.x,m=d>0?e.x+e.width-Math.floor(d/o)*o:e.x+e.width,f=c>0?e.y+Math.floor(c/o)*o:e.y,w=h>0?e.y+e.height-Math.floor(h/o)*o:e.y+e.height;return{x:v,y:f,width:m-v,height:w-f}}function Fd(e,t,n,o,l){const[i,u,r,a]=t,[d,c,h,v]=l,{x:m,y:f,width:w,height:C}=e,p=[];if(w<=0||C<=0)return p;const g=m+w,b=f+C,k=m<i,x=f<u,M=m+w>r,B=f+C>a,R=m>=i&&m<r||g>i&&g<=r||m<i&&g>r,F=f>=u&&f<a||b>u&&b<=a||f<u&&b>a;if(R&&F){const I=Math.max(m,i),T=Math.max(f,u),z=Math.min(g,r),E=Math.min(b,a);p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:d,y:c,width:h-d+1,height:v-c+1}})}if(k&&x){const I=m,T=f,z=Math.min(g,i),E=Math.min(b,u);p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:0,y:0,width:d+1,height:c+1}})}if(x&&R){const I=Math.max(m,i),T=f,z=Math.min(g,r),E=Math.min(b,u);p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:d,y:0,width:h-d+1,height:c+1}})}if(x&&M){const I=Math.max(m,r),T=f,z=g,E=Math.min(b,u);p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:h,y:0,width:n-h+1,height:c+1}})}if(k&&F){const I=m,T=Math.max(f,u),z=Math.min(g,i),E=Math.min(b,a);p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:0,y:c,width:d+1,height:v-c+1}})}if(M&&F){const I=Math.max(m,r),T=Math.max(f,u),z=g,E=Math.min(b,a);p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:h,y:c,width:n-h+1,height:v-c+1}})}if(k&&B){const I=m,T=Math.max(f,a),z=Math.min(g,i),E=b;p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:0,y:v,width:d+1,height:o-v+1}})}if(B&&R){const I=Math.max(m,i),T=Math.max(f,a),z=Math.min(g,r),E=b;p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:d,y:v,width:h-d+1,height:o-v+1}})}if(M&&B){const I=Math.max(m,r),T=Math.max(f,a),z=g,E=b;p.push({rect:{x:I,y:T,width:z-I,height:E-T},clip:{x:h,y:v,width:n-h+1,height:o-v+1}})}return p}const Dd={kind:ie.Loading,allowOverlay:!1};function Ur(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C,p,g,b,k,x,M,B,R,F,D,I,T,z,E,S,W,N,J){var G;let j=(G=b==null?void 0:b.size)!==null&&G!==void 0?G:Number.MAX_SAFE_INTEGER;const _=performance.now();let Y=z.baseFontFull;e.font=Y;const V={ctx:e},ee=[0,0],de=C>0?Io(a,C,d):0;let me,$;const Ce=new _o,O=new Set,ve=Lu(g);if(wo(t,r,i,u,l,(Q,he,U,ae,ke)=>{const te=Math.max(0,ae-he),Be=he+te,Ye=l+1,ce=Q.width-te,H=o-l-1;if(g.length>0){let Ie=!1;for(let fe=0;fe<g.length;fe++){const Fe=g[fe];if(Dl(Be,Ye,ce,H,Fe.x,Fe.y,Fe.width,Fe.height)){Ie=!0;break}}if(!Ie)return}const re=()=>{e.save(),e.beginPath(),e.rect(Be,Ye,ce,H),e.clip()},ge=k.columns.hasIndex(Q.sourceIndex),ne=h(Bo(Q.group)).overrideTheme,Re=Q.themeOverride===void 0&&ne===void 0?z:On(z,ne,Q.themeOverride),De=Re.baseFontFull;De!==Y&&(Y=De,e.font=De),re();let xe;return hi(ke,U,o,a,d,C,p,ve,(Ie,fe,Fe,ze,Xe)=>{var be,Ve;if(fe<0)return;if(ee[0]=Q.sourceIndex,ee[1]=fe,Ce.has(ee)){j--;return}if(b!==void 0&&!b.has(ee))return;if(g.length>0){let Ge=!1;for(let pt=0;pt<g.length;pt++){const rt=g[pt];if(Dl(he,Ie,Q.width,Fe,rt.x,rt.y,rt.width,rt.height)){Ge=!0;break}}if(!Ge)return}const nt=k.rows.hasIndex(fe),je=m.hasIndex(fe),Ue=fe<a?c(ee):Dd;let at=he,ct=Q.width,qe=Ie,vt=Fe,Pe=!1,ot=!1;if(Ue.rowspan!==void 0){const[Ge,pt]=Ue.rowspan,rt=`${Q.sourceIndex}|${Ge}`;if(O.has(rt)){j--;return}else{let Gt=Ie;for(let mt=Ge;mt<fe;mt++)Gt-=d(mt);let Xt=0;for(let mt=Ge;mt<pt;mt++)Xt+=d(mt);if(Gt<Ye+H&&Gt+Xt>Ye){qe=Gt,vt=Xt,O.add(rt);for(let mt=Ge;mt<pt;mt++)mt!==fe&&Ce.add([Q.sourceIndex,mt]);Pe=!0}else{O.add(rt);for(let mt=Ge;mt<pt;mt++)Ce.add([Q.sourceIndex,mt]);j--;return}}}if(Ue.span!==void 0){const[Ge,pt]=Ue.span,rt=`${fe},${Ge},${pt},${Q.sticky}`;if($===void 0&&($=new Set),$.has(rt)){j--;return}else{const Gt=Ou(Ue.span,he,Ie,Q.width,Fe,Q,n),Xt=Q.sticky?Gt[0]:Gt[1];!Q.sticky&&Gt[0]!==void 0&&(ot=!0),Xt!==void 0&&(at=Xt.x,ct=Xt.width,$.add(rt),Pe=!0)}}if(Pe){e.restore(),xe=void 0,e.save(),e.beginPath();const Ge=Math.max(0,ae-at);e.rect(at+Ge,qe,ct-Ge,vt),me===void 0&&(me=[]),me.push({x:at+Ge,y:qe,width:ct-Ge,height:vt}),e.clip()}const Mt=v==null?void 0:v(fe),Ht=Xe&&((be=Q.trailingRowOptions)===null||be===void 0?void 0:be.themeOverride)!==void 0?(Ve=Q.trailingRowOptions)===null||Ve===void 0?void 0:Ve.themeOverride:void 0,xt=Ue.themeOverride===void 0&&Mt===void 0&&Ht===void 0?Re:On(Re,Mt,Ht,Ue.themeOverride);e.beginPath();const Wt=Da(ee,Ue,k);let wt=Sa(ee,Ue,k,w);const Zt=Ue.span!==void 0&&k.columns.some(Ge=>Ue.span!==void 0&&Ge>=Ue.span[0]&&Ge<=Ue.span[1]);Wt&&!f&&w?wt=0:Wt&&w&&(wt=Math.max(wt,1)),Zt&&wt++,Wt||(nt&&wt++,ge&&!Xe&&wt++);const pn=Ue.kind===ie.Protected?xt.bgCellMedium:xt.bgCell;let Le;if((ze||pn!==z.bgCell)&&(Le=mn(pn,Le)),wt>0||je){je&&(Le=mn(xt.bgHeader,Le));for(let Ge=0;Ge<wt;Ge++)Le=mn(xt.accentLight,Le)}else if(x!==void 0){for(const Ge of x)if(Ge[0]===Q.sourceIndex&&Ge[1]===fe){Le=mn(xt.bgSearchResult,Le);break}}if(M!==void 0)for(let Ge=0;Ge<M.length;Ge++){const pt=M[Ge],rt=pt.range;pt.style!=="solid-outline"&&rt.x<=Q.sourceIndex&&Q.sourceIndex<rt.x+rt.width&&rt.y<=fe&&fe<rt.y+rt.height&&(Le=mn(pt.color,Le))}let Bt=!1;if(b!==void 0){const Ge=Ie+1,rt=(ze?Ge+Fe-1:Math.min(Ge+Fe-1,o-de))-Ge;(rt!==Fe-1||at+1<=ae)&&(Bt=!0,e.save(),e.beginPath(),e.rect(at+1,Ge,ct-1,rt),e.clip()),Le=Le===void 0?xt.bgCell:mn(Le,xt.bgCell)}const Rt=Q.sourceIndex===n.length-1,Jt=fe===a-1;Le!==void 0&&(e.fillStyle=Le,xe!==void 0&&(xe.fillStyle=Le),b!==void 0?e.fillRect(at+1,qe+1,ct-(Rt?2:1),vt-(Jt?2:1)):e.fillRect(at,qe,ct,vt)),Ue.style==="faded"&&(e.globalAlpha=.6);let Cn;for(let Ge=0;Ge<F.length;Ge++){const pt=F[Ge];if(pt.item[0]===Q.sourceIndex&&pt.item[1]===fe){Cn=pt;break}}if(ct>J&&!ot){var Bn,on;const Ge=xt.baseFontFull;Ge!==Y&&(e.font=Ge,Y=Ge);let pt=0;if(Ue.rowspan!==void 0){var In;const rt=(In=Ue.rowSpanPosition)!==null&&In!==void 0?In:"top";if(rt==="top")pt=Fe/2-vt/2;else if(rt==="bottom"){const[Gt,Xt]=Ue.rowspan,mt=d(Xt-1);pt=vt/2-mt/2}}xe=Nu(e,Ue,Q.sourceIndex,fe,Rt,Jt,at,qe,ct,vt,wt>0,xt,Le??xt.bgCell,B,R,(Bn=(on=Cn)===null||on===void 0?void 0:on.hoverAmount)!==null&&Bn!==void 0?Bn:0,D,T,_,I,xe,E,S,W,N,pt)}if(Bt&&e.restore(),Ue.style==="faded"&&(e.globalAlpha=1),j--,Pe){var Yt,ln;e.restore(),(Yt=xe)===null||Yt===void 0||(ln=Yt.deprep)===null||ln===void 0||ln.call(Yt,V),xe=void 0,re(),Y=De,e.font=De}return j<=0}),e.restore(),j<=0}),me!==void 0)return me}const Cl=[0,0],bl={x:0,y:0,width:0,height:0},Oi=[void 0,()=>{}];let Zi=!1;function Sd(){Zi=!0}function Nu(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C,p,g,b,k,x,M,B,R,F){let D,I;C!==void 0&&C[0][0]===n&&C[0][1]===o&&(D=C[1][0],I=C[1][1]);let T;Cl[0]=n,Cl[1]=o,bl.x=u,bl.y=r,bl.width=a,bl.height=d,Oi[0]=M.getValue(Cl),Oi[1]=j=>M.setValue(Cl,j),Zi=!1;const z={ctx:e,theme:h,col:n,row:o,cell:t,rect:bl,highlighted:c,cellFillColor:v,hoverAmount:w,frameTime:g,hoverX:D,drawState:Oi,hoverY:I,imageLoader:m,spriteManager:f,hyperWrapping:p,overrideCursor:D!==void 0?R:void 0,requestAnimationFrame:Sd},E=Ha(z,t.lastUpdated,g,k,l,i),S=B(t);if(S!==void 0){var W,N;if(((W=k)===null||W===void 0?void 0:W.renderer)!==S){var J,G;(J=k)===null||J===void 0||(G=J.deprep)===null||G===void 0||G.call(J,z),k=void 0}const j=(N=S.drawPrep)===null||N===void 0?void 0:N.call(S,z,k);e.save(),e.translate(0,F),b!==void 0&&!Ao(z.cell)?b(z,()=>S.draw(z,t)):S.draw(z,t),e.restore(),T=j===void 0?void 0:{deprep:j==null?void 0:j.deprep,fillStyle:j==null?void 0:j.fillStyle,font:j==null?void 0:j.font,renderer:S}}return(E||Zi)&&(x==null||x(Cl)),T}function ai(e,t,n,o,l,i,u,r){var a;let d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:-20,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:-20,h=arguments.length>10&&arguments[10]!==void 0?arguments[10]:void 0,v=arguments.length>11&&arguments[11]!==void 0?arguments[11]:"center",m=arguments.length>12&&arguments[12]!==void 0?arguments[12]:"square",f=arguments.length>13&&arguments[13]!==void 0?arguments[13]:!1;const w=Math.floor(l+u/2),C=m==="circle"?1e4:(a=t.roundingRadius)!==null&&a!==void 0?a:4;let p=mu(h??t.checkboxMaxSize,u,t.cellVerticalPadding),g=p/2;const b=vu(v,o,i,t.cellHorizontalPadding,p),k=gu(b,w,p),x=wu(o+d,l+c,k);switch(n){case!0:{e.beginPath(),Wn(e,b-p/2,w-p/2,p,p,C),m==="circle"&&(g*=.8,p*=.8),e.fillStyle=f?t.bgCellMedium:r?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(b-g+p/4.23,w-g+p/1.97),e.lineTo(b-g+p/2.42,w-g+p/1.44),e.lineTo(b-g+p/1.29,w-g+p/3.25),e.strokeStyle=f?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case ii:case!1:{e.beginPath(),Wn(e,b-p/2+.5,w-p/2+.5,p-1,p-1,C),e.lineWidth=1,e.strokeStyle=f?t.textLight:x?t.textDark:t.textMedium,e.stroke();break}case Qi:{e.beginPath(),Wn(e,b-p/2,w-p/2,p,p,C),e.fillStyle=f?t.bgCellMedium:x?t.textMedium:t.textLight,e.fill(),m==="circle"&&(g*=.8,p*=.8),e.beginPath(),e.moveTo(b-p/3,w),e.lineTo(b+p/3,w),e.strokeStyle=f?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:Fl()}}function Md(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C,p,g,b,k,x){var M,B,R,F;const D=k??(o?1:0),I=x??(o?[a]:[]),T=I.reduce((G,j)=>G+j,0),z=r+T;if(z<=0)return;e.fillStyle=v.bgHeader,p!==void 0&&o&&(k??1)>1?e.fillRect(0,T,i,r):e.fillRect(0,0,i,z);const E=l==null||(M=l[0])===null||M===void 0?void 0:M[0],S=l==null||(B=l[0])===null||B===void 0?void 0:B[1],W=l==null||(R=l[1])===null||R===void 0?void 0:R[0],N=l==null||(F=l[1])===null||F===void 0?void 0:F[1],J=v.headerFontFull;e.font=J,wo(t,0,u,0,z,(G,j,_,Y)=>{var V,ee;if(p!==void 0&&!p.has([G.sourceIndex,-1]))return;const de=Math.max(0,Y-j);e.save(),e.beginPath(),e.rect(j+de,T,G.width-de,r),e.clip();const me=C(Bo(G.group)).overrideTheme,$=G.themeOverride===void 0&&me===void 0?v:On(v,me,G.themeOverride);$.bgHeader!==v.bgHeader&&(e.fillStyle=$.bgHeader,e.fill()),$!==v&&(e.font=$.headerFontFull);const Ce=h.columns.hasIndex(G.sourceIndex),O=d!==void 0||c||G.headerRowMarkerDisabled===!0,ve=!O&&S===-1&&E===G.sourceIndex,Q=O?0:(V=(ee=f.find(te=>te.item[0]===G.sourceIndex&&te.item[1]===-1))===null||ee===void 0?void 0:ee.hoverAmount)!==null&&V!==void 0?V:0,he=(h==null?void 0:h.current)!==void 0&&h.current.cell[0]===G.sourceIndex,U=Ce?$.accentColor:he?$.bgHeaderHasFocus:$.bgHeader,ae=o?T:0,ke=G.sourceIndex===0?0:1;Ce?(e.fillStyle=U,e.fillRect(j+ke,ae,G.width-ke,r)):(he||Q>0)&&(e.beginPath(),e.rect(j+ke,ae,G.width-ke,r),he&&(e.fillStyle=$.bgHeaderHasFocus,e.fill()),Q>0&&(e.globalAlpha=Q,e.fillStyle=$.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Gu(e,j,ae,G.width,r,G,Ce,$,ve,ve?W:void 0,ve?N:void 0,he,Q,m,g,b),e.restore()}),o&&(D>1?Ad(e,t,i,u,I,D,l,v,m,f,w,C,p):Rd(e,t,i,u,a,l,v,m,f,w,C,p)),o&&(k??1)>1&&(e.beginPath(),e.moveTo(0,T+.5),e.lineTo(i,T+.5),e.strokeStyle=v.borderColor,e.lineWidth=1,e.stroke())}function Rd(e,t,n,o,l,i,u,r,a,d,c,h){var v;const[m,f]=(v=i==null?void 0:i[0])!==null&&v!==void 0?v:[];let w=0;bd(t,n,o,l,(C,p,g,b,k,x)=>{var M,B,R;if(h!==void 0&&!h.hasItemInRectangle({x:C[0],y:-2,width:C[1]-C[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(g,b,k,x),e.clip();const F=c(p),D=(F==null?void 0:F.overrideTheme)===void 0?u:On(u,F.overrideTheme),I=f===-2&&m!==void 0&&m>=C[0]&&m<=C[1],T=I?(M=D.bgGroupHeaderHovered)!==null&&M!==void 0?M:D.bgHeaderHovered:(B=D.bgGroupHeader)!==null&&B!==void 0?B:D.bgHeader;if(T!==u.bgHeader&&(e.fillStyle=T,e.fill()),e.fillStyle=(R=D.textGroupHeader)!==null&&R!==void 0?R:D.textHeader,F!==void 0){const E=F.name,W=e.measureText(E).width,N=F.icon!==void 0?26:0,J=N+W,G=g+(k-J)/2;if(F.icon!==void 0&&r.drawSprite(F.icon,"normal",e,G,(l-20)/2,20,D),e.fillText(E,G+N,l/2+wn(e,u.headerFontFull)),F.actions!==void 0&&I){var z;const j=sr({x:g,y:b,width:k,height:x},F.actions);e.beginPath();const _=j[0].x-10,Y=g+k-_;e.rect(_,0,Y,l);const V=e.createLinearGradient(_,0,_+Y,0),ee=mo(T,0);V.addColorStop(0,ee),V.addColorStop(10/Y,T),V.addColorStop(1,T),e.fillStyle=V,e.fill(),e.globalAlpha=.6;const[de,me]=(z=i==null?void 0:i[1])!==null&&z!==void 0?z:[-1,-1];for(let $=0;$<F.actions.length;$++){const Ce=F.actions[$],O=j[$],ve=go(O,de+g,me);ve&&(e.globalAlpha=1),r.drawSprite(Ce.icon,"normal",e,O.x+O.width/2-10,O.y+O.height/2-10,20,D),ve&&(e.globalAlpha=.6)}e.globalAlpha=1}}g!==0&&d(C[0])&&(e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,l),e.strokeStyle=u.borderColor,e.lineWidth=1,e.stroke()),e.restore(),w=g+k}),e.beginPath(),e.moveTo(w+.5,0),e.lineTo(w+.5,l),e.moveTo(0,l+.5),e.lineTo(n,l+.5),e.strokeStyle=u.borderColor,e.lineWidth=1,e.stroke()}function Ad(e,t,n,o,l,i,u,r,a,d,c,h,v){var m;const[f,w]=(m=u==null?void 0:u[0])!==null&&m!==void 0?m:[];e.font=r.headerFontFull;const C=l.reduce((g,b)=>g+b,0);v===void 0&&(e.fillStyle=r.bgHeader,e.fillRect(0,0,n,C));let p=0;if(yd(t,n,o,l,i,(g,b,k,x,M,B,R)=>{var F,D,I,T;const z=-(R+2);if(v!==void 0&&!v.hasItemInRectangle({x:g[0],y:z,width:g[1]-g[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(k,x,M,B),e.clip();const E=h(b),S=(E==null?void 0:E.overrideTheme)===void 0?r:On(r,E.overrideTheme),W=w===z&&f!==void 0&&f>=g[0]&&f<=g[1],N=W?(F=S.bgGroupHeaderHovered)!==null&&F!==void 0?F:S.bgHeaderHovered:(D=S.bgGroupHeader)!==null&&D!==void 0?D:S.bgHeader;e.fillStyle=N,e.fillRect(k,x,M,B),e.fillStyle=(I=S.textGroupHeader)!==null&&I!==void 0?I:S.textHeader;const J=(T=E==null?void 0:E.name)!==null&&T!==void 0?T:b,j=e.measureText(J).width,_=(E==null?void 0:E.icon)!==void 0?26:0,Y=_+j,V=k+(M-Y)/2;if((E==null?void 0:E.icon)!==void 0&&a.drawSprite(E.icon,"normal",e,V,x+(B-20)/2,20,S),e.fillText(J,V+_,x+B/2+wn(e,r.headerFontFull)),E!==void 0&&E.actions!==void 0&&W){var ee;const de=sr({x:k,y:x,width:M,height:B},E.actions);e.beginPath();const me=de[0].x-10,$=k+M-me;e.rect(me,x,$,B);const Ce=e.createLinearGradient(me,0,me+$,0),O=mo(N,0);Ce.addColorStop(0,O),Ce.addColorStop(10/$,N),Ce.addColorStop(1,N),e.fillStyle=Ce,e.fill(),e.globalAlpha=.6;const[ve,Q]=(ee=u==null?void 0:u[1])!==null&&ee!==void 0?ee:[-1,-1];for(let he=0;he<E.actions.length;he++){const U=E.actions[he],ae=de[he],ke=go(ae,ve+k,Q);ke&&(e.globalAlpha=1),a.drawSprite(U.icon,"normal",e,ae.x+ae.width/2-10,ae.y+ae.height/2-10,20,S),ke&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=r.borderColor,e.lineWidth=1,k!==0&&c(g[0])&&(e.beginPath(),e.moveTo(k+.5,x),e.lineTo(k+.5,x+B),e.stroke()),(R<i-1||v===void 0)&&(e.beginPath(),e.moveTo(k,x+B+.5),e.lineTo(k+M,x+B+.5),e.stroke()),e.restore(),p=Math.max(p,k+M)}),v===void 0){e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,C);let g=0;for(let b=0;b<i-1;b++)g+=l[b],e.moveTo(0,g+.5),e.lineTo(n,g+.5);e.strokeStyle=r.borderColor,e.lineWidth=1,e.stroke()}}const ni=30;function Bd(e,t,n,o,l){return{x:e+n-ni,y:Math.max(t,t+o/2-ni/2),width:ni,height:Math.min(ni,o)}}function sr(e,t){const n=[];let o=e.x+e.width-26*t.length;const l=e.y+e.height/2-13,i=26,u=26;for(let r=0;r<t.length;r++)n.push({x:o,y:l,width:u,height:i}),o+=26;return n}function yl(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function $u(e,t,n,o,l,i,u,r){var a,d;const c=u.cellHorizontalPadding,h=u.headerIconSize,v=Bd(n,o,l,i),m=e===void 0?(a=(d=Au(t.title,u.headerFontFull))===null||d===void 0?void 0:d.width)!==null&&a!==void 0?a:0:Ho(t.title,e,u.headerFontFull).width,f=t.icon!==void 0?Math.ceil(h*1.3):0,w=f+m,C=n+Math.max(c,(l-w)/2),p=t.icon===void 0?void 0:{x:C,y:o+(i-h)/2,width:h,height:h},g=p===void 0||t.overlayIcon===void 0?void 0:{x:p.x+9,y:p.y+6,width:18,height:18},b={x:C+f,y:o,width:m,height:i};let k;t.indicatorIcon!==void 0&&(k={x:b.x+m+c,y:o+(i-h)/2,width:h,height:h});const x=n+l/2;return{menuBounds:yl(v,x,r),iconBounds:yl(p,x,r),iconOverlayBounds:yl(g,x,r),textBounds:yl(b,x,r),indicatorIconBounds:yl(k,x,r)}}function jr(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const g=i.rowMarkerChecked;g!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=h);const b=i.headerRowMarkerTheme!==void 0?On(r,i.headerRowMarkerTheme):r;ai(e,b,g,t,n,o,l,!1,void 0,void 0,r.checkboxMaxSize,"center",i.rowMarker),g!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const C=u?r.textHeaderSelected:r.textHeader,p=i.hasMenu===!0&&(a||m&&u)&&w.menuBounds!==void 0;if(i.icon!==void 0&&w.iconBounds!==void 0){let g=u?"selected":"normal";i.style==="highlight"&&(g=u?"selected":"special"),v.drawSprite(i.icon,g,e,w.iconBounds.x,w.iconBounds.y,w.iconBounds.width,r),i.overlayIcon!==void 0&&w.iconOverlayBounds!==void 0&&v.drawSprite(i.overlayIcon,u?"selected":"special",e,w.iconOverlayBounds.x,w.iconOverlayBounds.y,w.iconOverlayBounds.width,r)}if(p&&o>35){const b=f?35:o-35,k=f?35*.7:o-35*.7,x=b/o,M=k/o,B=e.createLinearGradient(t,0,t+o,0),R=mo(C,0);B.addColorStop(f?1:0,C),B.addColorStop(x,C),B.addColorStop(M,R),B.addColorStop(f?0:1,R),e.fillStyle=B}else e.fillStyle=C;if(f&&(e.textAlign="right"),w.textBounds!==void 0&&e.fillText(i.title,f?w.textBounds.x+w.textBounds.width:w.textBounds.x,n+l/2+wn(e,r.headerFontFull)),f&&(e.textAlign="left"),i.indicatorIcon!==void 0&&w.indicatorIconBounds!==void 0&&(!p||!Dl(w.menuBounds.x,w.menuBounds.y,w.menuBounds.width,w.menuBounds.height,w.indicatorIconBounds.x,w.indicatorIconBounds.y,w.indicatorIconBounds.width,w.indicatorIconBounds.height))){let g=u?"selected":"normal";i.style==="highlight"&&(g=u?"selected":"special"),v.drawSprite(i.indicatorIcon,g,e,w.indicatorIconBounds.x,w.indicatorIconBounds.y,w.indicatorIconBounds.width,r)}if(p&&w.menuBounds!==void 0){const g=w.menuBounds,b=d!==void 0&&c!==void 0&&go(g,d+t,c+n);if(b||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===ri.Triangle){e.beginPath();const k=g.x+g.width/2-5.5,x=g.y+g.height/2-3;La(e,[{x:k,y:x},{x:k+11,y:x},{x:k+5.5,y:x+6}],1),e.fillStyle=C,e.fill()}else if(i.menuIcon===ri.Dots){e.beginPath();const k=g.x+g.width/2,x=g.y+g.height/2;Pa(e,k,x),e.fillStyle=C,e.fill()}else{const k=g.x+(g.width-r.headerIconSize)/2,x=g.y+(g.height-r.headerIconSize)/2;v.drawSprite(i.menuIcon,"normal",e,k,x,r.headerIconSize,r)}b||(e.globalAlpha=1)}}function Gu(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w){const C=nr(i.title)==="rtl",p=$u(e,i,t,n,o,l,r,C);if(f!==void 0){var g;f({ctx:e,theme:r,rect:{x:t,y:n,width:o,height:l},column:i,columnIndex:i.sourceIndex,isSelected:u,hoverAmount:v,isHovered:a,hasSelectedCell:h,spriteManager:m,menuBounds:(g=p==null?void 0:p.menuBounds)!==null&&g!==void 0?g:{x:0,y:0,height:0,width:0},hoverX:d,hoverY:c},()=>jr(e,t,n,o,l,i,u,r,a,d,c,v,m,w,C,p))}else jr(e,t,n,o,l,i,u,r,a,d,c,v,m,w,C,p)}function Id(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C,p,g){if(p!==void 0||t[t.length-1]!==n[t.length-1])return;const b=Lu(C);wo(t,a,u,r,i,(k,x,M,B,R)=>{if(k!==t[t.length-1])return;x+=k.width;const F=Math.max(x,B);F>o||(e.save(),e.beginPath(),e.rect(F,i+1,1e4,l-i-1),e.clip(),hi(R,M,l,d,c,f,w,b,(D,I,T,z)=>{if(!z&&C.length>0&&!C.some(J=>Dl(x,D,1e4,T,J.x,J.y,J.width,J.height)))return;const E=v.hasIndex(I),S=m.hasIndex(I);e.beginPath();const W=h==null?void 0:h(I),N=W===void 0?g:On(g,W);N.bgCell!==g.bgCell&&(e.fillStyle=N.bgCell,e.fillRect(x,D,1e4,T)),S&&(e.fillStyle=N.bgHeader,e.fillRect(x,D,1e4,T)),E&&(e.fillStyle=N.accentLight,e.fillRect(x,D,1e4,T))}),e.restore())})}function Hd(e,t,n,o,l,i,u,r,a){var d;let c=!1;for(const w of t)if(!w.sticky){c=u(w.sourceIndex);break}const h=(d=a.horizontalBorderColor)!==null&&d!==void 0?d:a.borderColor,v=a.borderColor,m=c?ol(t):0;let f;if(m!==0&&(f=Gr(v,a.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=f,e.stroke()),l>0){const w=v===h&&f!==void 0?f:Gr(h,a.bgCell),C=Io(i,l,r);e.beginPath(),e.moveTo(0,o-C+.5),e.lineTo(n,o-C+.5),e.strokeStyle=w,e.stroke()}}const Xu=(e,t,n)=>{let o=0,l=t,i=0,u=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;for(const r of e)o=Math.min(o,r.x-1),l=Math.max(l,r.x+r.width+1),i=Math.min(i,r.y-1),u=Math.max(u,r.y+r.height+1)}return{minX:o,maxX:l,minY:i,maxY:u}};function Td(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f){const w=f.bgCell,{minX:C,maxX:p,minY:g,maxY:b}=Xu(r,i,u),k=[],x=u-Io(m,v,d);let M=a,B=n,R=0;for(;M+l<x;){const z=M+l,E=d(B);if(z>=g&&z<=b-1){const S=c==null?void 0:c(B),W=S==null?void 0:S.bgCell;W!==void 0&&W!==w&&B>=m-v&&k.push({x:C,y:z,w:p-C,h:E,color:W})}M+=E,B<m-v&&(R=M),B++}let F=0;const D=Math.min(x,b)-R;if(D>0)for(let z=0;z<t.length;z++){var I;const E=t[z];if(E.width===0)continue;const S=E.sticky?F:F+o,W=(I=E.themeOverride)===null||I===void 0?void 0:I.bgCell;W!==void 0&&W!==w&&S>=C&&S<=p&&h(z+1)&&k.push({x:S,y:R,w:E.width,h:D,color:W}),F+=E.width}if(k.length===0)return;let T;e.beginPath();for(let z=k.length-1;z>=0;z--){const E=k[z];T===void 0?T=E.color:E.color!==T&&(e.fillStyle=T,e.fill(),e.beginPath(),T=E.color),e.rect(E.x,E.y,E.w,E.h)}T!==void 0&&(e.fillStyle=T,e.fill()),e.beginPath()}function qr(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C){var p;let g=arguments.length>17&&arguments[17]!==void 0?arguments[17]:!1;if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,u);for(const S of a)e.rect(S.x+1,S.y+1,S.width-1,S.height-1);e.clip("evenodd")}const b=(p=C.horizontalBorderColor)!==null&&p!==void 0?p:C.borderColor,k=C.borderColor,{minX:x,maxX:M,minY:B,maxY:R}=Xu(r,i,u),F=[];e.beginPath();let D=.5;for(let S=0;S<t.length;S++){const W=t[S];if(W.width===0)continue;D+=W.width;const N=W.sticky?D:D+o;N>=x&&N<=M&&m(S+1)&&F.push({x1:N,y1:Math.max(d,B),x2:N,y2:Math.min(u,R),color:k})}let I=u+.5;for(let S=w-f;S<w;S++){const W=h(S);I-=W,F.push({x1:x,y1:I,x2:M,y2:I,color:b})}if(g!==!0){let S=c+.5,W=n;const N=I;for(;S+l<N;){const J=S+l;if(J>=B&&J<=R-1){var T,z;const G=v==null?void 0:v(W);F.push({x1:x,y1:J,x2:M,y2:J,color:(T=(z=G==null?void 0:G.horizontalBorderColor)!==null&&z!==void 0?z:G==null?void 0:G.borderColor)!==null&&T!==void 0?T:b})}S+=h(W),W++}}const E=Ys(F,S=>S.color);for(const S of Object.keys(E)){e.strokeStyle=S;for(const W of E[S])e.moveTo(W.x1,W.y1),e.lineTo(W.x2,W.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function zd(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C,p,g){const b=[];e.imageSmoothingEnabled=!1;const k=Math.min(l.cellYOffset,u),x=Math.max(l.cellYOffset,u);let M=0;if(typeof p=="number")M+=(x-k)*p;else for(let E=k;E<x;E++)M+=p(E);u>l.cellYOffset&&(M=-M),M+=a-l.translateY;const B=Math.min(l.cellXOffset,i),R=Math.max(l.cellXOffset,i);let F=0;for(let E=B;E<R;E++)F+=w[E].width;i>l.cellXOffset&&(F=-F),F+=r-l.translateX;const D=ol(C);if(F!==0&&M!==0)return{regions:[]};const I=d>0?Io(v,d,p):0,T=c-D-Math.abs(F),z=h-m-I-Math.abs(M)-1;if(T>150&&z>150){const E={sx:0,sy:0,sw:c*f,sh:h*f,dx:0,dy:0,dw:c*f,dh:h*f};if(M>0?(E.sy=(m+1)*f,E.sh=z*f,E.dy=(M+m+1)*f,E.dh=z*f,b.push({x:0,y:m,width:c,height:M+1})):M<0&&(E.sy=(-M+m+1)*f,E.sh=z*f,E.dy=(m+1)*f,E.dh=z*f,b.push({x:0,y:h+M-I,width:c,height:-M+I})),F>0?(E.sx=D*f,E.sw=T*f,E.dx=(F+D)*f,E.dw=T*f,b.push({x:D-1,y:0,width:F+2,height:h})):F<0&&(E.sx=(D-F)*f,E.sw=T*f,E.dx=D*f,E.dw=T*f,b.push({x:c+F,y:0,width:-F,height:h})),e.setTransform(1,0,0,1,0,0),g){if(D>0&&F!==0&&M===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const S=D*f,W=h*f;e.drawImage(t,0,0,S,W,0,0,S,W)}if(I>0&&F===0&&M!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const S=(h-I)*f,W=c*f,N=I*f;e.drawImage(t,0,S,W,N,0,S,W,N)}}e.drawImage(t,E.sx,E.sy,E.sw,E.sh,E.dx,E.dy,E.dw,E.dh),e.scale(f,f)}return e.imageSmoothingEnabled=!0,{regions:b}}function Pd(e,t,n,o,l,i,u,r,a,d){const c=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||l!==e.translateY||wo(a,n,o,l,r,(h,v,m,f)=>{if(h.sourceIndex===d){const w=Math.max(v,f)+1;return c.push({x:w,y:0,width:i-w,height:u}),!0}}),c}function Ld(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const l=e.mappedColumns[o],i=t.mappedColumns[o];if(el(l,i))continue;if(n!==void 0||l.width===i.width)return!1;const{width:u,...r}=l,{width:a,...d}=i;if(!el(r,d))return!1;n=o}return n===void 0?!0:n}return!0}function Zr(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C,p){const g=f==null?void 0:f.filter(F=>F.style!=="no-outline");if(g===void 0||g.length===0)return;const b=ol(r),k=Io(m,v,h),x=[a,0,r.length,m-v],M=[b,0,t,n-k],B=g.map(F=>{var D;const I=F.range,T=(D=F.style)!==null&&D!==void 0?D:"dashed";return Fd(I,x,t,n,M).map(z=>{const E=z.rect,S=ji(E.x,E.y,t,n,c,d+c,o,l,i,u,m,a,v,r,h,C,p),W=E.width===1&&E.height===1?S:ji(E.x+E.width-1,E.y+E.height-1,t,n,c,d+c,o,l,i,u,m,a,v,r,h,C,p);return E.x+E.width>=r.length&&(W.width-=1),E.y+E.height>=m&&(W.height-=1),{color:F.color,style:T,clip:z.clip,rect:xd({x:S.x,y:S.y,width:W.x+W.width-S.x,height:W.y+W.height-S.y},t,n,8)}})}),R=()=>{e.lineWidth=1;let F=!1;for(const D of B)for(const I of D)if((I==null?void 0:I.rect)!==void 0&&Dl(0,0,t,n,I.rect.x,I.rect.y,I.rect.width,I.rect.height)){const T=F,z=!kd(I.clip,I.rect);e.beginPath(),z&&(e.save(),e.rect(I.clip.x,I.clip.y,I.clip.width,I.clip.height),e.clip()),I.style==="dashed"&&!F?(e.setLineDash([5,3]),F=!0):(I.style==="solid"||I.style==="solid-outline")&&F&&(e.setLineDash([]),F=!1),e.strokeStyle=I.style==="solid-outline"?mn(mn(I.color,w.borderColor),w.bgCell):mo(I.color,1),e.closePath(),e.strokeRect(I.rect.x+.5,I.rect.y+.5,I.rect.width-1,I.rect.height-1),z&&(e.restore(),F=T)}F&&e.setLineDash([])};return R(),R}function Jr(e,t,n,o,l){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=l,e.stroke(),e.globalAlpha=1}function Wi(e,t,n,o,l,i,u,r,a,d,c,h,v,m,f,w,C){var p;if(c.current===void 0)return;const g=w!==!1&&w!==void 0;if(!g)return;const b=typeof w=="object"?{...ui,...w}:ui,k=c.current.range,x=c.current.cell,M=[k.x+k.width-1,k.y+k.height-1];if(x[1]>=C&&M[1]>=C||!u.some(N=>N.sourceIndex===x[0]||N.sourceIndex===M[0]))return;const[R,F]=c.current.cell,D=v(c.current.cell),I=(p=D.span)!==null&&p!==void 0?p:[R,R],T=F>=C-m,z=m>0&&!T?Io(C,m,h)-1:0,E=M[1];let S;if(wo(u,o,l,i,d,(N,J,G,j,_)=>{if(N.sticky&&R>N.sourceIndex)return;const Y=N.sourceIndex<I[0],V=N.sourceIndex>I[1],ee=N.sourceIndex===M[0];if(!(!ee&&(Y||V)))return hi(_,G,n,C,h,m,f,void 0,(de,me,$)=>{if(me!==F&&me!==E)return;let Ce=J,O=N.width;if(D.span!==void 0){const Q=Ou(D.span,J,de,N.width,$,N,r),he=N.sticky?Q[0]:Q[1];he!==void 0&&(Ce=he.x,O=he.width)}return me===E&&ee&&g&&(S=()=>{var Q,he;j>Ce&&!N.sticky&&(e.beginPath(),e.rect(j,0,t-j,n),e.clip());const U=b.size,ae=U/2,ke=Ce+O+b.offsetX-ae+.5,te=de+$+b.offsetY-ae+.5;e.beginPath(),b.shape==="circle"?e.arc(ke+ae,te+ae,ae,0,Math.PI*2):e.rect(ke,te,U,U),e.fillStyle=(Q=(he=N.themeOverride)===null||he===void 0?void 0:he.accentColor)!==null&&Q!==void 0?Q:a.accentColor,e.fill(),b.outline>0&&(e.lineWidth=b.outline,e.strokeStyle=a.bgCell,b.shape==="circle"?(e.beginPath(),e.arc(ke+ae,te+ae,ae+b.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(ke-b.outline/2,te-b.outline/2,U+b.outline,U+b.outline))}),S!==void 0}),S!==void 0}),S===void 0)return;const W=()=>{var N;e.save(),e.beginPath(),e.rect(0,d,t,n-d-z),e.clip(),(N=S)===null||N===void 0||N(),e.restore()};return W(),W}function Od(e,t,n,o,l,i,u,r,a){a===void 0||a.size===0||(e.beginPath(),wo(t,r,i,u,l,(d,c,h,v)=>{const m=Math.max(0,v-c),f=c+m+1,w=d.width-m-1;a.has([d.sourceIndex,-1])&&e.rect(f,o,w,l-o)}),e.clip())}function Wd(e,t,n,o,l,i,u,r,a,d){let c=0;return wo(e,i,o,l,n,(h,v,m,f,w)=>(hi(w,m,t,u,r,a,d,void 0,(C,p,g,b)=>{b||(c=Math.max(p,c))}),!0)),c}function Qr(e,t){var n,o;const{canvasCtx:l,headerCanvasCtx:i,width:u,height:r,cellXOffset:a,cellYOffset:d,translateX:c,translateY:h,mappedColumns:v,enableGroups:m,freezeColumns:f,dragAndDropState:w,theme:C,drawFocus:p,headerHeight:g,groupHeaderHeight:b,groupLevels:k,groupHeaderHeights:x,disabledRows:M,rowHeight:B,verticalBorder:R,overrideCursor:F,isResizing:D,selection:I,fillHandle:T,freezeTrailingRows:z,rows:E,getCellContent:S,getGroupDetails:W,getRowThemeOverride:N,isFocused:J,drawHeaderCallback:G,prelightCells:j,drawCellCallback:_,highlightRegions:Y,resizeCol:V,imageLoader:ee,lastBlitData:de,hoverValues:me,hyperWrapping:$,hoverInfo:Ce,spriteManager:O,maxScaleFactor:ve,hasAppendRow:Q,touchMode:he,enqueue:U,renderStateProvider:ae,getCellRenderer:ke,renderStrategy:te,bufferACtx:Be,bufferBCtx:Ye,damage:ce,minimumCellWidth:H,resizeIndicator:re}=e;if(u===0||r===0)return;const ge=te==="double-buffer",ne=Math.min(ve,Math.ceil((n=window.devicePixelRatio)!==null&&n!==void 0?n:1)),Re=te!=="direct"&&Ld(e,t),De=l.canvas;(De.width!==u*ne||De.height!==r*ne)&&(De.width=u*ne,De.height=r*ne,De.style.width=u+"px",De.style.height=r+"px");const xe=i.canvas,Ie=x.reduce((Le,Bt)=>Le+Bt,0),fe=g+Ie,Fe=fe+1;(xe.width!==u*ne||xe.height!==Fe*ne)&&(xe.width=u*ne,xe.height=Fe*ne,xe.style.width=u+"px",xe.style.height=Fe+"px");const ze=Be.canvas,Xe=Ye.canvas;ge&&(ze.width!==u*ne||ze.height!==r*ne)&&(ze.width=u*ne,ze.height=r*ne,de.current!==void 0&&(de.current.aBufferScroll=void 0)),ge&&(Xe.width!==u*ne||Xe.height!==r*ne)&&(Xe.width=u*ne,Xe.height=r*ne,de.current!==void 0&&(de.current.bBufferScroll=void 0));const be=de.current;if(Re===!0&&a===(be==null?void 0:be.cellXOffset)&&d===(be==null?void 0:be.cellYOffset)&&c===(be==null?void 0:be.translateX)&&h===(be==null?void 0:be.translateY))return;let Ve=null;ge&&(Ve=l);const nt=i;let je;ge?ce!==void 0?je=(be==null?void 0:be.lastBuffer)==="b"?Ye:Be:je=(be==null?void 0:be.lastBuffer)==="b"?Be:Ye:je=l;const Ue=je.canvas,at=ge?Ue===ze?Xe:ze:De,ct=typeof B=="number"?()=>B:B;nt.save(),je.save(),nt.beginPath(),je.beginPath(),nt.textBaseline="middle",je.textBaseline="middle",ne!==1&&(nt.scale(ne,ne),je.scale(ne,ne));const qe=Ui(v,a,u,w,c);let vt=[];const Pe=p&&((o=I.current)===null||o===void 0?void 0:o.cell[1])===d&&h===0;let ot=!1;if(Y!==void 0){for(const Le of Y)if(Le.style!=="no-outline"&&Le.range.y===d&&h===0){ot=!0;break}}const Mt=()=>{var Le,Bt;nt.fillStyle=C.bgHeader,nt.fillRect(0,0,u,fe+1),Md(nt,qe,v,m,Ce,u,c,g,b,w,D,I,C,O,me,R,W,ce,G,he,k,x),qr(nt,qe,d,c,h,u,r,void 0,void 0,Ie,fe,ct,N,R,z,E,C,!0),nt.beginPath(),nt.moveTo(0,Fe-.5),nt.lineTo(u,Fe-.5),nt.strokeStyle=mn((Le=(Bt=C.headerBottomBorderColor)!==null&&Bt!==void 0?Bt:C.horizontalBorderColor)!==null&&Le!==void 0?Le:C.borderColor,C.bgHeader),nt.stroke(),ot&&Zr(nt,u,r,a,d,c,h,v,f,g,Ie,B,z,E,Y,C,k,x),Pe&&Wi(nt,u,r,d,c,h,qe,v,C,fe,I,ct,S,z,Q,T,E)};if(ce!==void 0){const Le=qe[qe.length-1].sourceIndex+1,Bt=ce.hasItemInRegion([{x:a,y:-2,width:Le,height:2},{x:a,y:d,width:Le,height:300},{x:0,y:d,width:f,height:300},{x:0,y:-2,width:f,height:2},{x:a,y:E-z,width:Le,height:z,when:z>0}]),Rt=Jt=>{Ur(Jt,qe,v,r,fe,c,h,d,E,ct,S,W,N,M,J,p,z,Q,vt,ce,I,j,Y,ee,O,me,Ce,_,$,C,U,ae,ke,F,H);const Cn=I.current;T!==!1&&T!==void 0&&p&&Cn!==void 0&&ce.has(Su(Cn.range))&&Wi(Jt,u,r,d,c,h,qe,v,C,fe,I,ct,S,z,Q,T,E)};Bt&&(Rt(je),Ve!==null&&(Ve.save(),Ve.scale(ne,ne),Ve.textBaseline="middle",Rt(Ve),Ve.restore()),ce.hasHeader()&&(Od(nt,qe,u,Ie,fe,c,h,d,ce),Mt())),je.restore(),nt.restore();return}if((Re!==!0||a!==(be==null?void 0:be.cellXOffset)||d!==(be==null?void 0:be.cellYOffset)||c!==(be==null?void 0:be.translateX)||h!==(be==null?void 0:be.translateY)||Pe!==(be==null?void 0:be.mustDrawFocusOnHeader)||ot!==(be==null?void 0:be.mustDrawHighlightRingsOnHeader))&&Mt(),Re===!0){vn(at!==void 0&&be!==void 0);const{regions:Le}=zd(je,at,at===ze?be.aBufferScroll:be.bBufferScroll,at===ze?be.bBufferScroll:be.aBufferScroll,be,a,d,c,h,z,u,r,E,fe,ne,v,qe,B,ge);vt=Le}else Re!==!1&&(vn(be!==void 0),vt=Pd(be,a,d,c,h,u,r,fe,qe,Re));Hd(je,qe,u,r,z,E,R,ct,C);const Ht=Zr(je,u,r,a,d,c,h,v,f,g,Ie,B,z,E,Y,C,k,x),xt=p?Wi(je,u,r,d,c,h,qe,v,C,fe,I,ct,S,z,Q,T,E):void 0;if(je.fillStyle=C.bgCell,vt.length>0){je.beginPath();for(const Le of vt)je.rect(Le.x,Le.y,Le.width,Le.height);je.clip(),je.fill(),je.beginPath()}else je.fillRect(0,0,u,r);const Wt=Ur(je,qe,v,r,fe,c,h,d,E,ct,S,W,N,M,J,p,z,Q,vt,ce,I,j,Y,ee,O,me,Ce,_,$,C,U,ae,ke,F,H);Id(je,qe,v,u,r,fe,c,h,d,E,ct,N,I.rows,M,z,Q,vt,ce,C),Td(je,qe,d,c,h,u,r,vt,fe,ct,N,R,z,E,C),qr(je,qe,d,c,h,u,r,vt,Wt,Ie,fe,ct,N,R,z,E,C),Ht==null||Ht(),xt==null||xt(),D&&re!=="none"&&wo(qe,0,c,0,fe,(Le,Bt)=>{if(Le.sourceIndex===V){var Rt;if(Jr(nt,Bt+Le.width,0,fe+1,mn((Rt=C.resizeIndicatorColor)!==null&&Rt!==void 0?Rt:C.accentLight,C.bgHeader)),re==="full"){var Jt;Jr(je,Bt+Le.width,fe,r,mn((Jt=C.resizeIndicatorColor)!==null&&Jt!==void 0?Jt:C.accentLight,C.bgCell))}return!0}return!1}),Ve!==null&&(Ve.fillStyle=C.bgCell,Ve.fillRect(0,0,u,r),Ve.drawImage(je.canvas,0,0));const wt=Wd(qe,r,fe,c,h,d,E,ct,z,Q);ee==null||ee.setWindow({x:a,y:d,width:qe.length,height:wt-d},f,Array.from({length:z},(Le,Bt)=>E-1-Bt));const Zt=be!==void 0&&(a!==be.cellXOffset||c!==be.translateX),pn=be!==void 0&&(d!==be.cellYOffset||h!==be.translateY);de.current={cellXOffset:a,cellYOffset:d,translateX:c,translateY:h,mustDrawFocusOnHeader:Pe,mustDrawHighlightRingsOnHeader:ot,lastBuffer:ge?Ue===ze?"a":"b":void 0,aBufferScroll:Ue===ze?[Zt,pn]:be==null?void 0:be.aBufferScroll,bBufferScroll:Ue===Xe?[Zt,pn]:be==null?void 0:be.bBufferScroll},je.restore(),nt.restore()}const Nd=80;function $d(e){const t=e-1;return t*t*t+1}class Gd{constructor(t){this.callback=void 0,this.currentHoveredItem=void 0,this.leavingItems=[],this.lastAnimationTime=void 0,this.addToLeavingItems=n=>{this.leavingItems.some(l=>kl(l.item,n.item))||this.leavingItems.push(n)},this.removeFromLeavingItems=n=>{var o;const l=this.leavingItems.find(i=>kl(i.item,n));return this.leavingItems=this.leavingItems.filter(i=>i!==l),(o=l==null?void 0:l.hoverAmount)!==null&&o!==void 0?o:0},this.cleanUpLeavingElements=()=>{this.leavingItems=this.leavingItems.filter(n=>n.hoverAmount>0)},this.shouldStep=()=>{const n=this.leavingItems.length>0,o=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return n||o},this.getAnimatingItems=()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(n=>({...n,hoverAmount:$d(n.hoverAmount)})),this.step=n=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=n;else{const l=(n-this.lastAnimationTime)/Nd;for(const u of this.leavingItems)u.hoverAmount=xn(u.hoverAmount-l,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=xn(this.currentHoveredItem.hoverAmount+l,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=n,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0},this.setHovered=n=>{var o;if(!kl((o=this.currentHoveredItem)===null||o===void 0?void 0:o.item,n)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),n!==void 0){const l=this.removeFromLeavingItems(n);this.currentHoveredItem={item:n,hoverAmount:l}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}},this.callback=t}}class Xd{constructor(t){this.fn=void 0,this.val=void 0,this.fn=t}get value(){var t;return(t=this.val)!==null&&t!==void 0?t:this.val=this.fn()}}function ar(e){return new Xd(e)}const Kd=ar(()=>window.navigator.userAgent.includes("Firefox")),di=ar(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),gi=ar(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Yd(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const l=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(u),u=()=>{const r=t.current.map(ur);t.current=[],o.current(new _o(r)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:u)},[]);return s.useCallback(i=>{t.current.length===0&&l();const u=Rn(i[0],i[1]);t.current.includes(u)||t.current.push(u)},[l])}const ho="header",An="group-header",ci="out-of-bounds";var Qo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Qo||(Qo={}));function Ku(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Vd=(e,t)=>{var n;if(e.kind===ie.Custom)return e.copyData;const o=t==null?void 0:t(e);return(n=o==null?void 0:o.getAccessibilityString(e))!==null&&n!==void 0?n:""},Ud=(e,t)=>{var n,o,l,i,u,r,a,d,c,h,v;const{width:m,height:f,accessibilityHeight:w,columns:C,cellXOffset:p,cellYOffset:g,headerHeight:b,fillHandle:k=!1,groupHeaderHeight:x,groupLevels:M,groupHeaderHeights:B,rowHeight:R,rows:F,getCellContent:D,getRowThemeOverride:I,onHeaderMenuClick:T,onHeaderIndicatorClick:z,enableGroups:E,isFilling:S,onCanvasFocused:W,onCanvasBlur:N,isFocused:J,selection:G,freezeColumns:j,onContextMenu:_,freezeTrailingRows:Y,fixedShadowX:V=!0,fixedShadowY:ee=!0,drawFocusRing:de,onMouseDown:me,onMouseUp:$,onMouseMoveRaw:Ce,onMouseMove:O,onItemHovered:ve,dragAndDropState:Q,firstColAccessible:he,onKeyDown:U,onKeyUp:ae,highlightRegions:ke,canvasRef:te,onDragStart:Be,onDragEnd:Ye,eventTargetRef:ce,isResizing:H,resizeColumn:re,isDragging:ge,isDraggable:ne=!1,allowResize:Re,disabledRows:De,hasAppendRow:xe,getGroupDetails:Ie,theme:fe,prelightCells:Fe,headerIcons:ze,verticalBorder:Xe,drawCell:be,drawHeader:Ve,onCellFocused:nt,onDragOverCell:je,onDrop:Ue,onDragLeave:at,imageWindowLoader:ct,smoothScrollX:qe=!1,smoothScrollY:vt=!1,experimental:Pe,getCellRenderer:ot,resizeIndicator:Mt="full"}=e,Ht=(n=e.translateX)!==null&&n!==void 0?n:0,xt=(o=e.translateY)!==null&&o!==void 0?o:0,Wt=Math.max(j,Math.min(C.length-1,p)),wt=s.useRef(null),Zt=s.useRef((l=Pe==null?void 0:Pe.eventTarget)!==null&&l!==void 0?l:window),pn=Zt.current,Le=ct,Bt=s.useRef(),[Rt,Jt]=s.useState(!1),Cn=s.useRef([]),Bn=s.useRef(),[on,In]=s.useState(),[Yt,ln]=s.useState(),Ge=s.useRef(null),[pt,rt]=s.useState(),[Gt,Xt]=s.useState(!1),mt=s.useRef(Gt);mt.current=Gt;const Nn=s.useMemo(()=>new Cd(ze,()=>{At.current=void 0,Co.current()}),[ze]),vi=E?B.reduce((P,q)=>P+q,0):0,qn=b+vi,Zn=s.useRef(-1),il=((i=Pe==null?void 0:Pe.enableFirefoxRescaling)!==null&&i!==void 0?i:!1)&&Kd.value,it=((u=Pe==null?void 0:Pe.enableSafariRescaling)!==null&&u!==void 0?u:!1)&&di.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!il&&!it||(Zn.current!==-1&&Jt(!0),window.clearTimeout(Zn.current),Zn.current=window.setTimeout(()=>{Jt(!1),Zn.current=-1},200))},[g,Wt,Ht,xt,il,it]);const ft=xa(C,j),To=s.useMemo(()=>V?ol(ft,Q):0,[ft,Q,V]),Lt=s.useCallback((P,q,Ee)=>{const Se=P.getBoundingClientRect();if(q>=ft.length||Ee>=F)return;const we=Se.width/m,Me=ji(q,Ee,m,f,x,qn,Wt,g,Ht,xt,F,j,Y,ft,R,M,B);return we!==1&&(Me.x*=we,Me.y*=we,Me.width*=we,Me.height*=we),Me.x+=Se.x,Me.y+=Se.y,Me},[m,f,x,qn,Wt,g,Ht,xt,F,j,Y,ft,R,M,B]),Ot=s.useCallback((P,q,Ee,Se)=>{const we=P.getBoundingClientRect(),Me=we.width/m,Oe=(q-we.left)/Me,lt=(Ee-we.top)/Me,ye=5,yt=Ui(ft,Wt,m,void 0,Ht);let We=0,Ne=0;const Et=typeof PointerEvent<"u"&&Se instanceof PointerEvent&&Se.pointerType==="mouse"||typeof MouseEvent<"u"&&Se instanceof MouseEvent,X=typeof PointerEvent<"u"&&Se instanceof PointerEvent&&Se.pointerType==="touch"||typeof TouchEvent<"u"&&Se instanceof TouchEvent;Et&&(We=Se.button,Ne=Se.buttons);const ut=Ma(Oe,yt,Ht),$e=Ra(lt,f,E,b,x,F,R,g,xt,Y,M,B),Vt=(Se==null?void 0:Se.shiftKey)===!0,zt=(Se==null?void 0:Se.ctrlKey)===!0,bn=(Se==null?void 0:Se.metaKey)===!0,zn=[Oe<0?-1:m<Oe?1:0,lt<qn?-1:f<lt?1:0];let fn;if(ut===-1||lt<0||Oe<0||$e===void 0||Oe>m||lt>f){const ht=Oe>m?1:Oe<0?-1:0,pe=lt>f?1:lt<0?-1:0;let Kt=ht*2,_t=pe*2;ht===0&&(Kt=ut===-1?Qo.EndPadding:Qo.Center),pe===0&&(_t=$e===void 0?Qo.EndPadding:Qo.Center);let hn=!1;if(ut===-1&&$e===-1){const Fn=Lt(P,ft.length-1,-1);vn(Fn!==void 0),hn=q<Fn.x+Fn.width+ye}const ko=Oe>m&&Oe<m+Yi()||lt>f&&lt<f+Yi();fn={kind:ci,location:[ut!==-1?ut:Oe<0?0:ft.length-1,$e??F-1],region:[Kt,_t],shiftKey:Vt,ctrlKey:zt,metaKey:bn,isEdge:hn,isTouch:X,button:We,buttons:Ne,scrollEdge:zn,isMaybeScrollbar:ko}}else if($e<=-1){let ht=Lt(P,ut,$e);vn(ht!==void 0);let pe=ht!==void 0&&ht.x+ht.width-q<=ye;const Kt=E&&$e<=-2,_t=Kt?-($e+2):void 0,hn=ut-1;q-ht.x<=ye&&hn>=0?(pe=!0,ht=Lt(P,hn,$e),vn(ht!==void 0),fn={kind:Kt?An:ho,location:[hn,$e],bounds:ht,group:Bo(ft[hn].group,_t),isEdge:pe,shiftKey:Vt,ctrlKey:zt,metaKey:bn,isTouch:X,localEventX:q-ht.x,localEventY:Ee-ht.y,button:We,buttons:Ne,scrollEdge:zn}):fn={kind:Kt?An:ho,group:Bo(ft[ut].group,_t),location:[ut,$e],bounds:ht,isEdge:pe,shiftKey:Vt,ctrlKey:zt,metaKey:bn,isTouch:X,localEventX:q-ht.x,localEventY:Ee-ht.y,button:We,buttons:Ne,scrollEdge:zn}}else{const ht=Lt(P,ut,$e);vn(ht!==void 0);const pe=ht!==void 0&&ht.x+ht.width-q<ye;let Kt=!1;if(k!==!1&&k!==void 0&&G.current!==void 0){const hn=typeof k=="object"?{...ui,...k}:ui,ko=hn.size,Fn=ko/2,Dn=Su(G.current.range),io=Lt(P,Dn[0],Dn[1]);if(io!==void 0){const Ei=io.x+io.width+hn.offsetX-Fn+.5,ki=io.y+io.height+hn.offsetY-Fn+.5;Kt=Math.abs(Ei-q)<ko&&Math.abs(ki-Ee)<ko}}fn={kind:"cell",location:[ut,$e],bounds:ht,isEdge:pe,shiftKey:Vt,ctrlKey:zt,isFillHandle:Kt,metaKey:bn,isTouch:X,localEventX:q-ht.x,localEventY:Ee-ht.y,button:We,buttons:Ne,scrollEdge:zn}}return fn},[m,ft,Wt,Ht,f,E,b,x,F,R,g,xt,Y,Lt,k,G,qn,M,B]),[qt]=on??[],Sl=s.useRef(()=>{}),Jn=s.useRef(on);Jn.current=on;const[dn,cn]=s.useMemo(()=>{const P=document.createElement("canvas"),q=document.createElement("canvas");return P.style.display="none",P.style.opacity="0",P.style.position="fixed",q.style.display="none",q.style.opacity="0",q.style.position="fixed",[P.getContext("2d",{alpha:!1}),q.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(dn===null||cn===null))return document.documentElement.append(dn.canvas),document.documentElement.append(cn.canvas),()=>{dn.canvas.remove(),cn.canvas.remove()}},[dn,cn]);const Hn=s.useMemo(()=>new Oa,[]),po=il&&Rt?1:it&&Rt?2:5,Ml=(Pe==null?void 0:Pe.disableMinimumCellWidth)===!0?1:10,At=s.useRef(),zo=s.useRef(null),Po=s.useRef(null),Lo=s.useCallback(()=>{var P,q,Ee;const Se=wt.current,we=Ge.current;if(Se===null||we===null||(zo.current===null&&(zo.current=Se.getContext("2d",{alpha:!1}),Se.width=0,Se.height=0),Po.current===null&&(Po.current=we.getContext("2d",{alpha:!1}),we.width=0,we.height=0),zo.current===null||Po.current===null||dn===null||cn===null))return;let Me=!1;const Oe=yt=>{Me=!0,rt(yt)},lt=At.current,ye={headerCanvasCtx:Po.current,canvasCtx:zo.current,bufferACtx:dn,bufferBCtx:cn,width:m,height:f,cellXOffset:Wt,cellYOffset:g,translateX:Math.round(Ht),translateY:Math.round(xt),mappedColumns:ft,enableGroups:E,freezeColumns:j,dragAndDropState:Q,theme:fe,headerHeight:b,groupHeaderHeight:x,groupLevels:M,groupHeaderHeights:B,disabledRows:De??tt.empty(),rowHeight:R,verticalBorder:Xe,isResizing:H,resizeCol:re,isFocused:J,selection:G,fillHandle:k,drawCellCallback:be,hasAppendRow:xe,overrideCursor:Oe,maxScaleFactor:po,freezeTrailingRows:Y,rows:F,drawFocus:de,getCellContent:D,getGroupDetails:Ie??(yt=>({name:yt})),getRowThemeOverride:I,drawHeaderCallback:Ve,prelightCells:Fe,highlightRegions:ke,imageLoader:Le,lastBlitData:Bn,damage:Bt.current,hoverValues:Cn.current,hoverInfo:Jn.current,spriteManager:Nn,scrolling:Rt,hyperWrapping:(P=Pe==null?void 0:Pe.hyperWrapping)!==null&&P!==void 0?P:!1,touchMode:Gt,enqueue:Sl.current,renderStateProvider:Hn,renderStrategy:(q=Pe==null?void 0:Pe.renderStrategy)!==null&&q!==void 0?q:di.value?"double-buffer":"single-buffer",getCellRenderer:ot,minimumCellWidth:Ml,resizeIndicator:Mt};ye.damage===void 0?(At.current=ye,Qr(ye,lt)):Qr(ye,void 0),!Me&&(ye.damage===void 0||ye.damage.has(Jn==null||(Ee=Jn.current)===null||Ee===void 0?void 0:Ee[0]))&&rt(void 0)},[dn,cn,m,f,Wt,g,Ht,xt,ft,E,j,Q,fe,b,x,M,B,De,R,Xe,H,xe,re,J,G,k,Y,F,de,po,D,Ie,I,be,Ve,Fe,ke,Le,Nn,Rt,Pe==null?void 0:Pe.hyperWrapping,Pe==null?void 0:Pe.renderStrategy,Gt,Hn,ot,Ml,Mt]),Co=s.useRef(Lo);s.useLayoutEffect(()=>{Lo(),Co.current=Lo},[Lo]),s.useLayoutEffect(()=>{(async()=>{var q;((q=document)===null||q===void 0||(q=q.fonts)===null||q===void 0?void 0:q.ready)!==void 0&&(await document.fonts.ready,At.current=void 0,Co.current())})()},[]);const Qn=s.useCallback(P=>{Bt.current=P,Co.current(),Bt.current=void 0},[]),mi=Yd(Qn);Sl.current=mi;const Rl=s.useCallback(P=>{Qn(new _o(P.map(q=>q.cell)))},[Qn]);Le.setCallback(Qn);const[bo,wi]=s.useState(!1),[$n,_n]=qt??[],pi=$n!==void 0&&_n===-1&&$n>=0&&$n<ft.length&&ft[$n].headerRowMarkerDisabled!==!0,Ci=$n!==void 0&&_n===-2;let Al=!1,Bl=!1,Oo=pt;if(Oo===void 0&&$n!==void 0&&_n!==void 0&&_n>-1&&_n<F){const P=D([$n,_n],!0);Al=P.kind===$t.NewRow||P.kind===$t.Marker&&P.markerKind!=="number",Bl=P.kind===ie.Boolean&&_i(P),Oo=P.cursor}const Il=ge?"grabbing":(Yt??!1)||H?"col-resize":bo||S?"crosshair":Oo!==void 0?Oo:pi||Al||Bl||Ci?"pointer":"default",Wo=s.useMemo(()=>({contain:"strict",display:"block",cursor:Il}),[Il]),Hl=s.useRef("default"),rl=ce==null?void 0:ce.current;rl!=null&&Hl.current!==Wo.cursor&&(rl.style.cursor=Hl.current=Wo.cursor);const No=s.useCallback((P,q,Ee,Se)=>{if(Ie===void 0)return;const we=Ie(P);if(we.actions!==void 0){const Me=sr(q,we.actions);for(const[Oe,lt]of Me.entries())if(go(lt,Ee+q.x,Se+lt.y))return we.actions[Oe]}},[Ie]),Tn=s.useCallback((P,q,Ee,Se)=>{const we=ft[q];if(!ge&&!H&&!(Yt??!1)){const Me=Lt(P,q,-1);vn(Me!==void 0);const Oe=$u(void 0,we,Me.x,Me.y,Me.width,Me.height,fe,nr(we.title)==="rtl");if(we.hasMenu===!0&&Oe.menuBounds!==void 0&&go(Oe.menuBounds,Ee,Se))return{area:"menu",bounds:Oe.menuBounds};if(we.indicatorIcon!==void 0&&Oe.indicatorIconBounds!==void 0&&go(Oe.indicatorIconBounds,Ee,Se))return{area:"indicator",bounds:Oe.indicatorIconBounds}}},[ft,Lt,Yt,ge,H,fe]),ul=s.useRef(0),eo=s.useRef(),$o=s.useRef(!1),Go=s.useCallback(P=>{const q=wt.current,Ee=ce==null?void 0:ce.current;if(q===null||P.target!==q&&P.target!==Ee)return;$o.current=!0;const Se=P.clientX,we=P.clientY;if(P.target===Ee&&Ee!==null){const Oe=Ee.getBoundingClientRect();if(Se>Oe.right||we>Oe.bottom)return}const Me=Ot(q,Se,we,P);eo.current=Me.location,Me.isTouch&&(ul.current=Date.now()),mt.current!==Me.isTouch&&Xt(Me.isTouch),!(Me.kind===ho&&Tn(q,Me.location[0],Se,we)!==void 0)&&(Me.kind===An&&No(Me.group,Me.bounds,Me.localEventX,Me.localEventY)!==void 0||(me==null||me(Me),!Me.isTouch&&ne!==!0&&ne!==Me.kind&&Me.button<3&&Me.button!==1&&P.preventDefault()))},[ce,ne,Ot,No,Tn,me]);tn("pointerdown",Go,pn,!1);const yo=s.useRef(0),Xo=s.useCallback(P=>{const q=yo.current;yo.current=Date.now();const Ee=wt.current;if($o.current=!1,$===void 0||Ee===null)return;const Se=ce==null?void 0:ce.current,we=P.target!==Ee&&P.target!==Se,Me=P.clientX,Oe=P.clientY,lt=P.pointerType==="mouse"?P.button<3:!0;let ye=Ot(Ee,Me,Oe,P);ye.isTouch&&ul.current!==0&&Date.now()-ul.current>500&&(ye={...ye,isLongTouch:!0}),q!==0&&Date.now()-q<(ye.isTouch?1e3:500)&&(ye={...ye,isDoubleClick:!0}),mt.current!==ye.isTouch&&Xt(ye.isTouch),!we&&P.cancelable&&lt&&P.preventDefault();const[yt]=ye.location,We=Tn(Ee,yt,Me,Oe);if(ye.kind===ho&&We!==void 0){var Ne,Et;(ye.button!==0||((Ne=eo.current)===null||Ne===void 0?void 0:Ne[0])!==yt||((Et=eo.current)===null||Et===void 0?void 0:Et[1])!==-1)&&$(ye,!0);return}else if(ye.kind===An){const X=No(ye.group,ye.bounds,ye.localEventX,ye.localEventY);if(X!==void 0){ye.button===0&&X.onClick(ye);return}}$(ye,we)},[$,ce,Ot,Tn,No]);tn("pointerup",Xo,pn,!1);const Tl=s.useCallback(P=>{const q=wt.current;if(q===null)return;const Ee=ce==null?void 0:ce.current,Se=P.target!==q&&P.target!==Ee;let we,Me,Oe=!0;P instanceof MouseEvent?(we=P.clientX,Me=P.clientY,Oe=P.button<3):(we=P.changedTouches[0].clientX,Me=P.changedTouches[0].clientY);const lt=Ot(q,we,Me,P);mt.current!==lt.isTouch&&Xt(lt.isTouch),!Se&&P.cancelable&&Oe&&P.preventDefault();const[ye]=lt.location;if(lt.kind===ho){var yt,We;const Ne=Tn(q,ye,we,Me);Ne!==void 0&&lt.button===0&&((yt=eo.current)===null||yt===void 0?void 0:yt[0])===ye&&((We=eo.current)===null||We===void 0?void 0:We[1])===-1&&(Ne.area==="menu"?T==null||T(ye,Ne.bounds):Ne.area==="indicator"&&(z==null||z(ye,Ne.bounds)))}},[ce,Ot,Tn,T,z]);tn("click",Tl,pn,!1);const Ke=s.useCallback(P=>{const q=wt.current,Ee=ce==null?void 0:ce.current;if(q===null||P.target!==q&&P.target!==Ee||_===void 0)return;const Se=Ot(q,P.clientX,P.clientY,P);_(Se,()=>{P.cancelable&&P.preventDefault()})},[ce,Ot,_]);tn("contextmenu",Ke,(r=ce==null?void 0:ce.current)!==null&&r!==void 0?r:null,!1);const zl=s.useCallback(P=>{Bt.current=new _o(P.map(q=>q.item)),Cn.current=P,Co.current(),Bt.current=void 0},[]),Eo=s.useMemo(()=>new Gd(zl),[zl]),Qt=s.useRef(Eo);Qt.current=Eo,s.useLayoutEffect(()=>{const P=Qt.current;if(qt===void 0||qt[1]<0){P.setHovered(qt);return}const q=D(qt,!0),Ee=ot(q),Se=Ee===void 0&&q.kind===ie.Custom||(Ee==null?void 0:Ee.needsHover)!==void 0&&(typeof Ee.needsHover=="boolean"?Ee.needsHover:Ee.needsHover(q));P.setHovered(Se?qt:void 0)},[D,ot,qt]);const rn=s.useRef(),sl=s.useCallback(P=>{const q=wt.current;if(q===null)return;const Ee=ce==null?void 0:ce.current,Se=P.target!==q&&P.target!==Ee,we=Ot(q,P.clientX,P.clientY,P);if(we.kind!=="out-of-bounds"&&Se&&!$o.current&&!we.isTouch)return;const Me=(ye,yt)=>{In(We=>We===ye||(We==null?void 0:We[0][0])===(ye==null?void 0:ye[0][0])&&(We==null?void 0:We[0][1])===(ye==null?void 0:ye[0][1])&&((We==null?void 0:We[1][0])===(ye==null?void 0:ye[1][0])&&(We==null?void 0:We[1][1])===(ye==null?void 0:ye[1][1])||!yt)?We:ye)};if(!Ku(we,rn.current))rt(void 0),ve==null||ve(we),Me(we.kind===ci?void 0:[we.location,[we.localEventX,we.localEventY]],!0),rn.current=we;else if(we.kind==="cell"||we.kind===ho||we.kind===An){let ye=!1,yt=!0;if(we.kind==="cell"){var Oe;const Ne=D(we.location),Et=(Oe=ot(Ne))===null||Oe===void 0?void 0:Oe.needsHoverPosition;yt=Et??Ne.kind===ie.Custom,ye=yt}else ye=!0;const We=[we.location,[we.localEventX,we.localEventY]];Me(We,yt),Jn.current=We,ye&&Qn(new _o([we.location]))}const lt=we.location[0]>=(he?0:1);ln(we.kind===ho&&we.isEdge&&lt&&Re===!0),wi(we.kind==="cell"&&we.isFillHandle),Ce==null||Ce(P),O(we)},[ce,Ot,he,Re,Ce,O,ve,D,ot,Qn]);tn("pointermove",sl,pn,!0);const al=s.useCallback(P=>{const q=wt.current;if(q===null)return;let Ee,Se;G.current!==void 0&&(Ee=Lt(q,G.current.cell[0],G.current.cell[1]),Se=G.current.cell),U==null||U({bounds:Ee,stopPropagation:()=>P.stopPropagation(),preventDefault:()=>P.preventDefault(),cancel:()=>{},ctrlKey:P.ctrlKey,metaKey:P.metaKey,shiftKey:P.shiftKey,altKey:P.altKey,key:P.key,keyCode:P.keyCode,rawEvent:P,location:Se})},[U,G,Lt]),dl=s.useCallback(P=>{const q=wt.current;if(q===null)return;let Ee,Se;G.current!==void 0&&(Ee=Lt(q,G.current.cell[0],G.current.cell[1]),Se=G.current.cell),ae==null||ae({bounds:Ee,stopPropagation:()=>P.stopPropagation(),preventDefault:()=>P.preventDefault(),cancel:()=>{},ctrlKey:P.ctrlKey,metaKey:P.metaKey,shiftKey:P.shiftKey,altKey:P.altKey,key:P.key,keyCode:P.keyCode,rawEvent:P,location:Se})},[ae,G,Lt]),cl=s.useCallback(P=>{if(wt.current=P,te!==void 0&&(te.current=P),Pe!=null&&Pe.eventTarget)Zt.current=Pe.eventTarget;else if(P===null)Zt.current=window;else{const q=P.getRootNode();q===document&&(Zt.current=window),Zt.current=q}},[te,Pe==null?void 0:Pe.eventTarget]),Pl=s.useCallback(P=>{const q=wt.current;if(q===null||ne===!1||H){P.preventDefault();return}let Ee,Se;const we=Ot(q,P.clientX,P.clientY);if(ne!==!0&&we.kind!==ne){P.preventDefault();return}const Me=(Et,X)=>{Ee=Et,Se=X};let Oe,lt,ye;const yt=(Et,X,ut)=>{Oe=Et,lt=X,ye=ut};let We=!1;if(Be==null||Be({...we,setData:Me,setDragImage:yt,preventDefault:()=>We=!0,defaultPrevented:()=>We}),!We&&Ee!==void 0&&Se!==void 0&&P.dataTransfer!==null)if(P.dataTransfer.setData(Ee,Se),P.dataTransfer.effectAllowed="copyLink",Oe!==void 0&&lt!==void 0&&ye!==void 0)P.dataTransfer.setDragImage(Oe,lt,ye);else{const[Et,X]=we.location;if(X!==void 0){var Ne;const ut=document.createElement("canvas"),$e=Lt(q,Et,X);vn($e!==void 0);const Vt=Math.ceil((Ne=window.devicePixelRatio)!==null&&Ne!==void 0?Ne:1);ut.width=$e.width*Vt,ut.height=$e.height*Vt;const zt=ut.getContext("2d");zt!==null&&(zt.scale(Vt,Vt),zt.textBaseline="middle",X===-1?(zt.font=fe.headerFontFull,zt.fillStyle=fe.bgHeader,zt.fillRect(0,0,ut.width,ut.height),Gu(zt,0,0,$e.width,$e.height,ft[Et],!1,fe,!1,void 0,void 0,!1,0,Nn,Ve,!1)):(zt.font=fe.baseFontFull,zt.fillStyle=fe.bgCell,zt.fillRect(0,0,ut.width,ut.height),Nu(zt,D([Et,X]),0,X,!1,!1,0,0,$e.width,$e.height,!1,fe,fe.bgCell,Le,Nn,1,void 0,!1,0,void 0,void 0,void 0,Hn,ot,()=>{},0))),ut.style.left="-100%",ut.style.position="absolute",ut.style.width=`${$e.width}px`,ut.style.height=`${$e.height}px`,document.body.append(ut),P.dataTransfer.setDragImage(ut,$e.width/2,$e.height/2),window.setTimeout(()=>{ut.remove()},0)}}else P.preventDefault()},[ne,H,Ot,Be,Lt,fe,ft,Nn,Ve,D,Le,Hn,ot]);tn("dragstart",Pl,(a=ce==null?void 0:ce.current)!==null&&a!==void 0?a:null,!1,!1);const to=s.useRef(),no=s.useCallback(P=>{var q;const Ee=wt.current;if(Ue!==void 0&&P.preventDefault(),Ee===null||je===void 0)return;const Se=Ot(Ee,P.clientX,P.clientY),[we,Me]=Se.location,Oe=we-(he?0:1),[lt,ye]=(q=to.current)!==null&&q!==void 0?q:[];(lt!==Oe||ye!==Me)&&(to.current=[Oe,Me],je([Oe,Me],P.dataTransfer))},[he,Ot,je,Ue]);tn("dragover",no,(d=ce==null?void 0:ce.current)!==null&&d!==void 0?d:null,!1,!1);const bi=s.useCallback(()=>{to.current=void 0,Ye==null||Ye()},[Ye]);tn("dragend",bi,(c=ce==null?void 0:ce.current)!==null&&c!==void 0?c:null,!1,!1);const fl=s.useCallback(P=>{const q=wt.current;if(q===null||Ue===void 0)return;P.preventDefault();const Ee=Ot(q,P.clientX,P.clientY),[Se,we]=Ee.location,Me=Se-(he?0:1);Ue([Me,we],P.dataTransfer)},[he,Ot,Ue]);tn("drop",fl,(h=ce==null?void 0:ce.current)!==null&&h!==void 0?h:null,!1,!1);const Ko=s.useCallback(()=>{at==null||at()},[at]);tn("dragleave",Ko,(v=ce==null?void 0:ce.current)!==null&&v!==void 0?v:null,!1,!1);const Ll=s.useRef(G);Ll.current=G;const oo=s.useRef(null),lo=s.useCallback(P=>{if(!(wt.current===null||!wt.current.contains(document.activeElement))){if(P===null&&Ll.current.current!==void 0){var q;te==null||(q=te.current)===null||q===void 0||q.focus({preventScroll:!0})}else P!==null&&P.focus({preventScroll:!0});oo.current=P}},[te]);s.useImperativeHandle(t,()=>({focus:()=>{const P=oo.current;if(P===null||!document.contains(P)){var q;te==null||(q=te.current)===null||q===void 0||q.focus({preventScroll:!0})}else P.focus({preventScroll:!0})},getBounds:(P,q)=>{if(!(te===void 0||te.current===null))return Lt(te.current,P??0,q??-1)},damage:Rl,getMouseArgsForPosition:(P,q,Ee)=>{if(!(te===void 0||te.current===null))return Ot(te.current,P,q,Ee)}}),[te,Rl,Lt,Ot]);const Gn=s.useRef(),hl=_s(()=>{var P,q,Ee,Se;if(m<50||(Pe==null?void 0:Pe.disableAccessibilityTree)===!0)return null;let we=Ui(ft,Wt,m,Q,Ht);const Me=he?0:-1;!he&&((P=we[0])===null||P===void 0?void 0:P.sourceIndex)===0&&(we=we.slice(1));const[Oe,lt]=(q=(Ee=G.current)===null||Ee===void 0?void 0:Ee.cell)!==null&&q!==void 0?q:[],ye=(Se=G.current)===null||Se===void 0?void 0:Se.range,yt=we.map(Ne=>Ne.sourceIndex),We=Ro(g,Math.min(F,g+w));return Oe!==void 0&&lt!==void 0&&!(yt.includes(Oe)&&We.includes(lt))&&lo(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":F+1,"aria-multiselectable":"true","aria-colcount":ft.length+Me},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},we.map(Ne=>s.createElement("th",{role:"columnheader","aria-selected":G.columns.hasIndex(Ne.sourceIndex),"aria-colindex":Ne.sourceIndex+1+Me,tabIndex:-1,onFocus:Et=>{if(Et.target!==oo.current)return nt==null?void 0:nt([Ne.sourceIndex,-1])},key:Ne.sourceIndex},Ne.title)))),s.createElement("tbody",{role:"rowgroup"},We.map(Ne=>s.createElement("tr",{role:"row","aria-selected":G.rows.hasIndex(Ne),key:Ne,"aria-rowindex":Ne+2},we.map(Et=>{const X=Et.sourceIndex,ut=Rn(X,Ne),$e=Oe===X&&lt===Ne,Vt=ye!==void 0&&X>=ye.x&&X<ye.x+ye.width&&Ne>=ye.y&&Ne<ye.y+ye.height,zt=`glide-cell-${X}-${Ne}`,bn=[X,Ne],zn=D(bn,!0);return s.createElement("td",{key:ut,role:"gridcell","aria-colindex":X+1+Me,"aria-selected":Vt,"aria-readonly":Ao(zn)||!vo(zn),id:zt,"data-testid":zt,onClick:()=>{const fn=te==null?void 0:te.current;if(fn!=null)return U==null?void 0:U({bounds:Lt(fn,X,Ne),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:bn})},onFocusCapture:fn=>{var ht,pe;if(!(fn.target===oo.current||((ht=Gn.current)===null||ht===void 0?void 0:ht[0])===X&&((pe=Gn.current)===null||pe===void 0?void 0:pe[1])===Ne))return Gn.current=bn,nt==null?void 0:nt(bn)},ref:$e?lo:void 0,tabIndex:-1},Vd(zn,ot))})))))},[m,ft,Wt,Q,Ht,F,g,w,G,lo,D,te,U,Lt,nt],200),Yo=j===0||!V?0:Wt>j?1:xn(-Ht/100,0,1),Ol=-g*32+xt,_e=ee?xn(-Ol/100,0,1):0,gl=s.useMemo(()=>{if(!Yo&&!_e)return null;const P={position:"absolute",top:0,left:To,width:m-To,height:f,opacity:Yo,pointerEvents:"none",transition:qe?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},q={position:"absolute",top:qn,left:0,width:m,height:f,opacity:_e,pointerEvents:"none",transition:vt?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,Yo>0&&s.createElement("div",{id:"shadow-x",style:P}),_e>0&&s.createElement("div",{id:"shadow-y",style:q}))},[Yo,_e,To,m,qe,qn,f,vt]),yi=s.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:-1,onKeyDown:al,onKeyUp:dl,onFocus:W,onBlur:N,ref:cl,style:Wo},hl),s.createElement("canvas",{ref:Ge,style:yi}),gl)},jd=s.memo(s.forwardRef(Ud));function El(e,t,n,o){var l;return xn(Math.round(t-((l=e.growOffset)!==null&&l!==void 0?l:0)),Math.ceil(n),Math.floor(o))}const qd=e=>{var t;const[n,o]=s.useState(),[l,i]=s.useState(),[u,r]=s.useState(),[a,d]=s.useState(),[c,h]=s.useState(!1),[v,m]=s.useState(),[f,w]=s.useState(),[C,p]=s.useState(),[g,b]=s.useState(!1),[k,x]=s.useState(),{onHeaderMenuClick:M,onHeaderIndicatorClick:B,getCellContent:R,onColumnMoved:F,onColumnResize:D,onColumnResizeStart:I,onColumnResizeEnd:T,gridRef:z,maxColumnWidth:E,minColumnWidth:S,onRowMoved:W,lockColumns:N,onColumnProposeMove:J,onMouseDown:G,onMouseUp:j,onItemHovered:_,onDragStart:Y,canvasRef:V}=e,ee=((t=D??T)!==null&&t!==void 0?t:I)!==void 0,{columns:de,selection:me}=e,$=me.columns,Ce=s.useCallback(H=>{const[re,ge]=H.location;u!==void 0&&a!==re&&re>=N?(h(!0),d(re)):f!==void 0&&ge!==void 0?(b(!0),p(Math.max(0,ge))):l===void 0&&!c&&!g&&(_==null||_(H))},[u,f,a,_,N,l,c,g]),O=F!==void 0,ve=s.useCallback(H=>{if(H.button===0){const[ne,Re]=H.location;if(H.kind==="out-of-bounds"&&H.isEdge&&ee){var re;const De=z==null||(re=z.current)===null||re===void 0?void 0:re.getBounds(de.length-1,-1);De!==void 0&&(o(De.x),i(de.length-1))}else if(H.kind==="header"&&ne>=N){const De=V==null?void 0:V.current;if(H.isEdge&&ee&&De){var ge;o(H.bounds.x),i(ne);const Ie=De.getBoundingClientRect().width/De.offsetWidth,fe=H.bounds.width/Ie;I==null||I(de[ne],fe,ne,fe+((ge=de[ne].growOffset)!==null&&ge!==void 0?ge:0))}else H.kind==="header"&&O&&(m(H.bounds.x),r(ne))}else H.kind==="cell"&&N>0&&ne===0&&Re!==void 0&&W!==void 0&&(x(H.bounds.y),w(Re))}G==null||G(H)},[G,ee,N,W,z,de,O,I,V]),Q=s.useCallback((H,re)=>{c||g||M==null||M(H,re)},[c,g,M]),he=s.useCallback((H,re)=>{c||g||B==null||B(H,re)},[c,g,B]),U=s.useRef(-1),ae=s.useCallback(()=>{U.current=-1,w(void 0),p(void 0),x(void 0),b(!1),r(void 0),d(void 0),m(void 0),h(!1),i(void 0),o(void 0)},[]),ke=s.useCallback((H,re)=>{if(H.button===0){if(l!==void 0){var ge;if(($==null?void 0:$.hasIndex(l))===!0)for(const xe of $){var ne;if(xe===l)continue;const Ie=de[xe],fe=El(Ie,U.current,S,E);D==null||D(Ie,fe,xe,fe+((ne=Ie.growOffset)!==null&&ne!==void 0?ne:0))}const De=El(de[l],U.current,S,E);if(T==null||T(de[l],De,l,De+((ge=de[l].growOffset)!==null&&ge!==void 0?ge:0)),$.hasIndex(l))for(const xe of $){var Re;if(xe===l)continue;const Ie=de[xe],fe=El(Ie,U.current,S,E);T==null||T(Ie,fe,xe,fe+((Re=Ie.growOffset)!==null&&Re!==void 0?Re:0))}}ae(),u!==void 0&&a!==void 0&&(J==null?void 0:J(u,a))!==!1&&(F==null||F(u,a)),f!==void 0&&C!==void 0&&(W==null||W(f,C))}j==null||j(H,re)},[j,l,u,a,f,C,$,T,de,S,E,D,F,W,ae,J]),te=s.useMemo(()=>{if(!(u===void 0||a===void 0)&&u!==a&&(J==null?void 0:J(u,a))!==!1)return{src:u,dest:a}},[u,a,J]),Be=s.useCallback(H=>{const re=V==null?void 0:V.current;if(u!==void 0&&v!==void 0)Math.abs(H.clientX-v)>20&&h(!0);else if(f!==void 0&&k!==void 0)Math.abs(H.clientY-k)>20&&b(!0);else if(l!==void 0&&n!==void 0&&re){var ge;const De=re.getBoundingClientRect().width/re.offsetWidth,xe=(H.clientX-n)/De,Ie=de[l],fe=El(Ie,xe,S,E);if(D==null||D(Ie,fe,l,fe+((ge=Ie.growOffset)!==null&&ge!==void 0?ge:0)),U.current=xe,($==null?void 0:$.first())===l)for(const Fe of $){var ne;if(Fe===l)continue;const ze=de[Fe],Xe=El(ze,U.current,S,E);D==null||D(ze,Xe,Fe,Xe+((ne=ze.growOffset)!==null&&ne!==void 0?ne:0))}}},[u,v,f,k,l,n,de,S,E,D,$,V]),Ye=s.useCallback((H,re)=>{if(f===void 0||C===void 0)return R(H,re);let[ge,ne]=H;return ne===C?ne=f:(ne>C&&(ne-=1),ne>=f&&(ne+=1)),R([ge,ne],re)},[f,C,R]),ce=s.useCallback(H=>{Y==null||Y(H),H.defaultPrevented()||ae()},[ae,Y]);return s.createElement(jd,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:l,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:Ye,isResizing:l!==void 0,onHeaderMenuClick:Q,onHeaderIndicatorClick:he,isDragging:c,onItemHovered:Ce,onDragStart:ce,onMouseDown:ve,allowResize:ee,onMouseUp:ke,dragAndDropState:te,onMouseMoveRaw:Be,ref:z})};function Zd(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const l=u=>{for(const r of u){const{width:a,height:d}=r&&r.contentRect||{};o(c=>c.width===a&&c.height===d?c:{width:a,height:d})}},i=new window.ResizeObserver(l);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Jd=(e,t,n)=>{const o=s.useRef(null),l=s.useRef(null),i=s.useRef(null),u=s.useRef(0),r=s.useRef(t);r.current=t;const a=n.current;s.useEffect(()=>{const d=()=>{if(l.current===!1&&a!==null){var v,m;const f=[a.scrollLeft,a.scrollTop];if(((v=i.current)===null||v===void 0?void 0:v[0])===f[0]&&((m=i.current)===null||m===void 0?void 0:m[1])===f[1])if(u.current>10){i.current=null,l.current=null;return}else u.current++;else u.current=0,r.current(f[0],f[1]),i.current=f;o.current=window.setTimeout(d,8.333333333333334)}},c=()=>{l.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},h=v=>{v.touches.length===0&&(l.current=!1,u.current=0,o.current=window.setTimeout(d,8.333333333333334))};if(e&&a!==null){const v=a;return v.addEventListener("touchstart",c),v.addEventListener("touchend",h),()=>{v.removeEventListener("touchstart",c),v.removeEventListener("touchend",h),o.current!==null&&window.clearTimeout(o.current)}}},[e,a])},Qd=()=>e=>e.isSafari?"scroll":"auto",_d=nn("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Qd()]}}),ec=33554400,tc=5e6;function nc(e){const t=jt.c(3),[n,o]=s.useState(!1),l=typeof window>"u"?null:window,i=s.useRef(0);let u;t[0]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{window.clearTimeout(i.current),o(!0)},t[0]=u):u=t[0],tn("touchstart",u,l,!0,!1);let r;return t[1]!==e?(r=a=>{a.touches.length===0&&(i.current=window.setTimeout(()=>o(!1),e))},t[1]=e,t[2]=r):r=t[2],tn("touchend",r,l,!0,!1),n}const oc=e=>{var t,n,o,l;const{children:i,clientHeight:u,scrollHeight:r,scrollWidth:a,update:d,draggable:c,className:h,preventDiagonalScrolling:v=!1,paddingBottom:m=0,paddingRight:f=0,rightElement:w,rightElementProps:C,kineticScrollPerfHack:p=!1,scrollRef:g,initialSize:b}=e,k=[],x=(t=C==null?void 0:C.sticky)!==null&&t!==void 0?t:!1,M=(n=C==null?void 0:C.fill)!==null&&n!==void 0?n:!1,B=s.useRef(0),R=s.useRef(0),F=s.useRef(null),D=typeof window>"u"?1:window.devicePixelRatio,I=s.useRef(D);s.useEffect(()=>{if(I.current!==D){B.current=0,R.current=0,I.current=D;const O=F.current;O!==null&&G.current(O.scrollLeft,O.scrollTop)}},[D]);const T=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),z=s.useRef(null),E=nc(200),[S,W]=s.useState(!0),N=s.useRef(0);s.useLayoutEffect(()=>{if(!S||E||T.current.lockDirection===void 0)return;const O=F.current;if(O===null)return;const[ve,Q]=T.current.lockDirection;ve!==void 0?O.scrollLeft=ve:Q!==void 0&&(O.scrollTop=Q),T.current.lockDirection=void 0},[E,S]);const J=s.useCallback((O,ve)=>{var Q,he,U,ae;const ke=F.current;if(ke===null)return;ve=ve??ke.scrollTop,O=O??ke.scrollLeft;const te=T.current.scrollTop,Be=T.current.scrollLeft,Ye=O-Be,ce=ve-te;E&&Ye!==0&&ce!==0&&(Math.abs(Ye)>3||Math.abs(ce)>3)&&v&&T.current.lockDirection===void 0&&(T.current.lockDirection=Math.abs(Ye)<Math.abs(ce)?[Be,void 0]:[void 0,te]);const H=T.current.lockDirection;O=(Q=H==null?void 0:H[0])!==null&&Q!==void 0?Q:O,ve=(he=H==null?void 0:H[1])!==null&&he!==void 0?he:ve,T.current.scrollLeft=O,T.current.scrollTop=ve;const re=ke.clientWidth,ge=ke.clientHeight,ne=ve,Re=R.current-ne,De=ke.scrollHeight-ge;R.current=ne;let xe;if(De>0&&r>ke.scrollHeight+5)if(Math.abs(Re)>2e3||ne===0||ne===De){const Ie=Math.max(0,Math.min(1,ne/De)),fe=r-ge;xe=Ie*fe,B.current=xe}else B.current-=Re,xe=B.current;else xe=ne,B.current=xe;xe=Math.max(0,Math.min(xe,r-ge)),B.current=xe,H!==void 0&&(window.clearTimeout(N.current),W(!1),N.current=window.setTimeout(()=>W(!0),200)),d({x:O,y:xe,width:re-f,height:ge-m,paddingRight:(U=(ae=z.current)===null||ae===void 0?void 0:ae.clientWidth)!==null&&U!==void 0?U:0})},[m,f,r,d,v,E]);Jd(p&&di.value,J,F);const G=s.useRef(J);G.current=J;const j=s.useRef(),_=s.useRef(!1);s.useLayoutEffect(()=>{_.current?J():_.current=!0},[J,m,f]);const Y=s.useCallback(O=>{F.current=O,g!==void 0&&(g.current=O)},[g]);let V=0,ee=0;const de=Math.min(r,ec);for(k.push(s.createElement("div",{key:V++,style:{width:a,height:0}}));ee<de;){const O=Math.min(tc,de-ee);k.push(s.createElement("div",{key:V++,style:{width:0,height:O}})),ee+=O}const{ref:me,width:$,height:Ce}=Zd(b);return typeof window<"u"&&(((o=j.current)===null||o===void 0?void 0:o.height)!==Ce||((l=j.current)===null||l===void 0?void 0:l.width)!==$)&&(window.setTimeout(()=>G.current(),0),j.current={width:$,height:Ce}),($??0)===0||(Ce??0)===0?s.createElement("div",{ref:me}):s.createElement("div",{ref:me},s.createElement(_d,{isSafari:di.value},s.createElement("div",{className:"dvn-underlay"},i),s.createElement("div",{ref:Y,style:j.current,draggable:c,onDragStart:O=>{c||(O.stopPropagation(),O.preventDefault())},className:"dvn-scroller "+(h??""),onScroll:()=>J()},s.createElement("div",{className:"dvn-scroll-inner"+(w===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},k),w!==void 0&&s.createElement(s.Fragment,null,!M&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:z,style:{height:Ce,maxHeight:u-Math.ceil(D%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:f,flexGrow:M?1:void 0,right:x?f??0:void 0,pointerEvents:"auto"}},w))))))},lc=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:l,groupHeaderHeight:i,enableGroups:u,freezeColumns:r,experimental:a,nonGrowWidth:d,clientSize:c,className:h,onVisibleRegionChanged:v,scrollRef:m,preventDiagonalScrolling:f,rightElement:w,rightElementProps:C,overscrollX:p,overscrollY:g,initialSize:b,smoothScrollX:k=!1,smoothScrollY:x=!1,isDraggable:M}=e,{paddingRight:B,paddingBottom:R}=a??{},[F,D]=c,I=s.useRef(),T=s.useRef(),z=s.useRef(),E=s.useRef(),S=d+Math.max(0,p??0);let W=u?l+i:l;if(typeof o=="number")W+=n*o;else for(let j=0;j<n;j++)W+=o(j);g!==void 0&&(W+=g);const N=s.useRef(),J=s.useCallback(()=>{var j,_;if(N.current===void 0)return;const Y={...N.current};let V=0,ee=Y.x<0?-Y.x:0,de=0,me=0;Y.x=Y.x<0?0:Y.x;let $=0;for(let ae=0;ae<r;ae++)$+=t[ae].width;for(const ae of t){const ke=V-$;if(Y.x>=ke+ae.width)V+=ae.width,me++,de++;else if(Y.x>ke)V+=ae.width,k?ee+=ke-Y.x:me++,de++;else if(Y.x+Y.width>ke)V+=ae.width,de++;else break}let Ce=0,O=0,ve=0;if(typeof o=="number")x?(O=Math.floor(Y.y/o),Ce=O*o-Y.y):O=Math.ceil(Y.y/o),ve=Math.ceil(Y.height/o)+O,Ce<0&&ve++;else{let ae=0;for(let ke=0;ke<n;ke++){const te=o(ke),Be=ae+(x?0:te/2);if(Y.y>=ae+te)ae+=te,O++,ve++;else if(Y.y>Be)ae+=te,x?Ce+=Be-Y.y:O++,ve++;else if(Y.y+Y.height>te/2+ae)ae+=te,ve++;else break}}O=Math.max(0,Math.min(O,n-1)),ve=Math.max(O,Math.min(ve,n));const Q={x:me,y:O,width:de-me,height:ve-O},he=I.current;if(he===void 0||he.y!==Q.y||he.x!==Q.x||he.height!==Q.height||he.width!==Q.width||T.current!==ee||z.current!==Ce||Y.width!==((j=E.current)===null||j===void 0?void 0:j[0])||Y.height!==((_=E.current)===null||_===void 0?void 0:_[1])){var U;v==null||v({x:me,y:O,width:de-me,height:ve-O},Y.width,Y.height,(U=Y.paddingRight)!==null&&U!==void 0?U:0,ee,Ce),I.current=Q,T.current=ee,z.current=Ce,E.current=[Y.width,Y.height]}},[t,o,n,v,r,k,x]),G=s.useCallback(j=>{N.current=j,J()},[J]);return s.useEffect(()=>{J()},[J]),s.createElement(oc,{scrollRef:m,className:h,kineticScrollPerfHack:a==null?void 0:a.kineticScrollPerfHack,preventDiagonalScrolling:f,draggable:M===!0||typeof M=="string",scrollWidth:S+(B??0),scrollHeight:W+(R??0),clientHeight:D,rightElement:w,paddingBottom:R,paddingRight:B,rightElementProps:C,update:G,initialSize:b},s.createElement(qd,{eventTargetRef:m,width:F,height:D,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},ic=nn("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),rc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),uc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),sc=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),ac=10,dc=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:l,searchInputRef:i,searchValue:u,searchResults:r,onSearchValueChange:a,getCellsForSelection:d,onSearchResultsChanged:c,showSearch:h=!1,onSearchClose:v}=e,[m]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[f,w]=s.useState(""),C=u??f,p=s.useCallback(_=>{w(_),a==null||a(_)},[a]),[g,b]=s.useState(),k=s.useRef(g);k.current=g,s.useEffect(()=>{r!==void 0&&(r.length>0?b(_=>{var Y;return{rowsSearched:o,results:r.length,selectedIndex:(Y=_==null?void 0:_.selectedIndex)!==null&&Y!==void 0?Y:-1}}):b(void 0))},[o,r]);const x=s.useRef();x.current===void 0&&(x.current=new AbortController);const M=s.useRef(),[B,R]=s.useState([]),F=r??B,D=s.useCallback(()=>{M.current!==void 0&&(window.cancelAnimationFrame(M.current),M.current=void 0),x.current!==void 0&&x.current.abort(),x.current=new AbortController},[]),I=s.useRef(n);I.current=n;const T=s.useCallback(_=>{const Y=new RegExp(_.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let V=I.current,ee=Math.min(10,o),de=0;b(void 0),R([]);const me=[],$=async()=>{var Ce,O;if(d===void 0)return;const ve=performance.now(),Q=o-de;let he=d({x:0,y:V,width:l.length,height:Math.min(ee,Q,o-V)},x.current.signal);typeof he=="function"&&(he=await he());let U=!1;for(const[ce,H]of he.entries())for(const[re,ge]of H.entries()){let ne;switch(ge.kind){case ie.Text:case ie.Number:ne=ge.displayData;break;case ie.Uri:case ie.Markdown:ne=ge.data;break;case ie.Boolean:ne=typeof ge.data=="boolean"?ge.data.toString():void 0;break;case ie.Image:case ie.Bubble:ne=ge.data.join("🐳");break;case ie.Custom:ne=ge.copyData;break}ne!==void 0&&Y.test(ne)&&(me.push([re,ce+V]),U=!0)}const ae=performance.now();U&&R([...me]),de+=he.length,vn(de<=o);const ke=(Ce=(O=k.current)===null||O===void 0?void 0:O.selectedIndex)!==null&&Ce!==void 0?Ce:-1;b({results:me.length,rowsSearched:de,selectedIndex:ke}),c==null||c(me,ke),V+ee>=o?V=0:V+=ee;const te=ae-ve,Be=Math.max(te,1),Ye=ac/Be;ee=Math.ceil(ee*Ye),de<o&&me.length<1e3&&(M.current=window.requestAnimationFrame($))};D(),M.current=window.requestAnimationFrame($)},[D,l.length,d,c,o]),z=s.useCallback(()=>{var _;v==null||v(),b(void 0),R([]),c==null||c([],-1),D(),t==null||(_=t.current)===null||_===void 0||_.focus()},[D,t,v,c]),E=s.useCallback(_=>{p(_.target.value),r===void 0&&(_.target.value===""?(b(void 0),R([]),D()):T(_.target.value))},[T,D,p,r]);s.useEffect(()=>{i.current!==null&&(p(""),b(void 0),B.length>0&&(R([]),c==null||c([],-1)),h?i.current.focus({preventScroll:!0}):D())},[h,i]);const S=s.useCallback(_=>{var Y;if(_==null||(Y=_.stopPropagation)===null||Y===void 0||Y.call(_),g===void 0||g.results===0)return;const V=(g.selectedIndex+1)%g.results;b({...g,selectedIndex:V}),c==null||c(F,V)},[g,c,F]),W=s.useCallback(_=>{var Y;if(_==null||(Y=_.stopPropagation)===null||Y===void 0||Y.call(_),g===void 0||g.results===0)return;let V=(g.selectedIndex-1)%g.results;V<0&&(V+=g.results),b({...g,selectedIndex:V}),c==null||c(F,V)},[c,F,g]),N=s.useCallback(_=>{(_.ctrlKey||_.metaKey)&&_.nativeEvent.code==="KeyF"||_.key==="Escape"?(z(),_.stopPropagation(),_.preventDefault()):_.key==="Enter"&&(_.shiftKey?W():S())},[z,S,W]);s.useEffect(()=>()=>{D()},[D]);const[J,G]=s.useState(!1);s.useEffect(()=>{if(h)G(!0);else{const _=setTimeout(()=>G(!1),150);return()=>clearTimeout(_)}},[h]);const j=s.useMemo(()=>{var _,Y,V;if(!h&&!J)return null;let ee;g!==void 0&&(ee=g.results>=1e3?"over 1000":`${g.results} result${g.results!==1?"s":""}`,g.selectedIndex>=0&&(ee=`${g.selectedIndex+1} of ${ee}`));const de=Ce=>{Ce.stopPropagation()},$={width:`${o>0?Math.floor(((_=g==null?void 0:g.rowsSearched)!==null&&_!==void 0?_:0)/o*100):0}%`};return s.createElement(ic,{className:"gdg-search-bar"+(h?"":" out"),onMouseDown:de,onMouseMove:de,onMouseUp:de,onClick:de},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:m,"aria-hidden":!h,"data-testid":"search-input",ref:i,onChange:E,value:C,tabIndex:h?void 0:-1,onKeyDownCapture:N}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!h,tabIndex:h?void 0:-1,onClick:W,disabled:((Y=g==null?void 0:g.results)!==null&&Y!==void 0?Y:0)===0},rc),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!h,tabIndex:h?void 0:-1,onClick:S,disabled:((V=g==null?void 0:g.results)!==null&&V!==void 0?V:0)===0},uc),v!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!h,"data-testid":"search-close-button",tabIndex:h?void 0:-1,onClick:z},sc)),g!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},ee)),s.createElement("div",{className:"gdg-search-progress",style:$})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:m},"Type to search")))},[h,J,g,o,m,i,E,C,N,W,S,v,z]);return s.createElement(s.Fragment,null,s.createElement(lc,{prelightCells:F,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),j)},cc=()=>e=>Math.max(16,e.targetHeight-10),fc=nn("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[cc(),"px"]}}),hc=e=>{const t=jt.c(37),{bounds:n,group:o,onClose:l,canvasBounds:i,onFinish:u}=e,[r,a]=Un.useState(o);let d;if(t[0]!==n.height||t[1]!==n.width||t[2]!==n.x||t[3]!==n.y||t[4]!==i.left||t[5]!==i.top||t[6]!==l||t[7]!==u||t[8]!==r){const c=n.x-i.left+1,h=n.y-i.top,v=n.width-2;let m;t[10]!==n.height||t[11]!==c||t[12]!==h||t[13]!==v?(m={position:"absolute",left:c,top:h,width:v,height:n.height},t[10]=n.height,t[11]=c,t[12]=h,t[13]=v,t[14]=m):m=t[14];let f;t[15]===Symbol.for("react.memo_cache_sentinel")?(f="gdg-g1tqibwd",t[15]=f):f=t[15];let w;t[16]!==l||t[17]!==m?(w={style:m,className:f,onClickOutside:l},t[16]=l,t[17]=m,t[18]=w):w=t[18];let C;if(t[19]!==n.height||t[20]!==l||t[21]!==u||t[22]!==r){let p;t[24]!==r?(p=x=>x.target.setSelectionRange(0,r.length),t[24]=r,t[25]=p):p=t[25];let g;t[26]===Symbol.for("react.memo_cache_sentinel")?(g=x=>a(x.target.value),t[26]=g):g=t[26];let b;t[27]!==l||t[28]!==u||t[29]!==r?(b=x=>{x.key==="Enter"?u(r):x.key==="Escape"&&l()},t[27]=l,t[28]=u,t[29]=r,t[30]=b):b=t[30];let k;t[31]!==n.height||t[32]!==l||t[33]!==b||t[34]!==p||t[35]!==r?(k={targetHeight:n.height,"data-testid":"group-rename-input",value:r,onBlur:l,onFocus:p,onChange:g,onKeyDown:b,autoFocus:!0},t[31]=n.height,t[32]=l,t[33]=b,t[34]=p,t[35]=r,t[36]=k):k=t[36],C=Un.createElement(fc,k),t[19]=n.height,t[20]=l,t[21]=u,t[22]=r,t[23]=C}else C=t[23];d=Un.createElement(Cu,w,C),t[0]=n.height,t[1]=n.width,t[2]=n.x,t[3]=n.y,t[4]=i.left,t[5]=i.top,t[6]=l,t[7]=u,t[8]=r,t[9]=d}else d=t[9];return d};function gc(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Ze(e,t,n){const o=Yu(e,t);return o&&(n.didMatch=!0),o}function Yu(e,t){if(e.length===0)return!1;if(e.includes("|")){const a=e.split("|");for(const d of a)if(Yu(d,t))return!0;return!1}let n=!1,o=!1,l=!1,i=!1;const u=e.split("+"),r=u.pop();if(!gc(r,t))return!1;if(u[0]==="any")return!0;for(const a of u)switch(a){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":l=!0;break;case"meta":i=!0;break;case"primary":gi.value?i=!0:n=!0;break}return t.altKey===l&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function vc(e){var t,n;if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case ie.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Qi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case ie.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case ie.Image:case ie.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case ie.Drilldown:return{formatted:e.data.map(o=>o.text),rawValue:e.data.map(o=>o.text),format:"string-array"};case ie.Text:return{formatted:(t=e.displayData)!==null&&t!==void 0?t:e.data,rawValue:e.data,format:"string"};case ie.Uri:return{formatted:(n=e.displayData)!==null&&n!==void 0?n:e.data,rawValue:e.data,format:"url"};case ie.Markdown:case ie.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case ie.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case ie.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case ie.Protected:return{formatted:"************",rawValue:"",format:"string"};default:Fl()}}function mc(e,t){return e.map((o,l)=>{const i=t[l];return o.map(u=>u.span!==void 0&&u.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:vc(u))})}function _r(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function wc(e){const t=[];for(const l of e){const i=[];for(const u of l)if(u.format==="url"){var n,o;i.push((n=(o=u.rawValue)===null||o===void 0?void 0:o.toString())!==null&&n!==void 0?n:"")}else u.format==="string-array"?i.push(u.formatted.map(r=>_r(r,!0)).join(",")):i.push(u.doNotEscape===!0?u.formatted:_r(u.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function Ni(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function eu(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function pc(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function Cc(e){const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const l of e){t.push("<tr>");for(const i of l){const u=`gdg-format="${i.format}"`;if(i.format==="url")t.push(`<td ${u}><a href="${i.rawValue}">${Ni(i.formatted)}</a></td>`);else if(i.format==="string-array")t.push(`<td ${u}><ol>${i.formatted.map((r,a)=>`<li gdg-raw-value=${eu(i.rawValue[a])}>`+Ni(r)+"</li>").join("")}</ol></td>`);else{var n,o;t.push(`<td gdg-raw-value=${eu((n=(o=i.rawValue)===null||o===void 0?void 0:o.toString())!==null&&n!==void 0?n:"")} ${u}>${Ni(i.formatted)}</td>`)}}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function bc(e,t){const n=mc(e,t),o=wc(n),l=Cc(n);return{textPlain:o,textHtml:l}}function tu(e){const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],l=[];let i;for(;o.length>0;){const C=o.pop();if(C===void 0)break;if(C instanceof HTMLTableElement||C.nodeName==="TBODY")o.push(...[...C.children].reverse());else if(C instanceof HTMLTableRowElement)i!==void 0&&l.push(i),i=[],o.push(...[...C.children].reverse());else if(C instanceof HTMLTableCellElement){var u;const p=C.cloneNode(!0),b=p.children.length===1&&p.children[0].nodeName==="P"?p.children[0]:null,k=(b==null?void 0:b.children.length)===1&&b.children[0].nodeName==="FONT",x=p.querySelectorAll("br");for(const R of x)R.replaceWith(`
`);const M=p.getAttribute("gdg-raw-value"),B=(u=p.getAttribute("gdg-format"))!==null&&u!==void 0?u:"string";if(p.querySelector("a")!==null){var r,a,d,c;(r=i)===null||r===void 0||r.push({rawValue:(a=(d=p.querySelector("a"))===null||d===void 0?void 0:d.getAttribute("href"))!==null&&a!==void 0?a:"",formatted:(c=p.textContent)!==null&&c!==void 0?c:"",format:B})}else if(p.querySelector("ol")!==null){var h;const R=p.querySelectorAll("li");(h=i)===null||h===void 0||h.push({rawValue:[...R].map(F=>{var D;return(D=F.getAttribute("gdg-raw-value"))!==null&&D!==void 0?D:""}),formatted:[...R].map(F=>{var D;return(D=F.textContent)!==null&&D!==void 0?D:""}),format:"string-array"})}else if(M!==null){var v,m;(v=i)===null||v===void 0||v.push({rawValue:pc(M),formatted:(m=p.textContent)!==null&&m!==void 0?m:"",format:B})}else{var f,w;let R=(f=p.textContent)!==null&&f!==void 0?f:"";k&&(R=R.replace(/\n(?!\n)/g,"")),(w=i)===null||w===void 0||w.push({rawValue:R??"",formatted:R??"",format:B})}}}return i!==void 0&&l.push(i),l}function yc(e,t,n,o,l){const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let u=!1;do{var r,a;if(((r=e)===null||r===void 0?void 0:r.current)===void 0)break;const c=(a=e.current)===null||a===void 0?void 0:a.range,h=[];if(c.width>2){const f=t({x:c.x,y:c.y,width:1,height:c.height},l.signal);if(typeof f=="function")return i;h.push(...f);const w=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},l.signal);if(typeof w=="function")return i;h.push(...w)}else{const f=t({x:c.x,y:c.y,width:c.width,height:c.height},l.signal);if(typeof f=="function")return i;h.push(...f)}let v=c.x-n,m=c.x+c.width-1-n;for(const f of h)for(const w of f)w.span!==void 0&&(v=Math.min(w.span[0],v),m=Math.max(w.span[1],m));if(v===c.x-n&&m===c.x+c.width-1-n)u=!0;else{var d;e={current:{cell:(d=e.current.cell)!==null&&d!==void 0?d:[0,0],range:{x:v+n,y:c.y,width:m-v+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}}while(!u);return e}function nu(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Ec(e){let t;(function(r){r[r.None=0]="None",r[r.inString=1]="inString",r[r.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],l=0,i=t.None;e=e.replace(/\r\n/g,`
`);let u=0;for(const r of e){switch(i){case t.None:r==="	"||r===`
`?(o.push(e.slice(l,u)),l=u+1,r===`
`&&(n.push(o),o=[])):r==='"'&&(i=t.inString);break;case t.inString:r==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:r==='"'?i=t.inString:((r==="	"||r===`
`)&&(o.push(nu(e.slice(l,u))),l=u+1,r===`
`&&(n.push(o),o=[])),i=t.None);break}u++}return l<e.length&&o.push(nu(e.slice(l,e.length))),n.push(o),n.map(r=>r.map(a=>({rawValue:a,formatted:a,format:"string"})))}function ou(e,t,n){var o;const l=bc(e,t),i=a=>{var d;(d=window.navigator.clipboard)===null||d===void 0||d.writeText(a)},u=(a,d)=>{var c;return((c=window.navigator.clipboard)===null||c===void 0?void 0:c.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([d],{type:"text/html"})})]),!0)},r=(a,d)=>{try{var c,h;if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");n==null||(c=n.clipboardData)===null||c===void 0||c.setData("text/plain",a),n==null||(h=n.clipboardData)===null||h===void 0||h.setData("text/html",d)}catch{u(a,d)||i(a)}};((o=window.navigator.clipboard)===null||o===void 0?void 0:o.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?r(l.textPlain,l.textHtml):i(l.textPlain),n==null||n.preventDefault()}function dr(e){return e!==!0}function kc(e){const{state:t,keybindings:n,overlayOpen:o,columnSelect:l,rowSelect:i,rangeSelect:u,editOnType:r,trapFocus:a,showTrailingBlankRow:d,columnsInLength:c,rowGroupingNavBehavior:h,mapper:v,onKeyDownIn:m,onSelectionCleared:f,onCellActivated:w,onDelete:C,getCellContent:p,setSelectedColumns:g,setSelectedRows:b,setShowSearchInner:k,searchInputRef:x,adjustSelection:M,updateSelectedCell:B,deleteRange:R,fillDown:F,fillRight:D,appendRow:I,getCustomNewRowTargetColumn:T,scrollToRef:z}=e,{gridSelection:E,gridRef:S,visibleRegionRef:W,rowMarkerOffset:N,rows:J,setGridSelection:G,getMangledCellContent:j,mangledOnCellsEdited:_,setOverlay:Y,reselect:V,focus:ee}=t,de=s.useCallback($=>{const Ce=()=>{$.stopPropagation(),$.preventDefault()},O={didMatch:!1},{bounds:ve}=$,Q=E.columns,he=E.rows,U=n;if(!o&&Ze(U.clear,$,O)){var ae,ke;const Fe=(ae=(ke=E.current)===null||ke===void 0?void 0:ke.cell)!==null&&ae!==void 0?ae:[N,0];G({columns:tt.empty(),rows:tt.empty(),current:{cell:Fe,range:{x:Fe[0],y:Fe[1],width:1,height:1},rangeStack:[]}},!1),f==null||f(),ee()}else if(!o&&Ze(U.selectAll,$,O)){var te,Be;G({columns:tt.empty(),rows:tt.empty(),current:{cell:(te=(Be=E.current)===null||Be===void 0?void 0:Be.cell)!==null&&te!==void 0?te:[N,0],range:{x:N,y:0,width:c,height:J},rangeStack:[]}},!1)}else if(Ze(U.search,$,O)){var Ye;x==null||(Ye=x.current)===null||Ye===void 0||Ye.focus({preventScroll:!0}),k(!0)}else if(Ze(U.delete,$,O)){var ce;const Fe=(ce=C==null?void 0:C(E))!==null&&ce!==void 0?ce:!0;if(Fe!==!1){const ze=Fe===!0?E:Fe;if(ze.current!==void 0){R(ze.current.range);for(const Xe of ze.current.rangeStack)R(Xe)}for(const Xe of ze.rows)R({x:N,y:Xe,width:c,height:1});for(const Xe of ze.columns)R({x:Xe,y:0,width:1,height:J})}}if(O.didMatch)return Ce(),!0;if(E.current===void 0)return!1;let[H,re]=E.current.cell;const[,ge]=E.current.cell;let ne=!1,Re=!1;if(Ze(U.scrollToSelectedCell,$,O))z.current(H-N,re);else if(l!=="none"&&Ze(U.selectColumn,$,O))Q.hasIndex(H)?g(Q.remove(H),void 0,!0):l==="single"?g(tt.fromSingleSelection(H),void 0,!0):g(void 0,H,!0);else if(i!=="none"&&Ze(U.selectRow,$,O))he.hasIndex(re)?b(he.remove(re),void 0,!0):i==="single"?b(tt.fromSingleSelection(re),void 0,!0):b(void 0,re,!0);else if(!o&&ve!==void 0&&Ze(U.activateCell,$,O))if(re===J&&d)window.setTimeout(()=>{const Fe=T(H);I(Fe??H)},0);else{const Fe={inputType:"keyboard",key:$.key},ze=j([H,re]);if(ze.kind===ie.Boolean&&ze.readonly!==!0){var De;w==null||w([H-N,re],Fe),_([{location:[H,re],value:{...ze,data:dr(ze.data)}}]),(De=S.current)===null||De===void 0||De.damage([{cell:[H,re]}])}else w==null||w([H-N,re],Fe),V(ve,Fe)}else E.current.range.height>1&&Ze(U.downFill,$,O)?F():E.current.range.width>1&&Ze(U.rightFill,$,O)?D():Ze(U.goToNextPage,$,O)?re+=Math.max(1,W.current.height-4):Ze(U.goToPreviousPage,$,O)?re-=Math.max(1,W.current.height-4):Ze(U.goToFirstCell,$,O)?(Y(void 0),re=0,H=0):Ze(U.goToLastCell,$,O)?(Y(void 0),re=Number.MAX_SAFE_INTEGER,H=Number.MAX_SAFE_INTEGER):Ze(U.selectToFirstCell,$,O)?(Y(void 0),M([-2,-2])):Ze(U.selectToLastCell,$,O)?(Y(void 0),M([2,2])):o?(Ze(U.closeOverlay,$,O)&&Y(void 0),Ze(U.acceptOverlayDown,$,O)&&(Y(void 0),re++),Ze(U.acceptOverlayUp,$,O)&&(Y(void 0),re--),Ze(U.acceptOverlayLeft,$,O)&&(Y(void 0),H--),Ze(U.acceptOverlayRight,$,O)&&(Y(void 0),H++)):(Ze(U.goDownCell,$,O)?re+=1:Ze(U.goUpCell,$,O)?re-=1:Ze(U.goRightCell,$,O)?H+=1:Ze(U.goLeftCell,$,O)?H-=1:Ze(U.goDownCellRetainSelection,$,O)?(re+=1,ne=!0):Ze(U.goUpCellRetainSelection,$,O)?(re-=1,ne=!0):Ze(U.goRightCellRetainSelection,$,O)?(H+=1,ne=!0):Ze(U.goLeftCellRetainSelection,$,O)?(H-=1,ne=!0):Ze(U.goToLastRow,$,O)?re=J-1:Ze(U.goToFirstRow,$,O)?re=Number.MIN_SAFE_INTEGER:Ze(U.goToLastColumn,$,O)?H=Number.MAX_SAFE_INTEGER:Ze(U.goToFirstColumn,$,O)?H=Number.MIN_SAFE_INTEGER:(u==="rect"||u==="multi-rect")&&(Ze(U.selectGrowDown,$,O)?M([0,1]):Ze(U.selectGrowUp,$,O)?M([0,-1]):Ze(U.selectGrowRight,$,O)?M([1,0]):Ze(U.selectGrowLeft,$,O)?M([-1,0]):Ze(U.selectToLastRow,$,O)?M([0,2]):Ze(U.selectToFirstRow,$,O)?M([0,-2]):Ze(U.selectToLastColumn,$,O)?M([2,0]):Ze(U.selectToFirstColumn,$,O)&&M([-2,0])),Re=O.didMatch);if(h!==void 0&&h!=="normal"&&re!==ge){const Fe=h==="skip-up"||h==="skip"||h==="block",ze=h==="skip-down"||h==="skip"||h==="block",Xe=re<ge;if(Xe&&Fe){for(;re>=0&&v(re).isGroupHeader;)re--;re<0&&(re=ge)}else if(!Xe&&ze){for(;re<J&&v(re).isGroupHeader;)re++;re>=J&&(re=ge)}}const Ie=B(H,re,!1,ne),fe=O.didMatch;return fe&&(Ie||!Re||a)&&Ce(),fe},[h,o,E,n,l,i,u,N,v,J,B,G,f,c,C,a,R,g,b,d,T,I,w,V,F,D,M,j,_,S,Y,ee,W,x,k,z]),me=s.useCallback($=>{let Ce=!1;if(m!==void 0&&m({...$,...$.location&&{location:[$.location[0]-N,$.location[1]]},cancel:()=>{Ce=!0}}),Ce||de($)||E.current===void 0)return;const[O,ve]=E.current.cell,Q=W.current,he=$.keyCode===229,U=r&&!$.metaKey&&!$.ctrlKey&&$.key.length===1&&/[!-~\xA1-\xAC\xAE-\u0377\u037A-\u037F\u0384-\u038A\u038C\u038E-\u03A1\u03A3-\u052F\u0531-\u0556\u0559-\u058A\u058D-\u058F\u0591-\u05C7\u05D0-\u05EA\u05EF-\u05F4\u0606-\u061B\u061D-\u06DC\u06DE-\u070D\u0710-\u074A\u074D-\u07B1\u07C0-\u07FA\u07FD-\u082D\u0830-\u083E\u0840-\u085B\u085E\u0860-\u086A\u0870-\u088E\u0897-\u08E1\u08E3-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A76\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AF1\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BFA\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C77-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4F\u0D54-\u0D63\u0D66-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2-\u0DF4\u0E01-\u0E3A\u0E3F-\u0E5B\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00-\u0F47\u0F49-\u0F6C\u0F71-\u0F97\u0F99-\u0FBC\u0FBE-\u0FCC\u0FCE-\u0FDA\u1000-\u10C5\u10C7\u10CD\u10D0-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u137C\u1380-\u1399\u13A0-\u13F5\u13F8-\u13FD\u1400-\u167F\u1681-\u169C\u16A0-\u16F8\u1700-\u1715\u171F-\u1736\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17DD\u17E0-\u17E9\u17F0-\u17F9\u1800-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1940\u1944-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u19DE-\u1A1B\u1A1E-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA0-\u1AAD\u1AB0-\u1ACE\u1B00-\u1B4C\u1B4E-\u1BF3\u1BFC-\u1C37\u1C3B-\u1C49\u1C4D-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CC7\u1CD0-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FC4\u1FC6-\u1FD3\u1FD6-\u1FDB\u1FDD-\u1FEF\u1FF2-\u1FF4\u1FF6-\u1FFE\u2010-\u2027\u2030-\u205E\u2070\u2071\u2074-\u208E\u2090-\u209C\u20A0-\u20C0\u20D0-\u20F0\u2100-\u218B\u2190-\u2429\u2440-\u244A\u2460-\u2B73\u2B76-\u2B95\u2B97-\u2CF3\u2CF9-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D70\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2E5D\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3001-\u303F\u3041-\u3096\u3099-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\u31E5\u31EF-\u321E\u3220-\uA48C\uA490-\uA4C6\uA4D0-\uA62B\uA640-\uA6F7\uA700-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA82C\uA830-\uA839\uA840-\uA877\uA880-\uA8C5\uA8CE-\uA8D9\uA8E0-\uA953\uA95F-\uA97C\uA980-\uA9CD\uA9CF-\uA9D9\uA9DE-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA5C-\uAAC2\uAADB-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB6B\uAB70-\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBC2\uFBD3-\uFD8F\uFD92-\uFDC7\uFDCF\uFDF0-\uFE19\uFE20-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE74\uFE76-\uFEFC\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10100}-\u{10102}\u{10107}-\u{10133}\u{10137}-\u{1018E}\u{10190}-\u{1019C}\u{101A0}\u{101D0}-\u{101FD}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{102E0}-\u{102FB}\u{10300}-\u{10323}\u{1032D}-\u{1034A}\u{10350}-\u{1037A}\u{10380}-\u{1039D}\u{1039F}-\u{103C3}\u{103C8}-\u{103D5}\u{10400}-\u{1049D}\u{104A0}-\u{104A9}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{1056F}-\u{1057A}\u{1057C}-\u{1058A}\u{1058C}-\u{10592}\u{10594}\u{10595}\u{10597}-\u{105A1}\u{105A3}-\u{105B1}\u{105B3}-\u{105B9}\u{105BB}\u{105BC}\u{105C0}-\u{105F3}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10780}-\u{10785}\u{10787}-\u{107B0}\u{107B2}-\u{107BA}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10857}-\u{1089E}\u{108A7}-\u{108AF}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{108FB}-\u{1091B}\u{1091F}-\u{10939}\u{1093F}\u{10980}-\u{109B7}\u{109BC}-\u{109CF}\u{109D2}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A38}-\u{10A3A}\u{10A3F}-\u{10A48}\u{10A50}-\u{10A58}\u{10A60}-\u{10A9F}\u{10AC0}-\u{10AE6}\u{10AEB}-\u{10AF6}\u{10B00}-\u{10B35}\u{10B39}-\u{10B55}\u{10B58}-\u{10B72}\u{10B78}-\u{10B91}\u{10B99}-\u{10B9C}\u{10BA9}-\u{10BAF}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10CFA}-\u{10D27}\u{10D30}-\u{10D39}\u{10D40}-\u{10D65}\u{10D69}-\u{10D85}\u{10D8E}\u{10D8F}\u{10E60}-\u{10E7E}\u{10E80}-\u{10EA9}\u{10EAB}-\u{10EAD}\u{10EB0}\u{10EB1}\u{10EC2}-\u{10EC4}\u{10EFC}-\u{10F27}\u{10F30}-\u{10F59}\u{10F70}-\u{10F89}\u{10FB0}-\u{10FCB}\u{10FE0}-\u{10FF6}\u{11000}-\u{1104D}\u{11052}-\u{11075}\u{1107F}-\u{110BC}\u{110BE}-\u{110C2}\u{110D0}-\u{110E8}\u{110F0}-\u{110F9}\u{11100}-\u{11134}\u{11136}-\u{11147}\u{11150}-\u{11176}\u{11180}-\u{111DF}\u{111E1}-\u{111F4}\u{11200}-\u{11211}\u{11213}-\u{11241}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A9}\u{112B0}-\u{112EA}\u{112F0}-\u{112F9}\u{11300}-\u{11303}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133B}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11350}\u{11357}\u{1135D}-\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11380}-\u{11389}\u{1138B}\u{1138E}\u{11390}-\u{113B5}\u{113B7}-\u{113C0}\u{113C2}\u{113C5}\u{113C7}-\u{113CA}\u{113CC}-\u{113D5}\u{113D7}\u{113D8}\u{113E1}\u{113E2}\u{11400}-\u{1145B}\u{1145D}-\u{11461}\u{11480}-\u{114C7}\u{114D0}-\u{114D9}\u{11580}-\u{115B5}\u{115B8}-\u{115DD}\u{11600}-\u{11644}\u{11650}-\u{11659}\u{11660}-\u{1166C}\u{11680}-\u{116B9}\u{116C0}-\u{116C9}\u{116D0}-\u{116E3}\u{11700}-\u{1171A}\u{1171D}-\u{1172B}\u{11730}-\u{11746}\u{11800}-\u{1183B}\u{118A0}-\u{118F2}\u{118FF}-\u{11906}\u{11909}\u{1190C}-\u{11913}\u{11915}\u{11916}\u{11918}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{11946}\u{11950}-\u{11959}\u{119A0}-\u{119A7}\u{119AA}-\u{119D7}\u{119DA}-\u{119E4}\u{11A00}-\u{11A47}\u{11A50}-\u{11AA2}\u{11AB0}-\u{11AF8}\u{11B00}-\u{11B09}\u{11BC0}-\u{11BE1}\u{11BF0}-\u{11BF9}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C36}\u{11C38}-\u{11C45}\u{11C50}-\u{11C6C}\u{11C70}-\u{11C8F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D47}\u{11D50}-\u{11D59}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D98}\u{11DA0}-\u{11DA9}\u{11EE0}-\u{11EF8}\u{11F00}-\u{11F10}\u{11F12}-\u{11F3A}\u{11F3E}-\u{11F5A}\u{11FB0}\u{11FC0}-\u{11FF1}\u{11FFF}-\u{12399}\u{12400}-\u{1246E}\u{12470}-\u{12474}\u{12480}-\u{12543}\u{12F90}-\u{12FF2}\u{13000}-\u{1342F}\u{13440}-\u{13455}\u{13460}-\u{143FA}\u{14400}-\u{14646}\u{16100}-\u{16139}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16A60}-\u{16A69}\u{16A6E}-\u{16ABE}\u{16AC0}-\u{16AC9}\u{16AD0}-\u{16AED}\u{16AF0}-\u{16AF5}\u{16B00}-\u{16B45}\u{16B50}-\u{16B59}\u{16B5B}-\u{16B61}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16D40}-\u{16D79}\u{16E40}-\u{16E9A}\u{16F00}-\u{16F4A}\u{16F4F}-\u{16F87}\u{16F8F}-\u{16F9F}\u{16FE0}-\u{16FE4}\u{16FF0}\u{16FF1}\u{17000}-\u{187F7}\u{18800}-\u{18CD5}\u{18CFF}-\u{18D08}\u{1AFF0}-\u{1AFF3}\u{1AFF5}-\u{1AFFB}\u{1AFFD}\u{1AFFE}\u{1B000}-\u{1B122}\u{1B132}\u{1B150}-\u{1B152}\u{1B155}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1BC9C}-\u{1BC9F}\u{1CC00}-\u{1CCF9}\u{1CD00}-\u{1CEB3}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1CF50}-\u{1CFC3}\u{1D000}-\u{1D0F5}\u{1D100}-\u{1D126}\u{1D129}-\u{1D172}\u{1D17B}-\u{1D1EA}\u{1D200}-\u{1D245}\u{1D2C0}-\u{1D2D3}\u{1D2E0}-\u{1D2F3}\u{1D300}-\u{1D356}\u{1D360}-\u{1D378}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D7CB}\u{1D7CE}-\u{1DA8B}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1DF00}-\u{1DF1E}\u{1DF25}-\u{1DF2A}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E030}-\u{1E06D}\u{1E08F}\u{1E100}-\u{1E12C}\u{1E130}-\u{1E13D}\u{1E140}-\u{1E149}\u{1E14E}\u{1E14F}\u{1E290}-\u{1E2AE}\u{1E2C0}-\u{1E2F9}\u{1E2FF}\u{1E4D0}-\u{1E4F9}\u{1E5D0}-\u{1E5FA}\u{1E5FF}\u{1E7E0}-\u{1E7E6}\u{1E7E8}-\u{1E7EB}\u{1E7ED}\u{1E7EE}\u{1E7F0}-\u{1E7FE}\u{1E800}-\u{1E8C4}\u{1E8C7}-\u{1E8D6}\u{1E900}-\u{1E94B}\u{1E950}-\u{1E959}\u{1E95E}\u{1E95F}\u{1EC71}-\u{1ECB4}\u{1ED01}-\u{1ED3D}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{1EEF0}\u{1EEF1}\u{1F000}-\u{1F02B}\u{1F030}-\u{1F093}\u{1F0A0}-\u{1F0AE}\u{1F0B1}-\u{1F0BF}\u{1F0C1}-\u{1F0CF}\u{1F0D1}-\u{1F0F5}\u{1F100}-\u{1F1AD}\u{1F1E6}-\u{1F202}\u{1F210}-\u{1F23B}\u{1F240}-\u{1F248}\u{1F250}\u{1F251}\u{1F260}-\u{1F265}\u{1F300}-\u{1F6D7}\u{1F6DC}-\u{1F6EC}\u{1F6F0}-\u{1F6FC}\u{1F700}-\u{1F776}\u{1F77B}-\u{1F7D9}\u{1F7E0}-\u{1F7EB}\u{1F7F0}\u{1F800}-\u{1F80B}\u{1F810}-\u{1F847}\u{1F850}-\u{1F859}\u{1F860}-\u{1F887}\u{1F890}-\u{1F8AD}\u{1F8B0}-\u{1F8BB}\u{1F8C0}\u{1F8C1}\u{1F900}-\u{1FA53}\u{1FA60}-\u{1FA6D}\u{1FA70}-\u{1FA7C}\u{1FA80}-\u{1FA89}\u{1FA8F}-\u{1FAC6}\u{1FACE}-\u{1FADC}\u{1FADF}-\u{1FAE9}\u{1FAF0}-\u{1FAF8}\u{1FB00}-\u{1FB92}\u{1FB94}-\u{1FBF9}\u{20000}-\u{2A6DF}\u{2A700}-\u{2B739}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2EBF0}-\u{2EE5D}\u{2F800}-\u{2FA1D}\u{30000}-\u{3134A}\u{31350}-\u{323AF}\u{E0100}-\u{E01EF}]/u.test($.key);if((he||U)&&$.bounds!==void 0&&vo(p([O-N,Math.max(0,Math.min(ve,J-1))]))){if((!d||ve!==J)&&(Q.y>ve||ve>Q.y+Q.height||Q.x>O||O>Q.x+Q.width))return;if($.stopPropagation(),$.preventDefault(),he){const ae={inputType:"keyboard",key:""};w==null||w([O-N,ve],ae),V($.bounds,ae,"")}else{const ae={inputType:"keyboard",key:$.key};w==null||w([O-N,ve],ae),V($.bounds,ae,$.key)}}},[r,m,de,E,p,N,J,d,w,V,W]);return{handleFixedKeybindings:de,onKeyDown:me}}function xc(e,t,n,o,l,i,u){const r=jt.c(24);let a;r[0]!==o||r[1]!==e||r[2]!==n||r[3]!==i||r[4]!==u||r[5]!==l||r[6]!==t?(a=(w,C,p,g)=>{var b,k;(i==="cell"||i==="multi-cell")&&w!==void 0&&(w={...w,range:{x:w.cell[0],y:w.cell[1],width:1,height:1}}),!u&&w!==void 0&&w.range.width>1&&(w={...w,range:{...w.range,width:1,x:w.cell[0]}});const x=n==="mixed"&&(p||g==="drag")||n==="additive",M=(o==="mixed"||o==="additive")&&x,B=p||(l==="mixed"||l==="additive")&&x;let R={current:w===void 0?void 0:{...w,rangeStack:g==="drag"?(b=(k=e.current)===null||k===void 0?void 0:k.rangeStack)!==null&&b!==void 0?b:[]:[]},columns:M?e.columns:tt.empty(),rows:B?e.rows:tt.empty()};p&&(i==="multi-rect"||i==="multi-cell")&&R.current!==void 0&&e.current!==void 0&&(R={...R,current:{...R.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(R,C)},r[0]=o,r[1]=e,r[2]=n,r[3]=i,r[4]=u,r[5]=l,r[6]=t,r[7]=a):a=r[7];const d=a;let c;r[8]!==o||r[9]!==e||r[10]!==n||r[11]!==l||r[12]!==t?(c=(w,C,p)=>{w=w??e.rows,C!==void 0&&(w=w.add(C));let g;if(l==="exclusive"&&w.length>0)g={current:void 0,columns:tt.empty(),rows:w};else{const b=p&&n==="mixed"||n==="additive",k=p&&o==="mixed"||o==="additive";g={current:b?e.current:void 0,columns:k?e.columns:tt.empty(),rows:w}}t(g,!1)},r[8]=o,r[9]=e,r[10]=n,r[11]=l,r[12]=t,r[13]=c):c=r[13];const h=c;let v;r[14]!==o||r[15]!==e||r[16]!==n||r[17]!==l||r[18]!==t?(v=(w,C,p)=>{w=w??e.columns,C!==void 0&&(w=w.add(C));let g;if(o==="exclusive"&&w.length>0)g={current:void 0,rows:tt.empty(),columns:w};else{const b=p&&n==="mixed"||n==="additive",k=p&&l==="mixed"||l==="additive";g={current:b?e.current:void 0,rows:k?e.rows:tt.empty(),columns:w}}t(g,!1)},r[14]=o,r[15]=e,r[16]=n,r[17]=l,r[18]=t,r[19]=v):v=r[19];const m=v;let f;return r[20]!==d||r[21]!==m||r[22]!==h?(f=[d,h,m],r[20]=d,r[21]=m,r[22]=h,r[23]=f):f=r[23],f}function Fc(e,t,n,o,l){const i=jt.c(12);let u;i[0]!==o.signal||i[1]!==t||i[2]!==e||i[3]!==l?(u=m=>{var f;if(e===!0){const w=[];for(let C=m.y;C<m.y+m.height;C++){const p=[];for(let g=m.x;g<m.x+m.width;g++)g<0||C>=l?p.push({kind:ie.Loading,allowOverlay:!1}):p.push(t([g,C]));w.push(p)}return w}return(f=e==null?void 0:e(m,o.signal))!==null&&f!==void 0?f:[]},i[0]=o.signal,i[1]=t,i[2]=e,i[3]=l,i[4]=u):u=i[4];const a=e!==void 0?u:void 0;let d;i[5]!==o.signal||i[6]!==a||i[7]!==n?(d=m=>{if(a===void 0)return[];const f={...m,x:m.x-n};if(f.x<0){f.x=0,f.width=f.width-1;const w=a(f,o.signal);return typeof w=="function"?async()=>(await w()).map(Sc):w.map(Dc)}return a(f,o.signal)},i[5]=o.signal,i[6]=a,i[7]=n,i[8]=d):d=i[8];const h=e!==void 0?d:void 0;let v;return i[9]!==h||i[10]!==a?(v=[h,a],i[9]=h,i[10]=a,i[11]=v):v=i[11],v}function Dc(e){return[{kind:ie.Loading,allowOverlay:!1},...e]}function Sc(e){return[{kind:ie.Loading,allowOverlay:!1},...e]}function lu(e){return typeof e=="string"?e:`${e}px`}const Mc=()=>e=>e.innerWidth,Rc=()=>e=>e.innerHeight,Ac=nn("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Mc()],"wmyidgi-1":[Rc()]}}),Bc=e=>{const{inWidth:t,inHeight:n,children:o,...l}=e;return s.createElement(Ac,{innerHeight:lu(n),innerWidth:lu(t),...l},o)},Ic=2,Hc=1300;function Tc(e,t,n){const o=jt.c(8),l=Un.useRef(0);let i;o[0]!==e?(i=e??[0,0],o[0]=e,o[1]=i):i=o[1];const[u,r]=i;let a,d;o[2]!==n||o[3]!==t||o[4]!==u||o[5]!==r?(a=()=>{if(u===0&&r===0){l.current=0;return}let c=!1,h=0;const v=m=>{if(!c){if(h===0)h=m;else{var f;const w=m-h;l.current=Math.min(1,l.current+w/Hc);const C=l.current**1.618*w*Ic;(f=t.current)===null||f===void 0||f.scrollBy(u*C,r*C),h=m,n==null||n()}window.requestAnimationFrame(v)}};return window.requestAnimationFrame(v),()=>{c=!0}},d=[t,u,r,n],o[2]=n,o[3]=t,o[4]=u,o[5]=r,o[6]=a,o[7]=d):(a=o[6],d=o[7]),Un.useEffect(a,d)}function zc(e){const t=jt.c(38),{state:n,keybindings:o,getCellsForSelection:l,coercePasteValue:i,onPaste:u,copyHeaders:r,columnsIn:a,onDelete:d,deleteRange:c,safeWindow:h}=e,{gridSelection:v,gridRef:m,scrollRef:f,canvasRef:w,abortControllerRef:C,rowMarkerOffset:p,mangledCols:g,mangledRows:b,rows:k,getMangledCellContent:x,mangledOnCellsEdited:M,getCellRenderer:B}=n;let R;t[0]!==w||t[1]!==i||t[2]!==B||t[3]!==x||t[4]!==m||t[5]!==v||t[6]!==o.paste||t[7]!==g.length||t[8]!==M||t[9]!==b||t[10]!==u||t[11]!==p||t[12]!==k||t[13]!==f?(R=async S=>{var W,N;if(!o.paste)return;const J=function(O,ve,Q,he){var U,ae;const ke=typeof Q=="object"?(U=Q==null?void 0:Q.join(`
`))!==null&&U!==void 0?U:"":(ae=Q==null?void 0:Q.toString())!==null&&ae!==void 0?ae:"";if(!Ao(O)&&vo(O)&&O.readonly!==!0){const Ye=i==null?void 0:i(ke,O);if(Ye!==void 0&&jn(Ye))return{location:ve,value:Ye};const ce=B(O);if(ce===void 0)return;if(ce.kind===ie.Custom){var te;vn(O.kind===ie.Custom);const H=(te=ce.onPaste)===null||te===void 0?void 0:te.call(ce,ke,O.data);return H===void 0?void 0:{location:ve,value:{...O,data:H}}}else{var Be;const H=(Be=ce.onPaste)===null||Be===void 0?void 0:Be.call(ce,ke,O,{formatted:he,formattedString:typeof he=="string"?he:he==null?void 0:he.join(`
`),rawValue:Q});return H===void 0?void 0:(vn(H.kind===O.kind),{location:ve,value:H})}}},G=v.columns,j=v.rows,_=((W=f.current)===null||W===void 0?void 0:W.contains(document.activeElement))===!0||((N=w.current)===null||N===void 0?void 0:N.contains(document.activeElement))===!0;let Y;if(v.current!==void 0)Y=[v.current.range.x,v.current.range.y];else if(G.length===1){var V;Y=[(V=G.first())!==null&&V!==void 0?V:0,0]}else if(j.length===1){var ee;Y=[p,(ee=j.first())!==null&&ee!==void 0?ee:0]}if(_&&Y!==void 0){var de;let Ce,O;if(navigator.clipboard.read!==void 0){const U=await navigator.clipboard.read();for(const ae of U){if(ae.types.includes("text/html")){const te=await(await ae.getType("text/html")).text(),Be=tu(te);if(Be!==void 0){Ce=Be;break}}ae.types.includes("text/plain")&&(O=await(await ae.getType("text/plain")).text())}}else if(navigator.clipboard.readText!==void 0)O=await navigator.clipboard.readText();else if(S!==void 0&&(S==null?void 0:S.clipboardData)!==null){if(S.clipboardData.types.includes("text/html")){const U=S.clipboardData.getData("text/html");Ce=tu(U)}Ce===void 0&&S.clipboardData.types.includes("text/plain")&&(O=S.clipboardData.getData("text/plain"))}else return;const[ve,Q]=Y,he=[];do{if(u===void 0){var me,$;const U=x(Y),ae=(me=O??(($=Ce)===null||$===void 0?void 0:$.map(Gc).join("	")))!==null&&me!==void 0?me:"",ke=J(U,Y,ae,void 0);ke!==void 0&&he.push(ke);break}if(Ce===void 0){if(O===void 0)return;Ce=Ec(O)}if(u===!1||typeof u=="function"&&(u==null?void 0:u([Y[0]-p,Y[1]],Ce.map(Nc)))!==!0)return;for(const[U,ae]of Ce.entries()){if(U+Q>=k)break;for(const[ke,te]of ae.entries()){const Be=[ke+ve,U+Q],[Ye,ce]=Be;if(Ye>=g.length||ce>=b)continue;const H=x(Be),re=J(H,Be,te.rawValue,te.formatted);re!==void 0&&he.push(re)}}}while(!1);M(he),(de=m.current)===null||de===void 0||de.damage(he.map(Wc))}},t[0]=w,t[1]=i,t[2]=B,t[3]=x,t[4]=m,t[5]=v,t[6]=o.paste,t[7]=g.length,t[8]=M,t[9]=b,t[10]=u,t[11]=p,t[12]=k,t[13]=f,t[14]=R):R=t[14];const F=R;tn("paste",F,h,!1,!0);let D;t[15]!==C||t[16]!==w||t[17]!==a||t[18]!==r||t[19]!==l||t[20]!==v||t[21]!==o.copy||t[22]!==p||t[23]!==k||t[24]!==f?(D=async(S,W)=>{var N,J;if(!o.copy)return;const G=W===!0||((N=f.current)===null||N===void 0?void 0:N.contains(document.activeElement))===!0||((J=w.current)===null||J===void 0?void 0:J.contains(document.activeElement))===!0,j=v.columns,_=v.rows,Y=(V,ee)=>{if(!r)ou(V,ee,S);else{const de=ee.map(me=>({kind:ie.Text,data:a[me].title,displayData:a[me].title,allowOverlay:!1}));ou([de,...V],ee,S)}};if(G&&l!==void 0){if(v.current!==void 0){let V=l(v.current.range,C.current.signal);typeof V!="object"&&(V=await V()),Y(V,Ro(v.current.range.x-p,v.current.range.x+v.current.range.width-p))}else if(_!==void 0&&_.length>0){const ee=[..._].map(de=>{const me=l({x:p,y:de,width:a.length,height:1},C.current.signal);return typeof me=="object"?me[0]:me().then(Oc)});if(ee.some(Lc)){const de=await Promise.all(ee);Y(de,Ro(a.length))}else Y(ee,Ro(a.length))}else if(j.length>0){const V=[],ee=[];for(const de of j){let me=l({x:de,y:0,width:1,height:k},C.current.signal);typeof me!="object"&&(me=await me()),V.push(me),ee.push(de-p)}if(V.length===1)Y(V[0],ee);else{const de=V.reduce(Pc);Y(de,ee)}}}},t[15]=C,t[16]=w,t[17]=a,t[18]=r,t[19]=l,t[20]=v,t[21]=o.copy,t[22]=p,t[23]=k,t[24]=f,t[25]=D):D=t[25];const I=D;tn("copy",I,h,!1,!1);let T;t[26]!==w||t[27]!==c||t[28]!==v||t[29]!==o.cut||t[30]!==I||t[31]!==d||t[32]!==f?(T=async S=>{var W,N;if(!(!o.cut||!(((W=f.current)===null||W===void 0?void 0:W.contains(document.activeElement))===!0||((N=w.current)===null||N===void 0?void 0:N.contains(document.activeElement))===!0))&&(await I(S),v.current!==void 0)){let G={current:{cell:v.current.cell,range:v.current.range,rangeStack:[]},rows:tt.empty(),columns:tt.empty()};const j=d==null?void 0:d(G);if(j===!1||(G=j===void 0||j===!0?G:j,G.current===void 0))return;c(G.current.range)}},t[26]=w,t[27]=c,t[28]=v,t[29]=o.cut,t[30]=I,t[31]=d,t[32]=f,t[33]=T):T=t[33];const z=T;tn("cut",z,h,!1,!1);let E;return t[34]!==I||t[35]!==z||t[36]!==F?(E={onCopy:I,onCut:z,onPasteInternal:F},t[34]=I,t[35]=z,t[36]=F,t[37]=E):E=t[37],E}function Pc(e,t){return e.map((n,o)=>[...n,...t[o]])}function Lc(e){return e instanceof Promise}function Oc(e){return e[0]}function Wc(e){return{cell:e.location}}function Nc(e){return e.map($c)}function $c(e){var t,n;return(t=(n=e.rawValue)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""}function Gc(e){return e.map(Xc).join("	")}function Xc(e){return e.rawValue}function Kc(e){const t=jt.c(30),{rowHeight:n,headerHeight:o,groupHeaderHeight:l,theme:i,overscrollX:u,overscrollY:r,scaleToRem:a,remSize:d}=e;let c;e:{var h,v,m;if(!a||d===16){let G;t[0]!==l||t[1]!==o||t[2]!==u||t[3]!==r||t[4]!==n||t[5]!==i?(G=[n,o,l,i,u,r],t[0]=l,t[1]=o,t[2]=u,t[3]=r,t[4]=n,t[5]=i,t[6]=G):G=t[6],c=G;break e}const x=d/16,M=n;let B;t[7]===Symbol.for("react.memo_cache_sentinel")?(B=Eu(),t[7]=B):B=t[7];const R=B;let F;t[8]!==M||t[9]!==x?(F=typeof M=="number"?M*x:G=>Math.ceil(M(G)*x),t[8]=M,t[9]=x,t[10]=F):F=t[10];const D=Math.ceil(o*x),I=Math.ceil(l*x),T=((h=i==null?void 0:i.headerIconSize)!==null&&h!==void 0?h:R.headerIconSize)*x,z=((v=i==null?void 0:i.cellHorizontalPadding)!==null&&v!==void 0?v:R.cellHorizontalPadding)*x,E=((m=i==null?void 0:i.cellVerticalPadding)!==null&&m!==void 0?m:R.cellVerticalPadding)*x;let S;t[11]!==T||t[12]!==z||t[13]!==E||t[14]!==i?(S={...i,headerIconSize:T,cellHorizontalPadding:z,cellVerticalPadding:E},t[11]=T,t[12]=z,t[13]=E,t[14]=i,t[15]=S):S=t[15];const W=Math.ceil((u??0)*x),N=Math.ceil((r??0)*x);let J;t[16]!==W||t[17]!==N||t[18]!==F||t[19]!==D||t[20]!==I||t[21]!==S?(J=[F,D,I,S,W,N],t[16]=W,t[17]=N,t[18]=F,t[19]=D,t[20]=I,t[21]=S,t[22]=J):J=t[22],c=J}const[f,w,C,p,g,b]=c;let k;return t[23]!==C||t[24]!==w||t[25]!==g||t[26]!==b||t[27]!==f||t[28]!==p?(k={rowHeight:f,headerHeight:w,groupHeaderHeight:C,theme:p,overscrollX:g,overscrollY:b},t[23]=C,t[24]=w,t[25]=g,t[26]=b,t[27]=f,t[28]=p,t[29]=k):k=t[29],k}const ao={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Je(e,t){return e===!0?t:e===!1?"":e}function iu(e){const t=gi.value;return{activateCell:Je(e.activateCell," |Enter|shift+Enter"),clear:Je(e.clear,"any+Escape"),closeOverlay:Je(e.closeOverlay,"any+Escape"),acceptOverlayDown:Je(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Je(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Je(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Je(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Je(e.delete,t?"Backspace|Delete":"Delete"),downFill:Je(e.downFill,"primary+_68"),scrollToSelectedCell:Je(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Je(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Je(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Je(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Je(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Je(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Je(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Je(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Je(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Je(e.goToFirstCell,"primary+Home"),goToFirstColumn:Je(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Je(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Je(e.goToLastCell,"primary+End"),goToLastColumn:Je(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Je(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Je(e.goToNextPage,"PageDown"),goToPreviousPage:Je(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Je(e.rightFill,"primary+_82"),search:Je(e.search,"primary+f"),selectAll:Je(e.selectAll,"primary+a"),selectColumn:Je(e.selectColumn,"ctrl+ "),selectGrowDown:Je(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Je(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Je(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Je(e.selectGrowUp,"shift+ArrowUp"),selectRow:Je(e.selectRow,"shift+ "),selectToFirstCell:Je(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Je(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Je(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Je(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Je(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Je(e.selectToLastRow,"primary+shift+ArrowDown")}}function Yc(e){const t=jt.c(9),n=la(e);let o;e:{var l,i,u,r,a,d,c,h,v,m,f,w;if(n===void 0){let B;t[0]===Symbol.for("react.memo_cache_sentinel")?(B=iu(ao),t[0]=B):B=t[0],o=B;break e}const C=(l=(i=n==null?void 0:n.goToNextPage)!==null&&i!==void 0?i:n==null?void 0:n.pageDown)!==null&&l!==void 0?l:ao.goToNextPage,p=(u=(r=n==null?void 0:n.goToPreviousPage)!==null&&r!==void 0?r:n==null?void 0:n.pageUp)!==null&&u!==void 0?u:ao.goToPreviousPage,g=(a=(d=n==null?void 0:n.goToFirstCell)!==null&&d!==void 0?d:n==null?void 0:n.first)!==null&&a!==void 0?a:ao.goToFirstCell,b=(c=(h=n==null?void 0:n.goToLastCell)!==null&&h!==void 0?h:n==null?void 0:n.last)!==null&&c!==void 0?c:ao.goToLastCell,k=(v=(m=n==null?void 0:n.selectToFirstCell)!==null&&m!==void 0?m:n==null?void 0:n.first)!==null&&v!==void 0?v:ao.selectToFirstCell,x=(f=(w=n==null?void 0:n.selectToLastCell)!==null&&w!==void 0?w:n==null?void 0:n.last)!==null&&f!==void 0?f:ao.selectToLastCell;let M;if(t[1]!==n||t[2]!==C||t[3]!==p||t[4]!==g||t[5]!==b||t[6]!==k||t[7]!==x){const B={...n,goToNextPage:C,goToPreviousPage:p,goToFirstCell:g,goToLastCell:b,selectToFirstCell:k,selectToLastCell:x};M=iu({...ao,...B}),t[1]=n,t[2]=C,t[3]=p,t[4]=g,t[5]=b,t[6]=k,t[7]=x,t[8]=M}else M=t[8];o=M}return o}function Vc(e){function t(o,l,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:l,path:i};const u={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:l,path:i};return o.subGroups!==void 0&&(u.subGroups=o.subGroups.map((r,a)=>t(r,l+1,[...i,a])).sort((r,a)=>r.headerIndex-a.headerIndex)),u}return e.map((o,l)=>t(o,0,[l])).sort((o,l)=>o.headerIndex-l.headerIndex)}function cr(e,t){const n=[];function o(r,a){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=a!==null?a-r.headerIndex:t-r.headerIndex;if(r.subGroups!==void 0&&(c=r.subGroups[0].headerIndex-r.headerIndex),c--,n.push({rowIndex:-1,headerIndex:r.headerIndex,contentIndex:-1,skip:d,isCollapsed:r.isCollapsed,depth:r.depth,path:r.path,rows:c}),r.subGroups)for(let h=0;h<r.subGroups.length;h++){const v=h<r.subGroups.length-1?r.subGroups[h+1].headerIndex:a;o(r.subGroups[h],v,d||r.isCollapsed)}}const l=Vc(e.groups);for(let r=0;r<l.length;r++){const a=r<l.length-1?l[r+1].headerIndex:null;o(l[r],a)}let i=0,u=0;for(const r of n)r.contentIndex=u,u+=r.rows,r.rowIndex=i,i+=r.isCollapsed?1:r.rows+1;return n.filter(r=>r.skip===!1).map(r=>{const{skip:a,...d}=r;return d})}function Ji(e,t){if(t===void 0||cr.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Uc(e,t,n,o){const l=jt.c(30);let i;l[0]!==e||l[1]!==t?(i=e===void 0?void 0:cr(e,t),l[0]=e,l[1]=t,l[2]=i):i=l[2];const u=i;let r;l[3]!==u?(r=u==null?void 0:u.reduce(qc,{}),l[3]=u,l[4]=r):r=l[4];const a=r;let d;e:{if(u===void 0){d=t;break e}let x;l[5]!==u?(x=u.reduce(jc,0),l[5]=u,l[6]=x):x=l[6],d=x}const c=d;let h;e:{if(e===void 0){h=n;break e}if(typeof n=="number"&&e.height===n){h=n;break e}let x;l[7]!==a||l[8]!==e||l[9]!==n?(x=M=>a!=null&&a[M]?e.height:typeof n=="number"?n:n(M),l[7]=a,l[8]=e,l[9]=n,l[10]=x):x=l[10],h=x}const v=h;let m;l[11]!==u?(m=x=>{if(u===void 0)return x;let M=x;for(const B of u){if(M===0)return;if(M--,!B.isCollapsed){if(M<B.rows)return B.contentIndex+M;M=M-B.rows}}return x},l[11]=u,l[12]=m):m=l[12];const f=m,w=o??(e==null?void 0:e.themeOverride);let C;l[13]!==u||l[14]!==o||l[15]!==e?(C=x=>{if(e===void 0)return o==null?void 0:o(x,x,x);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:M,contentIndex:B,groupIndex:R}=Ji(x,u);return M?e.themeOverride:o==null?void 0:o(x,R,B)},l[13]=u,l[14]=o,l[15]=e,l[16]=C):C=l[16];const p=C;let g;l[17]!==w||l[18]!==p?(g=fo(w,p),l[17]=w,l[18]=p,l[19]=g):g=l[19];const b=g;if(e===void 0){let x;return l[20]!==b||l[21]!==v||l[22]!==f||l[23]!==t?(x={rowHeight:v,rows:t,rowNumberMapper:f,getRowThemeOverride:b},l[20]=b,l[21]=v,l[22]=f,l[23]=t,l[24]=x):x=l[24],x}let k;return l[25]!==c||l[26]!==b||l[27]!==v||l[28]!==f?(k={rowHeight:v,rows:c,rowNumberMapper:f,getRowThemeOverride:b},l[25]=c,l[26]=b,l[27]=v,l[28]=f,l[29]=k):k=l[29],k}function jc(e,t){return e+(t.isCollapsed?1:t.rows+1)}function qc(e,t){return e[t.rowIndex]=t,e}function Zc(e,t){const n=jt.c(7);let o;n[0]!==e||n[1]!==t?(o=e===void 0?void 0:cr(e,t),n[0]=e,n[1]=t,n[2]=o):o=n[2];const l=o;let i;n[3]!==l?(i=a=>{if(typeof a=="number")return Ji(a,l);const d=Ji(a[1],l);return{...d,originalIndex:[a[0],d.originalIndex]}},n[3]=l,n[4]=i):i=n[4];const u=i;let r;return n[5]!==u?(r={getRowGroupingForPath:Uu,updateRowGroupingByPath:Vu,mapper:u},n[5]=u,n[6]=r):r=n[6],r}function Vu(e,t,n){const[o,...l]=t;return l[0]===-1?e.map((i,u)=>u===o?{...i,...n}:i):e.map((i,u)=>{var r;return u===o?{...i,subGroups:Vu((r=i.subGroups)!==null&&r!==void 0?r:[],l,n)}:i})}function Uu(e,t){var n;const[o,...l]=t;return l[0]===-1?e[o]:Uu((n=e[o].subGroups)!==null&&n!==void 0?n:[],l)}function Jc(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const l=n.value;l!==o&&(n.value=o,n.callback(o,l))}}}));return n.callback=t,n.facade}function Qc(e,t,n,o,l){var i,u;const[r,a]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),d=s.useMemo(()=>{var p,g;return{x:o.current.x,y:r,width:(p=o.current.width)!==null&&p!==void 0?p:1,height:(g=o.current.height)!==null&&g!==void 0?g:1,ty:a}},[o,a,r]),[c,h,v]=oa(d),m=s.useRef(l);m.current=l;const f=Jc(null,p=>{p!==null&&t!==void 0?p.scrollTop=t:p!==null&&e!==void 0&&(p.scrollLeft=e)}),w=((i=c.height)!==null&&i!==void 0?i:1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&f.current!==null&&w){if(f.current.scrollTop===t)return;f.current.scrollTop=t,f.current.scrollTop!==t&&v(),m.current()}},[t,w,v,f]);const C=((u=c.width)!==null&&u!==void 0?u:1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&f.current!==null&&C){if(f.current.scrollLeft===e)return;f.current.scrollLeft=e,f.current.scrollLeft!==e&&v(),m.current()}},[e,C,v,f]),{visibleRegion:c,setVisibleRegion:h,scrollRef:f}}const _c=nn("textarea")({name:"GhostInputBox",class:"gdg-g1wsindo",propsAsIs:!1}),e0=(e,t)=>{const{onInput:n,onCompositionStart:o,onCompositionEnd:l,onKeyDown:i,onKeyUp:u,onFocus:r,onBlur:a,disabled:d=!1}=e,c=s.useRef(null),h=s.useRef(!1),v=s.useRef({width:0,height:0}),m=s.useCallback(()=>{const b=c.current;if(!b||b.style.opacity==="0")return;const k=v.current.width,x=v.current.height;b.style.width=`${k}px`,b.style.height=`${x}px`;const M=Math.max(k,b.scrollWidth+2),B=Math.max(x,b.scrollHeight+2);b.style.width=`${M}px`,b.style.height=`${B}px`},[]);s.useImperativeHandle(t,()=>({focus:()=>{var b;(b=c.current)===null||b===void 0||b.focus({preventScroll:!0})},blur:()=>{var b;(b=c.current)===null||b===void 0||b.blur()},clear:()=>{c.current&&(c.current.value="",c.current.setSelectionRange(0,0))},getValue:()=>{var b,k;return(b=(k=c.current)===null||k===void 0?void 0:k.value)!==null&&b!==void 0?b:""},setValue:b=>{if(c.current){c.current.value=b;const k=b.length;c.current.setSelectionRange(k,k)}},setPosition:(b,k,x,M)=>{const B=c.current;B&&(v.current={width:x,height:M},B.style.left=`${b}px`,B.style.top=`${k}px`,B.style.width=`${x}px`,B.style.height=`${M}px`)},setVisible:b=>{const k=c.current;k&&(b?(k.style.opacity="1",k.style.pointerEvents="auto",k.style.zIndex="10000"):(k.style.left="-9999px",k.style.top="0",k.style.width="1px",k.style.height="1px",k.style.opacity="0",k.style.pointerEvents="none",k.style.zIndex="0"))}}));const f=s.useCallback(b=>{const k=b.currentTarget;n(k.value,h.current),m()},[n,m]),w=s.useCallback(()=>{h.current=!0,o()},[o]),C=s.useCallback(b=>{h.current=!1,l(b.currentTarget.value)},[l]),p=s.useCallback(b=>{i(b)},[i]),g=s.useCallback(b=>{u==null||u(b)},[u]);return s.createElement(_c,{ref:c,defaultValue:"",tabIndex:d?-1:0,disabled:d,onInput:f,onCompositionStart:w,onCompositionEnd:C,onKeyDown:p,onKeyUp:g,onFocus:r,onBlur:a,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},t0=s.memo(s.forwardRef(e0));function n0(e){const t=jt.c(41),{state:n,onKeyDown:o,onFinishEditing:l,onKeyUpIn:i,onCellActivated:u,setIsFocused:r}=e,{gridSelection:a,overlayRef:d,ghostInputRef:c,ghostInputVisibleRef:h,gridRef:v,rowMarkerOffset:m,getMangledCellContent:f,reselect:w}=n;let C;t[0]!==f||t[1]!==v||t[2]!==a||t[3]!==u||t[4]!==d||t[5]!==w||t[6]!==m?(C=(E,S)=>{if(d.current===void 0&&!S&&E.length>0&&E.trim().length>0&&a.current!==void 0){const[N,J]=a.current.cell,G=f([N,J]);if(G.kind===ie.Custom){const j=G.data,_=j==null?void 0:j.kind;if(_!=="number-cell"&&_!=="date-picker-cell")return}if(G.allowOverlay&&vo(G)&&G.readonly!==!0){var W;const j=(W=v.current)===null||W===void 0?void 0:W.getBounds(N,J);if(j!==void 0){const _={inputType:"keyboard",key:E};u==null||u([N-m,J],_),w(j,_,E)}}}},t[0]=f,t[1]=v,t[2]=a,t[3]=u,t[4]=d,t[5]=w,t[6]=m,t[7]=C):C=t[7];const p=C;let g;t[8]!==f||t[9]!==c||t[10]!==v||t[11]!==a||t[12]!==u||t[13]!==d||t[14]!==w||t[15]!==m||t[16]!==n?(g=()=>{var E;if(a.current===void 0)return;const[S,W]=a.current.cell,N=(E=d.current)===null||E===void 0?void 0:E.cell;if(N!==void 0&&(N[0]!==S||N[1]!==W)){var J,G;(J=c.current)===null||J===void 0||J.clear(),(G=c.current)===null||G===void 0||G.setVisible(!1),n.setGhostInputVisible(!1),d.current=void 0,n.setOverlay(void 0)}if(d.current===void 0){const Y=f([S,W]);if(Y.kind===ie.Custom){const V=Y.data,ee=V==null?void 0:V.kind;if(ee!=="number-cell"&&ee!=="date-picker-cell")return}if(Y.allowOverlay&&vo(Y)&&Y.readonly!==!0){var j;const V=(j=v.current)===null||j===void 0?void 0:j.getBounds(S,W);if(V!==void 0){var _;(_=c.current)===null||_===void 0||_.clear();const ee={inputType:"keyboard",key:""};u==null||u([S-m,W],ee),w(V,ee,"")}}}},t[8]=f,t[9]=c,t[10]=v,t[11]=a,t[12]=u,t[13]=d,t[14]=w,t[15]=m,t[16]=n,t[17]=g):g=t[17];const b=g,k=l0;let x;t[18]!==f||t[19]!==h||t[20]!==v||t[21]!==a||t[22]!==l||t[23]!==o||t[24]!==d?(x=E=>{var S,W;if(E.nativeEvent.isComposing)return;if(d.current!==void 0&&h.current){const V=E.key;if(d.current.content.kind===ie.Custom){(V==="Enter"||V==="Tab"||V==="Escape")&&(E.preventDefault(),E.stopPropagation());return}if(V==="Escape"){E.preventDefault(),E.stopPropagation(),l(void 0,[0,0]);return}if(V==="Enter"&&!E.shiftKey){E.preventDefault(),E.stopPropagation(),l(void 0,[0,1]);return}if(V==="Tab"){E.preventDefault(),E.stopPropagation(),l(void 0,E.shiftKey?[-1,0]:[1,0]);return}}const N=E.key;if(N.length===1&&!E.ctrlKey&&!E.metaKey&&!E.altKey)if(N===" "&&a.current!==void 0){const V=a.current.cell,ee=f(V);if(!(ee.kind===ie.Boolean&&ee.readonly!==!0))return}else return;if(d.current!==void 0&&h.current){const V=E.key;if(V==="Backspace"||V==="Delete"||(V==="ArrowLeft"||V==="ArrowRight"||V==="ArrowUp"||V==="ArrowDown"||V==="Home"||V==="End"))return}const G=(S=a.current)===null||S===void 0?void 0:S.cell,j=G!==void 0?(W=v.current)===null||W===void 0?void 0:W.getBounds(G[0],G[1]):void 0;let _=!1;const Y={bounds:j,cancel:()=>{_=!0},stopPropagation:()=>E.stopPropagation(),preventDefault:()=>E.preventDefault(),ctrlKey:E.ctrlKey,metaKey:E.metaKey,shiftKey:E.shiftKey,altKey:E.altKey,key:E.key,keyCode:E.keyCode,rawEvent:E,location:G};o(Y),_&&(E.preventDefault(),E.stopPropagation())},t[18]=f,t[19]=h,t[20]=v,t[21]=a,t[22]=l,t[23]=o,t[24]=d,t[25]=x):x=t[25];const M=x;let B;t[26]!==v||t[27]!==a||t[28]!==i?(B=E=>{var S,W;const N=(S=a.current)===null||S===void 0?void 0:S.cell,G={bounds:N!==void 0?(W=v.current)===null||W===void 0?void 0:W.getBounds(N[0],N[1]):void 0,cancel:o0,stopPropagation:()=>E.stopPropagation(),preventDefault:()=>E.preventDefault(),ctrlKey:E.ctrlKey,metaKey:E.metaKey,shiftKey:E.shiftKey,altKey:E.altKey,key:E.key,keyCode:E.keyCode,rawEvent:E,location:N};i==null||i(G)},t[26]=v,t[27]=a,t[28]=i,t[29]=B):B=t[29];const R=B;let F;t[30]!==r?(F=()=>{r(!0)},t[30]=r,t[31]=F):F=t[31];const D=F;let I;t[32]!==r?(I=()=>{r(!1)},t[32]=r,t[33]=I):I=t[33];const T=I;let z;return t[34]!==T||t[35]!==b||t[36]!==D||t[37]!==p||t[38]!==M||t[39]!==R?(z={onGhostInput:p,onGhostCompositionStart:b,onGhostCompositionEnd:k,onGhostKeyDown:M,onGhostKeyUp:R,onGhostFocus:D,onGhostBlur:T},t[34]=T,t[35]=b,t[36]=D,t[37]=p,t[38]=M,t[39]=R,t[40]=z):z=t[40],z}function o0(){}function l0(e){}function i0(e){const{state:t,mouseState:n,setMouseState:o,fillHighlightRegion:l,setFillHighlightRegion:i,setScrollDir:u,handleSelect:r,onMouseMove:a,onCellClicked:d,onCellActivated:c,onCellContextMenu:h,onHeaderContextMenu:v,onGroupHeaderContextMenu:m,onHeaderClicked:f,onGroupHeaderClicked:w,onColumnResize:C,onFillPattern:p,cellActivationBehavior:g,columnSelect:b,columnSelectionMode:k,columns:x,groupLevels:M,mergedTheme:B,minColumnWidth:R,maxColumnWidth:F,themeForCell:D,getCellsForSelection:I,setSelectedColumns:T,visibleRegion:z,lastMouseSelectLocation:E}=e,{gridSelection:S,gridRef:W,visibleRegionRef:N,abortControllerRef:J,rowMarkerOffset:G,mangledCols:j,rows:_,setGridSelection:Y,getMangledCellContent:V,mangledOnCellsEdited:ee,reselect:de,focus:me,getCellRenderer:$}=t,Ce=s.useRef(!1),O=s.useRef(z),ve=s.useRef(void 0),Q=s.useRef(!1),he=s.useCallback(H=>{if(Q.current=!1,O.current=N.current,H.button!==0&&H.button!==1){ve.current=void 0;return}const re=performance.now();ve.current={button:H.button,time:re,location:H.location},(H==null?void 0:H.kind)==="header"&&(Ce.current=!0);const ge=H.kind==="cell"&&H.isFillHandle;!ge&&H.kind!=="cell"&&H.isEdge||(o({previousSelection:S,fillHandle:ge}),E.current=void 0,!H.isTouch&&H.button===0&&!ge?r(H):!H.isTouch&&H.button===1&&(E.current=H.location))},[S,r]),U=s.useCallback(H=>{if(H.kind!==An||b!=="multi")return;const re=gi.value?H.metaKey:H.ctrlKey,[ge,ne]=H.location,Re=S.columns;if(ge<G)return;const De=j[ge];let xe=ge,Ie=ge;const fe=ne<=-2?-(ne+2):0,Fe=(ze,Xe)=>M>1?si(ze,Xe,fe,M):Fu(ze,Xe);for(let ze=ge-1;ze>=G&&Fe(De.group,j[ze].group);ze--)xe--;for(let ze=ge+1;ze<j.length&&Fe(De.group,j[ze].group);ze++)Ie++;if(me(),re||H.isTouch||k==="multi")if(Re.hasAll([xe,Ie+1])){let ze=Re;for(let Xe=xe;Xe<=Ie;Xe++)ze=ze.remove(Xe);T(ze,void 0,re)}else T(void 0,[xe,Ie+1],re);else T(tt.fromSingleSelection([xe,Ie+1]),void 0,re)},[b,me,S.columns,j,G,T,k,M]),ae=s.useCallback(async H=>{if(I!==void 0&&C!==void 0){const re=N.current.y,ge=N.current.height;let ne=I({x:H,y:re,width:1,height:Math.min(ge,_-re)},J.current.signal);typeof ne!="object"&&(ne=await ne());const Re=x[H-G],xe=document.createElement("canvas").getContext("2d",{alpha:!1});if(xe!==null){xe.font=B.baseFontFull;const Ie=zu(xe,B,Re,0,ne,R,F,!1,$);C==null||C(Re,Ie.width,H,Ie.width)}}},[x,I,F,B,R,C,G,_,$]),ke=s.useCallback(async(H,re)=>{var ge,ne;const Re=(ge=H.current)===null||ge===void 0?void 0:ge.range;if(Re===void 0||I===void 0||re.current===void 0)return;const De=re.current.range;if(p!==void 0){let Fe=!1;if(p({fillDestination:{...De,x:De.x-G},patternSource:{...Re,x:Re.x-G},preventDefault:()=>Fe=!0}),Fe)return}let xe=I(Re,J.current.signal);typeof xe!="object"&&(xe=await xe());const Ie=xe,fe=[];for(let Fe=0;Fe<De.width;Fe++)for(let ze=0;ze<De.height;ze++){const Xe=[De.x+Fe,De.y+ze];if(Du(Xe,Re))continue;const be=Ie[ze%Re.height][Fe%Re.width];Ao(be)||!vo(be)||fe.push({location:Xe,value:{...be}})}ee(fe),(ne=W.current)===null||ne===void 0||ne.damage(fe.map(Fe=>({cell:Fe.location})))},[I,ee,p,G]),te=s.useCallback(()=>{if(S.current===void 0||S.current.range.width<=1)return;const H={...S,current:{...S.current,range:{...S.current.range,width:1}}};ke(H,S)},[ke,S]),Be=s.useCallback(()=>{if(S.current===void 0||S.current.range.height<=1)return;const H={...S,current:{...S.current,range:{...S.current.range,height:1}}};ke(H,S)},[ke,S]),Ye=s.useCallback((H,re)=>{var ge,ne;const Re=n;if(o(void 0),i(void 0),u(void 0),Ce.current=!1,re)return;if((Re==null?void 0:Re.fillHandle)===!0&&S.current!==void 0&&((ge=Re.previousSelection)===null||ge===void 0?void 0:ge.current)!==void 0){if(l===void 0)return;const Ve={...S,current:{...S.current,range:Wu(Re.previousSelection.current.range,l)}};ke(Re.previousSelection,Ve),Y(Ve,!0);return}const[De,xe]=H.location,[Ie,fe]=(ne=E.current)!==null&&ne!==void 0?ne:[],Fe=()=>{Q.current=!0},ze=Ve=>{const nt=Ve.isTouch||Ie===De&&fe===xe;if(nt&&(d==null||d([De-G,xe],{...Ve,preventDefault:Fe})),Ve.button===1)return!Q.current;if(!Q.current){var je;const qe=V(H.location),vt=$(qe);if(vt!==void 0&&vt.onClick!==void 0&&nt){const ot=vt.onClick({...Ve,cell:qe,posX:Ve.localEventX,posY:Ve.localEventY,bounds:Ve.bounds,theme:D(qe,H.location),preventDefault:Fe});if(ot!==void 0&&!Ao(ot)&&jn(ot)){var Ue;ee([{location:Ve.location,value:ot}]),(Ue=W.current)===null||Ue===void 0||Ue.damage([{cell:Ve.location}])}}if(Q.current||S.current===void 0)return!1;let Pe=!1;switch((je=qe.activationBehaviorOverride)!==null&&je!==void 0?je:g){case"double-click":case"second-click":{var at;if((Re==null||(at=Re.previousSelection)===null||at===void 0||(at=at.current)===null||at===void 0?void 0:at.cell)===void 0)break;const[ot,Mt]=S.current.cell,[Ht,xt]=Re.previousSelection.current.cell;Pe=De===ot&&De===Ht&&xe===Mt&&xe===xt&&(Ve.isDoubleClick===!0||g==="second-click");break}case"single-click":{Pe=!0;break}}if(Pe){var ct;const Mt={inputType:"pointer",pointerActivation:Ve.isDoubleClick===!0?"double-click":(ct=qe.activationBehaviorOverride)!==null&&ct!==void 0?ct:g,pointerType:Ve.isTouch?"touch":"mouse"};return c==null||c([De-G,xe],Mt),de(Ve.bounds,Mt),!0}}return!1},Xe=H.location[0]-G;if(H.isTouch){const Ve=N.current,nt=O.current;if(Ve.x!==nt.x||Ve.y!==nt.y)return;if(H.isLongTouch===!0){var be;if(H.kind==="cell"&&kl((be=S.current)===null||be===void 0?void 0:be.cell,H.location)){h==null||h([Xe,H.location[1]],{...H,preventDefault:Fe});return}else if(H.kind==="header"&&S.columns.hasIndex(De)){v==null||v(Xe,{...H,preventDefault:Fe});return}else if(H.kind===An){if(Xe<0)return;m==null||m(Xe,{...H,preventDefault:Fe});return}}H.kind==="cell"?ze(H)||r(H):H.kind===An?w==null||w(Xe,{...H,preventDefault:Fe}):(H.kind===ho&&(f==null||f(Xe,{...H,preventDefault:Fe})),r(H));return}if(H.kind==="header"){if(Xe<0)return;H.isEdge?H.isDoubleClick===!0&&ae(De):H.button===0&&De===Ie&&xe===fe&&(f==null||f(Xe,{...H,preventDefault:Fe}))}if(H.kind===An){if(Xe<0)return;H.button===0&&De===Ie&&xe===fe&&(w==null||w(Xe,{...H,preventDefault:Fe}),Q.current||U(H))}H.kind==="cell"&&(H.button===0||H.button===1)&&ze(H),E.current=void 0},[n,S,G,l,ke,Y,d,V,$,g,D,ee,c,de,h,v,m,r,w,f,ae,U]),ce=s.useCallback(H=>{const re={...H,location:[H.location[0]-G,H.location[1]]};a==null||a(re),n!==void 0&&H.buttons===0&&(o(void 0),i(void 0),u(void 0),Ce.current=!1),u(ge=>{var ne,Re;return Ce.current?[H.scrollEdge[0],0]:H.scrollEdge[0]===(ge==null?void 0:ge[0])&&H.scrollEdge[1]===ge[1]?ge:n===void 0||((ne=(Re=ve.current)===null||Re===void 0?void 0:Re.location[0])!==null&&ne!==void 0?ne:0)<G?void 0:H.scrollEdge})},[n,a,G]);return{onMouseDown:he,onMouseUp:Ye,onMouseMoveImpl:ce,handleGroupHeaderSelection:U,normalSizeColumn:ae,fillDown:Be,fillRight:te,mouseDownData:ve,isActivelyDraggingHeader:Ce}}const r0=s.lazy(async()=>await au(()=>Promise.resolve().then(()=>ka),void 0,import.meta.url));let u0=0;function s0(e){return Us(Pr(Pr(e).filter(t=>t.span!==void 0).map(t=>{var n,o,l,i;return Ro(((n=(o=t.span)===null||o===void 0?void 0:o[0])!==null&&n!==void 0?n:0)+1,((l=(i=t.span)===null||i===void 0?void 0:i[1])!==null&&l!==void 0?l:0)+1)})))}function oi(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const co={kind:ie.Loading,allowOverlay:!1},$i={columns:tt.empty(),rows:tt.empty(),current:void 0},a0=(e,t)=>{var n,o,l,i,u,r,a,d,c,h,v,m,f,w,C,p;const[g,b]=s.useState($i),[k,x]=s.useState(),M=s.useRef(null),B=s.useRef(null),[R,F]=s.useState(),[D,I]=s.useState(),T=s.useRef(void 0),z=s.useRef(null),[E,S]=s.useState(!1),W=s.useRef(E);W.current=E;const N=s.useRef(k);N.current=k;const J=typeof window>"u"?null:window,{imageEditorOverride:G,getRowThemeOverride:j,markdownDivCreateNode:_,width:Y,height:V,columns:ee,rows:de,getCellContent:me,onCellClicked:$,onCellActivated:Ce,onFillPattern:O,onFinishedEditing:ve,coercePasteValue:Q,drawHeader:he,drawCell:U,editorBloom:ae,onHeaderClicked:ke,onColumnProposeMove:te,rangeSelectionColumnSpanning:Be=!0,spanRangeBehavior:Ye="default",onGroupHeaderClicked:ce,onCellContextMenu:H,className:re,onHeaderContextMenu:ge,getCellsForSelection:ne,onGroupHeaderContextMenu:Re,onGroupHeaderRenamed:De,onCellEdited:xe,onCellsEdited:Ie,onSearchResultsChanged:fe,searchResults:Fe,onSearchValueChange:ze,searchValue:Xe,onKeyDown:be,onKeyUp:Ve,keybindings:nt,editOnType:je=!0,onRowAppended:Ue,onColumnAppended:at,onColumnMoved:ct,validateCell:qe,highlightRegions:vt,rangeSelect:Pe="rect",columnSelect:ot="multi",rowSelect:Mt="multi",rangeSelectionBlending:Ht="exclusive",columnSelectionBlending:xt="exclusive",rowSelectionBlending:Wt="exclusive",onDelete:wt,onDragStart:Zt,onMouseMove:pn,onPaste:Le,copyHeaders:Bt=!1,freezeColumns:Rt=0,cellActivationBehavior:Jt="second-click",rowSelectionMode:Cn="auto",columnSelectionMode:Bn="auto",onHeaderMenuClick:on,onHeaderIndicatorClick:In,getGroupDetails:Yt,rowGrouping:ln,onSearchClose:Ge,onItemHovered:pt,onSelectionCleared:rt,showSearch:Gt,onVisibleRegionChanged:Xt,gridSelection:mt,onGridSelectionChange:Nn,minColumnWidth:vi=50,maxColumnWidth:qn=500,maxColumnAutoWidth:Zn,provideEditor:il,trailingRowOptions:it,freezeTrailingRows:ft=0,allowedFillDirections:To="orthogonal",scrollOffsetX:Lt,scrollOffsetY:Ot,verticalBorder:qt,onDragOverCell:Sl,onDrop:Jn,onColumnResize:dn,onColumnResizeEnd:cn,onColumnResizeStart:Hn,customRenderers:po,fillHandle:Ml,experimental:At,fixedShadowX:zo,fixedShadowY:Po,headerIcons:Lo,imageWindowLoader:Co,initialSize:Qn,isDraggable:mi,onDragLeave:Rl,onRowMoved:bo,overscrollX:wi,overscrollY:$n,preventDiagonalScrolling:_n,rightElement:pi,rightElementProps:Ci,trapFocus:Al=!1,smoothScrollX:Bl,smoothScrollY:Oo,scaleToRem:fr=!1,rowHeight:Il=34,headerHeight:Wo=36,groupHeaderHeight:Hl=Wo,theme:rl,isOutsideClick:No,renderers:Tn,resizeIndicator:ul,scrollToActiveCell:eo=!0,drawFocusRing:$o=!0,portalElementRef:Go,onRowStatus:yo,onRowId:Xo}=e,Tl=$o==="no-editor"?k===void 0:$o,Ke=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,zl=(n=Ke==null?void 0:Ke.rowNumber)!==null&&n!==void 0?n:!1;let Eo=(o=(l=Ke==null?void 0:Ke.kind)!==null&&l!==void 0?l:e.rowMarkers)!==null&&o!==void 0?o:"none",Qt=zl;(Eo==="both"||Eo==="checkbox-and-number")&&(Eo="checkbox",Qt=!0);const rn=Eo,sl=(i=Ke==null?void 0:Ke.width)!==null&&i!==void 0?i:e.rowMarkerWidth,al=(u=(r=Ke==null?void 0:Ke.startIndex)!==null&&r!==void 0?r:e.rowMarkerStartIndex)!==null&&u!==void 0?u:1,dl=(a=Ke==null?void 0:Ke.theme)!==null&&a!==void 0?a:e.rowMarkerTheme,cl=Ke==null?void 0:Ke.headerTheme,Pl=Ke==null?void 0:Ke.headerAlwaysVisible,to=Mt!=="multi"||(Ke==null?void 0:Ke.headerDisabled)===!0,no=(d=Ke==null?void 0:Ke.checkboxStyle)!==null&&d!==void 0?d:"square",bi=(c=Ke==null?void 0:Ke.rowStatus)!==null&&c!==void 0?c:!1,fl=(h=Ke==null?void 0:Ke.rowStatusWidth)!==null&&h!==void 0?h:40,Ko=Ke==null?void 0:Ke.rowStatusTheme,Ll=(v=Ke==null?void 0:Ke.rowId)!==null&&v!==void 0?v:!1,oo=(m=Ke==null?void 0:Ke.rowIdWidth)!==null&&m!==void 0?m:80,lo=Ke==null?void 0:Ke.rowIdTheme,Gn=Math.max(vi,20),hl=Math.max(qn,Gn),Yo=Math.max(Zn??hl,Gn),Ol=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:_e,rowNumberMapper:gl,rowHeight:yi,getRowThemeOverride:P}=Uc(ln,de,Il,j),q=s.useMemo(()=>Number.parseFloat(Ol.fontSize),[Ol]),{rowHeight:Ee,headerHeight:Se,groupHeaderHeight:we,theme:Me,overscrollX:Oe,overscrollY:lt}=Kc({groupHeaderHeight:Hl,headerHeight:Wo,overscrollX:wi,overscrollY:$n,remSize:q,rowHeight:yi,scaleToRem:fr,theme:rl}),ye=Yc(nt),yt=sl??(de>1e4?48:de>1e3?44:de>100?36:32),We=rn!=="none",Ne=bi===!0,Et=Ll===!0,X=(We?Qt?2:1:0)+(Ne?1:0)+(Et?1:0),ut=(We?(Qt?2:1)*yt:0)+(Ne?fl:0)+(Et?oo:0),$e=it!==void 0,Vt=(it==null?void 0:it.sticky)===!0,[zt,bn]=s.useState(!1),zn=Gt??zt,fn=s.useCallback(()=>{Ge!==void 0?Ge():bn(!1)},[Ge]),ht=s.useMemo(()=>mt===void 0?void 0:oi(mt,X),[mt,X]),pe=ht??g,Kt=s.useRef(new AbortController);s.useEffect(()=>()=>Kt==null?void 0:Kt.current.abort(),[]);const[_t,hn]=Fc(ne,me,X,Kt.current,_e),ko=s.useCallback((y,A,L)=>{if(qe===void 0)return!0;const K=[y[0]-X,y[1]];return qe==null?void 0:qe(K,A,L)},[X,qe]),Fn=s.useRef(mt),Dn=s.useCallback((y,A)=>{A&&(y=yc(y,_t,X,Ye,Kt.current)),Nn!==void 0?(Fn.current=oi(y,-X),Nn(Fn.current)):b(y)},[Nn,_t,X,Ye]),io=fo(dn,s.useCallback((y,A,L,K)=>{dn==null||dn(ee[L-X],A,L-X,K)},[dn,X,ee])),Ei=fo(cn,s.useCallback((y,A,L,K)=>{cn==null||cn(ee[L-X],A,L-X,K)},[cn,X,ee])),ki=fo(Hn,s.useCallback((y,A,L,K)=>{Hn==null||Hn(ee[L-X],A,L-X,K)},[Hn,X,ee])),Zu=fo(he,s.useCallback((y,A)=>{var L;return(L=he==null?void 0:he({...y,columnIndex:y.columnIndex-X},A))!==null&&L!==void 0?L:!1},[he,X])),Ju=fo(U,s.useCallback((y,A)=>{var L;return(L=U==null?void 0:U({...y,col:y.col-X},A))!==null&&L!==void 0?L:!1},[U,X])),hr=s.useCallback(y=>{if(wt!==void 0){const A=wt(oi(y,-X));return typeof A=="boolean"?A:oi(A,X)}return!0},[wt,X]),[Ut,yn,gn]=xc(pe,Dn,Ht,xt,Wt,Pe,Be),un=s.useMemo(()=>On(Eu(),Me),[Me]),[xi,Qu]=s.useState([0,0,0]),gr=s.useMemo(()=>{if(Tn===void 0)return{};const y={};for(const A of Tn)y[A.kind]=A;return y},[Tn]),Pn=s.useCallback(y=>y.kind!==ie.Custom?gr[y.kind]:po==null?void 0:po.find(A=>A.isMatch(y)),[po,gr]);let{sizedColumns:Sn,nonGrowWidth:vr}=Na(ee,_e,hn,xi[0]-ut-xi[2],Gn,Yo,un,Pn,Kt.current);vr+=ut;const Vo=s.useMemo(()=>{let y=0;for(const A of Sn)A.group!==void 0&&(typeof A.group=="string"?y=Math.max(y,1):y=Math.max(y,A.group.length));return y},[Sn]),mr=Vo>0,wr=s.useMemo(()=>Vo===0?[]:Array(Vo).fill(we),[Vo,we]),_u=wr.reduce((y,A)=>y+A,0),vl=Se+_u,pr=pe.rows.length,Cr=rn==="none"?void 0:pr===0?!1:pr===_e?!0:void 0,Ct=s.useMemo(()=>{const y=[];return rn!=="none"&&(Qt&&y.push({title:"",width:yt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:dl,rowMarker:no,rowMarkerChecked:!1,headerRowMarkerTheme:cl,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),y.push({title:"",width:yt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:dl,rowMarker:no,rowMarkerChecked:Cr,headerRowMarkerTheme:cl,headerRowMarkerAlwaysVisible:Pl,headerRowMarkerDisabled:to})),Ne&&y.push({title:"",width:fl,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Ko}),Et&&y.push({title:"ID",width:oo,icon:void 0,hasMenu:!1,style:"normal",themeOverride:lo}),[...y,...Sn]},[Ne,fl,Ko,Et,oo,lo,rn,Sn,yt,dl,no,Cr,cl,Pl,to,Qt]),ro=s.useRef({height:1,width:1,x:0,y:0}),Wl=s.useRef(!1),{setVisibleRegion:br,visibleRegion:xo,scrollRef:Ft}=Qc(Lt,Ot,Ee,ro,()=>Wl.current=!0);ro.current=xo;const es=xo.x+X,Nl=xo.y,sn=s.useRef(null),an=s.useCallback(y=>{if(y===!0){var A;(A=z.current)===null||A===void 0||A.focus()}else window.requestAnimationFrame(()=>{var L;(L=z.current)===null||L===void 0||L.focus()})},[]),en=$e?_e+1:_e,Fo=s.useCallback(y=>{const A=X===0?y:y.map(K=>({...K,location:[K.location[0]-X,K.location[1]]})),L=Ie==null?void 0:Ie(A);if(L!==!0)for(const K of A)xe==null||xe(K.location,K.value);return L},[xe,Ie,X]),[ml,yr]=s.useState(),Uo=pe.current!==void 0&&pe.current.range.width*pe.current.range.height>1?pe.current.range:void 0,jo=Tl?(f=pe.current)===null||f===void 0?void 0:f.cell:void 0,$l=jo==null?void 0:jo[0],Gl=jo==null?void 0:jo[1],ts=s.useMemo(()=>{var y,A;if((vt===void 0||vt.length===0)&&((y=(A=Uo??$l)!==null&&A!==void 0?A:Gl)!==null&&y!==void 0?y:ml)===void 0)return;const L=[];if(vt!==void 0)for(const K of vt){const le=Ct.length-K.range.x-X;le>0&&L.push({color:K.color,range:{...K.range,x:K.range.x+X,width:Math.min(le,K.range.width)},style:K.style})}return ml!==void 0&&L.push({color:mo(un.accentColor,0),range:ml,style:"dashed"}),Uo!==void 0&&L.push({color:mo(un.accentColor,.5),range:Uo,style:"solid-outline"}),$l!==void 0&&Gl!==void 0&&L.push({color:un.accentColor,range:{x:$l,y:Gl,width:1,height:1},style:"solid-outline"}),L.length>0?L:void 0},[ml,Uo,$l,Gl,vt,Ct.length,un.accentColor,X]),Er=s.useRef(Ct);Er.current=Ct;const Xn=s.useCallback(function(y){let[A,L]=y,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const le=$e&&L===en-1;let Z=0,se=-1,oe=-1,ue=-1,He=-1;if(We&&Qt&&(se=Z++),We&&(oe=Z++),Ne&&(ue=Z++),Et&&(He=Z++),A===se){var Te;if(le)return co;const Tt=gl(L);return Tt===void 0?co:{kind:$t.Marker,allowOverlay:!1,checkboxStyle:no,checked:!1,markerKind:"number",row:al+Tt,drawHandle:!1,cursor:void 0,disabled:((Te=e.disabledRows)===null||Te===void 0?void 0:Te.call(e,L))===!0}}if(A===oe){var et;if(le)return co;const Tt=gl(L);if(Tt===void 0)return co;let Nt;return Qt?Nt=rn==="checkbox-visible"?"checkbox-visible":"checkbox":rn==="clickable-number"?Nt="number":Nt=rn,{kind:$t.Marker,allowOverlay:!1,checkboxStyle:no,checked:(pe==null?void 0:pe.rows.hasIndex(L))===!0,markerKind:Nt,row:al+Tt,drawHandle:bo!==void 0,cursor:Qt?void 0:rn==="clickable-number"?"pointer":void 0,disabled:((et=e.disabledRows)===null||et===void 0?void 0:et.call(e,L))===!0}}if(A===ue){if(le)return co;const Tt=yo==null?void 0:yo(L);return{kind:$t.RowStatus,allowOverlay:!1,status:Tt,themeOverride:Ko}}if(A===He){if(le)return co;const Tt=Xo==null?void 0:Xo(L);return{kind:$t.RowId,allowOverlay:!1,rowId:Tt,themeOverride:lo}}if(le){var Pt,Dt;const Nt=A===X&&(Pt=it==null?void 0:it.hint)!==null&&Pt!==void 0?Pt:"",kt=Er.current[A];if((kt==null||(Dt=kt.trailingRowOptions)===null||Dt===void 0?void 0:Dt.disabled)===!0)return co;{var Qe,Ae,gt,bt;const Ln=(Qe=kt==null||(Ae=kt.trailingRowOptions)===null||Ae===void 0?void 0:Ae.hint)!==null&&Qe!==void 0?Qe:Nt,Mn=(gt=kt==null||(bt=kt.trailingRowOptions)===null||bt===void 0?void 0:bt.addIcon)!==null&&gt!==void 0?gt:it==null?void 0:it.addIcon;return{kind:$t.NewRow,hint:Ln,allowOverlay:!1,icon:Mn}}}else{const Tt=A-X;if(K||(At==null?void 0:At.strict)===!0){var st,dt,kn;const kt=ro.current,Ln=kt.x>Tt||Tt>kt.x+kt.width||kt.y>L||L>kt.y+kt.height||L>=Mi.current,Mn=Tt===((st=kt.extras)===null||st===void 0||(st=st.selected)===null||st===void 0?void 0:st[0])&&L===((dt=kt.extras)===null||dt===void 0?void 0:dt.selected[1]);let Yn=!1;if(((kn=kt.extras)===null||kn===void 0?void 0:kn.freezeRegions)!==void 0){for(const Jo of kt.extras.freezeRegions)if(go(Jo,Tt,L)){Yn=!0;break}}if(Ln&&!Mn&&!Yn)return co}let Nt=me([Tt,L]);return X!==0&&Nt.span!==void 0&&(Nt={...Nt,span:[Nt.span[0]+X,Nt.span[1]+X]}),Nt}},[$e,en,Ne,yo,Ko,Et,Xo,lo,We,gl,no,pe==null?void 0:pe.rows,rn,al,bo,X,it==null?void 0:it.hint,it==null?void 0:it.addIcon,At==null?void 0:At.strict,me,Qt]),Fi=s.useCallback(y=>{var A;let L=(A=Yt==null?void 0:Yt(y))!==null&&A!==void 0?A:{name:y};if(De!==void 0&&y!==""){var K;L={icon:L.icon,name:L.name,overrideTheme:L.overrideTheme,actions:[...(K=L.actions)!==null&&K!==void 0?K:[],{title:"Rename",icon:"renameIcon",onClick:le=>Bi({group:L.name,bounds:le.bounds})}]}}return L},[Yt,De]),Xl=s.useCallback(y=>{var A;const[L,K]=y.cell,le=Ct[L],Z=(le==null?void 0:le.group)!==void 0?(A=Fi(le.group))===null||A===void 0?void 0:A.overrideTheme:void 0,se=le==null?void 0:le.themeOverride,oe=P==null?void 0:P(K);x({...y,theme:On(un,Z,se,oe,y.content.themeOverride)})},[P,Ct,Fi,un]),ns=s.useCallback((y,A,L)=>{if(pe.current===void 0)return;const[K,le]=pe.current.cell,Z=Xn([K,le]);if(Z.kind!==ie.Boolean&&Z.allowOverlay){let Dt=Z;if(L!==void 0)switch(Dt.kind){case ie.Number:{const gt=qs(()=>L==="-"?-0:Number.parseFloat(L),0);Dt={...Dt,data:Number.isNaN(gt)?0:gt};break}case ie.Text:case ie.Markdown:case ie.Uri:Dt={...Dt,data:L};break}Xl({target:y,content:Dt,initialValue:L,cell:[K,le],highlight:L===void 0,forceEditMode:L!==void 0,activation:A});const Qe=Dt.kind===ie.Custom;if(L!==void 0&&!Qe){var se,oe;if((se=z.current)===null||se===void 0||se.setPosition(y.x,y.y,y.width,y.height),L.length>0){var ue;(ue=z.current)===null||ue===void 0||ue.setValue(L)}(oe=z.current)===null||oe===void 0||oe.setVisible(!0),S(!0)}else if(Qe&&L!==void 0){var He,Te,et;(He=z.current)===null||He===void 0||He.clear(),(Te=z.current)===null||Te===void 0||Te.setVisible(!1),(et=z.current)===null||et===void 0||et.blur(),S(!1)}}else if(Z.kind===ie.Boolean&&A.inputType==="keyboard"&&Z.readonly!==!0){var Pt;Fo([{location:pe.current.cell,value:{...Z,data:dr(Z.data)}}]),(Pt=sn.current)===null||Pt===void 0||Pt.damage([{cell:pe.current.cell}])}},[Xn,pe,Fo,Xl]),kr=s.useCallback((y,A)=>{var L;const K=(L=sn.current)===null||L===void 0?void 0:L.getBounds(y,A);if(K===void 0||Ft.current===null)return;const le=Xn([y,A]);le.allowOverlay&&Xl({target:K,content:le,initialValue:void 0,highlight:!0,cell:[y,A],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Xn,Ft,Xl]),It=s.useCallback(function(y,A){let L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"both",K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,le=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,Z=arguments.length>5&&arguments[5]!==void 0?arguments[5]:void 0;if(Ft.current!==null){const ue=sn.current,He=B.current,Te=typeof y!="number"?y.unit==="cell"?y.amount:void 0:y,et=typeof A!="number"?A.unit==="cell"?A.amount:void 0:A,Pt=typeof y!="number"&&y.unit==="px"?y.amount:void 0,Dt=typeof A!="number"&&A.unit==="px"?A.amount:void 0;if(ue!==null&&He!==null){let Qe={x:0,y:0,width:0,height:0},Ae=0,gt=0;if(Te!==void 0||et!==void 0){var se;if(Qe=(se=ue.getBounds((Te??0)+X,et??0))!==null&&se!==void 0?se:Qe,Qe.width===0||Qe.height===0)return}const bt=He.getBoundingClientRect(),st=bt.width/He.offsetWidth;if(Pt!==void 0&&(Qe={...Qe,x:Pt-bt.left-Ft.current.scrollLeft,width:1}),Dt!==void 0&&(Qe={...Qe,y:Dt+bt.top-Ft.current.scrollTop,height:1}),Qe!==void 0){const dt={x:Qe.x-K,y:Qe.y-le,width:Qe.width+2*K,height:Qe.height+2*le};let kn=0;for(let Pi=0;Pi<Rt;Pi++)kn+=Sn[Pi].width;let Tt=0;const Nt=ft+(Vt?1:0);Nt>0&&(Tt=Io(en,Nt,Ee));let kt=kn*st+bt.left+ut*st,Ln=bt.right,Mn=bt.top+vl*st,Yn=bt.bottom-Tt*st;const Jo=Qe.width+K*2;switch(Z==null?void 0:Z.hAlign){case"start":Ln=kt+Jo;break;case"end":kt=Ln-Jo;break;case"center":kt=Math.floor((kt+Ln)/2)-Jo/2,Ln=kt+Jo;break}const Ql=Qe.height+le*2;switch(Z==null?void 0:Z.vAlign){case"start":Yn=Mn+Ql;break;case"end":Mn=Yn-Ql;break;case"center":Mn=Math.floor((Mn+Yn)/2)-Ql/2,Yn=Mn+Ql;break}if(kt>dt.x?Ae=dt.x-kt:Ln<dt.x+dt.width&&(Ae=dt.x+dt.width-Ln),Mn>dt.y?gt=dt.y-Mn:Yn<dt.y+dt.height&&(gt=dt.y+dt.height-Yn),L==="vertical"||typeof y=="number"&&y<Rt?Ae=0:(L==="horizontal"||typeof A=="number"&&A>=en-Nt)&&(gt=0),Ae!==0||gt!==0){var oe;st!==1&&(Ae/=st,gt/=st),Ft.current.scrollTo({left:Ae+Ft.current.scrollLeft,top:gt+Ft.current.scrollTop,behavior:(oe=Z==null?void 0:Z.behavior)!==null&&oe!==void 0?oe:"auto"})}}}}},[X,ft,yt,Ft,vl,Rt,Sn,en,Vt,Ee]),Kl=s.useRef(It);Kl.current=It;const Di=s.useRef(kr),Si=s.useRef(me);Di.current=kr,Si.current=me;const Mi=s.useRef(_e);Mi.current=_e;const xr=s.useRef(Ct.length);xr.current=Ct.length;const Do=s.useCallback(async function(y){var A;let L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,K=arguments.length>2?arguments[2]:void 0;const le=Ct[y];if((le==null||(A=le.trailingRowOptions)===null||A===void 0?void 0:A.disabled)===!0)return;const Z=Ue==null?void 0:Ue();let se,oe=!0;Z!==void 0&&(se=await Z,se==="top"&&(oe=!1),typeof se=="number"&&(oe=!1));let ue=0;const He=()=>{if(Mi.current<=_e){ue<500&&window.setTimeout(He,ue),ue=50+ue*2;return}const Te=typeof se=="number"?se:oe?_e:0;Kl.current(y-X,Te,"both",0,20,K?{behavior:K}:void 0),Ut({cell:[y,Te],range:{x:y,y:Te,width:1,height:1}},!1,!1,"edit");const et=Si.current([y-X,Te]);et.allowOverlay&&vo(et)&&et.readonly!==!0&&L&&window.setTimeout(()=>{Di.current(y,Te)},0)};He()},[Ct,Ue,X,_e,Ut]),Yl=s.useCallback(async function(y){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const L=at==null?void 0:at();let K,le=!0;L!==void 0&&(K=await L,K==="left"&&(le=!1),typeof K=="number"&&(le=!1));let Z=0;const se=()=>{if(xr.current<=Ct.length){Z<500&&window.setTimeout(se,Z),Z=50+Z*2;return}const oe=typeof K=="number"?K:le?Ct.length:0;It(oe-X,y),Ut({cell:[oe,y],range:{x:oe,y,width:1,height:1}},!1,!1,"edit");const ue=Si.current([oe-X,y]);ue.allowOverlay&&vo(ue)&&ue.readonly!==!0&&A&&window.setTimeout(()=>{Di.current(oe,y)},0)};se()},[Ct,at,X,It,Ut]),wl=s.useCallback(y=>{var A,L;const K=(A=(L=Sn[y])===null||L===void 0||(L=L.trailingRowOptions)===null||L===void 0?void 0:L.targetColumn)!==null&&A!==void 0?A:it==null?void 0:it.targetColumn;if(typeof K=="number")return K+(We?1:0);if(typeof K=="object"){const le=ee.indexOf(K);if(le>=0)return le+(We?1:0)}},[Sn,ee,We,it==null?void 0:it.targetColumn]),uo=s.useRef(void 0),qo=s.useRef(void 0),Vl=s.useCallback((y,A)=>{var L;const[K,le]=A;return On(un,(L=Ct[K])===null||L===void 0?void 0:L.themeOverride,P==null?void 0:P(le),y.themeOverride)},[P,Ct,un]),{mapper:pl}=Zc(ln,de),Ri=ln==null?void 0:ln.navigationBehavior,Ul=s.useRef(void 0),os=s.useCallback(y=>{var A,L;const K=gi.value?y.metaKey:y.ctrlKey,le=K&&Mt==="multi",[Z,se]=y.location,oe=pe.columns,ue=pe.rows,[He,Te]=(A=(L=pe.current)===null||L===void 0?void 0:L.cell)!==null&&A!==void 0?A:[];if(y.kind==="cell"){if(qo.current=void 0,Ul.current=[Z,se],Z===(Qt?1:0)&&We){if($e===!0&&se===_e||rn==="number"||Mt==="none")return;const Ae=Xn(y.location);if(Ae.kind!==$t.Marker||Ae.disabled===!0)return;if(bo!==void 0){var et;const st=Pn(Ae);vn((st==null?void 0:st.kind)===$t.Marker);const dt=st==null||(et=st.onClick)===null||et===void 0?void 0:et.call(st,{...y,cell:Ae,posX:y.localEventX,posY:y.localEventY,bounds:y.bounds,theme:Vl(Ae,y.location),preventDefault:()=>{}});if(dt===void 0||dt.checked===Ae.checked)return}x(void 0),an();const gt=ue.hasIndex(se),bt=uo.current;if(Mt==="multi"&&(y.shiftKey||y.isLongTouch===!0)&&bt!==void 0&&ue.hasIndex(bt)){const st=[Math.min(bt,se),Math.max(bt,se)+1];le||Cn==="multi"?yn(void 0,st,!0):yn(tt.fromSingleSelection(st),void 0,le)}else Mt==="multi"&&(le||y.isTouch||Cn==="multi")?gt?yn(ue.remove(se),void 0,!0):(yn(void 0,se,!0),uo.current=se):gt&&ue.length===1?yn(tt.empty(),void 0,K):(yn(tt.fromSingleSelection(se),void 0,K),uo.current=se)}else if(Z>=X&&$e&&se===_e){const Ae=wl(Z);Do(Ae??Z)}else if(He!==Z||Te!==se){var Pt;const Ae=Xn(y.location),gt=Pn(Ae);if((gt==null?void 0:gt.onSelect)!==void 0){let dt=!1;if(gt.onSelect({...y,cell:Ae,posX:y.localEventX,posY:y.localEventY,bounds:y.bounds,preventDefault:()=>dt=!0,theme:Vl(Ae,y.location)}),dt)return}if(Ri==="block"&&pl(se).isGroupHeader)return;const bt=Vt&&se===_e,st=Vt&&pe!==void 0&&((Pt=pe.current)===null||Pt===void 0?void 0:Pt.cell[1])===_e;if((y.shiftKey||y.isLongTouch===!0)&&He!==void 0&&Te!==void 0&&pe.current!==void 0&&!st){if(bt)return;const dt=Math.min(Z,He),kn=Math.max(Z,He),Tt=Math.min(se,Te),Nt=Math.max(se,Te);Ut({...pe.current,range:{x:dt,y:Tt,width:kn-dt+1,height:Nt-Tt+1}},!0,K,"click"),uo.current=void 0,an()}else{const dt=pe.rows.length>0;Ut({cell:[Z,se],range:{x:Z,y:se,width:1,height:1}},!0,K||dt,"click"),uo.current=void 0,x(void 0),an()}}}else if(y.kind==="header")if(Ul.current=[Z,se],x(void 0),We&&Z===(Qt?1:0))uo.current=void 0,qo.current=void 0,!to&&Mt==="multi"&&(ue.length!==_e?yn(tt.fromSingleSelection([0,_e]),void 0,K):yn(tt.empty(),void 0,K),an());else{const Qe=qo.current;if(ot==="multi"&&(y.shiftKey||y.isLongTouch===!0)&&Qe!==void 0&&oe.hasIndex(Qe)){const Ae=[Math.min(Qe,Z),Math.max(Qe,Z)+1];K||y.isTouch||Bn==="multi"?gn(void 0,Ae,K):gn(tt.fromSingleSelection(Ae),void 0,K)}else ot==="multi"&&(K||y.isTouch||Bn==="multi")?(oe.hasIndex(Z)?gn(oe.remove(Z),void 0,K):gn(void 0,Z,K),qo.current=Z):ot!=="none"&&(oe.hasIndex(Z)?gn(oe.remove(Z),void 0,K):gn(tt.fromSingleSelection(Z),void 0,K),qo.current=Z);uo.current=void 0,an()}else y.kind===An?Ul.current=[Z,se]:y.kind===ci&&!y.isMaybeScrollbar&&(Dn($i,!1),x(void 0),an(),rt==null||rt(),uo.current=void 0,qo.current=void 0)},[Mt,ot,pe,We,X,$e,Qt,_e,rn,Xn,bo,an,Cn,Bn,Pn,Vl,yn,wl,Do,Ri,pl,Vt,Ut,to,gn,Dn,rt]),jl={gridSelection:pe,overlay:k,gridRef:sn,ghostInputRef:z,overlayRef:N,ghostInputVisibleRef:W,scrollRef:Ft,canvasRef:B,visibleRegionRef:ro,abortControllerRef:Kt,rowMarkerOffset:X,mangledCols:Ct,mangledRows:en,rows:_e,setGridSelection:Dn,getMangledCellContent:Xn,mangledOnCellsEdited:Fo,setOverlay:x,focus:an,setGhostInputVisible:S,reselect:ns,getCellRenderer:Pn},{onMouseDown:ls,onMouseUp:is,onMouseMoveImpl:rs,normalSizeColumn:Fr,fillDown:us,fillRight:ss,mouseDownData:Kn,isActivelyDraggingHeader:as}=i0({state:jl,mouseState:R,setMouseState:F,fillHighlightRegion:ml,setFillHighlightRegion:yr,setScrollDir:I,handleSelect:os,onMouseMove:pn,onCellClicked:$,onCellActivated:Ce,onCellContextMenu:H,onHeaderContextMenu:ge,onGroupHeaderContextMenu:Re,onHeaderClicked:ke,onGroupHeaderClicked:ce,onColumnResize:io,onFillPattern:O,cellActivationBehavior:Jt,columnSelect:ot,columnSelectionMode:Bn,columns:Sn,groupLevels:Vo,mergedTheme:un,minColumnWidth:Gn,maxColumnWidth:hl,themeForCell:Vl,getCellsForSelection:_t,setSelectedColumns:gn,visibleRegion:xo,lastMouseSelectLocation:Ul}),[Ai,Bi]=s.useState(),ds=s.useCallback((y,A)=>{on==null||on(y-X,A)},[on,X]),cs=s.useCallback((y,A)=>{In==null||In(y-X,A)},[In,X]);s.useEffect(()=>{if(k===void 0)return;const y=K=>{const le=[];let Z=K.parentElement;for(;Z&&Z!==document.documentElement;){const se=window.getComputedStyle(Z),oe=se.overflow+se.overflowY+se.overflowX;(oe.includes("scroll")||oe.includes("auto"))&&le.push(Z),Z=Z.parentElement}return le},A=K=>{const le=K.target;Ft.current&&!Ft.current.contains(le)&&x(void 0)},L=[];if(Ft.current){const K=y(Ft.current);L.push(...K)}return L.forEach(K=>{K.addEventListener("scroll",A)}),window.addEventListener("scroll",A),document.addEventListener("scroll",A,!0),()=>{L.forEach(K=>{K.removeEventListener("scroll",A)}),window.removeEventListener("scroll",A),document.removeEventListener("scroll",A,!0)}},[k,x,Ft]);const En=pe==null||(w=pe.current)===null||w===void 0?void 0:w.cell,fs=s.useCallback((y,A,L,K,le,Z)=>{if(Wl.current=!1,k!==void 0){const Te=ro.current;(Te.x!==y.x||Te.y!==y.y)&&x(void 0)}let se=En;se!==void 0&&(se=[se[0]-X,se[1]]);const oe=Rt===0?void 0:{x:0,y:y.y,width:Rt,height:y.height},ue=[];oe!==void 0&&ue.push(oe),ft>0&&(ue.push({x:y.x-X,y:_e-ft,width:y.width,height:ft}),Rt>0&&ue.push({x:0,y:_e-ft,width:Rt,height:ft}));const He={x:y.x-X,y:y.y,width:y.width,height:$e&&y.y+y.height>=_e?y.height-1:y.height,tx:le,ty:Z,extras:{selected:se,freezeRegion:oe,freezeRegions:ue}};ro.current=He,br(He),Qu([A,L,K]),Xt==null||Xt(He,He.tx,He.ty,He.extras)},[En,k,X,$e,_e,Rt,ft,x,br,Xt]),hs=fo(te,s.useCallback((y,A)=>(te==null?void 0:te(y-X,A-X))!==!1,[te,X])),gs=fo(ct,s.useCallback((y,A)=>{ct==null||ct(y-X,A-X),ot!=="none"&&gn(tt.fromSingleSelection(A),void 0,!0)},[ot,ct,X,gn])),Ii=s.useRef(!1),vs=s.useCallback(y=>{if(y.location[0]===0&&X>0){y.preventDefault();return}Zt==null||Zt({...y,location:[y.location[0]-X,y.location[1]]}),y.defaultPrevented()||(Ii.current=!0),F(void 0)},[Zt,X]),ms=s.useCallback(()=>{Ii.current=!1},[]),Dr=ln==null?void 0:ln.selectionBehavior,ql=s.useCallback(y=>{if(Dr!=="block-spanning")return;const{isGroupHeader:A,path:L,groupRows:K}=pl(y);if(A)return[y,y];const le=L[L.length-1],Z=y-le,se=y+K-le-1;return[Z,se]},[pl,Dr]),Hi=s.useRef(void 0),Ti=s.useCallback(y=>{var A,L;if(!Ku(y,Hi.current)&&(Hi.current=y,!((Kn==null||(A=Kn.current)===null||A===void 0?void 0:A.button)!==void 0&&Kn.current.button>=1))){if(y.buttons!==0&&R!==void 0&&((L=Kn.current)===null||L===void 0?void 0:L.location[0])===0&&X===1&&Mt==="multi"&&R.previousSelection&&!R.previousSelection.rows.hasIndex(Kn.current.location[1])&&pe.rows.hasIndex(Kn.current.location[1])){const le=Math.min(Kn.current.location[1],y.location[1]),Z=Math.max(Kn.current.location[1],y.location[1])+1;yn(tt.fromSingleSelection([le,Z]),void 0,!1)}else if(y.buttons!==0&&R!==void 0&&pe.current!==void 0&&!Ii.current&&!as.current&&(Pe==="rect"||Pe==="multi-rect")){var K;const[le,Z]=pe.current.cell;let[se,oe]=y.location;if(oe<0&&(oe=ro.current.y),R.fillHandle===!0&&((K=R.previousSelection)===null||K===void 0?void 0:K.current)!==void 0){const ue=R.previousSelection.current.range;oe=Math.min(oe,$e?_e-1:_e);const He=Ed(ue,se,oe,To);yr(He)}else{if($e&&Z===_e)return;if($e&&oe===_e)if(y.kind===ci)oe--;else return;se=Math.max(se,X);const Te=ql(Z);oe=Te===void 0?oe:xn(oe,Te[0],Te[1]);const et=se-le,Pt=oe-Z,Dt={x:et>=0?le:se,y:Pt>=0?Z:oe,width:Math.abs(et)+1,height:Math.abs(Pt)+1};Ut({...pe.current,range:Dt},!0,!1,"drag")}}pt==null||pt({...y,location:[y.location[0]-X,y.location[1]]})}},[R,X,Mt,pe,Pe,pt,yn,$e,_e,To,ql,Ut]),ws=s.useCallback(()=>{const y=Hi.current;if(y===void 0)return;const[A,L]=y.scrollEdge;let[K,le]=y.location;const Z=ro.current;if(A===-1){var se,oe;K=(se=(oe=Z.extras)===null||oe===void 0||(oe=oe.freezeRegion)===null||oe===void 0?void 0:oe.x)!==null&&se!==void 0?se:Z.x}else A===1&&(K=Z.x+Z.width);L===-1?le=Math.max(0,Z.y):L===1&&(le=Math.min(_e-1,Z.y+Z.height)),K=xn(K,0,Ct.length-1),le=xn(le,0,_e-1),Ti({...y,location:[K,le]})},[Ct.length,Ti,_e]);Tc(D,Ft,ws);const ps=s.useCallback(y=>{var A;if(pe.current===void 0)return;const[L,K]=y,[le,Z]=pe.current.cell,se=pe.current.range;let oe=se.x,ue=se.x+se.width,He=se.y,Te=se.y+se.height;const[et,Pt]=(A=ql(Z))!==null&&A!==void 0?A:[0,_e-1],Dt=Pt+1;if(K!==0)switch(K){case 2:{Te=Dt,He=Z,It(0,Te,"vertical");break}case-2:{He=et,Te=Z+1,It(0,He,"vertical");break}case 1:{He<Z?(He++,It(0,He,"vertical")):(Te=Math.min(Dt,Te+1),It(0,Te,"vertical"));break}case-1:{Te>Z+1?(Te--,It(0,Te,"vertical")):(He=Math.max(et,He-1),It(0,He,"vertical"));break}default:Fl()}if(L!==0)if(L===2)ue=Ct.length,oe=le,It(ue-1-X,0,"horizontal");else if(L===-2)oe=X,ue=le+1,It(oe-X,0,"horizontal");else{let Qe=[];if(_t!==void 0){const Ae=_t({x:oe,y:He,width:ue-oe-X,height:Te-He},Kt.current.signal);typeof Ae=="object"&&(Qe=s0(Ae))}if(L===1){let Ae=!1;if(oe<le){if(Qe.length>0){const gt=Ro(oe+1,le+1).find(bt=>!Qe.includes(bt-X));gt!==void 0&&(oe=gt,Ae=!0)}else oe++,Ae=!0;Ae&&It(oe,0,"horizontal")}Ae||(ue=Math.min(Ct.length,ue+1),It(ue-1-X,0,"horizontal"))}else if(L===-1){let Ae=!1;if(ue>le+1){if(Qe.length>0){const gt=Ro(ue-1,le,-1).find(bt=>!Qe.includes(bt-X));gt!==void 0&&(ue=gt,Ae=!0)}else ue--,Ae=!0;Ae&&It(ue-X,0,"horizontal")}Ae||(oe=Math.max(X,oe-1),It(oe-X,0,"horizontal"))}else Fl()}Ut({cell:pe.current.cell,range:{x:oe,y:He,width:ue-oe,height:Te-He}},!0,!1,"keyboard-select")},[_t,ql,pe,Ct.length,X,_e,It,Ut]),zi=s.useRef(eo);zi.current=eo;const So=s.useCallback((y,A,L,K)=>{const le=en-(L?0:1);y=xn(y,X,Sn.length-1+X),A=xn(A,0,le);const Z=En==null?void 0:En[0],se=En==null?void 0:En[1];if(y===Z&&A===se)return!1;if(K&&pe.current!==void 0){const oe=[...pe.current.rangeStack];(pe.current.range.width>1||pe.current.range.height>1)&&oe.push(pe.current.range),Dn({...pe,current:{cell:[y,A],range:{x:y,y:A,width:1,height:1},rangeStack:oe}},!0)}else Ut({cell:[y,A],range:{x:y,y:A,width:1,height:1}},!0,!1,"keyboard-nav");return T.current!==void 0&&T.current[0]===y&&T.current[1]===A&&(T.current=void 0),zi.current&&It(y-X,A,"both",0,20),!0},[en,X,Sn.length,En,pe,It,Dn,Ut]),Sr=s.useCallback((y,A)=>{var L,K,le,Z,se;const oe=N.current;W.current;let ue=y;const He=(L=(K=z.current)===null||K===void 0?void 0:K.getValue())!==null&&L!==void 0?L:"",Te=(oe==null||(le=oe.content)===null||le===void 0?void 0:le.kind)===ie.Custom;if((oe==null?void 0:oe.cell)!==void 0&&He.length>0&&oe.content!==void 0&&!Te){const Ae=oe.content;if(Ae.kind===ie.Text)ue={...Ae,data:He,displayData:He};else if(Ae.kind===ie.Number){const gt=Number.parseFloat(He),bt=Number.isNaN(gt)?0:gt;ue={...Ae,data:bt,displayData:bt.toLocaleString()}}else Ae.kind===ie.Uri?ue={...Ae,data:He,displayData:He}:Ae.kind===ie.Markdown&&(ue={...Ae,data:He})}else Te&&(ue=y);if(ue!==void 0&&He.length===0)if(ue.kind===ie.Text&&ue.data!==ue.displayData)ue={...ue,displayData:ue.data};else if(ue.kind===ie.Number){const Ae=ue.data!==void 0?ue.data.toLocaleString():"0";ue.displayData!==Ae&&(ue={...ue,displayData:Ae})}else ue.kind===ie.Uri&&ue.data!==ue.displayData&&(ue={...ue,displayData:ue.data});const et=oe==null?void 0:oe.content,Pt=()=>{if(ue===void 0||et===void 0)return!1;if(ue.kind!==et.kind)return!0;switch(ue.kind){case ie.Text:case ie.Uri:case ie.Markdown:return ue.data!==et.data;case ie.Number:return ue.data!==et.data;case ie.Boolean:return ue.data!==et.data;default:return!0}};(oe==null?void 0:oe.cell)!==void 0&&ue!==void 0&&jn(ue)&&Pt()&&(Fo([{location:oe.cell,value:ue}]),window.requestAnimationFrame(()=>{var Ae;(Ae=sn.current)===null||Ae===void 0||Ae.damage([{cell:oe.cell}])})),(Z=z.current)===null||Z===void 0||Z.clear(),(se=z.current)===null||se===void 0||se.setVisible(!1),S(!1),an(!0),N.current=void 0,x(void 0);const[Dt,Qe]=A;if(pe.current!==void 0&&(Dt!==0||Qe!==0)){const Ae=pe.current.cell[1]===en-1;if(Ae&&Qe===1){ve==null||ve(y,[0,0]);return}const gt=pe.current.cell[0]===Ct.length-1&&y!==void 0;let bt=!0;if(Ae&&Qe===1&&Ue!==void 0){bt=!1;const st=pe.current.cell[0]+Dt,dt=wl(st);Do(dt??st,!1)}if(gt&&Dt===1&&at!==void 0){bt=!1;const st=pe.current.cell[1]+Qe;Yl(st,!1)}if(bt){const st=xn(pe.current.cell[0]+Dt,X,Ct.length-1),dt=xn(pe.current.cell[1]+Qe,0,en-1);So(st,dt,Ae,!1),window.requestAnimationFrame(()=>{var kn;(kn=z.current)===null||kn===void 0||kn.focus()})}}ve==null||ve(y,A)},[an,pe,ve,Fo,en,So,Ct.length,Do,Yl,Ue,at,wl,X]),Cs=s.useMemo(()=>`gdg-overlay-${u0++}`,[]),Mr=s.useCallback(y=>{var A;an();const L=[];for(let se=y.x;se<y.x+y.width;se++)for(let oe=y.y;oe<y.y+y.height;oe++){const ue=me([se-X,oe]);if(!ue.allowOverlay&&ue.kind!==ie.Boolean)continue;let He;if(ue.kind===ie.Custom){var K;const Te=Pn(ue),et=Te==null||(K=Te.provideEditor)===null||K===void 0?void 0:K.call(Te,{...ue,location:[se-X,oe]});if((Te==null?void 0:Te.onDelete)!==void 0)He=Te.onDelete(ue);else if(hu(et)){var le;He=et==null||(le=et.deletedValue)===null||le===void 0?void 0:le.call(et,ue)}}else if(jn(ue)&&ue.allowOverlay||ue.kind===ie.Boolean){var Z;const Te=Pn(ue);He=Te==null||(Z=Te.onDelete)===null||Z===void 0?void 0:Z.call(Te,ue)}He!==void 0&&!Ao(He)&&jn(He)&&L.push({location:[se,oe],value:He})}Fo(L),(A=sn.current)===null||A===void 0||A.damage(L.map(se=>({cell:se.location})))},[an,me,Pn,Fo,X]),bs=k!==void 0,{onKeyDown:Zo}=kc({state:jl,keybindings:ye,overlayOpen:bs,columnSelect:ot,rowSelect:Mt,rangeSelect:Pe,editOnType:je,trapFocus:Al,showTrailingBlankRow:$e,columnsInLength:ee.length,rowGroupingNavBehavior:Ri,mapper:pl,onKeyDownIn:be,onSelectionCleared:rt,onCellActivated:Ce,onDelete:hr,getCellContent:me,setSelectedColumns:gn,setSelectedRows:yn,setShowSearchInner:bn,searchInputRef:M,adjustSelection:ps,updateSelectedCell:So,deleteRange:Mr,fillDown:us,fillRight:ss,appendRow:Do,getCustomNewRowTargetColumn:wl,scrollToRef:Kl}),[ys,Rr]=s.useState(!1),Ar=s.useRef(cu(y=>{Rr(y)},5)),{onGhostInput:Es,onGhostCompositionStart:ks,onGhostCompositionEnd:xs,onGhostKeyDown:Fs,onGhostKeyUp:Ds,onGhostFocus:Ss,onGhostBlur:Ms}=n0({state:jl,onKeyDown:Zo,onFinishEditing:Sr,onKeyUpIn:Ve,onCellActivated:Ce,setIsFocused:Rr}),Rs=s.useCallback((y,A)=>{const L=y.location[0]-X;if(y.kind==="header"&&(ge==null||ge(L,{...y,preventDefault:A})),y.kind===An){if(L<0)return;Re==null||Re(L,{...y,preventDefault:A})}if(y.kind==="cell"){const[K,le]=y.location;H==null||H([L,le],{...y,preventDefault:A}),Fa(pe,y.location)||So(K,le,!1,!1)}},[pe,H,Re,ge,X,So]),{onCopy:Br,onPasteInternal:Ir}=zc({state:jl,keybindings:ye,getCellsForSelection:_t,coercePasteValue:Q,onPaste:Le,copyHeaders:Bt,columnsIn:ee,onDelete:hr,deleteRange:Mr,safeWindow:J}),As=s.useCallback((y,A)=>{if(fe!==void 0){X!==0&&(y=y.map(le=>[le[0]-X,le[1]])),fe(y,A);return}if(y.length===0||A===-1)return;const[L,K]=y[A];T.current!==void 0&&T.current[0]===L&&T.current[1]===K||(T.current=[L,K],So(L,K,!1,!1))},[fe,X,So]),[Zl,Jl]=(C=mt==null||(p=mt.current)===null||p===void 0?void 0:p.cell)!==null&&C!==void 0?C:[];s.useLayoutEffect(()=>{var y,A;zi.current&&!Wl.current&&Zl!==void 0&&Jl!==void 0&&(Zl!==((y=Fn.current)===null||y===void 0||(y=y.current)===null||y===void 0?void 0:y.cell[0])||Jl!==((A=Fn.current)===null||A===void 0||(A=A.current)===null||A===void 0?void 0:A.cell[1]))&&Kl.current(Zl,Jl),Wl.current=!1},[Zl,Jl]);const Hr=pe.current!==void 0&&(pe.current.cell[0]>=Ct.length||pe.current.cell[1]>=en);s.useLayoutEffect(()=>{Hr&&Dn($i,!1)},[Hr,Dn]);const Bs=s.useMemo(()=>$e===!0&&(it==null?void 0:it.tint)===!0?tt.fromSingleSelection(en-1):tt.empty(),[en,$e,it==null?void 0:it.tint]),Is=s.useCallback(y=>{var A;return typeof qt=="boolean"?qt:(A=qt==null?void 0:qt(y-X))!==null&&A!==void 0?A:!0},[X,qt]),Hs=s.useMemo(()=>{if(Ai===void 0||B.current===null)return null;const{bounds:y,group:A}=Ai,L=B.current.getBoundingClientRect();return s.createElement(hc,{bounds:y,group:A,canvasBounds:L,onClose:()=>Bi(void 0),onFinish:K=>{Bi(void 0),De==null||De(A,K)}})},[De,Ai]),Ts=Math.min(Ct.length,Rt+X);s.useImperativeHandle(t,()=>({appendRow:(y,A)=>Do(y+X,A),appendColumn:(y,A)=>Yl(y,A),updateCells:y=>{var A;return X!==0&&(y=y.map(L=>({cell:[L.cell[0]+X,L.cell[1]]}))),(A=sn.current)===null||A===void 0?void 0:A.damage(y)},getBounds:(y,A)=>{var L;if(!((B==null?void 0:B.current)===null||(Ft==null?void 0:Ft.current)===null)){if(y===void 0&&A===void 0){const K=B.current.getBoundingClientRect(),le=K.width/Ft.current.clientWidth;return{x:K.x-Ft.current.scrollLeft*le,y:K.y-Ft.current.scrollTop*le,width:Ft.current.scrollWidth*le,height:Ft.current.scrollHeight*le}}return(L=sn.current)===null||L===void 0?void 0:L.getBounds((y??0)+X,A)}},focus:()=>{var y;return(y=sn.current)===null||y===void 0?void 0:y.focus()},emit:async y=>{switch(y){case"delete":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Zo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Br(void 0,!0);break;case"paste":await Ir();break}},scrollTo:It,remeasureColumns:y=>{for(const A of y)Fr(A+X)},getMouseArgsForPosition:(y,A,L)=>{if((sn==null?void 0:sn.current)===null)return;const K=sn.current.getMouseArgsForPosition(y,A,L);if(K!==void 0)return{...K,location:[K.location[0]-X,K.location[1]]}}}),[Do,Yl,Fr,Ft,Br,Zo,Ir,X,It]);const[Tr,zr]=En??[],zs=s.useCallback(y=>{const[A,L]=y;if(L===-1){ot!=="none"&&(gn(tt.fromSingleSelection(A),void 0,!1),an());return}Tr===A&&zr===L||(Ut({cell:y,range:{x:A,y:L,width:1,height:1}},!0,!1,"keyboard-nav"),It(A,L))},[ot,an,It,Tr,zr,Ut,gn]),Ps=s.useCallback(()=>{Ar.current(!0),pe.current===void 0&&pe.columns.length===0&&pe.rows.length===0&&R===void 0&&Ut({cell:[X,Nl],range:{x:X,y:Nl,width:1,height:1}},!0,!1,"keyboard-select")},[Nl,pe,R,X,Ut]),Ls=s.useCallback(()=>{Ar.current(!1)},[]),[Os,Ws]=s.useMemo(()=>{var y;let A;const L=(y=At==null?void 0:At.scrollbarWidthOverride)!==null&&y!==void 0?y:Yi(),K=_e+($e?1:0);if(typeof Ee=="number")A=vl+K*Ee;else{let Z=0;const se=Math.min(K,10);for(let oe=0;oe<se;oe++)Z+=Ee(oe);Z=Math.floor(Z/se),A=vl+K*Z}A+=L;const le=Ct.reduce((Z,se)=>se.width+Z,0)+L;return[`${Math.min(1e5,le)}px`,`${Math.min(1e5,A)}px`]},[Ct,At==null?void 0:At.scrollbarWidthOverride,Ee,_e,$e,vl]),Ns=s.useMemo(()=>bu(un),[un]);return s.createElement(or.Provider,{value:un},s.createElement(Bc,{style:Ns,className:re,inWidth:Y??Os,inHeight:V??Ws},s.createElement(dc,{fillHandle:Ml,drawFocusRing:Tl,experimental:At,fixedShadowX:zo,fixedShadowY:Po,getRowThemeOverride:P,headerIcons:Lo,imageWindowLoader:Co,initialSize:Qn,isDraggable:mi,onDragLeave:Rl,onRowMoved:bo,overscrollX:Oe,overscrollY:lt,preventDiagonalScrolling:_n,rightElement:pi,rightElementProps:Ci,smoothScrollX:Bl,smoothScrollY:Oo,className:re,enableGroups:mr,onCanvasFocused:Ps,onCanvasBlur:Ls,canvasRef:B,onContextMenu:Rs,theme:un,cellXOffset:es,cellYOffset:Nl,accessibilityHeight:xo.height,onDragEnd:ms,columns:Ct,nonGrowWidth:vr,drawHeader:Zu,onColumnProposeMove:hs,drawCell:Ju,disabledRows:Bs,freezeColumns:Ts,lockColumns:X,firstColAccessible:X===0,getCellContent:Xn,minColumnWidth:Gn,maxColumnWidth:hl,searchInputRef:M,showSearch:zn,onSearchClose:fn,highlightRegions:ts,getCellsForSelection:_t,getGroupDetails:Fi,headerHeight:Se,isFocused:ys,groupHeaderHeight:mr?we:0,groupLevels:Vo,groupHeaderHeights:wr,freezeTrailingRows:ft+($e&&(it==null?void 0:it.sticky)===!0?1:0),hasAppendRow:$e,onColumnResize:io,onColumnResizeEnd:Ei,onColumnResizeStart:ki,onCellFocused:zs,onColumnMoved:gs,onDragStart:vs,onHeaderMenuClick:ds,onHeaderIndicatorClick:cs,onItemHovered:Ti,isFilling:(R==null?void 0:R.fillHandle)===!0,onMouseMove:rs,onKeyDown:Zo,onKeyUp:Ve,onMouseDown:ls,onMouseUp:is,onDragOverCell:Sl,onDrop:Jn,onSearchResultsChanged:As,onVisibleRegionChanged:fs,clientSize:xi,rowHeight:Ee,searchResults:Fe,searchValue:Xe,onSearchValueChange:ze,rows:en,scrollRef:Ft,selection:pe,translateX:xo.tx,translateY:xo.ty,verticalBorder:Is,gridRef:sn,getCellRenderer:Pn,resizeIndicator:ul}),Hs,k!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(r0,{...k,validateCell:ko,bloom:ae,id:Cs,getCellRenderer:Pn,className:(At==null?void 0:At.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:il,imageEditorOverride:G,portalElementRef:Go,onFinishEditing:Sr,markdownDivCreateNode:_,isOutsideClick:No,customEventTarget:At==null?void 0:At.eventTarget,isGhostMode:E}))),(y=>{const A=(y=Go==null?void 0:Go.current)!==null&&y!==void 0?y:document.getElementById("portal");return A===null?null:du.createPortal(s.createElement(t0,{ref:z,onInput:Es,onCompositionStart:ks,onCompositionEnd:xs,onKeyDown:Fs,onKeyUp:Ds,onFocus:Ss,onBlur:Ms}),A)})())},d0=s.forwardRef(a0);function ru(e){var t,n;const{cell:o,posX:l,posY:i,bounds:u,theme:r}=e,{width:a,height:d,x:c,y:h}=u,v=(t=o.maxSize)!==null&&t!==void 0?t:r.checkboxMaxSize,m=Math.floor(u.y+d/2),f=mu(v,d,r.cellVerticalPadding),w=vu((n=o.contentAlign)!==null&&n!==void 0?n:"center",c,a,r.cellHorizontalPadding,f),C=gu(w,m,f),p=wu(c+l,h+i,C);return _i(o)&&p}const c0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"false"},kind:ie.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>{var t,n;return f0(e,e.cell.data,_i(e.cell),(t=e.cell.maxSize)!==null&&t!==void 0?t:e.theme.checkboxMaxSize,(n=e.cell.hoverEffectIntensity)!==null&&n!==void 0?n:.35)},onDelete:e=>({...e,data:!1}),onSelect:e=>{ru(e)&&e.preventDefault()},onClick:e=>{if(ru(e))return{...e.cell,data:dr(e.cell.data)}},onPaste:(e,t)=>{let n=ii;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Qi),n===t.data?void 0:{...t,data:n}}};function f0(e,t,n,o,l){if(!n&&t===ii)return;const{ctx:i,hoverAmount:u,theme:r,rect:a,highlighted:d,hoverX:c,hoverY:h,cell:{contentAlign:v}}=e,{x:m,y:f,width:w,height:C}=a;let p=!1;if(l>0){let g=n?1-l+l*u:.4;if(t===ii&&(g*=u),g===0)return;g<1&&(p=!0,i.globalAlpha=g)}ai(i,r,t,m,f,w,C,d,c,h,o,v),p&&(i.globalAlpha=1)}const h0=nn("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),g0=e=>{const t=jt.c(9),{bubbles:n}=e,{isGhostMode:o}=s.useContext(ll);let l;if(t[0]!==n||t[1]!==o){let i;t[3]!==n?(i=n.map(v0),t[3]=n,t[4]=i):i=t[4];let u;if(t[5]!==o){const r=!o;let a;t[7]!==r?(a={className:"gdg-input",autoFocus:r},t[7]=r,t[8]=a):a=t[8],u=s.createElement("textarea",a),t[5]=o,t[6]=u}else u=t[6];l=s.createElement(h0,null,i,u),t[0]=n,t[1]=o,t[2]=l}else l=t[2];return l};function v0(e,t){return s.createElement("div",{key:t,className:"boe-bubble"},e)}const m0={getAccessibilityString:e=>pu(e.data),kind:ie.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((l,i)=>e.measureText(i).width+l+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>w0(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(g0,{bubbles:t.data})},onPaste:()=>{}};function w0(e,t){const{rect:n,theme:o,ctx:l,highlighted:i}=e,{x:u,y:r,width:a,height:d}=n;let c=u+o.cellHorizontalPadding;const h=[];for(const m of t){if(c>u+a)break;const f=Ho(m,l,o.baseFontFull).width;h.push({x:c,width:f}),c+=f+o.bubblePadding*2+o.bubbleMargin}l.beginPath();for(const m of h){var v;Wn(l,m.x,r+(d-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,(v=o.roundingRadius)!==null&&v!==void 0?v:o.bubbleHeight/2)}l.fillStyle=i?o.bgBubbleSelected:o.bgBubble,l.fill();for(const[m,f]of h.entries())l.beginPath(),l.fillStyle=o.textBubble,l.fillText(t[m],f.x+o.bubblePadding,r+d/2+wn(l,o))}const p0=nn("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),C0=e=>{const{drilldowns:t}=e;return s.createElement(p0,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},b0={getAccessibilityString:e=>pu(e.data.map(t=>t.text)),kind:ie.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,l)=>e.measureText(l.text).width+o+n.bubblePadding*2+n.bubbleMargin+(l.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>E0(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(C0,{drilldowns:t.data})},onPaste:()=>{}},Gi={};function y0(e,t,n,o){const l=Math.ceil(window.devicePixelRatio),i=5,u=n-i*2,r=4,a=n*l,d=o+i,c=o*3,h=(c+i*2)*l,v=`${e},${t},${l},${n}`;if(Gi[v]!==void 0)return{el:Gi[v],height:a,width:h,middleWidth:r*l,sideWidth:d*l,padding:i*l,dpr:l};const m=document.createElement("canvas"),f=m.getContext("2d");return f===null?null:(m.width=h,m.height=a,f.scale(l,l),Gi[v]=m,f.beginPath(),Wn(f,i,i,c,u,o),f.shadowColor="rgba(24, 25, 34, 0.4)",f.shadowBlur=1,f.fillStyle=e,f.fill(),f.shadowColor="rgba(24, 25, 34, 0.3)",f.shadowOffsetY=1,f.shadowBlur=5,f.fillStyle=e,f.fill(),f.shadowOffsetY=0,f.shadowBlur=0,f.shadowBlur=0,f.beginPath(),Wn(f,i+.5,i+.5,c,u,o),f.strokeStyle=t,f.lineWidth=1,f.stroke(),{el:m,height:a,width:h,sideWidth:d*l,middleWidth:o*l,padding:i*l,dpr:l})}function E0(e,t){var n;const{rect:o,theme:l,ctx:i,imageLoader:u,col:r,row:a}=e,{x:d,width:c}=o,h=l.baseFontFull,v=Iu(i,h),m=Math.min(o.height,Math.max(16,Math.ceil(v*l.lineHeight)*2)),f=Math.floor(o.y+(o.height-m)/2),w=m-10,C=l.bubblePadding,p=l.bubbleMargin;let g=d+l.cellHorizontalPadding;const b=(n=l.roundingRadius)!==null&&n!==void 0?n:6,k=y0(l.bgCell,l.drilldownBorder,m,b),x=[];for(const B of t){if(g>d+c)break;const F=Ho(B.text,i,h).width;let D=0;B.img!==void 0&&u.loadOrGetImage(B.img,r,a)!==void 0&&(D=w-8+4);const I=F+D+C*2;x.push({x:g,width:I}),g+=I+p}if(k!==null){const{el:B,height:R,middleWidth:F,sideWidth:D,width:I,dpr:T,padding:z}=k,E=D/T,S=z/T;for(const W of x){const N=Math.floor(W.x),J=Math.floor(W.width),G=J-(E-S)*2;i.imageSmoothingEnabled=!1,i.drawImage(B,0,0,D,R,N-S,f,E,m),G>0&&i.drawImage(B,D,0,F,R,N+(E-S),f,G,m),i.drawImage(B,I-D,0,D,R,N+J-(E-S),f,E,m),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[B,R]of x.entries()){const F=t[B];let D=R.x+C;if(F.img!==void 0){const I=u.loadOrGetImage(F.img,r,a);if(I!==void 0){var M;const T=w-8;let z=0,E=0,S=I.width,W=I.height;S>W?(z+=(S-W)/2,S=W):W>S&&(E+=(W-S)/2,W=S),i.beginPath(),Wn(i,D,f+m/2-T/2,T,T,(M=l.roundingRadius)!==null&&M!==void 0?M:3),i.save(),i.clip(),i.drawImage(I,z,E,S,W,D,f+m/2-T/2,T,T),i.restore(),D+=T+4}}i.beginPath(),i.fillStyle=l.textBubble,i.fillText(F.text,D,f+m/2+wn(i,l))}}const k0={getAccessibilityString:e=>e.data.join(", "),kind:ie.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>{var t,n,o;return x0(e,(t=e.cell.displayData)!==null&&t!==void 0?t:e.cell.data,(n=(o=e.cell.rounding)!==null&&o!==void 0?o:e.theme.roundingRadius)!==null&&n!==void 0?n:4,e.cell.contentAlign)},measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,l=o??ia;return s.createElement(l,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(l=>{try{return new URL(l),l}catch{return}}).filter(l=>l!==void 0);if(!(o.length===t.data.length&&o.every((l,i)=>l===t.data[i])))return{...t,data:o}}},Xi=4;function x0(e,t,n,o){const{rect:l,col:i,row:u,theme:r,ctx:a,imageLoader:d}=e,{x:c,y:h,height:v,width:m}=l,f=v-r.cellVerticalPadding*2,w=[];let C=0;for(let g=0;g<t.length;g++){const b=t[g];if(b.length===0)continue;const k=d.loadOrGetImage(b,i,u);if(k!==void 0){w[g]=k;const x=k.width*(f/k.height);C+=x+Xi}}if(C===0)return;C-=Xi;let p=c+r.cellHorizontalPadding;o==="right"?p=Math.floor(c+m-r.cellHorizontalPadding-C):o==="center"&&(p=Math.floor(c+m/2-C/2));for(const g of w){if(g===void 0)continue;const b=g.width*(f/g.height);n>0&&(a.beginPath(),Wn(a,p,h+r.cellVerticalPadding,b,f,n),a.save(),a.clip()),a.drawImage(g,p,h+r.cellVerticalPadding,b,f),n>0&&a.restore(),p+=b+Xi}}function F0(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const D0={getAccessibilityString:()=>"",kind:ie.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{var t,n;const{cell:o,col:l,row:i,ctx:u,rect:r,theme:a}=e;if(o.skeletonWidth===void 0||o.skeletonWidth===0)return;let d=o.skeletonWidth;o.skeletonWidthVariability!==void 0&&o.skeletonWidthVariability>0&&(d+=Math.round(F0(l,i)*o.skeletonWidthVariability));const c=a.cellHorizontalPadding;d+c*2>=r.width&&(d=r.width-c*2-1);const h=(t=o.skeletonHeight)!==null&&t!==void 0?t:Math.min(18,r.height-2*a.cellVerticalPadding);Wn(u,r.x+c,r.y+(r.height-h)/2,d,h,(n=a.roundingRadius)!==null&&n!==void 0?n:3),u.fillStyle=mo(a.textDark,.1),u.fill()},onPaste:()=>{}},S0=()=>e=>e.targetWidth,uu=nn("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[S0(),"px"]}}),M0=e=>{const t=jt.c(52),{value:n,onChange:o,forceEditMode:l,createNode:i,targetRect:u,onFinish:r,validatedSelection:a}=e,{isGhostMode:d}=s.useContext(ll),c=n.data,h=n.readonly===!0,[v,m]=s.useState(c===""||l);let f;t[0]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{m(R0)},t[0]=f):f=t[0];const w=f,C=c?"gdg-ml-6":"";if(v){let g;if(t[1]!==C||t[2]!==d||t[3]!==c||t[4]!==o||t[5]!==r||t[6]!==u.width||t[7]!==a||t[8]!==n){const b=u.width-20;let k;t[10]!==b?(k={targetWidth:b},t[10]=b,t[11]=k):k=t[11];let x;if(t[12]!==d||t[13]!==c||t[14]!==o||t[15]!==a){const B=!d;let R;t[17]!==c||t[18]!==o||t[19]!==B||t[20]!==a?(R={autoFocus:B,highlight:!1,validatedSelection:a,value:c,onKeyDown:A0,onChange:o},t[17]=c,t[18]=o,t[19]=B,t[20]=a,t[21]=R):R=t[21],x=s.createElement(lr,R),t[12]=d,t[13]=c,t[14]=o,t[15]=a,t[16]=x}else x=t[16];let M;if(t[22]!==C||t[23]!==r||t[24]!==n){const B=`gdg-edit-icon gdg-checkmark-hover ${C}`;let R;t[26]!==r||t[27]!==n?(R=()=>r(n),t[26]=r,t[27]=n,t[28]=R):R=t[28];let F;t[29]!==B||t[30]!==R?(F={className:B,onClick:R},t[29]=B,t[30]=R,t[31]=F):F=t[31];let D;t[32]===Symbol.for("react.memo_cache_sentinel")?(D=s.createElement(Qs,null),t[32]=D):D=t[32],M=s.createElement("div",F,D),t[22]=C,t[23]=r,t[24]=n,t[25]=M}else M=t[25];g=s.createElement(uu,k,x,M),t[1]=C,t[2]=d,t[3]=c,t[4]=o,t[5]=r,t[6]=u.width,t[7]=a,t[8]=n,t[9]=g}else g=t[9];return g}let p;if(t[33]!==C||t[34]!==i||t[35]!==d||t[36]!==c||t[37]!==h||t[38]!==u.width){let g;t[40]!==u.width?(g={targetWidth:u.width},t[40]=u.width,t[41]=g):g=t[41];let b;t[42]!==i||t[43]!==c?(b=s.createElement(ua,{contents:c,createNode:i}),t[42]=i,t[43]=c,t[44]=b):b=t[44];let k;t[45]!==C||t[46]!==h?(k=!h&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${C}`,onClick:w},s.createElement(tr,null))),t[45]=C,t[46]=h,t[47]=k):k=t[47];let x;if(t[48]!==d){const M=!d;let B;t[50]!==M?(B={className:"gdg-md-edit-textarea gdg-input",autoFocus:M},t[50]=M,t[51]=B):B=t[51],x=s.createElement("textarea",B),t[48]=d,t[49]=x}else x=t[49];p=s.createElement(uu,g,b,k,x),t[33]=C,t[34]=i,t[35]=d,t[36]=c,t[37]=h,t[38]=u.width,t[39]=p}else p=t[39];return p};function R0(e){return!e}function A0(e){e.key==="Enter"&&e.stopPropagation()}const B0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""},kind:ie.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:fi,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Vn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:l,markdownDivCreateNode:i,forceEditMode:u,validatedSelection:r}=e;return s.createElement(M0,{onFinish:l,targetRect:o,value:n,validatedSelection:r,onChange:a=>t({...n,data:a.target.value}),forceEditMode:u,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},I0={getAccessibilityString:e=>e.row.toString(),kind:$t.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:H0,measure:()=>44,draw:e=>z0(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:l}=e;if(n.disabled===!0)return;const{width:i,height:u}=t,r=n.drawHandle?7+(i-7)/2:i/2,a=u/2;if(Math.abs(o-r)<=10&&Math.abs(l-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function H0(e,t){const{ctx:n,theme:o}=e,l=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==l&&(n.font=l,i.font=l),i.deprep=T0,n.textAlign="center",i}function T0(e){const{ctx:t}=e;t.textAlign="start"}function z0(e,t,n,o,l,i,u){if(u){const{ctx:C,rect:p,theme:g}=e,{x:b,y:k,width:x,height:M}=p,B=o==="checkbox"?"checkbox-visible":o;if(B!=="number"&&(C.globalAlpha=n?1:.4,ai(C,g,n,l?b+7:b,k,l?x-7:x,M,!1,-20,-20,g.checkboxMaxSize,"center",i,!0),C.globalAlpha=1),B==="number"||B==="both"&&!n){const R=t.toString(),F=g.markerFontFull,D=b+x/2;C.fillStyle="#cccccc",C.font=F,C.fillText(R,D,k+M/2+wn(C,F))}if(l){C.globalAlpha=.4,C.beginPath();for(const R of[3,6])for(const F of[-5,-1,3])C.rect(b+R,k+M/2+F,2,2);C.fillStyle="#cccccc",C.fill(),C.beginPath(),C.globalAlpha=1}return}const{ctx:r,rect:a,hoverAmount:d,theme:c}=e,{x:h,y:v,width:m,height:f}=a,w=n?1:o==="checkbox-visible"?.6+.4*d:d;if(o!=="number"&&w>0){r.globalAlpha=w;const C=7*(n?d:1);if(ai(r,c,n,l?h+C:h,v,l?m-C:m,f,!0,void 0,void 0,c.checkboxMaxSize,"center",i,u),l){r.globalAlpha=d,r.beginPath();for(const p of[3,6])for(const g of[-5,-1,3])r.rect(h+p,v+f/2+g,2,2);r.fillStyle=c.textLight,r.fill(),r.beginPath()}r.globalAlpha=1}if(o==="number"||o==="both"&&!n){const C=t.toString(),p=c.markerFontFull,g=h+m/2;o==="both"&&d!==0&&(r.globalAlpha=1-d),r.fillStyle=c.textLight,r.font=p,r.fillText(C,g,v+f/2+wn(r,p)),d!==0&&(r.globalAlpha=1)}}const P0={getAccessibilityString:()=>"",kind:$t.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>L0(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function L0(e,t,n){const{ctx:o,rect:l,hoverAmount:i,theme:u,spriteManager:r}=e,{x:a,y:d,width:c,height:h}=l;o.beginPath(),o.globalAlpha=i,o.rect(a+1,d+1,c,h-2),o.fillStyle=u.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const v=t!=="";let m=0;if(n!==void 0){const w=h-8,C=a+8/2,p=d+8/2;r.drawSprite(n,"normal",o,C,p,w,u,v?1:i),m=w}else{m=24;const f=12,w=v?f:i*f,C=v?0:(1-i)*f*.5,p=u.cellHorizontalPadding+4;w>0&&(o.moveTo(a+p+C,d+h/2),o.lineTo(a+p+C+w,d+h/2),o.moveTo(a+p+C+w*.5,d+h/2-w*.5),o.lineTo(a+p+C+w*.5,d+h/2+w*.5),o.lineWidth=2,o.strokeStyle=u.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=u.textMedium,o.fillText(t,m+a+u.cellHorizontalPadding+.5,d+h/2+wn(o,u)),o.beginPath()}function ju(e,t,n,o,l,i,u){var r,a,d;e.textBaseline="alphabetic";const c=O0(e,l,o,t,(r=n==null?void 0:n.fullSize)!==null&&r!==void 0?r:!1);e.beginPath(),Wn(e,c.x,c.y,c.width,c.height,(a=t.roundingRadius)!==null&&a!==void 0?a:4),e.globalAlpha=i,e.fillStyle=(d=n==null?void 0:n.bgColor)!==null&&d!==void 0?d:mo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",u==null||u("text")}function O0(e,t,n,o,l){const i=o.cellHorizontalPadding,u=o.cellVerticalPadding;if(l)return{x:t.x+i/2,y:t.y+u/2+1,width:t.width-i,height:t.height-u-1};const r=Ho(n,e,o.baseFontFull,"alphabetic"),a=t.height-u,d=Math.min(a,r.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-d)/2+1,width:r.width+i*3,height:d-1}}const W0=s.lazy(async()=>await au(()=>import("./number-overlay-editor-Dbz3weqL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),N0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""},kind:ie.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:fi,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:l,rect:i,overrideCursor:u}=e,{hoverEffect:r,displayData:a,hoverEffectTheme:d}=n;r===!0&&t>0&&ju(o,l,d,a,i,t,u),Vn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,onFinishedEditing:o,value:l,validatedSelection:i}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(W0,{highlight:t,disabled:l.readonly===!0,value:l.data,fixedDecimals:l.fixedDecimals,allowNegative:l.allowNegative,thousandSeparator:l.thousandSeparator,decimalSeparator:l.decimalSeparator,validatedSelection:i,onChange:u=>{var r;return n({...l,data:Number.isNaN((r=u.floatValue)!==null&&r!==void 0?r:0)?0:u.floatValue})},onKeyDown:u=>{u.key==="Enter"&&!u.shiftKey?(u.preventDefault(),o(l,[0,1])):u.key==="Tab"?(u.preventDefault(),o(l,[u.shiftKey?-1:1,0])):u.key==="Escape"&&(u.preventDefault(),o(void 0,[0,0]))}}))},onPaste:(e,t,n)=>{var o;const l=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(l)||t.data===l))return{...t,data:l,displayData:(o=n.formattedString)!==null&&o!==void 0?o:t.displayData}}},$0={getAccessibilityString:()=>"",measure:()=>108,kind:ie.Protected,needsHover:!1,needsHoverPosition:!1,draw:G0,onPaste:()=>{}};function G0(e){const{ctx:t,theme:n,rect:o}=e,{x:l,y:i,height:u}=o;t.beginPath();const r=2.5;let a=l+n.cellHorizontalPadding+r;const d=i+u/2,c=Math.cos(Nr(30))*r,h=Math.sin(Nr(30))*r;for(let v=0;v<12;v++)t.moveTo(a,d-r),t.lineTo(a,d+r),t.moveTo(a+c,d-h),t.lineTo(a-c,d+h),t.moveTo(a-c,d-h),t.lineTo(a+c,d+h),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const X0={getAccessibilityString:e=>{var t;return(t=e.rowId)!==null&&t!==void 0?t:""},kind:$t.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>{var o;return Ho((o=t.rowId)!==null&&o!==void 0?o:"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2},draw:e=>{const{ctx:t,rect:n,cell:o,theme:l}=e,i=o.rowId;if(!i)return;t.fillStyle=l.textDark,t.font=l.baseFontStyle,t.textAlign="left";const u=n.x+l.cellHorizontalPadding,r=n.y+n.height/2;t.fillText(i,u,r+wn(t,l))},onClick:()=>{},onPaste:()=>{}},K0={getAccessibilityString:e=>{var t;return(t=e.rowId)!==null&&t!==void 0?t:""},kind:$t.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:Y0,measure:()=>80,draw:e=>U0(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function Y0(e,t){const{ctx:n}=e,o="12px sans-serif",l=t??{};return(l==null?void 0:l.font)!==o&&(n.font=o,l.font=o),l.deprep=V0,n.textAlign="left",l}function V0(e){const{ctx:t}=e;t.textAlign="start"}function U0(e,t){if(!t)return;const{ctx:n,rect:o,theme:l}=e,{x:i,y:u,height:r}=o;n.fillStyle=l.textDark,n.font="12px sans-serif";const a=i+8,d=u+r/2;n.fillText(t,a,d+wn(n,n.font))}const j0={getAccessibilityString:e=>{var t;return(t=e.status)!==null&&t!==void 0?t:""},kind:$t.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:q0,measure:()=>40,draw:e=>J0(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function q0(e,t){const{ctx:n}=e,o="bold 14px sans-serif",l=t??{};return(l==null?void 0:l.font)!==o&&(n.font=o,l.font=o),l.deprep=Z0,n.textAlign="center",l}function Z0(e){const{ctx:t}=e;t.textAlign="start"}function J0(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:l,y:i,width:u,height:r}=o,a={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=a[t],n.font="bold 14px sans-serif";const d=l+u/2,c=i+r/2;n.fillText(t,d,c+wn(n,n.font))}const Q0={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""},kind:ie.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:fi,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:l,rect:i,theme:u,overrideCursor:r}=e,{displayData:a,contentAlign:d,hoverEffect:c,allowWrapping:h,hoverEffectTheme:v}=t;c===!0&&n>0&&ju(l,u,v,a,i,n,r),Vn(e,a,d,h,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let l=0;for(const i of o)l=Math.max(l,e.measureText(i).width);return l+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:l,validatedSelection:i}=t;return s.createElement(lr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:l.readonly!==!0,disabled:l.readonly===!0,altNewline:!0,value:l.data,validatedSelection:i,onChange:u=>o({...l,data:u.target.value})})}}),onPaste:(e,t,n)=>{var o;return e===t.data?void 0:{...t,data:e,displayData:(o=n.formattedString)!==null&&o!==void 0?o:t.displayData}}},_0=nn("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),ef=e=>{const t=jt.c(27),{uri:n,onChange:o,forceEditMode:l,readonly:i,validatedSelection:u,preview:r}=e,{isGhostMode:a}=s.useContext(ll),[d,c]=s.useState(!i&&(n===""||l));let h;t[0]===Symbol.for("react.memo_cache_sentinel")?(h=()=>{c(!0)},t[0]=h):h=t[0];const v=h;if(d){let f;if(t[1]!==a||t[2]!==o||t[3]!==n||t[4]!==u){const w=!a;let C;t[6]!==o||t[7]!==w||t[8]!==n||t[9]!==u?(C={validatedSelection:u,highlight:!0,autoFocus:w,value:n,onChange:o},t[6]=o,t[7]=w,t[8]=n,t[9]=u,t[10]=C):C=t[10],f=s.createElement(lr,C),t[1]=a,t[2]=o,t[3]=n,t[4]=u,t[5]=f}else f=t[5];return f}let m;if(t[11]!==a||t[12]!==r||t[13]!==i||t[14]!==n){let f;if(t[16]!==r||t[17]!==n){let p;t[19]!==n?(p={className:"gdg-link-area",href:n,target:"_blank",rel:"noopener noreferrer"},t[19]=n,t[20]=p):p=t[20],f=s.createElement("a",p,r),t[16]=r,t[17]=n,t[18]=f}else f=t[18];let w;t[21]!==i?(w=!i&&s.createElement("div",{className:"gdg-edit-icon",onClick:v},s.createElement(tr,null)),t[21]=i,t[22]=w):w=t[22];let C;if(t[23]!==a){const p=!a;let g;t[25]!==p?(g={className:"gdg-input",autoFocus:p},t[25]=p,t[26]=g):g=t[26],C=s.createElement("textarea",g),t[23]=a,t[24]=C}else C=t[24];m=s.createElement(_0,null,f,w,C),t[11]=a,t[12]=r,t[13]=i,t[14]=n,t[15]=m}else m=t[15];return m};function qu(e,t,n,o){let l=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,u=e.width,r=e.actualBoundingBoxAscent;return o==="right"?l=t.width-u-n.cellHorizontalPadding:o==="center"&&(l=t.width/2-u/2),{x:l,y:i,width:u,height:r}}function su(e){var t;const{cell:n,bounds:o,posX:l,posY:i,theme:u}=e,r=(t=n.displayData)!==null&&t!==void 0?t:n.data;if(n.hoverEffect!==!0||n.onClickUri===void 0)return!1;const a=Au(r,u.baseFontFull);if(a===void 0)return!1;const d=qu(a,o,u,n.contentAlign);return go({x:d.x-4,y:d.y-4,width:d.width+8,height:d.height+8},l,i)}const tf={getAccessibilityString:e=>{var t,n;return(t=(n=e.data)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:""},kind:ie.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:fi,draw:e=>{var t;const{cell:n,theme:o,overrideCursor:l,hoverX:i,hoverY:u,rect:r,ctx:a}=e,d=(t=n.displayData)!==null&&t!==void 0?t:n.data,c=n.hoverEffect===!0;if(l!==void 0&&c&&i!==void 0&&u!==void 0){const h=Ho(d,a,o.baseFontFull),v=qu(h,r,o,n.contentAlign),{x:m,y:f,width:w,height:C}=v;if(i>=m-4&&i<=m-4+w+8&&u>=f-4&&u<=f-4+C+8){const p=wn(a,o.baseFontFull);l("pointer");const g=5,b=f-p;a.beginPath(),a.moveTo(r.x+m,Math.floor(r.y+b+C+g)+.5),a.lineTo(r.x+m+w,Math.floor(r.y+b+C+g)+.5),a.strokeStyle=o.linkColor,a.stroke(),a.save(),a.fillStyle=e.cellFillColor,Vn({...e,rect:{...r,x:r.x-1}},d,n.contentAlign),Vn({...e,rect:{...r,x:r.x-2}},d,n.contentAlign),Vn({...e,rect:{...r,x:r.x+1}},d,n.contentAlign),Vn({...e,rect:{...r,x:r.x+2}},d,n.contentAlign),a.restore()}}a.fillStyle=c?o.linkColor:o.textDark,Vn(e,d,n.contentAlign)},onSelect:e=>{su(e)&&e.preventDefault()},onClick:e=>{const{cell:t}=e;if(su(e)){var o;(o=t.onClickUri)===null||o===void 0||o.call(t,e)}},measure:(e,t,n)=>{var o;return e.measureText((o=t.displayData)!==null&&o!==void 0?o:t.data).width+n.cellHorizontalPadding*2},onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{var n;const{onChange:o,value:l,forceEditMode:i,validatedSelection:u}=t;return s.createElement(ef,{forceEditMode:l.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:l.data,preview:(n=l.displayData)!==null&&n!==void 0?n:l.data,validatedSelection:u,readonly:l.readonly===!0,onChange:r=>o({...l,data:r.target.value})})},onPaste:(e,t,n)=>{var o;return e===t.data?void 0:{...t,data:e,displayData:(o=n.formattedString)!==null&&o!==void 0?o:t.displayData}}},nf=[I0,P0,j0,K0,c0,m0,b0,k0,D0,B0,N0,$0,X0,Q0,tf],Ki=[];class of extends Tu{constructor(){super(...arguments),this.imageLoaded=()=>{},this.loadedLocations=[],this.cache={},this.sendLoaded=Vs(()=>{this.imageLoaded(new _o(this.loadedLocations)),this.loadedLocations=[]},20),this.clearOutOfWindow=()=>{const t=Object.keys(this.cache);for(const n of t){const o=this.cache[n];let l=!1;for(let i=0;i<o.cells.length;i++){const u=o.cells[i];if(this.isInWindow(u)){l=!0;break}}l?o.cells=o.cells.filter(this.isInWindow):(o.cancel(),delete this.cache[n])}}}setCallback(t){this.imageLoaded=t}loadImage(t,n,o,l){var i;let u=!1;const r=(i=Ki.pop())!==null&&i!==void 0?i:new Image;let a=!1;const d={img:void 0,cells:[Rn(n,o)],url:t,cancel:()=>{a||(a=!0,Ki.length<12?Ki.unshift(r):u||(r.src=""))}},c=new Promise(h=>r.addEventListener("load",()=>h(null)));requestAnimationFrame(async()=>{try{r.src=t,await c,await r.decode();const h=this.cache[l];if(h!==void 0&&!a){h.img=r;for(const v of h.cells)this.loadedLocations.push(ur(v));u=!0,this.sendLoaded()}}catch{d.cancel()}}),this.cache[l]=d}loadOrGetImage(t,n,o){const l=t,i=this.cache[l];if(i!==void 0){const u=Rn(n,o);return i.cells.includes(u)||i.cells.push(u),i.img}else this.loadImage(t,n,o,l)}}const lf=(e,t)=>{const n=s.useMemo(()=>({...wd,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>{var i;return(i=e.renderers)!==null&&i!==void 0?i:nf},[e.renderers]),l=s.useMemo(()=>{var i;return(i=e.imageWindowLoader)!==null&&i!==void 0?i:new of},[e.imageWindowLoader]);return s.createElement(d0,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:l})},wf=s.forwardRef(lf);export{wf as D,ie as G,lr as a,Iu as b,mn as c,mf as d,gf as e,ff as f,wn as g,jn as h,hf as i,Or as j,ll as k,Ho as m,nl as p,Wn as r,vf as u};
