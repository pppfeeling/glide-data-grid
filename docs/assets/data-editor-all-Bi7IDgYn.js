const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-CunnMCbA.js","./iframe-CjmKsnL3.js","./preload-helper-C1FmrZbK.js","./index-C1kEPNG5.js","./marked.esm-CYi05mr0.js","./throttle-BnV2iN4V.js","./flatten-DN3djzyt.js","./number-overlay-editor-CrhXxULw.js","./react-number-format.es-CCCxd45n.js"])))=>i.map(i=>d[i]);
var Zs=Object.defineProperty;var Js=(e,t,n)=>t in e?Zs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Le=(e,t,n)=>Js(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as Et}from"./iframe-CjmKsnL3.js";import{_ as Ll}from"./preload-helper-C1FmrZbK.js";import{h as Qs,g as Bl,j as ea,k as ta,v as na,l as oa,m as fn,r as ho,t as ra}from"./throttle-BnV2iN4V.js";import{u as ia,f as al}from"./flatten-DN3djzyt.js";import{s as on,a as la}from"./marked.esm-CYi05mr0.js";function Wl(e="This should not happen"){throw new Error(e)}function en(e,t="Assertion failed"){if(!e)return Wl(t)}function dr(e,t){return Wl(t??"Hell froze over")}function sa(e,t){try{return e()}catch{return t}}const cl=Object.prototype.hasOwnProperty;function $o(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&$o(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(cl.call(e,n)&&++o&&!cl.call(t,n)||!(n in t)||!$o(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Gr=null,Li=void 0;var ee;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(ee||(ee={}));var dl;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(dl||(dl={}));var _r;(function(e){e.Triangle="triangle",e.Dots="dots"})(_r||(_r={}));function $r(e){return"width"in e&&typeof e.width=="number"}async function ul(e){return typeof e=="object"?e:await e()}function zo(e){return!(e.kind===ee.Loading||e.kind===ee.Bubble||e.kind===ee.RowID||e.kind===ee.Protected||e.kind===ee.Drilldown)}function Au(e){return!(e.kind===ee.Loading||e.kind===ee.Bubble||e.kind===ee.RowID||e.kind===ee.Protected||e.kind===ee.Drilldown||e.kind===ee.Boolean||e.kind===ee.Image||e.kind===ee.Custom)}function Lo(e){return e.kind===nn.Marker||e.kind===nn.NewRow}function Po(e){if(!zo(e)||e.kind===ee.Image)return!1;switch(e.kind){case ee.Text:case ee.Number:case ee.Markdown:case ee.Uri:case ee.Custom:case ee.Boolean:return e.readonly!==!0;default:dr(e,"A cell was passed with an invalid kind")}}function aa(e){return Qs(e,"editor")}function Bi(e){return!(e.readonly??!1)}var nn;(function(e){e.NewRow="new-row",e.Marker="marker"})(nn||(nn={}));const Kr={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Ci(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let fl;const Zt=class Zt{constructor(t){Le(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Zt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Ci([...this.items,n]);return new Zt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,d]of n.entries()){const[l,c]=d;if(l<=r&&o<=c){const f=[];l<o&&f.push([l,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new Zt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Le(Zt,"create",t=>new Zt(Ci(t))),Le(Zt,"empty",()=>fl??(fl=new Zt([]))),Le(Zt,"fromSingleSelection",t=>Zt.empty().add(t)),Le(Zt,"fromArray",t=>{if(t.length===0)return Zt.empty();const n=t.map(r=>[r,r+1]),o=Ci(n);return new Zt(o)});let et=Zt;const ca=on("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Vt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const d=n,l=c=>{var f;(f=i.current)==null||f.call(d,c)};return d.addEventListener(e,l,{passive:o,capture:r}),()=>{d.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function eo(e,t){return e===void 0?void 0:t}const da=Math.PI;function hl(e){return e*da/180}const $l=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Ol=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Nl=(e,t,n)=>Math.min(e,t-n*2),Xl=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Wi=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},ua=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function fa(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const d=s.useRef(Bl(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&d.current(()=>e())},t),o}const ha="֑-߿יִ-﷽ﹰ-ﻼ",ga="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",ma=new RegExp("^[^"+ga+"]*["+ha+"]");function $i(e){return ma.test(e)?"rtl":"not-rtl"}let Or;function Fi(){if(typeof document>"u")return 0;if(Or!==void 0)return Or;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Or=n-o,Or}const fo=Symbol();function wa(e){const t=s.useRef([fo,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const c=t.current[0];c!==fo&&(l=typeof l=="function"?l(c):l,l===c)||(c!==fo&&r({}),o(f=>typeof l=="function"?l(c===fo?f:c):l),t.current[0]=fo)},[]),d=s.useCallback(()=>{t.current[0]=fo,r({})},[]);return[t.current[0]===fo?n:t.current[0],i,d]}function Yl(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ba(e){const t=s.useRef(e);return $o(e,t.current)||(t.current=e),t.current}const ya=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const d=i.length>1;return s.createElement(ca,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(ea.Carousel,{showArrows:d,showThumbs:!1,swipeable:d,emulateTouch:d,infiniteLoop:d},i.map(l=>{const c=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},c)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Wi,null)))},pa=on("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class va extends Et.PureComponent{constructor(){super(...arguments);Le(this,"targetElement",null);Le(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,d=la(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let c=i==null?void 0:i(d);if(c===void 0){const u=document.createElement("template");u.innerHTML=d,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Et.createElement(pa,{ref:this.containerRefHook})}}const Ca=on("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),xa=on("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),ka=on("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let gl=0;const Zr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:d,...l}=e,{onChange:c,className:f}=l,u=s.useRef(null),m=n??"";en(c!==void 0,"GrowingEntry must be a controlled input area");const[g]=s.useState(()=>"input-box-"+(gl=(gl+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const b=m.toString().length;h.focus(),h.setSelectionRange(r?0:b,b)},[]),s.useLayoutEffect(()=>{var h;if(d!==void 0){const b=typeof d=="number"?[d,null]:d;(h=u.current)==null||h.setSelectionRange(b[0],b[1])}},[d]);const w=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(ka,{className:"gdg-growing-entry"},s.createElement(xa,{className:f},m+`
`),s.createElement(Ca,{...l,className:(f??"")+" gdg-input",id:g,ref:u,onKeyDown:w,value:m,placeholder:t,dir:"auto"}))},xi={};let Jn=null;function Sa(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Oo(e){const t=e.toLowerCase().trim();if(xi[t]!==void 0)return xi[t];Jn=Jn||Sa(),Jn.style.color="#000",Jn.style.color=t;const n=getComputedStyle(Jn).color;Jn.style.color="#fff",Jn.style.color=t;const o=getComputedStyle(Jn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),xi[t]=r,r}function mo(e,t){const[n,o,r]=Oo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const ml=new Map;function wl(e,t){const n=`${e}-${t}`,o=ml.get(n);if(o!==void 0)return o;const r=tn(e,t);return ml.set(n,r),r}function tn(e,t){if(t===void 0)return e;const[n,o,r,i]=Oo(e);if(i===1)return e;const[d,l,c,f]=Oo(t),u=i+f*(1-i),m=(i*n+f*d*(1-i))/u,g=(i*o+f*l*(1-i))/u,w=(i*r+f*c*(1-i))/u;return`rgba(${m}, ${g}, ${w}, ${u})`}function zu(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,d]=Oo(e),[l,c,f,u]=Oo(t),m=o*d,g=r*d,w=i*d,h=l*u,b=c*u,C=f*u,k=n,y=1-n,M=d*y+u*k;if(M===0)return"rgba(0, 0, 0, 0)";const $=Math.floor((m*y+h*k)/M),B=Math.floor((g*y+b*k)/M),A=Math.floor((w*y+C*k)/M);return`rgba(${$}, ${B}, ${A}, ${M})`}function Pu(e){if(e==="transparent")return 0;function t(i){const d=i/255;return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}const[n,o,r]=Oo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Ma(e,t){return Et.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function Ra(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(ar(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function ur(e,t){return(e??"")===(t??"")}function Ea(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Gl(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function ar(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function _l(e){return[e.x+e.width-1,e.y+e.height-1]}function bl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,d=n.y+n.height-1,[l,c]=e;if(c<i||c>d)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Ia(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&bl(e,t,i)&&r++;for(const d of n.current.rangeStack)bl(e,t,d)&&r++;return r}function Kl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,d)=>({...i,sticky:e[d].sticky})),n=o}return n}function No(e,t){let n=0;const o=Kl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function wo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Ti(e,t,n,o,r){const i=Kl(e,o),d=[];for(const f of i)if(f.sticky)d.push(f);else break;if(d.length>0)for(const f of d)n-=f.width;let l=t,c=r??0;for(;c<=n&&l<i.length;)c+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||d.push(u)}return d}function Da(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Fa(e,t,n,o,r,i,d,l,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let m=t;for(let h=0;h<f;h++){const b=i-1-h,C=typeof d=="number"?d:d(b);if(m-=C,e>=m)return b}const g=i-f,w=e-(c??0);if(typeof d=="number"){const h=Math.floor((w-u)/d)+l;return h>=g?void 0:h}else{let h=u;for(let b=l;b<g;b++){const C=d(b);if(w<=h+C)return b;h+=C}return}}let Yr=0,cr={};const Ta=typeof window>"u";async function Ha(){var e;Ta||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Yr=0,cr={},na())}Ha();function Ul(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Xo(e,t,n,o="middle"){const r=Ul(e,t,o,n);let i=cr[r];return i===void 0&&(i=t.measureText(e),cr[r]=i,Yr++),Yr>1e4&&(cr={},Yr=0),i}function Vl(e,t){const n=Ul(e,void 0,"middle",t);return cr[n]}function _n(e,t){return typeof t!="string"&&(t=t.baseFontFull),Aa(e,t)}function yl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const pl=[];function Aa(e,t){for(const i of pl)if(i.key===t)return i.val;const n=yl(e,"alphabetic"),r=-(yl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return pl.push({key:t,val:r}),r}function za(e,t,n,o,r,i){const{ctx:d,rect:l,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const m=1-f/u;d.globalAlpha=m,d.fillStyle=c.bgSearchResult,d.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),d.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function hr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},d=n??r.textDark;return d!==i.fillStyle&&(o.fillStyle=d,i.fillStyle=d),i}function Lu(e,t,n,o,r){const{rect:i,ctx:d,theme:l}=e;d.fillStyle=l.textDark,Hn({ctx:d,rect:i,theme:l},t,n,o,r)}function ql(e,t,n,o,r,i,d,l,c){c==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+d):c==="center"?e.fillText(t,n+r/2,o+i/2+d):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+d)}function jl(e,t){const n=Xo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Pa(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function La(e,t,n,o,r,i,d,l,c,f){const u=l.baseFontFull,m=ta(e,t,u,r-l.cellHorizontalPadding*2,f??!1),g=jl(e,u),w=l.lineHeight*g,h=g+w*(m.length-1),b=h+l.cellVerticalPadding>i;b&&(e.save(),e.rect(n,o,r,i),e.clip());const C=o+i/2-h/2;let k=Math.max(o+l.cellVerticalPadding,C);for(const y of m)if(ql(e,y,n,k,r,g,d,l,c),k+=w,k>o+i)break;b&&e.restore()}function Hn(e,t,n,o,r){const{ctx:i,rect:d,theme:l}=e,{x:c,y:f,width:u,height:m}=d;o=o??!1,o||(t=Pa(t,u));const g=_n(i,l),w=$i(t)==="rtl";if(n===void 0&&w&&(n="right"),w&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?La(i,t,c,f,u,m,g,l,n,r):ql(i,t,c,f,u,m,g,l,n),h&&(i.textAlign="start"),w&&(i.direction="inherit")}}function An(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Ba(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Wa(e,t,n){const o=function(l,c){const f=c.x-l.x,u=c.y-l.y,m=Math.sqrt(f*f+u*u),g=f/m,w=u/m;return{x:f,y:c.y-l.y,len:m,nx:g,ny:w,ang:Math.atan2(w,g)}};let r;const i=t.length;let d=t[i-1];for(let l=0;l<i;l++){let c=t[l%i];const f=t[(l+1)%i],u=o(c,d),m=o(c,f),g=u.nx*m.ny-u.ny*m.nx,w=u.nx*m.nx-u.ny*-m.ny;let h=Math.asin(g<-1?-1:g>1?1:g),b=1,C=!1;w<0?h<0?h=Math.PI+h:(h=Math.PI-h,b=-1,C=!0):h>0&&(b=-1,C=!0),r=c.radius!==void 0?c.radius:n;const k=h/2;let y=Math.abs(Math.cos(k)*r/Math.sin(k)),M;y>Math.min(u.len/2,m.len/2)?(y=Math.min(u.len/2,m.len/2),M=Math.abs(y*Math.sin(k)/Math.cos(k))):M=r;let $=c.x+m.nx*y,B=c.y+m.ny*y;$+=-m.ny*M*b,B+=m.nx*M*b,e.arc($,B,M,u.ang+Math.PI/2*b,m.ang-Math.PI/2*b,C),d=c,c=f}e.closePath()}function Hi(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h){const b={x:0,y:i+f,width:0,height:0};if(e>=w.length||t>=u||t<-2||e<0)return b;const C=i-r;if(e>=m){const k=d>e?-1:1,y=No(w);b.x+=y+c;for(let M=d;M!==e;M+=k)b.x+=w[k===1?M:M-1].width*k}else for(let k=0;k<e;k++)b.x+=w[k].width;if(b.width=w[e].width+1,t===-1)b.y=r,b.height=C;else if(t===-2){b.y=0,b.height=r;let k=e;const y=w[e].group,M=w[e].sticky;for(;k>0&&ur(w[k-1].group,y)&&w[k-1].sticky===M;){const B=w[k-1];b.x-=B.width,b.width+=B.width,k--}let $=e;for(;$+1<w.length&&ur(w[$+1].group,y)&&w[$+1].sticky===M;){const B=w[$+1];b.width+=B.width,$++}if(!M){const B=No(w),A=b.x-B;A<0&&(b.x-=A,b.width+=A),b.x+b.width>n&&(b.width=n-b.x)}}else if(t>=u-g){let k=u-t;for(b.y=o;k>0;){const y=t+k-1;b.height=typeof h=="number"?h:h(y),b.y-=b.height,k--}b.height+=1}else{const k=l>t?-1:1;if(typeof h=="number"){const y=t-l;b.y+=y*h}else for(let y=l;y!==t;y+=k)b.y+=h(y)*k;b.height=(typeof h=="number"?h:h(t))+1}return b}const Oi=1<<21;function kn(e,t){return(t+2)*Oi+e}function Zl(e){return e%Oi}function Ni(e){return Math.floor(e/Oi)-2}function Xi(e){const t=Zl(e),n=Ni(e);return[t,n]}class Jl{constructor(){Le(this,"visibleWindow",{x:0,y:0,width:0,height:0});Le(this,"freezeCols",0);Le(this,"freezeRows",[]);Le(this,"isInWindow",t=>{const n=Zl(t),o=Ni(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,d=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&d})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&$o(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class $a extends Jl{constructor(){super(...arguments);Le(this,"cache",new Map);Le(this,"setValue",(n,o)=>{this.cache.set(kn(n[0],n[1]),o)});Le(this,"getValue",n=>this.cache.get(kn(n[0],n[1])));Le(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Wo{constructor(t=[]){Le(this,"cells");this.cells=new Set(t.map(n=>kn(n[0],n[1])))}add(t){this.cells.add(kn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(kn(t[0],t[1]))}remove(t){this.cells.delete(kn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Ni(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(kn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Xi(t)}}function Oa(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const Ql={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function es(){return Ql}const ts=Et.createContext(Ql);function Bu(){return Et.useContext(ts)}function Gn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=tn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Ai=150;function Na(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Ai}function ns(e,t,n,o,r,i,d,l,c){let f=0;const u=r===void 0?[]:r.map(w=>{const h=Na(e,w[o],t,c);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let w=0;for(const b of u)w+=b;const h=w/u.length;for(let b=0;b<u.length;b++)u[b]>=h*2?u[b]=0:f=Math.max(f,u[b])}const m=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=m;const g=Math.max(Math.ceil(i),Math.min(Math.floor(d),Math.ceil(f)));return{...n,width:g}}function Xa(e,t,n,o,r,i,d,l,c){const f=s.useRef(t),u=s.useRef(n),m=s.useRef(d);f.current=t,u.current=n,m.current=d;const[g,w]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const y=document.createElement("canvas");return y.style.display="none",y.style.opacity="0",y.style.position="fixed",[y,y.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(g&&document.documentElement.append(g),()=>{g==null||g.remove()}),[g]);const h=s.useRef({}),b=s.useRef(),[C,k]=s.useState();return s.useLayoutEffect(()=>{const y=u.current;if(y===void 0||e.every($r))return;let M=Math.max(1,10-Math.floor(e.length/1e4)),$=0;M<f.current&&M>1&&(M--,$=1);const B={x:0,y:0,width:e.length,height:Math.min(f.current,M)},A={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const Y=y(B,c.signal),R=$>0?y(A,c.signal):void 0;let O;typeof Y=="object"?O=Y:O=await ul(Y),R!==void 0&&(typeof R=="object"?O=[...O,...R]:O=[...O,...await ul(R)]),b.current=e,k(O)})()},[c.signal,e]),s.useMemo(()=>{let M=e.every($r)?e:w===null?e.map(P=>$r(P)?P:{...P,width:Ai}):(w.font=m.current.baseFontFull,e.map((P,Y)=>{if($r(P))return P;if(h.current[P.id]!==void 0)return{...P,width:h.current[P.id]};if(C===void 0||b.current!==e||P.id===void 0)return{...P,width:Ai};const R=ns(w,d,P,Y,C,r,i,!0,l);return h.current[P.id]=R.width,R})),$=0,B=0;const A=[];for(const[P,Y]of M.entries())$+=Y.width,Y.grow!==void 0&&Y.grow>0&&(B+=Y.grow,A.push(P));if($<o&&A.length>0){const P=[...M],Y=o-$;let R=Y;for(let O=0;O<A.length;O++){const X=A[O],W=(M[X].grow??0)/B,F=O===A.length-1?R:Math.min(R,Math.floor(Y*W));P[X]={...M[X],growOffset:F,width:M[X].width+F},R-=F}M=P}return{sizedColumns:M,nonGrowWidth:$}},[o,e,w,C,d,r,i,l])}const St='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Ya=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Ga=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},_a=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Ka=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ua=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},os=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Va=e=>{const t=e.bgColor;return`${St}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},qa=os,ja=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},uc=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},fc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${St}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},hc=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},gc=e=>{const t=e.fgColor,n=e.bgColor;return`${St}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},mc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},wc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},bc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),yc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),pc={headerRowID:Ya,headerNumber:_a,headerCode:Ga,headerString:Ka,headerBoolean:Ua,headerAudioUri:qa,headerVideoUri:ja,headerEmoji:Za,headerImage:Ja,headerUri:os,headerPhone:Qa,headerMarkdown:ec,headerDate:tc,headerTime:nc,headerEmail:oc,headerReference:rc,headerIfThenElse:ic,headerSingleValue:lc,headerLookup:sc,headerTextTemplate:ac,headerMath:cc,headerRollup:dc,headerJoinStrings:uc,headerSplitString:fc,headerGeoDistance:hc,headerArray:gc,rowOwnerOverlay:mc,protectedColumnOverlay:wc,renameIcon:Va,headerArrowDown:bc,headerArrowUp:yc};function vc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Cc{constructor(t,n){Le(this,"onSettled");Le(this,"spriteMap",new Map);Le(this,"headerIcons");Le(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,d,l,c=1){const[f,u]=vc(n,l),m=d*Math.ceil(window.devicePixelRatio),g=`${f}_${u}_${m}_${t}`;let w=this.spriteMap.get(g);if(w===void 0){const h=this.headerIcons[t];if(h===void 0)return;w=document.createElement("canvas");const b=w.getContext("2d");if(b===null)return;const C=new Image;C.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(g,w);const k=C.decode();if(k===void 0)return;this.inFlight++,k.then(()=>{b.drawImage(C,0,0,m,m)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(w,0,0,m,m,r,i,d,d),c<1&&(o.globalAlpha=1)}}function rs(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Jr(e,t,n,o,r,i,d,l,c){l=l??t;let f=t,u=e;const m=o-i;let g=!1;for(;f<n&&u<m;){const w=r(u);if(f+w>l&&c(f,u,w,!1,d&&u===o-1)===!0){g=!0;break}f+=w,u++}if(!g){f=n;for(let w=0;w<i;w++){u=o-1-w;const h=r(u);f-=h,c(f,u,h,!0,d&&u===o-1)}}}function no(e,t,n,o,r,i){let d=0,l=0;const c=r+o;for(const f of e){const u=f.sticky?l:d+n;if(i(f,u,c,f.sticky?0:l,t)===!0)break;d+=f.width,l+=f.sticky?f.width:0}}function is(e,t,n,o,r){let i=0,d=0;for(let l=0;l<e.length;l++){const c=e[l];let f=l+1,u=c.width;for(c.sticky&&(d+=u);f<e.length&&ur(e[f].group,c.group)&&e[f].sticky===e[l].sticky;){const b=e[f];u+=b.width,f++,l++,b.sticky&&(d+=b.width)}const m=c.sticky?0:n,g=i+m,w=c.sticky?0:Math.max(0,d-g),h=Math.min(u-w,t-(g+w));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",g+w,0,h,o),i+=u}}function ls(e,t,n,o,r,i,d){var g;const[l,c]=e;let f,u;const m=((g=d.find(w=>!w.sticky))==null?void 0:g.sourceIndex)??0;if(c>m){const w=Math.max(l,m);let h=t,b=o;for(let C=i.sourceIndex-1;C>=w;C--)h-=d[C].width,b+=d[C].width;for(let C=i.sourceIndex+1;C<=c;C++)b+=d[C].width;u={x:h,y:n,width:b,height:r}}if(m>l){const w=Math.min(c,m-1);let h=t,b=o;for(let C=i.sourceIndex-1;C>=l;C--)h-=d[C].width,b+=d[C].width;for(let C=i.sourceIndex+1;C<=w;C++)b+=d[C].width;f={x:h,y:n,width:b,height:r}}return[f,u]}function xc(e,t,n,o){if(o==="any")return ss(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Gl([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,d=n-e.y+1,l=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:d,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return c===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===d?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function fr(e,t,n,o,r,i,d,l){return e<=r+d&&r<=e+n&&t<=i+l&&i<=t+o}function go(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function ss(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function kc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Sc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,d=t+4,l=n+4,c=r-e.x,f=e.x+e.width-d,u=i-e.y,m=e.y+e.height-l,g=c>0?e.x+Math.floor(c/o)*o:e.x,w=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,b=m>0?e.y+e.height-Math.floor(m/o)*o:e.y+e.height;return{x:g,y:h,width:w-g,height:b-h}}function Mc(e,t,n,o,r){const[i,d,l,c]=t,[f,u,m,g]=r,{x:w,y:h,width:b,height:C}=e,k=[];if(b<=0||C<=0)return k;const y=w+b,M=h+C,$=w<i,B=h<d,A=w+b>l,P=h+C>c,Y=w>=i&&w<l||y>i&&y<=l||w<i&&y>l,R=h>=d&&h<c||M>d&&M<=c||h<d&&M>c;if(Y&&R){const X=Math.max(w,i),W=Math.max(h,d),F=Math.min(y,l),H=Math.min(M,c);k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:f,y:u,width:m-f+1,height:g-u+1}})}if($&&B){const X=w,W=h,F=Math.min(y,i),H=Math.min(M,d);k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:0,y:0,width:f+1,height:u+1}})}if(B&&Y){const X=Math.max(w,i),W=h,F=Math.min(y,l),H=Math.min(M,d);k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:f,y:0,width:m-f+1,height:u+1}})}if(B&&A){const X=Math.max(w,l),W=h,F=y,H=Math.min(M,d);k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:m,y:0,width:n-m+1,height:u+1}})}if($&&R){const X=w,W=Math.max(h,d),F=Math.min(y,i),H=Math.min(M,c);k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:0,y:u,width:f+1,height:g-u+1}})}if(A&&R){const X=Math.max(w,l),W=Math.max(h,d),F=y,H=Math.min(M,c);k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:m,y:u,width:n-m+1,height:g-u+1}})}if($&&P){const X=w,W=Math.max(h,c),F=Math.min(y,i),H=M;k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:0,y:g,width:f+1,height:o-g+1}})}if(P&&Y){const X=Math.max(w,i),W=Math.max(h,c),F=Math.min(y,l),H=M;k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:f,y:g,width:m-f+1,height:o-g+1}})}if(A&&P){const X=Math.max(w,l),W=Math.max(h,c),F=y,H=M;k.push({rect:{x:X,y:W,width:F-X,height:H-W},clip:{x:m,y:g,width:n-m+1,height:o-g+1}})}return k}const Rc={kind:ee.Loading,allowOverlay:!1};function vl(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b,C,k,y,M,$,B,A,P,Y,R,O,X,W,F,H,le,q,he,de){let ye=(M==null?void 0:M.size)??Number.MAX_SAFE_INTEGER;const te=performance.now();let K=F.baseFontFull;e.font=K;const pe={ctx:e},ne=[0,0],we=C>0?wo(c,C,f):0;let $e,V;const oe=new Wo,Ae=new Set,Ve=rs(y);if(no(t,l,i,d,r,(ce,qe,st,Ce,ze)=>{const Fe=Math.max(0,Ce-qe),vt=qe+Fe,ht=r+1,gt=ce.width-Fe,j=o-r-1;if(y.length>0){let at=!1;for(let Z=0;Z<y.length;Z++){const se=y[Z];if(fr(vt,ht,gt,j,se.x,se.y,se.width,se.height)){at=!0;break}}if(!at)return}const be=()=>{e.save(),e.beginPath(),e.rect(vt,ht,gt,j),e.clip()},xe=$.columns.hasIndex(ce.sourceIndex),Ie=m(ce.group??"").overrideTheme,ke=ce.themeOverride===void 0&&Ie===void 0?F:Gn(F,Ie,ce.themeOverride),tt=ke.baseFontFull;tt!==K&&(K=tt,e.font=tt),be();let Ze;return Jr(ze,st,o,c,f,C,k,Ve,(at,Z,se,Oe,Xe)=>{var zn,Kt,gn;if(Z<0)return;if(ne[0]=ce.sourceIndex,ne[1]=Z,oe.has(ne)){ye--;return}if(M!==void 0&&!M.has(ne))return;if(y.length>0){let Ee=!1;for(let Qe=0;Qe<y.length;Qe++){const Je=y[Qe];if(fr(qe,at,ce.width,se,Je.x,Je.y,Je.width,Je.height)){Ee=!0;break}}if(!Ee)return}const Ht=$.rows.hasIndex(Z),At=w.hasIndex(Z),Re=Z<c?u(ne):Rc;let Se=qe,ct=ce.width,Rt=at,It=se,Ot=!1,Pt=!1;if(Re.rowspan!==void 0){const[Ee,Qe]=Re.rowspan,Je=`${ce.sourceIndex}|${Ee}`;if(Ae.has(Je)){ye--;return}else{let _e=at;for(let Ge=Ee;Ge<Z;Ge++)_e-=f(Ge);let Nt=0;for(let Ge=Ee;Ge<Qe;Ge++)Nt+=f(Ge);if(_e<ht+j&&_e+Nt>ht){Rt=_e,It=Nt,Ae.add(Je);for(let Ge=Ee;Ge<Qe;Ge++)Ge!==Z&&oe.add([ce.sourceIndex,Ge]);Ot=!0}else{Ae.add(Je);for(let Ge=Ee;Ge<Qe;Ge++)oe.add([ce.sourceIndex,Ge]);ye--;return}}}if(Re.span!==void 0){const[Ee,Qe]=Re.span,Je=`${Z},${Ee},${Qe},${ce.sticky}`;if(V===void 0&&(V=new Set),V.has(Je)){ye--;return}else{const _e=ls(Re.span,qe,at,ce.width,se,ce,n),Nt=ce.sticky?_e[0]:_e[1];!ce.sticky&&_e[0]!==void 0&&(Pt=!0),Nt!==void 0&&(Se=Nt.x,ct=Nt.width,V.add(Je),Ot=!0)}}if(Ot){e.restore(),Ze=void 0,e.save(),e.beginPath();const Ee=Math.max(0,Ce-Se);e.rect(Se+Ee,Rt,ct-Ee,It),$e===void 0&&($e=[]),$e.push({x:Se+Ee,y:Rt,width:ct-Ee,height:It}),e.clip()}const hn=g==null?void 0:g(Z),rn=Xe&&((zn=ce.trailingRowOptions)==null?void 0:zn.themeOverride)!==void 0?(Kt=ce.trailingRowOptions)==null?void 0:Kt.themeOverride:void 0,zt=Re.themeOverride===void 0&&hn===void 0&&rn===void 0?ke:Gn(ke,hn,rn,Re.themeOverride);e.beginPath();const qt=Ea(ne,Re,$);let Gt=Ia(ne,Re,$,b);const Sn=Re.span!==void 0&&$.columns.some(Ee=>Re.span!==void 0&&Ee>=Re.span[0]&&Ee<=Re.span[1]);qt&&!h&&b?Gt=0:qt&&b&&(Gt=Math.max(Gt,1)),Sn&&Gt++,qt||(Ht&&Gt++,xe&&!Xe&&Gt++);const Ct=Re.kind===ee.Protected?zt.bgCellMedium:zt.bgCell;let dt;if((Oe||Ct!==F.bgCell)&&(dt=tn(Ct,dt)),Gt>0||At){At&&(dt=tn(zt.bgHeader,dt));for(let Ee=0;Ee<Gt;Ee++)dt=tn(zt.accentLight,dt)}else if(B!==void 0){for(const Ee of B)if(Ee[0]===ce.sourceIndex&&Ee[1]===Z){dt=tn(zt.bgSearchResult,dt);break}}if(A!==void 0)for(let Ee=0;Ee<A.length;Ee++){const Qe=A[Ee],Je=Qe.range;Qe.style!=="solid-outline"&&Je.x<=ce.sourceIndex&&ce.sourceIndex<Je.x+Je.width&&Je.y<=Z&&Z<Je.y+Je.height&&(dt=tn(Qe.color,dt))}let Ye=!1;if(M!==void 0){const Ee=at+1,Je=(Oe?Ee+se-1:Math.min(Ee+se-1,o-we))-Ee;(Je!==se-1||Se+1<=Ce)&&(Ye=!0,e.save(),e.beginPath(),e.rect(Se+1,Ee,ct-1,Je),e.clip()),dt=dt===void 0?zt.bgCell:tn(dt,zt.bgCell)}const Lt=ce.sourceIndex===n.length-1,Jt=Z===c-1;dt!==void 0&&(e.fillStyle=dt,Ze!==void 0&&(Ze.fillStyle=dt),M!==void 0?e.fillRect(Se+1,Rt+1,ct-(Lt?2:1),It-(Jt?2:1)):e.fillRect(Se,Rt,ct,It)),Re.style==="faded"&&(e.globalAlpha=.6);let Mn;for(let Ee=0;Ee<R.length;Ee++){const Qe=R[Ee];if(Qe.item[0]===ce.sourceIndex&&Qe.item[1]===Z){Mn=Qe;break}}if(ct>de&&!Pt){const Ee=zt.baseFontFull;Ee!==K&&(e.font=Ee,K=Ee);let Qe=0;if(Re.rowspan!==void 0){const Je=Re.rowSpanPosition??"top";if(Je==="top")Qe=se/2-It/2;else if(Je==="bottom"){const[_e,Nt]=Re.rowspan,Ge=f(Nt-1);Qe=It/2-Ge/2}}Ze=as(e,Re,ce.sourceIndex,Z,Lt,Jt,Se,Rt,ct,It,Gt>0,zt,dt??zt.bgCell,P,Y,(Mn==null?void 0:Mn.hoverAmount)??0,O,W,te,X,Ze,H,le,q,he,Qe)}return Ye&&e.restore(),Re.style==="faded"&&(e.globalAlpha=1),ye--,Ot&&(e.restore(),(gn=Ze==null?void 0:Ze.deprep)==null||gn.call(Ze,pe),Ze=void 0,be(),K=tt,e.font=tt),ye<=0}),e.restore(),ye<=0}),$e!==void 0)return $e}const rr=[0,0],ir={x:0,y:0,width:0,height:0},ki=[void 0,()=>{}];let zi=!1;function Ec(){zi=!0}function as(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b,C,k,y,M,$,B,A,P,Y,R){var q,he;let O,X;C!==void 0&&C[0][0]===n&&C[0][1]===o&&(O=C[1][0],X=C[1][1]);let W;rr[0]=n,rr[1]=o,ir.x=d,ir.y=l,ir.width=c,ir.height=f,ki[0]=A.getValue(rr),ki[1]=de=>A.setValue(rr,de),zi=!1;const F={ctx:e,theme:m,col:n,row:o,cell:t,rect:ir,highlighted:u,cellFillColor:g,hoverAmount:b,frameTime:y,hoverX:O,drawState:ki,hoverY:X,imageLoader:w,spriteManager:h,hyperWrapping:k,overrideCursor:O!==void 0?Y:void 0,requestAnimationFrame:Ec},H=za(F,t.lastUpdated,y,$,r,i),le=P(t);if(le!==void 0){($==null?void 0:$.renderer)!==le&&((q=$==null?void 0:$.deprep)==null||q.call($,F),$=void 0);const de=(he=le.drawPrep)==null?void 0:he.call(le,F,$);e.save(),e.translate(0,R),M!==void 0&&!Lo(F.cell)?M(F,()=>le.draw(F,t)):le.draw(F,t),e.restore(),W=de===void 0?void 0:{deprep:de==null?void 0:de.deprep,fillStyle:de==null?void 0:de.fillStyle,font:de==null?void 0:de.font,renderer:le}}return(H||zi)&&(B==null||B(rr)),W}function Ur(e,t,n,o,r,i,d,l,c=-20,f=-20,u=void 0,m="center",g="square",w=!1){const h=Math.floor(r+d/2),b=g==="circle"?1e4:t.roundingRadius??4;let C=Nl(u??t.checkboxMaxSize,d,t.cellVerticalPadding),k=C/2;const y=Ol(m,o,i,t.cellHorizontalPadding,C),M=$l(y,h,C),$=Xl(o+c,r+f,M);switch(n){case!0:{e.beginPath(),An(e,y-C/2,h-C/2,C,C,b),g==="circle"&&(k*=.8,C*=.8),e.fillStyle=w?t.bgCellMedium:l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(y-k+C/4.23,h-k+C/1.97),e.lineTo(y-k+C/2.42,h-k+C/1.44),e.lineTo(y-k+C/1.29,h-k+C/3.25),e.strokeStyle=w?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Gr:case!1:{e.beginPath(),An(e,y-C/2+.5,h-C/2+.5,C-1,C-1,b),e.lineWidth=1,e.strokeStyle=w?t.textLight:$?t.textDark:t.textMedium,e.stroke();break}case Li:{e.beginPath(),An(e,y-C/2,h-C/2,C,C,b),e.fillStyle=w?t.bgCellMedium:$?t.textMedium:t.textLight,e.fill(),g==="circle"&&(k*=.8,C*=.8),e.beginPath(),e.moveTo(y-C/3,h),e.lineTo(y+C/3,h),e.strokeStyle=w?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:dr()}}function Ic(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b,C,k,y){var R,O,X,W;const M=d+l;if(M<=0)return;e.fillStyle=m.bgHeader,e.fillRect(0,0,r,M);const $=(R=o==null?void 0:o[0])==null?void 0:R[0],B=(O=o==null?void 0:o[0])==null?void 0:O[1],A=(X=o==null?void 0:o[1])==null?void 0:X[0],P=(W=o==null?void 0:o[1])==null?void 0:W[1],Y=m.headerFontFull;e.font=Y,no(t,0,i,0,M,(F,H,le,q)=>{var Ae;if(C!==void 0&&!C.has([F.sourceIndex,-1]))return;const he=Math.max(0,q-H);e.save(),e.beginPath(),e.rect(H+he,l,F.width-he,d),e.clip();const de=b(F.group??"").overrideTheme,ye=F.themeOverride===void 0&&de===void 0?m:Gn(m,de,F.themeOverride);ye.bgHeader!==m.bgHeader&&(e.fillStyle=ye.bgHeader,e.fill()),ye!==m&&(e.font=ye.headerFontFull);const te=u.columns.hasIndex(F.sourceIndex),K=c!==void 0||f||F.headerRowMarkerDisabled===!0,pe=!K&&B===-1&&$===F.sourceIndex,ne=K?0:((Ae=w.find(Ve=>Ve.item[0]===F.sourceIndex&&Ve.item[1]===-1))==null?void 0:Ae.hoverAmount)??0,we=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===F.sourceIndex,$e=te?ye.accentColor:we?ye.bgHeaderHasFocus:ye.bgHeader,V=n?l:0,oe=F.sourceIndex===0?0:1;te?(e.fillStyle=$e,e.fillRect(H+oe,V,F.width-oe,d)):(we||ne>0)&&(e.beginPath(),e.rect(H+oe,V,F.width-oe,d),we&&(e.fillStyle=ye.bgHeaderHasFocus,e.fill()),ne>0&&(e.globalAlpha=ne,e.fillStyle=ye.bgHeaderHovered,e.fill(),e.globalAlpha=1)),us(e,H,V,F.width,d,F,te,ye,pe,pe?A:void 0,pe?P:void 0,we,ne,g,k,y),e.restore()}),n&&Dc(e,t,r,i,l,o,m,g,w,h,b,C)}function Dc(e,t,n,o,r,i,d,l,c,f,u,m){const[w,h]=(i==null?void 0:i[0])??[];let b=0;is(t,n,o,r,(C,k,y,M,$,B)=>{if(m!==void 0&&!m.hasItemInRectangle({x:C[0],y:-2,width:C[1]-C[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,M,$,B),e.clip();const A=u(k),P=(A==null?void 0:A.overrideTheme)===void 0?d:Gn(d,A.overrideTheme),Y=h===-2&&w!==void 0&&w>=C[0]&&w<=C[1],R=Y?P.bgGroupHeaderHovered??P.bgHeaderHovered:P.bgGroupHeader??P.bgHeader;if(R!==d.bgHeader&&(e.fillStyle=R,e.fill()),e.fillStyle=P.textGroupHeader??P.textHeader,A!==void 0){let O=y;if(A.icon!==void 0&&(l.drawSprite(A.icon,"normal",e,O+8,(r-20)/2,20,P),O+=26),e.fillText(A.name,O+8,r/2+_n(e,d.headerFontFull)),A.actions!==void 0&&Y){const X=cs({x:y,y:M,width:$,height:B},A.actions);e.beginPath();const W=X[0].x-10,F=y+$-W;e.rect(W,0,F,r);const H=e.createLinearGradient(W,0,W+F,0),le=mo(R,0);H.addColorStop(0,le),H.addColorStop(10/F,R),H.addColorStop(1,R),e.fillStyle=H,e.fill(),e.globalAlpha=.6;const[q,he]=(i==null?void 0:i[1])??[-1,-1];for(let de=0;de<A.actions.length;de++){const ye=A.actions[de],te=X[de],K=go(te,q+y,he);K&&(e.globalAlpha=1),l.drawSprite(ye.icon,"normal",e,te.x+te.width/2-10,te.y+te.height/2-10,20,P),K&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&f(C[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.strokeStyle=d.borderColor,e.lineWidth=1,e.stroke()),e.restore(),b=y+$}),e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=d.borderColor,e.lineWidth=1,e.stroke()}const Nr=30;function Fc(e,t,n,o,r){return{x:e+n-Nr,y:Math.max(t,t+o/2-Nr/2),width:Nr,height:Math.min(Nr,o)}}function cs(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,d=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:d,height:i}),o+=26;return n}function lr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ds(e,t,n,o,r,i,d,l){var P;const c=d.cellHorizontalPadding,f=d.headerIconSize,u=Fc(n,o,r,i);let m=n+c;const g=t.icon===void 0?void 0:{x:m,y:o+(i-f)/2,width:f,height:f},w=g===void 0||t.overlayIcon===void 0?void 0:{x:g.x+9,y:g.y+6,width:18,height:18};g!==void 0&&(m+=Math.ceil(f*1.3));const h=e===void 0?((P=Vl(t.title,d.headerFontFull))==null?void 0:P.width)??0:Xo(t.title,e,d.headerFontFull).width,b=t.hasMenu===!0?35:0,C=t.indicatorIcon!==void 0?f+c:0,k=h+C,y=r-(g!==void 0?Math.ceil(f*1.3)+c:c)-b-c,M=n+(g!==void 0?Math.ceil(f*1.3)+c:c)+(y-k)/2,$={x:Math.max(m,M),y:o,width:h,height:i};let B;t.indicatorIcon!==void 0&&(B={x:$.x+h+c,y:o+(i-f)/2,width:f,height:f});const A=n+r/2;return{menuBounds:lr(u,A,l),iconBounds:lr(g,A,l),iconOverlayBounds:lr(w,A,l),textBounds:lr($,A,l),indicatorIconBounds:lr(B,A,l)}}function Cl(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const y=i.rowMarkerChecked;y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=m);const M=i.headerRowMarkerTheme!==void 0?Gn(l,i.headerRowMarkerTheme):l;Ur(e,M,y,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),y!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const C=d?l.textHeaderSelected:l.textHeader,k=i.hasMenu===!0&&(c||w&&d)&&b.menuBounds!==void 0;if(i.icon!==void 0&&b.iconBounds!==void 0){let y=d?"selected":"normal";i.style==="highlight"&&(y=d?"selected":"special"),g.drawSprite(i.icon,y,e,b.iconBounds.x,b.iconBounds.y,b.iconBounds.width,l),i.overlayIcon!==void 0&&b.iconOverlayBounds!==void 0&&g.drawSprite(i.overlayIcon,d?"selected":"special",e,b.iconOverlayBounds.x,b.iconOverlayBounds.y,b.iconOverlayBounds.width,l)}if(k&&o>35){const M=h?35:o-35,$=h?35*.7:o-35*.7,B=M/o,A=$/o,P=e.createLinearGradient(t,0,t+o,0),Y=mo(C,0);P.addColorStop(h?1:0,C),P.addColorStop(B,C),P.addColorStop(A,Y),P.addColorStop(h?0:1,Y),e.fillStyle=P}else e.fillStyle=C;if(h&&(e.textAlign="right"),b.textBounds!==void 0&&e.fillText(i.title,h?b.textBounds.x+b.textBounds.width:b.textBounds.x,n+r/2+_n(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&b.indicatorIconBounds!==void 0&&(!k||!fr(b.menuBounds.x,b.menuBounds.y,b.menuBounds.width,b.menuBounds.height,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,b.indicatorIconBounds.height))){let y=d?"selected":"normal";i.style==="highlight"&&(y=d?"selected":"special"),g.drawSprite(i.indicatorIcon,y,e,b.indicatorIconBounds.x,b.indicatorIconBounds.y,b.indicatorIconBounds.width,l)}if(k&&b.menuBounds!==void 0){const y=b.menuBounds,M=f!==void 0&&u!==void 0&&go(y,f+t,u+n);if(M||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===_r.Triangle){e.beginPath();const $=y.x+y.width/2-5.5,B=y.y+y.height/2-3;Wa(e,[{x:$,y:B},{x:$+11,y:B},{x:$+5.5,y:B+6}],1),e.fillStyle=C,e.fill()}else if(i.menuIcon===_r.Dots){e.beginPath();const $=y.x+y.width/2,B=y.y+y.height/2;Ba(e,$,B),e.fillStyle=C,e.fill()}else{const $=y.x+(y.width-l.headerIconSize)/2,B=y.y+(y.height-l.headerIconSize)/2;g.drawSprite(i.menuIcon,"normal",e,$,B,l.headerIconSize,l)}M||(e.globalAlpha=1)}}function us(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b){const C=$i(i.title)==="rtl",k=ds(e,i,t,n,o,r,l,C);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:d,hoverAmount:g,isHovered:c,hasSelectedCell:m,spriteManager:w,menuBounds:(k==null?void 0:k.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>Cl(e,t,n,o,r,i,d,l,c,f,u,g,w,b,C,k)):Cl(e,t,n,o,r,i,d,l,c,f,u,g,w,b,C,k)}function Tc(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b,C,k,y){if(k!==void 0||t[t.length-1]!==n[t.length-1])return;const M=rs(C);no(t,c,d,l,i,($,B,A,P,Y)=>{if($!==t[t.length-1])return;B+=$.width;const R=Math.max(B,P);R>o||(e.save(),e.beginPath(),e.rect(R,i+1,1e4,r-i-1),e.clip(),Jr(Y,A,r,f,u,h,b,M,(O,X,W,F)=>{if(!F&&C.length>0&&!C.some(de=>fr(B,O,1e4,W,de.x,de.y,de.width,de.height)))return;const H=g.hasIndex(X),le=w.hasIndex(X);e.beginPath();const q=m==null?void 0:m(X),he=q===void 0?y:Gn(y,q);he.bgCell!==y.bgCell&&(e.fillStyle=he.bgCell,e.fillRect(B,O,1e4,W)),le&&(e.fillStyle=he.bgHeader,e.fillRect(B,O,1e4,W)),H&&(e.fillStyle=he.accentLight,e.fillRect(B,O,1e4,W))}),e.restore())})}function Hc(e,t,n,o,r,i,d,l,c){let f=!1;for(const h of t)if(!h.sticky){f=d(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,m=c.borderColor,g=f?No(t):0;let w;if(g!==0&&(w=wl(m,c.bgCell),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,o),e.strokeStyle=w,e.stroke()),r>0){const h=m===u&&w!==void 0?w:wl(u,c.bgCell),b=wo(i,r,l);e.beginPath(),e.moveTo(0,o-b+.5),e.lineTo(n,o-b+.5),e.strokeStyle=h,e.stroke()}}const fs=(e,t,n)=>{let o=0,r=t,i=0,d=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),d=Math.max(d,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:d}};function Ac(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h){var W;const b=h.bgCell,{minX:C,maxX:k,minY:y,maxY:M}=fs(l,i,d),$=[],B=d-wo(w,g,f);let A=c,P=n,Y=0;for(;A+r<B;){const F=A+r,H=f(P);if(F>=y&&F<=M-1){const le=u==null?void 0:u(P),q=le==null?void 0:le.bgCell;q!==void 0&&q!==b&&P>=w-g&&$.push({x:C,y:F,w:k-C,h:H,color:q})}A+=H,P<w-g&&(Y=A),P++}let R=0;const O=Math.min(B,M)-Y;if(O>0)for(let F=0;F<t.length;F++){const H=t[F];if(H.width===0)continue;const le=H.sticky?R:R+o,q=(W=H.themeOverride)==null?void 0:W.bgCell;q!==void 0&&q!==b&&le>=C&&le<=k&&m(F+1)&&$.push({x:le,y:Y,w:H.width,h:O,color:q}),R+=H.width}if($.length===0)return;let X;e.beginPath();for(let F=$.length-1;F>=0;F--){const H=$[F];X===void 0?X=H.color:H.color!==X&&(e.fillStyle=X,e.fill(),e.beginPath(),X=H.color),e.rect(H.x,H.y,H.w,H.h)}X!==void 0&&(e.fillStyle=X,e.fill()),e.beginPath()}function xl(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b,C,k=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,d);for(const W of c)e.rect(W.x+1,W.y+1,W.width-1,W.height-1);e.clip("evenodd")}const y=C.horizontalBorderColor??C.borderColor,M=C.borderColor,{minX:$,maxX:B,minY:A,maxY:P}=fs(l,i,d),Y=[];e.beginPath();let R=.5;for(let W=0;W<t.length;W++){const F=t[W];if(F.width===0)continue;R+=F.width;const H=F.sticky?R:R+o;H>=$&&H<=B&&w(W+1)&&Y.push({x1:H,y1:Math.max(f,A),x2:H,y2:Math.min(d,P),color:M})}let O=d+.5;for(let W=b-h;W<b;W++){const F=m(W);O-=F,Y.push({x1:$,y1:O,x2:B,y2:O,color:y})}if(k!==!0){let W=u+.5,F=n;const H=O;for(;W+r<H;){const le=W+r;if(le>=A&&le<=P-1){const q=g==null?void 0:g(F);Y.push({x1:$,y1:le,x2:B,y2:le,color:(q==null?void 0:q.horizontalBorderColor)??(q==null?void 0:q.borderColor)??y})}W+=m(F),F++}}const X=oa(Y,W=>W.color);for(const W of Object.keys(X)){e.strokeStyle=W;for(const F of X[W])e.moveTo(F.x1,F.y1),e.lineTo(F.x2,F.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function zc(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b,C,k,y){const M=[];e.imageSmoothingEnabled=!1;const $=Math.min(r.cellYOffset,d),B=Math.max(r.cellYOffset,d);let A=0;if(typeof k=="number")A+=(B-$)*k;else for(let H=$;H<B;H++)A+=k(H);d>r.cellYOffset&&(A=-A),A+=c-r.translateY;const P=Math.min(r.cellXOffset,i),Y=Math.max(r.cellXOffset,i);let R=0;for(let H=P;H<Y;H++)R+=b[H].width;i>r.cellXOffset&&(R=-R),R+=l-r.translateX;const O=No(C);if(R!==0&&A!==0)return{regions:[]};const X=f>0?wo(g,f,k):0,W=u-O-Math.abs(R),F=m-w-X-Math.abs(A)-1;if(W>150&&F>150){const H={sx:0,sy:0,sw:u*h,sh:m*h,dx:0,dy:0,dw:u*h,dh:m*h};if(A>0?(H.sy=(w+1)*h,H.sh=F*h,H.dy=(A+w+1)*h,H.dh=F*h,M.push({x:0,y:w,width:u,height:A+1})):A<0&&(H.sy=(-A+w+1)*h,H.sh=F*h,H.dy=(w+1)*h,H.dh=F*h,M.push({x:0,y:m+A-X,width:u,height:-A+X})),R>0?(H.sx=O*h,H.sw=W*h,H.dx=(R+O)*h,H.dw=W*h,M.push({x:O-1,y:0,width:R+2,height:m})):R<0&&(H.sx=(O-R)*h,H.sw=W*h,H.dx=O*h,H.dw=W*h,M.push({x:u+R,y:0,width:-R,height:m})),e.setTransform(1,0,0,1,0,0),y){if(O>0&&R!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const le=O*h,q=m*h;e.drawImage(t,0,0,le,q,0,0,le,q)}if(X>0&&R===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const le=(m-X)*h,q=u*h,he=X*h;e.drawImage(t,0,le,q,he,0,le,q,he)}}e.drawImage(t,H.sx,H.sy,H.sw,H.sh,H.dx,H.dy,H.dw,H.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:M}}function Pc(e,t,n,o,r,i,d,l,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||no(c,n,o,r,l,(m,g,w,h)=>{if(m.sourceIndex===f){const b=Math.max(g,h)+1;return u.push({x:b,y:0,width:i-b,height:d}),!0}}),u}function Lc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if($o(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:d,...l}=r,{width:c,...f}=i;if(!$o(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function kl(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b){const C=h==null?void 0:h.filter(P=>P.style!=="no-outline");if(C===void 0||C.length===0)return;const k=No(l),y=wo(w,g,m),M=[c,0,l.length,w-g],$=[k,0,t,n-y],B=C.map(P=>{const Y=P.range,R=P.style??"dashed";return Mc(Y,M,t,n,$).map(O=>{const X=O.rect,W=Hi(X.x,X.y,t,n,u,f+u,o,r,i,d,w,c,g,l,m),F=X.width===1&&X.height===1?W:Hi(X.x+X.width-1,X.y+X.height-1,t,n,u,f+u,o,r,i,d,w,c,g,l,m);return X.x+X.width>=l.length&&(F.width-=1),X.y+X.height>=w&&(F.height-=1),{color:P.color,style:R,clip:O.clip,rect:Sc({x:W.x,y:W.y,width:F.x+F.width-W.x,height:F.y+F.height-W.y},t,n,8)}})}),A=()=>{e.lineWidth=1;let P=!1;for(const Y of B)for(const R of Y)if((R==null?void 0:R.rect)!==void 0&&fr(0,0,t,n,R.rect.x,R.rect.y,R.rect.width,R.rect.height)){const O=P,X=!kc(R.clip,R.rect);e.beginPath(),X&&(e.save(),e.rect(R.clip.x,R.clip.y,R.clip.width,R.clip.height),e.clip()),R.style==="dashed"&&!P?(e.setLineDash([5,3]),P=!0):(R.style==="solid"||R.style==="solid-outline")&&P&&(e.setLineDash([]),P=!1),e.strokeStyle=R.style==="solid-outline"?tn(tn(R.color,b.borderColor),b.bgCell):mo(R.color,1),e.closePath(),e.strokeRect(R.rect.x+.5,R.rect.y+.5,R.rect.width-1,R.rect.height-1),X&&(e.restore(),P=O)}P&&e.setLineDash([])};return A(),A}function Sl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Si(e,t,n,o,r,i,d,l,c,f,u,m,g,w,h,b,C){if(u.current===void 0)return;const k=b!==!1&&b!==void 0;if(!k)return;const y=typeof b=="object"?{...Kr,...b}:Kr,M=u.current.range,$=u.current.cell,B=[M.x+M.width-1,M.y+M.height-1];if($[1]>=C&&B[1]>=C||!d.some(q=>q.sourceIndex===$[0]||q.sourceIndex===B[0]))return;const[P,Y]=u.current.cell,R=g(u.current.cell),O=R.span??[P,P],X=Y>=C-w,W=w>0&&!X?wo(C,w,m)-1:0,F=B[1];let H;if(no(d,o,r,i,f,(q,he,de,ye,te)=>{if(q.sticky&&P>q.sourceIndex)return;const K=q.sourceIndex<O[0],pe=q.sourceIndex>O[1],ne=q.sourceIndex===B[0];if(!(!ne&&(K||pe)))return Jr(te,de,n,C,m,w,h,void 0,(we,$e,V)=>{if($e!==Y&&$e!==F)return;let oe=he,Ae=q.width;if(R.span!==void 0){const ce=ls(R.span,he,we,q.width,V,q,l),qe=q.sticky?ce[0]:ce[1];qe!==void 0&&(oe=qe.x,Ae=qe.width)}return $e===F&&ne&&k&&(H=()=>{var ze;ye>oe&&!q.sticky&&(e.beginPath(),e.rect(ye,0,t-ye,n),e.clip());const ce=y.size,qe=ce/2,st=oe+Ae+y.offsetX-qe+.5,Ce=we+V+y.offsetY-qe+.5;e.beginPath(),y.shape==="circle"?e.arc(st+qe,Ce+qe,qe,0,Math.PI*2):e.rect(st,Ce,ce,ce),e.fillStyle=((ze=q.themeOverride)==null?void 0:ze.accentColor)??c.accentColor,e.fill(),y.outline>0&&(e.lineWidth=y.outline,e.strokeStyle=c.bgCell,y.shape==="circle"?(e.beginPath(),e.arc(st+qe,Ce+qe,qe+y.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(st-y.outline/2,Ce-y.outline/2,ce+y.outline,ce+y.outline))}),H!==void 0}),H!==void 0}),H===void 0)return;const le=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-W),e.clip(),H==null||H(),e.restore()};return le(),le}function Bc(e,t,n,o,r,i,d,l,c){c===void 0||c.size===0||(e.beginPath(),is(t,n,i,o,(f,u,m,g,w,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(m,g,w,h)}),no(t,l,i,d,r,(f,u,m,g)=>{const w=Math.max(0,g-u),h=u+w+1,b=f.width-w-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,b,r-o)}),e.clip())}function Wc(e,t,n,o,r,i,d,l,c,f){let u=0;return no(e,i,o,r,n,(m,g,w,h,b)=>(Jr(b,w,t,d,l,c,f,void 0,(C,k,y,M)=>{M||(u=Math.max(k,u))}),!0)),u}function Ml(e,t){var Sn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:d,cellYOffset:l,translateX:c,translateY:f,mappedColumns:u,enableGroups:m,freezeColumns:g,dragAndDropState:w,theme:h,drawFocus:b,headerHeight:C,groupHeaderHeight:k,disabledRows:y,rowHeight:M,verticalBorder:$,overrideCursor:B,isResizing:A,selection:P,fillHandle:Y,freezeTrailingRows:R,rows:O,getCellContent:X,getGroupDetails:W,getRowThemeOverride:F,isFocused:H,drawHeaderCallback:le,prelightCells:q,drawCellCallback:he,highlightRegions:de,resizeCol:ye,imageLoader:te,lastBlitData:K,hoverValues:pe,hyperWrapping:ne,hoverInfo:we,spriteManager:$e,maxScaleFactor:V,hasAppendRow:oe,touchMode:Ae,enqueue:Ve,renderStateProvider:ce,getCellRenderer:qe,renderStrategy:st,bufferACtx:Ce,bufferBCtx:ze,damage:Fe,minimumCellWidth:vt,resizeIndicator:ht}=e;if(r===0||i===0)return;const gt=st==="double-buffer",j=Math.min(V,Math.ceil(window.devicePixelRatio??1)),be=st!=="direct"&&Lc(e,t),xe=n.canvas;(xe.width!==r*j||xe.height!==i*j)&&(xe.width=r*j,xe.height=i*j,xe.style.width=r+"px",xe.style.height=i+"px");const Ie=o.canvas,ke=m?k+C:C,tt=ke+1;(Ie.width!==r*j||Ie.height!==tt*j)&&(Ie.width=r*j,Ie.height=tt*j,Ie.style.width=r+"px",Ie.style.height=tt+"px");const Ze=Ce.canvas,at=ze.canvas;gt&&(Ze.width!==r*j||Ze.height!==i*j)&&(Ze.width=r*j,Ze.height=i*j,K.current!==void 0&&(K.current.aBufferScroll=void 0)),gt&&(at.width!==r*j||at.height!==i*j)&&(at.width=r*j,at.height=i*j,K.current!==void 0&&(K.current.bBufferScroll=void 0));const Z=K.current;if(be===!0&&d===(Z==null?void 0:Z.cellXOffset)&&l===(Z==null?void 0:Z.cellYOffset)&&c===(Z==null?void 0:Z.translateX)&&f===(Z==null?void 0:Z.translateY))return;let se=null;gt&&(se=n);const Oe=o;let Xe;gt?Fe!==void 0?Xe=(Z==null?void 0:Z.lastBuffer)==="b"?ze:Ce:Xe=(Z==null?void 0:Z.lastBuffer)==="b"?Ce:ze:Xe=n;const Ht=Xe.canvas,At=gt?Ht===Ze?at:Ze:xe,Re=typeof M=="number"?()=>M:M;Oe.save(),Xe.save(),Oe.beginPath(),Xe.beginPath(),Oe.textBaseline="middle",Xe.textBaseline="middle",j!==1&&(Oe.scale(j,j),Xe.scale(j,j));const Se=Ti(u,d,r,w,c);let ct=[];const Rt=b&&((Sn=P.current)==null?void 0:Sn.cell[1])===l&&f===0;let It=!1;if(de!==void 0){for(const Ct of de)if(Ct.style!=="no-outline"&&Ct.range.y===l&&f===0){It=!0;break}}const Ot=()=>{Ic(Oe,Se,m,we,r,c,C,k,w,A,P,h,$e,pe,$,W,Fe,le,Ae),xl(Oe,Se,l,c,f,r,i,void 0,void 0,k,ke,Re,F,$,R,O,h,!0),Oe.beginPath(),Oe.moveTo(0,tt-.5),Oe.lineTo(r,tt-.5),Oe.strokeStyle=tn(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),Oe.stroke(),It&&kl(Oe,r,i,d,l,c,f,u,g,C,k,M,R,O,de,h),Rt&&Si(Oe,r,i,l,c,f,Se,u,h,ke,P,Re,X,R,oe,Y,O)};if(Fe!==void 0){const Ct=Se[Se.length-1].sourceIndex+1,dt=Fe.hasItemInRegion([{x:d,y:-2,width:Ct,height:2},{x:d,y:l,width:Ct,height:300},{x:0,y:l,width:g,height:300},{x:0,y:-2,width:g,height:2},{x:d,y:O-R,width:Ct,height:R,when:R>0}]),Ye=Lt=>{vl(Lt,Se,u,i,ke,c,f,l,O,Re,X,W,F,y,H,b,R,oe,ct,Fe,P,q,de,te,$e,pe,we,he,ne,h,Ve,ce,qe,B,vt);const Jt=P.current;Y!==!1&&Y!==void 0&&b&&Jt!==void 0&&Fe.has(_l(Jt.range))&&Si(Lt,r,i,l,c,f,Se,u,h,ke,P,Re,X,R,oe,Y,O)};dt&&(Ye(Xe),se!==null&&(se.save(),se.scale(j,j),se.textBaseline="middle",Ye(se),se.restore()),Fe.hasHeader()&&(Bc(Oe,Se,r,k,ke,c,f,l,Fe),Ot())),Xe.restore(),Oe.restore();return}if((be!==!0||d!==(Z==null?void 0:Z.cellXOffset)||c!==(Z==null?void 0:Z.translateX)||Rt!==(Z==null?void 0:Z.mustDrawFocusOnHeader)||It!==(Z==null?void 0:Z.mustDrawHighlightRingsOnHeader))&&Ot(),be===!0){en(At!==void 0&&Z!==void 0);const{regions:Ct}=zc(Xe,At,At===Ze?Z.aBufferScroll:Z.bBufferScroll,At===Ze?Z.bBufferScroll:Z.aBufferScroll,Z,d,l,c,f,R,r,i,O,ke,j,u,Se,M,gt);ct=Ct}else be!==!1&&(en(Z!==void 0),ct=Pc(Z,d,l,c,f,r,i,ke,Se,be));Hc(Xe,Se,r,i,R,O,$,Re,h);const Pt=kl(Xe,r,i,d,l,c,f,u,g,C,k,M,R,O,de,h),hn=b?Si(Xe,r,i,l,c,f,Se,u,h,ke,P,Re,X,R,oe,Y,O):void 0;if(Xe.fillStyle=h.bgCell,ct.length>0){Xe.beginPath();for(const Ct of ct)Xe.rect(Ct.x,Ct.y,Ct.width,Ct.height);Xe.clip(),Xe.fill(),Xe.beginPath()}else Xe.fillRect(0,0,r,i);const rn=vl(Xe,Se,u,i,ke,c,f,l,O,Re,X,W,F,y,H,b,R,oe,ct,Fe,P,q,de,te,$e,pe,we,he,ne,h,Ve,ce,qe,B,vt);Tc(Xe,Se,u,r,i,ke,c,f,l,O,Re,F,P.rows,y,R,oe,ct,Fe,h),Ac(Xe,Se,l,c,f,r,i,ct,ke,Re,F,$,R,O,h),xl(Xe,Se,l,c,f,r,i,ct,rn,k,ke,Re,F,$,R,O,h),Pt==null||Pt(),hn==null||hn(),A&&ht!=="none"&&no(Se,0,c,0,ke,(Ct,dt)=>Ct.sourceIndex===ye?(Sl(Oe,dt+Ct.width,0,ke+1,tn(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),ht==="full"&&Sl(Xe,dt+Ct.width,ke,i,tn(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),se!==null&&(se.fillStyle=h.bgCell,se.fillRect(0,0,r,i),se.drawImage(Xe.canvas,0,0));const zt=Wc(Se,i,ke,c,f,l,O,Re,R,oe);te==null||te.setWindow({x:d,y:l,width:Se.length,height:zt-l},g,Array.from({length:R},(Ct,dt)=>O-1-dt));const qt=Z!==void 0&&(d!==Z.cellXOffset||c!==Z.translateX),Gt=Z!==void 0&&(l!==Z.cellYOffset||f!==Z.translateY);K.current={cellXOffset:d,cellYOffset:l,translateX:c,translateY:f,mustDrawFocusOnHeader:Rt,mustDrawHighlightRingsOnHeader:It,lastBuffer:gt?Ht===Ze?"a":"b":void 0,aBufferScroll:Ht===Ze?[qt,Gt]:Z==null?void 0:Z.aBufferScroll,bBufferScroll:Ht===at?[qt,Gt]:Z==null?void 0:Z.bBufferScroll},Xe.restore(),Oe.restore()}const $c=80;function Oc(e){const t=e-1;return t*t*t+1}class Nc{constructor(t){Le(this,"callback");Le(this,"currentHoveredItem");Le(this,"leavingItems",[]);Le(this,"lastAnimationTime");Le(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>ar(o.item,t.item))||this.leavingItems.push(t)});Le(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>ar(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Le(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Le(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Le(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Oc(t.hoverAmount)})));Le(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/$c;for(const i of this.leavingItems)i.hoverAmount=fn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=fn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Le(this,"setHovered",t=>{var n;if(!ar((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Xc{constructor(t){Le(this,"fn");Le(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Yi(e){return new Xc(e)}const Yc=Yi(()=>window.navigator.userAgent.includes("Firefox")),Vr=Yi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),qr=Yi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Gc(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(d),d=()=>{const l=t.current.map(Xi);t.current=[],o.current(new Wo(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:d)},[]);return s.useCallback(i=>{t.current.length===0&&r();const d=kn(i[0],i[1]);t.current.includes(d)||t.current.push(d)},[r])}const to="header",xn="group-header",jr="out-of-bounds";var Bo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Bo||(Bo={}));function hs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const _c=(e,t)=>{if(e.kind===ee.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Kc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:d,cellYOffset:l,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:m,rows:g,getCellContent:w,getRowThemeOverride:h,onHeaderMenuClick:b,onHeaderIndicatorClick:C,enableGroups:k,isFilling:y,onCanvasFocused:M,onCanvasBlur:$,isFocused:B,selection:A,freezeColumns:P,onContextMenu:Y,freezeTrailingRows:R,fixedShadowX:O=!0,fixedShadowY:X=!0,drawFocusRing:W,onMouseDown:F,onMouseUp:H,onMouseMoveRaw:le,onMouseMove:q,onItemHovered:he,dragAndDropState:de,firstColAccessible:ye,onKeyDown:te,onKeyUp:K,highlightRegions:pe,canvasRef:ne,onDragStart:we,onDragEnd:$e,eventTargetRef:V,isResizing:oe,resizeColumn:Ae,isDragging:Ve,isDraggable:ce=!1,allowResize:qe,disabledRows:st,hasAppendRow:Ce,getGroupDetails:ze,theme:Fe,prelightCells:vt,headerIcons:ht,verticalBorder:gt,drawCell:j,drawHeader:be,onCellFocused:xe,onDragOverCell:Ie,onDrop:ke,onDragLeave:tt,imageWindowLoader:Ze,smoothScrollX:at=!1,smoothScrollY:Z=!1,experimental:se,getCellRenderer:Oe,resizeIndicator:Xe="full"}=e,Ht=e.translateX??0,At=e.translateY??0,Re=Math.max(P,Math.min(i.length-1,d)),Se=s.useRef(null),ct=s.useRef((se==null?void 0:se.eventTarget)??window),Rt=ct.current,It=Ze,Ot=s.useRef(),[Pt,hn]=s.useState(!1),rn=s.useRef([]),zt=s.useRef(),[qt,Gt]=s.useState(),[Sn,Ct]=s.useState(),dt=s.useRef(null),[Ye,Lt]=s.useState(),[Jt,Mn]=s.useState(!1),zn=s.useRef(Jt);zn.current=Jt;const Kt=s.useMemo(()=>new Cc(ht,()=>{yo.current=void 0,oo.current()}),[ht]),gn=k?u+c:c,Ee=s.useRef(-1),Qe=((se==null?void 0:se.enableFirefoxRescaling)??!1)&&Yc.value,Je=((se==null?void 0:se.enableSafariRescaling)??!1)&&Vr.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!Qe&&!Je||(Ee.current!==-1&&hn(!0),window.clearTimeout(Ee.current),Ee.current=window.setTimeout(()=>{hn(!1),Ee.current=-1},200))},[l,Re,Ht,At,Qe,Je]);const _e=Ma(i,P),Nt=s.useMemo(()=>O?No(_e,de):0,[_e,de,O]),Ge=s.useCallback((E,_,ue)=>{const x=E.getBoundingClientRect();if(_>=_e.length||ue>=g)return;const U=x.width/n,Q=Hi(_,ue,n,o,u,gn,Re,l,Ht,At,g,P,R,_e,m);return U!==1&&(Q.x*=U,Q.y*=U,Q.width*=U,Q.height*=U),Q.x+=x.x,Q.y+=x.y,Q},[n,o,u,gn,Re,l,Ht,At,g,P,R,_e,m]),Ke=s.useCallback((E,_,ue,x)=>{const U=E.getBoundingClientRect(),Q=U.width/n,Te=(_-U.left)/Q,Ue=(ue-U.top)/Q,fe=5,ot=Ti(_e,Re,n,void 0,Ht);let ge=0,rt=0;const bt=typeof PointerEvent<"u"&&x instanceof PointerEvent&&x.pointerType==="mouse"||typeof MouseEvent<"u"&&x instanceof MouseEvent,mt=typeof PointerEvent<"u"&&x instanceof PointerEvent&&x.pointerType==="touch"||typeof TouchEvent<"u"&&x instanceof TouchEvent;bt&&(ge=x.button,rt=x.buttons);const yt=Da(Te,ot,Ht),ut=Fa(Ue,o,k,c,u,g,m,l,At,R),je=(x==null?void 0:x.shiftKey)===!0,Mt=(x==null?void 0:x.ctrlKey)===!0,wt=(x==null?void 0:x.metaKey)===!0,pt=[Te<0?-1:n<Te?1:0,Ue<gn?-1:o<Ue?1:0];let an;if(yt===-1||Ue<0||Te<0||ut===void 0||Te>n||Ue>o){const ft=Te>n?1:Te<0?-1:0,yn=Ue>o?1:Ue<0?-1:0;let xt=ft*2,Yt=yn*2;ft===0&&(xt=yt===-1?Bo.EndPadding:Bo.Center),yn===0&&(Yt=ut===void 0?Bo.EndPadding:Bo.Center);let Xn=!1;if(yt===-1&&ut===-1){const cn=Ge(E,_e.length-1,-1);en(cn!==void 0),Xn=_<cn.x+cn.width+fe}const Yn=Te>n&&Te<n+Fi()||Ue>o&&Ue<o+Fi();an={kind:jr,location:[yt!==-1?yt:Te<0?0:_e.length-1,ut??g-1],region:[xt,Yt],shiftKey:je,ctrlKey:Mt,metaKey:wt,isEdge:Xn,isTouch:mt,button:ge,buttons:rt,scrollEdge:pt,isMaybeScrollbar:Yn}}else if(ut<=-1){let ft=Ge(E,yt,ut);en(ft!==void 0);let yn=ft!==void 0&&ft.x+ft.width-_<=fe;const xt=yt-1;_-ft.x<=fe&&xt>=0?(yn=!0,ft=Ge(E,xt,ut),en(ft!==void 0),an={kind:k&&ut===-2?xn:to,location:[xt,ut],bounds:ft,group:_e[xt].group??"",isEdge:yn,shiftKey:je,ctrlKey:Mt,metaKey:wt,isTouch:mt,localEventX:_-ft.x,localEventY:ue-ft.y,button:ge,buttons:rt,scrollEdge:pt}):an={kind:k&&ut===-2?xn:to,group:_e[yt].group??"",location:[yt,ut],bounds:ft,isEdge:yn,shiftKey:je,ctrlKey:Mt,metaKey:wt,isTouch:mt,localEventX:_-ft.x,localEventY:ue-ft.y,button:ge,buttons:rt,scrollEdge:pt}}else{const ft=Ge(E,yt,ut);en(ft!==void 0);const yn=ft!==void 0&&ft.x+ft.width-_<fe;let xt=!1;if(f!==!1&&f!==void 0&&A.current!==void 0){const Xn=typeof f=="object"?{...Kr,...f}:Kr,Yn=Xn.size,cn=Yn/2,jo=_l(A.current.range),Vn=Ge(E,jo[0],jo[1]);if(Vn!==void 0){const Ne=Vn.x+Vn.width+Xn.offsetX-cn+.5,Ut=Vn.y+Vn.height+Xn.offsetY-cn+.5;xt=Math.abs(Ne-_)<Yn&&Math.abs(Ut-ue)<Yn}}an={kind:"cell",location:[yt,ut],bounds:ft,isEdge:yn,shiftKey:je,ctrlKey:Mt,isFillHandle:xt,metaKey:wt,isTouch:mt,localEventX:_-ft.x,localEventY:ue-ft.y,button:ge,buttons:rt,scrollEdge:pt}}return an},[n,_e,Re,Ht,o,k,c,u,g,m,l,At,R,Ge,f,A,gn]),[Pn]=qt??[],gr=s.useRef(()=>{}),Kn=s.useRef(qt);Kn.current=qt;const[Ln,Bn]=s.useMemo(()=>{const E=document.createElement("canvas"),_=document.createElement("canvas");return E.style.display="none",E.style.opacity="0",E.style.position="fixed",_.style.display="none",_.style.opacity="0",_.style.position="fixed",[E.getContext("2d",{alpha:!1}),_.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Ln===null||Bn===null))return document.documentElement.append(Ln.canvas),document.documentElement.append(Bn.canvas),()=>{Ln.canvas.remove(),Bn.canvas.remove()}},[Ln,Bn]);const bo=s.useMemo(()=>new $a,[]),mr=Qe&&Pt?1:Je&&Pt?2:5,Wn=(se==null?void 0:se.disableMinimumCellWidth)===!0?1:10,yo=s.useRef(),po=s.useRef(null),vo=s.useRef(null),Co=s.useCallback(()=>{var Te;const E=Se.current,_=dt.current;if(E===null||_===null||(po.current===null&&(po.current=E.getContext("2d",{alpha:!1}),E.width=0,E.height=0),vo.current===null&&(vo.current=_.getContext("2d",{alpha:!1}),_.width=0,_.height=0),po.current===null||vo.current===null||Ln===null||Bn===null))return;let ue=!1;const x=Ue=>{ue=!0,Lt(Ue)},U=yo.current,Q={headerCanvasCtx:vo.current,canvasCtx:po.current,bufferACtx:Ln,bufferBCtx:Bn,width:n,height:o,cellXOffset:Re,cellYOffset:l,translateX:Math.round(Ht),translateY:Math.round(At),mappedColumns:_e,enableGroups:k,freezeColumns:P,dragAndDropState:de,theme:Fe,headerHeight:c,groupHeaderHeight:u,disabledRows:st??et.empty(),rowHeight:m,verticalBorder:gt,isResizing:oe,resizeCol:Ae,isFocused:B,selection:A,fillHandle:f,drawCellCallback:j,hasAppendRow:Ce,overrideCursor:x,maxScaleFactor:mr,freezeTrailingRows:R,rows:g,drawFocus:W,getCellContent:w,getGroupDetails:ze??(Ue=>({name:Ue})),getRowThemeOverride:h,drawHeaderCallback:be,prelightCells:vt,highlightRegions:pe,imageLoader:It,lastBlitData:zt,damage:Ot.current,hoverValues:rn.current,hoverInfo:Kn.current,spriteManager:Kt,scrolling:Pt,hyperWrapping:(se==null?void 0:se.hyperWrapping)??!1,touchMode:Jt,enqueue:gr.current,renderStateProvider:bo,renderStrategy:(se==null?void 0:se.renderStrategy)??(Vr.value?"double-buffer":"single-buffer"),getCellRenderer:Oe,minimumCellWidth:Wn,resizeIndicator:Xe};Q.damage===void 0?(yo.current=Q,Ml(Q,U)):Ml(Q,void 0),!ue&&(Q.damage===void 0||Q.damage.has((Te=Kn==null?void 0:Kn.current)==null?void 0:Te[0]))&&Lt(void 0)},[Ln,Bn,n,o,Re,l,Ht,At,_e,k,P,de,Fe,c,u,st,m,gt,oe,Ce,Ae,B,A,f,R,g,W,mr,w,ze,h,j,be,vt,pe,It,Kt,Pt,se==null?void 0:se.hyperWrapping,se==null?void 0:se.renderStrategy,Jt,bo,Oe,Wn,Xe]),oo=s.useRef(Co);s.useLayoutEffect(()=>{Co(),oo.current=Co},[Co]),s.useLayoutEffect(()=>{(async()=>{var _;((_=document==null?void 0:document.fonts)==null?void 0:_.ready)!==void 0&&(await document.fonts.ready,yo.current=void 0,oo.current())})()},[]);const $n=s.useCallback(E=>{Ot.current=E,oo.current(),Ot.current=void 0},[]),Qr=Gc($n);gr.current=Qr;const wr=s.useCallback(E=>{$n(new Wo(E.map(_=>_.cell)))},[$n]);It.setCallback($n);const[ei,ti]=s.useState(!1),[Rn,Un]=Pn??[],ni=Rn!==void 0&&Un===-1&&Rn>=0&&Rn<_e.length&&_e[Rn].headerRowMarkerDisabled!==!0,oi=Rn!==void 0&&Un===-2;let xo=!1,br=!1,ro=Ye;if(ro===void 0&&Rn!==void 0&&Un!==void 0&&Un>-1&&Un<g){const E=w([Rn,Un],!0);xo=E.kind===nn.NewRow||E.kind===nn.Marker&&E.markerKind!=="number",br=E.kind===ee.Boolean&&Bi(E),ro=E.cursor}const yr=Ve?"grabbing":(Sn??!1)||oe?"col-resize":ei||y?"crosshair":ro!==void 0?ro:ni||xo||br||oi?"pointer":"default",En=s.useMemo(()=>({contain:"strict",display:"block",cursor:yr}),[yr]),Yo=s.useRef("default"),nt=V==null?void 0:V.current;nt!=null&&Yo.current!==En.cursor&&(nt.style.cursor=Yo.current=En.cursor);const ko=s.useCallback((E,_,ue,x)=>{if(ze===void 0)return;const U=ze(E);if(U.actions!==void 0){const Q=cs(_,U.actions);for(const[Te,Ue]of Q.entries())if(go(Ue,ue+_.x,x+Ue.y))return U.actions[Te]}},[ze]),mn=s.useCallback((E,_,ue,x)=>{const U=_e[_];if(!Ve&&!oe&&!(Sn??!1)){const Q=Ge(E,_,-1);en(Q!==void 0);const Te=ds(void 0,U,Q.x,Q.y,Q.width,Q.height,Fe,$i(U.title)==="rtl");if(U.hasMenu===!0&&Te.menuBounds!==void 0&&go(Te.menuBounds,ue,x))return{area:"menu",bounds:Te.menuBounds};if(U.indicatorIcon!==void 0&&Te.indicatorIconBounds!==void 0&&go(Te.indicatorIconBounds,ue,x))return{area:"indicator",bounds:Te.indicatorIconBounds}}},[_e,Ge,Sn,Ve,oe,Fe]),jt=s.useRef(0),Xt=s.useRef(),Go=s.useRef(!1),_o=s.useCallback(E=>{const _=Se.current,ue=V==null?void 0:V.current;if(_===null||E.target!==_&&E.target!==ue)return;Go.current=!0;const x=E.clientX,U=E.clientY;if(E.target===ue&&ue!==null){const Te=ue.getBoundingClientRect();if(x>Te.right||U>Te.bottom)return}const Q=Ke(_,x,U,E);Xt.current=Q.location,Q.isTouch&&(jt.current=Date.now()),zn.current!==Q.isTouch&&Mn(Q.isTouch),!(Q.kind===to&&mn(_,Q.location[0],x,U)!==void 0)&&(Q.kind===xn&&ko(Q.group,Q.bounds,Q.localEventX,Q.localEventY)!==void 0||(F==null||F(Q),!Q.isTouch&&ce!==!0&&ce!==Q.kind&&Q.button<3&&Q.button!==1&&E.preventDefault()))},[V,ce,Ke,ko,mn,F]);Vt("pointerdown",_o,Rt,!1);const So=s.useRef(0),Ko=s.useCallback(E=>{var rt,bt;const _=So.current;So.current=Date.now();const ue=Se.current;if(Go.current=!1,H===void 0||ue===null)return;const x=V==null?void 0:V.current,U=E.target!==ue&&E.target!==x,Q=E.clientX,Te=E.clientY,Ue=E.pointerType==="mouse"?E.button<3:!0;let fe=Ke(ue,Q,Te,E);fe.isTouch&&jt.current!==0&&Date.now()-jt.current>500&&(fe={...fe,isLongTouch:!0}),_!==0&&Date.now()-_<(fe.isTouch?1e3:500)&&(fe={...fe,isDoubleClick:!0}),zn.current!==fe.isTouch&&Mn(fe.isTouch),!U&&E.cancelable&&Ue&&E.preventDefault();const[ot]=fe.location,ge=mn(ue,ot,Q,Te);if(fe.kind===to&&ge!==void 0){(fe.button!==0||((rt=Xt.current)==null?void 0:rt[0])!==ot||((bt=Xt.current)==null?void 0:bt[1])!==-1)&&H(fe,!0);return}else if(fe.kind===xn){const mt=ko(fe.group,fe.bounds,fe.localEventX,fe.localEventY);if(mt!==void 0){fe.button===0&&mt.onClick(fe);return}}H(fe,U)},[H,V,Ke,mn,ko]);Vt("pointerup",Ko,Rt,!1);const pr=s.useCallback(E=>{var ot,ge;const _=Se.current;if(_===null)return;const ue=V==null?void 0:V.current,x=E.target!==_&&E.target!==ue;let U,Q,Te=!0;E instanceof MouseEvent?(U=E.clientX,Q=E.clientY,Te=E.button<3):(U=E.changedTouches[0].clientX,Q=E.changedTouches[0].clientY);const Ue=Ke(_,U,Q,E);zn.current!==Ue.isTouch&&Mn(Ue.isTouch),!x&&E.cancelable&&Te&&E.preventDefault();const[fe]=Ue.location;if(Ue.kind===to){const rt=mn(_,fe,U,Q);rt!==void 0&&Ue.button===0&&((ot=Xt.current)==null?void 0:ot[0])===fe&&((ge=Xt.current)==null?void 0:ge[1])===-1&&(rt.area==="menu"?b==null||b(fe,rt.bounds):rt.area==="indicator"&&(C==null||C(fe,rt.bounds)))}},[V,Ke,mn,b,C]);Vt("click",pr,Rt,!1);const Mo=s.useCallback(E=>{const _=Se.current,ue=V==null?void 0:V.current;if(_===null||E.target!==_&&E.target!==ue||Y===void 0)return;const x=Ke(_,E.clientX,E.clientY,E);Y(x,()=>{E.cancelable&&E.preventDefault()})},[V,Ke,Y]);Vt("contextmenu",Mo,(V==null?void 0:V.current)??null,!1);const On=s.useCallback(E=>{Ot.current=new Wo(E.map(_=>_.item)),rn.current=E,oo.current(),Ot.current=void 0},[]),Nn=s.useMemo(()=>new Nc(On),[On]),io=s.useRef(Nn);io.current=Nn,s.useLayoutEffect(()=>{const E=io.current;if(Pn===void 0||Pn[1]<0){E.setHovered(Pn);return}const _=w(Pn,!0),ue=Oe(_),x=ue===void 0&&_.kind===ee.Custom||(ue==null?void 0:ue.needsHover)!==void 0&&(typeof ue.needsHover=="boolean"?ue.needsHover:ue.needsHover(_));E.setHovered(x?Pn:void 0)},[w,Oe,Pn]);const vr=s.useRef(),Cr=s.useCallback(E=>{var Ue;const _=Se.current;if(_===null)return;const ue=V==null?void 0:V.current,x=E.target!==_&&E.target!==ue,U=Ke(_,E.clientX,E.clientY,E);if(U.kind!=="out-of-bounds"&&x&&!Go.current&&!U.isTouch)return;const Q=(fe,ot)=>{Gt(ge=>ge===fe||(ge==null?void 0:ge[0][0])===(fe==null?void 0:fe[0][0])&&(ge==null?void 0:ge[0][1])===(fe==null?void 0:fe[0][1])&&((ge==null?void 0:ge[1][0])===(fe==null?void 0:fe[1][0])&&(ge==null?void 0:ge[1][1])===(fe==null?void 0:fe[1][1])||!ot)?ge:fe)};if(!hs(U,vr.current))Lt(void 0),he==null||he(U),Q(U.kind===jr?void 0:[U.location,[U.localEventX,U.localEventY]],!0),vr.current=U;else if(U.kind==="cell"||U.kind===to||U.kind===xn){let fe=!1,ot=!0;if(U.kind==="cell"){const rt=w(U.location);ot=((Ue=Oe(rt))==null?void 0:Ue.needsHoverPosition)??rt.kind===ee.Custom,fe=ot}else fe=!0;const ge=[U.location,[U.localEventX,U.localEventY]];Q(ge,ot),Kn.current=ge,fe&&$n(new Wo([U.location]))}const Te=U.location[0]>=(ye?0:1);Ct(U.kind===to&&U.isEdge&&Te&&qe===!0),ti(U.kind==="cell"&&U.isFillHandle),le==null||le(E),q(U)},[V,Ke,ye,qe,le,q,he,w,Oe,$n]);Vt("pointermove",Cr,Rt,!0);const Me=s.useCallback(E=>{const _=Se.current;if(_===null)return;let ue,x;A.current!==void 0&&(ue=Ge(_,A.current.cell[0],A.current.cell[1]),x=A.current.cell),te==null||te({bounds:ue,stopPropagation:()=>E.stopPropagation(),preventDefault:()=>E.preventDefault(),cancel:()=>{},ctrlKey:E.ctrlKey,metaKey:E.metaKey,shiftKey:E.shiftKey,altKey:E.altKey,key:E.key,keyCode:E.keyCode,rawEvent:E,location:x})},[te,A,Ge]),Uo=s.useCallback(E=>{const _=Se.current;if(_===null)return;let ue,x;A.current!==void 0&&(ue=Ge(_,A.current.cell[0],A.current.cell[1]),x=A.current.cell),K==null||K({bounds:ue,stopPropagation:()=>E.stopPropagation(),preventDefault:()=>E.preventDefault(),cancel:()=>{},ctrlKey:E.ctrlKey,metaKey:E.metaKey,shiftKey:E.shiftKey,altKey:E.altKey,key:E.key,keyCode:E.keyCode,rawEvent:E,location:x})},[K,A,Ge]),ii=s.useCallback(E=>{if(Se.current=E,ne!==void 0&&(ne.current=E),se!=null&&se.eventTarget)ct.current=se.eventTarget;else if(E===null)ct.current=window;else{const _=E.getRootNode();_===document&&(ct.current=window),ct.current=_}},[ne,se==null?void 0:se.eventTarget]),wn=s.useCallback(E=>{const _=Se.current;if(_===null||ce===!1||oe){E.preventDefault();return}let ue,x;const U=Ke(_,E.clientX,E.clientY);if(ce!==!0&&U.kind!==ce){E.preventDefault();return}const Q=(rt,bt)=>{ue=rt,x=bt};let Te,Ue,fe;const ot=(rt,bt,mt)=>{Te=rt,Ue=bt,fe=mt};let ge=!1;if(we==null||we({...U,setData:Q,setDragImage:ot,preventDefault:()=>ge=!0,defaultPrevented:()=>ge}),!ge&&ue!==void 0&&x!==void 0&&E.dataTransfer!==null)if(E.dataTransfer.setData(ue,x),E.dataTransfer.effectAllowed="copyLink",Te!==void 0&&Ue!==void 0&&fe!==void 0)E.dataTransfer.setDragImage(Te,Ue,fe);else{const[rt,bt]=U.location;if(bt!==void 0){const mt=document.createElement("canvas"),yt=Ge(_,rt,bt);en(yt!==void 0);const ut=Math.ceil(window.devicePixelRatio??1);mt.width=yt.width*ut,mt.height=yt.height*ut;const je=mt.getContext("2d");je!==null&&(je.scale(ut,ut),je.textBaseline="middle",bt===-1?(je.font=Fe.headerFontFull,je.fillStyle=Fe.bgHeader,je.fillRect(0,0,mt.width,mt.height),us(je,0,0,yt.width,yt.height,_e[rt],!1,Fe,!1,void 0,void 0,!1,0,Kt,be,!1)):(je.font=Fe.baseFontFull,je.fillStyle=Fe.bgCell,je.fillRect(0,0,mt.width,mt.height),as(je,w([rt,bt]),0,bt,!1,!1,0,0,yt.width,yt.height,!1,Fe,Fe.bgCell,It,Kt,1,void 0,!1,0,void 0,void 0,void 0,bo,Oe,()=>{},0))),mt.style.left="-100%",mt.style.position="absolute",mt.style.width=`${yt.width}px`,mt.style.height=`${yt.height}px`,document.body.append(mt),E.dataTransfer.setDragImage(mt,yt.width/2,yt.height/2),window.setTimeout(()=>{mt.remove()},0)}}else E.preventDefault()},[ce,oe,Ke,we,Ge,Fe,_e,Kt,be,w,It,bo,Oe]);Vt("dragstart",wn,(V==null?void 0:V.current)??null,!1,!1);const Vo=s.useRef(),In=s.useCallback(E=>{const _=Se.current;if(ke!==void 0&&E.preventDefault(),_===null||Ie===void 0)return;const ue=Ke(_,E.clientX,E.clientY),[x,U]=ue.location,Q=x-(ye?0:1),[Te,Ue]=Vo.current??[];(Te!==Q||Ue!==U)&&(Vo.current=[Q,U],Ie([Q,U],E.dataTransfer))},[ye,Ke,Ie,ke]);Vt("dragover",In,(V==null?void 0:V.current)??null,!1,!1);const qo=s.useCallback(()=>{Vo.current=void 0,$e==null||$e()},[$e]);Vt("dragend",qo,(V==null?void 0:V.current)??null,!1,!1);const xr=s.useCallback(E=>{const _=Se.current;if(_===null||ke===void 0)return;E.preventDefault();const ue=Ke(_,E.clientX,E.clientY),[x,U]=ue.location,Q=x-(ye?0:1);ke([Q,U],E.dataTransfer)},[ye,Ke,ke]);Vt("drop",xr,(V==null?void 0:V.current)??null,!1,!1);const kr=s.useCallback(()=>{tt==null||tt()},[tt]);Vt("dragleave",kr,(V==null?void 0:V.current)??null,!1,!1);const Sr=s.useRef(A);Sr.current=A;const Ro=s.useRef(null),ln=s.useCallback(E=>{var _;Se.current===null||!Se.current.contains(document.activeElement)||(E===null&&Sr.current.current!==void 0?(_=ne==null?void 0:ne.current)==null||_.focus({preventScroll:!0}):E!==null&&E.focus({preventScroll:!0}),Ro.current=E)},[ne]);s.useImperativeHandle(t,()=>({focus:()=>{var _;const E=Ro.current;E===null||!document.contains(E)?(_=ne==null?void 0:ne.current)==null||_.focus({preventScroll:!0}):E.focus({preventScroll:!0})},getBounds:(E,_)=>{if(!(ne===void 0||ne.current===null))return Ge(ne.current,E??0,_??-1)},damage:wr,getMouseArgsForPosition:(E,_,ue)=>{if(!(ne===void 0||ne.current===null))return Ke(ne.current,E,_,ue)}}),[ne,wr,Ge,Ke]);const bn=s.useRef(),sn=fa(()=>{var Ue,fe,ot;if(n<50||(se==null?void 0:se.disableAccessibilityTree)===!0)return null;let E=Ti(_e,Re,n,de,Ht);const _=ye?0:-1;!ye&&((Ue=E[0])==null?void 0:Ue.sourceIndex)===0&&(E=E.slice(1));const[ue,x]=((fe=A.current)==null?void 0:fe.cell)??[],U=(ot=A.current)==null?void 0:ot.range,Q=E.map(ge=>ge.sourceIndex),Te=ho(l,Math.min(g,l+r));return ue!==void 0&&x!==void 0&&!(Q.includes(ue)&&Te.includes(x))&&ln(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":g+1,"aria-multiselectable":"true","aria-colcount":_e.length+_},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},E.map(ge=>s.createElement("th",{role:"columnheader","aria-selected":A.columns.hasIndex(ge.sourceIndex),"aria-colindex":ge.sourceIndex+1+_,tabIndex:-1,onFocus:rt=>{if(rt.target!==Ro.current)return xe==null?void 0:xe([ge.sourceIndex,-1])},key:ge.sourceIndex},ge.title)))),s.createElement("tbody",{role:"rowgroup"},Te.map(ge=>s.createElement("tr",{role:"row","aria-selected":A.rows.hasIndex(ge),key:ge,"aria-rowindex":ge+2},E.map(rt=>{const bt=rt.sourceIndex,mt=kn(bt,ge),yt=ue===bt&&x===ge,ut=U!==void 0&&bt>=U.x&&bt<U.x+U.width&&ge>=U.y&&ge<U.y+U.height,je=`glide-cell-${bt}-${ge}`,Mt=[bt,ge],wt=w(Mt,!0);return s.createElement("td",{key:mt,role:"gridcell","aria-colindex":bt+1+_,"aria-selected":ut,"aria-readonly":Lo(wt)||!Po(wt),id:je,"data-testid":je,onClick:()=>{const pt=ne==null?void 0:ne.current;if(pt!=null)return te==null?void 0:te({bounds:Ge(pt,bt,ge),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:Mt})},onFocusCapture:pt=>{var an,ft;if(!(pt.target===Ro.current||((an=bn.current)==null?void 0:an[0])===bt&&((ft=bn.current)==null?void 0:ft[1])===ge))return bn.current=Mt,xe==null?void 0:xe(Mt)},ref:yt?ln:void 0,tabIndex:-1},_c(wt,Oe))})))))},[n,_e,Re,de,Ht,g,l,r,A,ln,w,ne,te,Ge,xe],200),D=P===0||!O?0:Re>P?1:fn(-Ht/100,0,1),Dt=-l*32+At,Dn=X?fn(-Dt/100,0,1):0,li=s.useMemo(()=>{if(!D&&!Dn)return null;const E={position:"absolute",top:0,left:Nt,width:n-Nt,height:o,opacity:D,pointerEvents:"none",transition:at?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},_={position:"absolute",top:gn,left:0,width:n,height:o,opacity:Dn,pointerEvents:"none",transition:Z?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,D>0&&s.createElement("div",{id:"shadow-x",style:E}),Dn>0&&s.createElement("div",{id:"shadow-y",style:_}))},[D,Dn,Nt,n,at,gn,o,Z]),Mr=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Me,onKeyUp:Uo,onFocus:M,onBlur:$,ref:ii,style:En},sn),s.createElement("canvas",{ref:dt,style:Mr}),li)},Uc=s.memo(s.forwardRef(Kc));function sr(e,t,n,o){return fn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Vc=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,d]=s.useState(),[l,c]=s.useState(),[f,u]=s.useState(!1),[m,g]=s.useState(),[w,h]=s.useState(),[b,C]=s.useState(),[k,y]=s.useState(!1),[M,$]=s.useState(),{onHeaderMenuClick:B,onHeaderIndicatorClick:A,getCellContent:P,onColumnMoved:Y,onColumnResize:R,onColumnResizeStart:O,onColumnResizeEnd:X,gridRef:W,maxColumnWidth:F,minColumnWidth:H,onRowMoved:le,lockColumns:q,onColumnProposeMove:he,onMouseDown:de,onMouseUp:ye,onItemHovered:te,onDragStart:K,canvasRef:pe}=e,ne=(R??X??O)!==void 0,{columns:we,selection:$e}=e,V=$e.columns,oe=s.useCallback(j=>{const[be,xe]=j.location;i!==void 0&&l!==be&&be>=q?(u(!0),c(be)):w!==void 0&&xe!==void 0?(y(!0),C(Math.max(0,xe))):o===void 0&&!f&&!k&&(te==null||te(j))},[i,w,l,te,q,o,f,k]),Ae=Y!==void 0,Ve=s.useCallback(j=>{var be;if(j.button===0){const[xe,Ie]=j.location;if(j.kind==="out-of-bounds"&&j.isEdge&&ne){const ke=(be=W==null?void 0:W.current)==null?void 0:be.getBounds(we.length-1,-1);ke!==void 0&&(n(ke.x),r(we.length-1))}else if(j.kind==="header"&&xe>=q){const ke=pe==null?void 0:pe.current;if(j.isEdge&&ne&&ke){n(j.bounds.x),r(xe);const Ze=ke.getBoundingClientRect().width/ke.offsetWidth,at=j.bounds.width/Ze;O==null||O(we[xe],at,xe,at+(we[xe].growOffset??0))}else j.kind==="header"&&Ae&&(g(j.bounds.x),d(xe))}else j.kind==="cell"&&q>0&&xe===0&&Ie!==void 0&&le!==void 0&&($(j.bounds.y),h(Ie))}de==null||de(j)},[de,ne,q,le,W,we,Ae,O,pe]),ce=s.useCallback((j,be)=>{f||k||B==null||B(j,be)},[f,k,B]),qe=s.useCallback((j,be)=>{f||k||A==null||A(j,be)},[f,k,A]),st=s.useRef(-1),Ce=s.useCallback(()=>{st.current=-1,h(void 0),C(void 0),$(void 0),y(!1),d(void 0),c(void 0),g(void 0),u(!1),r(void 0),n(void 0)},[]),ze=s.useCallback((j,be)=>{if(j.button===0){if(o!==void 0){if((V==null?void 0:V.hasIndex(o))===!0)for(const Ie of V){if(Ie===o)continue;const ke=we[Ie],tt=sr(ke,st.current,H,F);R==null||R(ke,tt,Ie,tt+(ke.growOffset??0))}const xe=sr(we[o],st.current,H,F);if(X==null||X(we[o],xe,o,xe+(we[o].growOffset??0)),V.hasIndex(o))for(const Ie of V){if(Ie===o)continue;const ke=we[Ie],tt=sr(ke,st.current,H,F);X==null||X(ke,tt,Ie,tt+(ke.growOffset??0))}}Ce(),i!==void 0&&l!==void 0&&(he==null?void 0:he(i,l))!==!1&&(Y==null||Y(i,l)),w!==void 0&&b!==void 0&&(le==null||le(w,b))}ye==null||ye(j,be)},[ye,o,i,l,w,b,V,X,we,H,F,R,Y,le,Ce,he]),Fe=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(he==null?void 0:he(i,l))!==!1)return{src:i,dest:l}},[i,l,he]),vt=s.useCallback(j=>{const be=pe==null?void 0:pe.current;if(i!==void 0&&m!==void 0)Math.abs(j.clientX-m)>20&&u(!0);else if(w!==void 0&&M!==void 0)Math.abs(j.clientY-M)>20&&y(!0);else if(o!==void 0&&t!==void 0&&be){const Ie=be.getBoundingClientRect().width/be.offsetWidth,ke=(j.clientX-t)/Ie,tt=we[o],Ze=sr(tt,ke,H,F);if(R==null||R(tt,Ze,o,Ze+(tt.growOffset??0)),st.current=ke,(V==null?void 0:V.first())===o)for(const at of V){if(at===o)continue;const Z=we[at],se=sr(Z,st.current,H,F);R==null||R(Z,se,at,se+(Z.growOffset??0))}}},[i,m,w,M,o,t,we,H,F,R,V,pe]),ht=s.useCallback((j,be)=>{if(w===void 0||b===void 0)return P(j,be);let[xe,Ie]=j;return Ie===b?Ie=w:(Ie>b&&(Ie-=1),Ie>=w&&(Ie+=1)),P([xe,Ie],be)},[w,b,P]),gt=s.useCallback(j=>{K==null||K(j),j.defaultPrevented()||Ce()},[Ce,K]);return s.createElement(Uc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:ht,isResizing:o!==void 0,onHeaderMenuClick:ce,onHeaderIndicatorClick:qe,isDragging:f,onItemHovered:oe,onDragStart:gt,onMouseDown:Ve,allowResize:ne,onMouseUp:ze,dragAndDropState:Fe,onMouseMoveRaw:vt,ref:W})};function qc(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=d=>{for(const l of d){const{width:c,height:f}=l&&l.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const jc=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),d=s.useRef(0),l=s.useRef(t);l.current=t;const c=n.current;s.useEffect(()=>{const f=()=>{var g,w;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((g=i.current)==null?void 0:g[0])===h[0]&&((w=i.current)==null?void 0:w[1])===h[1])if(d.current>10){i.current=null,r.current=null;return}else d.current++;else d.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},m=g=>{g.touches.length===0&&(r.current=!1,d.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const g=c;return g.addEventListener("touchstart",u),g.addEventListener("touchend",m),()=>{g.removeEventListener("touchstart",u),g.removeEventListener("touchend",m),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Zc=()=>e=>e.isSafari?"scroll":"auto",Jc=on("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Zc()]}}),Qc=33554400,ed=5e6;function td(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Vt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Vt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const nd=e=>{var $e,V;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:d,className:l,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:m,rightElementProps:g,kineticScrollPerfHack:w=!1,scrollRef:h,initialSize:b}=e,C=[],k=(g==null?void 0:g.sticky)??!1,y=(g==null?void 0:g.fill)??!1,M=s.useRef(0),$=s.useRef(0),B=s.useRef(null),A=typeof window>"u"?1:window.devicePixelRatio,P=s.useRef(A);s.useEffect(()=>{if(P.current!==A){M.current=0,$.current=0,P.current=A;const oe=B.current;oe!==null&&le.current(oe.scrollLeft,oe.scrollTop)}},[A]);const Y=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),R=s.useRef(null),O=td(200),[X,W]=s.useState(!0),F=s.useRef(0);s.useLayoutEffect(()=>{if(!X||O||Y.current.lockDirection===void 0)return;const oe=B.current;if(oe===null)return;const[Ae,Ve]=Y.current.lockDirection;Ae!==void 0?oe.scrollLeft=Ae:Ve!==void 0&&(oe.scrollTop=Ve),Y.current.lockDirection=void 0},[O,X]);const H=s.useCallback((oe,Ae)=>{var xe;const Ve=B.current;if(Ve===null)return;Ae=Ae??Ve.scrollTop,oe=oe??Ve.scrollLeft;const ce=Y.current.scrollTop,qe=Y.current.scrollLeft,st=oe-qe,Ce=Ae-ce;O&&st!==0&&Ce!==0&&(Math.abs(st)>3||Math.abs(Ce)>3)&&c&&Y.current.lockDirection===void 0&&(Y.current.lockDirection=Math.abs(st)<Math.abs(Ce)?[qe,void 0]:[void 0,ce]);const ze=Y.current.lockDirection;oe=(ze==null?void 0:ze[0])??oe,Ae=(ze==null?void 0:ze[1])??Ae,Y.current.scrollLeft=oe,Y.current.scrollTop=Ae;const Fe=Ve.clientWidth,vt=Ve.clientHeight,ht=Ae,gt=$.current-ht,j=Ve.scrollHeight-vt;$.current=ht;let be;if(j>0&&o>Ve.scrollHeight+5)if(Math.abs(gt)>2e3||ht===0||ht===j){const Ie=Math.max(0,Math.min(1,ht/j)),ke=o-vt;be=Ie*ke,M.current=be}else M.current-=gt,be=M.current;else be=ht,M.current=be;be=Math.max(0,Math.min(be,o-vt)),M.current=be,ze!==void 0&&(window.clearTimeout(F.current),W(!1),F.current=window.setTimeout(()=>W(!0),200)),i({x:oe,y:be,width:Fe-u,height:vt-f,paddingRight:((xe=R.current)==null?void 0:xe.clientWidth)??0})},[f,u,o,i,c,O]);jc(w&&Vr.value,H,B);const le=s.useRef(H);le.current=H;const q=s.useRef(),he=s.useRef(!1);s.useLayoutEffect(()=>{he.current?H():he.current=!0},[H,f,u]);const de=s.useCallback(oe=>{B.current=oe,h!==void 0&&(h.current=oe)},[h]);let ye=0,te=0;const K=Math.min(o,Qc);for(C.push(s.createElement("div",{key:ye++,style:{width:r,height:0}}));te<K;){const oe=Math.min(ed,K-te);C.push(s.createElement("div",{key:ye++,style:{width:0,height:oe}})),te+=oe}const{ref:pe,width:ne,height:we}=qc(b);return typeof window<"u"&&((($e=q.current)==null?void 0:$e.height)!==we||((V=q.current)==null?void 0:V.width)!==ne)&&(window.setTimeout(()=>le.current(),0),q.current={width:ne,height:we}),(ne??0)===0||(we??0)===0?s.createElement("div",{ref:pe}):s.createElement("div",{ref:pe},s.createElement(Jc,{isSafari:Vr.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:de,style:q.current,draggable:d,onDragStart:oe=>{d||(oe.stopPropagation(),oe.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>H()},s.createElement("div",{className:"dvn-scroll-inner"+(m===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},C),m!==void 0&&s.createElement(s.Fragment,null,!y&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:R,style:{height:we,maxHeight:n-Math.ceil(A%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:y?1:void 0,right:k?u??0:void 0,pointerEvents:"auto"}},m))))))},od=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:d,freezeColumns:l,experimental:c,nonGrowWidth:f,clientSize:u,className:m,onVisibleRegionChanged:g,scrollRef:w,preventDiagonalScrolling:h,rightElement:b,rightElementProps:C,overscrollX:k,overscrollY:y,initialSize:M,smoothScrollX:$=!1,smoothScrollY:B=!1,isDraggable:A}=e,{paddingRight:P,paddingBottom:Y}=c??{},[R,O]=u,X=s.useRef(),W=s.useRef(),F=s.useRef(),H=s.useRef(),le=f+Math.max(0,k??0);let q=d?r+i:r;if(typeof o=="number")q+=n*o;else for(let te=0;te<n;te++)q+=o(te);y!==void 0&&(q+=y);const he=s.useRef(),de=s.useCallback(()=>{var qe,st;if(he.current===void 0)return;const te={...he.current};let K=0,pe=te.x<0?-te.x:0,ne=0,we=0;te.x=te.x<0?0:te.x;let $e=0;for(let Ce=0;Ce<l;Ce++)$e+=t[Ce].width;for(const Ce of t){const ze=K-$e;if(te.x>=ze+Ce.width)K+=Ce.width,we++,ne++;else if(te.x>ze)K+=Ce.width,$?pe+=ze-te.x:we++,ne++;else if(te.x+te.width>ze)K+=Ce.width,ne++;else break}let V=0,oe=0,Ae=0;if(typeof o=="number")B?(oe=Math.floor(te.y/o),V=oe*o-te.y):oe=Math.ceil(te.y/o),Ae=Math.ceil(te.height/o)+oe,V<0&&Ae++;else{let Ce=0;for(let ze=0;ze<n;ze++){const Fe=o(ze),vt=Ce+(B?0:Fe/2);if(te.y>=Ce+Fe)Ce+=Fe,oe++,Ae++;else if(te.y>vt)Ce+=Fe,B?V+=vt-te.y:oe++,Ae++;else if(te.y+te.height>Fe/2+Ce)Ce+=Fe,Ae++;else break}}oe=Math.max(0,Math.min(oe,n-1)),Ae=Math.max(oe,Math.min(Ae,n));const Ve={x:we,y:oe,width:ne-we,height:Ae-oe},ce=X.current;(ce===void 0||ce.y!==Ve.y||ce.x!==Ve.x||ce.height!==Ve.height||ce.width!==Ve.width||W.current!==pe||F.current!==V||te.width!==((qe=H.current)==null?void 0:qe[0])||te.height!==((st=H.current)==null?void 0:st[1]))&&(g==null||g({x:we,y:oe,width:ne-we,height:Ae-oe},te.width,te.height,te.paddingRight??0,pe,V),X.current=Ve,W.current=pe,F.current=V,H.current=[te.width,te.height])},[t,o,n,g,l,$,B]),ye=s.useCallback(te=>{he.current=te,de()},[de]);return s.useEffect(()=>{de()},[de]),s.createElement(nd,{scrollRef:w,className:m,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:A===!0||typeof A=="string",scrollWidth:le+(P??0),scrollHeight:q+(Y??0),clientHeight:O,rightElement:b,paddingBottom:Y,paddingRight:P,rightElementProps:C,update:ye,initialSize:M},s.createElement(Vc,{eventTargetRef:w,width:R,height:O,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},rd=on("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),id=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),ld=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),sd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),ad=10,cd=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:d,searchResults:l,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:m=!1,onSearchClose:g}=e,[w]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,b]=s.useState(""),C=d??h,k=s.useCallback(K=>{b(K),c==null||c(K)},[c]),[y,M]=s.useState(),$=s.useRef(y);$.current=y,s.useEffect(()=>{l!==void 0&&(l.length>0?M(K=>({rowsSearched:o,results:l.length,selectedIndex:(K==null?void 0:K.selectedIndex)??-1})):M(void 0))},[o,l]);const B=s.useRef();B.current===void 0&&(B.current=new AbortController);const A=s.useRef(),[P,Y]=s.useState([]),R=l??P,O=s.useCallback(()=>{A.current!==void 0&&(window.cancelAnimationFrame(A.current),A.current=void 0),B.current!==void 0&&B.current.abort(),B.current=new AbortController},[]),X=s.useRef(n);X.current=n;const W=s.useCallback(K=>{const pe=new RegExp(K.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ne=X.current,we=Math.min(10,o),$e=0;M(void 0),Y([]);const V=[],oe=async()=>{var ht;if(f===void 0)return;const Ae=performance.now(),Ve=o-$e;let ce=f({x:0,y:ne,width:r.length,height:Math.min(we,Ve,o-ne)},B.current.signal);typeof ce=="function"&&(ce=await ce());let qe=!1;for(const[gt,j]of ce.entries())for(const[be,xe]of j.entries()){let Ie;switch(xe.kind){case ee.Text:case ee.Number:Ie=xe.displayData;break;case ee.Uri:case ee.Markdown:Ie=xe.data;break;case ee.Boolean:Ie=typeof xe.data=="boolean"?xe.data.toString():void 0;break;case ee.Image:case ee.Bubble:Ie=xe.data.join("🐳");break;case ee.Custom:Ie=xe.copyData;break}Ie!==void 0&&pe.test(Ie)&&(V.push([be,gt+ne]),qe=!0)}const st=performance.now();qe&&Y([...V]),$e+=ce.length,en($e<=o);const Ce=((ht=$.current)==null?void 0:ht.selectedIndex)??-1;M({results:V.length,rowsSearched:$e,selectedIndex:Ce}),u==null||u(V,Ce),ne+we>=o?ne=0:ne+=we;const ze=st-Ae,Fe=Math.max(ze,1),vt=ad/Fe;we=Math.ceil(we*vt),$e<o&&V.length<1e3&&(A.current=window.requestAnimationFrame(oe))};O(),A.current=window.requestAnimationFrame(oe)},[O,r.length,f,u,o]),F=s.useCallback(()=>{var K;g==null||g(),M(void 0),Y([]),u==null||u([],-1),O(),(K=t==null?void 0:t.current)==null||K.focus()},[O,t,g,u]),H=s.useCallback(K=>{k(K.target.value),l===void 0&&(K.target.value===""?(M(void 0),Y([]),O()):W(K.target.value))},[W,O,k,l]);s.useEffect(()=>{i.current!==null&&(k(""),M(void 0),P.length>0&&(Y([]),u==null||u([],-1)),m?i.current.focus({preventScroll:!0}):O())},[m,i]);const le=s.useCallback(K=>{var ne;if((ne=K==null?void 0:K.stopPropagation)==null||ne.call(K),y===void 0||y.results===0)return;const pe=(y.selectedIndex+1)%y.results;M({...y,selectedIndex:pe}),u==null||u(R,pe)},[y,u,R]),q=s.useCallback(K=>{var ne;if((ne=K==null?void 0:K.stopPropagation)==null||ne.call(K),y===void 0||y.results===0)return;let pe=(y.selectedIndex-1)%y.results;pe<0&&(pe+=y.results),M({...y,selectedIndex:pe}),u==null||u(R,pe)},[u,R,y]),he=s.useCallback(K=>{(K.ctrlKey||K.metaKey)&&K.nativeEvent.code==="KeyF"||K.key==="Escape"?(F(),K.stopPropagation(),K.preventDefault()):K.key==="Enter"&&(K.shiftKey?q():le())},[F,le,q]);s.useEffect(()=>()=>{O()},[O]);const[de,ye]=s.useState(!1);s.useEffect(()=>{if(m)ye(!0);else{const K=setTimeout(()=>ye(!1),150);return()=>clearTimeout(K)}},[m]);const te=s.useMemo(()=>{if(!m&&!de)return null;let K;y!==void 0&&(K=y.results>=1e3?"over 1000":`${y.results} result${y.results!==1?"s":""}`,y.selectedIndex>=0&&(K=`${y.selectedIndex+1} of ${K}`));const pe=$e=>{$e.stopPropagation()},we={width:`${o>0?Math.floor(((y==null?void 0:y.rowsSearched)??0)/o*100):0}%`};return s.createElement(rd,{className:"gdg-search-bar"+(m?"":" out"),onMouseDown:pe,onMouseMove:pe,onMouseUp:pe,onClick:pe},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:w,"aria-hidden":!m,"data-testid":"search-input",ref:i,onChange:H,value:C,tabIndex:m?void 0:-1,onKeyDownCapture:he}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:q,disabled:((y==null?void 0:y.results)??0)===0},id),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!m,tabIndex:m?void 0:-1,onClick:le,disabled:((y==null?void 0:y.results)??0)===0},ld),g!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!m,"data-testid":"search-close-button",tabIndex:m?void 0:-1,onClick:F},sd)),y!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},K)),s.createElement("div",{className:"gdg-search-progress",style:we})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:w},"Type to search")))},[m,de,y,o,w,i,H,C,he,q,le,g,F]);return s.createElement(s.Fragment,null,s.createElement(od,{prelightCells:R,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),te)};class dd extends s.PureComponent{constructor(){super(...arguments);Le(this,"wrapperRef",s.createRef());Le(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const ud=()=>e=>Math.max(16,e.targetHeight-10),fd=on("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[ud(),"px"]}}),hd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[d,l]=Et.useState(n);return Et.createElement(dd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Et.createElement(fd,{targetHeight:t.height,"data-testid":"group-rename-input",value:d,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,d.length),onChange:c=>l(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(d):c.key==="Escape"&&o()},autoFocus:!0}))};function gd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Be(e,t,n){const o=gs(e,t);return o&&(n.didMatch=!0),o}function gs(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(gs(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const d=e.split("+"),l=d.pop();if(!gd(l,t))return!1;if(d[0]==="any")return!0;for(const c of d)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":qr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function md(e,t,n,o,r,i,d){const l=Et.useCallback((u,m,g,w)=>{var M;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!d&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(g||w==="drag")||n==="additive",b=(o==="mixed"||o==="additive")&&h,C=(r==="mixed"||r==="additive")&&h;let k={current:u===void 0?void 0:{...u,rangeStack:w==="drag"?((M=e.current)==null?void 0:M.rangeStack)??[]:[]},columns:b?e.columns:et.empty(),rows:C?e.rows:et.empty()};g&&(i==="multi-rect"||i==="multi-cell")&&k.current!==void 0&&e.current!==void 0&&(k={...k,current:{...k.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(k,m)},[o,e,n,i,d,r,t]),c=Et.useCallback((u,m,g)=>{u=u??e.rows,m!==void 0&&(u=u.add(m));let w;if(r==="exclusive"&&u.length>0)w={current:void 0,columns:et.empty(),rows:u};else{const h=g&&n==="mixed"||n==="additive",b=g&&o==="mixed"||o==="additive";w={current:h?e.current:void 0,columns:b?e.columns:et.empty(),rows:u}}t(w,!1)},[o,e,n,r,t]),f=Et.useCallback((u,m,g)=>{u=u??e.columns,m!==void 0&&(u=u.add(m));let w;if(o==="exclusive"&&u.length>0)w={current:void 0,rows:et.empty(),columns:u};else{const h=g&&n==="mixed"||n==="additive",b=g&&r==="mixed"||r==="additive";w={current:h?e.current:void 0,rows:b?e.rows:et.empty(),columns:u}}t(w,!1)},[o,e,n,r,t]);return[l,c,f]}function wd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let m=f.y;m<f.y+f.height;m++){const g=[];for(let w=f.x;w<f.x+f.width;w++)w<0||m>=r?g.push({kind:ee.Loading,allowOverlay:!1}):g.push(t([w,m]));u.push(g)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),d=e!==void 0?i:void 0,l=s.useCallback(f=>{if(d===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const m=d(u,o.signal);return typeof m=="function"?async()=>(await m()).map(g=>[{kind:ee.Loading,allowOverlay:!1},...g]):m.map(g=>[{kind:ee.Loading,allowOverlay:!1},...g])}return d(u,o.signal)},[o.signal,d,n]);return[e!==void 0?l:void 0,d]}function bd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case ee.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Li?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case ee.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case ee.Image:case ee.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case ee.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case ee.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case ee.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case ee.Markdown:case ee.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case ee.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case ee.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case ee.Protected:return{formatted:"************",rawValue:"",format:"string"};default:dr()}}function yd(e,t){return e.map((o,r)=>{const i=t[r];return o.map(d=>d.span!==void 0&&d.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:bd(d))})}function Rl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function pd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(d=>Rl(d,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:Rl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Mi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function El(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function vd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function Cd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Mi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((d,l)=>`<li gdg-raw-value=${El(r.rawValue[l])}>`+Mi(d)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${El(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Mi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function xd(e,t){const n=yd(e,t),o=pd(n),r=Cd(n);return{textPlain:o,textHtml:r}}function Il(e){var d;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const c=l.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,m=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",g=c.querySelectorAll("br");for(const b of g)b.replaceWith(`
`);const w=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((d=c.querySelector("a"))==null?void 0:d.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const b=c.querySelectorAll("li");i==null||i.push({rawValue:[...b].map(C=>C.getAttribute("gdg-raw-value")??""),formatted:[...b].map(C=>C.textContent??""),format:"string-array"})}else if(w!==null)i==null||i.push({rawValue:vd(w),formatted:c.textContent??"",format:h});else{let b=c.textContent??"";m&&(b=b.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:b??"",formatted:b??"",format:h})}}}return i!==void 0&&r.push(i),r}function kd(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let d=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(l=e.current)==null?void 0:l.range,f=[];if(c.width>2){const g=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof g=="function")return i;f.push(...g);const w=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w)}else{const g=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof g=="function")return i;f.push(...g)}let u=c.x-n,m=c.x+c.width-1-n;for(const g of f)for(const w of g)w.span!==void 0&&(u=Math.min(w.span[0],u),m=Math.max(w.span[1],m));u===c.x-n&&m===c.x+c.width-1-n?d=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:m-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!d);return e}function Dl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Sd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let d=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,d)),r=d+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Dl(e.slice(r,d))),r=d+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}d++}return r<e.length&&o.push(Dl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Fl(e,t,n){var l;const o=xd(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},d=(c,f)=>{var u,m;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(m=n==null?void 0:n.clipboardData)==null||m.setData("text/html",f)}catch{i(c,f)||r(c)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?d(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function ms(e){return e!==!0}function Tl(e){return typeof e=="string"?e:`${e}px`}const Md=()=>e=>e.innerWidth,Rd=()=>e=>e.innerHeight,Ed=on("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Md()],"wmyidgi-1":[Rd()]}}),Id=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(Ed,{innerHeight:Tl(n),innerWidth:Tl(t),...r},o)},Dd=2,Fd=1300;function Td(e,t,n){const o=Et.useRef(0),[r,i]=e??[0,0];Et.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let d=!1,l=0;const c=f=>{var u;if(!d){if(l===0)l=f;else{const m=f-l;o.current=Math.min(1,o.current+m/Fd);const g=o.current**1.618*m*Dd;(u=t.current)==null||u.scrollBy(r*g,i*g),l=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{d=!0}},[t,r,i,n])}function Hd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:d,remSize:l}){const[c,f,u,m,g,w]=Et.useMemo(()=>{if(!d||l===16)return[e,t,n,o,r,i];const h=l/16,b=e,C=es();return[typeof b=="number"?b*h:k=>Math.ceil(b(k)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??C.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??C.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??C.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,d,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:m,overscrollX:g,overscrollY:w}}const Qn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function We(e,t){return e===!0?t:e===!1?"":e}function Hl(e){const t=qr.value;return{activateCell:We(e.activateCell," |Enter|shift+Enter"),clear:We(e.clear,"any+Escape"),closeOverlay:We(e.closeOverlay,"any+Escape"),acceptOverlayDown:We(e.acceptOverlayDown,"Enter"),acceptOverlayUp:We(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:We(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:We(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:We(e.delete,t?"Backspace|Delete":"Delete"),downFill:We(e.downFill,"primary+_68"),scrollToSelectedCell:We(e.scrollToSelectedCell,"primary+Enter"),goDownCell:We(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:We(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:We(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:We(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:We(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:We(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:We(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:We(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:We(e.goToFirstCell,"primary+Home"),goToFirstColumn:We(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:We(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:We(e.goToLastCell,"primary+End"),goToLastColumn:We(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:We(e.goToLastRow,"primary+ArrowDown"),goToNextPage:We(e.goToNextPage,"PageDown"),goToPreviousPage:We(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:We(e.rightFill,"primary+_82"),search:We(e.search,"primary+f"),selectAll:We(e.selectAll,"primary+a"),selectColumn:We(e.selectColumn,"ctrl+ "),selectGrowDown:We(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:We(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:We(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:We(e.selectGrowUp,"shift+ArrowUp"),selectRow:We(e.selectRow,"shift+ "),selectToFirstCell:We(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:We(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:We(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:We(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:We(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:We(e.selectToLastRow,"primary+shift+ArrowDown")}}function Ad(e){const t=ba(e);return Et.useMemo(()=>{if(t===void 0)return Hl(Qn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Qn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Qn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Qn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Qn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Qn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Qn.selectToLastCell};return Hl({...Qn,...n})},[t])}function zd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const d={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(d.subGroups=o.subGroups.map((l,c)=>t(l,r+1,[...i,c])).sort((l,c)=>l.headerIndex-c.headerIndex)),d}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Gi(e,t){const n=[];function o(l,c,f=!1){let u=c!==null?c-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let m=0;m<l.subGroups.length;m++){const g=m<l.subGroups.length-1?l.subGroups[m+1].headerIndex:c;o(l.subGroups[m],g,f||l.isCollapsed)}}const r=zd(e.groups);for(let l=0;l<r.length;l++){const c=l<r.length-1?r[l+1].headerIndex:null;o(r[l],c)}let i=0,d=0;for(const l of n)l.contentIndex=d,d+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:c,...f}=l;return f})}function Pi(e,t){if(t===void 0||Gi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Pd(e,t,n,o){const r=Et.useMemo(()=>e===void 0?void 0:Gi(e,t),[e,t]),i=Et.useMemo(()=>r==null?void 0:r.reduce((u,m)=>(u[m.rowIndex]=m,u),{}),[r]),d=Et.useMemo(()=>r===void 0?t:r.reduce((u,m)=>u+(m.isCollapsed?1:m.rows+1),0),[r,t]),l=Et.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),c=Et.useCallback(u=>{if(r===void 0)return u;let m=u;for(const g of r){if(m===0)return;if(m--,!g.isCollapsed){if(m<g.rows)return g.contentIndex+m;m-=g.rows}}return u},[r]),f=eo(o??(e==null?void 0:e.themeOverride),Et.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:m,contentIndex:g,groupIndex:w}=Pi(u,r);return m?e.themeOverride:o==null?void 0:o(u,w,g)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:c,getRowThemeOverride:f}:{rowHeight:l,rows:d,rowNumberMapper:c,getRowThemeOverride:f}}function Ld(e,t){const n=Et.useMemo(()=>e===void 0?void 0:Gi(e,t),[e,t]);return{getRowGroupingForPath:bs,updateRowGroupingByPath:ws,mapper:Et.useCallback(o=>{if(typeof o=="number")return Pi(o,n);const r=Pi(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function ws(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,d)=>d===o?{...i,...n}:i):e.map((i,d)=>d===o?{...i,subGroups:ws(i.subGroups??[],r,n)}:i)}function bs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:bs(e[n].subGroups??[],o)}function Bd(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Wd(e,t,n,o,r){const[i,d]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:d}),[o,d,i]),[c,f,u]=wa(l),m=s.useRef(r);m.current=r;const g=Bd(null,b=>{b!==null&&t!==void 0?b.scrollTop=t:b!==null&&e!==void 0&&(b.scrollLeft=e)}),w=(c.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&g.current!==null&&w){if(g.current.scrollTop===t)return;g.current.scrollTop=t,g.current.scrollTop!==t&&u(),m.current()}},[t,w,u,g]);const h=(c.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&g.current!==null&&h){if(g.current.scrollLeft===e)return;g.current.scrollLeft=e,g.current.scrollLeft!==e&&u(),m.current()}},[e,h,u,g]),{visibleRegion:c,setVisibleRegion:f,scrollRef:g}}const $d=s.lazy(async()=>await Ll(()=>import("./data-grid-overlay-editor-CunnMCbA.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let Od=0;function Nd(e){return ia(al(al(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return ho((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Xr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Ao={kind:ee.Loading,allowOverlay:!1},Ri={columns:et.empty(),rows:et.empty(),current:void 0},Xd=(e,t)=>{var il,ll,sl;const[n,o]=s.useState(Ri),[r,i]=s.useState(),d=s.useRef(null),l=s.useRef(null),[c,f]=s.useState(),u=s.useRef(void 0),m=typeof window>"u"?null:window,{imageEditorOverride:g,getRowThemeOverride:w,markdownDivCreateNode:h,width:b,height:C,columns:k,rows:y,getCellContent:M,onCellClicked:$,onCellActivated:B,onFillPattern:A,onFinishedEditing:P,coercePasteValue:Y,drawHeader:R,drawCell:O,editorBloom:X,onHeaderClicked:W,onColumnProposeMove:F,rangeSelectionColumnSpanning:H=!0,spanRangeBehavior:le="default",onGroupHeaderClicked:q,onCellContextMenu:he,className:de,onHeaderContextMenu:ye,getCellsForSelection:te,onGroupHeaderContextMenu:K,onGroupHeaderRenamed:pe,onCellEdited:ne,onCellsEdited:we,onSearchResultsChanged:$e,searchResults:V,onSearchValueChange:oe,searchValue:Ae,onKeyDown:Ve,onKeyUp:ce,keybindings:qe,editOnType:st=!0,onRowAppended:Ce,onColumnAppended:ze,onColumnMoved:Fe,validateCell:vt,highlightRegions:ht,rangeSelect:gt="rect",columnSelect:j="multi",rowSelect:be="multi",rangeSelectionBlending:xe="exclusive",columnSelectionBlending:Ie="exclusive",rowSelectionBlending:ke="exclusive",onDelete:tt,onDragStart:Ze,onMouseMove:at,onPaste:Z,copyHeaders:se=!1,freezeColumns:Oe=0,cellActivationBehavior:Xe="second-click",rowSelectionMode:Ht="auto",columnSelectionMode:At="auto",onHeaderMenuClick:Re,onHeaderIndicatorClick:Se,getGroupDetails:ct,rowGrouping:Rt,onSearchClose:It,onItemHovered:Ot,onSelectionCleared:Pt,showSearch:hn,onVisibleRegionChanged:rn,gridSelection:zt,onGridSelectionChange:qt,minColumnWidth:Gt=50,maxColumnWidth:Sn=500,maxColumnAutoWidth:Ct,provideEditor:dt,trailingRowOptions:Ye,freezeTrailingRows:Lt=0,allowedFillDirections:Jt="orthogonal",scrollOffsetX:Mn,scrollOffsetY:zn,verticalBorder:Kt,onDragOverCell:gn,onDrop:Ee,onColumnResize:Qe,onColumnResizeEnd:Je,onColumnResizeStart:_e,customRenderers:Nt,fillHandle:Ge,experimental:Ke,fixedShadowX:Pn,fixedShadowY:gr,headerIcons:Kn,imageWindowLoader:Ln,initialSize:Bn,isDraggable:bo,onDragLeave:mr,onRowMoved:Wn,overscrollX:yo,overscrollY:po,preventDiagonalScrolling:vo,rightElement:Co,rightElementProps:oo,trapFocus:$n=!1,smoothScrollX:Qr,smoothScrollY:wr,scaleToRem:ei=!1,rowHeight:ti=34,headerHeight:Rn=36,groupHeaderHeight:Un=Rn,theme:ni,isOutsideClick:oi,renderers:xo,resizeIndicator:br,scrollToActiveCell:ro=!0,drawFocusRing:ri=!0,portalElementRef:yr,isActivationOnEnter:En}=e,Yo=ri==="no-editor"?r===void 0:ri,nt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,ko=(nt==null?void 0:nt.rowNumber)??!1;let mn=(nt==null?void 0:nt.kind)??e.rowMarkers??"none",jt=ko;(mn==="both"||mn==="checkbox-and-number")&&(mn="checkbox",jt=!0);const Xt=mn,Go=(nt==null?void 0:nt.width)??e.rowMarkerWidth,_o=(nt==null?void 0:nt.startIndex)??e.rowMarkerStartIndex??1,So=(nt==null?void 0:nt.theme)??e.rowMarkerTheme,Ko=nt==null?void 0:nt.headerTheme,pr=nt==null?void 0:nt.headerAlwaysVisible,Mo=be!=="multi"||(nt==null?void 0:nt.headerDisabled)===!0,On=(nt==null?void 0:nt.checkboxStyle)??"square",Nn=Math.max(Gt,20),io=Math.max(Sn,Nn),vr=Math.max(Ct??io,Nn),Cr=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Me,rowNumberMapper:Uo,rowHeight:ii,getRowThemeOverride:wn}=Pd(Rt,y,ti,w),Vo=s.useMemo(()=>Number.parseFloat(Cr.fontSize),[Cr]),{rowHeight:In,headerHeight:qo,groupHeaderHeight:xr,theme:kr,overscrollX:Sr,overscrollY:Ro}=Hd({groupHeaderHeight:Un,headerHeight:Rn,overscrollX:yo,overscrollY:po,remSize:Vo,rowHeight:ii,scaleToRem:ei,theme:ni}),ln=Ad(qe),bn=Go??(y>1e4?48:y>1e3?44:y>100?36:32),sn=Xt!=="none",D=sn?jt?2:1:0,Dt=Ye!==void 0,Dn=(Ye==null?void 0:Ye.sticky)===!0,[li,Mr]=s.useState(!1),E=hn??li,_=s.useCallback(()=>{It!==void 0?It():Mr(!1)},[It]),x=s.useMemo(()=>zt===void 0?void 0:Xr(zt,D),[zt,D])??n,U=s.useRef(new AbortController);s.useEffect(()=>()=>U==null?void 0:U.current.abort(),[]);const[Q,Te]=wd(te,M,D,U.current,Me),Ue=s.useCallback((a,p,v)=>{if(vt===void 0)return!0;const S=[a[0]-D,a[1]];return vt==null?void 0:vt(S,p,v)},[D,vt]),fe=s.useRef(zt),ot=s.useCallback((a,p)=>{p&&(a=kd(a,Q,D,le,U.current)),qt!==void 0?(fe.current=Xr(a,-D),qt(fe.current)):o(a)},[qt,Q,D,le]),ge=eo(Qe,s.useCallback((a,p,v,S)=>{Qe==null||Qe(k[v-D],p,v-D,S)},[Qe,D,k])),rt=eo(Je,s.useCallback((a,p,v,S)=>{Je==null||Je(k[v-D],p,v-D,S)},[Je,D,k])),bt=eo(_e,s.useCallback((a,p,v,S)=>{_e==null||_e(k[v-D],p,v-D,S)},[_e,D,k])),mt=eo(R,s.useCallback((a,p)=>(R==null?void 0:R({...a,columnIndex:a.columnIndex-D},p))??!1,[R,D])),yt=eo(O,s.useCallback((a,p)=>(O==null?void 0:O({...a,col:a.col-D},p))??!1,[O,D])),ut=s.useCallback(a=>{if(tt!==void 0){const p=tt(Xr(a,-D));return typeof p=="boolean"?p:Xr(p,D)}return!0},[tt,D]),[je,Mt,wt]=md(x,ot,xe,Ie,ke,gt,H),pt=s.useMemo(()=>Gn(es(),kr),[kr]),[an,ft]=s.useState([0,0,0]),yn=s.useMemo(()=>{if(xo===void 0)return{};const a={};for(const p of xo)a[p.kind]=p;return a},[xo]),xt=s.useCallback(a=>a.kind!==ee.Custom?yn[a.kind]:Nt==null?void 0:Nt.find(p=>p.isMatch(a)),[Nt,yn]);let{sizedColumns:Yt,nonGrowWidth:Xn}=Xa(k,Me,Te,an[0]-(D===0?0:bn)-an[2],Nn,vr,pt,xt,U.current);Xt!=="none"&&(Xn+=bn);const Yn=s.useMemo(()=>Yt.some(a=>a.group!==void 0),[Yt]),cn=Yn?qo+xr:qo,jo=x.rows.length,Vn=Xt==="none"?void 0:jo===0?!1:jo===Me?!0:void 0,Ne=s.useMemo(()=>{if(Xt==="none")return Yt;const a=[];return jt&&a.push({title:"",width:bn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:So,rowMarker:On,rowMarkerChecked:!1,headerRowMarkerTheme:Ko,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),a.push({title:"",width:bn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:So,rowMarker:On,rowMarkerChecked:Vn,headerRowMarkerTheme:Ko,headerRowMarkerAlwaysVisible:pr,headerRowMarkerDisabled:Mo}),[...a,...Yt]},[Xt,Yt,bn,So,On,Vn,Ko,pr,Mo,jt]),Ut=s.useRef({height:1,width:1,x:0,y:0}),Rr=s.useRef(!1),{setVisibleRegion:_i,visibleRegion:lo,scrollRef:it}=Wd(Mn,zn,In,Ut,()=>Rr.current=!0);Ut.current=lo;const vs=lo.x+D,Er=lo.y,Bt=s.useRef(null),_t=s.useCallback(a=>{var p;a===!0?(p=Bt.current)==null||p.focus():window.requestAnimationFrame(()=>{var v;(v=Bt.current)==null||v.focus()})},[]),Wt=Dt?Me+1:Me,dn=s.useCallback(a=>{const p=D===0?a:a.map(S=>({...S,location:[S.location[0]-D,S.location[1]]})),v=we==null?void 0:we(p);if(v!==!0)for(const S of p)ne==null||ne(S.location,S.value);return v},[ne,we,D]),[so,si]=s.useState(),Ir=x.current!==void 0&&x.current.range.width*x.current.range.height>1?x.current.range:void 0,Eo=Yo?(il=x.current)==null?void 0:il.cell:void 0,Dr=Eo==null?void 0:Eo[0],Fr=Eo==null?void 0:Eo[1],Cs=s.useMemo(()=>{if((ht===void 0||ht.length===0)&&(Ir??Dr??Fr??so)===void 0)return;const a=[];if(ht!==void 0)for(const p of ht){const v=Ne.length-p.range.x-D;v>0&&a.push({color:p.color,range:{...p.range,x:p.range.x+D,width:Math.min(v,p.range.width)},style:p.style})}return so!==void 0&&a.push({color:mo(pt.accentColor,0),range:so,style:"dashed"}),Ir!==void 0&&a.push({color:mo(pt.accentColor,.5),range:Ir,style:"solid-outline"}),Dr!==void 0&&Fr!==void 0&&a.push({color:pt.accentColor,range:{x:Dr,y:Fr,width:1,height:1},style:"solid-outline"}),a.length>0?a:void 0},[so,Ir,Dr,Fr,ht,Ne.length,pt.accentColor,D]),Ki=s.useRef(Ne);Ki.current=Ne;const Qt=s.useCallback(([a,p],v=!1)=>{var T,I,L,G,J,ae,re,ve,He;const S=Dt&&p===Wt-1,z=a===0&&sn,N=a===1&&sn&&jt;if(z){if(S)return Ao;const De=Uo(p);if(De===void 0)return Ao;let me;return jt||Xt==="clickable-number"?me="number":me=Xt,{kind:nn.Marker,allowOverlay:!1,checkboxStyle:On,checked:jt?!1:(x==null?void 0:x.rows.hasIndex(p))===!0,markerKind:me,row:_o+De,drawHandle:jt?!1:Wn!==void 0,cursor:jt?void 0:Xt==="clickable-number"?"pointer":void 0,disabled:((T=e.disabledRows)==null?void 0:T.call(e,p))===!0}}if(N){if(S)return Ao;const De=Uo(p);return De===void 0?Ao:{kind:nn.Marker,allowOverlay:!1,checkboxStyle:On,checked:(x==null?void 0:x.rows.hasIndex(p))===!0,markerKind:Xt==="checkbox-visible"?"checkbox-visible":"checkbox",row:_o+De,drawHandle:Wn!==void 0,cursor:void 0,disabled:((I=e.disabledRows)==null?void 0:I.call(e,p))===!0}}else if(S){const me=a===D?(Ye==null?void 0:Ye.hint)??"":"",ie=Ki.current[a];if(((L=ie==null?void 0:ie.trailingRowOptions)==null?void 0:L.disabled)===!0)return Ao;{const lt=((G=ie==null?void 0:ie.trailingRowOptions)==null?void 0:G.hint)??me,Tt=((J=ie==null?void 0:ie.trailingRowOptions)==null?void 0:J.addIcon)??(Ye==null?void 0:Ye.addIcon);return{kind:nn.NewRow,hint:lt,allowOverlay:!1,icon:Tt}}}else{const De=a-D;if(v||(Ke==null?void 0:Ke.strict)===!0){const ie=Ut.current,lt=ie.x>De||De>ie.x+ie.width||ie.y>p||p>ie.y+ie.height||p>=ui.current,Tt=De===((re=(ae=ie.extras)==null?void 0:ae.selected)==null?void 0:re[0])&&p===((ve=ie.extras)==null?void 0:ve.selected[1]);let Pe=!1;if(((He=ie.extras)==null?void 0:He.freezeRegions)!==void 0){for(const kt of ie.extras.freezeRegions)if(go(kt,De,p)){Pe=!0;break}}if(lt&&!Tt&&!Pe)return Ao}let me=M([De,p]);return D!==0&&me.span!==void 0&&(me={...me,span:[me.span[0]+D,me.span[1]+D]}),me}},[Dt,Wt,sn,Uo,On,x==null?void 0:x.rows,Xt,_o,Wn,D,Ye==null?void 0:Ye.hint,Ye==null?void 0:Ye.addIcon,Ke==null?void 0:Ke.strict,M]),ai=s.useCallback(a=>{let p=(ct==null?void 0:ct(a))??{name:a};return pe!==void 0&&a!==""&&(p={icon:p.icon,name:p.name,overrideTheme:p.overrideTheme,actions:[...p.actions??[],{title:"Rename",icon:"renameIcon",onClick:v=>hi({group:p.name,bounds:v.bounds})}]}),p},[ct,pe]),Io=s.useCallback(a=>{var I;const[p,v]=a.cell,S=Ne[p],z=(S==null?void 0:S.group)!==void 0?(I=ai(S.group))==null?void 0:I.overrideTheme:void 0,N=S==null?void 0:S.themeOverride,T=wn==null?void 0:wn(v);i({...a,theme:Gn(pt,z,N,T,a.content.themeOverride)})},[wn,Ne,ai,pt]),Zo=s.useCallback((a,p,v)=>{var T;if(x.current===void 0)return;const[S,z]=x.current.cell,N=Qt([S,z]);if(N.kind!==ee.Boolean&&N.allowOverlay){let I=N;if(v!==void 0)switch(I.kind){case ee.Number:{const L=sa(()=>v==="-"?-0:Number.parseFloat(v),0);I={...I,data:Number.isNaN(L)?0:L};break}case ee.Text:case ee.Markdown:case ee.Uri:I={...I,data:v};break}Io({target:a,content:I,initialValue:v,cell:[S,z],highlight:v===void 0,forceEditMode:v!==void 0,activation:p})}else N.kind===ee.Boolean&&p.inputType==="keyboard"&&N.readonly!==!0&&(dn([{location:x.current.cell,value:{...N,data:ms(N.data)}}]),(T=Bt.current)==null||T.damage([{cell:x.current.cell}]))},[Qt,x,dn,Io]),Ui=s.useCallback((a,p)=>{var z;const v=(z=Bt.current)==null?void 0:z.getBounds(a,p);if(v===void 0||it.current===null)return;const S=Qt([a,p]);S.allowOverlay&&Io({target:v,content:S,initialValue:void 0,highlight:!0,cell:[a,p],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Qt,it,Io]),Ft=s.useCallback((a,p,v="both",S=0,z=0,N=void 0)=>{if(it.current!==null){const T=Bt.current,I=l.current,L=typeof a!="number"?a.unit==="cell"?a.amount:void 0:a,G=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,J=typeof a!="number"&&a.unit==="px"?a.amount:void 0,ae=typeof p!="number"&&p.unit==="px"?p.amount:void 0;if(T!==null&&I!==null){let re={x:0,y:0,width:0,height:0},ve=0,He=0;if((L!==void 0||G!==void 0)&&(re=T.getBounds((L??0)+D,G??0)??re,re.width===0||re.height===0))return;const De=I.getBoundingClientRect(),me=De.width/I.offsetWidth;if(J!==void 0&&(re={...re,x:J-De.left-it.current.scrollLeft,width:1}),ae!==void 0&&(re={...re,y:ae+De.top-it.current.scrollTop,height:1}),re!==void 0){const ie={x:re.x-S,y:re.y-z,width:re.width+2*S,height:re.height+2*z};let lt=0;for(let vi=0;vi<Oe;vi++)lt+=Yt[vi].width;let Tt=0;const Pe=Lt+(Dn?1:0);Pe>0&&(Tt=wo(Wt,Pe,In));let kt=lt*me+De.left+D*bn*me,$t=De.right,Cn=De.top+cn*me,Tn=De.bottom-Tt*me;const Br=re.width+S*2;switch(N==null?void 0:N.hAlign){case"start":$t=kt+Br;break;case"end":kt=$t-Br;break;case"center":kt=Math.floor((kt+$t)/2)-Br/2,$t=kt+Br;break}const Wr=re.height+z*2;switch(N==null?void 0:N.vAlign){case"start":Tn=Cn+Wr;break;case"end":Cn=Tn-Wr;break;case"center":Cn=Math.floor((Cn+Tn)/2)-Wr/2,Tn=Cn+Wr;break}kt>ie.x?ve=ie.x-kt:$t<ie.x+ie.width&&(ve=ie.x+ie.width-$t),Cn>ie.y?He=ie.y-Cn:Tn<ie.y+ie.height&&(He=ie.y+ie.height-Tn),v==="vertical"||typeof a=="number"&&a<Oe?ve=0:(v==="horizontal"||typeof p=="number"&&p>=Wt-Pe)&&(He=0),(ve!==0||He!==0)&&(me!==1&&(ve/=me,He/=me),it.current.scrollTo({left:ve+it.current.scrollLeft,top:He+it.current.scrollTop,behavior:(N==null?void 0:N.behavior)??"auto"}))}}}},[D,Lt,bn,it,cn,Oe,Yt,Wt,Dn,In]),ci=s.useRef(Ui),di=s.useRef(M);ci.current=Ui,di.current=M;const ui=s.useRef(Me);ui.current=Me;const Vi=s.useRef(Ne.length);Vi.current=Ne.length;const qn=s.useCallback(async(a,p=!0,v)=>{var G;const S=Ne[a];if(((G=S==null?void 0:S.trailingRowOptions)==null?void 0:G.disabled)===!0)return;const z=Ce==null?void 0:Ce();let N,T=!0;z!==void 0&&(N=await z,N==="top"&&(T=!1),typeof N=="number"&&(T=!1));let I=0;const L=()=>{if(ui.current<=Me){I<500&&window.setTimeout(L,I),I=50+I*2;return}const J=typeof N=="number"?N:T?Me:0;Lr.current(a-D,J,"both",0,20,v?{behavior:v}:void 0),je({cell:[a,J],range:{x:a,y:J,width:1,height:1}},!1,!1,"edit");const ae=di.current([a-D,J]);ae.allowOverlay&&Po(ae)&&ae.readonly!==!0&&p&&window.setTimeout(()=>{ci.current(a,J)},0)};L()},[Ne,Ce,D,Me,je]),Tr=s.useCallback(async(a,p=!0)=>{const v=ze==null?void 0:ze();let S,z=!0;v!==void 0&&(S=await v,S==="left"&&(z=!1),typeof S=="number"&&(z=!1));let N=0;const T=()=>{if(Vi.current<=Ne.length){N<500&&window.setTimeout(T,N),N=50+N*2;return}const I=typeof S=="number"?S:z?Ne.length:0;Ft(I-D,a),je({cell:[I,a],range:{x:I,y:a,width:1,height:1}},!1,!1,"edit");const L=di.current([I-D,a]);L.allowOverlay&&Po(L)&&L.readonly!==!0&&p&&window.setTimeout(()=>{ci.current(I,a)},0)};T()},[Ne,ze,D,Ft,je]),Do=s.useCallback(a=>{var v,S;const p=((S=(v=Yt[a])==null?void 0:v.trailingRowOptions)==null?void 0:S.targetColumn)??(Ye==null?void 0:Ye.targetColumn);if(typeof p=="number")return p+(sn?1:0);if(typeof p=="object"){const z=k.indexOf(p);if(z>=0)return z+(sn?1:0)}},[Yt,k,sn,Ye==null?void 0:Ye.targetColumn]),jn=s.useRef(void 0),Fo=s.useRef(void 0),Jo=s.useCallback((a,p)=>{var z;const[v,S]=p;return Gn(pt,(z=Ne[v])==null?void 0:z.themeOverride,wn==null?void 0:wn(S),a.themeOverride)},[wn,Ne,pt]),{mapper:ao}=Ld(Rt,y),pn=Rt==null?void 0:Rt.navigationBehavior,Qo=s.useCallback(a=>{var G,J,ae;const p=qr.value?a.metaKey:a.ctrlKey,v=p&&be==="multi",[S,z]=a.location,N=x.columns,T=x.rows,[I,L]=((G=x.current)==null?void 0:G.cell)??[];if(a.kind==="cell"){if(Fo.current=void 0,co.current=[S,z],(jt?S===1:S===0)&&sn){if(Dt===!0&&z===Me||Xt==="number"||be==="none")return;const ve=Qt(a.location);if(ve.kind!==nn.Marker||ve.disabled===!0)return;if(Wn!==void 0){const me=xt(ve);en((me==null?void 0:me.kind)===nn.Marker);const ie=(J=me==null?void 0:me.onClick)==null?void 0:J.call(me,{...a,cell:ve,posX:a.localEventX,posY:a.localEventY,bounds:a.bounds,theme:Jo(ve,a.location),preventDefault:()=>{}});if(ie===void 0||ie.checked===ve.checked)return}i(void 0),_t();const He=T.hasIndex(z),De=jn.current;if(be==="multi"&&(a.shiftKey||a.isLongTouch===!0)&&De!==void 0&&T.hasIndex(De)){const me=[Math.min(De,z),Math.max(De,z)+1];v||Ht==="multi"?Mt(void 0,me,!0):Mt(et.fromSingleSelection(me),void 0,v)}else be==="multi"&&(v||a.isTouch||Ht==="multi")?He?Mt(T.remove(z),void 0,!0):(Mt(void 0,z,!0),jn.current=z):He&&T.length===1?Mt(et.empty(),void 0,p):(Mt(et.fromSingleSelection(z),void 0,p),jn.current=z)}else if(S>=D&&Dt&&z===Me){const ve=Do(S);qn(ve??S)}else if(I!==S||L!==z){const ve=Qt(a.location),He=xt(ve);if((He==null?void 0:He.onSelect)!==void 0){let ie=!1;if(He.onSelect({...a,cell:ve,posX:a.localEventX,posY:a.localEventY,bounds:a.bounds,preventDefault:()=>ie=!0,theme:Jo(ve,a.location)}),ie)return}if(pn==="block"&&ao(z).isGroupHeader)return;const De=Dn&&z===Me,me=Dn&&x!==void 0&&((ae=x.current)==null?void 0:ae.cell[1])===Me;if((a.shiftKey||a.isLongTouch===!0)&&I!==void 0&&L!==void 0&&x.current!==void 0&&!me){if(De)return;const ie=Math.min(S,I),lt=Math.max(S,I),Tt=Math.min(z,L),Pe=Math.max(z,L);je({...x.current,range:{x:ie,y:Tt,width:lt-ie+1,height:Pe-Tt+1}},!0,p,"click"),jn.current=void 0,_t()}else je({cell:[S,z],range:{x:S,y:z,width:1,height:1}},!0,p,"click"),jn.current=void 0,i(void 0),_t()}}else if(a.kind==="header")if(co.current=[S,z],i(void 0),sn&&S===0)jn.current=void 0,Fo.current=void 0,!Mo&&be==="multi"&&(T.length!==Me?Mt(et.fromSingleSelection([0,Me]),void 0,p):Mt(et.empty(),void 0,p),_t());else{const re=Fo.current;if(j==="multi"&&(a.shiftKey||a.isLongTouch===!0)&&re!==void 0&&N.hasIndex(re)){const ve=[Math.min(re,S),Math.max(re,S)+1];p||a.isTouch||At==="multi"?wt(void 0,ve,p):wt(et.fromSingleSelection(ve),void 0,p)}else j==="multi"&&(p||a.isTouch||At==="multi")?(N.hasIndex(S)?wt(N.remove(S),void 0,p):wt(void 0,S,p),Fo.current=S):j!=="none"&&(N.hasIndex(S)?wt(N.remove(S),void 0,p):wt(et.fromSingleSelection(S),void 0,p),Fo.current=S);jn.current=void 0,_t()}else a.kind===xn?co.current=[S,z]:a.kind===jr&&!a.isMaybeScrollbar&&(ot(Ri,!1),i(void 0),_t(),Pt==null||Pt(),jn.current=void 0,Fo.current=void 0)},[be,j,x,sn,D,Dt,Me,Xt,Qt,Wn,_t,Ht,At,xt,Jo,Mt,Do,qn,pn,ao,Dn,je,Mo,wt,ot,Pt]),er=s.useRef(!1),co=s.useRef(void 0),qi=s.useRef(lo),un=s.useRef(void 0),xs=s.useCallback(a=>{if(To.current=!1,qi.current=Ut.current,a.button!==0&&a.button!==1){un.current=void 0;return}const p=performance.now();un.current={button:a.button,time:p,location:a.location},(a==null?void 0:a.kind)==="header"&&(er.current=!0);const v=a.kind==="cell"&&a.isFillHandle;!v&&a.kind!=="cell"&&a.isEdge||(f({previousSelection:x,fillHandle:v}),co.current=void 0,!a.isTouch&&a.button===0&&!v?Qo(a):!a.isTouch&&a.button===1&&(co.current=a.location))},[x,Qo]),[fi,hi]=s.useState(),ji=s.useCallback(a=>{if(a.kind!==xn||j!=="multi")return;const p=qr.value?a.metaKey:a.ctrlKey,[v]=a.location,S=x.columns;if(v<D)return;const z=Ne[v];let N=v,T=v;for(let I=v-1;I>=D&&ur(z.group,Ne[I].group);I--)N--;for(let I=v+1;I<Ne.length&&ur(z.group,Ne[I].group);I++)T++;if(_t(),p||a.isTouch||At==="multi")if(S.hasAll([N,T+1])){let I=S;for(let L=N;L<=T;L++)I=I.remove(L);wt(I,void 0,p)}else wt(void 0,[N,T+1],p);else wt(et.fromSingleSelection([N,T+1]),void 0,p)},[j,_t,x.columns,Ne,D,wt,At]),To=s.useRef(!1),Hr=s.useCallback(async a=>{if(Q!==void 0&&ge!==void 0){const p=Ut.current.y,v=Ut.current.height;let S=Q({x:a,y:p,width:1,height:Math.min(v,Me-p)},U.current.signal);typeof S!="object"&&(S=await S());const z=Yt[a-D],T=document.createElement("canvas").getContext("2d",{alpha:!1});if(T!==null){T.font=pt.baseFontFull;const I=ns(T,pt,z,0,S,Nn,io,!1,xt);ge==null||ge(z,I.width,a,I.width)}}},[Yt,Q,io,pt,Nn,ge,D,Me,xt]),[ks,gi]=s.useState(),Ho=s.useCallback(async(a,p)=>{var I,L;const v=(I=a.current)==null?void 0:I.range;if(v===void 0||Q===void 0||p.current===void 0)return;const S=p.current.range;if(A!==void 0){let G=!1;if(A({fillDestination:{...S,x:S.x-D},patternSource:{...v,x:v.x-D},preventDefault:()=>G=!0}),G)return}let z=Q(v,U.current.signal);typeof z!="object"&&(z=await z());const N=z,T=[];for(let G=0;G<S.width;G++)for(let J=0;J<S.height;J++){const ae=[S.x+G,S.y+J];if(Gl(ae,v))continue;const re=N[J%v.height][G%v.width];Lo(re)||!Po(re)||T.push({location:ae,value:{...re}})}dn(T),(L=Bt.current)==null||L.damage(T.map(G=>({cell:G.location})))},[Q,dn,A,D]),Zi=s.useCallback(()=>{if(x.current===void 0||x.current.range.width<=1)return;const a={...x,current:{...x.current,range:{...x.current.range,width:1}}};Ho(a,x)},[Ho,x]),Ji=s.useCallback(()=>{if(x.current===void 0||x.current.range.height<=1)return;const a={...x,current:{...x.current,range:{...x.current.range,height:1}}};Ho(a,x)},[Ho,x]),Ss=s.useCallback((a,p)=>{var J,ae;const v=c;if(f(void 0),si(void 0),gi(void 0),er.current=!1,p)return;if((v==null?void 0:v.fillHandle)===!0&&x.current!==void 0&&((J=v.previousSelection)==null?void 0:J.current)!==void 0){if(so===void 0)return;const re={...x,current:{...x.current,range:ss(v.previousSelection.current.range,so)}};Ho(v.previousSelection,re),ot(re,!0);return}const[S,z]=a.location,[N,T]=co.current??[],I=()=>{To.current=!0},L=re=>{var He,De,me;const ve=re.isTouch||N===S&&T===z;if(ve&&($==null||$([S-D,z],{...re,preventDefault:I})),re.button===1)return!To.current;if(!To.current){const ie=Qt(a.location),lt=xt(ie);if(lt!==void 0&&lt.onClick!==void 0&&ve){const Pe=lt.onClick({...re,cell:ie,posX:re.localEventX,posY:re.localEventY,bounds:re.bounds,theme:Jo(ie,a.location),preventDefault:I});Pe!==void 0&&!Lo(Pe)&&zo(Pe)&&(dn([{location:re.location,value:Pe}]),(He=Bt.current)==null||He.damage([{cell:re.location}]))}if(To.current||x.current===void 0)return!1;let Tt=!1;switch(ie.activationBehaviorOverride??Xe){case"double-click":case"second-click":{if(((me=(De=v==null?void 0:v.previousSelection)==null?void 0:De.current)==null?void 0:me.cell)===void 0)break;const[Pe,kt]=x.current.cell,[$t,Cn]=v.previousSelection.current.cell;Tt=S===Pe&&S===$t&&z===kt&&z===Cn&&(re.isDoubleClick===!0||Xe==="second-click");break}case"single-click":{Tt=!0;break}}if(Tt){const kt={inputType:"pointer",pointerActivation:re.isDoubleClick===!0?"double-click":ie.activationBehaviorOverride??Xe,pointerType:re.isTouch?"touch":"mouse"};return B==null||B([S-D,z],kt),Zo(re.bounds,kt),!0}}return!1},G=a.location[0]-D;if(a.isTouch){const re=Ut.current,ve=qi.current;if(re.x!==ve.x||re.y!==ve.y)return;if(a.isLongTouch===!0){if(a.kind==="cell"&&ar((ae=x.current)==null?void 0:ae.cell,a.location)){he==null||he([G,a.location[1]],{...a,preventDefault:I});return}else if(a.kind==="header"&&x.columns.hasIndex(S)){ye==null||ye(G,{...a,preventDefault:I});return}else if(a.kind===xn){if(G<0)return;K==null||K(G,{...a,preventDefault:I});return}}a.kind==="cell"?L(a)||Qo(a):a.kind===xn?q==null||q(G,{...a,preventDefault:I}):(a.kind===to&&(W==null||W(G,{...a,preventDefault:I})),Qo(a));return}if(a.kind==="header"){if(G<0)return;a.isEdge?a.isDoubleClick===!0&&Hr(S):a.button===0&&S===N&&z===T&&(W==null||W(G,{...a,preventDefault:I}))}if(a.kind===xn){if(G<0)return;a.button===0&&S===N&&z===T&&(q==null||q(G,{...a,preventDefault:I}),To.current||ji(a))}a.kind==="cell"&&(a.button===0||a.button===1)&&L(a),co.current=void 0},[c,x,D,so,Ho,ot,$,Qt,xt,Xe,Jo,dn,B,Zo,he,ye,K,Qo,q,W,Hr,ji]),Ms=s.useCallback(a=>{const p={...a,location:[a.location[0]-D,a.location[1]]};at==null||at(p),c!==void 0&&a.buttons===0&&(f(void 0),si(void 0),gi(void 0),er.current=!1),gi(v=>{var S;return er.current?[a.scrollEdge[0],0]:a.scrollEdge[0]===(v==null?void 0:v[0])&&a.scrollEdge[1]===v[1]?v:c===void 0||(((S=un.current)==null?void 0:S.location[0])??0)<D?void 0:a.scrollEdge})},[c,at,D]),Rs=s.useCallback((a,p)=>{Re==null||Re(a-D,p)},[Re,D]),Es=s.useCallback((a,p)=>{Se==null||Se(a-D,p)},[Se,D]);s.useEffect(()=>{if(r===void 0)return;const a=S=>{const z=[];let N=S.parentElement;for(;N&&N!==document.documentElement;){const T=window.getComputedStyle(N),I=T.overflow+T.overflowY+T.overflowX;(I.includes("scroll")||I.includes("auto"))&&z.push(N),N=N.parentElement}return z},p=S=>{const z=S.target;it.current&&!it.current.contains(z)&&i(void 0)},v=[];if(it.current){const S=a(it.current);v.push(...S)}return v.forEach(S=>{S.addEventListener("scroll",p)}),window.addEventListener("scroll",p),document.addEventListener("scroll",p,!0),()=>{v.forEach(S=>{S.removeEventListener("scroll",p)}),window.removeEventListener("scroll",p),document.removeEventListener("scroll",p,!0)}},[r,i,it]);const Fn=(ll=x==null?void 0:x.current)==null?void 0:ll.cell,Is=s.useCallback((a,p,v,S,z,N)=>{if(Rr.current=!1,r!==void 0){const J=Ut.current;(J.x!==a.x||J.y!==a.y)&&i(void 0)}let T=Fn;T!==void 0&&(T=[T[0]-D,T[1]]);const I=Oe===0?void 0:{x:0,y:a.y,width:Oe,height:a.height},L=[];I!==void 0&&L.push(I),Lt>0&&(L.push({x:a.x-D,y:Me-Lt,width:a.width,height:Lt}),Oe>0&&L.push({x:0,y:Me-Lt,width:Oe,height:Lt}));const G={x:a.x-D,y:a.y,width:a.width,height:Dt&&a.y+a.height>=Me?a.height-1:a.height,tx:z,ty:N,extras:{selected:T,freezeRegion:I,freezeRegions:L}};Ut.current=G,_i(G),ft([p,v,S]),rn==null||rn(G,G.tx,G.ty,G.extras)},[Fn,r,D,Dt,Me,Oe,Lt,i,_i,rn]),Ds=eo(F,s.useCallback((a,p)=>(F==null?void 0:F(a-D,p-D))!==!1,[F,D])),Fs=eo(Fe,s.useCallback((a,p)=>{Fe==null||Fe(a-D,p-D),j!=="none"&&wt(et.fromSingleSelection(p),void 0,!0)},[j,Fe,D,wt])),mi=s.useRef(!1),Ts=s.useCallback(a=>{if(a.location[0]===0&&D>0){a.preventDefault();return}Ze==null||Ze({...a,location:[a.location[0]-D,a.location[1]]}),a.defaultPrevented()||(mi.current=!0),f(void 0)},[Ze,D]),Hs=s.useCallback(()=>{mi.current=!1},[]),Qi=Rt==null?void 0:Rt.selectionBehavior,Ar=s.useCallback(a=>{if(Qi!=="block-spanning")return;const{isGroupHeader:p,path:v,groupRows:S}=ao(a);if(p)return[a,a];const z=v[v.length-1],N=a-z,T=a+S-z-1;return[N,T]},[ao,Qi]),wi=s.useRef(void 0),bi=s.useCallback(a=>{var p,v,S;if(!hs(a,wi.current)&&(wi.current=a,!(((p=un==null?void 0:un.current)==null?void 0:p.button)!==void 0&&un.current.button>=1))){if(a.buttons!==0&&c!==void 0&&((v=un.current)==null?void 0:v.location[0])===0&&D===1&&be==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(un.current.location[1])&&x.rows.hasIndex(un.current.location[1])){const z=Math.min(un.current.location[1],a.location[1]),N=Math.max(un.current.location[1],a.location[1])+1;Mt(et.fromSingleSelection([z,N]),void 0,!1)}else if(a.buttons!==0&&c!==void 0&&x.current!==void 0&&!mi.current&&!er.current&&(gt==="rect"||gt==="multi-rect")){const[z,N]=x.current.cell;let[T,I]=a.location;if(I<0&&(I=Ut.current.y),c.fillHandle===!0&&((S=c.previousSelection)==null?void 0:S.current)!==void 0){const L=c.previousSelection.current.range;I=Math.min(I,Dt?Me-1:Me);const G=xc(L,T,I,Jt);si(G)}else{if(Dt&&N===Me)return;if(Dt&&I===Me)if(a.kind===jr)I--;else return;T=Math.max(T,D);const J=Ar(N);I=J===void 0?I:fn(I,J[0],J[1]);const ae=T-z,re=I-N,ve={x:ae>=0?z:T,y:re>=0?N:I,width:Math.abs(ae)+1,height:Math.abs(re)+1};je({...x.current,range:ve},!0,!1,"drag")}}Ot==null||Ot({...a,location:[a.location[0]-D,a.location[1]]})}},[c,D,be,x,gt,Ot,Mt,Dt,Me,Jt,Ar,je]),As=s.useCallback(()=>{var T,I;const a=wi.current;if(a===void 0)return;const[p,v]=a.scrollEdge;let[S,z]=a.location;const N=Ut.current;p===-1?S=((I=(T=N.extras)==null?void 0:T.freezeRegion)==null?void 0:I.x)??N.x:p===1&&(S=N.x+N.width),v===-1?z=Math.max(0,N.y):v===1&&(z=Math.min(Me-1,N.y+N.height)),S=fn(S,0,Ne.length-1),z=fn(z,0,Me-1),bi({...a,location:[S,z]})},[Ne.length,bi,Me]);Td(ks,it,As);const vn=s.useCallback(a=>{if(x.current===void 0)return;const[p,v]=a,[S,z]=x.current.cell,N=x.current.range;let T=N.x,I=N.x+N.width,L=N.y,G=N.y+N.height;const[J,ae]=Ar(z)??[0,Me-1],re=ae+1;if(v!==0)switch(v){case 2:{G=re,L=z,Ft(0,G,"vertical");break}case-2:{L=J,G=z+1,Ft(0,L,"vertical");break}case 1:{L<z?(L++,Ft(0,L,"vertical")):(G=Math.min(re,G+1),Ft(0,G,"vertical"));break}case-1:{G>z+1?(G--,Ft(0,G,"vertical")):(L=Math.max(J,L-1),Ft(0,L,"vertical"));break}default:dr()}if(p!==0)if(p===2)I=Ne.length,T=S,Ft(I-1-D,0,"horizontal");else if(p===-2)T=D,I=S+1,Ft(T-D,0,"horizontal");else{let ve=[];if(Q!==void 0){const He=Q({x:T,y:L,width:I-T-D,height:G-L},U.current.signal);typeof He=="object"&&(ve=Nd(He))}if(p===1){let He=!1;if(T<S){if(ve.length>0){const De=ho(T+1,S+1).find(me=>!ve.includes(me-D));De!==void 0&&(T=De,He=!0)}else T++,He=!0;He&&Ft(T,0,"horizontal")}He||(I=Math.min(Ne.length,I+1),Ft(I-1-D,0,"horizontal"))}else if(p===-1){let He=!1;if(I>S+1){if(ve.length>0){const De=ho(I-1,S,-1).find(me=>!ve.includes(me-D));De!==void 0&&(I=De,He=!0)}else I--,He=!0;He&&Ft(I-D,0,"horizontal")}He||(T=Math.max(D,T-1),Ft(T-D,0,"horizontal"))}else dr()}je({cell:x.current.cell,range:{x:T,y:L,width:I-T,height:G-L}},!0,!1,"keyboard-select")},[Q,Ar,x,Ne.length,D,Me,Ft,je]),yi=s.useRef(ro);yi.current=ro;const Zn=s.useCallback((a,p,v,S)=>{const z=Wt-(v?0:1);a=fn(a,D,Yt.length-1+D),p=fn(p,0,z);const N=Fn==null?void 0:Fn[0],T=Fn==null?void 0:Fn[1];if(a===N&&p===T)return!1;if(S&&x.current!==void 0){const I=[...x.current.rangeStack];(x.current.range.width>1||x.current.range.height>1)&&I.push(x.current.range),ot({...x,current:{cell:[a,p],range:{x:a,y:p,width:1,height:1},rangeStack:I}},!0)}else je({cell:[a,p],range:{x:a,y:p,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===a&&u.current[1]===p&&(u.current=void 0),yi.current&&Ft(a-D,p,"both",0,20),!0},[Wt,D,Yt.length,Fn,x,Ft,ot,je]),zs=s.useCallback((a,p)=>{(r==null?void 0:r.cell)!==void 0&&a!==void 0&&zo(a)&&(dn([{location:r.cell,value:a}]),window.requestAnimationFrame(()=>{var z;(z=Bt.current)==null||z.damage([{cell:r.cell}])})),_t(!0),i(void 0);const[v,S]=p;if(x.current!==void 0&&(v!==0||S!==0)){const z=x.current.cell[1]===Wt-1;if(z&&S===1){P==null||P(a,[0,0]);return}const N=x.current.cell[0]===Ne.length-1&&a!==void 0;let T=!0;if(z&&S===1&&Ce!==void 0){T=!1;const I=x.current.cell[0]+v,L=Do(I);qn(L??I,!1)}if(N&&v===1&&ze!==void 0){T=!1;const I=x.current.cell[1]+S;Tr(I,!1)}if(T){let I=x.current.cell[0]+v,L=x.current.cell[1]+S,G=!1;En&&v===1&&S===0?I>=Ne.length?L>=Wt-1?(I=x.current.cell[0],L=x.current.cell[1],G=!1):(I=D,L+=1,G=!0):G=!0:(I=fn(I,D,Ne.length-1),L=fn(L,0,Wt-1),G=En===!0&&v===0&&S===1),Zn(I,L,z,!1),G&&window.setTimeout(()=>{var ae;const J=M([I-D,L]);if(Po(J)){const re=(ae=Bt.current)==null?void 0:ae.getBounds(I,L);if(re&&J.allowOverlay){const ve={inputType:"keyboard",key:"Enter"};B==null||B([I-D,L],ve),Io({target:re,content:J,initialValue:void 0,cell:[I,L],highlight:!0,forceEditMode:!0,activation:ve})}}},50)}}P==null||P(a,p)},[r==null?void 0:r.cell,_t,x,P,dn,Wt,Zn,Ne.length,qn,Tr,Ce,ze,Do,M,D,B,Io,En]),Ps=s.useMemo(()=>`gdg-overlay-${Od++}`,[]),uo=s.useCallback(a=>{var v,S,z,N;_t();const p=[];for(let T=a.x;T<a.x+a.width;T++)for(let I=a.y;I<a.y+a.height;I++){const L=M([T-D,I]);if(!L.allowOverlay&&L.kind!==ee.Boolean)continue;let G;if(L.kind===ee.Custom){const J=xt(L),ae=(v=J==null?void 0:J.provideEditor)==null?void 0:v.call(J,{...L,location:[T-D,I]});(J==null?void 0:J.onDelete)!==void 0?G=J.onDelete(L):aa(ae)&&(G=(S=ae==null?void 0:ae.deletedValue)==null?void 0:S.call(ae,L))}else if(zo(L)&&L.allowOverlay||L.kind===ee.Boolean){const J=xt(L);G=(z=J==null?void 0:J.onDelete)==null?void 0:z.call(J,L)}G!==void 0&&!Lo(G)&&zo(G)&&p.push({location:[T,I],value:G})}dn(p),(N=Bt.current)==null||N.damage(p.map(T=>({cell:T.location})))},[_t,M,xt,dn,D]),tr=r!==void 0,el=s.useCallback(a=>{var ie,lt,Tt;const p=()=>{a.stopPropagation(),a.preventDefault()},v={didMatch:!1},{bounds:S}=a,z=x.columns,N=x.rows,T=ln;if(!tr&&Be(T.clear,a,v)){const Pe=((ie=x.current)==null?void 0:ie.cell)??[D,0];ot({columns:et.empty(),rows:et.empty(),current:{cell:Pe,range:{x:Pe[0],y:Pe[1],width:1,height:1},rangeStack:[]}},!1),Pt==null||Pt(),_t()}else if(!tr&&Be(T.selectAll,a,v))ot({columns:et.empty(),rows:et.empty(),current:{cell:((lt=x.current)==null?void 0:lt.cell)??[D,0],range:{x:D,y:0,width:k.length,height:Me},rangeStack:[]}},!1);else if(Be(T.search,a,v))(Tt=d==null?void 0:d.current)==null||Tt.focus({preventScroll:!0}),Mr(!0);else if(Be(T.delete,a,v)){const Pe=(ut==null?void 0:ut(x))??!0;if(Pe!==!1){const kt=Pe===!0?x:Pe;if(kt.current!==void 0){uo(kt.current.range);for(const $t of kt.current.rangeStack)uo($t)}for(const $t of kt.rows)uo({x:D,y:$t,width:k.length,height:1});for(const $t of kt.columns)uo({x:$t,y:0,width:1,height:Me})}}if(v.didMatch)return p(),!0;if(x.current===void 0)return!1;let[I,L]=x.current.cell;const[,G]=x.current.cell;let J=!1,ae=!1;if(Be(T.scrollToSelectedCell,a,v))Lr.current(I-D,L);else if(j!=="none"&&Be(T.selectColumn,a,v))z.hasIndex(I)?wt(z.remove(I),void 0,!0):j==="single"?wt(et.fromSingleSelection(I),void 0,!0):wt(void 0,I,!0);else if(be!=="none"&&Be(T.selectRow,a,v))N.hasIndex(L)?Mt(N.remove(L),void 0,!0):be==="single"?Mt(et.fromSingleSelection(L),void 0,!0):Mt(void 0,L,!0);else if(!tr&&S!==void 0&&Be(T.activateCell,a,v))if(L===Me&&Dt)window.setTimeout(()=>{const Pe=Do(I);qn(Pe??I)},0);else{const Pe={inputType:"keyboard",key:a.key};B==null||B([I-D,L],Pe),Zo(S,Pe)}else if(x.current.range.height>1&&Be(T.downFill,a,v))Ji();else if(x.current.range.width>1&&Be(T.rightFill,a,v))Zi();else if(Be(T.goToNextPage,a,v))L+=Math.max(1,Ut.current.height-4);else if(Be(T.goToPreviousPage,a,v))L-=Math.max(1,Ut.current.height-4);else if(Be(T.goToFirstCell,a,v))i(void 0),L=0,I=0;else if(Be(T.goToLastCell,a,v))i(void 0),L=Number.MAX_SAFE_INTEGER,I=Number.MAX_SAFE_INTEGER;else if(Be(T.selectToFirstCell,a,v))i(void 0),vn([-2,-2]);else if(Be(T.selectToLastCell,a,v))i(void 0),vn([2,2]);else if(tr)Be(T.closeOverlay,a,v)&&i(void 0),Be(T.acceptOverlayDown,a,v)&&(i(void 0),L++),Be(T.acceptOverlayUp,a,v)&&(i(void 0),L--),Be(T.acceptOverlayLeft,a,v)&&(i(void 0),I--),Be(T.acceptOverlayRight,a,v)&&(i(void 0),I++);else{if(Be(T.goDownCell,a,v))L+=1;else if(Be(T.goUpCell,a,v))L-=1;else if(Be(T.goRightCell,a,v)){const Pe=a.key==="Tab"&&!a.shiftKey;if(En===!0&&Pe){const kt=Ne.length-1;I>=kt?L<Wt-1&&(I=D,L+=1):I+=1}else I+=1}else Be(T.goLeftCell,a,v)?I-=1:Be(T.goDownCellRetainSelection,a,v)?(L+=1,J=!0):Be(T.goUpCellRetainSelection,a,v)?(L-=1,J=!0):Be(T.goRightCellRetainSelection,a,v)?(I+=1,J=!0):Be(T.goLeftCellRetainSelection,a,v)?(I-=1,J=!0):Be(T.goToLastRow,a,v)?L=Me-1:Be(T.goToFirstRow,a,v)?L=Number.MIN_SAFE_INTEGER:Be(T.goToLastColumn,a,v)?I=Number.MAX_SAFE_INTEGER:Be(T.goToFirstColumn,a,v)?I=Number.MIN_SAFE_INTEGER:(gt==="rect"||gt==="multi-rect")&&(Be(T.selectGrowDown,a,v)?vn([0,1]):Be(T.selectGrowUp,a,v)?vn([0,-1]):Be(T.selectGrowRight,a,v)?vn([1,0]):Be(T.selectGrowLeft,a,v)?vn([-1,0]):Be(T.selectToLastRow,a,v)?vn([0,2]):Be(T.selectToFirstRow,a,v)?vn([0,-2]):Be(T.selectToLastColumn,a,v)?vn([2,0]):Be(T.selectToFirstColumn,a,v)&&vn([-2,0]));ae=v.didMatch}if(pn!==void 0&&pn!=="normal"&&L!==G){const Pe=pn==="skip-up"||pn==="skip"||pn==="block",kt=pn==="skip-down"||pn==="skip"||pn==="block",$t=L<G;if($t&&Pe){for(;L>=0&&ao(L).isGroupHeader;)L--;L<0&&(L=G)}else if(!$t&&kt){for(;L<Me&&ao(L).isGroupHeader;)L++;L>=Me&&(L=G)}}const ve=Zn(I,L,!1,J),He=v.didMatch,De=a.key==="Tab";return He&&(ve||!ae||$n||En===!0&&De)&&p(),He},[pn,tr,x,ln,j,be,gt,D,ao,Me,Zn,ot,Pt,k.length,ut,$n,uo,wt,Mt,Dt,Do,qn,B,Zo,Ji,Zi,vn,En,Ne.length,Wt]),nr=s.useCallback(a=>{let p=!1;Ve!==void 0&&Ve({...a,...a.location&&{location:[a.location[0]-D,a.location[1]]},cancel:()=>{p=!0}}),!p&&(el(a)||x.current)},[st,Ve,el,x,M,D,Me,Dt,B,Zo]),Ls=s.useCallback((a,p)=>{const v=a.location[0]-D;if(a.kind==="header"&&(ye==null||ye(v,{...a,preventDefault:p})),a.kind===xn){if(v<0)return;K==null||K(v,{...a,preventDefault:p})}if(a.kind==="cell"){const[S,z]=a.location;he==null||he([v,z],{...a,preventDefault:p}),Ra(x,a.location)||Zn(S,z,!1,!1)}},[x,he,K,ye,D,Zn]),pi=s.useCallback(async a=>{var T,I,L;if(!ln.paste)return;function p(G,J,ae,re){var He,De;const ve=typeof ae=="object"?(ae==null?void 0:ae.join(`
`))??"":(ae==null?void 0:ae.toString())??"";if(!Lo(G)&&Po(G)&&G.readonly!==!0){const me=Y==null?void 0:Y(ve,G);if(me!==void 0&&zo(me))return{location:J,value:me};const ie=xt(G);if(ie===void 0)return;if(ie.kind===ee.Custom){en(G.kind===ee.Custom);const lt=(He=ie.onPaste)==null?void 0:He.call(ie,ve,G.data);return lt===void 0?void 0:{location:J,value:{...G,data:lt}}}else{const lt=(De=ie.onPaste)==null?void 0:De.call(ie,ve,G,{formatted:re,formattedString:typeof re=="string"?re:re==null?void 0:re.join(`
`),rawValue:ae});return lt===void 0?void 0:(en(lt.kind===G.kind),{location:J,value:lt})}}}const v=x.columns,S=x.rows,z=((T=it.current)==null?void 0:T.contains(document.activeElement))===!0||((I=l.current)==null?void 0:I.contains(document.activeElement))===!0;let N;if(x.current!==void 0?N=[x.current.range.x,x.current.range.y]:v.length===1?N=[v.first()??0,0]:S.length===1&&(N=[D,S.first()??0]),z&&N!==void 0){let G,J;const ae="text/plain",re="text/html";if(navigator.clipboard.read!==void 0){const me=await navigator.clipboard.read();for(const ie of me){if(ie.types.includes(re)){const Tt=await(await ie.getType(re)).text(),Pe=Il(Tt);if(Pe!==void 0){G=Pe;break}}ie.types.includes(ae)&&(J=await(await ie.getType(ae)).text())}}else if(navigator.clipboard.readText!==void 0)J=await navigator.clipboard.readText();else if(a!==void 0&&(a==null?void 0:a.clipboardData)!==null){if(a.clipboardData.types.includes(re)){const me=a.clipboardData.getData(re);G=Il(me)}G===void 0&&a.clipboardData.types.includes(ae)&&(J=a.clipboardData.getData(ae))}else return;const[ve,He]=N,De=[];do{if(Z===void 0){const me=Qt(N),ie=J??(G==null?void 0:G.map(Tt=>Tt.map(Pe=>Pe.rawValue).join("	")).join("	"))??"",lt=p(me,N,ie,void 0);lt!==void 0&&De.push(lt);break}if(G===void 0){if(J===void 0)return;G=Sd(J)}if(Z===!1||typeof Z=="function"&&(Z==null?void 0:Z([N[0]-D,N[1]],G.map(me=>me.map(ie=>{var lt;return((lt=ie.rawValue)==null?void 0:lt.toString())??""}))))!==!0)return;for(const[me,ie]of G.entries()){if(me+He>=Me)break;for(const[lt,Tt]of ie.entries()){const Pe=[lt+ve,me+He],[kt,$t]=Pe;if(kt>=Ne.length||$t>=Wt)continue;const Cn=Qt(Pe),Tn=p(Cn,Pe,Tt.rawValue,Tt.formatted);Tn!==void 0&&De.push(Tn)}}}while(!1);dn(De),(L=Bt.current)==null||L.damage(De.map(me=>({cell:me.location})))}},[Y,xt,Qt,x,ln.paste,it,Ne.length,dn,Wt,Z,D,Me]);Vt("paste",pi,m,!1,!0);const or=s.useCallback(async(a,p)=>{var T,I;if(!ln.copy)return;const v=p===!0||((T=it.current)==null?void 0:T.contains(document.activeElement))===!0||((I=l.current)==null?void 0:I.contains(document.activeElement))===!0,S=x.columns,z=x.rows,N=(L,G)=>{if(!se)Fl(L,G,a);else{const J=G.map(ae=>({kind:ee.Text,data:k[ae].title,displayData:k[ae].title,allowOverlay:!1}));Fl([J,...L],G,a)}};if(v&&Q!==void 0){if(x.current!==void 0){let L=Q(x.current.range,U.current.signal);typeof L!="object"&&(L=await L()),N(L,ho(x.current.range.x-D,x.current.range.x+x.current.range.width-D))}else if(z!==void 0&&z.length>0){const G=[...z].map(J=>{const ae=Q({x:D,y:J,width:k.length,height:1},U.current.signal);return typeof ae=="object"?ae[0]:ae().then(re=>re[0])});if(G.some(J=>J instanceof Promise)){const J=await Promise.all(G);N(J,ho(k.length))}else N(G,ho(k.length))}else if(S.length>0){const L=[],G=[];for(const J of S){let ae=Q({x:J,y:0,width:1,height:Me},U.current.signal);typeof ae!="object"&&(ae=await ae()),L.push(ae),G.push(J-D)}if(L.length===1)N(L[0],G);else{const J=L.reduce((ae,re)=>ae.map((ve,He)=>[...ve,...re[He]]));N(J,G)}}}},[k,Q,x,ln.copy,D,it,Me,se]);Vt("copy",or,m,!1,!1);const Bs=s.useCallback(async a=>{var v,S;if(!(!ln.cut||!(((v=it.current)==null?void 0:v.contains(document.activeElement))===!0||((S=l.current)==null?void 0:S.contains(document.activeElement))===!0))&&(await or(a),x.current!==void 0)){let z={current:{cell:x.current.cell,range:x.current.range,rangeStack:[]},rows:et.empty(),columns:et.empty()};const N=ut==null?void 0:ut(z);if(N===!1||(z=N===!0?z:N,z.current===void 0))return;uo(z.current.range)}},[uo,x,ln.cut,or,it,ut]);Vt("cut",Bs,m,!1,!1);const Ws=s.useCallback((a,p)=>{if($e!==void 0){D!==0&&(a=a.map(z=>[z[0]-D,z[1]])),$e(a,p);return}if(a.length===0||p===-1)return;const[v,S]=a[p];u.current!==void 0&&u.current[0]===v&&u.current[1]===S||(u.current=[v,S],Zn(v,S,!1,!1))},[$e,D,Zn]),[zr,Pr]=((sl=zt==null?void 0:zt.current)==null?void 0:sl.cell)??[],Lr=s.useRef(Ft);Lr.current=Ft,s.useLayoutEffect(()=>{var a,p,v,S;yi.current&&!Rr.current&&zr!==void 0&&Pr!==void 0&&(zr!==((p=(a=fe.current)==null?void 0:a.current)==null?void 0:p.cell[0])||Pr!==((S=(v=fe.current)==null?void 0:v.current)==null?void 0:S.cell[1]))&&Lr.current(zr,Pr),Rr.current=!1},[zr,Pr]);const tl=x.current!==void 0&&(x.current.cell[0]>=Ne.length||x.current.cell[1]>=Wt);s.useLayoutEffect(()=>{tl&&ot(Ri,!1)},[tl,ot]);const $s=s.useMemo(()=>Dt===!0&&(Ye==null?void 0:Ye.tint)===!0?et.fromSingleSelection(Wt-1):et.empty(),[Wt,Dt,Ye==null?void 0:Ye.tint]),Os=s.useCallback(a=>typeof Kt=="boolean"?Kt:(Kt==null?void 0:Kt(a-D))??!0,[D,Kt]),Ns=s.useMemo(()=>{if(fi===void 0||l.current===null)return null;const{bounds:a,group:p}=fi,v=l.current.getBoundingClientRect();return s.createElement(hd,{bounds:a,group:p,canvasBounds:v,onClose:()=>hi(void 0),onFinish:S=>{hi(void 0),pe==null||pe(p,S)}})},[pe,fi]),Xs=Math.min(Ne.length,Oe+D);s.useImperativeHandle(t,()=>({appendRow:(a,p)=>qn(a+D,p),appendColumn:(a,p)=>Tr(a,p),updateCells:a=>{var p;return D!==0&&(a=a.map(v=>({cell:[v.cell[0]+D,v.cell[1]]}))),(p=Bt.current)==null?void 0:p.damage(a)},getBounds:(a,p)=>{var v;if(!((l==null?void 0:l.current)===null||(it==null?void 0:it.current)===null)){if(a===void 0&&p===void 0){const S=l.current.getBoundingClientRect(),z=S.width/it.current.clientWidth;return{x:S.x-it.current.scrollLeft*z,y:S.y-it.current.scrollTop*z,width:it.current.scrollWidth*z,height:it.current.scrollHeight*z}}return(v=Bt.current)==null?void 0:v.getBounds((a??0)+D,p)}},focus:()=>{var a;return(a=Bt.current)==null?void 0:a.focus()},emit:async a=>{switch(a){case"delete":nr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":nr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":nr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await or(void 0,!0);break;case"paste":await pi();break}},scrollTo:Ft,remeasureColumns:a=>{for(const p of a)Hr(p+D)},getMouseArgsForPosition:(a,p,v)=>{if((Bt==null?void 0:Bt.current)===null)return;const S=Bt.current.getMouseArgsForPosition(a,p,v);if(S!==void 0)return{...S,location:[S.location[0]-D,S.location[1]]}}}),[qn,Tr,Hr,it,or,nr,pi,D,Ft]);const[nl,ol]=Fn??[],Ys=s.useCallback(a=>{const[p,v]=a;if(v===-1){j!=="none"&&(wt(et.fromSingleSelection(p),void 0,!1),_t());return}nl===p&&ol===v||(je({cell:a,range:{x:p,y:v,width:1,height:1}},!0,!1,"keyboard-nav"),Ft(p,v))},[j,_t,Ft,nl,ol,je,wt]),[Gs,_s]=s.useState(!1),rl=s.useRef(Bl(a=>{_s(a)},5)),Ks=s.useCallback(()=>{rl.current(!0),x.current===void 0&&x.columns.length===0&&x.rows.length===0&&c===void 0&&je({cell:[D,Er],range:{x:D,y:Er,width:1,height:1}},!0,!1,"keyboard-select")},[Er,x,c,D,je]),Us=s.useCallback(()=>{rl.current(!1)},[]),[Vs,qs]=s.useMemo(()=>{let a;const p=(Ke==null?void 0:Ke.scrollbarWidthOverride)??Fi(),v=Me+(Dt?1:0);if(typeof In=="number")a=cn+v*In;else{let z=0;const N=Math.min(v,10);for(let T=0;T<N;T++)z+=In(T);z=Math.floor(z/N),a=cn+v*z}a+=p;const S=Ne.reduce((z,N)=>N.width+z,0)+p;return[`${Math.min(1e5,S)}px`,`${Math.min(1e5,a)}px`]},[Ne,Ke==null?void 0:Ke.scrollbarWidthOverride,In,Me,Dt,cn]),js=s.useMemo(()=>Oa(pt),[pt]);return s.createElement(ts.Provider,{value:pt},s.createElement(Id,{style:js,className:de,inWidth:b??Vs,inHeight:C??qs},s.createElement(cd,{fillHandle:Ge,drawFocusRing:Yo,experimental:Ke,fixedShadowX:Pn,fixedShadowY:gr,getRowThemeOverride:wn,headerIcons:Kn,imageWindowLoader:Ln,initialSize:Bn,isDraggable:bo,onDragLeave:mr,onRowMoved:Wn,overscrollX:Sr,overscrollY:Ro,preventDiagonalScrolling:vo,rightElement:Co,rightElementProps:oo,smoothScrollX:Qr,smoothScrollY:wr,className:de,enableGroups:Yn,onCanvasFocused:Ks,onCanvasBlur:Us,canvasRef:l,onContextMenu:Ls,theme:pt,cellXOffset:vs,cellYOffset:Er,accessibilityHeight:lo.height,onDragEnd:Hs,columns:Ne,nonGrowWidth:Xn,drawHeader:mt,onColumnProposeMove:Ds,drawCell:yt,disabledRows:$s,freezeColumns:Xs,lockColumns:D,firstColAccessible:D===0,getCellContent:Qt,minColumnWidth:Nn,maxColumnWidth:io,searchInputRef:d,showSearch:E,onSearchClose:_,highlightRegions:Cs,getCellsForSelection:Q,getGroupDetails:ai,headerHeight:qo,isFocused:Gs,groupHeaderHeight:Yn?xr:0,freezeTrailingRows:Lt+(Dt&&(Ye==null?void 0:Ye.sticky)===!0?1:0),hasAppendRow:Dt,onColumnResize:ge,onColumnResizeEnd:rt,onColumnResizeStart:bt,onCellFocused:Ys,onColumnMoved:Fs,onDragStart:Ts,onHeaderMenuClick:Rs,onHeaderIndicatorClick:Es,onItemHovered:bi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:Ms,onKeyDown:nr,onKeyUp:ce,onMouseDown:xs,onMouseUp:Ss,onDragOverCell:gn,onDrop:Ee,onSearchResultsChanged:Ws,onVisibleRegionChanged:Is,clientSize:an,rowHeight:In,searchResults:V,searchValue:Ae,onSearchValueChange:oe,rows:Wt,scrollRef:it,selection:x,translateX:lo.tx,translateY:lo.ty,verticalBorder:Os,gridRef:Bt,getCellRenderer:xt,resizeIndicator:br}),Ns,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement($d,{...r,validateCell:Ue,bloom:X,id:Ps,getCellRenderer:xt,className:(Ke==null?void 0:Ke.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:dt,imageEditorOverride:g,portalElementRef:yr,onFinishEditing:zs,markdownDivCreateNode:h,isOutsideClick:oi,customEventTarget:Ke==null?void 0:Ke.eventTarget}))))},Yd=s.forwardRef(Xd);function Al(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:d,height:l,x:c,y:f}=r,u=t.maxSize??i.checkboxMaxSize,m=Math.floor(r.y+l/2),g=Nl(u,l,i.cellVerticalPadding),w=Ol(t.contentAlign??"center",c,d,i.cellHorizontalPadding,g),h=$l(w,m,g),b=Xl(c+n,f+o,h);return Bi(t)&&b}const Gd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:ee.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>_d(e,e.cell.data,Bi(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Al(e)&&e.preventDefault()},onClick:e=>{if(Al(e))return{...e.cell,data:ms(e.cell.data)}},onPaste:(e,t)=>{let n=Gr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Li),n===t.data?void 0:{...t,data:n}}};function _d(e,t,n,o,r){if(!n&&t===Gr)return;const{ctx:i,hoverAmount:d,theme:l,rect:c,highlighted:f,hoverX:u,hoverY:m,cell:{contentAlign:g}}=e,{x:w,y:h,width:b,height:C}=c;let k=!1;if(r>0){let y=n?1-r+r*d:.4;if(t===Gr&&(y*=d),y===0)return;y<1&&(k=!0,i.globalAlpha=y)}Ur(i,l,t,w,h,b,C,f,u,m,o,g),k&&(i.globalAlpha=1)}const Kd=on("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Ud=e=>{const{bubbles:t}=e;return s.createElement(Kd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Vd={getAccessibilityString:e=>Yl(e.data),kind:ee.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>qd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Ud,{bubbles:t.data})},onPaste:()=>{}};function qd(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:d,y:l,width:c,height:f}=n;let u=d+o.cellHorizontalPadding;const m=[];for(const g of t){if(u>d+c)break;const w=Xo(g,r,o.baseFontFull).width;m.push({x:u,width:w}),u+=w+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const g of m)An(r,g.x,l+(f-o.bubbleHeight)/2,g.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[g,w]of m.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[g],w.x+o.bubblePadding,l+f/2+_n(r,o))}const jd=on("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Zd=e=>{const{drilldowns:t}=e;return s.createElement(jd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},Jd={getAccessibilityString:e=>Yl(e.data.map(t=>t.text)),kind:ee.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>eu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Zd,{drilldowns:t.data})},onPaste:()=>{}},Ei={};function Qd(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,d=n-i*2,l=4,c=n*r,f=o+i,u=o*3,m=(u+i*2)*r,g=`${e},${t},${r},${n}`;if(Ei[g]!==void 0)return{el:Ei[g],height:c,width:m,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const w=document.createElement("canvas"),h=w.getContext("2d");return h===null?null:(w.width=m,w.height=c,h.scale(r,r),Ei[g]=w,h.beginPath(),An(h,i,i,u,d,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),An(h,i+.5,i+.5,u,d,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:w,height:c,width:m,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function eu(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:d,row:l}=e,{x:c,width:f}=n,u=o.baseFontFull,m=jl(r,u),g=Math.min(n.height,Math.max(16,Math.ceil(m*o.lineHeight)*2)),w=Math.floor(n.y+(n.height-g)/2),h=g-10,b=o.bubblePadding,C=o.bubbleMargin;let k=c+o.cellHorizontalPadding;const y=o.roundingRadius??6,M=Qd(o.bgCell,o.drilldownBorder,g,y),$=[];for(const B of t){if(k>c+f)break;const P=Xo(B.text,r,u).width;let Y=0;B.img!==void 0&&i.loadOrGetImage(B.img,d,l)!==void 0&&(Y=h-8+4);const R=P+Y+b*2;$.push({x:k,width:R}),k+=R+C}if(M!==null){const{el:B,height:A,middleWidth:P,sideWidth:Y,width:R,dpr:O,padding:X}=M,W=Y/O,F=X/O;for(const H of $){const le=Math.floor(H.x),q=Math.floor(H.width),he=q-(W-F)*2;r.imageSmoothingEnabled=!1,r.drawImage(B,0,0,Y,A,le-F,w,W,g),he>0&&r.drawImage(B,Y,0,P,A,le+(W-F),w,he,g),r.drawImage(B,R-Y,0,Y,A,le+q-(W-F),w,W,g),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[B,A]of $.entries()){const P=t[B];let Y=A.x+b;if(P.img!==void 0){const R=i.loadOrGetImage(P.img,d,l);if(R!==void 0){const O=h-8;let X=0,W=0,F=R.width,H=R.height;F>H?(X+=(F-H)/2,F=H):H>F&&(W+=(H-F)/2,H=F),r.beginPath(),An(r,Y,w+g/2-O/2,O,O,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(R,X,W,F,H,Y,w+g/2-O/2,O,O),r.restore(),Y+=O+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(P.text,Y,w+g/2+_n(r,o))}}const tu={getAccessibilityString:e=>e.data.join(", "),kind:ee.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>nu(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ya;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Ii=4;function nu(e,t,n,o){const{rect:r,col:i,row:d,theme:l,ctx:c,imageLoader:f}=e,{x:u,y:m,height:g,width:w}=r,h=g-l.cellVerticalPadding*2,b=[];let C=0;for(let y=0;y<t.length;y++){const M=t[y];if(M.length===0)continue;const $=f.loadOrGetImage(M,i,d);if($!==void 0){b[y]=$;const B=$.width*(h/$.height);C+=B+Ii}}if(C===0)return;C-=Ii;let k=u+l.cellHorizontalPadding;o==="right"?k=Math.floor(u+w-l.cellHorizontalPadding-C):o==="center"&&(k=Math.floor(u+w/2-C/2));for(const y of b){if(y===void 0)continue;const M=y.width*(h/y.height);n>0&&(c.beginPath(),An(c,k,m+l.cellVerticalPadding,M,h,n),c.save(),c.clip()),c.drawImage(y,k,m+l.cellVerticalPadding,M,h),n>0&&c.restore(),k+=M+Ii}}function ou(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const ru={getAccessibilityString:()=>"",kind:ee.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:d}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(ou(n,o)*t.skeletonWidthVariability));const c=d.cellHorizontalPadding;l+c*2>=i.width&&(l=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*d.cellVerticalPadding);An(r,i.x+c,i.y+(i.height-f)/2,l,f,d.roundingRadius??3),r.fillStyle=mo(d.textDark,.1),r.fill()},onPaste:()=>{}},iu=()=>e=>e.targetWidth,zl=on("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[iu(),"px"]}}),lu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:d,validatedSelection:l}=e,c=t.data,f=t.readonly===!0,[u,m]=s.useState(c===""||o),g=s.useCallback(()=>{m(h=>!h)},[]),w=c?"gdg-ml-6":"";return u?s.createElement(zl,{targetWidth:i.width-20},s.createElement(Zr,{autoFocus:!0,highlight:!1,validatedSelection:l,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${w}`,onClick:()=>d(t)},s.createElement(ua,null))):s.createElement(zl,{targetWidth:i.width},s.createElement(va,{contents:c,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${w}`,onClick:g},s.createElement(Wi,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},su={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:hr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Hn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:d,validatedSelection:l}=e;return s.createElement(lu,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:c=>t({...n,data:c.target.value}),forceEditMode:d,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},au={getAccessibilityString:e=>e.row.toString(),kind:nn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:cu,measure:()=>44,draw:e=>uu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e;if(n.disabled===!0)return;const{width:i,height:d}=t,l=n.drawHandle?7+(i-7)/2:i/2,c=d/2;if(Math.abs(o-l)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function cu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=du,n.textAlign="center",i}function du(e){const{ctx:t}=e;t.textAlign="start"}function uu(e,t,n,o,r,i,d){if(d){const{ctx:C,rect:k,theme:y}=e,{x:M,y:$,width:B,height:A}=k,P=o==="checkbox"?"checkbox-visible":o;if(P!=="number"&&(C.globalAlpha=n?1:.4,Ur(C,y,n,r?M+7:M,$,r?B-7:B,A,!1,-20,-20,y.checkboxMaxSize,"center",i,!0),C.globalAlpha=1),P==="number"||P==="both"&&!n){const Y=t.toString(),R=y.markerFontFull,O=M+B/2;C.fillStyle="#cccccc",C.font=R,C.fillText(Y,O,$+A/2+_n(C,R))}if(r){C.globalAlpha=.4,C.beginPath();for(const Y of[3,6])for(const R of[-5,-1,3])C.rect(M+Y,$+A/2+R,2,2);C.fillStyle="#cccccc",C.fill(),C.beginPath(),C.globalAlpha=1}return}const{ctx:l,rect:c,hoverAmount:f,theme:u}=e,{x:m,y:g,width:w,height:h}=c,b=n?1:o==="checkbox-visible"?.6+.4*f:f;if(o!=="number"&&b>0){l.globalAlpha=b;const C=7*(n?f:1);if(Ur(l,u,n,r?m+C:m,g,r?w-C:w,h,!0,void 0,void 0,u.checkboxMaxSize,"center",i,d),r){l.globalAlpha=f,l.beginPath();for(const k of[3,6])for(const y of[-5,-1,3])l.rect(m+k,g+h/2+y,2,2);l.fillStyle=u.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const C=t.toString(),k=u.markerFontFull,y=m+w/2;o==="both"&&f!==0&&(l.globalAlpha=1-f),l.fillStyle=u.textLight,l.font=k,l.fillText(C,y,g+h/2+_n(l,k)),f!==0&&(l.globalAlpha=1)}}const fu={getAccessibilityString:()=>"",kind:nn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>hu(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function hu(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:d,spriteManager:l}=e,{x:c,y:f,width:u,height:m}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,m-2),o.fillStyle=d.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let w=0;if(n!==void 0){const b=m-8,C=c+8/2,k=f+8/2;l.drawSprite(n,"normal",o,C,k,b,d,g?1:i),w=b}else{w=24;const h=12,b=g?h:i*h,C=g?0:(1-i)*h*.5,k=d.cellHorizontalPadding+4;b>0&&(o.moveTo(c+k+C,f+m/2),o.lineTo(c+k+C+b,f+m/2),o.moveTo(c+k+C+b*.5,f+m/2-b*.5),o.lineTo(c+k+C+b*.5,f+m/2+b*.5),o.lineWidth=2,o.strokeStyle=d.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=d.textMedium,o.fillText(t,w+c+d.cellHorizontalPadding+.5,f+m/2+_n(o,d)),o.beginPath()}function ys(e,t,n,o,r,i,d){e.textBaseline="alphabetic";const l=gu(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),An(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??mo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",d==null||d("text")}function gu(e,t,n,o,r){const i=o.cellHorizontalPadding,d=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+d/2+1,width:t.width-i,height:t.height-d-1};const l=Xo(n,e,o.baseFontFull,"alphabetic"),c=t.height-d,f=Math.min(c,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const mu=s.lazy(async()=>await Ll(()=>import("./number-overlay-editor-CrhXxULw.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),wu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:hr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:d}=e,{hoverEffect:l,displayData:c,hoverEffectTheme:f}=n;l===!0&&t>0&&ys(o,r,f,c,i,t,d),Hn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(mu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},bu={getAccessibilityString:()=>"",measure:()=>108,kind:ee.Protected,needsHover:!1,needsHoverPosition:!1,draw:yu,onPaste:()=>{}};function yu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:d}=o;t.beginPath();const l=2.5;let c=r+n.cellHorizontalPadding+l;const f=i+d/2,u=Math.cos(hl(30))*l,m=Math.sin(hl(30))*l;for(let g=0;g<12;g++)t.moveTo(c,f-l),t.lineTo(c,f+l),t.moveTo(c+u,f-m),t.lineTo(c-u,f+m),t.moveTo(c-u,f-m),t.lineTo(c+u,f+m),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const pu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>hr(e,t,e.theme.textLight),draw:e=>Hn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return Et.createElement(Zr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},vu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:hr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:d,overrideCursor:l}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:m,hoverEffectTheme:g}=t;u===!0&&n>0&&ys(r,d,g,c,i,n,l),Hn(e,c,f,m,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Zr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:d=>o({...r,data:d.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Cu=on("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),xu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:d}=e,[l,c]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{c(!0)},[]);return l?s.createElement(Zr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(Cu,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},d),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Wi,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ps(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,d=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-d-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-d/2),{x:r,y:i,width:d,height:l}}function Pl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,d=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=Vl(d,i.baseFontFull);if(l===void 0)return!1;const c=ps(l,n,i,t.contentAlign);return go({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const ku={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:hr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:d,ctx:l}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Xo(c,l,n.baseFontFull),m=ps(u,d,n,t.contentAlign),{x:g,y:w,width:h,height:b}=m;if(r>=g-4&&r<=g-4+h+8&&i>=w-4&&i<=w-4+b+8){const C=_n(l,n.baseFontFull);o("pointer");const k=5,y=w-C;l.beginPath(),l.moveTo(d.x+g,Math.floor(d.y+y+b+k)+.5),l.lineTo(d.x+g+h,Math.floor(d.y+y+b+k)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Hn({...e,rect:{...d,x:d.x-1}},c,t.contentAlign),Hn({...e,rect:{...d,x:d.x-2}},c,t.contentAlign),Hn({...e,rect:{...d,x:d.x+1}},c,t.contentAlign),Hn({...e,rect:{...d,x:d.x+2}},c,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Hn(e,c,t.contentAlign)},onSelect:e=>{Pl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Pl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(xu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:d=>n({...o,data:d.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Su=[au,fu,Gd,Vd,Jd,tu,ru,su,wu,bu,pu,vu,ku],Di=[];class Mu extends Jl{constructor(){super(...arguments);Le(this,"imageLoaded",()=>{});Le(this,"loadedLocations",[]);Le(this,"cache",{});Le(this,"sendLoaded",ra(()=>{this.imageLoaded(new Wo(this.loadedLocations)),this.loadedLocations=[]},20));Le(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let d=0;d<r.cells.length;d++){const l=r.cells[d];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let d=!1;const l=Di.pop()??new Image;let c=!1;const f={img:void 0,cells:[kn(o,r)],url:n,cancel:()=>{c||(c=!0,Di.length<12?Di.unshift(l):d||(l.src=""))}},u=new Promise(m=>l.addEventListener("load",()=>m(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const m=this.cache[i];if(m!==void 0&&!c){m.img=l;for(const g of m.cells)this.loadedLocations.push(Xi(g));d=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,d=this.cache[i];if(d!==void 0){const l=kn(o,r);return d.cells.includes(l)||d.cells.push(l),d.img}else this.loadImage(n,o,r,i)}}const Ru=(e,t)=>{const n=s.useMemo(()=>({...pc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??Su,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new Mu,[e.imageWindowLoader]);return s.createElement(Yd,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Wu=s.forwardRef(Ru);export{dd as C,Wu as D,ee as G,ts as T,Zr as a,jl as b,tn as c,Lu as d,Pu as e,Au as f,_n as g,zo as h,zu as i,dl as j,Lo as k,aa as l,Xo as m,Oa as n,Oo as p,An as r,Bu as u};
