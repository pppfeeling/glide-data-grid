const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-CurjsbOR.js","./iframe-DNtM7szx.js","./preload-helper-C1FmrZbK.js","./index-11sBGtDm.js","./image-window-loader-V3wfVhga.js","./throttle-DwxcRZC0.js","./marked.esm-Bk15hlo4.js","./image-window-loader-DhbFCWIb.css","./flatten-Cfvwb28E.js","./scrolling-data-grid-Cva-q6bk.js","./scrolling-data-grid-wZ406GJK.css","./data-grid-overlay-editor-Cmj_ecGQ.css"])))=>i.map(i=>d[i]);
var Vl=Object.defineProperty;var Bl=(t,o,i)=>o in t?Vl(t,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[o]=i;var hn=(t,o,i)=>Bl(t,typeof o!="symbol"?o+"":o,i);import{r as l,R as fe}from"./iframe-DNtM7szx.js";import{_ as _l}from"./preload-helper-C1FmrZbK.js";import{G as Q,b as No,i as Fo,r as nr,c as Wo,C as X,g as hr,d as Xl,w as ht,e as Yl,f as ql,m as gn,h as rr,I as $o,p as jl,j as Zl,t as Jl,k as Ql,l as Kt,o as lr,n as ir,q as ei,s as Ao,v as oo,x as ti,y as oi,z as ni,A as ri,B as li,D as cr,E as no,F as ii,H as ci,J as sr,K as si,u as mn,L as ai,M as ui,T as di,N as ar,O as fi,P as hi}from"./image-window-loader-V3wfVhga.js";import{m as St,r as Nt,g as gi}from"./throttle-DwxcRZC0.js";import{u as mi,f as ur}from"./flatten-Cfvwb28E.js";import{G as vi}from"./scrolling-data-grid-Cva-q6bk.js";import{s as wn}from"./marked.esm-Bk15hlo4.js";const Z='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Ci=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}<rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},wi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}<rect x="2" y="2" width="16" height="16" rx="4" fill="${i}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},pi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},bi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},yi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${i}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},gr=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},xi=t=>{const o=t.bgColor;return`${Z}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Mi=gr,Ri=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},ki=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},Si=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Ti=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${i}"/>
  </svg>`},zi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},Ei=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},Li=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},Hi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Di=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${i}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${i}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},Ii=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${i}"/>
</svg>`},Fi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},$i=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},Ai=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Gi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},Pi=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${i}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Ki=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},Ni=t=>{const o=t.fgColor,i=t.bgColor;return`
    ${Z}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},Wi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${i}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},Oi=t=>{const o=t.fgColor,i=t.bgColor;return`${Z}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${i}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},Ui=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Vi=t=>{const o=t.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${t.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},Bi={headerRowID:Ci,headerNumber:pi,headerCode:wi,headerString:bi,headerBoolean:yi,headerAudioUri:Mi,headerVideoUri:Ri,headerEmoji:ki,headerImage:Si,headerUri:gr,headerPhone:Ti,headerMarkdown:zi,headerDate:Ei,headerTime:Li,headerEmail:Hi,headerReference:Di,headerIfThenElse:Ii,headerSingleValue:Fi,headerLookup:$i,headerTextTemplate:Ai,headerMath:Gi,headerRollup:Pi,headerJoinStrings:Ki,headerSplitString:Ni,headerGeoDistance:Wi,headerArray:Oi,rowOwnerOverlay:Ui,protectedColumnOverlay:Vi,renameIcon:xi},_i=wn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),Xi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Yi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),qi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),ji=10,Zi=t=>{const{canvasRef:o,cellYOffset:i,rows:d,columns:w,searchInputRef:x,searchValue:D,searchResults:b,onSearchValueChange:R,getCellsForSelection:E,onSearchResultsChanged:v,showSearch:M=!1,onSearchClose:T}=t,[K]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[U,_]=l.useState(""),ve=D??U,V=l.useCallback(H=>{_(H),R==null||R(H)},[R]),[I,N]=l.useState(),pe=l.useRef(I);pe.current=I,l.useEffect(()=>{b!==void 0&&(b.length>0?N(H=>({rowsSearched:d,results:b.length,selectedIndex:(H==null?void 0:H.selectedIndex)??-1})):N(void 0))},[d,b]);const J=l.useRef();J.current===void 0&&(J.current=new AbortController);const he=l.useRef(),[q,ee]=l.useState([]),ne=b??q,Y=l.useCallback(()=>{he.current!==void 0&&(window.cancelAnimationFrame(he.current),he.current=void 0),J.current!==void 0&&J.current.abort(),J.current=new AbortController},[]),Ye=l.useRef(i);Ye.current=i;const Le=l.useCallback(H=>{const ie=new RegExp(H.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let de=Ye.current,De=Math.min(10,d),Ke=0;N(void 0),ee([]);const mt=[],lo=async()=>{var nt;if(E===void 0)return;const Uo=performance.now(),Ot=d-Ke;let vt=E({x:0,y:de,width:w.length,height:Math.min(De,Ot,d-de)},J.current.signal);typeof vt=="function"&&(vt=await vt());let io=!1;for(const[je,be]of vt.entries())for(const[ke,Ze]of be.entries()){let Je;switch(Ze.kind){case Q.Text:case Q.Number:Je=Ze.displayData;break;case Q.Uri:case Q.Markdown:Je=Ze.data;break;case Q.Boolean:Je=typeof Ze.data=="boolean"?Ze.data.toString():void 0;break;case Q.Image:case Q.Bubble:Je=Ze.data.join("🐳");break;case Q.Custom:Je=Ze.copyData;break}Je!==void 0&&ie.test(Je)&&(mt.push([ke,je+de]),io=!0)}const Vo=performance.now();io&&ee([...mt]),Ke+=vt.length,No(Ke<=d);const qe=((nt=pe.current)==null?void 0:nt.selectedIndex)??-1;N({results:mt.length,rowsSearched:Ke,selectedIndex:qe}),v==null||v(mt,qe),de+De>=d?de=0:de+=De;const ot=Vo-Uo,Ct=Math.max(ot,1),wt=ji/Ct;De=Math.ceil(De*wt),Ke<d&&mt.length<1e3&&(he.current=window.requestAnimationFrame(lo))};Y(),he.current=window.requestAnimationFrame(lo)},[Y,w.length,E,v,d]),Re=l.useCallback(()=>{var H;T==null||T(),N(void 0),ee([]),v==null||v([],-1),Y(),(H=o==null?void 0:o.current)==null||H.focus()},[Y,o,T,v]),ro=l.useCallback(H=>{V(H.target.value),b===void 0&&(H.target.value===""?(N(void 0),ee([]),Y()):Le(H.target.value))},[Le,Y,V,b]);l.useEffect(()=>{x.current!==null&&(V(""),N(void 0),q.length>0&&(ee([]),v==null||v([],-1)),M?x.current.focus({preventScroll:!0}):Y())},[M,x]);const gt=l.useCallback(H=>{var de;if((de=H==null?void 0:H.stopPropagation)==null||de.call(H),I===void 0||I.results===0)return;const ie=(I.selectedIndex+1)%I.results;N({...I,selectedIndex:ie}),v==null||v(ne,ie)},[I,v,ne]),He=l.useCallback(H=>{var de;if((de=H==null?void 0:H.stopPropagation)==null||de.call(H),I===void 0||I.results===0)return;let ie=(I.selectedIndex-1)%I.results;ie<0&&(ie+=I.results),N({...I,selectedIndex:ie}),v==null||v(ne,ie)},[v,ne,I]),Ge=l.useCallback(H=>{(H.ctrlKey||H.metaKey)&&H.nativeEvent.code==="KeyF"||H.key==="Escape"?(Re(),H.stopPropagation(),H.preventDefault()):H.key==="Enter"&&(H.shiftKey?He():gt())},[Re,gt,He]);l.useEffect(()=>()=>{Y()},[Y]);const[Wt,Pe]=l.useState(!1);l.useEffect(()=>{if(M)Pe(!0);else{const H=setTimeout(()=>Pe(!1),150);return()=>clearTimeout(H)}},[M]);const Oo=l.useMemo(()=>{if(!M&&!Wt)return null;let H;I!==void 0&&(H=I.results>=1e3?"over 1000":`${I.results} result${I.results!==1?"s":""}`,I.selectedIndex>=0&&(H=`${I.selectedIndex+1} of ${H}`));const ie=Ke=>{Ke.stopPropagation()},De={width:`${d>0?Math.floor(((I==null?void 0:I.rowsSearched)??0)/d*100):0}%`};return l.createElement(_i,{className:"gdg-search-bar"+(M?"":" out"),onMouseDown:ie,onMouseMove:ie,onMouseUp:ie,onClick:ie},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:K,"aria-hidden":!M,"data-testid":"search-input",ref:x,onChange:ro,value:ve,tabIndex:M?void 0:-1,onKeyDownCapture:Ge}),l.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:He,disabled:((I==null?void 0:I.results)??0)===0},Xi),l.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!M,tabIndex:M?void 0:-1,onClick:gt,disabled:((I==null?void 0:I.results)??0)===0},Yi),T!==void 0&&l.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!M,"data-testid":"search-close-button",tabIndex:M?void 0:-1,onClick:Re},qi)),I!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},H)),l.createElement("div",{className:"gdg-search-progress",style:De})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:K},"Type to search")))},[M,Wt,I,d,K,x,ro,ve,Ge,He,gt,T,Re]);return l.createElement(l.Fragment,null,l.createElement(vi,{prelightCells:ne,accessibilityHeight:t.accessibilityHeight,canvasRef:t.canvasRef,cellXOffset:t.cellXOffset,cellYOffset:t.cellYOffset,className:t.className,clientSize:t.clientSize,columns:t.columns,disabledRows:t.disabledRows,enableGroups:t.enableGroups,fillHandle:t.fillHandle,firstColAccessible:t.firstColAccessible,nonGrowWidth:t.nonGrowWidth,fixedShadowX:t.fixedShadowX,fixedShadowY:t.fixedShadowY,freezeColumns:t.freezeColumns,getCellContent:t.getCellContent,getCellRenderer:t.getCellRenderer,getGroupDetails:t.getGroupDetails,getRowThemeOverride:t.getRowThemeOverride,groupHeaderHeight:t.groupHeaderHeight,headerHeight:t.headerHeight,highlightRegions:t.highlightRegions,imageWindowLoader:t.imageWindowLoader,initialSize:t.initialSize,isFilling:t.isFilling,isFocused:t.isFocused,lockColumns:t.lockColumns,maxColumnWidth:t.maxColumnWidth,minColumnWidth:t.minColumnWidth,onHeaderMenuClick:t.onHeaderMenuClick,onHeaderIndicatorClick:t.onHeaderIndicatorClick,onMouseMove:t.onMouseMove,onVisibleRegionChanged:t.onVisibleRegionChanged,overscrollX:t.overscrollX,overscrollY:t.overscrollY,preventDiagonalScrolling:t.preventDiagonalScrolling,rightElement:t.rightElement,rightElementProps:t.rightElementProps,rowHeight:t.rowHeight,rows:t.rows,scrollRef:t.scrollRef,selection:t.selection,theme:t.theme,freezeTrailingRows:t.freezeTrailingRows,hasAppendRow:t.hasAppendRow,translateX:t.translateX,translateY:t.translateY,verticalBorder:t.verticalBorder,onColumnProposeMove:t.onColumnProposeMove,drawFocusRing:t.drawFocusRing,drawCell:t.drawCell,drawHeader:t.drawHeader,experimental:t.experimental,gridRef:t.gridRef,headerIcons:t.headerIcons,isDraggable:t.isDraggable,onCanvasBlur:t.onCanvasBlur,onCanvasFocused:t.onCanvasFocused,onCellFocused:t.onCellFocused,onColumnMoved:t.onColumnMoved,onColumnResize:t.onColumnResize,onColumnResizeEnd:t.onColumnResizeEnd,onColumnResizeStart:t.onColumnResizeStart,onContextMenu:t.onContextMenu,onDragEnd:t.onDragEnd,onDragLeave:t.onDragLeave,onDragOverCell:t.onDragOverCell,onDragStart:t.onDragStart,onDrop:t.onDrop,onItemHovered:t.onItemHovered,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onRowMoved:t.onRowMoved,smoothScrollX:t.smoothScrollX,smoothScrollY:t.smoothScrollY,resizeIndicator:t.resizeIndicator}),Oo)};class Ji extends l.PureComponent{constructor(){super(...arguments);hn(this,"wrapperRef",l.createRef());hn(this,"clickOutside",i=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(i))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(i.target)){let d=i.target;for(;d!==null;){if(d.classList.contains("click-outside-ignore"))return;d=d.parentElement}this.props.onClickOutside()}})}componentDidMount(){const i=this.props.customEventTarget??document;i.addEventListener("pointerdown",this.clickOutside,!0),i.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const i=this.props.customEventTarget??document;i.removeEventListener("pointerdown",this.clickOutside,!0),i.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:i,isOutsideClick:d,customEventTarget:w,...x}=this.props;return l.createElement("div",{...x,ref:this.wrapperRef},this.props.children)}}const Qi=()=>t=>Math.max(16,t.targetHeight-10),ec=wn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Qi(),"px"]}}),tc=t=>{const{bounds:o,group:i,onClose:d,canvasBounds:w,onFinish:x}=t,[D,b]=fe.useState(i);return fe.createElement(Ji,{style:{position:"absolute",left:o.x-w.left+1,top:o.y-w.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:d},fe.createElement(ec,{targetHeight:o.height,"data-testid":"group-rename-input",value:D,onBlur:d,onFocus:R=>R.target.setSelectionRange(0,D.length),onChange:R=>b(R.target.value),onKeyDown:R=>{R.key==="Enter"?x(D):R.key==="Escape"&&d()},autoFocus:!0}))},vn=150;function oc(t,o,i,d){var x;const w=d(o);return((x=w==null?void 0:w.measure)==null?void 0:x.call(w,t,o,i))??vn}function mr(t,o,i,d,w,x,D,b,R){let E=0;const v=w===void 0?[]:w.map(K=>{const U=oc(t,K[d],o,R);return E=Math.max(E,U),U});if(v.length>5&&b){E=0;let K=0;for(const _ of v)K+=_;const U=K/v.length;for(let _=0;_<v.length;_++)v[_]>=U*2?v[_]=0:E=Math.max(E,v[_])}const M=t.font;t.font=o.headerFontFull,E=Math.max(E,t.measureText(i.title).width+o.cellHorizontalPadding*2+(i.icon===void 0?0:28)),t.font=M;const T=Math.max(Math.ceil(x),Math.min(Math.floor(D),Math.ceil(E)));return{...i,width:T}}function nc(t,o,i,d,w,x,D,b,R){const E=l.useRef(o),v=l.useRef(i),M=l.useRef(D);E.current=o,v.current=i,M.current=D;const[T,K]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const I=document.createElement("canvas");return I.style.display="none",I.style.opacity="0",I.style.position="fixed",[I,I.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(T&&document.documentElement.append(T),()=>{T==null||T.remove()}),[T]);const U=l.useRef({}),_=l.useRef(),[ve,V]=l.useState();return l.useLayoutEffect(()=>{const I=v.current;if(I===void 0||t.every(Fo))return;let N=Math.max(1,10-Math.floor(t.length/1e4)),pe=0;N<E.current&&N>1&&(N--,pe=1);const J={x:0,y:0,width:t.length,height:Math.min(E.current,N)},he={x:0,y:E.current-1,width:t.length,height:1};(async()=>{const ee=I(J,R.signal),ne=pe>0?I(he,R.signal):void 0;let Y;typeof ee=="object"?Y=ee:Y=await nr(ee),ne!==void 0&&(typeof ne=="object"?Y=[...Y,...ne]:Y=[...Y,...await nr(ne)]),_.current=t,V(Y)})()},[R.signal,t]),l.useMemo(()=>{let N=t.every(Fo)?t:K===null?t.map(q=>Fo(q)?q:{...q,width:vn}):(K.font=M.current.baseFontFull,t.map((q,ee)=>{if(Fo(q))return q;if(U.current[q.id]!==void 0)return{...q,width:U.current[q.id]};if(ve===void 0||_.current!==t||q.id===void 0)return{...q,width:vn};const ne=mr(K,D,q,ee,ve,w,x,!0,b);return U.current[q.id]=ne.width,ne})),pe=0,J=0;const he=[];for(const[q,ee]of N.entries())pe+=ee.width,ee.grow!==void 0&&ee.grow>0&&(J+=ee.grow,he.push(q));if(pe<d&&he.length>0){const q=[...N],ee=d-pe;let ne=ee;for(let Y=0;Y<he.length;Y++){const Ye=he[Y],Le=(N[Ye].grow??0)/J,Re=Y===he.length-1?ne:Math.min(ne,Math.floor(ee*Le));q[Ye]={...N[Ye],growOffset:Re,width:N[Ye].width+Re},ne-=Re}N=q}return{sizedColumns:N,nonGrowWidth:pe}},[d,t,K,ve,D,w,x,b])}function rc(t,o){return t===void 0?!1:t.length>1&&t.startsWith("_")?Number.parseInt(t.slice(1))===o.keyCode:t.length===1&&t>="a"&&t<="z"?t.toUpperCase().codePointAt(0)===o.keyCode:t===o.key}function G(t,o,i){const d=vr(t,o);return d&&(i.didMatch=!0),d}function vr(t,o){if(t.length===0)return!1;if(t.includes("|")){const R=t.split("|");for(const E of R)if(vr(E,o))return!0;return!1}let i=!1,d=!1,w=!1,x=!1;const D=t.split("+"),b=D.pop();if(!rc(b,o))return!1;if(D[0]==="any")return!0;for(const R of D)switch(R){case"ctrl":i=!0;break;case"shift":d=!0;break;case"alt":w=!0;break;case"meta":x=!0;break;case"primary":Wo.value?x=!0:i=!0;break}return o.altKey===w&&o.ctrlKey===i&&o.shiftKey===d&&o.metaKey===x}function lc(t,o,i,d,w,x,D){const b=fe.useCallback((v,M,T,K)=>{var N;(x==="cell"||x==="multi-cell")&&v!==void 0&&(v={...v,range:{x:v.cell[0],y:v.cell[1],width:1,height:1}}),!D&&v!==void 0&&v.range.width>1&&(v={...v,range:{...v.range,width:1,x:v.cell[0]}});const U=i==="mixed"&&(T||K==="drag")||i==="additive",_=(d==="mixed"||d==="additive")&&U,ve=(w==="mixed"||w==="additive")&&U;let V={current:v===void 0?void 0:{...v,rangeStack:K==="drag"?((N=t.current)==null?void 0:N.rangeStack)??[]:[]},columns:_?t.columns:X.empty(),rows:ve?t.rows:X.empty()};T&&(x==="multi-rect"||x==="multi-cell")&&V.current!==void 0&&t.current!==void 0&&(V={...V,current:{...V.current,rangeStack:[...t.current.rangeStack,t.current.range]}}),o(V,M)},[d,t,i,x,D,w,o]),R=fe.useCallback((v,M,T)=>{v=v??t.rows,M!==void 0&&(v=v.add(M));let K;if(w==="exclusive"&&v.length>0)K={current:void 0,columns:X.empty(),rows:v};else{const U=T&&i==="mixed"||i==="additive",_=T&&d==="mixed"||d==="additive";K={current:U?t.current:void 0,columns:_?t.columns:X.empty(),rows:v}}o(K,!1)},[d,t,i,w,o]),E=fe.useCallback((v,M,T)=>{v=v??t.columns,M!==void 0&&(v=v.add(M));let K;if(d==="exclusive"&&v.length>0)K={current:void 0,rows:X.empty(),columns:v};else{const U=T&&i==="mixed"||i==="additive",_=T&&w==="mixed"||w==="additive";K={current:U?t.current:void 0,rows:_?t.rows:X.empty(),columns:v}}o(K,!1)},[d,t,i,w,o]);return[b,R,E]}function ic(t,o,i,d,w){const x=l.useCallback(E=>{if(t===!0){const v=[];for(let M=E.y;M<E.y+E.height;M++){const T=[];for(let K=E.x;K<E.x+E.width;K++)K<0||M>=w?T.push({kind:Q.Loading,allowOverlay:!1}):T.push(o([K,M]));v.push(T)}return v}return(t==null?void 0:t(E,d.signal))??[]},[d.signal,o,t,w]),D=t!==void 0?x:void 0,b=l.useCallback(E=>{if(D===void 0)return[];const v={...E,x:E.x-i};if(v.x<0){v.x=0,v.width--;const M=D(v,d.signal);return typeof M=="function"?async()=>(await M()).map(T=>[{kind:Q.Loading,allowOverlay:!1},...T]):M.map(T=>[{kind:Q.Loading,allowOverlay:!1},...T])}return D(v,d.signal)},[d.signal,D,i]);return[t!==void 0?b:void 0,D]}function dr(t){return typeof t=="string"?t:`${t}px`}const cc=()=>t=>t.innerWidth,sc=()=>t=>t.innerHeight,ac=wn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[cc()],"w2q57ts-1":[sc()]}}),uc=t=>{const{inWidth:o,inHeight:i,children:d,...w}=t;return l.createElement(ac,{innerHeight:dr(i),innerWidth:dr(o),...w},d)},dc=2,fc=1300;function hc(t,o,i){const d=fe.useRef(0),[w,x]=t??[0,0];fe.useEffect(()=>{if(w===0&&x===0){d.current=0;return}let D=!1,b=0;const R=E=>{var v;if(!D){if(b===0)b=E;else{const M=E-b;d.current=Math.min(1,d.current+M/fc);const T=d.current**1.618*M*dc;(v=o.current)==null||v.scrollBy(w*T,x*T),b=E,i==null||i()}window.requestAnimationFrame(R)}};return window.requestAnimationFrame(R),()=>{D=!0}},[o,w,x,i])}function gc({rowHeight:t,headerHeight:o,groupHeaderHeight:i,theme:d,overscrollX:w,overscrollY:x,scaleToRem:D,remSize:b}){const[R,E,v,M,T,K]=fe.useMemo(()=>{if(!D||b===16)return[t,o,i,d,w,x];const U=b/16,_=t,ve=hr();return[typeof _=="number"?_*U:V=>Math.ceil(_(V)*U),Math.ceil(o*U),Math.ceil(i*U),{...d,headerIconSize:((d==null?void 0:d.headerIconSize)??ve.headerIconSize)*U,cellHorizontalPadding:((d==null?void 0:d.cellHorizontalPadding)??ve.cellHorizontalPadding)*U,cellVerticalPadding:((d==null?void 0:d.cellVerticalPadding)??ve.cellVerticalPadding)*U},Math.ceil((w??0)*U),Math.ceil((x??0)*U)]},[i,o,w,x,b,t,D,d]);return{rowHeight:R,headerHeight:E,groupHeaderHeight:v,theme:M,overscrollX:T,overscrollY:K}}const ft={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function P(t,o){return t===!0?o:t===!1?"":t}function fr(t){const o=Wo.value;return{activateCell:P(t.activateCell," |Enter|shift+Enter"),clear:P(t.clear,"any+Escape"),closeOverlay:P(t.closeOverlay,"any+Escape"),acceptOverlayDown:P(t.acceptOverlayDown,"Enter"),acceptOverlayUp:P(t.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:P(t.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:P(t.acceptOverlayRight,"Tab"),copy:t.copy,cut:t.cut,delete:P(t.delete,o?"Backspace|Delete":"Delete"),downFill:P(t.downFill,"primary+_68"),scrollToSelectedCell:P(t.scrollToSelectedCell,"primary+Enter"),goDownCell:P(t.goDownCell,"ArrowDown"),goDownCellRetainSelection:P(t.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:P(t.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:P(t.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:P(t.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:P(t.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:P(t.goUpCell,"ArrowUp"),goUpCellRetainSelection:P(t.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:P(t.goToFirstCell,"primary+Home"),goToFirstColumn:P(t.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:P(t.goToFirstRow,"primary+ArrowUp"),goToLastCell:P(t.goToLastCell,"primary+End"),goToLastColumn:P(t.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:P(t.goToLastRow,"primary+ArrowDown"),goToNextPage:P(t.goToNextPage,"PageDown"),goToPreviousPage:P(t.goToPreviousPage,"PageUp"),paste:t.paste,rightFill:P(t.rightFill,"primary+_82"),search:P(t.search,"primary+f"),selectAll:P(t.selectAll,"primary+a"),selectColumn:P(t.selectColumn,"ctrl+ "),selectGrowDown:P(t.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:P(t.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:P(t.selectGrowRight,"shift+ArrowRight"),selectGrowUp:P(t.selectGrowUp,"shift+ArrowUp"),selectRow:P(t.selectRow,"shift+ "),selectToFirstCell:P(t.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:P(t.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:P(t.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:P(t.selectToLastCell,"primary+shift+End"),selectToLastColumn:P(t.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:P(t.selectToLastRow,"primary+shift+ArrowDown")}}function mc(t){const o=Xl(t);return fe.useMemo(()=>{if(o===void 0)return fr(ft);const i={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??ft.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??ft.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??ft.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??ft.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??ft.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??ft.selectToLastCell};return fr({...ft,...i})},[o])}function vc(t){function o(d,w,x){if(typeof d=="number")return{headerIndex:d,isCollapsed:!1,depth:w,path:x};const D={headerIndex:d.headerIndex,isCollapsed:d.isCollapsed,depth:w,path:x};return d.subGroups!==void 0&&(D.subGroups=d.subGroups.map((b,R)=>o(b,w+1,[...x,R])).sort((b,R)=>b.headerIndex-R.headerIndex)),D}return t.map((d,w)=>o(d,0,[w])).sort((d,w)=>d.headerIndex-w.headerIndex)}function pn(t,o){const i=[];function d(b,R,E=!1){let v=R!==null?R-b.headerIndex:o-b.headerIndex;if(b.subGroups!==void 0&&(v=b.subGroups[0].headerIndex-b.headerIndex),v--,i.push({rowIndex:-1,headerIndex:b.headerIndex,contentIndex:-1,skip:E,isCollapsed:b.isCollapsed,depth:b.depth,path:b.path,rows:v}),b.subGroups)for(let M=0;M<b.subGroups.length;M++){const T=M<b.subGroups.length-1?b.subGroups[M+1].headerIndex:R;d(b.subGroups[M],T,E||b.isCollapsed)}}const w=vc(t.groups);for(let b=0;b<w.length;b++){const R=b<w.length-1?w[b+1].headerIndex:null;d(w[b],R)}let x=0,D=0;for(const b of i)b.contentIndex=D,D+=b.rows,b.rowIndex=x,x+=b.isCollapsed?1:b.rows+1;return i.filter(b=>b.skip===!1).map(b=>{const{skip:R,...E}=b;return E})}function Cn(t,o){if(o===void 0||pn.length===0)return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1};let i=t;for(const d of o){if(i===0)return{path:[...d.path,-1],originalIndex:d.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:d.rows};if(d.isCollapsed)i--;else{if(i<=d.rows)return{path:[...d.path,i-1],originalIndex:d.headerIndex+i,isGroupHeader:!1,groupIndex:i-1,contentIndex:d.contentIndex+i-1,groupRows:d.rows};i=i-d.rows-1}}return{path:[t],originalIndex:t,isGroupHeader:!1,groupIndex:t,contentIndex:t,groupRows:-1}}function Cc(t,o,i,d){const w=fe.useMemo(()=>t===void 0?void 0:pn(t,o),[t,o]),x=fe.useMemo(()=>w==null?void 0:w.reduce((v,M)=>(v[M.rowIndex]=M,v),{}),[w]),D=fe.useMemo(()=>w===void 0?o:w.reduce((v,M)=>v+(M.isCollapsed?1:M.rows+1),0),[w,o]),b=fe.useMemo(()=>t===void 0||typeof i=="number"&&t.height===i?i:v=>x!=null&&x[v]?t.height:typeof i=="number"?i:i(v),[x,t,i]),R=fe.useCallback(v=>{if(w===void 0)return v;let M=v;for(const T of w){if(M===0)return;if(M--,!T.isCollapsed){if(M<T.rows)return T.contentIndex+M;M-=T.rows}}return v},[w]),E=ht(d??(t==null?void 0:t.themeOverride),fe.useCallback(v=>{if(t===void 0)return d==null?void 0:d(v,v,v);if(d===void 0&&(t==null?void 0:t.themeOverride)===void 0)return;const{isGroupHeader:M,contentIndex:T,groupIndex:K}=Cn(v,w);return M?t.themeOverride:d==null?void 0:d(v,K,T)},[w,d,t]));return t===void 0?{rowHeight:b,rows:o,rowNumberMapper:R,getRowThemeOverride:E}:{rowHeight:b,rows:D,rowNumberMapper:R,getRowThemeOverride:E}}function wc(t,o){const i=fe.useMemo(()=>t===void 0?void 0:pn(t,o),[t,o]);return{getRowGroupingForPath:wr,updateRowGroupingByPath:Cr,mapper:fe.useCallback(d=>{if(typeof d=="number")return Cn(d,i);const w=Cn(d[1],i);return{...w,originalIndex:[d[0],w.originalIndex]}},[i])}}function Cr(t,o,i){const[d,...w]=o;return w[0]===-1?t.map((x,D)=>D===d?{...x,...i}:x):t.map((x,D)=>D===d?{...x,subGroups:Cr(x.subGroups??[],w,i)}:x)}function wr(t,o){const[i,...d]=o;return d[0]===-1?t[i]:wr(t[i].subGroups??[],d)}function pc(t,o){const[i]=l.useState(()=>({value:t,callback:o,facade:{get current(){return i.value},set current(d){const w=i.value;w!==d&&(i.value=d,i.callback(d,w))}}}));return i.callback=o,i.facade}function bc(t,o,i,d,w){const[x,D]=l.useMemo(()=>[o!==void 0&&typeof i=="number"?Math.floor(o/i):0,o!==void 0&&typeof i=="number"?-(o%i):0],[o,i]),b=l.useMemo(()=>({x:d.current.x,y:x,width:d.current.width??1,height:d.current.height??1,ty:D}),[d,D,x]),[R,E,v]=Yl(b),M=l.useRef(w);M.current=w;const T=pc(null,_=>{_!==null&&o!==void 0?_.scrollTop=o:_!==null&&t!==void 0&&(_.scrollLeft=t)}),K=(R.height??1)>1;l.useLayoutEffect(()=>{if(o!==void 0&&T.current!==null&&K){if(T.current.scrollTop===o)return;T.current.scrollTop=o,T.current.scrollTop!==o&&v(),M.current()}},[o,K,v,T]);const U=(R.width??1)>1;return l.useLayoutEffect(()=>{if(t!==void 0&&T.current!==null&&U){if(T.current.scrollLeft===t)return;T.current.scrollLeft=t,T.current.scrollLeft!==t&&v(),M.current()}},[t,U,v,T]),{visibleRegion:R,setVisibleRegion:E,scrollRef:T}}const yc=l.lazy(async()=>await _l(()=>import("./data-grid-overlay-editor-CurjsbOR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url));let xc=0;function Mc(t){return mi(ur(ur(t).filter(o=>o.span!==void 0).map(o=>{var i,d;return Nt((((i=o.span)==null?void 0:i[0])??0)+1,(((d=o.span)==null?void 0:d[1])??0)+1)})))}function Go(t,o){return t===void 0||o===0||t.columns.length===0&&t.current===void 0?t:{current:t.current===void 0?void 0:{cell:[t.current.cell[0]+o,t.current.cell[1]],range:{...t.current.range,x:t.current.range.x+o},rangeStack:t.current.rangeStack.map(i=>({...i,x:i.x+o}))},rows:t.rows,columns:t.columns.offset(o)}}const Po={kind:Q.Loading,allowOverlay:!1},Ko={columns:X.empty(),rows:X.empty(),current:void 0},Rc=(t,o)=>{var er,tr,or;const[i,d]=l.useState(Ko),[w,x]=l.useState(),D=l.useRef(null),b=l.useRef(null),[R,E]=l.useState(),v=l.useRef(),M=typeof window>"u"?null:window,{imageEditorOverride:T,getRowThemeOverride:K,markdownDivCreateNode:U,width:_,height:ve,columns:V,rows:I,getCellContent:N,onCellClicked:pe,onCellActivated:J,onFillPattern:he,onFinishedEditing:q,coercePasteValue:ee,drawHeader:ne,drawCell:Y,editorBloom:Ye,onHeaderClicked:Le,onColumnProposeMove:Re,rangeSelectionColumnSpanning:ro=!0,spanRangeBehavior:gt="default",onGroupHeaderClicked:He,onCellContextMenu:Ge,className:Wt,onHeaderContextMenu:Pe,getCellsForSelection:Oo,onGroupHeaderContextMenu:H,onGroupHeaderRenamed:ie,onCellEdited:de,onCellsEdited:De,onSearchResultsChanged:Ke,searchResults:mt,onSearchValueChange:lo,searchValue:Uo,onKeyDown:Ot,onKeyUp:vt,keybindings:io,editOnType:Vo=!0,onRowAppended:qe,onColumnAppended:ot,onColumnMoved:Ct,validateCell:wt,highlightRegions:nt,rangeSelect:je="rect",columnSelect:be="multi",rowSelect:ke="multi",rangeSelectionBlending:Ze="exclusive",columnSelectionBlending:Je="exclusive",rowSelectionBlending:pr="exclusive",onDelete:Bo,onDragStart:co,onMouseMove:so,onPaste:pt,copyHeaders:bn=!1,freezeColumns:Qe=0,cellActivationBehavior:ao="second-click",rowSelectionMode:_o="auto",columnSelectionMode:Ut="auto",onHeaderMenuClick:uo,onHeaderIndicatorClick:fo,getGroupDetails:ho,rowGrouping:rt,onSearchClose:Xo,onItemHovered:go,onSelectionCleared:lt,showSearch:br,onVisibleRegionChanged:mo,gridSelection:bt,onGridSelectionChange:Tt,minColumnWidth:yr=50,maxColumnWidth:xr=500,maxColumnAutoWidth:Mr,provideEditor:Rr,trailingRowOptions:B,freezeTrailingRows:et=0,allowedFillDirections:yn="orthogonal",scrollOffsetX:kr,scrollOffsetY:Sr,verticalBorder:zt,onDragOverCell:Tr,onDrop:zr,onColumnResize:Vt,onColumnResizeEnd:Bt,onColumnResizeStart:_t,customRenderers:vo,fillHandle:Er,experimental:ae,fixedShadowX:Lr,fixedShadowY:Hr,headerIcons:Dr,imageWindowLoader:Ir,initialSize:Fr,isDraggable:$r,onDragLeave:Ar,onRowMoved:Xt,overscrollX:Gr,overscrollY:Pr,preventDiagonalScrolling:Kr,rightElement:Nr,rightElementProps:Wr,trapFocus:xn=!1,smoothScrollX:Or,smoothScrollY:Ur,scaleToRem:Vr=!1,rowHeight:Br=34,headerHeight:Mn=36,groupHeaderHeight:_r=Mn,theme:Xr,isOutsideClick:Yr,renderers:Yo,resizeIndicator:qr,scrollToActiveCell:Rn=!0,drawFocusRing:kn=!0,portalElementRef:jr}=t,Sn=kn==="no-editor"?w===void 0:kn,te=typeof t.rowMarkers=="string"?void 0:t.rowMarkers,Ne=(te==null?void 0:te.kind)??t.rowMarkers??"none",Zr=(te==null?void 0:te.width)??t.rowMarkerWidth,Tn=(te==null?void 0:te.startIndex)??t.rowMarkerStartIndex??1,zn=(te==null?void 0:te.theme)??t.rowMarkerTheme,En=te==null?void 0:te.headerTheme,Ln=te==null?void 0:te.headerAlwaysVisible,Co=ke!=="multi"||(te==null?void 0:te.headerDisabled)===!0,wo=(te==null?void 0:te.checkboxStyle)??"square",Et=Math.max(yr,20),po=Math.max(xr,Et),Jr=Math.max(Mr??po,Et),Hn=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:F,rowNumberMapper:Dn,rowHeight:Qr,getRowThemeOverride:tt}=Cc(rt,I,Br,K),el=l.useMemo(()=>Number.parseFloat(Hn.fontSize),[Hn]),{rowHeight:it,headerHeight:qo,groupHeaderHeight:In,theme:Fn,overscrollX:tl,overscrollY:ol}=gc({groupHeaderHeight:_r,headerHeight:Mn,overscrollX:Gr,overscrollY:Pr,remSize:el,rowHeight:Qr,scaleToRem:Vr,theme:Xr}),ct=mc(io),Lt=Zr??(I>1e4?48:I>1e3?44:I>100?36:32),Ve=Ne!=="none",a=Ve?1:0,ce=B!==void 0,Yt=(B==null?void 0:B.sticky)===!0,[nl,$n]=l.useState(!1),rl=br??nl,ll=l.useCallback(()=>{Xo!==void 0?Xo():$n(!1)},[Xo]),g=l.useMemo(()=>bt===void 0?void 0:Go(bt,a),[bt,a])??i,Se=l.useRef();Se.current===void 0&&(Se.current=new AbortController),l.useEffect(()=>()=>Se==null?void 0:Se.current.abort(),[]);const[ge,il]=ic(Oo,N,a,Se.current,F),cl=l.useCallback((e,n,r)=>{if(wt===void 0)return!0;const c=[e[0]-a,e[1]];return wt==null?void 0:wt(c,n,r)},[a,wt]),bo=l.useRef(bt),Ie=l.useCallback((e,n)=>{n&&(e=ql(e,ge,a,gt,Se.current)),Tt!==void 0?(bo.current=Go(e,-a),Tt(bo.current)):d(e)},[Tt,ge,a,gt]),Ht=ht(Vt,l.useCallback((e,n,r,c)=>{Vt==null||Vt(V[r-a],n,r-a,c)},[Vt,a,V])),sl=ht(Bt,l.useCallback((e,n,r,c)=>{Bt==null||Bt(V[r-a],n,r-a,c)},[Bt,a,V])),al=ht(_t,l.useCallback((e,n,r,c)=>{_t==null||_t(V[r-a],n,r-a,c)},[_t,a,V])),ul=ht(ne,l.useCallback((e,n)=>(ne==null?void 0:ne({...e,columnIndex:e.columnIndex-a},n))??!1,[ne,a])),dl=ht(Y,l.useCallback((e,n)=>(Y==null?void 0:Y({...e,col:e.col-a},n))??!1,[Y,a])),st=l.useCallback(e=>{if(Bo!==void 0){const n=Bo(Go(e,-a));return typeof n=="boolean"?n:Go(n,a)}return!0},[Bo,a]),[me,ye,ue]=lc(g,Ie,Ze,Je,pr,je,ro),Ce=l.useMemo(()=>gn(hr(),Fn),[Fn]),[jo,fl]=l.useState([0,0,0]),An=l.useMemo(()=>{if(Yo===void 0)return{};const e={};for(const n of Yo)e[n.kind]=n;return e},[Yo]),xe=l.useCallback(e=>e.kind!==Q.Custom?An[e.kind]:vo==null?void 0:vo.find(n=>n.isMatch(e)),[vo,An]);let{sizedColumns:ze,nonGrowWidth:Gn}=nc(V,F,il,jo[0]-(a===0?0:Lt)-jo[2],Et,Jr,Ce,xe,Se.current);Ne!=="none"&&(Gn+=Lt);const Zo=l.useMemo(()=>ze.some(e=>e.group!==void 0),[ze]),qt=Zo?qo+In:qo,Pn=g.rows.length,Kn=Ne==="none"?void 0:Pn===0?!1:Pn===F?!0:void 0,W=l.useMemo(()=>Ne==="none"?ze:[{title:"",width:Lt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:zn,rowMarker:wo,rowMarkerChecked:Kn,headerRowMarkerTheme:En,headerRowMarkerAlwaysVisible:Ln,headerRowMarkerDisabled:Co},...ze],[Ne,ze,Lt,zn,wo,Kn,En,Ln,Co]),Fe=l.useRef({height:1,width:1,x:0,y:0}),yo=l.useRef(!1),{setVisibleRegion:Nn,visibleRegion:yt,scrollRef:j}=bc(kr,Sr,it,Fe,()=>yo.current=!0);Fe.current=yt;const hl=yt.x+a,xo=yt.y,le=l.useRef(null),Me=l.useCallback(e=>{var n;e===!0?(n=le.current)==null||n.focus():window.requestAnimationFrame(()=>{var r;(r=le.current)==null||r.focus()})},[]),we=ce?F+1:F,$e=l.useCallback(e=>{const n=a===0?e:e.map(c=>({...c,location:[c.location[0]-a,c.location[1]]})),r=De==null?void 0:De(n);if(r!==!0)for(const c of n)de==null||de(c.location,c.value);return r},[de,De,a]),[xt,Jo]=l.useState(),Mo=g.current!==void 0&&g.current.range.width*g.current.range.height>1?g.current.range:void 0,Dt=Sn?(er=g.current)==null?void 0:er.cell:void 0,Ro=Dt==null?void 0:Dt[0],ko=Dt==null?void 0:Dt[1],gl=l.useMemo(()=>{if((nt===void 0||nt.length===0)&&(Mo??Ro??ko??xt)===void 0)return;const e=[];if(nt!==void 0)for(const n of nt){const r=W.length-n.range.x-a;r>0&&e.push({color:n.color,range:{...n.range,x:n.range.x+a,width:Math.min(r,n.range.width)},style:n.style})}return xt!==void 0&&e.push({color:rr(Ce.accentColor,0),range:xt,style:"dashed"}),Mo!==void 0&&e.push({color:rr(Ce.accentColor,.5),range:Mo,style:"solid-outline"}),Ro!==void 0&&ko!==void 0&&e.push({color:Ce.accentColor,range:{x:Ro,y:ko,width:1,height:1},style:"solid-outline"}),e.length>0?e:void 0},[xt,Mo,Ro,ko,nt,W.length,Ce.accentColor,a]),Wn=l.useRef(W);Wn.current=W;const Ee=l.useCallback(([e,n],r=!1)=>{var m,u,s,h,C,y,k;const c=ce&&n===we-1;if(e===0&&Ve){if(c)return Po;const p=Dn(n);return p===void 0?Po:{kind:$o.Marker,allowOverlay:!1,checkboxStyle:wo,checked:(g==null?void 0:g.rows.hasIndex(n))===!0,markerKind:Ne==="clickable-number"?"number":Ne,row:Tn+p,drawHandle:Xt!==void 0,cursor:Ne==="clickable-number"?"pointer":void 0}}else if(c){const L=e===a?(B==null?void 0:B.hint)??"":"",S=Wn.current[e];if(((m=S==null?void 0:S.trailingRowOptions)==null?void 0:m.disabled)===!0)return Po;{const A=((u=S==null?void 0:S.trailingRowOptions)==null?void 0:u.hint)??L,$=((s=S==null?void 0:S.trailingRowOptions)==null?void 0:s.addIcon)??(B==null?void 0:B.addIcon);return{kind:$o.NewRow,hint:A,allowOverlay:!1,icon:$}}}else{const p=e-a;if(r||(ae==null?void 0:ae.strict)===!0){const S=Fe.current,A=S.x>p||p>S.x+S.width||S.y>n||n>S.y+S.height||n>=on.current,$=p===((C=(h=S.extras)==null?void 0:h.selected)==null?void 0:C[0])&&n===((y=S.extras)==null?void 0:y.selected[1]);let z=!1;if(((k=S.extras)==null?void 0:k.freezeRegions)!==void 0){for(const O of S.extras.freezeRegions)if(jl(O,p,n)){z=!0;break}}if(A&&!$&&!z)return Po}let L=N([p,n]);return a!==0&&L.span!==void 0&&(L={...L,span:[L.span[0]+a,L.span[1]+a]}),L}},[ce,we,Ve,Dn,wo,g==null?void 0:g.rows,Ne,Tn,Xt,a,B==null?void 0:B.hint,B==null?void 0:B.addIcon,ae==null?void 0:ae.strict,N]),Qo=l.useCallback(e=>{let n=(ho==null?void 0:ho(e))??{name:e};return ie!==void 0&&e!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:r=>rn({group:n.name,bounds:r.bounds})}]}),n},[ho,ie]),It=l.useCallback(e=>{var s;const[n,r]=e.cell,c=W[n],f=(c==null?void 0:c.group)!==void 0?(s=Qo(c.group))==null?void 0:s.overrideTheme:void 0,m=c==null?void 0:c.themeOverride,u=tt==null?void 0:tt(r);x({...e,theme:gn(Ce,f,m,u,e.content.themeOverride)})},[tt,W,Qo,Ce]),Ft=l.useCallback((e,n,r)=>{var u;if(g.current===void 0)return;const[c,f]=g.current.cell,m=Ee([c,f]);if(m.kind!==Q.Boolean&&m.allowOverlay){let s=m;if(r!==void 0)switch(s.kind){case Q.Number:{const h=Zl(()=>r==="-"?-0:Number.parseFloat(r),0);s={...s,data:Number.isNaN(h)?0:h};break}case Q.Text:case Q.Markdown:case Q.Uri:s={...s,data:r};break}It({target:e,content:s,initialValue:r,cell:[c,f],highlight:r===void 0,forceEditMode:r!==void 0,activation:n})}else m.kind===Q.Boolean&&n.inputType==="keyboard"&&m.readonly!==!0&&($e([{location:g.current.cell,value:{...m,data:Jl(m.data)}}]),(u=le.current)==null||u.damage([{cell:g.current.cell}]))},[Ee,g,$e,It]),On=l.useCallback((e,n)=>{var f;const r=(f=le.current)==null?void 0:f.getBounds(e,n);if(r===void 0||j.current===null)return;const c=Ee([e,n]);c.allowOverlay&&It({target:r,content:c,initialValue:void 0,highlight:!0,cell:[e,n],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Ee,j,It]),re=l.useCallback((e,n,r="both",c=0,f=0,m=void 0)=>{if(j.current!==null){const u=le.current,s=b.current,h=typeof e!="number"?e.unit==="cell"?e.amount:void 0:e,C=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,y=typeof e!="number"&&e.unit==="px"?e.amount:void 0,k=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(u!==null&&s!==null){let p={x:0,y:0,width:0,height:0},L=0,S=0;if((h!==void 0||C!==void 0)&&(p=u.getBounds((h??0)+a,C??0)??p,p.width===0||p.height===0))return;const A=s.getBoundingClientRect(),$=A.width/s.offsetWidth;if(y!==void 0&&(p={...p,x:y-A.left-j.current.scrollLeft,width:1}),k!==void 0&&(p={...p,y:k+A.top-j.current.scrollTop,height:1}),p!==void 0){const z={x:p.x-c,y:p.y-f,width:p.width+2*c,height:p.height+2*f};let O=0;for(let fn=0;fn<Qe;fn++)O+=ze[fn].width;let oe=0;const se=et+(Yt?1:0);se>0&&(oe=Ql(we,se,it));let Te=O*$+A.left+a*Lt*$,_e=A.right,Ue=A.top+qt*$,Xe=A.bottom-oe*$;const Do=p.width+c*2;switch(m==null?void 0:m.hAlign){case"start":_e=Te+Do;break;case"end":Te=_e-Do;break;case"center":Te=Math.floor((Te+_e)/2)-Do/2,_e=Te+Do;break}const Io=p.height+f*2;switch(m==null?void 0:m.vAlign){case"start":Xe=Ue+Io;break;case"end":Ue=Xe-Io;break;case"center":Ue=Math.floor((Ue+Xe)/2)-Io/2,Xe=Ue+Io;break}Te>z.x?L=z.x-Te:_e<z.x+z.width&&(L=z.x+z.width-_e),Ue>z.y?S=z.y-Ue:Xe<z.y+z.height&&(S=z.y+z.height-Xe),r==="vertical"||typeof e=="number"&&e<Qe?L=0:(r==="horizontal"||typeof n=="number"&&n>=we-se)&&(S=0),(L!==0||S!==0)&&($!==1&&(L/=$,S/=$),j.current.scrollTo({left:L+j.current.scrollLeft,top:S+j.current.scrollTop,behavior:(m==null?void 0:m.behavior)??"auto"}))}}}},[a,et,Lt,j,qt,Qe,ze,we,Yt,it]),en=l.useRef(On),tn=l.useRef(N);en.current=On,tn.current=N;const on=l.useRef(F);on.current=F;const Un=l.useRef(W.length);Un.current=W.length;const at=l.useCallback(async(e,n=!0,r)=>{var C;const c=W[e];if(((C=c==null?void 0:c.trailingRowOptions)==null?void 0:C.disabled)===!0)return;const f=qe==null?void 0:qe();let m,u=!0;f!==void 0&&(m=await f,m==="top"&&(u=!1),typeof m=="number"&&(u=!1));let s=0;const h=()=>{if(on.current<=F){s<500&&window.setTimeout(h,s),s=50+s*2;return}const y=typeof m=="number"?m:u?F:0;Ho.current(e-a,y,"both",0,0,r?{behavior:r}:void 0),me({cell:[e,y],range:{x:e,y,width:1,height:1}},!1,!1,"edit");const k=tn.current([e-a,y]);k.allowOverlay&&oo(k)&&k.readonly!==!0&&n&&window.setTimeout(()=>{en.current(e,y)},0)};h()},[W,qe,a,F,me]),So=l.useCallback(async(e,n=!0)=>{const r=ot==null?void 0:ot();let c,f=!0;r!==void 0&&(c=await r,c==="left"&&(f=!1),typeof c=="number"&&(f=!1));let m=0;const u=()=>{if(Un.current<=W.length){m<500&&window.setTimeout(u,m),m=50+m*2;return}const s=typeof c=="number"?c:f?W.length:0;re(s-a,e),me({cell:[s,e],range:{x:s,y:e,width:1,height:1}},!1,!1,"edit");const h=tn.current([s-a,e]);h.allowOverlay&&oo(h)&&h.readonly!==!0&&n&&window.setTimeout(()=>{en.current(s,e)},0)};u()},[W,ot,a,re,me]),$t=l.useCallback(e=>{var r,c;const n=((c=(r=ze[e])==null?void 0:r.trailingRowOptions)==null?void 0:c.targetColumn)??(B==null?void 0:B.targetColumn);if(typeof n=="number")return n+(Ve?1:0);if(typeof n=="object"){const f=V.indexOf(n);if(f>=0)return f+(Ve?1:0)}},[ze,V,Ve,B==null?void 0:B.targetColumn]),ut=l.useRef(),At=l.useRef(),jt=l.useCallback((e,n)=>{var f;const[r,c]=n;return gn(Ce,(f=W[r])==null?void 0:f.themeOverride,tt==null?void 0:tt(c),e.themeOverride)},[tt,W,Ce]),{mapper:Mt}=wc(rt,I),We=rt==null?void 0:rt.navigationBehavior,Zt=l.useCallback(e=>{var C,y,k;const n=Wo.value?e.metaKey:e.ctrlKey,r=n&&ke==="multi",[c,f]=e.location,m=g.columns,u=g.rows,[s,h]=((C=g.current)==null?void 0:C.cell)??[];if(e.kind==="cell"){if(At.current=void 0,Rt.current=[c,f],c===0&&Ve){if(ce===!0&&f===F||Ne==="number"||ke==="none")return;const p=Ee(e.location);if(p.kind!==$o.Marker)return;if(Xt!==void 0){const A=xe(p);No((A==null?void 0:A.kind)===$o.Marker);const $=(y=A==null?void 0:A.onClick)==null?void 0:y.call(A,{...e,cell:p,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,theme:jt(p,e.location),preventDefault:()=>{}});if($===void 0||$.checked===p.checked)return}x(void 0),Me();const L=u.hasIndex(f),S=ut.current;if(ke==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&S!==void 0&&u.hasIndex(S)){const A=[Math.min(S,f),Math.max(S,f)+1];r||_o==="multi"?ye(void 0,A,!0):ye(X.fromSingleSelection(A),void 0,r)}else ke==="multi"&&(r||e.isTouch||_o==="multi")?L?ye(u.remove(f),void 0,!0):(ye(void 0,f,!0),ut.current=f):L&&u.length===1?ye(X.empty(),void 0,n):(ye(X.fromSingleSelection(f),void 0,n),ut.current=f)}else if(c>=a&&ce&&f===F){const p=$t(c);at(p??c)}else if(s!==c||h!==f){const p=Ee(e.location),L=xe(p);if((L==null?void 0:L.onSelect)!==void 0){let $=!1;if(L.onSelect({...e,cell:p,posX:e.localEventX,posY:e.localEventY,bounds:e.bounds,preventDefault:()=>$=!0,theme:jt(p,e.location)}),$)return}if(We==="block"&&Mt(f).isGroupHeader)return;const S=Yt&&f===F,A=Yt&&g!==void 0&&((k=g.current)==null?void 0:k.cell[1])===F;if((e.shiftKey||e.isLongTouch===!0)&&s!==void 0&&h!==void 0&&g.current!==void 0&&!A){if(S)return;const $=Math.min(c,s),z=Math.max(c,s),O=Math.min(f,h),oe=Math.max(f,h);me({...g.current,range:{x:$,y:O,width:z-$+1,height:oe-O+1}},!0,n,"click"),ut.current=void 0,Me()}else me({cell:[c,f],range:{x:c,y:f,width:1,height:1}},!0,n,"click"),ut.current=void 0,x(void 0),Me()}}else if(e.kind==="header")if(Rt.current=[c,f],x(void 0),Ve&&c===0)ut.current=void 0,At.current=void 0,!Co&&ke==="multi"&&(u.length!==F?ye(X.fromSingleSelection([0,F]),void 0,n):ye(X.empty(),void 0,n),Me());else{const p=At.current;if(be==="multi"&&(e.shiftKey||e.isLongTouch===!0)&&p!==void 0&&m.hasIndex(p)){const L=[Math.min(p,c),Math.max(p,c)+1];n||e.isTouch||Ut==="multi"?ue(void 0,L,n):ue(X.fromSingleSelection(L),void 0,n)}else be==="multi"&&(n||e.isTouch||Ut==="multi")?(m.hasIndex(c)?ue(m.remove(c),void 0,n):ue(void 0,c,n),At.current=c):be!=="none"&&(m.hasIndex(c)?ue(m.remove(c),void 0,n):ue(X.fromSingleSelection(c),void 0,n),At.current=c);ut.current=void 0,Me()}else e.kind===Kt?Rt.current=[c,f]:e.kind===lr&&!e.isMaybeScrollbar&&(Ie(Ko,!1),x(void 0),Me(),lt==null||lt(),ut.current=void 0,At.current=void 0)},[ke,be,g,Ve,a,ce,F,Ne,Ee,Xt,Me,_o,Ut,xe,jt,ye,$t,at,We,Mt,Yt,me,Co,ue,Ie,lt]),Jt=l.useRef(!1),Rt=l.useRef(),Vn=l.useRef(yt),Ae=l.useRef(),ml=l.useCallback(e=>{if(Gt.current=!1,Vn.current=Fe.current,e.button!==0&&e.button!==1){Ae.current=void 0;return}const n=performance.now();Ae.current={button:e.button,time:n,location:e.location},(e==null?void 0:e.kind)==="header"&&(Jt.current=!0);const r=e.kind==="cell"&&e.isFillHandle;!r&&e.kind!=="cell"&&e.isEdge||(E({previousSelection:g,fillHandle:r}),Rt.current=void 0,!e.isTouch&&e.button===0&&!r?Zt(e):!e.isTouch&&e.button===1&&(Rt.current=e.location))},[g,Zt]),[nn,rn]=l.useState(),Bn=l.useCallback(e=>{if(e.kind!==Kt||be!=="multi")return;const n=Wo.value?e.metaKey:e.ctrlKey,[r]=e.location,c=g.columns;if(r<a)return;const f=W[r];let m=r,u=r;for(let s=r-1;s>=a&&ir(f.group,W[s].group);s--)m--;for(let s=r+1;s<W.length&&ir(f.group,W[s].group);s++)u++;if(Me(),n||e.isTouch||Ut==="multi")if(c.hasAll([m,u+1])){let s=c;for(let h=m;h<=u;h++)s=s.remove(h);ue(s,void 0,n)}else ue(void 0,[m,u+1],n);else ue(X.fromSingleSelection([m,u+1]),void 0,n)},[be,Me,g.columns,W,a,ue,Ut]),Gt=l.useRef(!1),To=l.useCallback(async e=>{if(ge!==void 0&&Ht!==void 0){const n=Fe.current.y,r=Fe.current.height;let c=ge({x:e,y:n,width:1,height:Math.min(r,F-n)},Se.current.signal);typeof c!="object"&&(c=await c());const f=ze[e-a],u=document.createElement("canvas").getContext("2d",{alpha:!1});if(u!==null){u.font=Ce.baseFontFull;const s=mr(u,Ce,f,0,c,Et,po,!1,xe);Ht==null||Ht(f,s.width,e,s.width)}}},[ze,ge,po,Ce,Et,Ht,a,F,xe]),[vl,ln]=l.useState(),Pt=l.useCallback(async(e,n)=>{var s,h;const r=(s=e.current)==null?void 0:s.range;if(r===void 0||ge===void 0||n.current===void 0)return;const c=n.current.range;if(he!==void 0){let C=!1;if(he({fillDestination:{...c,x:c.x-a},patternSource:{...r,x:r.x-a},preventDefault:()=>C=!0}),C)return}let f=ge(r,Se.current.signal);typeof f!="object"&&(f=await f());const m=f,u=[];for(let C=0;C<c.width;C++)for(let y=0;y<c.height;y++){const k=[c.x+C,c.y+y];if(ei(k,r))continue;const p=m[y%r.height][C%r.width];Ao(p)||!oo(p)||u.push({location:k,value:{...p}})}$e(u),(h=le.current)==null||h.damage(u.map(C=>({cell:C.location})))},[ge,$e,he,a]),_n=l.useCallback(()=>{if(g.current===void 0||g.current.range.width<=1)return;const e={...g,current:{...g.current,range:{...g.current.range,width:1}}};Pt(e,g)},[Pt,g]),Xn=l.useCallback(()=>{if(g.current===void 0||g.current.range.height<=1)return;const e={...g,current:{...g.current,range:{...g.current.range,height:1}}};Pt(e,g)},[Pt,g]),Cl=l.useCallback((e,n)=>{var y,k;const r=R;if(E(void 0),Jo(void 0),ln(void 0),Jt.current=!1,n)return;if((r==null?void 0:r.fillHandle)===!0&&g.current!==void 0&&((y=r.previousSelection)==null?void 0:y.current)!==void 0){if(xt===void 0)return;const p={...g,current:{...g.current,range:ti(r.previousSelection.current.range,xt)}};Pt(r.previousSelection,p),Ie(p,!0);return}const[c,f]=e.location,[m,u]=Rt.current??[],s=()=>{Gt.current=!0},h=p=>{var S,A,$;const L=p.isTouch||m===c&&u===f;if(L&&(pe==null||pe([c-a,f],{...p,preventDefault:s})),p.button===1)return!Gt.current;if(!Gt.current){const z=Ee(e.location),O=xe(z);if(O!==void 0&&O.onClick!==void 0&&L){const se=O.onClick({...p,cell:z,posX:p.localEventX,posY:p.localEventY,bounds:p.bounds,theme:jt(z,e.location),preventDefault:s});se!==void 0&&!Ao(se)&&no(se)&&($e([{location:p.location,value:se}]),(S=le.current)==null||S.damage([{cell:p.location}]))}if(Gt.current||g.current===void 0)return!1;let oe=!1;switch(z.activationBehaviorOverride??ao){case"double-click":case"second-click":{if((($=(A=r==null?void 0:r.previousSelection)==null?void 0:A.current)==null?void 0:$.cell)===void 0)break;const[se,Te]=g.current.cell,[_e,Ue]=r.previousSelection.current.cell;oe=c===se&&c===_e&&f===Te&&f===Ue&&(p.isDoubleClick===!0||ao==="second-click");break}case"single-click":{oe=!0;break}}if(oe){const Te={inputType:"pointer",pointerActivation:p.isDoubleClick===!0?"double-click":z.activationBehaviorOverride??ao,pointerType:p.isTouch?"touch":"mouse"};return J==null||J([c-a,f],Te),Ft(p.bounds,Te),!0}}return!1},C=e.location[0]-a;if(e.isTouch){const p=Fe.current,L=Vn.current;if(p.x!==L.x||p.y!==L.y)return;if(e.isLongTouch===!0){if(e.kind==="cell"&&oi((k=g.current)==null?void 0:k.cell,e.location)){Ge==null||Ge([C,e.location[1]],{...e,preventDefault:s});return}else if(e.kind==="header"&&g.columns.hasIndex(c)){Pe==null||Pe(C,{...e,preventDefault:s});return}else if(e.kind===Kt){if(C<0)return;H==null||H(C,{...e,preventDefault:s});return}}e.kind==="cell"?h(e)||Zt(e):e.kind===Kt?He==null||He(C,{...e,preventDefault:s}):(e.kind===ni&&(Le==null||Le(C,{...e,preventDefault:s})),Zt(e));return}if(e.kind==="header"){if(C<0)return;e.isEdge?e.isDoubleClick===!0&&To(c):e.button===0&&c===m&&f===u&&(Le==null||Le(C,{...e,preventDefault:s}))}if(e.kind===Kt){if(C<0)return;e.button===0&&c===m&&f===u&&(He==null||He(C,{...e,preventDefault:s}),Gt.current||Bn(e))}e.kind==="cell"&&(e.button===0||e.button===1)&&h(e),Rt.current=void 0},[R,g,a,xt,Pt,Ie,pe,Ee,xe,ao,jt,$e,J,Ft,Ge,Pe,H,Zt,He,Le,To,Bn]),wl=l.useCallback(e=>{const n={...e,location:[e.location[0]-a,e.location[1]]};so==null||so(n),R!==void 0&&e.buttons===0&&(E(void 0),Jo(void 0),ln(void 0),Jt.current=!1),ln(r=>{var c;return Jt.current?[e.scrollEdge[0],0]:e.scrollEdge[0]===(r==null?void 0:r[0])&&e.scrollEdge[1]===r[1]?r:R===void 0||(((c=Ae.current)==null?void 0:c.location[0])??0)<a?void 0:e.scrollEdge})},[R,so,a]),pl=l.useCallback((e,n)=>{uo==null||uo(e-a,n)},[uo,a]),bl=l.useCallback((e,n)=>{fo==null||fo(e-a,n)},[fo,a]),Be=(tr=g==null?void 0:g.current)==null?void 0:tr.cell,yl=l.useCallback((e,n,r,c,f,m)=>{yo.current=!1;let u=Be;u!==void 0&&(u=[u[0]-a,u[1]]);const s=Qe===0?void 0:{x:0,y:e.y,width:Qe,height:e.height},h=[];s!==void 0&&h.push(s),et>0&&(h.push({x:e.x-a,y:F-et,width:e.width,height:et}),Qe>0&&h.push({x:0,y:F-et,width:Qe,height:et}));const C={x:e.x-a,y:e.y,width:e.width,height:ce&&e.y+e.height>=F?e.height-1:e.height,tx:f,ty:m,extras:{selected:u,freezeRegion:s,freezeRegions:h}};Fe.current=C,Nn(C),fl([n,r,c]),mo==null||mo(C,C.tx,C.ty,C.extras)},[Be,a,ce,F,Qe,et,Nn,mo]),xl=ht(Re,l.useCallback((e,n)=>(Re==null?void 0:Re(e-a,n-a))!==!1,[Re,a])),Ml=ht(Ct,l.useCallback((e,n)=>{Ct==null||Ct(e-a,n-a),be!=="none"&&ue(X.fromSingleSelection(n),void 0,!0)},[be,Ct,a,ue])),cn=l.useRef(!1),Rl=l.useCallback(e=>{if(e.location[0]===0&&a>0){e.preventDefault();return}co==null||co({...e,location:[e.location[0]-a,e.location[1]]}),e.defaultPrevented()||(cn.current=!0),E(void 0)},[co,a]),kl=l.useCallback(()=>{cn.current=!1},[]),Yn=rt==null?void 0:rt.selectionBehavior,zo=l.useCallback(e=>{if(Yn!=="block-spanning")return;const{isGroupHeader:n,path:r,groupRows:c}=Mt(e);if(n)return[e,e];const f=r[r.length-1],m=e-f,u=e+c-f-1;return[m,u]},[Mt,Yn]),sn=l.useRef(),an=l.useCallback(e=>{var n,r,c;if(!ri(e,sn.current)&&(sn.current=e,!(((n=Ae==null?void 0:Ae.current)==null?void 0:n.button)!==void 0&&Ae.current.button>=1))){if(e.buttons!==0&&R!==void 0&&((r=Ae.current)==null?void 0:r.location[0])===0&&a===1&&ke==="multi"&&R.previousSelection&&!R.previousSelection.rows.hasIndex(Ae.current.location[1])&&g.rows.hasIndex(Ae.current.location[1])){const f=Math.min(Ae.current.location[1],e.location[1]),m=Math.max(Ae.current.location[1],e.location[1])+1;ye(X.fromSingleSelection([f,m]),void 0,!1)}else if(e.buttons!==0&&R!==void 0&&g.current!==void 0&&!cn.current&&!Jt.current&&(je==="rect"||je==="multi-rect")){const[f,m]=g.current.cell;let[u,s]=e.location;if(s<0&&(s=Fe.current.y),R.fillHandle===!0&&((c=R.previousSelection)==null?void 0:c.current)!==void 0){const h=R.previousSelection.current.range;s=Math.min(s,ce?F-1:F);const C=li(h,u,s,yn);Jo(C)}else{if(ce&&m===F)return;if(ce&&s===F)if(e.kind===lr)s--;else return;u=Math.max(u,a);const y=zo(m);s=y===void 0?s:St(s,y[0],y[1]);const k=u-f,p=s-m,L={x:k>=0?f:u,y:p>=0?m:s,width:Math.abs(k)+1,height:Math.abs(p)+1};me({...g.current,range:L},!0,!1,"drag")}}go==null||go({...e,location:[e.location[0]-a,e.location[1]]})}},[R,a,ke,g,je,go,ye,ce,F,yn,zo,me]),Sl=l.useCallback(()=>{var u,s;const e=sn.current;if(e===void 0)return;const[n,r]=e.scrollEdge;let[c,f]=e.location;const m=Fe.current;n===-1?c=((s=(u=m.extras)==null?void 0:u.freezeRegion)==null?void 0:s.x)??m.x:n===1&&(c=m.x+m.width),r===-1?f=Math.max(0,m.y):r===1&&(f=Math.min(F-1,m.y+m.height)),c=St(c,0,W.length-1),f=St(f,0,F-1),an({...e,location:[c,f]})},[W.length,an,F]);hc(vl,j,Sl);const Oe=l.useCallback(e=>{if(g.current===void 0)return;const[n,r]=e,[c,f]=g.current.cell,m=g.current.range;let u=m.x,s=m.x+m.width,h=m.y,C=m.y+m.height;const[y,k]=zo(f)??[0,F-1],p=k+1;if(r!==0)switch(r){case 2:{C=p,h=f,re(0,C,"vertical");break}case-2:{h=y,C=f+1,re(0,h,"vertical");break}case 1:{h<f?(h++,re(0,h,"vertical")):(C=Math.min(p,C+1),re(0,C,"vertical"));break}case-1:{C>f+1?(C--,re(0,C,"vertical")):(h=Math.max(y,h-1),re(0,h,"vertical"));break}default:cr()}if(n!==0)if(n===2)s=W.length,u=c,re(s-1-a,0,"horizontal");else if(n===-2)u=a,s=c+1,re(u-a,0,"horizontal");else{let L=[];if(ge!==void 0){const S=ge({x:u,y:h,width:s-u-a,height:C-h},Se.current.signal);typeof S=="object"&&(L=Mc(S))}if(n===1){let S=!1;if(u<c){if(L.length>0){const A=Nt(u+1,c+1).find($=>!L.includes($-a));A!==void 0&&(u=A,S=!0)}else u++,S=!0;S&&re(u,0,"horizontal")}S||(s=Math.min(W.length,s+1),re(s-1-a,0,"horizontal"))}else if(n===-1){let S=!1;if(s>c+1){if(L.length>0){const A=Nt(s-1,c,-1).find($=>!L.includes($-a));A!==void 0&&(s=A,S=!0)}else s--,S=!0;S&&re(s-a,0,"horizontal")}S||(u=Math.max(a,u-1),re(u-a,0,"horizontal"))}else cr()}me({cell:g.current.cell,range:{x:u,y:h,width:s-u,height:C-h}},!0,!1,"keyboard-select")},[ge,zo,g,W.length,a,F,re,me]),un=l.useRef(Rn);un.current=Rn;const dt=l.useCallback((e,n,r,c)=>{const f=we-(r?0:1);e=St(e,a,ze.length-1+a),n=St(n,0,f);const m=Be==null?void 0:Be[0],u=Be==null?void 0:Be[1];if(e===m&&n===u)return!1;if(c&&g.current!==void 0){const s=[...g.current.rangeStack];(g.current.range.width>1||g.current.range.height>1)&&s.push(g.current.range),Ie({...g,current:{cell:[e,n],range:{x:e,y:n,width:1,height:1},rangeStack:s}},!0)}else me({cell:[e,n],range:{x:e,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return v.current!==void 0&&v.current[0]===e&&v.current[1]===n&&(v.current=void 0),un.current&&re(e-a,n),!0},[we,a,ze.length,Be,g,re,Ie,me]),Tl=l.useCallback((e,n)=>{(w==null?void 0:w.cell)!==void 0&&e!==void 0&&no(e)&&($e([{location:w.cell,value:e}]),window.requestAnimationFrame(()=>{var f;(f=le.current)==null||f.damage([{cell:w.cell}])})),Me(!0),x(void 0);const[r,c]=n;if(g.current!==void 0&&(r!==0||c!==0)){const f=g.current.cell[1]===we-1&&e!==void 0,m=g.current.cell[0]===W.length-1&&e!==void 0;let u=!0;if(f&&c===1&&qe!==void 0){u=!1;const s=g.current.cell[0]+r,h=$t(s);at(h??s,!1)}if(m&&r===1&&ot!==void 0){u=!1;const s=g.current.cell[1]+c;So(s,!1)}if(u){const s=St(g.current.cell[0]+r,0,W.length-1),h=St(g.current.cell[1]+c,0,we-1);dt(s,h,f,!1),r===0&&c===1&&window.setTimeout(()=>{var y;const C=N([s-a,h]);if(oo(C)){const k=(y=le.current)==null?void 0:y.getBounds(s,h);if(k&&C.allowOverlay){le.current&&le.current.focus();const p={current:{cell:[s,h],range:{x:s,y:h,width:1,height:1},rangeStack:[]},columns:X.empty(),rows:X.empty()};Tt==null||Tt(p);const L={inputType:"keyboard",key:"Enter"};J==null||J([s-a,h],L),It({target:k,content:C,initialValue:void 0,cell:[s,h],highlight:!0,forceEditMode:!0,activation:L})}}},50)}}q==null||q(e,n)},[w==null?void 0:w.cell,Me,g,q,$e,we,dt,W.length,at,So,qe,ot,$t,le,N,a,J,Ft,It]),zl=l.useMemo(()=>`gdg-overlay-${xc++}`,[]),kt=l.useCallback(e=>{var r,c,f,m;Me();const n=[];for(let u=e.x;u<e.x+e.width;u++)for(let s=e.y;s<e.y+e.height;s++){const h=N([u-a,s]);if(!h.allowOverlay&&h.kind!==Q.Boolean)continue;let C;if(h.kind===Q.Custom){const y=xe(h),k=(r=y==null?void 0:y.provideEditor)==null?void 0:r.call(y,{...h,location:[u-a,s]});(y==null?void 0:y.onDelete)!==void 0?C=y.onDelete(h):ii(k)&&(C=(c=k==null?void 0:k.deletedValue)==null?void 0:c.call(k,h))}else if(no(h)&&h.allowOverlay||h.kind===Q.Boolean){const y=xe(h);C=(f=y==null?void 0:y.onDelete)==null?void 0:f.call(y,h)}C!==void 0&&!Ao(C)&&no(C)&&n.push({location:[u,s],value:C})}$e(n),(m=le.current)==null||m.damage(n.map(u=>({cell:u.location})))},[Me,N,xe,$e,a]),Qt=w!==void 0,qn=l.useCallback(e=>{var A,$;const n=()=>{e.stopPropagation(),e.preventDefault()},r={didMatch:!1},{bounds:c}=e,f=g.columns,m=g.rows,u=ct;if(!Qt&&G(u.clear,e,r))Ie(Ko,!1),lt==null||lt();else if(!Qt&&G(u.selectAll,e,r))Ie({columns:X.empty(),rows:X.empty(),current:{cell:((A=g.current)==null?void 0:A.cell)??[a,0],range:{x:a,y:0,width:V.length,height:F},rangeStack:[]}},!1);else if(G(u.search,e,r))($=D==null?void 0:D.current)==null||$.focus({preventScroll:!0}),$n(!0);else if(G(u.delete,e,r)){const z=(st==null?void 0:st(g))??!0;if(z!==!1){const O=z===!0?g:z;if(O.current!==void 0){kt(O.current.range);for(const oe of O.current.rangeStack)kt(oe)}for(const oe of O.rows)kt({x:a,y:oe,width:V.length,height:1});for(const oe of O.columns)kt({x:oe,y:0,width:1,height:F})}}if(r.didMatch)return n(),!0;if(g.current===void 0)return!1;let[s,h]=g.current.cell;const[,C]=g.current.cell;let y=!1,k=!1;if(G(u.scrollToSelectedCell,e,r))Ho.current(s-a,h);else if(be!=="none"&&G(u.selectColumn,e,r))f.hasIndex(s)?ue(f.remove(s),void 0,!0):be==="single"?ue(X.fromSingleSelection(s),void 0,!0):ue(void 0,s,!0);else if(ke!=="none"&&G(u.selectRow,e,r))m.hasIndex(h)?ye(m.remove(h),void 0,!0):ke==="single"?ye(X.fromSingleSelection(h),void 0,!0):ye(void 0,h,!0);else if(!Qt&&c!==void 0&&G(u.activateCell,e,r))if(h===F&&ce)window.setTimeout(()=>{const z=$t(s);at(z??s)},0);else{const z={inputType:"keyboard",key:e.key};J==null||J([s-a,h],z),Ft(c,z)}else g.current.range.height>1&&G(u.downFill,e,r)?Xn():g.current.range.width>1&&G(u.rightFill,e,r)?_n():G(u.goToNextPage,e,r)?h+=Math.max(1,Fe.current.height-4):G(u.goToPreviousPage,e,r)?h-=Math.max(1,Fe.current.height-4):G(u.goToFirstCell,e,r)?(x(void 0),h=0,s=0):G(u.goToLastCell,e,r)?(x(void 0),h=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER):G(u.selectToFirstCell,e,r)?(x(void 0),Oe([-2,-2])):G(u.selectToLastCell,e,r)?(x(void 0),Oe([2,2])):Qt?(G(u.closeOverlay,e,r)&&x(void 0),G(u.acceptOverlayDown,e,r)&&(x(void 0),h++),G(u.acceptOverlayUp,e,r)&&(x(void 0),h--),G(u.acceptOverlayLeft,e,r)&&(x(void 0),s--),G(u.acceptOverlayRight,e,r)&&(x(void 0),s++)):(G(u.goDownCell,e,r)?h+=1:G(u.goUpCell,e,r)?h-=1:G(u.goRightCell,e,r)?s+=1:G(u.goLeftCell,e,r)?s-=1:G(u.goDownCellRetainSelection,e,r)?(h+=1,y=!0):G(u.goUpCellRetainSelection,e,r)?(h-=1,y=!0):G(u.goRightCellRetainSelection,e,r)?(s+=1,y=!0):G(u.goLeftCellRetainSelection,e,r)?(s-=1,y=!0):G(u.goToLastRow,e,r)?h=F-1:G(u.goToFirstRow,e,r)?h=Number.MIN_SAFE_INTEGER:G(u.goToLastColumn,e,r)?s=Number.MAX_SAFE_INTEGER:G(u.goToFirstColumn,e,r)?s=Number.MIN_SAFE_INTEGER:(je==="rect"||je==="multi-rect")&&(G(u.selectGrowDown,e,r)?Oe([0,1]):G(u.selectGrowUp,e,r)?Oe([0,-1]):G(u.selectGrowRight,e,r)?Oe([1,0]):G(u.selectGrowLeft,e,r)?Oe([-1,0]):G(u.selectToLastRow,e,r)?Oe([0,2]):G(u.selectToFirstRow,e,r)?Oe([0,-2]):G(u.selectToLastColumn,e,r)?Oe([2,0]):G(u.selectToFirstColumn,e,r)&&Oe([-2,0])),k=r.didMatch);if(We!==void 0&&We!=="normal"&&h!==C){const z=We==="skip-up"||We==="skip"||We==="block",O=We==="skip-down"||We==="skip"||We==="block",oe=h<C;if(oe&&z){for(;h>=0&&Mt(h).isGroupHeader;)h--;h<0&&(h=C)}else if(!oe&&O){for(;h<F&&Mt(h).isGroupHeader;)h++;h>=F&&(h=C)}}const L=dt(s,h,!1,y),S=r.didMatch;return S&&(L||!k||xn)&&n(),S},[We,Qt,g,ct,be,ke,je,a,Mt,F,dt,Ie,lt,V.length,st,xn,kt,ue,ye,ce,$t,at,J,Ft,Xn,_n,Oe]),eo=l.useCallback(e=>{let n=!1;Ot!==void 0&&Ot({...e,...e.location&&{location:[e.location[0]-a,e.location[1]]},cancel:()=>{n=!0}}),!n&&(qn(e)||g.current)},[Vo,Ot,qn,g,N,a,F,ce,J,Ft]),El=l.useCallback((e,n)=>{const r=e.location[0]-a;if(e.kind==="header"&&(Pe==null||Pe(r,{...e,preventDefault:n})),e.kind===Kt){if(r<0)return;H==null||H(r,{...e,preventDefault:n})}if(e.kind==="cell"){const[c,f]=e.location;Ge==null||Ge([r,f],{...e,preventDefault:n}),ci(g,e.location)||dt(c,f,!1,!1)}},[g,Ge,H,Pe,a,dt]),dn=l.useCallback(async e=>{var u,s,h;if(!ct.paste)return;function n(C,y,k,p){var S,A;const L=typeof k=="object"?(k==null?void 0:k.join(`
`))??"":(k==null?void 0:k.toString())??"";if(!Ao(C)&&oo(C)&&C.readonly!==!0){const $=ee==null?void 0:ee(L,C);if($!==void 0&&no($))return{location:y,value:$};const z=xe(C);if(z===void 0)return;if(z.kind===Q.Custom){No(C.kind===Q.Custom);const O=(S=z.onPaste)==null?void 0:S.call(z,L,C.data);return O===void 0?void 0:{location:y,value:{...C,data:O}}}else{const O=(A=z.onPaste)==null?void 0:A.call(z,L,C,{formatted:p,formattedString:typeof p=="string"?p:p==null?void 0:p.join(`
`),rawValue:k});return O===void 0?void 0:(No(O.kind===C.kind),{location:y,value:O})}}}const r=g.columns,c=g.rows,f=((u=j.current)==null?void 0:u.contains(document.activeElement))===!0||((s=b.current)==null?void 0:s.contains(document.activeElement))===!0;let m;if(g.current!==void 0?m=[g.current.range.x,g.current.range.y]:r.length===1?m=[r.first()??0,0]:c.length===1&&(m=[a,c.first()??0]),f&&m!==void 0){let C,y;const k="text/plain",p="text/html";if(navigator.clipboard.read!==void 0){const $=await navigator.clipboard.read();for(const z of $){if(z.types.includes(p)){const oe=await(await z.getType(p)).text(),se=sr(oe);if(se!==void 0){C=se;break}}z.types.includes(k)&&(y=await(await z.getType(k)).text())}}else if(navigator.clipboard.readText!==void 0)y=await navigator.clipboard.readText();else if(e!==void 0&&(e==null?void 0:e.clipboardData)!==null){if(e.clipboardData.types.includes(p)){const $=e.clipboardData.getData(p);C=sr($)}C===void 0&&e.clipboardData.types.includes(k)&&(y=e.clipboardData.getData(k))}else return;const[L,S]=m,A=[];do{if(pt===void 0){const $=Ee(m),z=y??(C==null?void 0:C.map(oe=>oe.map(se=>se.rawValue).join("	")).join("	"))??"",O=n($,m,z,void 0);O!==void 0&&A.push(O);break}if(C===void 0){if(y===void 0)return;C=si(y)}if(pt===!1||typeof pt=="function"&&(pt==null?void 0:pt([m[0]-a,m[1]],C.map($=>$.map(z=>{var O;return((O=z.rawValue)==null?void 0:O.toString())??""}))))!==!0)return;for(const[$,z]of C.entries()){if($+S>=F)break;for(const[O,oe]of z.entries()){const se=[O+L,$+S],[Te,_e]=se;if(Te>=W.length||_e>=we)continue;const Ue=Ee(se),Xe=n(Ue,se,oe.rawValue,oe.formatted);Xe!==void 0&&A.push(Xe)}}}while(!1);$e(A),(h=le.current)==null||h.damage(A.map($=>({cell:$.location})))}},[ee,xe,Ee,g,ct.paste,j,W.length,$e,we,pt,a,F]);mn("paste",dn,M,!1,!0);const to=l.useCallback(async(e,n)=>{var u,s;if(!ct.copy)return;const r=n===!0||((u=j.current)==null?void 0:u.contains(document.activeElement))===!0||((s=b.current)==null?void 0:s.contains(document.activeElement))===!0,c=g.columns,f=g.rows,m=(h,C)=>{if(!bn)ar(h,C,e);else{const y=C.map(k=>({kind:Q.Text,data:V[k].title,displayData:V[k].title,allowOverlay:!1}));ar([y,...h],C,e)}};if(r&&ge!==void 0){if(g.current!==void 0){let h=ge(g.current.range,Se.current.signal);typeof h!="object"&&(h=await h()),m(h,Nt(g.current.range.x-a,g.current.range.x+g.current.range.width-a))}else if(f!==void 0&&f.length>0){const C=[...f].map(y=>{const k=ge({x:a,y,width:V.length,height:1},Se.current.signal);return typeof k=="object"?k[0]:k().then(p=>p[0])});if(C.some(y=>y instanceof Promise)){const y=await Promise.all(C);m(y,Nt(V.length))}else m(C,Nt(V.length))}else if(c.length>0){const h=[],C=[];for(const y of c){let k=ge({x:y,y:0,width:1,height:F},Se.current.signal);typeof k!="object"&&(k=await k()),h.push(k),C.push(y-a)}if(h.length===1)m(h[0],C);else{const y=h.reduce((k,p)=>k.map((L,S)=>[...L,...p[S]]));m(y,C)}}}},[V,ge,g,ct.copy,a,j,F,bn]);mn("copy",to,M,!1,!1);const Ll=l.useCallback(async e=>{var r,c;if(!(!ct.cut||!(((r=j.current)==null?void 0:r.contains(document.activeElement))===!0||((c=b.current)==null?void 0:c.contains(document.activeElement))===!0))&&(await to(e),g.current!==void 0)){let f={current:{cell:g.current.cell,range:g.current.range,rangeStack:[]},rows:X.empty(),columns:X.empty()};const m=st==null?void 0:st(f);if(m===!1||(f=m===!0?f:m,f.current===void 0))return;kt(f.current.range)}},[kt,g,ct.cut,to,j,st]);mn("cut",Ll,M,!1,!1);const Hl=l.useCallback((e,n)=>{if(Ke!==void 0){a!==0&&(e=e.map(f=>[f[0]-a,f[1]])),Ke(e,n);return}if(e.length===0||n===-1)return;const[r,c]=e[n];v.current!==void 0&&v.current[0]===r&&v.current[1]===c||(v.current=[r,c],dt(r,c,!1,!1))},[Ke,a,dt]),[Eo,Lo]=((or=bt==null?void 0:bt.current)==null?void 0:or.cell)??[],Ho=l.useRef(re);Ho.current=re,l.useLayoutEffect(()=>{var e,n,r,c;un.current&&!yo.current&&Eo!==void 0&&Lo!==void 0&&(Eo!==((n=(e=bo.current)==null?void 0:e.current)==null?void 0:n.cell[0])||Lo!==((c=(r=bo.current)==null?void 0:r.current)==null?void 0:c.cell[1]))&&Ho.current(Eo,Lo),yo.current=!1},[Eo,Lo]);const jn=g.current!==void 0&&(g.current.cell[0]>=W.length||g.current.cell[1]>=we);l.useLayoutEffect(()=>{jn&&Ie(Ko,!1)},[jn,Ie]);const Dl=l.useMemo(()=>ce===!0&&(B==null?void 0:B.tint)===!0?X.fromSingleSelection(we-1):X.empty(),[we,ce,B==null?void 0:B.tint]),Il=l.useCallback(e=>typeof zt=="boolean"?zt:(zt==null?void 0:zt(e-a))??!0,[a,zt]),Fl=l.useMemo(()=>{if(nn===void 0||b.current===null)return null;const{bounds:e,group:n}=nn,r=b.current.getBoundingClientRect();return l.createElement(tc,{bounds:e,group:n,canvasBounds:r,onClose:()=>rn(void 0),onFinish:c=>{rn(void 0),ie==null||ie(n,c)}})},[ie,nn]),$l=Math.min(W.length,Qe+(Ve?1:0));l.useImperativeHandle(o,()=>({appendRow:(e,n)=>at(e+a,n),appendColumn:(e,n)=>So(e,n),updateCells:e=>{var n;return a!==0&&(e=e.map(r=>({cell:[r.cell[0]+a,r.cell[1]]}))),(n=le.current)==null?void 0:n.damage(e)},getBounds:(e,n)=>{var r;if(!((b==null?void 0:b.current)===null||(j==null?void 0:j.current)===null)){if(e===void 0&&n===void 0){const c=b.current.getBoundingClientRect(),f=c.width/j.current.clientWidth;return{x:c.x-j.current.scrollLeft*f,y:c.y-j.current.scrollTop*f,width:j.current.scrollWidth*f,height:j.current.scrollHeight*f}}return(r=le.current)==null?void 0:r.getBounds((e??0)+a,n)}},focus:()=>{var e;return(e=le.current)==null?void 0:e.focus()},emit:async e=>{switch(e){case"delete":eo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":eo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":eo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await to(void 0,!0);break;case"paste":await dn();break}},scrollTo:re,remeasureColumns:e=>{for(const n of e)To(n+a)},getMouseArgsForPosition:(e,n,r)=>{if((le==null?void 0:le.current)===null)return;const c=le.current.getMouseArgsForPosition(e,n,r);if(c!==void 0)return{...c,location:[c.location[0]-a,c.location[1]]}}}),[at,So,To,j,to,eo,dn,a,re]);const[Zn,Jn]=Be??[],Al=l.useCallback(e=>{const[n,r]=e;if(r===-1){be!=="none"&&(ue(X.fromSingleSelection(n),void 0,!1),Me());return}Zn===n&&Jn===r||(me({cell:e,range:{x:n,y:r,width:1,height:1}},!0,!1,"keyboard-nav"),re(n,r))},[be,Me,re,Zn,Jn,me,ue]),[Gl,Pl]=l.useState(!1),Qn=l.useRef(gi(e=>{Pl(e)},5)),Kl=l.useCallback(()=>{Qn.current(!0),g.current===void 0&&g.columns.length===0&&g.rows.length===0&&R===void 0&&me({cell:[a,xo],range:{x:a,y:xo,width:1,height:1}},!0,!1,"keyboard-select")},[xo,g,R,a,me]),Nl=l.useCallback(()=>{Qn.current(!1)},[]),[Wl,Ol]=l.useMemo(()=>{let e;const n=(ae==null?void 0:ae.scrollbarWidthOverride)??ai(),r=F+(ce?1:0);if(typeof it=="number")e=qt+r*it;else{let f=0;const m=Math.min(r,10);for(let u=0;u<m;u++)f+=it(u);f=Math.floor(f/m),e=qt+r*f}e+=n;const c=W.reduce((f,m)=>m.width+f,0)+n;return[`${Math.min(1e5,c)}px`,`${Math.min(1e5,e)}px`]},[W,ae==null?void 0:ae.scrollbarWidthOverride,it,F,ce,qt]),Ul=l.useMemo(()=>ui(Ce),[Ce]);return l.createElement(di.Provider,{value:Ce},l.createElement(uc,{style:Ul,className:Wt,inWidth:_??Wl,inHeight:ve??Ol},l.createElement(Zi,{fillHandle:Er,drawFocusRing:Sn,experimental:ae,fixedShadowX:Lr,fixedShadowY:Hr,getRowThemeOverride:tt,headerIcons:Dr,imageWindowLoader:Ir,initialSize:Fr,isDraggable:$r,onDragLeave:Ar,onRowMoved:Xt,overscrollX:tl,overscrollY:ol,preventDiagonalScrolling:Kr,rightElement:Nr,rightElementProps:Wr,smoothScrollX:Or,smoothScrollY:Ur,className:Wt,enableGroups:Zo,onCanvasFocused:Kl,onCanvasBlur:Nl,canvasRef:b,onContextMenu:El,theme:Ce,cellXOffset:hl,cellYOffset:xo,accessibilityHeight:yt.height,onDragEnd:kl,columns:W,nonGrowWidth:Gn,drawHeader:ul,onColumnProposeMove:xl,drawCell:dl,disabledRows:Dl,freezeColumns:$l,lockColumns:a,firstColAccessible:a===0,getCellContent:Ee,minColumnWidth:Et,maxColumnWidth:po,searchInputRef:D,showSearch:rl,onSearchClose:ll,highlightRegions:gl,getCellsForSelection:ge,getGroupDetails:Qo,headerHeight:qo,isFocused:Gl,groupHeaderHeight:Zo?In:0,freezeTrailingRows:et+(ce&&(B==null?void 0:B.sticky)===!0?1:0),hasAppendRow:ce,onColumnResize:Ht,onColumnResizeEnd:sl,onColumnResizeStart:al,onCellFocused:Al,onColumnMoved:Ml,onDragStart:Rl,onHeaderMenuClick:pl,onHeaderIndicatorClick:bl,onItemHovered:an,isFilling:(R==null?void 0:R.fillHandle)===!0,onMouseMove:wl,onKeyDown:eo,onKeyUp:vt,onMouseDown:ml,onMouseUp:Cl,onDragOverCell:Tr,onDrop:zr,onSearchResultsChanged:Hl,onVisibleRegionChanged:yl,clientSize:jo,rowHeight:it,searchResults:mt,searchValue:Uo,onSearchValueChange:lo,rows:we,scrollRef:j,selection:g,translateX:yt.tx,translateY:yt.ty,verticalBorder:Il,gridRef:le,getCellRenderer:xe,resizeIndicator:qr}),Fl,w!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(yc,{...w,validateCell:cl,bloom:Ye,id:zl,getCellRenderer:xe,className:(ae==null?void 0:ae.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Rr,imageEditorOverride:T,portalElementRef:jr,onFinishEditing:Tl,markdownDivCreateNode:U,isOutsideClick:Yr,customEventTarget:ae==null?void 0:ae.eventTarget}))))},kc=l.forwardRef(Rc),Sc=(t,o)=>{const i=l.useMemo(()=>({...Bi,...t.headerIcons}),[t.headerIcons]),d=l.useMemo(()=>t.renderers??fi,[t.renderers]),w=l.useMemo(()=>t.imageWindowLoader??new hi,[t.imageWindowLoader]);return l.createElement(kc,{...t,renderers:d,headerIcons:i,ref:o,imageWindowLoader:w})},Ac=l.forwardRef(Sc);export{Ji as C,Ac as D,ft as k,wc as u};
