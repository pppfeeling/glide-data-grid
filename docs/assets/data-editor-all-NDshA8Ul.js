const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-BB7FxlLN.js","./iframe-BiMpfC1x.js","./preload-helper-C1FmrZbK.js","./index-D9VBCTZu.js","./marked.esm-junou-0M.js","./throttle-D1BBloZG.js","./flatten-B48GLVnS.js","./number-overlay-editor-Drpz6LLI.js","./react-number-format.es-DvBwhE8X.js"])))=>i.map(i=>d[i]);
var Vs=Object.defineProperty;var qs=(e,t,n)=>t in e?Vs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ne=(e,t,n)=>qs(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as St}from"./iframe-BiMpfC1x.js";import{_ as Al}from"./preload-helper-C1FmrZbK.js";import{h as js,g as zl,j as Zs,k as Js,v as Qs,l as ea,m as rn,r as co,t as ta}from"./throttle-D1BBloZG.js";import{u as na,f as il}from"./flatten-B48GLVnS.js";import{s as en,a as oa}from"./marked.esm-junou-0M.js";function Pl(e="This should not happen"){throw new Error(e)}function Jt(e,t="Assertion failed"){if(!e)return Pl(t)}function lr(e,t){return Pl(t??"Hell froze over")}function ra(e,t){try{return e()}catch{return t}}const ll=Object.prototype.hasOwnProperty;function $o(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&$o(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(ll.call(e,n)&&++o&&!ll.call(t,n)||!(n in t)||!$o(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Wr=null,Ai=void 0;var ee;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(ee||(ee={}));var sl;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(sl||(sl={}));var $r;(function(e){e.Triangle="triangle",e.Dots="dots"})($r||($r={}));function Tr(e){return"width"in e&&typeof e.width=="number"}async function al(e){return typeof e=="object"?e:await e()}function zo(e){return!(e.kind===ee.Loading||e.kind===ee.Bubble||e.kind===ee.RowID||e.kind===ee.Protected||e.kind===ee.Drilldown)}function Fu(e){return!(e.kind===ee.Loading||e.kind===ee.Bubble||e.kind===ee.RowID||e.kind===ee.Protected||e.kind===ee.Drilldown||e.kind===ee.Boolean||e.kind===ee.Image||e.kind===ee.Custom)}function Lo(e){return e.kind===ln.Marker||e.kind===ln.NewRow}function Po(e){if(!zo(e)||e.kind===ee.Image)return!1;switch(e.kind){case ee.Text:case ee.Number:case ee.Markdown:case ee.Uri:case ee.Custom:case ee.Boolean:return e.readonly!==!0;default:lr(e,"A cell was passed with an invalid kind")}}function ia(e){return js(e,"editor")}function zi(e){return!(e.readonly??!1)}var ln;(function(e){e.NewRow="new-row",e.Marker="marker"})(ln||(ln={}));const Or={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function yi(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let cl;const Kt=class Kt{constructor(t){Ne(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Kt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=yi([...this.items,n]);return new Kt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,c]of n.entries()){const[l,a]=c;if(l<=r&&o<=a){const f=[];l<o&&f.push([l,o]),r<a&&f.push([r,a]),n.splice(i,1,...f)}}return new Kt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Ne(Kt,"create",t=>new Kt(yi(t))),Ne(Kt,"empty",()=>cl??(cl=new Kt([]))),Ne(Kt,"fromSingleSelection",t=>Kt.empty().add(t)),Ne(Kt,"fromArray",t=>{if(t.length===0)return Kt.empty();const n=t.map(r=>[r,r+1]),o=yi(n);return new Kt(o)});let rt=Kt;const la=en("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Gt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const c=n,l=a=>{var f;(f=i.current)==null||f.call(c,a)};return c.addEventListener(e,l,{passive:o,capture:r}),()=>{c.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function Zn(e,t){return e===void 0?void 0:t}const sa=Math.PI;function dl(e){return e*sa/180}const Ll=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),Bl=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Wl=(e,t,n)=>Math.min(e,t-n*2),$l=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Pi=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},aa=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function ca(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const c=s.useRef(zl(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&c.current(()=>e())},t),o}const da="֑-߿יִ-﷽ﹰ-ﻼ",ua="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",fa=new RegExp("^[^"+ua+"]*["+da+"]");function Li(e){return fa.test(e)?"rtl":"not-rtl"}let Ar;function Ei(){if(typeof document>"u")return 0;if(Ar!==void 0)return Ar;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Ar=n-o,Ar}const ao=Symbol();function ha(e){const t=s.useRef([ao,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const a=t.current[0];a!==ao&&(l=typeof l=="function"?l(a):l,l===a)||(a!==ao&&r({}),o(f=>typeof l=="function"?l(a===ao?f:a):l),t.current[0]=ao)},[]),c=s.useCallback(()=>{t.current[0]=ao,r({})},[]);return[t.current[0]===ao?n:t.current[0],i,c]}function Ol(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function ga(e){const t=s.useRef(e);return $o(e,t.current)||(t.current=e),t.current}const ma=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const c=i.length>1;return s.createElement(la,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(Zs.Carousel,{showArrows:c,showThumbs:!1,swipeable:c,emulateTouch:c,infiniteLoop:c},i.map(l=>{const a=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},a)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Pi,null)))},wa=en("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class ba extends St.PureComponent{constructor(){super(...arguments);Ne(this,"targetElement",null);Ne(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,c=oa(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let a=i==null?void 0:i(c);if(a===void 0){const u=document.createElement("template");u.innerHTML=c,a=u.content}n.append(a);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),St.createElement(wa,{ref:this.containerRefHook})}}const ya=en("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),pa=en("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),va=en("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let ul=0;const _r=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:c,...l}=e,{onChange:a,className:f}=l,u=s.useRef(null),w=n??"";Jt(a!==void 0,"GrowingEntry must be a controlled input area");const[g]=s.useState(()=>"input-box-"+(ul=(ul+1)%1e7));s.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const y=w.toString().length;h.focus(),h.setSelectionRange(r?0:y,y)},[]),s.useLayoutEffect(()=>{var h;if(c!==void 0){const y=typeof c=="number"?[c,null]:c;(h=u.current)==null||h.setSelectionRange(y[0],y[1])}},[c]);const b=s.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return s.createElement(va,{className:"gdg-growing-entry"},s.createElement(pa,{className:f},w+`
`),s.createElement(ya,{...l,className:(f??"")+" gdg-input",id:g,ref:u,onKeyDown:b,value:w,placeholder:t,dir:"auto"}))},pi={};let qn=null;function Ca(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Oo(e){const t=e.toLowerCase().trim();if(pi[t]!==void 0)return pi[t];qn=qn||Ca(),qn.style.color="#000",qn.style.color=t;const n=getComputedStyle(qn).color;qn.style.color="#fff",qn.style.color=t;const o=getComputedStyle(qn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),pi[t]=r,r}function fo(e,t){const[n,o,r]=Oo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const fl=new Map;function hl(e,t){const n=`${e}-${t}`,o=fl.get(n);if(o!==void 0)return o;const r=Qt(e,t);return fl.set(n,r),r}function Qt(e,t){if(t===void 0)return e;const[n,o,r,i]=Oo(e);if(i===1)return e;const[c,l,a,f]=Oo(t),u=i+f*(1-i),w=(i*n+f*c*(1-i))/u,g=(i*o+f*l*(1-i))/u,b=(i*r+f*a*(1-i))/u;return`rgba(${w}, ${g}, ${b}, ${u})`}function Hu(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,c]=Oo(e),[l,a,f,u]=Oo(t),w=o*c,g=r*c,b=i*c,h=l*u,y=a*u,x=f*u,k=n,p=1-n,M=c*p+u*k;if(M===0)return"rgba(0, 0, 0, 0)";const W=Math.floor((w*p+h*k)/M),P=Math.floor((g*p+y*k)/M),T=Math.floor((b*p+x*k)/M);return`rgba(${W}, ${P}, ${T}, ${M})`}function Tu(e){if(e==="transparent")return 0;function t(i){const c=i/255;return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const[n,o,r]=Oo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function xa(e,t){return St.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function ka(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(rr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function sr(e,t){return(e??"")===(t??"")}function Sa(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function Nl(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function rr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function Xl(e){return[e.x+e.width-1,e.y+e.height-1]}function gl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,c=n.y+n.height-1,[l,a]=e;if(a<i||a>c)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Ma(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&gl(e,t,i)&&r++;for(const c of n.current.rangeStack)gl(e,t,c)&&r++;return r}function Yl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,c)=>({...i,sticky:e[c].sticky})),n=o}return n}function No(e,t){let n=0;const o=Yl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function ho(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Ii(e,t,n,o,r){const i=Yl(e,o),c=[];for(const f of i)if(f.sticky)c.push(f);else break;if(c.length>0)for(const f of c)n-=f.width;let l=t,a=r??0;for(;a<=n&&l<i.length;)a+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||c.push(u)}return c}function Ra(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Ea(e,t,n,o,r,i,c,l,a,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let w=t;for(let h=0;h<f;h++){const y=i-1-h,x=typeof c=="number"?c:c(y);if(w-=x,e>=w)return y}const g=i-f,b=e-(a??0);if(typeof c=="number"){const h=Math.floor((b-u)/c)+l;return h>=g?void 0:h}else{let h=u;for(let y=l;y<g;y++){const x=c(y);if(b<=h+x)return y;h+=x}return}}let Br=0,ir={};const Ia=typeof window>"u";async function Da(){var e;Ia||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Br=0,ir={},Qs())}Da();function Gl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Xo(e,t,n,o="middle"){const r=Gl(e,t,o,n);let i=ir[r];return i===void 0&&(i=t.measureText(e),ir[r]=i,Br++),Br>1e4&&(ir={},Br=0),i}function _l(e,t){const n=Gl(e,void 0,"middle",t);return ir[n]}function Wn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Fa(e,t)}function ml(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const wl=[];function Fa(e,t){for(const i of wl)if(i.key===t)return i.val;const n=ml(e,"alphabetic"),r=-(ml(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return wl.push({key:t,val:r}),r}function Ha(e,t,n,o,r,i){const{ctx:c,rect:l,theme:a}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const w=1-f/u;c.globalAlpha=w,c.fillStyle=a.bgSearchResult,c.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),c.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return f<u}function cr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},c=n??r.textDark;return c!==i.fillStyle&&(o.fillStyle=c,i.fillStyle=c),i}function Au(e,t,n,o,r){const{rect:i,ctx:c,theme:l}=e;c.fillStyle=l.textDark,Rn({ctx:c,rect:i,theme:l},t,n,o,r)}function Ul(e,t,n,o,r,i,c,l,a){a==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+c):a==="center"?e.fillText(t,n+r/2,o+i/2+c):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+c)}function Kl(e,t){const n=Xo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Ta(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Aa(e,t,n,o,r,i,c,l,a,f){const u=l.baseFontFull,w=Js(e,t,u,r-l.cellHorizontalPadding*2,f??!1),g=Kl(e,u),b=l.lineHeight*g,h=g+b*(w.length-1),y=h+l.cellVerticalPadding>i;y&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let k=Math.max(o+l.cellVerticalPadding,x);for(const p of w)if(Ul(e,p,n,k,r,g,c,l,a),k+=b,k>o+i)break;y&&e.restore()}function Rn(e,t,n,o,r){const{ctx:i,rect:c,theme:l}=e,{x:a,y:f,width:u,height:w}=c;o=o??!1,o||(t=Ta(t,u));const g=Wn(i,l),b=Li(t)==="rtl";if(n===void 0&&b&&(n="right"),b&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?Aa(i,t,a,f,u,w,g,l,n,r):Ul(i,t,a,f,u,w,g,l,n),h&&(i.textAlign="start"),b&&(i.direction="inherit")}}function En(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function za(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Pa(e,t,n){const o=function(l,a){const f=a.x-l.x,u=a.y-l.y,w=Math.sqrt(f*f+u*u),g=f/w,b=u/w;return{x:f,y:a.y-l.y,len:w,nx:g,ny:b,ang:Math.atan2(b,g)}};let r;const i=t.length;let c=t[i-1];for(let l=0;l<i;l++){let a=t[l%i];const f=t[(l+1)%i],u=o(a,c),w=o(a,f),g=u.nx*w.ny-u.ny*w.nx,b=u.nx*w.nx-u.ny*-w.ny;let h=Math.asin(g<-1?-1:g>1?1:g),y=1,x=!1;b<0?h<0?h=Math.PI+h:(h=Math.PI-h,y=-1,x=!0):h>0&&(y=-1,x=!0),r=a.radius!==void 0?a.radius:n;const k=h/2;let p=Math.abs(Math.cos(k)*r/Math.sin(k)),M;p>Math.min(u.len/2,w.len/2)?(p=Math.min(u.len/2,w.len/2),M=Math.abs(p*Math.sin(k)/Math.cos(k))):M=r;let W=a.x+w.nx*p,P=a.y+w.ny*p;W+=-w.ny*M*y,P+=w.nx*M*y,e.arc(W,P,M,u.ang+Math.PI/2*y,w.ang-Math.PI/2*y,x),c=a,a=f}e.closePath()}function Di(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h){const y={x:0,y:i+f,width:0,height:0};if(e>=b.length||t>=u||t<-2||e<0)return y;const x=i-r;if(e>=w){const k=c>e?-1:1,p=No(b);y.x+=p+a;for(let M=c;M!==e;M+=k)y.x+=b[k===1?M:M-1].width*k}else for(let k=0;k<e;k++)y.x+=b[k].width;if(y.width=b[e].width+1,t===-1)y.y=r,y.height=x;else if(t===-2){y.y=0,y.height=r;let k=e;const p=b[e].group,M=b[e].sticky;for(;k>0&&sr(b[k-1].group,p)&&b[k-1].sticky===M;){const P=b[k-1];y.x-=P.width,y.width+=P.width,k--}let W=e;for(;W+1<b.length&&sr(b[W+1].group,p)&&b[W+1].sticky===M;){const P=b[W+1];y.width+=P.width,W++}if(!M){const P=No(b),T=y.x-P;T<0&&(y.x-=T,y.width+=T),y.x+y.width>n&&(y.width=n-y.x)}}else if(t>=u-g){let k=u-t;for(y.y=o;k>0;){const p=t+k-1;y.height=typeof h=="number"?h:h(p),y.y-=y.height,k--}y.height+=1}else{const k=l>t?-1:1;if(typeof h=="number"){const p=t-l;y.y+=p*h}else for(let p=l;p!==t;p+=k)y.y+=h(p)*k;y.height=(typeof h=="number"?h:h(t))+1}return y}const Bi=1<<21;function mn(e,t){return(t+2)*Bi+e}function Vl(e){return e%Bi}function Wi(e){return Math.floor(e/Bi)-2}function $i(e){const t=Vl(e),n=Wi(e);return[t,n]}class ql{constructor(){Ne(this,"visibleWindow",{x:0,y:0,width:0,height:0});Ne(this,"freezeCols",0);Ne(this,"freezeRows",[]);Ne(this,"isInWindow",t=>{const n=Vl(t),o=Wi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,c=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&c})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&$o(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class La extends ql{constructor(){super(...arguments);Ne(this,"cache",new Map);Ne(this,"setValue",(n,o)=>{this.cache.set(mn(n[0],n[1]),o)});Ne(this,"getValue",n=>this.cache.get(mn(n[0],n[1])));Ne(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Wo{constructor(t=[]){Ne(this,"cells");this.cells=new Set(t.map(n=>mn(n[0],n[1])))}add(t){this.cells.add(mn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(mn(t[0],t[1]))}remove(t){this.cells.delete(mn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Wi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(mn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield $i(t)}}function Ba(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const jl={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function Zl(){return jl}const Jl=St.createContext(jl);function zu(){return St.useContext(Jl)}function Bn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=Qt(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Fi=150;function Wa(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Fi}function Ql(e,t,n,o,r,i,c,l,a){let f=0;const u=r===void 0?[]:r.map(b=>{const h=Wa(e,b[o],t,a);return f=Math.max(f,h),h});if(u.length>5&&l){f=0;let b=0;for(const y of u)b+=y;const h=b/u.length;for(let y=0;y<u.length;y++)u[y]>=h*2?u[y]=0:f=Math.max(f,u[y])}const w=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=w;const g=Math.max(Math.ceil(i),Math.min(Math.floor(c),Math.ceil(f)));return{...n,width:g}}function $a(e,t,n,o,r,i,c,l,a){const f=s.useRef(t),u=s.useRef(n),w=s.useRef(c);f.current=t,u.current=n,w.current=c;const[g,b]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const p=document.createElement("canvas");return p.style.display="none",p.style.opacity="0",p.style.position="fixed",[p,p.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(g&&document.documentElement.append(g),()=>{g==null||g.remove()}),[g]);const h=s.useRef({}),y=s.useRef(),[x,k]=s.useState();return s.useLayoutEffect(()=>{const p=u.current;if(p===void 0||e.every(Tr))return;let M=Math.max(1,10-Math.floor(e.length/1e4)),W=0;M<f.current&&M>1&&(M--,W=1);const P={x:0,y:0,width:e.length,height:Math.min(f.current,M)},T={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const X=p(P,a.signal),R=W>0?p(T,a.signal):void 0;let $;typeof X=="object"?$=X:$=await al(X),R!==void 0&&(typeof R=="object"?$=[...$,...R]:$=[...$,...await al(R)]),y.current=e,k($)})()},[a.signal,e]),s.useMemo(()=>{let M=e.every(Tr)?e:b===null?e.map(z=>Tr(z)?z:{...z,width:Fi}):(b.font=w.current.baseFontFull,e.map((z,X)=>{if(Tr(z))return z;if(h.current[z.id]!==void 0)return{...z,width:h.current[z.id]};if(x===void 0||y.current!==e||z.id===void 0)return{...z,width:Fi};const R=Ql(b,c,z,X,x,r,i,!0,l);return h.current[z.id]=R.width,R})),W=0,P=0;const T=[];for(const[z,X]of M.entries())W+=X.width,X.grow!==void 0&&X.grow>0&&(P+=X.grow,T.push(z));if(W<o&&T.length>0){const z=[...M],X=o-W;let R=X;for(let $=0;$<T.length;$++){const N=T[$],L=(M[N].grow??0)/P,E=$===T.length-1?R:Math.min(R,Math.floor(X*L));z[N]={...M[N],growOffset:E,width:M[N].width+E},R-=E}M=z}return{sizedColumns:M,nonGrowWidth:W}},[o,e,b,x,c,r,i,l])}const pt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Oa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Na=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Xa=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Ya=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ga=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},es=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},_a=e=>{const t=e.bgColor;return`${pt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Ua=es,Ka=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Va=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},ec=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},tc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${pt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},uc=e=>{const t=e.fgColor,n=e.bgColor;return`${pt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},fc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},hc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},gc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),mc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),wc={headerRowID:Oa,headerNumber:Xa,headerCode:Na,headerString:Ya,headerBoolean:Ga,headerAudioUri:Ua,headerVideoUri:Ka,headerEmoji:Va,headerImage:qa,headerUri:es,headerPhone:ja,headerMarkdown:Za,headerDate:Ja,headerTime:Qa,headerEmail:ec,headerReference:tc,headerIfThenElse:nc,headerSingleValue:oc,headerLookup:rc,headerTextTemplate:ic,headerMath:lc,headerRollup:sc,headerJoinStrings:ac,headerSplitString:cc,headerGeoDistance:dc,headerArray:uc,rowOwnerOverlay:fc,protectedColumnOverlay:hc,renameIcon:_a,headerArrowDown:gc,headerArrowUp:mc};function bc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class yc{constructor(t,n){Ne(this,"onSettled");Ne(this,"spriteMap",new Map);Ne(this,"headerIcons");Ne(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,c,l,a=1){const[f,u]=bc(n,l),w=c*Math.ceil(window.devicePixelRatio),g=`${f}_${u}_${w}_${t}`;let b=this.spriteMap.get(g);if(b===void 0){const h=this.headerIcons[t];if(h===void 0)return;b=document.createElement("canvas");const y=b.getContext("2d");if(y===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(g,b);const k=x.decode();if(k===void 0)return;this.inFlight++,k.then(()=>{y.drawImage(x,0,0,w,w)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(b,0,0,w,w,r,i,c,c),a<1&&(o.globalAlpha=1)}}function ts(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Ur(e,t,n,o,r,i,c,l,a){l=l??t;let f=t,u=e;const w=o-i;let g=!1;for(;f<n&&u<w;){const b=r(u);if(f+b>l&&a(f,u,b,!1,c&&u===o-1)===!0){g=!0;break}f+=b,u++}if(!g){f=n;for(let b=0;b<i;b++){u=o-1-b;const h=r(u);f-=h,a(f,u,h,!0,c&&u===o-1)}}}function Qn(e,t,n,o,r,i){let c=0,l=0;const a=r+o;for(const f of e){const u=f.sticky?l:c+n;if(i(f,u,a,f.sticky?0:l,t)===!0)break;c+=f.width,l+=f.sticky?f.width:0}}function ns(e,t,n,o,r){let i=0,c=0;for(let l=0;l<e.length;l++){const a=e[l];let f=l+1,u=a.width;for(a.sticky&&(c+=u);f<e.length&&sr(e[f].group,a.group)&&e[f].sticky===e[l].sticky;){const y=e[f];u+=y.width,f++,l++,y.sticky&&(c+=y.width)}const w=a.sticky?0:n,g=i+w,b=a.sticky?0:Math.max(0,c-g),h=Math.min(u-b,t-(g+b));r([a.sourceIndex,e[f-1].sourceIndex],a.group??"",g+b,0,h,o),i+=u}}function os(e,t,n,o,r,i,c){var g;const[l,a]=e;let f,u;const w=((g=c.find(b=>!b.sticky))==null?void 0:g.sourceIndex)??0;if(a>w){const b=Math.max(l,w);let h=t,y=o;for(let x=i.sourceIndex-1;x>=b;x--)h-=c[x].width,y+=c[x].width;for(let x=i.sourceIndex+1;x<=a;x++)y+=c[x].width;u={x:h,y:n,width:y,height:r}}if(w>l){const b=Math.min(a,w-1);let h=t,y=o;for(let x=i.sourceIndex-1;x>=l;x--)h-=c[x].width,y+=c[x].width;for(let x=i.sourceIndex+1;x<=b;x++)y+=c[x].width;f={x:h,y:n,width:y,height:r}}return[f,u]}function pc(e,t,n,o){if(o==="any")return rs(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),Nl([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,c=n-e.y+1,l=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:c,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return a===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===c?{x:e.x,y:n,width:e.width,height:e.y-n}:a===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function ar(e,t,n,o,r,i,c,l){return e<=r+c&&r<=e+n&&t<=i+l&&i<=t+o}function uo(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function rs(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function vc(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Cc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,c=t+4,l=n+4,a=r-e.x,f=e.x+e.width-c,u=i-e.y,w=e.y+e.height-l,g=a>0?e.x+Math.floor(a/o)*o:e.x,b=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,y=w>0?e.y+e.height-Math.floor(w/o)*o:e.y+e.height;return{x:g,y:h,width:b-g,height:y-h}}function xc(e,t,n,o,r){const[i,c,l,a]=t,[f,u,w,g]=r,{x:b,y:h,width:y,height:x}=e,k=[];if(y<=0||x<=0)return k;const p=b+y,M=h+x,W=b<i,P=h<c,T=b+y>l,z=h+x>a,X=b>=i&&b<l||p>i&&p<=l||b<i&&p>l,R=h>=c&&h<a||M>c&&M<=a||h<c&&M>a;if(X&&R){const N=Math.max(b,i),L=Math.max(h,c),E=Math.min(p,l),H=Math.min(M,a);k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:f,y:u,width:w-f+1,height:g-u+1}})}if(W&&P){const N=b,L=h,E=Math.min(p,i),H=Math.min(M,c);k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:0,y:0,width:f+1,height:u+1}})}if(P&&X){const N=Math.max(b,i),L=h,E=Math.min(p,l),H=Math.min(M,c);k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:f,y:0,width:w-f+1,height:u+1}})}if(P&&T){const N=Math.max(b,l),L=h,E=p,H=Math.min(M,c);k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:w,y:0,width:n-w+1,height:u+1}})}if(W&&R){const N=b,L=Math.max(h,c),E=Math.min(p,i),H=Math.min(M,a);k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:0,y:u,width:f+1,height:g-u+1}})}if(T&&R){const N=Math.max(b,l),L=Math.max(h,c),E=p,H=Math.min(M,a);k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:w,y:u,width:n-w+1,height:g-u+1}})}if(W&&z){const N=b,L=Math.max(h,a),E=Math.min(p,i),H=M;k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:0,y:g,width:f+1,height:o-g+1}})}if(z&&X){const N=Math.max(b,i),L=Math.max(h,a),E=Math.min(p,l),H=M;k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:f,y:g,width:w-f+1,height:o-g+1}})}if(T&&z){const N=Math.max(b,l),L=Math.max(h,a),E=p,H=M;k.push({rect:{x:N,y:L,width:E-N,height:H-L},clip:{x:w,y:g,width:n-w+1,height:o-g+1}})}return k}const kc={kind:ee.Loading,allowOverlay:!1};function bl(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y,x,k,p,M,W,P,T,z,X,R,$,N,L,E,H,re,K,fe,ue){let we=(M==null?void 0:M.size)??Number.MAX_SAFE_INTEGER;const te=performance.now();let _=E.baseFontFull;e.font=_;const ve={ctx:e},ne=[0,0],he=x>0?ho(a,x,f):0;let Ge,U;const oe=new Wo,Le=new Set,Je=ts(p);if(Qn(t,l,i,c,r,(ae,Qe,ct,Ce,Be)=>{const Te=Math.max(0,Ce-Qe),bt=Qe+Te,gt=r+1,mt=ae.width-Te,V=o-r-1;if(p.length>0){let dt=!1;for(let q=0;q<p.length;q++){const le=p[q];if(ar(bt,gt,mt,V,le.x,le.y,le.width,le.height)){dt=!0;break}}if(!dt)return}const ge=()=>{e.save(),e.beginPath(),e.rect(bt,gt,mt,V),e.clip()},ke=W.columns.hasIndex(ae.sourceIndex),He=w(ae.group??"").overrideTheme,Se=ae.themeOverride===void 0&&He===void 0?E:Bn(E,He,ae.themeOverride),lt=Se.baseFontFull;lt!==_&&(_=lt,e.font=lt),ge();let tt;return Ur(Be,ct,o,a,f,x,k,Je,(dt,q,le,_e,Ke)=>{var In,Xt,an;if(q<0)return;if(ne[0]=ae.sourceIndex,ne[1]=q,oe.has(ne)){we--;return}if(M!==void 0&&!M.has(ne))return;if(p.length>0){let Ie=!1;for(let it=0;it<p.length;it++){const nt=p[it];if(ar(Qe,dt,ae.width,le,nt.x,nt.y,nt.width,nt.height)){Ie=!0;break}}if(!Ie)return}const Et=W.rows.hasIndex(q),It=b.hasIndex(q),Ee=q<a?u(ne):kc;let Me=Qe,ut=ae.width,xt=dt,Mt=le,zt=!1,Ht=!1;if(Ee.rowspan!==void 0){const[Ie,it]=Ee.rowspan,nt=`${ae.sourceIndex}|${Ie}`;if(Le.has(nt)){we--;return}else{let je=dt;for(let qe=Ie;qe<q;qe++)je-=f(qe);let Pt=0;for(let qe=Ie;qe<it;qe++)Pt+=f(qe);if(je<gt+V&&je+Pt>gt){xt=je,Mt=Pt,Le.add(nt);for(let qe=Ie;qe<it;qe++)qe!==q&&oe.add([ae.sourceIndex,qe]);zt=!0}else{Le.add(nt);for(let qe=Ie;qe<it;qe++)oe.add([ae.sourceIndex,qe]);we--;return}}}if(Ee.span!==void 0){const[Ie,it]=Ee.span,nt=`${q},${Ie},${it},${ae.sticky}`;if(U===void 0&&(U=new Set),U.has(nt)){we--;return}else{const je=os(Ee.span,Qe,dt,ae.width,le,ae,n),Pt=ae.sticky?je[0]:je[1];!ae.sticky&&je[0]!==void 0&&(Ht=!0),Pt!==void 0&&(Me=Pt.x,ut=Pt.width,U.add(nt),zt=!0)}}if(zt){e.restore(),tt=void 0,e.save(),e.beginPath();const Ie=Math.max(0,Ce-Me);e.rect(Me+Ie,xt,ut-Ie,Mt),Ge===void 0&&(Ge=[]),Ge.push({x:Me+Ie,y:xt,width:ut-Ie,height:Mt}),e.clip()}const sn=g==null?void 0:g(q),tn=Ke&&((In=ae.trailingRowOptions)==null?void 0:In.themeOverride)!==void 0?(Xt=ae.trailingRowOptions)==null?void 0:Xt.themeOverride:void 0,Dt=Ee.themeOverride===void 0&&sn===void 0&&tn===void 0?Se:Bn(Se,sn,tn,Ee.themeOverride);e.beginPath();const Lt=Sa(ne,Ee,W);let Bt=Ma(ne,Ee,W,y);const wn=Ee.span!==void 0&&W.columns.some(Ie=>Ee.span!==void 0&&Ie>=Ee.span[0]&&Ie<=Ee.span[1]);Lt&&!h&&y?Bt=0:Lt&&y&&(Bt=Math.max(Bt,1)),wn&&Bt++,Lt||(Et&&Bt++,ke&&!Ke&&Bt++);const yt=Ee.kind===ee.Protected?Dt.bgCellMedium:Dt.bgCell;let ft;if((_e||yt!==E.bgCell)&&(ft=Qt(yt,ft)),Bt>0||It){It&&(ft=Qt(Dt.bgHeader,ft));for(let Ie=0;Ie<Bt;Ie++)ft=Qt(Dt.accentLight,ft)}else if(P!==void 0){for(const Ie of P)if(Ie[0]===ae.sourceIndex&&Ie[1]===q){ft=Qt(Dt.bgSearchResult,ft);break}}if(T!==void 0)for(let Ie=0;Ie<T.length;Ie++){const it=T[Ie],nt=it.range;it.style!=="solid-outline"&&nt.x<=ae.sourceIndex&&ae.sourceIndex<nt.x+nt.width&&nt.y<=q&&q<nt.y+nt.height&&(ft=Qt(it.color,ft))}let Ve=!1;if(M!==void 0){const Ie=dt+1,nt=(_e?Ie+le-1:Math.min(Ie+le-1,o-he))-Ie;(nt!==le-1||Me+1<=Ce)&&(Ve=!0,e.save(),e.beginPath(),e.rect(Me+1,Ie,ut-1,nt),e.clip()),ft=ft===void 0?Dt.bgCell:Qt(ft,Dt.bgCell)}const Tt=ae.sourceIndex===n.length-1,Vt=q===a-1;ft!==void 0&&(e.fillStyle=ft,tt!==void 0&&(tt.fillStyle=ft),M!==void 0?e.fillRect(Me+1,xt+1,ut-(Tt?2:1),Mt-(Vt?2:1)):e.fillRect(Me,xt,ut,Mt)),Ee.style==="faded"&&(e.globalAlpha=.6);let bn;for(let Ie=0;Ie<R.length;Ie++){const it=R[Ie];if(it.item[0]===ae.sourceIndex&&it.item[1]===q){bn=it;break}}if(ut>ue&&!Ht){const Ie=Dt.baseFontFull;Ie!==_&&(e.font=Ie,_=Ie);let it=0;if(Ee.rowspan!==void 0){const nt=Ee.rowSpanPosition??"top";if(nt==="top")it=le/2-Mt/2;else if(nt==="bottom"){const[je,Pt]=Ee.rowspan,qe=f(Pt-1);it=Mt/2-qe/2}}tt=is(e,Ee,ae.sourceIndex,q,Tt,Vt,Me,xt,ut,Mt,Bt>0,Dt,ft??Dt.bgCell,z,X,(bn==null?void 0:bn.hoverAmount)??0,$,L,te,N,tt,H,re,K,fe,it)}return Ve&&e.restore(),Ee.style==="faded"&&(e.globalAlpha=1),we--,zt&&(e.restore(),(an=tt==null?void 0:tt.deprep)==null||an.call(tt,ve),tt=void 0,ge(),_=lt,e.font=lt),we<=0}),e.restore(),we<=0}),Ge!==void 0)return Ge}const er=[0,0],tr={x:0,y:0,width:0,height:0},vi=[void 0,()=>{}];let Hi=!1;function Sc(){Hi=!0}function is(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y,x,k,p,M,W,P,T,z,X,R){var K,fe;let $,N;x!==void 0&&x[0][0]===n&&x[0][1]===o&&($=x[1][0],N=x[1][1]);let L;er[0]=n,er[1]=o,tr.x=c,tr.y=l,tr.width=a,tr.height=f,vi[0]=T.getValue(er),vi[1]=ue=>T.setValue(er,ue),Hi=!1;const E={ctx:e,theme:w,col:n,row:o,cell:t,rect:tr,highlighted:u,cellFillColor:g,hoverAmount:y,frameTime:p,hoverX:$,drawState:vi,hoverY:N,imageLoader:b,spriteManager:h,hyperWrapping:k,overrideCursor:$!==void 0?X:void 0,requestAnimationFrame:Sc},H=Ha(E,t.lastUpdated,p,W,r,i),re=z(t);if(re!==void 0){(W==null?void 0:W.renderer)!==re&&((K=W==null?void 0:W.deprep)==null||K.call(W,E),W=void 0);const ue=(fe=re.drawPrep)==null?void 0:fe.call(re,E,W);e.save(),e.translate(0,R),M!==void 0&&!Lo(E.cell)?M(E,()=>re.draw(E,t)):re.draw(E,t),e.restore(),L=ue===void 0?void 0:{deprep:ue==null?void 0:ue.deprep,fillStyle:ue==null?void 0:ue.fillStyle,font:ue==null?void 0:ue.font,renderer:re}}return(H||Hi)&&(P==null||P(er)),L}function Nr(e,t,n,o,r,i,c,l,a=-20,f=-20,u=void 0,w="center",g="square",b=!1){const h=Math.floor(r+c/2),y=g==="circle"?1e4:t.roundingRadius??4;let x=Wl(u??t.checkboxMaxSize,c,t.cellVerticalPadding),k=x/2;const p=Bl(w,o,i,t.cellHorizontalPadding,x),M=Ll(p,h,x),W=$l(o+a,r+f,M);switch(n){case!0:{e.beginPath(),En(e,p-x/2,h-x/2,x,x,y),g==="circle"&&(k*=.8,x*=.8),e.fillStyle=b?t.bgCellMedium:l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(p-k+x/4.23,h-k+x/1.97),e.lineTo(p-k+x/2.42,h-k+x/1.44),e.lineTo(p-k+x/1.29,h-k+x/3.25),e.strokeStyle=b?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Wr:case!1:{e.beginPath(),En(e,p-x/2+.5,h-x/2+.5,x-1,x-1,y),e.lineWidth=1,e.strokeStyle=b?t.textLight:W?t.textDark:t.textMedium,e.stroke();break}case Ai:{e.beginPath(),En(e,p-x/2,h-x/2,x,x,y),e.fillStyle=b?t.bgCellMedium:W?t.textMedium:t.textLight,e.fill(),g==="circle"&&(k*=.8,x*=.8),e.beginPath(),e.moveTo(p-x/3,h),e.lineTo(p+x/3,h),e.strokeStyle=b?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:lr()}}function Mc(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y,x,k,p){var R,$,N,L;const M=c+l;if(M<=0)return;e.fillStyle=w.bgHeader,e.fillRect(0,0,r,M);const W=(R=o==null?void 0:o[0])==null?void 0:R[0],P=($=o==null?void 0:o[0])==null?void 0:$[1],T=(N=o==null?void 0:o[1])==null?void 0:N[0],z=(L=o==null?void 0:o[1])==null?void 0:L[1],X=w.headerFontFull;e.font=X,Qn(t,0,i,0,M,(E,H,re,K)=>{var Le;if(x!==void 0&&!x.has([E.sourceIndex,-1]))return;const fe=Math.max(0,K-H);e.save(),e.beginPath(),e.rect(H+fe,l,E.width-fe,c),e.clip();const ue=y(E.group??"").overrideTheme,we=E.themeOverride===void 0&&ue===void 0?w:Bn(w,ue,E.themeOverride);we.bgHeader!==w.bgHeader&&(e.fillStyle=we.bgHeader,e.fill()),we!==w&&(e.font=we.headerFontFull);const te=u.columns.hasIndex(E.sourceIndex),_=a!==void 0||f||E.headerRowMarkerDisabled===!0,ve=!_&&P===-1&&W===E.sourceIndex,ne=_?0:((Le=b.find(Je=>Je.item[0]===E.sourceIndex&&Je.item[1]===-1))==null?void 0:Le.hoverAmount)??0,he=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===E.sourceIndex,Ge=te?we.accentColor:he?we.bgHeaderHasFocus:we.bgHeader,U=n?l:0,oe=E.sourceIndex===0?0:1;te?(e.fillStyle=Ge,e.fillRect(H+oe,U,E.width-oe,c)):(he||ne>0)&&(e.beginPath(),e.rect(H+oe,U,E.width-oe,c),he&&(e.fillStyle=we.bgHeaderHasFocus,e.fill()),ne>0&&(e.globalAlpha=ne,e.fillStyle=we.bgHeaderHovered,e.fill(),e.globalAlpha=1)),as(e,H,U,E.width,c,E,te,we,ve,ve?T:void 0,ve?z:void 0,he,ne,g,k,p),e.restore()}),n&&Rc(e,t,r,i,l,o,w,g,b,h,y,x)}function Rc(e,t,n,o,r,i,c,l,a,f,u,w){const[b,h]=(i==null?void 0:i[0])??[];let y=0;ns(t,n,o,r,(x,k,p,M,W,P)=>{if(w!==void 0&&!w.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(p,M,W,P),e.clip();const T=u(k),z=(T==null?void 0:T.overrideTheme)===void 0?c:Bn(c,T.overrideTheme),X=h===-2&&b!==void 0&&b>=x[0]&&b<=x[1],R=X?z.bgGroupHeaderHovered??z.bgHeaderHovered:z.bgGroupHeader??z.bgHeader;if(R!==c.bgHeader&&(e.fillStyle=R,e.fill()),e.fillStyle=z.textGroupHeader??z.textHeader,T!==void 0){let $=p;if(T.icon!==void 0&&(l.drawSprite(T.icon,"normal",e,$+8,(r-20)/2,20,z),$+=26),e.fillText(T.name,$+8,r/2+Wn(e,c.headerFontFull)),T.actions!==void 0&&X){const N=ls({x:p,y:M,width:W,height:P},T.actions);e.beginPath();const L=N[0].x-10,E=p+W-L;e.rect(L,0,E,r);const H=e.createLinearGradient(L,0,L+E,0),re=fo(R,0);H.addColorStop(0,re),H.addColorStop(10/E,R),H.addColorStop(1,R),e.fillStyle=H,e.fill(),e.globalAlpha=.6;const[K,fe]=(i==null?void 0:i[1])??[-1,-1];for(let ue=0;ue<T.actions.length;ue++){const we=T.actions[ue],te=N[ue],_=uo(te,K+p,fe);_&&(e.globalAlpha=1),l.drawSprite(we.icon,"normal",e,te.x+te.width/2-10,te.y+te.height/2-10,20,z),_&&(e.globalAlpha=.6)}e.globalAlpha=1}}p!==0&&f(x[0])&&(e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,r),e.strokeStyle=c.borderColor,e.lineWidth=1,e.stroke()),e.restore(),y=p+W}),e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=c.borderColor,e.lineWidth=1,e.stroke()}const zr=30;function Ec(e,t,n,o,r){return{x:e+n-zr,y:Math.max(t,t+o/2-zr/2),width:zr,height:Math.min(zr,o)}}function ls(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,c=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:c,height:i}),o+=26;return n}function nr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ss(e,t,n,o,r,i,c,l){var z;const a=c.cellHorizontalPadding,f=c.headerIconSize,u=Ec(n,o,r,i);let w=n+a;const g=t.icon===void 0?void 0:{x:w,y:o+(i-f)/2,width:f,height:f},b=g===void 0||t.overlayIcon===void 0?void 0:{x:g.x+9,y:g.y+6,width:18,height:18};g!==void 0&&(w+=Math.ceil(f*1.3));const h=e===void 0?((z=_l(t.title,c.headerFontFull))==null?void 0:z.width)??0:Xo(t.title,e,c.headerFontFull).width,y=t.hasMenu===!0?35:0,x=t.indicatorIcon!==void 0?f+a:0,k=h+x,p=r-(g!==void 0?Math.ceil(f*1.3)+a:a)-y-a,M=n+(g!==void 0?Math.ceil(f*1.3)+a:a)+(p-k)/2,W={x:Math.max(w,M),y:o,width:h,height:i};let P;t.indicatorIcon!==void 0&&(P={x:W.x+h+a,y:o+(i-f)/2,width:f,height:f});const T=n+r/2;return{menuBounds:nr(u,T,l),iconBounds:nr(g,T,l),iconOverlayBounds:nr(b,T,l),textBounds:nr(W,T,l),indicatorIconBounds:nr(P,T,l)}}function yl(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const p=i.rowMarkerChecked;p!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=w);const M=i.headerRowMarkerTheme!==void 0?Bn(l,i.headerRowMarkerTheme):l;Nr(e,M,p,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),p!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=c?l.textHeaderSelected:l.textHeader,k=i.hasMenu===!0&&(a||b&&c)&&y.menuBounds!==void 0;if(i.icon!==void 0&&y.iconBounds!==void 0){let p=c?"selected":"normal";i.style==="highlight"&&(p=c?"selected":"special"),g.drawSprite(i.icon,p,e,y.iconBounds.x,y.iconBounds.y,y.iconBounds.width,l),i.overlayIcon!==void 0&&y.iconOverlayBounds!==void 0&&g.drawSprite(i.overlayIcon,c?"selected":"special",e,y.iconOverlayBounds.x,y.iconOverlayBounds.y,y.iconOverlayBounds.width,l)}if(k&&o>35){const M=h?35:o-35,W=h?35*.7:o-35*.7,P=M/o,T=W/o,z=e.createLinearGradient(t,0,t+o,0),X=fo(x,0);z.addColorStop(h?1:0,x),z.addColorStop(P,x),z.addColorStop(T,X),z.addColorStop(h?0:1,X),e.fillStyle=z}else e.fillStyle=x;if(h&&(e.textAlign="right"),y.textBounds!==void 0&&e.fillText(i.title,h?y.textBounds.x+y.textBounds.width:y.textBounds.x,n+r/2+Wn(e,l.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&y.indicatorIconBounds!==void 0&&(!k||!ar(y.menuBounds.x,y.menuBounds.y,y.menuBounds.width,y.menuBounds.height,y.indicatorIconBounds.x,y.indicatorIconBounds.y,y.indicatorIconBounds.width,y.indicatorIconBounds.height))){let p=c?"selected":"normal";i.style==="highlight"&&(p=c?"selected":"special"),g.drawSprite(i.indicatorIcon,p,e,y.indicatorIconBounds.x,y.indicatorIconBounds.y,y.indicatorIconBounds.width,l)}if(k&&y.menuBounds!==void 0){const p=y.menuBounds,M=f!==void 0&&u!==void 0&&uo(p,f+t,u+n);if(M||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===$r.Triangle){e.beginPath();const W=p.x+p.width/2-5.5,P=p.y+p.height/2-3;Pa(e,[{x:W,y:P},{x:W+11,y:P},{x:W+5.5,y:P+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===$r.Dots){e.beginPath();const W=p.x+p.width/2,P=p.y+p.height/2;za(e,W,P),e.fillStyle=x,e.fill()}else{const W=p.x+(p.width-l.headerIconSize)/2,P=p.y+(p.height-l.headerIconSize)/2;g.drawSprite(i.menuIcon,"normal",e,W,P,l.headerIconSize,l)}M||(e.globalAlpha=1)}}function as(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y){const x=Li(i.title)==="rtl",k=ss(e,i,t,n,o,r,l,x);h!==void 0?h({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:c,hoverAmount:g,isHovered:a,hasSelectedCell:w,spriteManager:b,menuBounds:(k==null?void 0:k.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>yl(e,t,n,o,r,i,c,l,a,f,u,g,b,y,x,k)):yl(e,t,n,o,r,i,c,l,a,f,u,g,b,y,x,k)}function Ic(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y,x,k,p){if(k!==void 0||t[t.length-1]!==n[t.length-1])return;const M=ts(x);Qn(t,a,c,l,i,(W,P,T,z,X)=>{if(W!==t[t.length-1])return;P+=W.width;const R=Math.max(P,z);R>o||(e.save(),e.beginPath(),e.rect(R,i+1,1e4,r-i-1),e.clip(),Ur(X,T,r,f,u,h,y,M,($,N,L,E)=>{if(!E&&x.length>0&&!x.some(ue=>ar(P,$,1e4,L,ue.x,ue.y,ue.width,ue.height)))return;const H=g.hasIndex(N),re=b.hasIndex(N);e.beginPath();const K=w==null?void 0:w(N),fe=K===void 0?p:Bn(p,K);fe.bgCell!==p.bgCell&&(e.fillStyle=fe.bgCell,e.fillRect(P,$,1e4,L)),re&&(e.fillStyle=fe.bgHeader,e.fillRect(P,$,1e4,L)),H&&(e.fillStyle=fe.accentLight,e.fillRect(P,$,1e4,L))}),e.restore())})}function Dc(e,t,n,o,r,i,c,l,a){let f=!1;for(const h of t)if(!h.sticky){f=c(h.sourceIndex);break}const u=a.horizontalBorderColor??a.borderColor,w=a.borderColor,g=f?No(t):0;let b;if(g!==0&&(b=hl(w,a.bgCell),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,o),e.strokeStyle=b,e.stroke()),r>0){const h=w===u&&b!==void 0?b:hl(u,a.bgCell),y=ho(i,r,l);e.beginPath(),e.moveTo(0,o-y+.5),e.lineTo(n,o-y+.5),e.strokeStyle=h,e.stroke()}}const cs=(e,t,n)=>{let o=0,r=t,i=0,c=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),c=Math.max(c,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:c}};function Fc(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h){var L;const y=h.bgCell,{minX:x,maxX:k,minY:p,maxY:M}=cs(l,i,c),W=[],P=c-ho(b,g,f);let T=a,z=n,X=0;for(;T+r<P;){const E=T+r,H=f(z);if(E>=p&&E<=M-1){const re=u==null?void 0:u(z),K=re==null?void 0:re.bgCell;K!==void 0&&K!==y&&z>=b-g&&W.push({x,y:E,w:k-x,h:H,color:K})}T+=H,z<b-g&&(X=T),z++}let R=0;const $=Math.min(P,M)-X;if($>0)for(let E=0;E<t.length;E++){const H=t[E];if(H.width===0)continue;const re=H.sticky?R:R+o,K=(L=H.themeOverride)==null?void 0:L.bgCell;K!==void 0&&K!==y&&re>=x&&re<=k&&w(E+1)&&W.push({x:re,y:X,w:H.width,h:$,color:K}),R+=H.width}if(W.length===0)return;let N;e.beginPath();for(let E=W.length-1;E>=0;E--){const H=W[E];N===void 0?N=H.color:H.color!==N&&(e.fillStyle=N,e.fill(),e.beginPath(),N=H.color),e.rect(H.x,H.y,H.w,H.h)}N!==void 0&&(e.fillStyle=N,e.fill()),e.beginPath()}function pl(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y,x,k=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,c);for(const L of a)e.rect(L.x+1,L.y+1,L.width-1,L.height-1);e.clip("evenodd")}const p=x.horizontalBorderColor??x.borderColor,M=x.borderColor,{minX:W,maxX:P,minY:T,maxY:z}=cs(l,i,c),X=[];e.beginPath();let R=.5;for(let L=0;L<t.length;L++){const E=t[L];if(E.width===0)continue;R+=E.width;const H=E.sticky?R:R+o;H>=W&&H<=P&&b(L+1)&&X.push({x1:H,y1:Math.max(f,T),x2:H,y2:Math.min(c,z),color:M})}let $=c+.5;for(let L=y-h;L<y;L++){const E=w(L);$-=E,X.push({x1:W,y1:$,x2:P,y2:$,color:p})}if(k!==!0){let L=u+.5,E=n;const H=$;for(;L+r<H;){const re=L+r;if(re>=T&&re<=z-1){const K=g==null?void 0:g(E);X.push({x1:W,y1:re,x2:P,y2:re,color:(K==null?void 0:K.horizontalBorderColor)??(K==null?void 0:K.borderColor)??p})}L+=w(E),E++}}const N=ea(X,L=>L.color);for(const L of Object.keys(N)){e.strokeStyle=L;for(const E of N[L])e.moveTo(E.x1,E.y1),e.lineTo(E.x2,E.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function Hc(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y,x,k,p){const M=[];e.imageSmoothingEnabled=!1;const W=Math.min(r.cellYOffset,c),P=Math.max(r.cellYOffset,c);let T=0;if(typeof k=="number")T+=(P-W)*k;else for(let H=W;H<P;H++)T+=k(H);c>r.cellYOffset&&(T=-T),T+=a-r.translateY;const z=Math.min(r.cellXOffset,i),X=Math.max(r.cellXOffset,i);let R=0;for(let H=z;H<X;H++)R+=y[H].width;i>r.cellXOffset&&(R=-R),R+=l-r.translateX;const $=No(x);if(R!==0&&T!==0)return{regions:[]};const N=f>0?ho(g,f,k):0,L=u-$-Math.abs(R),E=w-b-N-Math.abs(T)-1;if(L>150&&E>150){const H={sx:0,sy:0,sw:u*h,sh:w*h,dx:0,dy:0,dw:u*h,dh:w*h};if(T>0?(H.sy=(b+1)*h,H.sh=E*h,H.dy=(T+b+1)*h,H.dh=E*h,M.push({x:0,y:b,width:u,height:T+1})):T<0&&(H.sy=(-T+b+1)*h,H.sh=E*h,H.dy=(b+1)*h,H.dh=E*h,M.push({x:0,y:w+T-N,width:u,height:-T+N})),R>0?(H.sx=$*h,H.sw=L*h,H.dx=(R+$)*h,H.dw=L*h,M.push({x:$-1,y:0,width:R+2,height:w})):R<0&&(H.sx=($-R)*h,H.sw=L*h,H.dx=$*h,H.dw=L*h,M.push({x:u+R,y:0,width:-R,height:w})),e.setTransform(1,0,0,1,0,0),p){if($>0&&R!==0&&T===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const re=$*h,K=w*h;e.drawImage(t,0,0,re,K,0,0,re,K)}if(N>0&&R===0&&T!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const re=(w-N)*h,K=u*h,fe=N*h;e.drawImage(t,0,re,K,fe,0,re,K,fe)}}e.drawImage(t,H.sx,H.sy,H.sw,H.sh,H.dx,H.dy,H.dw,H.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:M}}function Tc(e,t,n,o,r,i,c,l,a,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||Qn(a,n,o,r,l,(w,g,b,h)=>{if(w.sourceIndex===f){const y=Math.max(g,h)+1;return u.push({x:y,y:0,width:i-y,height:c}),!0}}),u}function Ac(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if($o(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:c,...l}=r,{width:a,...f}=i;if(!$o(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function vl(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y){const x=h==null?void 0:h.filter(z=>z.style!=="no-outline");if(x===void 0||x.length===0)return;const k=No(l),p=ho(b,g,w),M=[a,0,l.length,b-g],W=[k,0,t,n-p],P=x.map(z=>{const X=z.range,R=z.style??"dashed";return xc(X,M,t,n,W).map($=>{const N=$.rect,L=Di(N.x,N.y,t,n,u,f+u,o,r,i,c,b,a,g,l,w),E=N.width===1&&N.height===1?L:Di(N.x+N.width-1,N.y+N.height-1,t,n,u,f+u,o,r,i,c,b,a,g,l,w);return N.x+N.width>=l.length&&(E.width-=1),N.y+N.height>=b&&(E.height-=1),{color:z.color,style:R,clip:$.clip,rect:Cc({x:L.x,y:L.y,width:E.x+E.width-L.x,height:E.y+E.height-L.y},t,n,8)}})}),T=()=>{e.lineWidth=1;let z=!1;for(const X of P)for(const R of X)if((R==null?void 0:R.rect)!==void 0&&ar(0,0,t,n,R.rect.x,R.rect.y,R.rect.width,R.rect.height)){const $=z,N=!vc(R.clip,R.rect);e.beginPath(),N&&(e.save(),e.rect(R.clip.x,R.clip.y,R.clip.width,R.clip.height),e.clip()),R.style==="dashed"&&!z?(e.setLineDash([5,3]),z=!0):(R.style==="solid"||R.style==="solid-outline")&&z&&(e.setLineDash([]),z=!1),e.strokeStyle=R.style==="solid-outline"?Qt(Qt(R.color,y.borderColor),y.bgCell):fo(R.color,1),e.closePath(),e.strokeRect(R.rect.x+.5,R.rect.y+.5,R.rect.width-1,R.rect.height-1),N&&(e.restore(),z=$)}z&&e.setLineDash([])};return T(),T}function Cl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Ci(e,t,n,o,r,i,c,l,a,f,u,w,g,b,h,y,x){if(u.current===void 0)return;const k=y!==!1&&y!==void 0;if(!k)return;const p=typeof y=="object"?{...Or,...y}:Or,M=u.current.range,W=u.current.cell,P=[M.x+M.width-1,M.y+M.height-1];if(W[1]>=x&&P[1]>=x||!c.some(K=>K.sourceIndex===W[0]||K.sourceIndex===P[0]))return;const[z,X]=u.current.cell,R=g(u.current.cell),$=R.span??[z,z],N=X>=x-b,L=b>0&&!N?ho(x,b,w)-1:0,E=P[1];let H;if(Qn(c,o,r,i,f,(K,fe,ue,we,te)=>{if(K.sticky&&z>K.sourceIndex)return;const _=K.sourceIndex<$[0],ve=K.sourceIndex>$[1],ne=K.sourceIndex===P[0];if(!(!ne&&(_||ve)))return Ur(te,ue,n,x,w,b,h,void 0,(he,Ge,U)=>{if(Ge!==X&&Ge!==E)return;let oe=fe,Le=K.width;if(R.span!==void 0){const ae=os(R.span,fe,he,K.width,U,K,l),Qe=K.sticky?ae[0]:ae[1];Qe!==void 0&&(oe=Qe.x,Le=Qe.width)}return Ge===E&&ne&&k&&(H=()=>{var Be;we>oe&&!K.sticky&&(e.beginPath(),e.rect(we,0,t-we,n),e.clip());const ae=p.size,Qe=ae/2,ct=oe+Le+p.offsetX-Qe+.5,Ce=he+U+p.offsetY-Qe+.5;e.beginPath(),p.shape==="circle"?e.arc(ct+Qe,Ce+Qe,Qe,0,Math.PI*2):e.rect(ct,Ce,ae,ae),e.fillStyle=((Be=K.themeOverride)==null?void 0:Be.accentColor)??a.accentColor,e.fill(),p.outline>0&&(e.lineWidth=p.outline,e.strokeStyle=a.bgCell,p.shape==="circle"?(e.beginPath(),e.arc(ct+Qe,Ce+Qe,Qe+p.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(ct-p.outline/2,Ce-p.outline/2,ae+p.outline,ae+p.outline))}),H!==void 0}),H!==void 0}),H===void 0)return;const re=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-L),e.clip(),H==null||H(),e.restore()};return re(),re}function zc(e,t,n,o,r,i,c,l,a){a===void 0||a.size===0||(e.beginPath(),ns(t,n,i,o,(f,u,w,g,b,h)=>{a.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(w,g,b,h)}),Qn(t,l,i,c,r,(f,u,w,g)=>{const b=Math.max(0,g-u),h=u+b+1,y=f.width-b-1;a.has([f.sourceIndex,-1])&&e.rect(h,o,y,r-o)}),e.clip())}function Pc(e,t,n,o,r,i,c,l,a,f){let u=0;return Qn(e,i,o,r,n,(w,g,b,h,y)=>(Ur(y,b,t,c,l,a,f,void 0,(x,k,p,M)=>{M||(u=Math.max(k,u))}),!0)),u}function xl(e,t){var wn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:c,cellYOffset:l,translateX:a,translateY:f,mappedColumns:u,enableGroups:w,freezeColumns:g,dragAndDropState:b,theme:h,drawFocus:y,headerHeight:x,groupHeaderHeight:k,disabledRows:p,rowHeight:M,verticalBorder:W,overrideCursor:P,isResizing:T,selection:z,fillHandle:X,freezeTrailingRows:R,rows:$,getCellContent:N,getGroupDetails:L,getRowThemeOverride:E,isFocused:H,drawHeaderCallback:re,prelightCells:K,drawCellCallback:fe,highlightRegions:ue,resizeCol:we,imageLoader:te,lastBlitData:_,hoverValues:ve,hyperWrapping:ne,hoverInfo:he,spriteManager:Ge,maxScaleFactor:U,hasAppendRow:oe,touchMode:Le,enqueue:Je,renderStateProvider:ae,getCellRenderer:Qe,renderStrategy:ct,bufferACtx:Ce,bufferBCtx:Be,damage:Te,minimumCellWidth:bt,resizeIndicator:gt}=e;if(r===0||i===0)return;const mt=ct==="double-buffer",V=Math.min(U,Math.ceil(window.devicePixelRatio??1)),ge=ct!=="direct"&&Ac(e,t),ke=n.canvas;(ke.width!==r*V||ke.height!==i*V)&&(ke.width=r*V,ke.height=i*V,ke.style.width=r+"px",ke.style.height=i+"px");const He=o.canvas,Se=w?k+x:x,lt=Se+1;(He.width!==r*V||He.height!==lt*V)&&(He.width=r*V,He.height=lt*V,He.style.width=r+"px",He.style.height=lt+"px");const tt=Ce.canvas,dt=Be.canvas;mt&&(tt.width!==r*V||tt.height!==i*V)&&(tt.width=r*V,tt.height=i*V,_.current!==void 0&&(_.current.aBufferScroll=void 0)),mt&&(dt.width!==r*V||dt.height!==i*V)&&(dt.width=r*V,dt.height=i*V,_.current!==void 0&&(_.current.bBufferScroll=void 0));const q=_.current;if(ge===!0&&c===(q==null?void 0:q.cellXOffset)&&l===(q==null?void 0:q.cellYOffset)&&a===(q==null?void 0:q.translateX)&&f===(q==null?void 0:q.translateY))return;let le=null;mt&&(le=n);const _e=o;let Ke;mt?Te!==void 0?Ke=(q==null?void 0:q.lastBuffer)==="b"?Be:Ce:Ke=(q==null?void 0:q.lastBuffer)==="b"?Ce:Be:Ke=n;const Et=Ke.canvas,It=mt?Et===tt?dt:tt:ke,Ee=typeof M=="number"?()=>M:M;_e.save(),Ke.save(),_e.beginPath(),Ke.beginPath(),_e.textBaseline="middle",Ke.textBaseline="middle",V!==1&&(_e.scale(V,V),Ke.scale(V,V));const Me=Ii(u,c,r,b,a);let ut=[];const xt=y&&((wn=z.current)==null?void 0:wn.cell[1])===l&&f===0;let Mt=!1;if(ue!==void 0){for(const yt of ue)if(yt.style!=="no-outline"&&yt.range.y===l&&f===0){Mt=!0;break}}const zt=()=>{Mc(_e,Me,w,he,r,a,x,k,b,T,z,h,Ge,ve,W,L,Te,re,Le),pl(_e,Me,l,a,f,r,i,void 0,void 0,k,Se,Ee,E,W,R,$,h,!0),_e.beginPath(),_e.moveTo(0,lt-.5),_e.lineTo(r,lt-.5),_e.strokeStyle=Qt(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),_e.stroke(),Mt&&vl(_e,r,i,c,l,a,f,u,g,x,k,M,R,$,ue,h),xt&&Ci(_e,r,i,l,a,f,Me,u,h,Se,z,Ee,N,R,oe,X,$)};if(Te!==void 0){const yt=Me[Me.length-1].sourceIndex+1,ft=Te.hasItemInRegion([{x:c,y:-2,width:yt,height:2},{x:c,y:l,width:yt,height:300},{x:0,y:l,width:g,height:300},{x:0,y:-2,width:g,height:2},{x:c,y:$-R,width:yt,height:R,when:R>0}]),Ve=Tt=>{bl(Tt,Me,u,i,Se,a,f,l,$,Ee,N,L,E,p,H,y,R,oe,ut,Te,z,K,ue,te,Ge,ve,he,fe,ne,h,Je,ae,Qe,P,bt);const Vt=z.current;X!==!1&&X!==void 0&&y&&Vt!==void 0&&Te.has(Xl(Vt.range))&&Ci(Tt,r,i,l,a,f,Me,u,h,Se,z,Ee,N,R,oe,X,$)};ft&&(Ve(Ke),le!==null&&(le.save(),le.scale(V,V),le.textBaseline="middle",Ve(le),le.restore()),Te.hasHeader()&&(zc(_e,Me,r,k,Se,a,f,l,Te),zt())),Ke.restore(),_e.restore();return}if((ge!==!0||c!==(q==null?void 0:q.cellXOffset)||a!==(q==null?void 0:q.translateX)||xt!==(q==null?void 0:q.mustDrawFocusOnHeader)||Mt!==(q==null?void 0:q.mustDrawHighlightRingsOnHeader))&&zt(),ge===!0){Jt(It!==void 0&&q!==void 0);const{regions:yt}=Hc(Ke,It,It===tt?q.aBufferScroll:q.bBufferScroll,It===tt?q.bBufferScroll:q.aBufferScroll,q,c,l,a,f,R,r,i,$,Se,V,u,Me,M,mt);ut=yt}else ge!==!1&&(Jt(q!==void 0),ut=Tc(q,c,l,a,f,r,i,Se,Me,ge));Dc(Ke,Me,r,i,R,$,W,Ee,h);const Ht=vl(Ke,r,i,c,l,a,f,u,g,x,k,M,R,$,ue,h),sn=y?Ci(Ke,r,i,l,a,f,Me,u,h,Se,z,Ee,N,R,oe,X,$):void 0;if(Ke.fillStyle=h.bgCell,ut.length>0){Ke.beginPath();for(const yt of ut)Ke.rect(yt.x,yt.y,yt.width,yt.height);Ke.clip(),Ke.fill(),Ke.beginPath()}else Ke.fillRect(0,0,r,i);const tn=bl(Ke,Me,u,i,Se,a,f,l,$,Ee,N,L,E,p,H,y,R,oe,ut,Te,z,K,ue,te,Ge,ve,he,fe,ne,h,Je,ae,Qe,P,bt);Ic(Ke,Me,u,r,i,Se,a,f,l,$,Ee,E,z.rows,p,R,oe,ut,Te,h),Fc(Ke,Me,l,a,f,r,i,ut,Se,Ee,E,W,R,$,h),pl(Ke,Me,l,a,f,r,i,ut,tn,k,Se,Ee,E,W,R,$,h),Ht==null||Ht(),sn==null||sn(),T&&gt!=="none"&&Qn(Me,0,a,0,Se,(yt,ft)=>yt.sourceIndex===we?(Cl(_e,ft+yt.width,0,Se+1,Qt(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),gt==="full"&&Cl(Ke,ft+yt.width,Se,i,Qt(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),le!==null&&(le.fillStyle=h.bgCell,le.fillRect(0,0,r,i),le.drawImage(Ke.canvas,0,0));const Dt=Pc(Me,i,Se,a,f,l,$,Ee,R,oe);te==null||te.setWindow({x:c,y:l,width:Me.length,height:Dt-l},g,Array.from({length:R},(yt,ft)=>$-1-ft));const Lt=q!==void 0&&(c!==q.cellXOffset||a!==q.translateX),Bt=q!==void 0&&(l!==q.cellYOffset||f!==q.translateY);_.current={cellXOffset:c,cellYOffset:l,translateX:a,translateY:f,mustDrawFocusOnHeader:xt,mustDrawHighlightRingsOnHeader:Mt,lastBuffer:mt?Et===tt?"a":"b":void 0,aBufferScroll:Et===tt?[Lt,Bt]:q==null?void 0:q.aBufferScroll,bBufferScroll:Et===dt?[Lt,Bt]:q==null?void 0:q.bBufferScroll},Ke.restore(),_e.restore()}const Lc=80;function Bc(e){const t=e-1;return t*t*t+1}class Wc{constructor(t){Ne(this,"callback");Ne(this,"currentHoveredItem");Ne(this,"leavingItems",[]);Ne(this,"lastAnimationTime");Ne(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>rr(o.item,t.item))||this.leavingItems.push(t)});Ne(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>rr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Ne(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Ne(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Ne(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Bc(t.hoverAmount)})));Ne(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Lc;for(const i of this.leavingItems)i.hoverAmount=rn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=rn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Ne(this,"setHovered",t=>{var n;if(!rr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class $c{constructor(t){Ne(this,"fn");Ne(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Oi(e){return new $c(e)}const Oc=Oi(()=>window.navigator.userAgent.includes("Firefox")),Xr=Oi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Yr=Oi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Nc(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(c),c=()=>{const l=t.current.map($i);t.current=[],o.current(new Wo(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:c)},[]);return s.useCallback(i=>{t.current.length===0&&r();const c=mn(i[0],i[1]);t.current.includes(c)||t.current.push(c)},[r])}const Jn="header",gn="group-header",Gr="out-of-bounds";var Bo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Bo||(Bo={}));function ds(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Xc=(e,t)=>{if(e.kind===ee.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Yc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:c,cellYOffset:l,headerHeight:a,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:w,rows:g,getCellContent:b,getRowThemeOverride:h,onHeaderMenuClick:y,onHeaderIndicatorClick:x,enableGroups:k,isFilling:p,onCanvasFocused:M,onCanvasBlur:W,isFocused:P,selection:T,freezeColumns:z,onContextMenu:X,freezeTrailingRows:R,fixedShadowX:$=!0,fixedShadowY:N=!0,drawFocusRing:L,onMouseDown:E,onMouseUp:H,onMouseMoveRaw:re,onMouseMove:K,onItemHovered:fe,dragAndDropState:ue,firstColAccessible:we,onKeyDown:te,onKeyUp:_,highlightRegions:ve,canvasRef:ne,onDragStart:he,onDragEnd:Ge,eventTargetRef:U,isResizing:oe,resizeColumn:Le,isDragging:Je,isDraggable:ae=!1,allowResize:Qe,disabledRows:ct,hasAppendRow:Ce,getGroupDetails:Be,theme:Te,prelightCells:bt,headerIcons:gt,verticalBorder:mt,drawCell:V,drawHeader:ge,onCellFocused:ke,onDragOverCell:He,onDrop:Se,onDragLeave:lt,imageWindowLoader:tt,smoothScrollX:dt=!1,smoothScrollY:q=!1,experimental:le,getCellRenderer:_e,resizeIndicator:Ke="full"}=e,Et=e.translateX??0,It=e.translateY??0,Ee=Math.max(z,Math.min(i.length-1,c)),Me=s.useRef(null),ut=s.useRef((le==null?void 0:le.eventTarget)??window),xt=ut.current,Mt=tt,zt=s.useRef(),[Ht,sn]=s.useState(!1),tn=s.useRef([]),Dt=s.useRef(),[Lt,Bt]=s.useState(),[wn,yt]=s.useState(),ft=s.useRef(null),[Ve,Tt]=s.useState(),[Vt,bn]=s.useState(!1),In=s.useRef(Vt);In.current=Vt;const Xt=s.useMemo(()=>new yc(gt,()=>{mo.current=void 0,eo.current()}),[gt]),an=k?u+a:a,Ie=s.useRef(-1),it=((le==null?void 0:le.enableFirefoxRescaling)??!1)&&Oc.value,nt=((le==null?void 0:le.enableSafariRescaling)??!1)&&Xr.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!it&&!nt||(Ie.current!==-1&&sn(!0),window.clearTimeout(Ie.current),Ie.current=window.setTimeout(()=>{sn(!1),Ie.current=-1},200))},[l,Ee,Et,It,it,nt]);const je=xa(i,z),Pt=s.useMemo(()=>$?No(je,ue):0,[je,ue,$]),qe=s.useCallback((m,Y,J)=>{const ce=m.getBoundingClientRect();if(Y>=je.length||J>=g)return;const Q=ce.width/n,ie=Di(Y,J,n,o,u,an,Ee,l,Et,It,g,z,R,je,w);return Q!==1&&(ie.x*=Q,ie.y*=Q,ie.width*=Q,ie.height*=Q),ie.x+=ce.x,ie.y+=ce.y,ie},[n,o,u,an,Ee,l,Et,It,g,z,R,je,w]),Ze=s.useCallback((m,Y,J,ce)=>{const Q=m.getBoundingClientRect(),ie=Q.width/n,be=(Y-Q.left)/ie,ze=(J-Q.top)/ie,me=5,At=Ii(je,Ee,n,void 0,Et);let ye=0,st=0;const ot=typeof PointerEvent<"u"&&ce instanceof PointerEvent&&ce.pointerType==="mouse"||typeof MouseEvent<"u"&&ce instanceof MouseEvent,Ae=typeof PointerEvent<"u"&&ce instanceof PointerEvent&&ce.pointerType==="touch"||typeof TouchEvent<"u"&&ce instanceof TouchEvent;ot&&(ye=ce.button,st=ce.buttons);const $e=Ra(be,At,Et),Ue=Ea(ze,o,k,a,u,g,w,l,It,R),et=(ce==null?void 0:ce.shiftKey)===!0,qt=(ce==null?void 0:ce.ctrlKey)===!0,Cn=(ce==null?void 0:ce.metaKey)===!0,jt=[be<0?-1:n<be?1:0,ze<an?-1:o<ze?1:0];let kt;if($e===-1||ze<0||be<0||Ue===void 0||be>n||ze>o){const Oe=be>n?1:be<0?-1:0,dn=ze>o?1:ze<0?-1:0;let _t=Oe*2,zn=dn*2;Oe===0&&(_t=$e===-1?Bo.EndPadding:Bo.Center),dn===0&&(zn=Ue===void 0?Bo.EndPadding:Bo.Center);let Pn=!1;if($e===-1&&Ue===-1){const We=qe(m,je.length-1,-1);Jt(We!==void 0),Pn=Y<We.x+We.width+me}const _n=be>n&&be<n+Ei()||ze>o&&ze<o+Ei();kt={kind:Gr,location:[$e!==-1?$e:be<0?0:je.length-1,Ue??g-1],region:[_t,zn],shiftKey:et,ctrlKey:qt,metaKey:Cn,isEdge:Pn,isTouch:Ae,button:ye,buttons:st,scrollEdge:jt,isMaybeScrollbar:_n}}else if(Ue<=-1){let Oe=qe(m,$e,Ue);Jt(Oe!==void 0);let dn=Oe!==void 0&&Oe.x+Oe.width-Y<=me;const _t=$e-1;Y-Oe.x<=me&&_t>=0?(dn=!0,Oe=qe(m,_t,Ue),Jt(Oe!==void 0),kt={kind:k&&Ue===-2?gn:Jn,location:[_t,Ue],bounds:Oe,group:je[_t].group??"",isEdge:dn,shiftKey:et,ctrlKey:qt,metaKey:Cn,isTouch:Ae,localEventX:Y-Oe.x,localEventY:J-Oe.y,button:ye,buttons:st,scrollEdge:jt}):kt={kind:k&&Ue===-2?gn:Jn,group:je[$e].group??"",location:[$e,Ue],bounds:Oe,isEdge:dn,shiftKey:et,ctrlKey:qt,metaKey:Cn,isTouch:Ae,localEventX:Y-Oe.x,localEventY:J-Oe.y,button:ye,buttons:st,scrollEdge:jt}}else{const Oe=qe(m,$e,Ue);Jt(Oe!==void 0);const dn=Oe!==void 0&&Oe.x+Oe.width-Y<me;let _t=!1;if(f!==!1&&f!==void 0&&T.current!==void 0){const Pn=typeof f=="object"?{...Or,...f}:Or,_n=Pn.size,We=_n/2,$t=Xl(T.current.range),xn=qe(m,$t[0],$t[1]);if(xn!==void 0){const pr=xn.x+xn.width+Pn.offsetX-We+.5,Ln=xn.y+xn.height+Pn.offsetY-We+.5;_t=Math.abs(pr-Y)<_n&&Math.abs(Ln-J)<_n}}kt={kind:"cell",location:[$e,Ue],bounds:Oe,isEdge:dn,shiftKey:et,ctrlKey:qt,isFillHandle:_t,metaKey:Cn,isTouch:Ae,localEventX:Y-Oe.x,localEventY:J-Oe.y,button:ye,buttons:st,scrollEdge:jt}}return kt},[n,je,Ee,Et,o,k,a,u,g,w,l,It,R,qe,f,T,an]),[Dn]=Lt??[],dr=s.useRef(()=>{}),$n=s.useRef(Lt);$n.current=Lt;const[Fn,Hn]=s.useMemo(()=>{const m=document.createElement("canvas"),Y=document.createElement("canvas");return m.style.display="none",m.style.opacity="0",m.style.position="fixed",Y.style.display="none",Y.style.opacity="0",Y.style.position="fixed",[m.getContext("2d",{alpha:!1}),Y.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Fn===null||Hn===null))return document.documentElement.append(Fn.canvas),document.documentElement.append(Hn.canvas),()=>{Fn.canvas.remove(),Hn.canvas.remove()}},[Fn,Hn]);const go=s.useMemo(()=>new La,[]),ur=it&&Ht?1:nt&&Ht?2:5,On=(le==null?void 0:le.disableMinimumCellWidth)===!0?1:10,mo=s.useRef(),wo=s.useRef(null),bo=s.useRef(null),yo=s.useCallback(()=>{var be;const m=Me.current,Y=ft.current;if(m===null||Y===null||(wo.current===null&&(wo.current=m.getContext("2d",{alpha:!1}),m.width=0,m.height=0),bo.current===null&&(bo.current=Y.getContext("2d",{alpha:!1}),Y.width=0,Y.height=0),wo.current===null||bo.current===null||Fn===null||Hn===null))return;let J=!1;const ce=ze=>{J=!0,Tt(ze)},Q=mo.current,ie={headerCanvasCtx:bo.current,canvasCtx:wo.current,bufferACtx:Fn,bufferBCtx:Hn,width:n,height:o,cellXOffset:Ee,cellYOffset:l,translateX:Math.round(Et),translateY:Math.round(It),mappedColumns:je,enableGroups:k,freezeColumns:z,dragAndDropState:ue,theme:Te,headerHeight:a,groupHeaderHeight:u,disabledRows:ct??rt.empty(),rowHeight:w,verticalBorder:mt,isResizing:oe,resizeCol:Le,isFocused:P,selection:T,fillHandle:f,drawCellCallback:V,hasAppendRow:Ce,overrideCursor:ce,maxScaleFactor:ur,freezeTrailingRows:R,rows:g,drawFocus:L,getCellContent:b,getGroupDetails:Be??(ze=>({name:ze})),getRowThemeOverride:h,drawHeaderCallback:ge,prelightCells:bt,highlightRegions:ve,imageLoader:Mt,lastBlitData:Dt,damage:zt.current,hoverValues:tn.current,hoverInfo:$n.current,spriteManager:Xt,scrolling:Ht,hyperWrapping:(le==null?void 0:le.hyperWrapping)??!1,touchMode:Vt,enqueue:dr.current,renderStateProvider:go,renderStrategy:(le==null?void 0:le.renderStrategy)??(Xr.value?"double-buffer":"single-buffer"),getCellRenderer:_e,minimumCellWidth:On,resizeIndicator:Ke};ie.damage===void 0?(mo.current=ie,xl(ie,Q)):xl(ie,void 0),!J&&(ie.damage===void 0||ie.damage.has((be=$n==null?void 0:$n.current)==null?void 0:be[0]))&&Tt(void 0)},[Fn,Hn,n,o,Ee,l,Et,It,je,k,z,ue,Te,a,u,ct,w,mt,oe,Ce,Le,P,T,f,R,g,L,ur,b,Be,h,V,ge,bt,ve,Mt,Xt,Ht,le==null?void 0:le.hyperWrapping,le==null?void 0:le.renderStrategy,Vt,go,_e,On,Ke]),eo=s.useRef(yo);s.useLayoutEffect(()=>{yo(),eo.current=yo},[yo]),s.useLayoutEffect(()=>{(async()=>{var Y;((Y=document==null?void 0:document.fonts)==null?void 0:Y.ready)!==void 0&&(await document.fonts.ready,mo.current=void 0,eo.current())})()},[]);const Tn=s.useCallback(m=>{zt.current=m,eo.current(),zt.current=void 0},[]),Kr=Nc(Tn);dr.current=Kr;const fr=s.useCallback(m=>{Tn(new Wo(m.map(Y=>Y.cell)))},[Tn]);Mt.setCallback(Tn);const[Vr,qr]=s.useState(!1),[yn,Nn]=Dn??[],jr=yn!==void 0&&Nn===-1&&yn>=0&&yn<je.length&&je[yn].headerRowMarkerDisabled!==!0,Zr=yn!==void 0&&Nn===-2;let po=!1,hr=!1,to=Ve;if(to===void 0&&yn!==void 0&&Nn!==void 0&&Nn>-1&&Nn<g){const m=b([yn,Nn],!0);po=m.kind===ln.NewRow||m.kind===ln.Marker&&m.markerKind!=="number",hr=m.kind===ee.Boolean&&zi(m),to=m.cursor}const gr=Je?"grabbing":(wn??!1)||oe?"col-resize":Vr||p?"crosshair":to!==void 0?to:jr||po||hr||Zr?"pointer":"default",Yo=s.useMemo(()=>({contain:"strict",display:"block",cursor:gr}),[gr]),Go=s.useRef("default"),wt=U==null?void 0:U.current;wt!=null&&Go.current!==Yo.cursor&&(wt.style.cursor=Go.current=Yo.cursor);const Wt=s.useCallback((m,Y,J,ce)=>{if(Be===void 0)return;const Q=Be(m);if(Q.actions!==void 0){const ie=ls(Y,Q.actions);for(const[be,ze]of ie.entries())if(uo(ze,J+Y.x,ce+ze.y))return Q.actions[be]}},[Be]),Xn=s.useCallback((m,Y,J,ce)=>{const Q=je[Y];if(!Je&&!oe&&!(wn??!1)){const ie=qe(m,Y,-1);Jt(ie!==void 0);const be=ss(void 0,Q,ie.x,ie.y,ie.width,ie.height,Te,Li(Q.title)==="rtl");if(Q.hasMenu===!0&&be.menuBounds!==void 0&&uo(be.menuBounds,J,ce))return{area:"menu",bounds:be.menuBounds};if(Q.indicatorIcon!==void 0&&be.indicatorIconBounds!==void 0&&uo(be.indicatorIconBounds,J,ce))return{area:"indicator",bounds:be.indicatorIconBounds}}},[je,qe,wn,Je,oe,Te]),vo=s.useRef(0),Yn=s.useRef(),Co=s.useRef(!1),mr=s.useCallback(m=>{const Y=Me.current,J=U==null?void 0:U.current;if(Y===null||m.target!==Y&&m.target!==J)return;Co.current=!0;const ce=m.clientX,Q=m.clientY;if(m.target===J&&J!==null){const be=J.getBoundingClientRect();if(ce>be.right||Q>be.bottom)return}const ie=Ze(Y,ce,Q,m);Yn.current=ie.location,ie.isTouch&&(vo.current=Date.now()),In.current!==ie.isTouch&&bn(ie.isTouch),!(ie.kind===Jn&&Xn(Y,ie.location[0],ce,Q)!==void 0)&&(ie.kind===gn&&Wt(ie.group,ie.bounds,ie.localEventX,ie.localEventY)!==void 0||(E==null||E(ie),!ie.isTouch&&ae!==!0&&ae!==ie.kind&&ie.button<3&&ie.button!==1&&m.preventDefault()))},[U,ae,Ze,Wt,Xn,E]);Gt("pointerdown",mr,xt,!1);const no=s.useRef(0),xo=s.useCallback(m=>{var st,ot;const Y=no.current;no.current=Date.now();const J=Me.current;if(Co.current=!1,H===void 0||J===null)return;const ce=U==null?void 0:U.current,Q=m.target!==J&&m.target!==ce,ie=m.clientX,be=m.clientY,ze=m.pointerType==="mouse"?m.button<3:!0;let me=Ze(J,ie,be,m);me.isTouch&&vo.current!==0&&Date.now()-vo.current>500&&(me={...me,isLongTouch:!0}),Y!==0&&Date.now()-Y<(me.isTouch?1e3:500)&&(me={...me,isDoubleClick:!0}),In.current!==me.isTouch&&bn(me.isTouch),!Q&&m.cancelable&&ze&&m.preventDefault();const[At]=me.location,ye=Xn(J,At,ie,be);if(me.kind===Jn&&ye!==void 0){(me.button!==0||((st=Yn.current)==null?void 0:st[0])!==At||((ot=Yn.current)==null?void 0:ot[1])!==-1)&&H(me,!0);return}else if(me.kind===gn){const Ae=Wt(me.group,me.bounds,me.localEventX,me.localEventY);if(Ae!==void 0){me.button===0&&Ae.onClick(me);return}}H(me,Q)},[H,U,Ze,Xn,Wt]);Gt("pointerup",xo,xt,!1);const Gn=s.useCallback(m=>{var At,ye;const Y=Me.current;if(Y===null)return;const J=U==null?void 0:U.current,ce=m.target!==Y&&m.target!==J;let Q,ie,be=!0;m instanceof MouseEvent?(Q=m.clientX,ie=m.clientY,be=m.button<3):(Q=m.changedTouches[0].clientX,ie=m.changedTouches[0].clientY);const ze=Ze(Y,Q,ie,m);In.current!==ze.isTouch&&bn(ze.isTouch),!ce&&m.cancelable&&be&&m.preventDefault();const[me]=ze.location;if(ze.kind===Jn){const st=Xn(Y,me,Q,ie);st!==void 0&&ze.button===0&&((At=Yn.current)==null?void 0:At[0])===me&&((ye=Yn.current)==null?void 0:ye[1])===-1&&(st.area==="menu"?y==null||y(me,st.bounds):st.area==="indicator"&&(x==null||x(me,st.bounds)))}},[U,Ze,Xn,y,x]);Gt("click",Gn,xt,!1);const ko=s.useCallback(m=>{const Y=Me.current,J=U==null?void 0:U.current;if(Y===null||m.target!==Y&&m.target!==J||X===void 0)return;const ce=Ze(Y,m.clientX,m.clientY,m);X(ce,()=>{m.cancelable&&m.preventDefault()})},[U,Ze,X]);Gt("contextmenu",ko,(U==null?void 0:U.current)??null,!1);const wr=s.useCallback(m=>{zt.current=new Wo(m.map(Y=>Y.item)),tn.current=m,eo.current(),zt.current=void 0},[]),_o=s.useMemo(()=>new Wc(wr),[wr]),xe=s.useRef(_o);xe.current=_o,s.useLayoutEffect(()=>{const m=xe.current;if(Dn===void 0||Dn[1]<0){m.setHovered(Dn);return}const Y=b(Dn,!0),J=_e(Y),ce=J===void 0&&Y.kind===ee.Custom||(J==null?void 0:J.needsHover)!==void 0&&(typeof J.needsHover=="boolean"?J.needsHover:J.needsHover(Y));m.setHovered(ce?Dn:void 0)},[b,_e,Dn]);const Uo=s.useRef(),Qr=s.useCallback(m=>{var ze;const Y=Me.current;if(Y===null)return;const J=U==null?void 0:U.current,ce=m.target!==Y&&m.target!==J,Q=Ze(Y,m.clientX,m.clientY,m);if(Q.kind!=="out-of-bounds"&&ce&&!Co.current&&!Q.isTouch)return;const ie=(me,At)=>{Bt(ye=>ye===me||(ye==null?void 0:ye[0][0])===(me==null?void 0:me[0][0])&&(ye==null?void 0:ye[0][1])===(me==null?void 0:me[0][1])&&((ye==null?void 0:ye[1][0])===(me==null?void 0:me[1][0])&&(ye==null?void 0:ye[1][1])===(me==null?void 0:me[1][1])||!At)?ye:me)};if(!ds(Q,Uo.current))Tt(void 0),fe==null||fe(Q),ie(Q.kind===Gr?void 0:[Q.location,[Q.localEventX,Q.localEventY]],!0),Uo.current=Q;else if(Q.kind==="cell"||Q.kind===Jn||Q.kind===gn){let me=!1,At=!0;if(Q.kind==="cell"){const st=b(Q.location);At=((ze=_e(st))==null?void 0:ze.needsHoverPosition)??st.kind===ee.Custom,me=At}else me=!0;const ye=[Q.location,[Q.localEventX,Q.localEventY]];ie(ye,At),$n.current=ye,me&&Tn(new Wo([Q.location]))}const be=Q.location[0]>=(we?0:1);yt(Q.kind===Jn&&Q.isEdge&&be&&Qe===!0),qr(Q.kind==="cell"&&Q.isFillHandle),re==null||re(m),K(Q)},[U,Ze,we,Qe,re,K,fe,b,_e,Tn]);Gt("pointermove",Qr,xt,!0);const cn=s.useCallback(m=>{const Y=Me.current;if(Y===null)return;let J,ce;T.current!==void 0&&(J=qe(Y,T.current.cell[0],T.current.cell[1]),ce=T.current.cell),te==null||te({bounds:J,stopPropagation:()=>m.stopPropagation(),preventDefault:()=>m.preventDefault(),cancel:()=>{},ctrlKey:m.ctrlKey,metaKey:m.metaKey,shiftKey:m.shiftKey,altKey:m.altKey,key:m.key,keyCode:m.keyCode,rawEvent:m,location:ce})},[te,T,qe]),ei=s.useCallback(m=>{const Y=Me.current;if(Y===null)return;let J,ce;T.current!==void 0&&(J=qe(Y,T.current.cell[0],T.current.cell[1]),ce=T.current.cell),_==null||_({bounds:J,stopPropagation:()=>m.stopPropagation(),preventDefault:()=>m.preventDefault(),cancel:()=>{},ctrlKey:m.ctrlKey,metaKey:m.metaKey,shiftKey:m.shiftKey,altKey:m.altKey,key:m.key,keyCode:m.keyCode,rawEvent:m,location:ce})},[_,T,qe]),pn=s.useCallback(m=>{if(Me.current=m,ne!==void 0&&(ne.current=m),le!=null&&le.eventTarget)ut.current=le.eventTarget;else if(m===null)ut.current=window;else{const Y=m.getRootNode();Y===document&&(ut.current=window),ut.current=Y}},[ne,le==null?void 0:le.eventTarget]),Ko=s.useCallback(m=>{const Y=Me.current;if(Y===null||ae===!1||oe){m.preventDefault();return}let J,ce;const Q=Ze(Y,m.clientX,m.clientY);if(ae!==!0&&Q.kind!==ae){m.preventDefault();return}const ie=(st,ot)=>{J=st,ce=ot};let be,ze,me;const At=(st,ot,Ae)=>{be=st,ze=ot,me=Ae};let ye=!1;if(he==null||he({...Q,setData:ie,setDragImage:At,preventDefault:()=>ye=!0,defaultPrevented:()=>ye}),!ye&&J!==void 0&&ce!==void 0&&m.dataTransfer!==null)if(m.dataTransfer.setData(J,ce),m.dataTransfer.effectAllowed="copyLink",be!==void 0&&ze!==void 0&&me!==void 0)m.dataTransfer.setDragImage(be,ze,me);else{const[st,ot]=Q.location;if(ot!==void 0){const Ae=document.createElement("canvas"),$e=qe(Y,st,ot);Jt($e!==void 0);const Ue=Math.ceil(window.devicePixelRatio??1);Ae.width=$e.width*Ue,Ae.height=$e.height*Ue;const et=Ae.getContext("2d");et!==null&&(et.scale(Ue,Ue),et.textBaseline="middle",ot===-1?(et.font=Te.headerFontFull,et.fillStyle=Te.bgHeader,et.fillRect(0,0,Ae.width,Ae.height),as(et,0,0,$e.width,$e.height,je[st],!1,Te,!1,void 0,void 0,!1,0,Xt,ge,!1)):(et.font=Te.baseFontFull,et.fillStyle=Te.bgCell,et.fillRect(0,0,Ae.width,Ae.height),is(et,b([st,ot]),0,ot,!1,!1,0,0,$e.width,$e.height,!1,Te,Te.bgCell,Mt,Xt,1,void 0,!1,0,void 0,void 0,void 0,go,_e,()=>{},0))),Ae.style.left="-100%",Ae.style.position="absolute",Ae.style.width=`${$e.width}px`,Ae.style.height=`${$e.height}px`,document.body.append(Ae),m.dataTransfer.setDragImage(Ae,$e.width/2,$e.height/2),window.setTimeout(()=>{Ae.remove()},0)}}else m.preventDefault()},[ae,oe,Ze,he,qe,Te,je,Xt,ge,b,Mt,go,_e]);Gt("dragstart",Ko,(U==null?void 0:U.current)??null,!1,!1);const So=s.useRef(),br=s.useCallback(m=>{const Y=Me.current;if(Se!==void 0&&m.preventDefault(),Y===null||He===void 0)return;const J=Ze(Y,m.clientX,m.clientY),[ce,Q]=J.location,ie=ce-(we?0:1),[be,ze]=So.current??[];(be!==ie||ze!==Q)&&(So.current=[ie,Q],He([ie,Q],m.dataTransfer))},[we,Ze,He,Se]);Gt("dragover",br,(U==null?void 0:U.current)??null,!1,!1);const ti=s.useCallback(()=>{So.current=void 0,Ge==null||Ge()},[Ge]);Gt("dragend",ti,(U==null?void 0:U.current)??null,!1,!1);const ni=s.useCallback(m=>{const Y=Me.current;if(Y===null||Se===void 0)return;m.preventDefault();const J=Ze(Y,m.clientX,m.clientY),[ce,Q]=J.location,ie=ce-(we?0:1);Se([ie,Q],m.dataTransfer)},[we,Ze,Se]);Gt("drop",ni,(U==null?void 0:U.current)??null,!1,!1);const vn=s.useCallback(()=>{lt==null||lt()},[lt]);Gt("dragleave",vn,(U==null?void 0:U.current)??null,!1,!1);const An=s.useRef(T);An.current=T;const Yt=s.useRef(null),I=s.useCallback(m=>{var Y;Me.current===null||!Me.current.contains(document.activeElement)||(m===null&&An.current.current!==void 0?(Y=ne==null?void 0:ne.current)==null||Y.focus({preventScroll:!0}):m!==null&&m.focus({preventScroll:!0}),Yt.current=m)},[ne]);s.useImperativeHandle(t,()=>({focus:()=>{var Y;const m=Yt.current;m===null||!document.contains(m)?(Y=ne==null?void 0:ne.current)==null||Y.focus({preventScroll:!0}):m.focus({preventScroll:!0})},getBounds:(m,Y)=>{if(!(ne===void 0||ne.current===null))return qe(ne.current,m??0,Y??-1)},damage:fr,getMouseArgsForPosition:(m,Y,J)=>{if(!(ne===void 0||ne.current===null))return Ze(ne.current,m,Y,J)}}),[ne,fr,qe,Ze]);const vt=s.useRef(),oo=ca(()=>{var ze,me,At;if(n<50||(le==null?void 0:le.disableAccessibilityTree)===!0)return null;let m=Ii(je,Ee,n,ue,Et);const Y=we?0:-1;!we&&((ze=m[0])==null?void 0:ze.sourceIndex)===0&&(m=m.slice(1));const[J,ce]=((me=T.current)==null?void 0:me.cell)??[],Q=(At=T.current)==null?void 0:At.range,ie=m.map(ye=>ye.sourceIndex),be=co(l,Math.min(g,l+r));return J!==void 0&&ce!==void 0&&!(ie.includes(J)&&be.includes(ce))&&I(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":g+1,"aria-multiselectable":"true","aria-colcount":je.length+Y},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},m.map(ye=>s.createElement("th",{role:"columnheader","aria-selected":T.columns.hasIndex(ye.sourceIndex),"aria-colindex":ye.sourceIndex+1+Y,tabIndex:-1,onFocus:st=>{if(st.target!==Yt.current)return ke==null?void 0:ke([ye.sourceIndex,-1])},key:ye.sourceIndex},ye.title)))),s.createElement("tbody",{role:"rowgroup"},be.map(ye=>s.createElement("tr",{role:"row","aria-selected":T.rows.hasIndex(ye),key:ye,"aria-rowindex":ye+2},m.map(st=>{const ot=st.sourceIndex,Ae=mn(ot,ye),$e=J===ot&&ce===ye,Ue=Q!==void 0&&ot>=Q.x&&ot<Q.x+Q.width&&ye>=Q.y&&ye<Q.y+Q.height,et=`glide-cell-${ot}-${ye}`,qt=[ot,ye],Cn=b(qt,!0);return s.createElement("td",{key:Ae,role:"gridcell","aria-colindex":ot+1+Y,"aria-selected":Ue,"aria-readonly":Lo(Cn)||!Po(Cn),id:et,"data-testid":et,onClick:()=>{const jt=ne==null?void 0:ne.current;if(jt!=null)return te==null?void 0:te({bounds:qe(jt,ot,ye),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:qt})},onFocusCapture:jt=>{var kt,Oe;if(!(jt.target===Yt.current||((kt=vt.current)==null?void 0:kt[0])===ot&&((Oe=vt.current)==null?void 0:Oe[1])===ye))return vt.current=qt,ke==null?void 0:ke(qt)},ref:$e?I:void 0,tabIndex:-1},Xc(Cn,_e))})))))},[n,je,Ee,ue,Et,g,l,r,T,I,b,ne,te,qe,ke],200),Mo=z===0||!$?0:Ee>z?1:rn(-Et/100,0,1),yr=-l*32+It,Ro=N?rn(-yr/100,0,1):0,oi=s.useMemo(()=>{if(!Mo&&!Ro)return null;const m={position:"absolute",top:0,left:Pt,width:n-Pt,height:o,opacity:Mo,pointerEvents:"none",transition:dt?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},Y={position:"absolute",top:an,left:0,width:n,height:o,opacity:Ro,pointerEvents:"none",transition:q?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,Mo>0&&s.createElement("div",{id:"shadow-x",style:m}),Ro>0&&s.createElement("div",{id:"shadow-y",style:Y}))},[Mo,Ro,Pt,n,dt,an,o,q]),Xi=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:cn,onKeyUp:ei,onFocus:M,onBlur:W,ref:pn,style:Yo},oo),s.createElement("canvas",{ref:ft,style:Xi}),oi)},Gc=s.memo(s.forwardRef(Yc));function or(e,t,n,o){return rn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const _c=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,c]=s.useState(),[l,a]=s.useState(),[f,u]=s.useState(!1),[w,g]=s.useState(),[b,h]=s.useState(),[y,x]=s.useState(),[k,p]=s.useState(!1),[M,W]=s.useState(),{onHeaderMenuClick:P,onHeaderIndicatorClick:T,getCellContent:z,onColumnMoved:X,onColumnResize:R,onColumnResizeStart:$,onColumnResizeEnd:N,gridRef:L,maxColumnWidth:E,minColumnWidth:H,onRowMoved:re,lockColumns:K,onColumnProposeMove:fe,onMouseDown:ue,onMouseUp:we,onItemHovered:te,onDragStart:_,canvasRef:ve}=e,ne=(R??N??$)!==void 0,{columns:he,selection:Ge}=e,U=Ge.columns,oe=s.useCallback(V=>{const[ge,ke]=V.location;i!==void 0&&l!==ge&&ge>=K?(u(!0),a(ge)):b!==void 0&&ke!==void 0?(p(!0),x(Math.max(0,ke))):o===void 0&&!f&&!k&&(te==null||te(V))},[i,b,l,te,K,o,f,k]),Le=X!==void 0,Je=s.useCallback(V=>{var ge;if(V.button===0){const[ke,He]=V.location;if(V.kind==="out-of-bounds"&&V.isEdge&&ne){const Se=(ge=L==null?void 0:L.current)==null?void 0:ge.getBounds(he.length-1,-1);Se!==void 0&&(n(Se.x),r(he.length-1))}else if(V.kind==="header"&&ke>=K){const Se=ve==null?void 0:ve.current;if(V.isEdge&&ne&&Se){n(V.bounds.x),r(ke);const tt=Se.getBoundingClientRect().width/Se.offsetWidth,dt=V.bounds.width/tt;$==null||$(he[ke],dt,ke,dt+(he[ke].growOffset??0))}else V.kind==="header"&&Le&&(g(V.bounds.x),c(ke))}else V.kind==="cell"&&K>0&&ke===0&&He!==void 0&&re!==void 0&&(W(V.bounds.y),h(He))}ue==null||ue(V)},[ue,ne,K,re,L,he,Le,$,ve]),ae=s.useCallback((V,ge)=>{f||k||P==null||P(V,ge)},[f,k,P]),Qe=s.useCallback((V,ge)=>{f||k||T==null||T(V,ge)},[f,k,T]),ct=s.useRef(-1),Ce=s.useCallback(()=>{ct.current=-1,h(void 0),x(void 0),W(void 0),p(!1),c(void 0),a(void 0),g(void 0),u(!1),r(void 0),n(void 0)},[]),Be=s.useCallback((V,ge)=>{if(V.button===0){if(o!==void 0){if((U==null?void 0:U.hasIndex(o))===!0)for(const He of U){if(He===o)continue;const Se=he[He],lt=or(Se,ct.current,H,E);R==null||R(Se,lt,He,lt+(Se.growOffset??0))}const ke=or(he[o],ct.current,H,E);if(N==null||N(he[o],ke,o,ke+(he[o].growOffset??0)),U.hasIndex(o))for(const He of U){if(He===o)continue;const Se=he[He],lt=or(Se,ct.current,H,E);N==null||N(Se,lt,He,lt+(Se.growOffset??0))}}Ce(),i!==void 0&&l!==void 0&&(fe==null?void 0:fe(i,l))!==!1&&(X==null||X(i,l)),b!==void 0&&y!==void 0&&(re==null||re(b,y))}we==null||we(V,ge)},[we,o,i,l,b,y,U,N,he,H,E,R,X,re,Ce,fe]),Te=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(fe==null?void 0:fe(i,l))!==!1)return{src:i,dest:l}},[i,l,fe]),bt=s.useCallback(V=>{const ge=ve==null?void 0:ve.current;if(i!==void 0&&w!==void 0)Math.abs(V.clientX-w)>20&&u(!0);else if(b!==void 0&&M!==void 0)Math.abs(V.clientY-M)>20&&p(!0);else if(o!==void 0&&t!==void 0&&ge){const He=ge.getBoundingClientRect().width/ge.offsetWidth,Se=(V.clientX-t)/He,lt=he[o],tt=or(lt,Se,H,E);if(R==null||R(lt,tt,o,tt+(lt.growOffset??0)),ct.current=Se,(U==null?void 0:U.first())===o)for(const dt of U){if(dt===o)continue;const q=he[dt],le=or(q,ct.current,H,E);R==null||R(q,le,dt,le+(q.growOffset??0))}}},[i,w,b,M,o,t,he,H,E,R,U,ve]),gt=s.useCallback((V,ge)=>{if(b===void 0||y===void 0)return z(V,ge);let[ke,He]=V;return He===y?He=b:(He>y&&(He-=1),He>=b&&(He+=1)),z([ke,He],ge)},[b,y,z]),mt=s.useCallback(V=>{_==null||_(V),V.defaultPrevented()||Ce()},[Ce,_]);return s.createElement(Gc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:gt,isResizing:o!==void 0,onHeaderMenuClick:ae,onHeaderIndicatorClick:Qe,isDragging:f,onItemHovered:oe,onDragStart:mt,onMouseDown:Je,allowResize:ne,onMouseUp:Be,dragAndDropState:Te,onMouseMoveRaw:bt,ref:L})};function Uc(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=c=>{for(const l of c){const{width:a,height:f}=l&&l.contentRect||{};o(u=>u.width===a&&u.height===f?u:{width:a,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Kc=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),c=s.useRef(0),l=s.useRef(t);l.current=t;const a=n.current;s.useEffect(()=>{const f=()=>{var g,b;if(r.current===!1&&a!==null){const h=[a.scrollLeft,a.scrollTop];if(((g=i.current)==null?void 0:g[0])===h[0]&&((b=i.current)==null?void 0:b[1])===h[1])if(c.current>10){i.current=null,r.current=null;return}else c.current++;else c.current=0,l.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},w=g=>{g.touches.length===0&&(r.current=!1,c.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&a!==null){const g=a;return g.addEventListener("touchstart",u),g.addEventListener("touchend",w),()=>{g.removeEventListener("touchstart",u),g.removeEventListener("touchend",w),o.current!==null&&window.clearTimeout(o.current)}}},[e,a])},Vc=()=>e=>e.isSafari?"scroll":"auto",qc=en("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Vc()]}}),jc=33554400,Zc=5e6;function Jc(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Gt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Gt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Qc=e=>{var Ge,U;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:c,className:l,preventDiagonalScrolling:a=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:w,rightElementProps:g,kineticScrollPerfHack:b=!1,scrollRef:h,initialSize:y}=e,x=[],k=(g==null?void 0:g.sticky)??!1,p=(g==null?void 0:g.fill)??!1,M=s.useRef(0),W=s.useRef(0),P=s.useRef(null),T=typeof window>"u"?1:window.devicePixelRatio,z=s.useRef(T);s.useEffect(()=>{if(z.current!==T){M.current=0,W.current=0,z.current=T;const oe=P.current;oe!==null&&re.current(oe.scrollLeft,oe.scrollTop)}},[T]);const X=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),R=s.useRef(null),$=Jc(200),[N,L]=s.useState(!0),E=s.useRef(0);s.useLayoutEffect(()=>{if(!N||$||X.current.lockDirection===void 0)return;const oe=P.current;if(oe===null)return;const[Le,Je]=X.current.lockDirection;Le!==void 0?oe.scrollLeft=Le:Je!==void 0&&(oe.scrollTop=Je),X.current.lockDirection=void 0},[$,N]);const H=s.useCallback((oe,Le)=>{var ke;const Je=P.current;if(Je===null)return;Le=Le??Je.scrollTop,oe=oe??Je.scrollLeft;const ae=X.current.scrollTop,Qe=X.current.scrollLeft,ct=oe-Qe,Ce=Le-ae;$&&ct!==0&&Ce!==0&&(Math.abs(ct)>3||Math.abs(Ce)>3)&&a&&X.current.lockDirection===void 0&&(X.current.lockDirection=Math.abs(ct)<Math.abs(Ce)?[Qe,void 0]:[void 0,ae]);const Be=X.current.lockDirection;oe=(Be==null?void 0:Be[0])??oe,Le=(Be==null?void 0:Be[1])??Le,X.current.scrollLeft=oe,X.current.scrollTop=Le;const Te=Je.clientWidth,bt=Je.clientHeight,gt=Le,mt=W.current-gt,V=Je.scrollHeight-bt;W.current=gt;let ge;if(V>0&&o>Je.scrollHeight+5)if(Math.abs(mt)>2e3||gt===0||gt===V){const He=Math.max(0,Math.min(1,gt/V)),Se=o-bt;ge=He*Se,M.current=ge}else M.current-=mt,ge=M.current;else ge=gt,M.current=ge;ge=Math.max(0,Math.min(ge,o-bt)),M.current=ge,Be!==void 0&&(window.clearTimeout(E.current),L(!1),E.current=window.setTimeout(()=>L(!0),200)),i({x:oe,y:ge,width:Te-u,height:bt-f,paddingRight:((ke=R.current)==null?void 0:ke.clientWidth)??0})},[f,u,o,i,a,$]);Kc(b&&Xr.value,H,P);const re=s.useRef(H);re.current=H;const K=s.useRef(),fe=s.useRef(!1);s.useLayoutEffect(()=>{fe.current?H():fe.current=!0},[H,f,u]);const ue=s.useCallback(oe=>{P.current=oe,h!==void 0&&(h.current=oe)},[h]);let we=0,te=0;const _=Math.min(o,jc);for(x.push(s.createElement("div",{key:we++,style:{width:r,height:0}}));te<_;){const oe=Math.min(Zc,_-te);x.push(s.createElement("div",{key:we++,style:{width:0,height:oe}})),te+=oe}const{ref:ve,width:ne,height:he}=Uc(y);return typeof window<"u"&&(((Ge=K.current)==null?void 0:Ge.height)!==he||((U=K.current)==null?void 0:U.width)!==ne)&&(window.setTimeout(()=>re.current(),0),K.current={width:ne,height:he}),(ne??0)===0||(he??0)===0?s.createElement("div",{ref:ve}):s.createElement("div",{ref:ve},s.createElement(qc,{isSafari:Xr.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:ue,style:K.current,draggable:c,onDragStart:oe=>{c||(oe.stopPropagation(),oe.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>H()},s.createElement("div",{className:"dvn-scroll-inner"+(w===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},x),w!==void 0&&s.createElement(s.Fragment,null,!p&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:R,style:{height:he,maxHeight:n-Math.ceil(T%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:p?1:void 0,right:k?u??0:void 0,pointerEvents:"auto"}},w))))))},ed=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:c,freezeColumns:l,experimental:a,nonGrowWidth:f,clientSize:u,className:w,onVisibleRegionChanged:g,scrollRef:b,preventDiagonalScrolling:h,rightElement:y,rightElementProps:x,overscrollX:k,overscrollY:p,initialSize:M,smoothScrollX:W=!1,smoothScrollY:P=!1,isDraggable:T}=e,{paddingRight:z,paddingBottom:X}=a??{},[R,$]=u,N=s.useRef(),L=s.useRef(),E=s.useRef(),H=s.useRef(),re=f+Math.max(0,k??0);let K=c?r+i:r;if(typeof o=="number")K+=n*o;else for(let te=0;te<n;te++)K+=o(te);p!==void 0&&(K+=p);const fe=s.useRef(),ue=s.useCallback(()=>{var Qe,ct;if(fe.current===void 0)return;const te={...fe.current};let _=0,ve=te.x<0?-te.x:0,ne=0,he=0;te.x=te.x<0?0:te.x;let Ge=0;for(let Ce=0;Ce<l;Ce++)Ge+=t[Ce].width;for(const Ce of t){const Be=_-Ge;if(te.x>=Be+Ce.width)_+=Ce.width,he++,ne++;else if(te.x>Be)_+=Ce.width,W?ve+=Be-te.x:he++,ne++;else if(te.x+te.width>Be)_+=Ce.width,ne++;else break}let U=0,oe=0,Le=0;if(typeof o=="number")P?(oe=Math.floor(te.y/o),U=oe*o-te.y):oe=Math.ceil(te.y/o),Le=Math.ceil(te.height/o)+oe,U<0&&Le++;else{let Ce=0;for(let Be=0;Be<n;Be++){const Te=o(Be),bt=Ce+(P?0:Te/2);if(te.y>=Ce+Te)Ce+=Te,oe++,Le++;else if(te.y>bt)Ce+=Te,P?U+=bt-te.y:oe++,Le++;else if(te.y+te.height>Te/2+Ce)Ce+=Te,Le++;else break}}oe=Math.max(0,Math.min(oe,n-1)),Le=Math.max(oe,Math.min(Le,n));const Je={x:he,y:oe,width:ne-he,height:Le-oe},ae=N.current;(ae===void 0||ae.y!==Je.y||ae.x!==Je.x||ae.height!==Je.height||ae.width!==Je.width||L.current!==ve||E.current!==U||te.width!==((Qe=H.current)==null?void 0:Qe[0])||te.height!==((ct=H.current)==null?void 0:ct[1]))&&(g==null||g({x:he,y:oe,width:ne-he,height:Le-oe},te.width,te.height,te.paddingRight??0,ve,U),N.current=Je,L.current=ve,E.current=U,H.current=[te.width,te.height])},[t,o,n,g,l,W,P]),we=s.useCallback(te=>{fe.current=te,ue()},[ue]);return s.useEffect(()=>{ue()},[ue]),s.createElement(Qc,{scrollRef:b,className:w,kineticScrollPerfHack:a==null?void 0:a.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:T===!0||typeof T=="string",scrollWidth:re+(z??0),scrollHeight:K+(X??0),clientHeight:$,rightElement:y,paddingBottom:X,paddingRight:z,rightElementProps:x,update:we,initialSize:M},s.createElement(_c,{eventTargetRef:b,width:R,height:$,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},td=en("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),nd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),od=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),rd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),id=10,ld=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:c,searchResults:l,onSearchValueChange:a,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:w=!1,onSearchClose:g}=e,[b]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,y]=s.useState(""),x=c??h,k=s.useCallback(_=>{y(_),a==null||a(_)},[a]),[p,M]=s.useState(),W=s.useRef(p);W.current=p,s.useEffect(()=>{l!==void 0&&(l.length>0?M(_=>({rowsSearched:o,results:l.length,selectedIndex:(_==null?void 0:_.selectedIndex)??-1})):M(void 0))},[o,l]);const P=s.useRef();P.current===void 0&&(P.current=new AbortController);const T=s.useRef(),[z,X]=s.useState([]),R=l??z,$=s.useCallback(()=>{T.current!==void 0&&(window.cancelAnimationFrame(T.current),T.current=void 0),P.current!==void 0&&P.current.abort(),P.current=new AbortController},[]),N=s.useRef(n);N.current=n;const L=s.useCallback(_=>{const ve=new RegExp(_.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ne=N.current,he=Math.min(10,o),Ge=0;M(void 0),X([]);const U=[],oe=async()=>{var gt;if(f===void 0)return;const Le=performance.now(),Je=o-Ge;let ae=f({x:0,y:ne,width:r.length,height:Math.min(he,Je,o-ne)},P.current.signal);typeof ae=="function"&&(ae=await ae());let Qe=!1;for(const[mt,V]of ae.entries())for(const[ge,ke]of V.entries()){let He;switch(ke.kind){case ee.Text:case ee.Number:He=ke.displayData;break;case ee.Uri:case ee.Markdown:He=ke.data;break;case ee.Boolean:He=typeof ke.data=="boolean"?ke.data.toString():void 0;break;case ee.Image:case ee.Bubble:He=ke.data.join("🐳");break;case ee.Custom:He=ke.copyData;break}He!==void 0&&ve.test(He)&&(U.push([ge,mt+ne]),Qe=!0)}const ct=performance.now();Qe&&X([...U]),Ge+=ae.length,Jt(Ge<=o);const Ce=((gt=W.current)==null?void 0:gt.selectedIndex)??-1;M({results:U.length,rowsSearched:Ge,selectedIndex:Ce}),u==null||u(U,Ce),ne+he>=o?ne=0:ne+=he;const Be=ct-Le,Te=Math.max(Be,1),bt=id/Te;he=Math.ceil(he*bt),Ge<o&&U.length<1e3&&(T.current=window.requestAnimationFrame(oe))};$(),T.current=window.requestAnimationFrame(oe)},[$,r.length,f,u,o]),E=s.useCallback(()=>{var _;g==null||g(),M(void 0),X([]),u==null||u([],-1),$(),(_=t==null?void 0:t.current)==null||_.focus()},[$,t,g,u]),H=s.useCallback(_=>{k(_.target.value),l===void 0&&(_.target.value===""?(M(void 0),X([]),$()):L(_.target.value))},[L,$,k,l]);s.useEffect(()=>{i.current!==null&&(k(""),M(void 0),z.length>0&&(X([]),u==null||u([],-1)),w?i.current.focus({preventScroll:!0}):$())},[w,i]);const re=s.useCallback(_=>{var ne;if((ne=_==null?void 0:_.stopPropagation)==null||ne.call(_),p===void 0||p.results===0)return;const ve=(p.selectedIndex+1)%p.results;M({...p,selectedIndex:ve}),u==null||u(R,ve)},[p,u,R]),K=s.useCallback(_=>{var ne;if((ne=_==null?void 0:_.stopPropagation)==null||ne.call(_),p===void 0||p.results===0)return;let ve=(p.selectedIndex-1)%p.results;ve<0&&(ve+=p.results),M({...p,selectedIndex:ve}),u==null||u(R,ve)},[u,R,p]),fe=s.useCallback(_=>{(_.ctrlKey||_.metaKey)&&_.nativeEvent.code==="KeyF"||_.key==="Escape"?(E(),_.stopPropagation(),_.preventDefault()):_.key==="Enter"&&(_.shiftKey?K():re())},[E,re,K]);s.useEffect(()=>()=>{$()},[$]);const[ue,we]=s.useState(!1);s.useEffect(()=>{if(w)we(!0);else{const _=setTimeout(()=>we(!1),150);return()=>clearTimeout(_)}},[w]);const te=s.useMemo(()=>{if(!w&&!ue)return null;let _;p!==void 0&&(_=p.results>=1e3?"over 1000":`${p.results} result${p.results!==1?"s":""}`,p.selectedIndex>=0&&(_=`${p.selectedIndex+1} of ${_}`));const ve=Ge=>{Ge.stopPropagation()},he={width:`${o>0?Math.floor(((p==null?void 0:p.rowsSearched)??0)/o*100):0}%`};return s.createElement(td,{className:"gdg-search-bar"+(w?"":" out"),onMouseDown:ve,onMouseMove:ve,onMouseUp:ve,onClick:ve},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:b,"aria-hidden":!w,"data-testid":"search-input",ref:i,onChange:H,value:x,tabIndex:w?void 0:-1,onKeyDownCapture:fe}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:K,disabled:((p==null?void 0:p.results)??0)===0},nd),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:re,disabled:((p==null?void 0:p.results)??0)===0},od),g!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!w,"data-testid":"search-close-button",tabIndex:w?void 0:-1,onClick:E},rd)),p!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},_)),s.createElement("div",{className:"gdg-search-progress",style:he})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:b},"Type to search")))},[w,ue,p,o,b,i,H,x,fe,K,re,g,E]);return s.createElement(s.Fragment,null,s.createElement(ed,{prelightCells:R,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),te)};class sd extends s.PureComponent{constructor(){super(...arguments);Ne(this,"wrapperRef",s.createRef());Ne(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const ad=()=>e=>Math.max(16,e.targetHeight-10),cd=en("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[ad(),"px"]}}),dd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[c,l]=St.useState(n);return St.createElement(sd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},St.createElement(cd,{targetHeight:t.height,"data-testid":"group-rename-input",value:c,onBlur:o,onFocus:a=>a.target.setSelectionRange(0,c.length),onChange:a=>l(a.target.value),onKeyDown:a=>{a.key==="Enter"?i(c):a.key==="Escape"&&o()},autoFocus:!0}))};function ud(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Xe(e,t,n){const o=us(e,t);return o&&(n.didMatch=!0),o}function us(e,t){if(e.length===0)return!1;if(e.includes("|")){const a=e.split("|");for(const f of a)if(us(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const c=e.split("+"),l=c.pop();if(!ud(l,t))return!1;if(c[0]==="any")return!0;for(const a of c)switch(a){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Yr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function fd(e,t,n,o,r,i,c){const l=St.useCallback((u,w,g,b)=>{var M;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!c&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(g||b==="drag")||n==="additive",y=(o==="mixed"||o==="additive")&&h,x=(r==="mixed"||r==="additive")&&h;let k={current:u===void 0?void 0:{...u,rangeStack:b==="drag"?((M=e.current)==null?void 0:M.rangeStack)??[]:[]},columns:y?e.columns:rt.empty(),rows:x?e.rows:rt.empty()};g&&(i==="multi-rect"||i==="multi-cell")&&k.current!==void 0&&e.current!==void 0&&(k={...k,current:{...k.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(k,w)},[o,e,n,i,c,r,t]),a=St.useCallback((u,w,g)=>{u=u??e.rows,w!==void 0&&(u=u.add(w));let b;if(r==="exclusive"&&u.length>0)b={current:void 0,columns:rt.empty(),rows:u};else{const h=g&&n==="mixed"||n==="additive",y=g&&o==="mixed"||o==="additive";b={current:h?e.current:void 0,columns:y?e.columns:rt.empty(),rows:u}}t(b,!1)},[o,e,n,r,t]),f=St.useCallback((u,w,g)=>{u=u??e.columns,w!==void 0&&(u=u.add(w));let b;if(o==="exclusive"&&u.length>0)b={current:void 0,rows:rt.empty(),columns:u};else{const h=g&&n==="mixed"||n==="additive",y=g&&r==="mixed"||r==="additive";b={current:h?e.current:void 0,rows:y?e.rows:rt.empty(),columns:u}}t(b,!1)},[o,e,n,r,t]);return[l,a,f]}function hd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let w=f.y;w<f.y+f.height;w++){const g=[];for(let b=f.x;b<f.x+f.width;b++)b<0||w>=r?g.push({kind:ee.Loading,allowOverlay:!1}):g.push(t([b,w]));u.push(g)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),c=e!==void 0?i:void 0,l=s.useCallback(f=>{if(c===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const w=c(u,o.signal);return typeof w=="function"?async()=>(await w()).map(g=>[{kind:ee.Loading,allowOverlay:!1},...g]):w.map(g=>[{kind:ee.Loading,allowOverlay:!1},...g])}return c(u,o.signal)},[o.signal,c,n]);return[e!==void 0?l:void 0,c]}function gd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case ee.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Ai?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case ee.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case ee.Image:case ee.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case ee.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case ee.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case ee.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case ee.Markdown:case ee.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case ee.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case ee.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case ee.Protected:return{formatted:"************",rawValue:"",format:"string"};default:lr()}}function md(e,t){return e.map((o,r)=>{const i=t[r];return o.map(c=>c.span!==void 0&&c.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:gd(c))})}function kl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function wd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(c=>kl(c,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:kl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function xi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Sl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function bd(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function yd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${xi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((c,l)=>`<li gdg-raw-value=${Sl(r.rawValue[l])}>`+xi(c)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Sl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${xi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function pd(e,t){const n=md(e,t),o=wd(n),r=yd(n);return{textPlain:o,textHtml:r}}function Ml(e){var c;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const a=l.cloneNode(!0),u=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,w=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",g=a.querySelectorAll("br");for(const y of g)y.replaceWith(`
`);const b=a.getAttribute("gdg-raw-value"),h=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)i==null||i.push({rawValue:((c=a.querySelector("a"))==null?void 0:c.getAttribute("href"))??"",formatted:a.textContent??"",format:h});else if(a.querySelector("ol")!==null){const y=a.querySelectorAll("li");i==null||i.push({rawValue:[...y].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...y].map(x=>x.textContent??""),format:"string-array"})}else if(b!==null)i==null||i.push({rawValue:bd(b),formatted:a.textContent??"",format:h});else{let y=a.textContent??"";w&&(y=y.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:y??"",formatted:y??"",format:h})}}}return i!==void 0&&r.push(i),r}function vd(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let c=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(l=e.current)==null?void 0:l.range,f=[];if(a.width>2){const g=t({x:a.x,y:a.y,width:1,height:a.height},r.signal);if(typeof g=="function")return i;f.push(...g);const b=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},r.signal);if(typeof b=="function")return i;f.push(...b)}else{const g=t({x:a.x,y:a.y,width:a.width,height:a.height},r.signal);if(typeof g=="function")return i;f.push(...g)}let u=a.x-n,w=a.x+a.width-1-n;for(const g of f)for(const b of g)b.span!==void 0&&(u=Math.min(b.span[0],u),w=Math.max(b.span[1],w));u===a.x-n&&w===a.x+a.width-1-n?c=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:a.y,width:w-u+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!c);return e}function Rl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Cd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let c=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,c)),r=c+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Rl(e.slice(r,c))),r=c+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}c++}return r<e.length&&o.push(Rl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(a=>({rawValue:a,formatted:a,format:"string"})))}function El(e,t,n){var l;const o=pd(e,t),r=a=>{var f;(f=window.navigator.clipboard)==null||f.writeText(a)},i=(a,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},c=(a,f)=>{var u,w;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",a),(w=n==null?void 0:n.clipboardData)==null||w.setData("text/html",f)}catch{i(a,f)||r(a)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?c(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function fs(e){return e!==!0}function Il(e){return typeof e=="string"?e:`${e}px`}const xd=()=>e=>e.innerWidth,kd=()=>e=>e.innerHeight,Sd=en("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[xd()],"wmyidgi-1":[kd()]}}),Md=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(Sd,{innerHeight:Il(n),innerWidth:Il(t),...r},o)},Rd=2,Ed=1300;function Id(e,t,n){const o=St.useRef(0),[r,i]=e??[0,0];St.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let c=!1,l=0;const a=f=>{var u;if(!c){if(l===0)l=f;else{const w=f-l;o.current=Math.min(1,o.current+w/Ed);const g=o.current**1.618*w*Rd;(u=t.current)==null||u.scrollBy(r*g,i*g),l=f,n==null||n()}window.requestAnimationFrame(a)}};return window.requestAnimationFrame(a),()=>{c=!0}},[t,r,i,n])}function Dd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:c,remSize:l}){const[a,f,u,w,g,b]=St.useMemo(()=>{if(!c||l===16)return[e,t,n,o,r,i];const h=l/16,y=e,x=Zl();return[typeof y=="number"?y*h:k=>Math.ceil(y(k)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,l,e,c,o]);return{rowHeight:a,headerHeight:f,groupHeaderHeight:u,theme:w,overscrollX:g,overscrollY:b}}const jn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Ye(e,t){return e===!0?t:e===!1?"":e}function Dl(e){const t=Yr.value;return{activateCell:Ye(e.activateCell," |Enter|shift+Enter"),clear:Ye(e.clear,"any+Escape"),closeOverlay:Ye(e.closeOverlay,"any+Escape"),acceptOverlayDown:Ye(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Ye(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Ye(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Ye(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Ye(e.delete,t?"Backspace|Delete":"Delete"),downFill:Ye(e.downFill,"primary+_68"),scrollToSelectedCell:Ye(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Ye(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Ye(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Ye(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Ye(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Ye(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Ye(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Ye(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Ye(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Ye(e.goToFirstCell,"primary+Home"),goToFirstColumn:Ye(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Ye(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Ye(e.goToLastCell,"primary+End"),goToLastColumn:Ye(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Ye(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Ye(e.goToNextPage,"PageDown"),goToPreviousPage:Ye(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Ye(e.rightFill,"primary+_82"),search:Ye(e.search,"primary+f"),selectAll:Ye(e.selectAll,"primary+a"),selectColumn:Ye(e.selectColumn,"ctrl+ "),selectGrowDown:Ye(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Ye(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Ye(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Ye(e.selectGrowUp,"shift+ArrowUp"),selectRow:Ye(e.selectRow,"shift+ "),selectToFirstCell:Ye(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Ye(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Ye(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Ye(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Ye(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Ye(e.selectToLastRow,"primary+shift+ArrowDown")}}function Fd(e){const t=ga(e);return St.useMemo(()=>{if(t===void 0)return Dl(jn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??jn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??jn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??jn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??jn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??jn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??jn.selectToLastCell};return Dl({...jn,...n})},[t])}function Hd(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const c={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(c.subGroups=o.subGroups.map((l,a)=>t(l,r+1,[...i,a])).sort((l,a)=>l.headerIndex-a.headerIndex)),c}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Ni(e,t){const n=[];function o(l,a,f=!1){let u=a!==null?a-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let w=0;w<l.subGroups.length;w++){const g=w<l.subGroups.length-1?l.subGroups[w+1].headerIndex:a;o(l.subGroups[w],g,f||l.isCollapsed)}}const r=Hd(e.groups);for(let l=0;l<r.length;l++){const a=l<r.length-1?r[l+1].headerIndex:null;o(r[l],a)}let i=0,c=0;for(const l of n)l.contentIndex=c,c+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:a,...f}=l;return f})}function Ti(e,t){if(t===void 0||Ni.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Td(e,t,n,o){const r=St.useMemo(()=>e===void 0?void 0:Ni(e,t),[e,t]),i=St.useMemo(()=>r==null?void 0:r.reduce((u,w)=>(u[w.rowIndex]=w,u),{}),[r]),c=St.useMemo(()=>r===void 0?t:r.reduce((u,w)=>u+(w.isCollapsed?1:w.rows+1),0),[r,t]),l=St.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),a=St.useCallback(u=>{if(r===void 0)return u;let w=u;for(const g of r){if(w===0)return;if(w--,!g.isCollapsed){if(w<g.rows)return g.contentIndex+w;w-=g.rows}}return u},[r]),f=Zn(o??(e==null?void 0:e.themeOverride),St.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:w,contentIndex:g,groupIndex:b}=Ti(u,r);return w?e.themeOverride:o==null?void 0:o(u,b,g)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:a,getRowThemeOverride:f}:{rowHeight:l,rows:c,rowNumberMapper:a,getRowThemeOverride:f}}function Ad(e,t){const n=St.useMemo(()=>e===void 0?void 0:Ni(e,t),[e,t]);return{getRowGroupingForPath:gs,updateRowGroupingByPath:hs,mapper:St.useCallback(o=>{if(typeof o=="number")return Ti(o,n);const r=Ti(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function hs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,c)=>c===o?{...i,...n}:i):e.map((i,c)=>c===o?{...i,subGroups:hs(i.subGroups??[],r,n)}:i)}function gs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:gs(e[n].subGroups??[],o)}function zd(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Pd(e,t,n,o,r){const[i,c]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:c}),[o,c,i]),[a,f,u]=ha(l),w=s.useRef(r);w.current=r;const g=zd(null,y=>{y!==null&&t!==void 0?y.scrollTop=t:y!==null&&e!==void 0&&(y.scrollLeft=e)}),b=(a.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&g.current!==null&&b){if(g.current.scrollTop===t)return;g.current.scrollTop=t,g.current.scrollTop!==t&&u(),w.current()}},[t,b,u,g]);const h=(a.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&g.current!==null&&h){if(g.current.scrollLeft===e)return;g.current.scrollLeft=e,g.current.scrollLeft!==e&&u(),w.current()}},[e,h,u,g]),{visibleRegion:a,setVisibleRegion:f,scrollRef:g}}const Ld=s.lazy(async()=>await Al(()=>import("./data-grid-overlay-editor-BB7FxlLN.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let Bd=0;function Wd(e){return na(il(il(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return co((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Pr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Lr={kind:ee.Loading,allowOverlay:!1},ki={columns:rt.empty(),rows:rt.empty(),current:void 0},$d=(e,t)=>{var nl,ol,rl;const[n,o]=s.useState(ki),[r,i]=s.useState(),c=s.useRef(null),l=s.useRef(null),[a,f]=s.useState(),u=s.useRef(void 0),w=typeof window>"u"?null:window,{imageEditorOverride:g,getRowThemeOverride:b,markdownDivCreateNode:h,width:y,height:x,columns:k,rows:p,getCellContent:M,onCellClicked:W,onCellActivated:P,onFillPattern:T,onFinishedEditing:z,coercePasteValue:X,drawHeader:R,drawCell:$,editorBloom:N,onHeaderClicked:L,onColumnProposeMove:E,rangeSelectionColumnSpanning:H=!0,spanRangeBehavior:re="default",onGroupHeaderClicked:K,onCellContextMenu:fe,className:ue,onHeaderContextMenu:we,getCellsForSelection:te,onGroupHeaderContextMenu:_,onGroupHeaderRenamed:ve,onCellEdited:ne,onCellsEdited:he,onSearchResultsChanged:Ge,searchResults:U,onSearchValueChange:oe,searchValue:Le,onKeyDown:Je,onKeyUp:ae,keybindings:Qe,editOnType:ct=!0,onRowAppended:Ce,onColumnAppended:Be,onColumnMoved:Te,validateCell:bt,highlightRegions:gt,rangeSelect:mt="rect",columnSelect:V="multi",rowSelect:ge="multi",rangeSelectionBlending:ke="exclusive",columnSelectionBlending:He="exclusive",rowSelectionBlending:Se="exclusive",onDelete:lt,onDragStart:tt,onMouseMove:dt,onPaste:q,copyHeaders:le=!1,freezeColumns:_e=0,cellActivationBehavior:Ke="second-click",rowSelectionMode:Et="auto",columnSelectionMode:It="auto",onHeaderMenuClick:Ee,onHeaderIndicatorClick:Me,getGroupDetails:ut,rowGrouping:xt,onSearchClose:Mt,onItemHovered:zt,onSelectionCleared:Ht,showSearch:sn,onVisibleRegionChanged:tn,gridSelection:Dt,onGridSelectionChange:Lt,minColumnWidth:Bt=50,maxColumnWidth:wn=500,maxColumnAutoWidth:yt,provideEditor:ft,trailingRowOptions:Ve,freezeTrailingRows:Tt=0,allowedFillDirections:Vt="orthogonal",scrollOffsetX:bn,scrollOffsetY:In,verticalBorder:Xt,onDragOverCell:an,onDrop:Ie,onColumnResize:it,onColumnResizeEnd:nt,onColumnResizeStart:je,customRenderers:Pt,fillHandle:qe,experimental:Ze,fixedShadowX:Dn,fixedShadowY:dr,headerIcons:$n,imageWindowLoader:Fn,initialSize:Hn,isDraggable:go,onDragLeave:ur,onRowMoved:On,overscrollX:mo,overscrollY:wo,preventDiagonalScrolling:bo,rightElement:yo,rightElementProps:eo,trapFocus:Tn=!1,smoothScrollX:Kr,smoothScrollY:fr,scaleToRem:Vr=!1,rowHeight:qr=34,headerHeight:yn=36,groupHeaderHeight:Nn=yn,theme:jr,isOutsideClick:Zr,renderers:po,resizeIndicator:hr,scrollToActiveCell:to=!0,drawFocusRing:Jr=!0,portalElementRef:gr,isActivationOnEnter:Yo}=e,Go=Jr==="no-editor"?r===void 0:Jr,wt=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Wt=(wt==null?void 0:wt.kind)??e.rowMarkers??"none",Xn=(wt==null?void 0:wt.width)??e.rowMarkerWidth,vo=(wt==null?void 0:wt.startIndex)??e.rowMarkerStartIndex??1,Yn=(wt==null?void 0:wt.theme)??e.rowMarkerTheme,Co=wt==null?void 0:wt.headerTheme,mr=wt==null?void 0:wt.headerAlwaysVisible,no=ge!=="multi"||(wt==null?void 0:wt.headerDisabled)===!0,xo=(wt==null?void 0:wt.checkboxStyle)??"square",Gn=Math.max(Bt,20),ko=Math.max(wn,Gn),wr=Math.max(yt??ko,Gn),_o=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:xe,rowNumberMapper:Uo,rowHeight:Qr,getRowThemeOverride:cn}=Td(xt,p,qr,b),ei=s.useMemo(()=>Number.parseFloat(_o.fontSize),[_o]),{rowHeight:pn,headerHeight:Ko,groupHeaderHeight:So,theme:br,overscrollX:ti,overscrollY:ni}=Dd({groupHeaderHeight:Nn,headerHeight:yn,overscrollX:mo,overscrollY:wo,remSize:ei,rowHeight:Qr,scaleToRem:Vr,theme:jr}),vn=Fd(Qe),An=Xn??(p>1e4?48:p>1e3?44:p>100?36:32),Yt=Wt!=="none",I=Yt?1:0,vt=Ve!==void 0,oo=(Ve==null?void 0:Ve.sticky)===!0,[Mo,yr]=s.useState(!1),Ro=sn??Mo,oi=s.useCallback(()=>{Mt!==void 0?Mt():yr(!1)},[Mt]),m=s.useMemo(()=>Dt===void 0?void 0:Pr(Dt,I),[Dt,I])??n,Y=s.useRef(new AbortController);s.useEffect(()=>()=>Y==null?void 0:Y.current.abort(),[]);const[J,ce]=hd(te,M,I,Y.current,xe),Q=s.useCallback((d,v,C)=>{if(bt===void 0)return!0;const S=[d[0]-I,d[1]];return bt==null?void 0:bt(S,v,C)},[I,bt]),ie=s.useRef(Dt),be=s.useCallback((d,v)=>{v&&(d=vd(d,J,I,re,Y.current)),Lt!==void 0?(ie.current=Pr(d,-I),Lt(ie.current)):o(d)},[Lt,J,I,re]),ze=Zn(it,s.useCallback((d,v,C,S)=>{it==null||it(k[C-I],v,C-I,S)},[it,I,k])),me=Zn(nt,s.useCallback((d,v,C,S)=>{nt==null||nt(k[C-I],v,C-I,S)},[nt,I,k])),At=Zn(je,s.useCallback((d,v,C,S)=>{je==null||je(k[C-I],v,C-I,S)},[je,I,k])),ye=Zn(R,s.useCallback((d,v)=>(R==null?void 0:R({...d,columnIndex:d.columnIndex-I},v))??!1,[R,I])),st=Zn($,s.useCallback((d,v)=>($==null?void 0:$({...d,col:d.col-I},v))??!1,[$,I])),ot=s.useCallback(d=>{if(lt!==void 0){const v=lt(Pr(d,-I));return typeof v=="boolean"?v:Pr(v,I)}return!0},[lt,I]),[Ae,$e,Ue]=fd(m,be,ke,He,Se,mt,H),et=s.useMemo(()=>Bn(Zl(),br),[br]),[qt,Cn]=s.useState([0,0,0]),jt=s.useMemo(()=>{if(po===void 0)return{};const d={};for(const v of po)d[v.kind]=v;return d},[po]),kt=s.useCallback(d=>d.kind!==ee.Custom?jt[d.kind]:Pt==null?void 0:Pt.find(v=>v.isMatch(d)),[Pt,jt]);let{sizedColumns:Oe,nonGrowWidth:dn}=$a(k,xe,ce,qt[0]-(I===0?0:An)-qt[2],Gn,wr,et,kt,Y.current);Wt!=="none"&&(dn+=An);const _t=s.useMemo(()=>Oe.some(d=>d.group!==void 0),[Oe]),zn=_t?Ko+So:Ko,Pn=m.rows.length,_n=Wt==="none"?void 0:Pn===0?!1:Pn===xe?!0:void 0,We=s.useMemo(()=>Wt==="none"?Oe:[{title:"",width:An,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Yn,rowMarker:xo,rowMarkerChecked:_n,headerRowMarkerTheme:Co,headerRowMarkerAlwaysVisible:mr,headerRowMarkerDisabled:no},...Oe],[Wt,Oe,An,Yn,xo,_n,Co,mr,no]),$t=s.useRef({height:1,width:1,x:0,y:0}),xn=s.useRef(!1),{setVisibleRegion:pr,visibleRegion:Ln,scrollRef:at}=Pd(bn,In,pn,$t,()=>xn.current=!0);$t.current=Ln;const bs=Ln.x+I,vr=Ln.y,Ft=s.useRef(null),Ot=s.useCallback(d=>{var v;d===!0?(v=Ft.current)==null||v.focus():window.requestAnimationFrame(()=>{var C;(C=Ft.current)==null||C.focus()})},[]),Nt=vt?xe+1:xe,nn=s.useCallback(d=>{const v=I===0?d:d.map(S=>({...S,location:[S.location[0]-I,S.location[1]]})),C=he==null?void 0:he(v);if(C!==!0)for(const S of v)ne==null||ne(S.location,S.value);return C},[ne,he,I]),[ro,ri]=s.useState(),Cr=m.current!==void 0&&m.current.range.width*m.current.range.height>1?m.current.range:void 0,Eo=Go?(nl=m.current)==null?void 0:nl.cell:void 0,xr=Eo==null?void 0:Eo[0],kr=Eo==null?void 0:Eo[1],ys=s.useMemo(()=>{if((gt===void 0||gt.length===0)&&(Cr??xr??kr??ro)===void 0)return;const d=[];if(gt!==void 0)for(const v of gt){const C=We.length-v.range.x-I;C>0&&d.push({color:v.color,range:{...v.range,x:v.range.x+I,width:Math.min(C,v.range.width)},style:v.style})}return ro!==void 0&&d.push({color:fo(et.accentColor,0),range:ro,style:"dashed"}),Cr!==void 0&&d.push({color:fo(et.accentColor,.5),range:Cr,style:"solid-outline"}),xr!==void 0&&kr!==void 0&&d.push({color:et.accentColor,range:{x:xr,y:kr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[ro,Cr,xr,kr,gt,We.length,et.accentColor,I]),Yi=s.useRef(We);Yi.current=We;const Zt=s.useCallback(([d,v],C=!1)=>{var O,F,D,B,G,Z,se,j;const S=vt&&v===Nt-1;if(d===0&&Yt){if(S)return Lr;const pe=Uo(v);return pe===void 0?Lr:{kind:ln.Marker,allowOverlay:!1,checkboxStyle:xo,checked:(m==null?void 0:m.rows.hasIndex(v))===!0,markerKind:Wt==="clickable-number"?"number":Wt,row:vo+pe,drawHandle:On!==void 0,cursor:Wt==="clickable-number"?"pointer":void 0,disabled:((O=e.disabledRows)==null?void 0:O.call(e,v))===!0}}else if(S){const Re=d===I?(Ve==null?void 0:Ve.hint)??"":"",de=Yi.current[d];if(((F=de==null?void 0:de.trailingRowOptions)==null?void 0:F.disabled)===!0)return Lr;{const De=((D=de==null?void 0:de.trailingRowOptions)==null?void 0:D.hint)??Re,Fe=((B=de==null?void 0:de.trailingRowOptions)==null?void 0:B.addIcon)??(Ve==null?void 0:Ve.addIcon);return{kind:ln.NewRow,hint:De,allowOverlay:!1,icon:Fe}}}else{const pe=d-I;if(C||(Ze==null?void 0:Ze.strict)===!0){const de=$t.current,De=de.x>pe||pe>de.x+de.width||de.y>v||v>de.y+de.height||v>=ai.current,Fe=pe===((Z=(G=de.extras)==null?void 0:G.selected)==null?void 0:Z[0])&&v===((se=de.extras)==null?void 0:se.selected[1]);let Pe=!1;if(((j=de.extras)==null?void 0:j.freezeRegions)!==void 0){for(const Ct of de.extras.freezeRegions)if(uo(Ct,pe,v)){Pe=!0;break}}if(De&&!Fe&&!Pe)return Lr}let Re=M([pe,v]);return I!==0&&Re.span!==void 0&&(Re={...Re,span:[Re.span[0]+I,Re.span[1]+I]}),Re}},[vt,Nt,Yt,Uo,xo,m==null?void 0:m.rows,Wt,vo,On,I,Ve==null?void 0:Ve.hint,Ve==null?void 0:Ve.addIcon,Ze==null?void 0:Ze.strict,M]),ii=s.useCallback(d=>{let v=(ut==null?void 0:ut(d))??{name:d};return ve!==void 0&&d!==""&&(v={icon:v.icon,name:v.name,overrideTheme:v.overrideTheme,actions:[...v.actions??[],{title:"Rename",icon:"renameIcon",onClick:C=>di({group:v.name,bounds:C.bounds})}]}),v},[ut,ve]),Io=s.useCallback(d=>{var D;const[v,C]=d.cell,S=We[v],A=(S==null?void 0:S.group)!==void 0?(D=ii(S.group))==null?void 0:D.overrideTheme:void 0,O=S==null?void 0:S.themeOverride,F=cn==null?void 0:cn(C);i({...d,theme:Bn(et,A,O,F,d.content.themeOverride)})},[cn,We,ii,et]),Do=s.useCallback((d,v,C)=>{var F;if(m.current===void 0)return;const[S,A]=m.current.cell,O=Zt([S,A]);if(O.kind!==ee.Boolean&&O.allowOverlay){let D=O;if(C!==void 0)switch(D.kind){case ee.Number:{const B=ra(()=>C==="-"?-0:Number.parseFloat(C),0);D={...D,data:Number.isNaN(B)?0:B};break}case ee.Text:case ee.Markdown:case ee.Uri:D={...D,data:C};break}Io({target:d,content:D,initialValue:C,cell:[S,A],highlight:C===void 0,forceEditMode:C!==void 0,activation:v})}else O.kind===ee.Boolean&&v.inputType==="keyboard"&&O.readonly!==!0&&(nn([{location:m.current.cell,value:{...O,data:fs(O.data)}}]),(F=Ft.current)==null||F.damage([{cell:m.current.cell}]))},[Zt,m,nn,Io]),Gi=s.useCallback((d,v)=>{var A;const C=(A=Ft.current)==null?void 0:A.getBounds(d,v);if(C===void 0||at.current===null)return;const S=Zt([d,v]);S.allowOverlay&&Io({target:C,content:S,initialValue:void 0,highlight:!0,cell:[d,v],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Zt,at,Io]),Rt=s.useCallback((d,v,C="both",S=0,A=0,O=void 0)=>{if(at.current!==null){const F=Ft.current,D=l.current,B=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,G=typeof v!="number"?v.unit==="cell"?v.amount:void 0:v,Z=typeof d!="number"&&d.unit==="px"?d.amount:void 0,se=typeof v!="number"&&v.unit==="px"?v.amount:void 0;if(F!==null&&D!==null){let j={x:0,y:0,width:0,height:0},pe=0,Re=0;if((B!==void 0||G!==void 0)&&(j=F.getBounds((B??0)+I,G??0)??j,j.width===0||j.height===0))return;const de=D.getBoundingClientRect(),De=de.width/D.offsetWidth;if(Z!==void 0&&(j={...j,x:Z-de.left-at.current.scrollLeft,width:1}),se!==void 0&&(j={...j,y:se+de.top-at.current.scrollTop,height:1}),j!==void 0){const Fe={x:j.x-S,y:j.y-A,width:j.width+2*S,height:j.height+2*A};let Pe=0;for(let bi=0;bi<_e;bi++)Pe+=Oe[bi].width;let Ct=0;const ht=Tt+(oo?1:0);ht>0&&(Ct=ho(Nt,ht,pn));let Ut=Pe*De+de.left+I*An*De,Sn=de.right,hn=de.top+zn*De,Mn=de.bottom-Ct*De;const Fr=j.width+S*2;switch(O==null?void 0:O.hAlign){case"start":Sn=Ut+Fr;break;case"end":Ut=Sn-Fr;break;case"center":Ut=Math.floor((Ut+Sn)/2)-Fr/2,Sn=Ut+Fr;break}const Hr=j.height+A*2;switch(O==null?void 0:O.vAlign){case"start":Mn=hn+Hr;break;case"end":hn=Mn-Hr;break;case"center":hn=Math.floor((hn+Mn)/2)-Hr/2,Mn=hn+Hr;break}Ut>Fe.x?pe=Fe.x-Ut:Sn<Fe.x+Fe.width&&(pe=Fe.x+Fe.width-Sn),hn>Fe.y?Re=Fe.y-hn:Mn<Fe.y+Fe.height&&(Re=Fe.y+Fe.height-Mn),C==="vertical"||typeof d=="number"&&d<_e?pe=0:(C==="horizontal"||typeof v=="number"&&v>=Nt-ht)&&(Re=0),(pe!==0||Re!==0)&&(De!==1&&(pe/=De,Re/=De),at.current.scrollTo({left:pe+at.current.scrollLeft,top:Re+at.current.scrollTop,behavior:(O==null?void 0:O.behavior)??"auto"}))}}}},[I,Tt,An,at,zn,_e,Oe,Nt,oo,pn]),li=s.useRef(Gi),si=s.useRef(M);li.current=Gi,si.current=M;const ai=s.useRef(xe);ai.current=xe;const _i=s.useRef(We.length);_i.current=We.length;const Un=s.useCallback(async(d,v=!0,C)=>{var G;const S=We[d];if(((G=S==null?void 0:S.trailingRowOptions)==null?void 0:G.disabled)===!0)return;const A=Ce==null?void 0:Ce();let O,F=!0;A!==void 0&&(O=await A,O==="top"&&(F=!1),typeof O=="number"&&(F=!1));let D=0;const B=()=>{if(ai.current<=xe){D<500&&window.setTimeout(B,D),D=50+D*2;return}const Z=typeof O=="number"?O:F?xe:0;Dr.current(d-I,Z,"both",0,0,C?{behavior:C}:void 0),Ae({cell:[d,Z],range:{x:d,y:Z,width:1,height:1}},!1,!1,"edit");const se=si.current([d-I,Z]);se.allowOverlay&&Po(se)&&se.readonly!==!0&&v&&window.setTimeout(()=>{li.current(d,Z)},0)};B()},[We,Ce,I,xe,Ae]),Sr=s.useCallback(async(d,v=!0)=>{const C=Be==null?void 0:Be();let S,A=!0;C!==void 0&&(S=await C,S==="left"&&(A=!1),typeof S=="number"&&(A=!1));let O=0;const F=()=>{if(_i.current<=We.length){O<500&&window.setTimeout(F,O),O=50+O*2;return}const D=typeof S=="number"?S:A?We.length:0;Rt(D-I,d),Ae({cell:[D,d],range:{x:D,y:d,width:1,height:1}},!1,!1,"edit");const B=si.current([D-I,d]);B.allowOverlay&&Po(B)&&B.readonly!==!0&&v&&window.setTimeout(()=>{li.current(D,d)},0)};F()},[We,Be,I,Rt,Ae]),Fo=s.useCallback(d=>{var C,S;const v=((S=(C=Oe[d])==null?void 0:C.trailingRowOptions)==null?void 0:S.targetColumn)??(Ve==null?void 0:Ve.targetColumn);if(typeof v=="number")return v+(Yt?1:0);if(typeof v=="object"){const A=k.indexOf(v);if(A>=0)return A+(Yt?1:0)}},[Oe,k,Yt,Ve==null?void 0:Ve.targetColumn]),Kn=s.useRef(void 0),Ho=s.useRef(void 0),Vo=s.useCallback((d,v)=>{var A;const[C,S]=v;return Bn(et,(A=We[C])==null?void 0:A.themeOverride,cn==null?void 0:cn(S),d.themeOverride)},[cn,We,et]),{mapper:io}=Ad(xt,p),un=xt==null?void 0:xt.navigationBehavior,qo=s.useCallback(d=>{var G,Z,se;const v=Yr.value?d.metaKey:d.ctrlKey,C=v&&ge==="multi",[S,A]=d.location,O=m.columns,F=m.rows,[D,B]=((G=m.current)==null?void 0:G.cell)??[];if(d.kind==="cell"){if(Ho.current=void 0,lo.current=[S,A],S===0&&Yt){if(vt===!0&&A===xe||Wt==="number"||ge==="none")return;const j=Zt(d.location);if(j.kind!==ln.Marker||j.disabled===!0)return;if(On!==void 0){const de=kt(j);Jt((de==null?void 0:de.kind)===ln.Marker);const De=(Z=de==null?void 0:de.onClick)==null?void 0:Z.call(de,{...d,cell:j,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Vo(j,d.location),preventDefault:()=>{}});if(De===void 0||De.checked===j.checked)return}i(void 0),Ot();const pe=F.hasIndex(A),Re=Kn.current;if(ge==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&Re!==void 0&&F.hasIndex(Re)){const de=[Math.min(Re,A),Math.max(Re,A)+1];C||Et==="multi"?$e(void 0,de,!0):$e(rt.fromSingleSelection(de),void 0,C)}else ge==="multi"&&(C||d.isTouch||Et==="multi")?pe?$e(F.remove(A),void 0,!0):($e(void 0,A,!0),Kn.current=A):pe&&F.length===1?$e(rt.empty(),void 0,v):($e(rt.fromSingleSelection(A),void 0,v),Kn.current=A)}else if(S>=I&&vt&&A===xe){const j=Fo(S);Un(j??S)}else if(D!==S||B!==A){const j=Zt(d.location),pe=kt(j);if((pe==null?void 0:pe.onSelect)!==void 0){let De=!1;if(pe.onSelect({...d,cell:j,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>De=!0,theme:Vo(j,d.location)}),De)return}if(un==="block"&&io(A).isGroupHeader)return;const Re=oo&&A===xe,de=oo&&m!==void 0&&((se=m.current)==null?void 0:se.cell[1])===xe;if((d.shiftKey||d.isLongTouch===!0)&&D!==void 0&&B!==void 0&&m.current!==void 0&&!de){if(Re)return;const De=Math.min(S,D),Fe=Math.max(S,D),Pe=Math.min(A,B),Ct=Math.max(A,B);Ae({...m.current,range:{x:De,y:Pe,width:Fe-De+1,height:Ct-Pe+1}},!0,v,"click"),Kn.current=void 0,Ot()}else Ae({cell:[S,A],range:{x:S,y:A,width:1,height:1}},!0,v,"click"),Kn.current=void 0,i(void 0),Ot()}}else if(d.kind==="header")if(lo.current=[S,A],i(void 0),Yt&&S===0)Kn.current=void 0,Ho.current=void 0,!no&&ge==="multi"&&(F.length!==xe?$e(rt.fromSingleSelection([0,xe]),void 0,v):$e(rt.empty(),void 0,v),Ot());else{const j=Ho.current;if(V==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&j!==void 0&&O.hasIndex(j)){const pe=[Math.min(j,S),Math.max(j,S)+1];v||d.isTouch||It==="multi"?Ue(void 0,pe,v):Ue(rt.fromSingleSelection(pe),void 0,v)}else V==="multi"&&(v||d.isTouch||It==="multi")?(O.hasIndex(S)?Ue(O.remove(S),void 0,v):Ue(void 0,S,v),Ho.current=S):V!=="none"&&(O.hasIndex(S)?Ue(O.remove(S),void 0,v):Ue(rt.fromSingleSelection(S),void 0,v),Ho.current=S);Kn.current=void 0,Ot()}else d.kind===gn?lo.current=[S,A]:d.kind===Gr&&!d.isMaybeScrollbar&&(be(ki,!1),i(void 0),Ot(),Ht==null||Ht(),Kn.current=void 0,Ho.current=void 0)},[ge,V,m,Yt,I,vt,xe,Wt,Zt,On,Ot,Et,It,kt,Vo,$e,Fo,Un,un,io,oo,Ae,no,Ue,be,Ht]),jo=s.useRef(!1),lo=s.useRef(void 0),Ui=s.useRef(Ln),on=s.useRef(void 0),ps=s.useCallback(d=>{if(To.current=!1,Ui.current=$t.current,d.button!==0&&d.button!==1){on.current=void 0;return}const v=performance.now();on.current={button:d.button,time:v,location:d.location},(d==null?void 0:d.kind)==="header"&&(jo.current=!0);const C=d.kind==="cell"&&d.isFillHandle;!C&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:m,fillHandle:C}),lo.current=void 0,!d.isTouch&&d.button===0&&!C?qo(d):!d.isTouch&&d.button===1&&(lo.current=d.location))},[m,qo]),[ci,di]=s.useState(),Ki=s.useCallback(d=>{if(d.kind!==gn||V!=="multi")return;const v=Yr.value?d.metaKey:d.ctrlKey,[C]=d.location,S=m.columns;if(C<I)return;const A=We[C];let O=C,F=C;for(let D=C-1;D>=I&&sr(A.group,We[D].group);D--)O--;for(let D=C+1;D<We.length&&sr(A.group,We[D].group);D++)F++;if(Ot(),v||d.isTouch||It==="multi")if(S.hasAll([O,F+1])){let D=S;for(let B=O;B<=F;B++)D=D.remove(B);Ue(D,void 0,v)}else Ue(void 0,[O,F+1],v);else Ue(rt.fromSingleSelection([O,F+1]),void 0,v)},[V,Ot,m.columns,We,I,Ue,It]),To=s.useRef(!1),Mr=s.useCallback(async d=>{if(J!==void 0&&ze!==void 0){const v=$t.current.y,C=$t.current.height;let S=J({x:d,y:v,width:1,height:Math.min(C,xe-v)},Y.current.signal);typeof S!="object"&&(S=await S());const A=Oe[d-I],F=document.createElement("canvas").getContext("2d",{alpha:!1});if(F!==null){F.font=et.baseFontFull;const D=Ql(F,et,A,0,S,Gn,ko,!1,kt);ze==null||ze(A,D.width,d,D.width)}}},[Oe,J,ko,et,Gn,ze,I,xe,kt]),[vs,ui]=s.useState(),Ao=s.useCallback(async(d,v)=>{var D,B;const C=(D=d.current)==null?void 0:D.range;if(C===void 0||J===void 0||v.current===void 0)return;const S=v.current.range;if(T!==void 0){let G=!1;if(T({fillDestination:{...S,x:S.x-I},patternSource:{...C,x:C.x-I},preventDefault:()=>G=!0}),G)return}let A=J(C,Y.current.signal);typeof A!="object"&&(A=await A());const O=A,F=[];for(let G=0;G<S.width;G++)for(let Z=0;Z<S.height;Z++){const se=[S.x+G,S.y+Z];if(Nl(se,C))continue;const j=O[Z%C.height][G%C.width];Lo(j)||!Po(j)||F.push({location:se,value:{...j}})}nn(F),(B=Ft.current)==null||B.damage(F.map(G=>({cell:G.location})))},[J,nn,T,I]),Vi=s.useCallback(()=>{if(m.current===void 0||m.current.range.width<=1)return;const d={...m,current:{...m.current,range:{...m.current.range,width:1}}};Ao(d,m)},[Ao,m]),qi=s.useCallback(()=>{if(m.current===void 0||m.current.range.height<=1)return;const d={...m,current:{...m.current,range:{...m.current.range,height:1}}};Ao(d,m)},[Ao,m]),Cs=s.useCallback((d,v)=>{var Z,se;const C=a;if(f(void 0),ri(void 0),ui(void 0),jo.current=!1,v)return;if((C==null?void 0:C.fillHandle)===!0&&m.current!==void 0&&((Z=C.previousSelection)==null?void 0:Z.current)!==void 0){if(ro===void 0)return;const j={...m,current:{...m.current,range:rs(C.previousSelection.current.range,ro)}};Ao(C.previousSelection,j),be(j,!0);return}const[S,A]=d.location,[O,F]=lo.current??[],D=()=>{To.current=!0},B=j=>{var Re,de,De;const pe=j.isTouch||O===S&&F===A;if(pe&&(W==null||W([S-I,A],{...j,preventDefault:D})),j.button===1)return!To.current;if(!To.current){const Fe=Zt(d.location),Pe=kt(Fe);if(Pe!==void 0&&Pe.onClick!==void 0&&pe){const ht=Pe.onClick({...j,cell:Fe,posX:j.localEventX,posY:j.localEventY,bounds:j.bounds,theme:Vo(Fe,d.location),preventDefault:D});ht!==void 0&&!Lo(ht)&&zo(ht)&&(nn([{location:j.location,value:ht}]),(Re=Ft.current)==null||Re.damage([{cell:j.location}]))}if(To.current||m.current===void 0)return!1;let Ct=!1;switch(Fe.activationBehaviorOverride??Ke){case"double-click":case"second-click":{if(((De=(de=C==null?void 0:C.previousSelection)==null?void 0:de.current)==null?void 0:De.cell)===void 0)break;const[ht,Ut]=m.current.cell,[Sn,hn]=C.previousSelection.current.cell;Ct=S===ht&&S===Sn&&A===Ut&&A===hn&&(j.isDoubleClick===!0||Ke==="second-click");break}case"single-click":{Ct=!0;break}}if(Ct){const Ut={inputType:"pointer",pointerActivation:j.isDoubleClick===!0?"double-click":Fe.activationBehaviorOverride??Ke,pointerType:j.isTouch?"touch":"mouse"};return P==null||P([S-I,A],Ut),Do(j.bounds,Ut),!0}}return!1},G=d.location[0]-I;if(d.isTouch){const j=$t.current,pe=Ui.current;if(j.x!==pe.x||j.y!==pe.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&rr((se=m.current)==null?void 0:se.cell,d.location)){fe==null||fe([G,d.location[1]],{...d,preventDefault:D});return}else if(d.kind==="header"&&m.columns.hasIndex(S)){we==null||we(G,{...d,preventDefault:D});return}else if(d.kind===gn){if(G<0)return;_==null||_(G,{...d,preventDefault:D});return}}d.kind==="cell"?B(d)||qo(d):d.kind===gn?K==null||K(G,{...d,preventDefault:D}):(d.kind===Jn&&(L==null||L(G,{...d,preventDefault:D})),qo(d));return}if(d.kind==="header"){if(G<0)return;d.isEdge?d.isDoubleClick===!0&&Mr(S):d.button===0&&S===O&&A===F&&(L==null||L(G,{...d,preventDefault:D}))}if(d.kind===gn){if(G<0)return;d.button===0&&S===O&&A===F&&(K==null||K(G,{...d,preventDefault:D}),To.current||Ki(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&B(d),lo.current=void 0},[a,m,I,ro,Ao,be,W,Zt,kt,Ke,Vo,nn,P,Do,fe,we,_,qo,K,L,Mr,Ki]),xs=s.useCallback(d=>{const v={...d,location:[d.location[0]-I,d.location[1]]};dt==null||dt(v),a!==void 0&&d.buttons===0&&(f(void 0),ri(void 0),ui(void 0),jo.current=!1),ui(C=>{var S;return jo.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(C==null?void 0:C[0])&&d.scrollEdge[1]===C[1]?C:a===void 0||(((S=on.current)==null?void 0:S.location[0])??0)<I?void 0:d.scrollEdge})},[a,dt,I]),ks=s.useCallback((d,v)=>{Ee==null||Ee(d-I,v)},[Ee,I]),Ss=s.useCallback((d,v)=>{Me==null||Me(d-I,v)},[Me,I]);s.useEffect(()=>{if(r===void 0)return;const d=S=>{const A=[];let O=S.parentElement;for(;O&&O!==document.documentElement;){const F=window.getComputedStyle(O),D=F.overflow+F.overflowY+F.overflowX;(D.includes("scroll")||D.includes("auto"))&&A.push(O),O=O.parentElement}return A},v=S=>{const A=S.target;at.current&&!at.current.contains(A)&&i(void 0)},C=[];if(at.current){const S=d(at.current);C.push(...S)}return C.forEach(S=>{S.addEventListener("scroll",v)}),window.addEventListener("scroll",v),document.addEventListener("scroll",v,!0),()=>{C.forEach(S=>{S.removeEventListener("scroll",v)}),window.removeEventListener("scroll",v),document.removeEventListener("scroll",v,!0)}},[r,i,at]);const kn=(ol=m==null?void 0:m.current)==null?void 0:ol.cell,Ms=s.useCallback((d,v,C,S,A,O)=>{if(xn.current=!1,r!==void 0){const Z=$t.current;(Z.x!==d.x||Z.y!==d.y)&&i(void 0)}let F=kn;F!==void 0&&(F=[F[0]-I,F[1]]);const D=_e===0?void 0:{x:0,y:d.y,width:_e,height:d.height},B=[];D!==void 0&&B.push(D),Tt>0&&(B.push({x:d.x-I,y:xe-Tt,width:d.width,height:Tt}),_e>0&&B.push({x:0,y:xe-Tt,width:_e,height:Tt}));const G={x:d.x-I,y:d.y,width:d.width,height:vt&&d.y+d.height>=xe?d.height-1:d.height,tx:A,ty:O,extras:{selected:F,freezeRegion:D,freezeRegions:B}};$t.current=G,pr(G),Cn([v,C,S]),tn==null||tn(G,G.tx,G.ty,G.extras)},[kn,r,I,vt,xe,_e,Tt,i,pr,tn]),Rs=Zn(E,s.useCallback((d,v)=>(E==null?void 0:E(d-I,v-I))!==!1,[E,I])),Es=Zn(Te,s.useCallback((d,v)=>{Te==null||Te(d-I,v-I),V!=="none"&&Ue(rt.fromSingleSelection(v),void 0,!0)},[V,Te,I,Ue])),fi=s.useRef(!1),Is=s.useCallback(d=>{if(d.location[0]===0&&I>0){d.preventDefault();return}tt==null||tt({...d,location:[d.location[0]-I,d.location[1]]}),d.defaultPrevented()||(fi.current=!0),f(void 0)},[tt,I]),Ds=s.useCallback(()=>{fi.current=!1},[]),ji=xt==null?void 0:xt.selectionBehavior,Rr=s.useCallback(d=>{if(ji!=="block-spanning")return;const{isGroupHeader:v,path:C,groupRows:S}=io(d);if(v)return[d,d];const A=C[C.length-1],O=d-A,F=d+S-A-1;return[O,F]},[io,ji]),hi=s.useRef(void 0),gi=s.useCallback(d=>{var v,C,S;if(!ds(d,hi.current)&&(hi.current=d,!(((v=on==null?void 0:on.current)==null?void 0:v.button)!==void 0&&on.current.button>=1))){if(d.buttons!==0&&a!==void 0&&((C=on.current)==null?void 0:C.location[0])===0&&I===1&&ge==="multi"&&a.previousSelection&&!a.previousSelection.rows.hasIndex(on.current.location[1])&&m.rows.hasIndex(on.current.location[1])){const A=Math.min(on.current.location[1],d.location[1]),O=Math.max(on.current.location[1],d.location[1])+1;$e(rt.fromSingleSelection([A,O]),void 0,!1)}else if(d.buttons!==0&&a!==void 0&&m.current!==void 0&&!fi.current&&!jo.current&&(mt==="rect"||mt==="multi-rect")){const[A,O]=m.current.cell;let[F,D]=d.location;if(D<0&&(D=$t.current.y),a.fillHandle===!0&&((S=a.previousSelection)==null?void 0:S.current)!==void 0){const B=a.previousSelection.current.range;D=Math.min(D,vt?xe-1:xe);const G=pc(B,F,D,Vt);ri(G)}else{if(vt&&O===xe)return;if(vt&&D===xe)if(d.kind===Gr)D--;else return;F=Math.max(F,I);const Z=Rr(O);D=Z===void 0?D:rn(D,Z[0],Z[1]);const se=F-A,j=D-O,pe={x:se>=0?A:F,y:j>=0?O:D,width:Math.abs(se)+1,height:Math.abs(j)+1};Ae({...m.current,range:pe},!0,!1,"drag")}}zt==null||zt({...d,location:[d.location[0]-I,d.location[1]]})}},[a,I,ge,m,mt,zt,$e,vt,xe,Vt,Rr,Ae]),Fs=s.useCallback(()=>{var F,D;const d=hi.current;if(d===void 0)return;const[v,C]=d.scrollEdge;let[S,A]=d.location;const O=$t.current;v===-1?S=((D=(F=O.extras)==null?void 0:F.freezeRegion)==null?void 0:D.x)??O.x:v===1&&(S=O.x+O.width),C===-1?A=Math.max(0,O.y):C===1&&(A=Math.min(xe-1,O.y+O.height)),S=rn(S,0,We.length-1),A=rn(A,0,xe-1),gi({...d,location:[S,A]})},[We.length,gi,xe]);Id(vs,at,Fs);const fn=s.useCallback(d=>{if(m.current===void 0)return;const[v,C]=d,[S,A]=m.current.cell,O=m.current.range;let F=O.x,D=O.x+O.width,B=O.y,G=O.y+O.height;const[Z,se]=Rr(A)??[0,xe-1],j=se+1;if(C!==0)switch(C){case 2:{G=j,B=A,Rt(0,G,"vertical");break}case-2:{B=Z,G=A+1,Rt(0,B,"vertical");break}case 1:{B<A?(B++,Rt(0,B,"vertical")):(G=Math.min(j,G+1),Rt(0,G,"vertical"));break}case-1:{G>A+1?(G--,Rt(0,G,"vertical")):(B=Math.max(Z,B-1),Rt(0,B,"vertical"));break}default:lr()}if(v!==0)if(v===2)D=We.length,F=S,Rt(D-1-I,0,"horizontal");else if(v===-2)F=I,D=S+1,Rt(F-I,0,"horizontal");else{let pe=[];if(J!==void 0){const Re=J({x:F,y:B,width:D-F-I,height:G-B},Y.current.signal);typeof Re=="object"&&(pe=Wd(Re))}if(v===1){let Re=!1;if(F<S){if(pe.length>0){const de=co(F+1,S+1).find(De=>!pe.includes(De-I));de!==void 0&&(F=de,Re=!0)}else F++,Re=!0;Re&&Rt(F,0,"horizontal")}Re||(D=Math.min(We.length,D+1),Rt(D-1-I,0,"horizontal"))}else if(v===-1){let Re=!1;if(D>S+1){if(pe.length>0){const de=co(D-1,S,-1).find(De=>!pe.includes(De-I));de!==void 0&&(D=de,Re=!0)}else D--,Re=!0;Re&&Rt(D-I,0,"horizontal")}Re||(F=Math.max(I,F-1),Rt(F-I,0,"horizontal"))}else lr()}Ae({cell:m.current.cell,range:{x:F,y:B,width:D-F,height:G-B}},!0,!1,"keyboard-select")},[J,Rr,m,We.length,I,xe,Rt,Ae]),mi=s.useRef(to);mi.current=to;const Vn=s.useCallback((d,v,C,S)=>{const A=Nt-(C?0:1);d=rn(d,I,Oe.length-1+I),v=rn(v,0,A);const O=kn==null?void 0:kn[0],F=kn==null?void 0:kn[1];if(d===O&&v===F)return!1;if(S&&m.current!==void 0){const D=[...m.current.rangeStack];(m.current.range.width>1||m.current.range.height>1)&&D.push(m.current.range),be({...m,current:{cell:[d,v],range:{x:d,y:v,width:1,height:1},rangeStack:D}},!0)}else Ae({cell:[d,v],range:{x:d,y:v,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===v&&(u.current=void 0),mi.current&&Rt(d-I,v),!0},[Nt,I,Oe.length,kn,m,Rt,be,Ae]),Hs=s.useCallback((d,v)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&zo(d)&&(nn([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var A;(A=Ft.current)==null||A.damage([{cell:r.cell}])})),Ot(!0),i(void 0);const[C,S]=v;if(m.current!==void 0&&(C!==0||S!==0)){const A=m.current.cell[1]===Nt-1;if(A&&S===1){z==null||z(d,[0,0]);return}const O=m.current.cell[0]===We.length-1&&d!==void 0;let F=!0;if(A&&S===1&&Ce!==void 0){F=!1;const D=m.current.cell[0]+C,B=Fo(D);Un(B??D,!1)}if(O&&C===1&&Be!==void 0){F=!1;const D=m.current.cell[1]+S;Sr(D,!1)}if(F){const D=rn(m.current.cell[0]+C,0,We.length-1),B=rn(m.current.cell[1]+S,0,Nt-1);Vn(D,B,A,!1),Yo&&(C===0&&S===1||C===1&&S===0)&&window.setTimeout(()=>{var Z;const G=M([D-I,B]);if(Po(G)){const se=(Z=Ft.current)==null?void 0:Z.getBounds(D,B);if(se&&G.allowOverlay){Ft.current&&Ft.current.focus();const j={current:{cell:[D,B],range:{x:D,y:B,width:1,height:1},rangeStack:[]},columns:rt.empty(),rows:rt.empty()};Lt==null||Lt(j);const pe={inputType:"keyboard",key:"Enter"};P==null||P([D-I,B],pe),Io({target:se,content:G,initialValue:void 0,cell:[D,B],highlight:!0,forceEditMode:!0,activation:pe})}}},50)}}z==null||z(d,v)},[r==null?void 0:r.cell,Ot,m,z,nn,Nt,Vn,We.length,Un,Sr,Ce,Be,Fo,Ft,M,I,P,Do,Io]),Ts=s.useMemo(()=>`gdg-overlay-${Bd++}`,[]),so=s.useCallback(d=>{var C,S,A,O;Ot();const v=[];for(let F=d.x;F<d.x+d.width;F++)for(let D=d.y;D<d.y+d.height;D++){const B=M([F-I,D]);if(!B.allowOverlay&&B.kind!==ee.Boolean)continue;let G;if(B.kind===ee.Custom){const Z=kt(B),se=(C=Z==null?void 0:Z.provideEditor)==null?void 0:C.call(Z,{...B,location:[F-I,D]});(Z==null?void 0:Z.onDelete)!==void 0?G=Z.onDelete(B):ia(se)&&(G=(S=se==null?void 0:se.deletedValue)==null?void 0:S.call(se,B))}else if(zo(B)&&B.allowOverlay||B.kind===ee.Boolean){const Z=kt(B);G=(A=Z==null?void 0:Z.onDelete)==null?void 0:A.call(Z,B)}G!==void 0&&!Lo(G)&&zo(G)&&v.push({location:[F,D],value:G})}nn(v),(O=Ft.current)==null||O.damage(v.map(F=>({cell:F.location})))},[Ot,M,kt,nn,I]),Zo=r!==void 0,Zi=s.useCallback(d=>{var de,De,Fe;const v=()=>{d.stopPropagation(),d.preventDefault()},C={didMatch:!1},{bounds:S}=d,A=m.columns,O=m.rows,F=vn;if(!Zo&&Xe(F.clear,d,C)){const Pe=((de=m.current)==null?void 0:de.cell)??[I,0];be({columns:rt.empty(),rows:rt.empty(),current:{cell:Pe,range:{x:Pe[0],y:Pe[1],width:1,height:1},rangeStack:[]}},!1),Ht==null||Ht(),Ot()}else if(!Zo&&Xe(F.selectAll,d,C))be({columns:rt.empty(),rows:rt.empty(),current:{cell:((De=m.current)==null?void 0:De.cell)??[I,0],range:{x:I,y:0,width:k.length,height:xe},rangeStack:[]}},!1);else if(Xe(F.search,d,C))(Fe=c==null?void 0:c.current)==null||Fe.focus({preventScroll:!0}),yr(!0);else if(Xe(F.delete,d,C)){const Pe=(ot==null?void 0:ot(m))??!0;if(Pe!==!1){const Ct=Pe===!0?m:Pe;if(Ct.current!==void 0){so(Ct.current.range);for(const ht of Ct.current.rangeStack)so(ht)}for(const ht of Ct.rows)so({x:I,y:ht,width:k.length,height:1});for(const ht of Ct.columns)so({x:ht,y:0,width:1,height:xe})}}if(C.didMatch)return v(),!0;if(m.current===void 0)return!1;let[D,B]=m.current.cell;const[,G]=m.current.cell;let Z=!1,se=!1;if(Xe(F.scrollToSelectedCell,d,C))Dr.current(D-I,B);else if(V!=="none"&&Xe(F.selectColumn,d,C))A.hasIndex(D)?Ue(A.remove(D),void 0,!0):V==="single"?Ue(rt.fromSingleSelection(D),void 0,!0):Ue(void 0,D,!0);else if(ge!=="none"&&Xe(F.selectRow,d,C))O.hasIndex(B)?$e(O.remove(B),void 0,!0):ge==="single"?$e(rt.fromSingleSelection(B),void 0,!0):$e(void 0,B,!0);else if(!Zo&&S!==void 0&&Xe(F.activateCell,d,C))if(B===xe&&vt)window.setTimeout(()=>{const Pe=Fo(D);Un(Pe??D)},0);else{const Pe={inputType:"keyboard",key:d.key};P==null||P([D-I,B],Pe),Do(S,Pe)}else m.current.range.height>1&&Xe(F.downFill,d,C)?qi():m.current.range.width>1&&Xe(F.rightFill,d,C)?Vi():Xe(F.goToNextPage,d,C)?B+=Math.max(1,$t.current.height-4):Xe(F.goToPreviousPage,d,C)?B-=Math.max(1,$t.current.height-4):Xe(F.goToFirstCell,d,C)?(i(void 0),B=0,D=0):Xe(F.goToLastCell,d,C)?(i(void 0),B=Number.MAX_SAFE_INTEGER,D=Number.MAX_SAFE_INTEGER):Xe(F.selectToFirstCell,d,C)?(i(void 0),fn([-2,-2])):Xe(F.selectToLastCell,d,C)?(i(void 0),fn([2,2])):Zo?(Xe(F.closeOverlay,d,C)&&i(void 0),Xe(F.acceptOverlayDown,d,C)&&(i(void 0),B++),Xe(F.acceptOverlayUp,d,C)&&(i(void 0),B--),Xe(F.acceptOverlayLeft,d,C)&&(i(void 0),D--),Xe(F.acceptOverlayRight,d,C)&&(i(void 0),D++)):(Xe(F.goDownCell,d,C)?B+=1:Xe(F.goUpCell,d,C)?B-=1:Xe(F.goRightCell,d,C)?D+=1:Xe(F.goLeftCell,d,C)?D-=1:Xe(F.goDownCellRetainSelection,d,C)?(B+=1,Z=!0):Xe(F.goUpCellRetainSelection,d,C)?(B-=1,Z=!0):Xe(F.goRightCellRetainSelection,d,C)?(D+=1,Z=!0):Xe(F.goLeftCellRetainSelection,d,C)?(D-=1,Z=!0):Xe(F.goToLastRow,d,C)?B=xe-1:Xe(F.goToFirstRow,d,C)?B=Number.MIN_SAFE_INTEGER:Xe(F.goToLastColumn,d,C)?D=Number.MAX_SAFE_INTEGER:Xe(F.goToFirstColumn,d,C)?D=Number.MIN_SAFE_INTEGER:(mt==="rect"||mt==="multi-rect")&&(Xe(F.selectGrowDown,d,C)?fn([0,1]):Xe(F.selectGrowUp,d,C)?fn([0,-1]):Xe(F.selectGrowRight,d,C)?fn([1,0]):Xe(F.selectGrowLeft,d,C)?fn([-1,0]):Xe(F.selectToLastRow,d,C)?fn([0,2]):Xe(F.selectToFirstRow,d,C)?fn([0,-2]):Xe(F.selectToLastColumn,d,C)?fn([2,0]):Xe(F.selectToFirstColumn,d,C)&&fn([-2,0])),se=C.didMatch);if(un!==void 0&&un!=="normal"&&B!==G){const Pe=un==="skip-up"||un==="skip"||un==="block",Ct=un==="skip-down"||un==="skip"||un==="block",ht=B<G;if(ht&&Pe){for(;B>=0&&io(B).isGroupHeader;)B--;B<0&&(B=G)}else if(!ht&&Ct){for(;B<xe&&io(B).isGroupHeader;)B++;B>=xe&&(B=G)}}const pe=Vn(D,B,!1,Z),Re=C.didMatch;return Re&&(pe||!se||Tn)&&v(),Re},[un,Zo,m,vn,V,ge,mt,I,io,xe,Vn,be,Ht,k.length,ot,Tn,so,Ue,$e,vt,Fo,Un,P,Do,qi,Vi,fn]),Jo=s.useCallback(d=>{let v=!1;Je!==void 0&&Je({...d,...d.location&&{location:[d.location[0]-I,d.location[1]]},cancel:()=>{v=!0}}),!v&&(Zi(d)||m.current)},[ct,Je,Zi,m,M,I,xe,vt,P,Do]),As=s.useCallback((d,v)=>{const C=d.location[0]-I;if(d.kind==="header"&&(we==null||we(C,{...d,preventDefault:v})),d.kind===gn){if(C<0)return;_==null||_(C,{...d,preventDefault:v})}if(d.kind==="cell"){const[S,A]=d.location;fe==null||fe([C,A],{...d,preventDefault:v}),ka(m,d.location)||Vn(S,A,!1,!1)}},[m,fe,_,we,I,Vn]),wi=s.useCallback(async d=>{var F,D,B;if(!vn.paste)return;function v(G,Z,se,j){var Re,de;const pe=typeof se=="object"?(se==null?void 0:se.join(`
`))??"":(se==null?void 0:se.toString())??"";if(!Lo(G)&&Po(G)&&G.readonly!==!0){const De=X==null?void 0:X(pe,G);if(De!==void 0&&zo(De))return{location:Z,value:De};const Fe=kt(G);if(Fe===void 0)return;if(Fe.kind===ee.Custom){Jt(G.kind===ee.Custom);const Pe=(Re=Fe.onPaste)==null?void 0:Re.call(Fe,pe,G.data);return Pe===void 0?void 0:{location:Z,value:{...G,data:Pe}}}else{const Pe=(de=Fe.onPaste)==null?void 0:de.call(Fe,pe,G,{formatted:j,formattedString:typeof j=="string"?j:j==null?void 0:j.join(`
`),rawValue:se});return Pe===void 0?void 0:(Jt(Pe.kind===G.kind),{location:Z,value:Pe})}}}const C=m.columns,S=m.rows,A=((F=at.current)==null?void 0:F.contains(document.activeElement))===!0||((D=l.current)==null?void 0:D.contains(document.activeElement))===!0;let O;if(m.current!==void 0?O=[m.current.range.x,m.current.range.y]:C.length===1?O=[C.first()??0,0]:S.length===1&&(O=[I,S.first()??0]),A&&O!==void 0){let G,Z;const se="text/plain",j="text/html";if(navigator.clipboard.read!==void 0){const De=await navigator.clipboard.read();for(const Fe of De){if(Fe.types.includes(j)){const Ct=await(await Fe.getType(j)).text(),ht=Ml(Ct);if(ht!==void 0){G=ht;break}}Fe.types.includes(se)&&(Z=await(await Fe.getType(se)).text())}}else if(navigator.clipboard.readText!==void 0)Z=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(j)){const De=d.clipboardData.getData(j);G=Ml(De)}G===void 0&&d.clipboardData.types.includes(se)&&(Z=d.clipboardData.getData(se))}else return;const[pe,Re]=O,de=[];do{if(q===void 0){const De=Zt(O),Fe=Z??(G==null?void 0:G.map(Ct=>Ct.map(ht=>ht.rawValue).join("	")).join("	"))??"",Pe=v(De,O,Fe,void 0);Pe!==void 0&&de.push(Pe);break}if(G===void 0){if(Z===void 0)return;G=Cd(Z)}if(q===!1||typeof q=="function"&&(q==null?void 0:q([O[0]-I,O[1]],G.map(De=>De.map(Fe=>{var Pe;return((Pe=Fe.rawValue)==null?void 0:Pe.toString())??""}))))!==!0)return;for(const[De,Fe]of G.entries()){if(De+Re>=xe)break;for(const[Pe,Ct]of Fe.entries()){const ht=[Pe+pe,De+Re],[Ut,Sn]=ht;if(Ut>=We.length||Sn>=Nt)continue;const hn=Zt(ht),Mn=v(hn,ht,Ct.rawValue,Ct.formatted);Mn!==void 0&&de.push(Mn)}}}while(!1);nn(de),(B=Ft.current)==null||B.damage(de.map(De=>({cell:De.location})))}},[X,kt,Zt,m,vn.paste,at,We.length,nn,Nt,q,I,xe]);Gt("paste",wi,w,!1,!0);const Qo=s.useCallback(async(d,v)=>{var F,D;if(!vn.copy)return;const C=v===!0||((F=at.current)==null?void 0:F.contains(document.activeElement))===!0||((D=l.current)==null?void 0:D.contains(document.activeElement))===!0,S=m.columns,A=m.rows,O=(B,G)=>{if(!le)El(B,G,d);else{const Z=G.map(se=>({kind:ee.Text,data:k[se].title,displayData:k[se].title,allowOverlay:!1}));El([Z,...B],G,d)}};if(C&&J!==void 0){if(m.current!==void 0){let B=J(m.current.range,Y.current.signal);typeof B!="object"&&(B=await B()),O(B,co(m.current.range.x-I,m.current.range.x+m.current.range.width-I))}else if(A!==void 0&&A.length>0){const G=[...A].map(Z=>{const se=J({x:I,y:Z,width:k.length,height:1},Y.current.signal);return typeof se=="object"?se[0]:se().then(j=>j[0])});if(G.some(Z=>Z instanceof Promise)){const Z=await Promise.all(G);O(Z,co(k.length))}else O(G,co(k.length))}else if(S.length>0){const B=[],G=[];for(const Z of S){let se=J({x:Z,y:0,width:1,height:xe},Y.current.signal);typeof se!="object"&&(se=await se()),B.push(se),G.push(Z-I)}if(B.length===1)O(B[0],G);else{const Z=B.reduce((se,j)=>se.map((pe,Re)=>[...pe,...j[Re]]));O(Z,G)}}}},[k,J,m,vn.copy,I,at,xe,le]);Gt("copy",Qo,w,!1,!1);const zs=s.useCallback(async d=>{var C,S;if(!(!vn.cut||!(((C=at.current)==null?void 0:C.contains(document.activeElement))===!0||((S=l.current)==null?void 0:S.contains(document.activeElement))===!0))&&(await Qo(d),m.current!==void 0)){let A={current:{cell:m.current.cell,range:m.current.range,rangeStack:[]},rows:rt.empty(),columns:rt.empty()};const O=ot==null?void 0:ot(A);if(O===!1||(A=O===!0?A:O,A.current===void 0))return;so(A.current.range)}},[so,m,vn.cut,Qo,at,ot]);Gt("cut",zs,w,!1,!1);const Ps=s.useCallback((d,v)=>{if(Ge!==void 0){I!==0&&(d=d.map(A=>[A[0]-I,A[1]])),Ge(d,v);return}if(d.length===0||v===-1)return;const[C,S]=d[v];u.current!==void 0&&u.current[0]===C&&u.current[1]===S||(u.current=[C,S],Vn(C,S,!1,!1))},[Ge,I,Vn]),[Er,Ir]=((rl=Dt==null?void 0:Dt.current)==null?void 0:rl.cell)??[],Dr=s.useRef(Rt);Dr.current=Rt,s.useLayoutEffect(()=>{var d,v,C,S;mi.current&&!xn.current&&Er!==void 0&&Ir!==void 0&&(Er!==((v=(d=ie.current)==null?void 0:d.current)==null?void 0:v.cell[0])||Ir!==((S=(C=ie.current)==null?void 0:C.current)==null?void 0:S.cell[1]))&&Dr.current(Er,Ir),xn.current=!1},[Er,Ir]);const Ji=m.current!==void 0&&(m.current.cell[0]>=We.length||m.current.cell[1]>=Nt);s.useLayoutEffect(()=>{Ji&&be(ki,!1)},[Ji,be]);const Ls=s.useMemo(()=>vt===!0&&(Ve==null?void 0:Ve.tint)===!0?rt.fromSingleSelection(Nt-1):rt.empty(),[Nt,vt,Ve==null?void 0:Ve.tint]),Bs=s.useCallback(d=>typeof Xt=="boolean"?Xt:(Xt==null?void 0:Xt(d-I))??!0,[I,Xt]),Ws=s.useMemo(()=>{if(ci===void 0||l.current===null)return null;const{bounds:d,group:v}=ci,C=l.current.getBoundingClientRect();return s.createElement(dd,{bounds:d,group:v,canvasBounds:C,onClose:()=>di(void 0),onFinish:S=>{di(void 0),ve==null||ve(v,S)}})},[ve,ci]),$s=Math.min(We.length,_e+(Yt?1:0));s.useImperativeHandle(t,()=>({appendRow:(d,v)=>Un(d+I,v),appendColumn:(d,v)=>Sr(d,v),updateCells:d=>{var v;return I!==0&&(d=d.map(C=>({cell:[C.cell[0]+I,C.cell[1]]}))),(v=Ft.current)==null?void 0:v.damage(d)},getBounds:(d,v)=>{var C;if(!((l==null?void 0:l.current)===null||(at==null?void 0:at.current)===null)){if(d===void 0&&v===void 0){const S=l.current.getBoundingClientRect(),A=S.width/at.current.clientWidth;return{x:S.x-at.current.scrollLeft*A,y:S.y-at.current.scrollTop*A,width:at.current.scrollWidth*A,height:at.current.scrollHeight*A}}return(C=Ft.current)==null?void 0:C.getBounds((d??0)+I,v)}},focus:()=>{var d;return(d=Ft.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Jo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Qo(void 0,!0);break;case"paste":await wi();break}},scrollTo:Rt,remeasureColumns:d=>{for(const v of d)Mr(v+I)},getMouseArgsForPosition:(d,v,C)=>{if((Ft==null?void 0:Ft.current)===null)return;const S=Ft.current.getMouseArgsForPosition(d,v,C);if(S!==void 0)return{...S,location:[S.location[0]-I,S.location[1]]}}}),[Un,Sr,Mr,at,Qo,Jo,wi,I,Rt]);const[Qi,el]=kn??[],Os=s.useCallback(d=>{const[v,C]=d;if(C===-1){V!=="none"&&(Ue(rt.fromSingleSelection(v),void 0,!1),Ot());return}Qi===v&&el===C||(Ae({cell:d,range:{x:v,y:C,width:1,height:1}},!0,!1,"keyboard-nav"),Rt(v,C))},[V,Ot,Rt,Qi,el,Ae,Ue]),[Ns,Xs]=s.useState(!1),tl=s.useRef(zl(d=>{Xs(d)},5)),Ys=s.useCallback(()=>{tl.current(!0),m.current===void 0&&m.columns.length===0&&m.rows.length===0&&a===void 0&&Ae({cell:[I,vr],range:{x:I,y:vr,width:1,height:1}},!0,!1,"keyboard-select")},[vr,m,a,I,Ae]),Gs=s.useCallback(()=>{tl.current(!1)},[]),[_s,Us]=s.useMemo(()=>{let d;const v=(Ze==null?void 0:Ze.scrollbarWidthOverride)??Ei(),C=xe+(vt?1:0);if(typeof pn=="number")d=zn+C*pn;else{let A=0;const O=Math.min(C,10);for(let F=0;F<O;F++)A+=pn(F);A=Math.floor(A/O),d=zn+C*A}d+=v;const S=We.reduce((A,O)=>O.width+A,0)+v;return[`${Math.min(1e5,S)}px`,`${Math.min(1e5,d)}px`]},[We,Ze==null?void 0:Ze.scrollbarWidthOverride,pn,xe,vt,zn]),Ks=s.useMemo(()=>Ba(et),[et]);return s.createElement(Jl.Provider,{value:et},s.createElement(Md,{style:Ks,className:ue,inWidth:y??_s,inHeight:x??Us},s.createElement(ld,{fillHandle:qe,drawFocusRing:Go,experimental:Ze,fixedShadowX:Dn,fixedShadowY:dr,getRowThemeOverride:cn,headerIcons:$n,imageWindowLoader:Fn,initialSize:Hn,isDraggable:go,onDragLeave:ur,onRowMoved:On,overscrollX:ti,overscrollY:ni,preventDiagonalScrolling:bo,rightElement:yo,rightElementProps:eo,smoothScrollX:Kr,smoothScrollY:fr,className:ue,enableGroups:_t,onCanvasFocused:Ys,onCanvasBlur:Gs,canvasRef:l,onContextMenu:As,theme:et,cellXOffset:bs,cellYOffset:vr,accessibilityHeight:Ln.height,onDragEnd:Ds,columns:We,nonGrowWidth:dn,drawHeader:ye,onColumnProposeMove:Rs,drawCell:st,disabledRows:Ls,freezeColumns:$s,lockColumns:I,firstColAccessible:I===0,getCellContent:Zt,minColumnWidth:Gn,maxColumnWidth:ko,searchInputRef:c,showSearch:Ro,onSearchClose:oi,highlightRegions:ys,getCellsForSelection:J,getGroupDetails:ii,headerHeight:Ko,isFocused:Ns,groupHeaderHeight:_t?So:0,freezeTrailingRows:Tt+(vt&&(Ve==null?void 0:Ve.sticky)===!0?1:0),hasAppendRow:vt,onColumnResize:ze,onColumnResizeEnd:me,onColumnResizeStart:At,onCellFocused:Os,onColumnMoved:Es,onDragStart:Is,onHeaderMenuClick:ks,onHeaderIndicatorClick:Ss,onItemHovered:gi,isFilling:(a==null?void 0:a.fillHandle)===!0,onMouseMove:xs,onKeyDown:Jo,onKeyUp:ae,onMouseDown:ps,onMouseUp:Cs,onDragOverCell:an,onDrop:Ie,onSearchResultsChanged:Ps,onVisibleRegionChanged:Ms,clientSize:qt,rowHeight:pn,searchResults:U,searchValue:Le,onSearchValueChange:oe,rows:Nt,scrollRef:at,selection:m,translateX:Ln.tx,translateY:Ln.ty,verticalBorder:Bs,gridRef:Ft,getCellRenderer:kt,resizeIndicator:hr}),Ws,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Ld,{...r,validateCell:Q,bloom:N,id:Ts,getCellRenderer:kt,className:(Ze==null?void 0:Ze.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:ft,imageEditorOverride:g,portalElementRef:gr,onFinishEditing:Hs,markdownDivCreateNode:h,isOutsideClick:Zr,customEventTarget:Ze==null?void 0:Ze.eventTarget}))))},Od=s.forwardRef($d);function Fl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:c,height:l,x:a,y:f}=r,u=t.maxSize??i.checkboxMaxSize,w=Math.floor(r.y+l/2),g=Wl(u,l,i.cellVerticalPadding),b=Bl(t.contentAlign??"center",a,c,i.cellHorizontalPadding,g),h=Ll(b,w,g),y=$l(a+n,f+o,h);return zi(t)&&y}const Nd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:ee.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Xd(e,e.cell.data,zi(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Fl(e)&&e.preventDefault()},onClick:e=>{if(Fl(e))return{...e.cell,data:fs(e.cell.data)}},onPaste:(e,t)=>{let n=Wr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Ai),n===t.data?void 0:{...t,data:n}}};function Xd(e,t,n,o,r){if(!n&&t===Wr)return;const{ctx:i,hoverAmount:c,theme:l,rect:a,highlighted:f,hoverX:u,hoverY:w,cell:{contentAlign:g}}=e,{x:b,y:h,width:y,height:x}=a;let k=!1;if(r>0){let p=n?1-r+r*c:.4;if(t===Wr&&(p*=c),p===0)return;p<1&&(k=!0,i.globalAlpha=p)}Nr(i,l,t,b,h,y,x,f,u,w,o,g),k&&(i.globalAlpha=1)}const Yd=en("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Gd=e=>{const{bubbles:t}=e;return s.createElement(Yd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},_d={getAccessibilityString:e=>Ol(e.data),kind:ee.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Ud(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Gd,{bubbles:t.data})},onPaste:()=>{}};function Ud(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:c,y:l,width:a,height:f}=n;let u=c+o.cellHorizontalPadding;const w=[];for(const g of t){if(u>c+a)break;const b=Xo(g,r,o.baseFontFull).width;w.push({x:u,width:b}),u+=b+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const g of w)En(r,g.x,l+(f-o.bubbleHeight)/2,g.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[g,b]of w.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[g],b.x+o.bubblePadding,l+f/2+Wn(r,o))}const Kd=en("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Vd=e=>{const{drilldowns:t}=e;return s.createElement(Kd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},qd={getAccessibilityString:e=>Ol(e.data.map(t=>t.text)),kind:ee.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Zd(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Vd,{drilldowns:t.data})},onPaste:()=>{}},Si={};function jd(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,c=n-i*2,l=4,a=n*r,f=o+i,u=o*3,w=(u+i*2)*r,g=`${e},${t},${r},${n}`;if(Si[g]!==void 0)return{el:Si[g],height:a,width:w,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const b=document.createElement("canvas"),h=b.getContext("2d");return h===null?null:(b.width=w,b.height=a,h.scale(r,r),Si[g]=b,h.beginPath(),En(h,i,i,u,c,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),En(h,i+.5,i+.5,u,c,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:b,height:a,width:w,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Zd(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:c,row:l}=e,{x:a,width:f}=n,u=o.baseFontFull,w=Kl(r,u),g=Math.min(n.height,Math.max(16,Math.ceil(w*o.lineHeight)*2)),b=Math.floor(n.y+(n.height-g)/2),h=g-10,y=o.bubblePadding,x=o.bubbleMargin;let k=a+o.cellHorizontalPadding;const p=o.roundingRadius??6,M=jd(o.bgCell,o.drilldownBorder,g,p),W=[];for(const P of t){if(k>a+f)break;const z=Xo(P.text,r,u).width;let X=0;P.img!==void 0&&i.loadOrGetImage(P.img,c,l)!==void 0&&(X=h-8+4);const R=z+X+y*2;W.push({x:k,width:R}),k+=R+x}if(M!==null){const{el:P,height:T,middleWidth:z,sideWidth:X,width:R,dpr:$,padding:N}=M,L=X/$,E=N/$;for(const H of W){const re=Math.floor(H.x),K=Math.floor(H.width),fe=K-(L-E)*2;r.imageSmoothingEnabled=!1,r.drawImage(P,0,0,X,T,re-E,b,L,g),fe>0&&r.drawImage(P,X,0,z,T,re+(L-E),b,fe,g),r.drawImage(P,R-X,0,X,T,re+K-(L-E),b,L,g),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[P,T]of W.entries()){const z=t[P];let X=T.x+y;if(z.img!==void 0){const R=i.loadOrGetImage(z.img,c,l);if(R!==void 0){const $=h-8;let N=0,L=0,E=R.width,H=R.height;E>H?(N+=(E-H)/2,E=H):H>E&&(L+=(H-E)/2,H=E),r.beginPath(),En(r,X,b+g/2-$/2,$,$,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(R,N,L,E,H,X,b+g/2-$/2,$,$),r.restore(),X+=$+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(z.text,X,b+g/2+Wn(r,o))}}const Jd={getAccessibilityString:e=>e.data.join(", "),kind:ee.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Qd(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ma;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Mi=4;function Qd(e,t,n,o){const{rect:r,col:i,row:c,theme:l,ctx:a,imageLoader:f}=e,{x:u,y:w,height:g,width:b}=r,h=g-l.cellVerticalPadding*2,y=[];let x=0;for(let p=0;p<t.length;p++){const M=t[p];if(M.length===0)continue;const W=f.loadOrGetImage(M,i,c);if(W!==void 0){y[p]=W;const P=W.width*(h/W.height);x+=P+Mi}}if(x===0)return;x-=Mi;let k=u+l.cellHorizontalPadding;o==="right"?k=Math.floor(u+b-l.cellHorizontalPadding-x):o==="center"&&(k=Math.floor(u+b/2-x/2));for(const p of y){if(p===void 0)continue;const M=p.width*(h/p.height);n>0&&(a.beginPath(),En(a,k,w+l.cellVerticalPadding,M,h,n),a.save(),a.clip()),a.drawImage(p,k,w+l.cellVerticalPadding,M,h),n>0&&a.restore(),k+=M+Mi}}function eu(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const tu={getAccessibilityString:()=>"",kind:ee.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:c}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(eu(n,o)*t.skeletonWidthVariability));const a=c.cellHorizontalPadding;l+a*2>=i.width&&(l=i.width-a*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*c.cellVerticalPadding);En(r,i.x+a,i.y+(i.height-f)/2,l,f,c.roundingRadius??3),r.fillStyle=fo(c.textDark,.1),r.fill()},onPaste:()=>{}},nu=()=>e=>e.targetWidth,Hl=en("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[nu(),"px"]}}),ou=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:c,validatedSelection:l}=e,a=t.data,f=t.readonly===!0,[u,w]=s.useState(a===""||o),g=s.useCallback(()=>{w(h=>!h)},[]),b=a?"gdg-ml-6":"";return u?s.createElement(Hl,{targetWidth:i.width-20},s.createElement(_r,{autoFocus:!0,highlight:!1,validatedSelection:l,value:a,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${b}`,onClick:()=>c(t)},s.createElement(aa,null))):s.createElement(Hl,{targetWidth:i.width},s.createElement(ba,{contents:a,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${b}`,onClick:g},s.createElement(Pi,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},ru={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:cr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Rn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:c,validatedSelection:l}=e;return s.createElement(ou,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:a=>t({...n,data:a.target.value}),forceEditMode:c,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},iu={getAccessibilityString:e=>e.row.toString(),kind:ln.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:lu,measure:()=>44,draw:e=>au(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e;if(n.disabled===!0)return;const{width:i,height:c}=t,l=n.drawHandle?7+(i-7)/2:i/2,a=c/2;if(Math.abs(o-l)<=10&&Math.abs(r-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function lu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=su,n.textAlign="center",i}function su(e){const{ctx:t}=e;t.textAlign="start"}function au(e,t,n,o,r,i,c){if(c){const{ctx:x,rect:k,theme:p}=e,{x:M,y:W,width:P,height:T}=k,z=o==="checkbox"?"checkbox-visible":o;if(z!=="number"&&(x.globalAlpha=n?1:.4,Nr(x,p,n,r?M+7:M,W,r?P-7:P,T,!1,-20,-20,p.checkboxMaxSize,"center",i,!0),x.globalAlpha=1),z==="number"||z==="both"&&!n){const X=t.toString(),R=p.markerFontFull,$=M+P/2;x.fillStyle="#cccccc",x.font=R,x.fillText(X,$,W+T/2+Wn(x,R))}if(r){x.globalAlpha=.4,x.beginPath();for(const X of[3,6])for(const R of[-5,-1,3])x.rect(M+X,W+T/2+R,2,2);x.fillStyle="#cccccc",x.fill(),x.beginPath(),x.globalAlpha=1}return}const{ctx:l,rect:a,hoverAmount:f,theme:u}=e,{x:w,y:g,width:b,height:h}=a,y=n?1:o==="checkbox-visible"?.6+.4*f:f;if(o!=="number"&&y>0){l.globalAlpha=y;const x=7*(n?f:1);if(Nr(l,u,n,r?w+x:w,g,r?b-x:b,h,!0,void 0,void 0,u.checkboxMaxSize,"center",i,c),r){l.globalAlpha=f,l.beginPath();for(const k of[3,6])for(const p of[-5,-1,3])l.rect(w+k,g+h/2+p,2,2);l.fillStyle=u.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const x=t.toString(),k=u.markerFontFull,p=w+b/2;o==="both"&&f!==0&&(l.globalAlpha=1-f),l.fillStyle=u.textLight,l.font=k,l.fillText(x,p,g+h/2+Wn(l,k)),f!==0&&(l.globalAlpha=1)}}const cu={getAccessibilityString:()=>"",kind:ln.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>du(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function du(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:c,spriteManager:l}=e,{x:a,y:f,width:u,height:w}=r;o.beginPath(),o.globalAlpha=i,o.rect(a+1,f+1,u,w-2),o.fillStyle=c.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let b=0;if(n!==void 0){const y=w-8,x=a+8/2,k=f+8/2;l.drawSprite(n,"normal",o,x,k,y,c,g?1:i),b=y}else{b=24;const h=12,y=g?h:i*h,x=g?0:(1-i)*h*.5,k=c.cellHorizontalPadding+4;y>0&&(o.moveTo(a+k+x,f+w/2),o.lineTo(a+k+x+y,f+w/2),o.moveTo(a+k+x+y*.5,f+w/2-y*.5),o.lineTo(a+k+x+y*.5,f+w/2+y*.5),o.lineWidth=2,o.strokeStyle=c.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=c.textMedium,o.fillText(t,b+a+c.cellHorizontalPadding+.5,f+w/2+Wn(o,c)),o.beginPath()}function ms(e,t,n,o,r,i,c){e.textBaseline="alphabetic";const l=uu(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),En(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??fo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",c==null||c("text")}function uu(e,t,n,o,r){const i=o.cellHorizontalPadding,c=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+c/2+1,width:t.width-i,height:t.height-c-1};const l=Xo(n,e,o.baseFontFull,"alphabetic"),a=t.height-c,f=Math.min(a,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const fu=s.lazy(async()=>await Al(()=>import("./number-overlay-editor-Drpz6LLI.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),hu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:cr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:c}=e,{hoverEffect:l,displayData:a,hoverEffectTheme:f}=n;l===!0&&t>0&&ms(o,r,f,a,i,t,c),Rn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(fu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},gu={getAccessibilityString:()=>"",measure:()=>108,kind:ee.Protected,needsHover:!1,needsHoverPosition:!1,draw:mu,onPaste:()=>{}};function mu(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:c}=o;t.beginPath();const l=2.5;let a=r+n.cellHorizontalPadding+l;const f=i+c/2,u=Math.cos(dl(30))*l,w=Math.sin(dl(30))*l;for(let g=0;g<12;g++)t.moveTo(a,f-l),t.lineTo(a,f+l),t.moveTo(a+u,f-w),t.lineTo(a-u,f+w),t.moveTo(a-u,f-w),t.lineTo(a+u,f+w),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const wu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>cr(e,t,e.theme.textLight),draw:e=>Rn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return St.createElement(_r,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},bu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:cr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:c,overrideCursor:l}=e,{displayData:a,contentAlign:f,hoverEffect:u,allowWrapping:w,hoverEffectTheme:g}=t;u===!0&&n>0&&ms(r,c,g,a,i,n,l),Rn(e,a,f,w,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(_r,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:c=>o({...r,data:c.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},yu=en("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),pu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:c}=e,[l,a]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{a(!0)},[]);return l?s.createElement(_r,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(yu,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},c),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Pi,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function ws(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,c=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-c-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-c/2),{x:r,y:i,width:c,height:l}}function Tl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,c=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=_l(c,i.baseFontFull);if(l===void 0)return!1;const a=ws(l,n,i,t.contentAlign);return uo({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,r)}const vu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:ee.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:cr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:c,ctx:l}=e,a=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Xo(a,l,n.baseFontFull),w=ws(u,c,n,t.contentAlign),{x:g,y:b,width:h,height:y}=w;if(r>=g-4&&r<=g-4+h+8&&i>=b-4&&i<=b-4+y+8){const x=Wn(l,n.baseFontFull);o("pointer");const k=5,p=b-x;l.beginPath(),l.moveTo(c.x+g,Math.floor(c.y+p+y+k)+.5),l.lineTo(c.x+g+h,Math.floor(c.y+p+y+k)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Rn({...e,rect:{...c,x:c.x-1}},a,t.contentAlign),Rn({...e,rect:{...c,x:c.x-2}},a,t.contentAlign),Rn({...e,rect:{...c,x:c.x+1}},a,t.contentAlign),Rn({...e,rect:{...c,x:c.x+2}},a,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Rn(e,a,t.contentAlign)},onSelect:e=>{Tl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Tl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(pu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:c=>n({...o,data:c.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Cu=[iu,cu,Nd,_d,qd,Jd,tu,ru,hu,gu,wu,bu,vu],Ri=[];class xu extends ql{constructor(){super(...arguments);Ne(this,"imageLoaded",()=>{});Ne(this,"loadedLocations",[]);Ne(this,"cache",{});Ne(this,"sendLoaded",ta(()=>{this.imageLoaded(new Wo(this.loadedLocations)),this.loadedLocations=[]},20));Ne(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let c=0;c<r.cells.length;c++){const l=r.cells[c];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let c=!1;const l=Ri.pop()??new Image;let a=!1;const f={img:void 0,cells:[mn(o,r)],url:n,cancel:()=>{a||(a=!0,Ri.length<12?Ri.unshift(l):c||(l.src=""))}},u=new Promise(w=>l.addEventListener("load",()=>w(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const w=this.cache[i];if(w!==void 0&&!a){w.img=l;for(const g of w.cells)this.loadedLocations.push($i(g));c=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,c=this.cache[i];if(c!==void 0){const l=mn(o,r);return c.cells.includes(l)||c.cells.push(l),c.img}else this.loadImage(n,o,r,i)}}const ku=(e,t)=>{const n=s.useMemo(()=>({...wc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??Cu,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new xu,[e.imageWindowLoader]);return s.createElement(Od,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Pu=s.forwardRef(ku);export{sd as C,Pu as D,ee as G,Jl as T,_r as a,Kl as b,Qt as c,Au as d,Tu as e,Fu as f,Wn as g,zo as h,Hu as i,sl as j,Lo as k,ia as l,Xo as m,Ba as n,Oo as p,En as r,zu as u};
