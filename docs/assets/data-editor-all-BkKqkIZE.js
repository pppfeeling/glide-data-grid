const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-C9WaGkNL.js","./iframe-DlpsAO35.js","./preload-helper-C1FmrZbK.js","./index-YelhS7F3.js","./marked.esm-C2nOZsb8.js","./throttle-CM-aqTNZ.js","./flatten-BhtxsdD9.js","./number-overlay-editor-Dbk4NGvZ.js","./react-number-format.es-BaoADXvn.js"])))=>i.map(i=>d[i]);
var na=Object.defineProperty;var oa=(e,t,n)=>t in e?na(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Le=(e,t,n)=>oa(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as St}from"./iframe-DlpsAO35.js";import{_ as Ol}from"./preload-helper-C1FmrZbK.js";import{h as ra,g as Xl,j as ia,k as la,v as sa,l as aa,m as un,r as wo,t as ca}from"./throttle-CM-aqTNZ.js";import{u as da,f as hl}from"./flatten-BhtxsdD9.js";import{s as on,a as ua}from"./marked.esm-C2nOZsb8.js";function Yl(e="This should not happen"){throw new Error(e)}function tn(e,t="Assertion failed"){if(!e)return Yl(t)}function hr(e,t){return Yl(t??"Hell froze over")}function fa(e,t){try{return e()}catch{return t}}const gl=Object.prototype.hasOwnProperty;function Go(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Go(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(gl.call(e,n)&&++o&&!gl.call(t,n)||!(n in t)||!Go(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Gr=null,$i=void 0;var J;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(J||(J={}));var ml;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(ml||(ml={}));var _r;(function(e){e.Triangle="triangle",e.Dots="dots"})(_r||(_r={}));function $r(e){return"width"in e&&typeof e.width=="number"}async function wl(e){return typeof e=="object"?e:await e()}function $o(e){return!(e.kind===J.Loading||e.kind===J.Bubble||e.kind===J.RowID||e.kind===J.Protected||e.kind===J.Drilldown)}function Xu(e){return!(e.kind===J.Loading||e.kind===J.Bubble||e.kind===J.RowID||e.kind===J.Protected||e.kind===J.Drilldown||e.kind===J.Boolean||e.kind===J.Image||e.kind===J.Custom)}function Oo(e){return e.kind===_t.Marker||e.kind===_t.NewRow||e.kind===_t.RowStatus}function No(e){if(!$o(e)||e.kind===J.Image)return!1;switch(e.kind){case J.Text:case J.Number:case J.Markdown:case J.Uri:case J.Custom:case J.Boolean:return e.readonly!==!0;default:hr(e,"A cell was passed with an invalid kind")}}function ha(e){return ra(e,"editor")}function Ni(e){return!(e.readonly??!1)}var _t;(function(e){e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status"})(_t||(_t={}));const Kr={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Si(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let bl;const jt=class jt{constructor(t){Le(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new jt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Si([...this.items,n]);return new jt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,d]of n.entries()){const[l,c]=d;if(l<=r&&o<=c){const f=[];l<o&&f.push([l,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new jt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Le(jt,"create",t=>new jt(Si(t))),Le(jt,"empty",()=>bl??(bl=new jt([]))),Le(jt,"fromSingleSelection",t=>jt.empty().add(t)),Le(jt,"fromArray",t=>{if(t.length===0)return jt.empty();const n=t.map(r=>[r,r+1]),o=Si(n);return new jt(o)});let ot=jt;const ga=on("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Vt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const d=n,l=c=>{var f;(f=i.current)==null||f.call(d,c)};return d.addEventListener(e,l,{passive:o,capture:r}),()=>{d.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function Qn(e,t){return e===void 0?void 0:t}const ma=Math.PI;function yl(e){return e*ma/180}const Gl=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),_l=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},Kl=(e,t,n)=>Math.min(e,t-n*2),Ul=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Oi=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},wa=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function ba(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const d=s.useRef(Xl(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&d.current(()=>e())},t),o}const ya="֑-߿יִ-﷽ﹰ-ﻼ",pa="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",va=new RegExp("^[^"+pa+"]*["+ya+"]");function Xi(e){return va.test(e)?"rtl":"not-rtl"}let Nr;function Ai(){if(typeof document>"u")return 0;if(Nr!==void 0)return Nr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Nr=n-o,Nr}const go=Symbol();function Ca(e){const t=s.useRef([go,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const c=t.current[0];c!==go&&(l=typeof l=="function"?l(c):l,l===c)||(c!==go&&r({}),o(f=>typeof l=="function"?l(c===go?f:c):l),t.current[0]=go)},[]),d=s.useCallback(()=>{t.current[0]=go,r({})},[]);return[t.current[0]===go?n:t.current[0],i,d]}function Vl(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function xa(e){const t=s.useRef(e);return Go(e,t.current)||(t.current=e),t.current}const ka=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const d=i.length>1;return s.createElement(ga,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(ia.Carousel,{showArrows:d,showThumbs:!1,swipeable:d,emulateTouch:d,infiniteLoop:d},i.map(l=>{const c=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},c)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Oi,null)))},Sa=on("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class Ma extends St.PureComponent{constructor(){super(...arguments);Le(this,"targetElement",null);Le(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,d=ua(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let c=i==null?void 0:i(d);if(c===void 0){const u=document.createElement("template");u.innerHTML=d,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),St.createElement(Sa,{ref:this.containerRefHook})}}const Ra=on("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Ea=on("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),Ia=on("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let pl=0;const Zr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:d,...l}=e,{onChange:c,className:f}=l,u=s.useRef(null),w=n??"";tn(c!==void 0,"GrowingEntry must be a controlled input area");const[m]=s.useState(()=>"input-box-"+(pl=(pl+1)%1e7));s.useEffect(()=>{const g=u.current;if(g===null||g.disabled)return;const y=w.toString().length;g.focus(),g.setSelectionRange(r?0:y,y)},[]),s.useLayoutEffect(()=>{var g;if(d!==void 0){const y=typeof d=="number"?[d,null]:d;(g=u.current)==null||g.setSelectionRange(y[0],y[1])}},[d]);const b=s.useCallback(g=>{g.key==="Enter"&&g.shiftKey&&i===!0||o==null||o(g)},[i,o]);return s.createElement(Ia,{className:"gdg-growing-entry"},s.createElement(Ea,{className:f},w+`
`),s.createElement(Ra,{...l,className:(f??"")+" gdg-input",id:m,ref:u,onKeyDown:b,value:w,placeholder:t,dir:"auto"}))},Mi={};let Zn=null;function Da(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function _o(e){const t=e.toLowerCase().trim();if(Mi[t]!==void 0)return Mi[t];Zn=Zn||Da(),Zn.style.color="#000",Zn.style.color=t;const n=getComputedStyle(Zn).color;Zn.style.color="#fff",Zn.style.color=t;const o=getComputedStyle(Zn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),Mi[t]=r,r}function yo(e,t){const[n,o,r]=_o(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const vl=new Map;function Cl(e,t){const n=`${e}-${t}`,o=vl.get(n);if(o!==void 0)return o;const r=nn(e,t);return vl.set(n,r),r}function nn(e,t){if(t===void 0)return e;const[n,o,r,i]=_o(e);if(i===1)return e;const[d,l,c,f]=_o(t),u=i+f*(1-i),w=(i*n+f*d*(1-i))/u,m=(i*o+f*l*(1-i))/u,b=(i*r+f*c*(1-i))/u;return`rgba(${w}, ${m}, ${b}, ${u})`}function Yu(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,d]=_o(e),[l,c,f,u]=_o(t),w=o*d,m=r*d,b=i*d,g=l*u,y=c*u,x=f*u,k=n,p=1-n,R=d*p+u*k;if(R===0)return"rgba(0, 0, 0, 0)";const W=Math.floor((w*p+g*k)/R),L=Math.floor((m*p+y*k)/R),A=Math.floor((b*p+x*k)/R);return`rgba(${W}, ${L}, ${A}, ${R})`}function Gu(e){if(e==="transparent")return 0;function t(i){const d=i/255;return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}const[n,o,r]=_o(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function Fa(e,t){return St.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function Ta(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(ur(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function gr(e,t){return(e??"")===(t??"")}function Ha(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function ql(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function ur(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function jl(e){return[e.x+e.width-1,e.y+e.height-1]}function xl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,d=n.y+n.height-1,[l,c]=e;if(c<i||c>d)return!1;if(t.span===void 0)return l>=o&&l<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function Aa(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&xl(e,t,i)&&r++;for(const d of n.current.rangeStack)xl(e,t,d)&&r++;return r}function Zl(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,d)=>({...i,sticky:e[d].sticky})),n=o}return n}function Ko(e,t){let n=0;const o=Zl(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function po(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function zi(e,t,n,o,r){const i=Zl(e,o),d=[];for(const f of i)if(f.sticky)d.push(f);else break;if(d.length>0)for(const f of d)n-=f.width;let l=t,c=r??0;for(;c<=n&&l<i.length;)c+=i[l].width,l++;for(let f=t;f<l;f++){const u=i[f];u.sticky||d.push(u)}return d}function za(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function Pa(e,t,n,o,r,i,d,l,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let w=t;for(let g=0;g<f;g++){const y=i-1-g,x=typeof d=="number"?d:d(y);if(w-=x,e>=w)return y}const m=i-f,b=e-(c??0);if(typeof d=="number"){const g=Math.floor((b-u)/d)+l;return g>=m?void 0:g}else{let g=u;for(let y=l;y<m;y++){const x=d(y);if(b<=g+x)return y;g+=x}return}}let Yr=0,fr={};const La=typeof window>"u";async function Ba(){var e;La||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Yr=0,fr={},sa())}Ba();function Jl(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Uo(e,t,n,o="middle"){const r=Jl(e,t,o,n);let i=fr[r];return i===void 0&&(i=t.measureText(e),fr[r]=i,Yr++),Yr>1e4&&(fr={},Yr=0),i}function Ql(e,t){const n=Jl(e,void 0,"middle",t);return fr[n]}function Hn(e,t){return typeof t!="string"&&(t=t.baseFontFull),Wa(e,t)}function kl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Sl=[];function Wa(e,t){for(const i of Sl)if(i.key===t)return i.val;const n=kl(e,"alphabetic"),r=-(kl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Sl.push({key:t,val:r}),r}function $a(e,t,n,o,r,i){const{ctx:d,rect:l,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const w=1-f/u;d.globalAlpha=w,d.fillStyle=c.bgSearchResult,d.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),d.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function wr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},d=n??r.textDark;return d!==i.fillStyle&&(o.fillStyle=d,i.fillStyle=d),i}function _u(e,t,n,o,r){const{rect:i,ctx:d,theme:l}=e;d.fillStyle=l.textDark,Fn({ctx:d,rect:i,theme:l},t,n,o,r)}function es(e,t,n,o,r,i,d,l,c){c==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+d):c==="center"?e.fillText(t,n+r/2,o+i/2+d):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+d)}function ts(e,t){const n=Uo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Na(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Oa(e,t,n,o,r,i,d,l,c,f){const u=l.baseFontFull,w=la(e,t,u,r-l.cellHorizontalPadding*2,f??!1),m=ts(e,u),b=l.lineHeight*m,g=m+b*(w.length-1),y=g+l.cellVerticalPadding>i;y&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-g/2;let k=Math.max(o+l.cellVerticalPadding,x);for(const p of w)if(es(e,p,n,k,r,m,d,l,c),k+=b,k>o+i)break;y&&e.restore()}function Fn(e,t,n,o,r){const{ctx:i,rect:d,theme:l}=e,{x:c,y:f,width:u,height:w}=d;o=o??!1,o||(t=Na(t,u));const m=Hn(i,l),b=Xi(t)==="rtl";if(n===void 0&&b&&(n="right"),b&&(i.direction="rtl"),t.length>0){let g=!1;n==="right"?(i.textAlign="right",g=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,g=!0),o?Oa(i,t,c,f,u,w,m,l,n,r):es(i,t,c,f,u,w,m,l,n),g&&(i.textAlign="start"),b&&(i.direction="inherit")}}function Tn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Xa(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Ya(e,t,n){const o=function(l,c){const f=c.x-l.x,u=c.y-l.y,w=Math.sqrt(f*f+u*u),m=f/w,b=u/w;return{x:f,y:c.y-l.y,len:w,nx:m,ny:b,ang:Math.atan2(b,m)}};let r;const i=t.length;let d=t[i-1];for(let l=0;l<i;l++){let c=t[l%i];const f=t[(l+1)%i],u=o(c,d),w=o(c,f),m=u.nx*w.ny-u.ny*w.nx,b=u.nx*w.nx-u.ny*-w.ny;let g=Math.asin(m<-1?-1:m>1?1:m),y=1,x=!1;b<0?g<0?g=Math.PI+g:(g=Math.PI-g,y=-1,x=!0):g>0&&(y=-1,x=!0),r=c.radius!==void 0?c.radius:n;const k=g/2;let p=Math.abs(Math.cos(k)*r/Math.sin(k)),R;p>Math.min(u.len/2,w.len/2)?(p=Math.min(u.len/2,w.len/2),R=Math.abs(p*Math.sin(k)/Math.cos(k))):R=r;let W=c.x+w.nx*p,L=c.y+w.ny*p;W+=-w.ny*R*y,L+=w.nx*R*y,e.arc(W,L,R,u.ang+Math.PI/2*y,w.ang-Math.PI/2*y,x),d=c,c=f}e.closePath()}function Pi(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g){const y={x:0,y:i+f,width:0,height:0};if(e>=b.length||t>=u||t<-2||e<0)return y;const x=i-r;if(e>=w){const k=d>e?-1:1,p=Ko(b);y.x+=p+c;for(let R=d;R!==e;R+=k)y.x+=b[k===1?R:R-1].width*k}else for(let k=0;k<e;k++)y.x+=b[k].width;if(y.width=b[e].width+1,t===-1)y.y=r,y.height=x;else if(t===-2){y.y=0,y.height=r;let k=e;const p=b[e].group,R=b[e].sticky;for(;k>0&&gr(b[k-1].group,p)&&b[k-1].sticky===R;){const L=b[k-1];y.x-=L.width,y.width+=L.width,k--}let W=e;for(;W+1<b.length&&gr(b[W+1].group,p)&&b[W+1].sticky===R;){const L=b[W+1];y.width+=L.width,W++}if(!R){const L=Ko(b),A=y.x-L;A<0&&(y.x-=A,y.width+=A),y.x+y.width>n&&(y.width=n-y.x)}}else if(t>=u-m){let k=u-t;for(y.y=o;k>0;){const p=t+k-1;y.height=typeof g=="number"?g:g(p),y.y-=y.height,k--}y.height+=1}else{const k=l>t?-1:1;if(typeof g=="number"){const p=t-l;y.y+=p*g}else for(let p=l;p!==t;p+=k)y.y+=g(p)*k;y.height=(typeof g=="number"?g:g(t))+1}return y}const Yi=1<<21;function vn(e,t){return(t+2)*Yi+e}function ns(e){return e%Yi}function Gi(e){return Math.floor(e/Yi)-2}function _i(e){const t=ns(e),n=Gi(e);return[t,n]}class os{constructor(){Le(this,"visibleWindow",{x:0,y:0,width:0,height:0});Le(this,"freezeCols",0);Le(this,"freezeRows",[]);Le(this,"isInWindow",t=>{const n=ns(t),o=Gi(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,d=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&d})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Go(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Ga extends os{constructor(){super(...arguments);Le(this,"cache",new Map);Le(this,"setValue",(n,o)=>{this.cache.set(vn(n[0],n[1]),o)});Le(this,"getValue",n=>this.cache.get(vn(n[0],n[1])));Le(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Yo{constructor(t=[]){Le(this,"cells");this.cells=new Set(t.map(n=>vn(n[0],n[1])))}add(t){this.cells.add(vn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(vn(t[0],t[1]))}remove(t){this.cells.delete(vn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Gi(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(vn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield _i(t)}}function _a(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const rs={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function is(){return rs}const ls=St.createContext(rs);function Ku(){return St.useContext(ls)}function Nn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=nn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Li=150;function Ka(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Li}function ss(e,t,n,o,r,i,d,l,c){let f=0;const u=r===void 0?[]:r.map(b=>{const g=Ka(e,b[o],t,c);return f=Math.max(f,g),g});if(u.length>5&&l){f=0;let b=0;for(const y of u)b+=y;const g=b/u.length;for(let y=0;y<u.length;y++)u[y]>=g*2?u[y]=0:f=Math.max(f,u[y])}const w=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=w;const m=Math.max(Math.ceil(i),Math.min(Math.floor(d),Math.ceil(f)));return{...n,width:m}}function Ua(e,t,n,o,r,i,d,l,c){const f=s.useRef(t),u=s.useRef(n),w=s.useRef(d);f.current=t,u.current=n,w.current=d;const[m,b]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const p=document.createElement("canvas");return p.style.display="none",p.style.opacity="0",p.style.position="fixed",[p,p.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(m&&document.documentElement.append(m),()=>{m==null||m.remove()}),[m]);const g=s.useRef({}),y=s.useRef(),[x,k]=s.useState();return s.useLayoutEffect(()=>{const p=u.current;if(p===void 0||e.every($r))return;let R=Math.max(1,10-Math.floor(e.length/1e4)),W=0;R<f.current&&R>1&&(R--,W=1);const L={x:0,y:0,width:e.length,height:Math.min(f.current,R)},A={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const Y=p(L,c.signal),E=W>0?p(A,c.signal):void 0;let $;typeof Y=="object"?$=Y:$=await wl(Y),E!==void 0&&(typeof E=="object"?$=[...$,...E]:$=[...$,...await wl(E)]),y.current=e,k($)})()},[c.signal,e]),s.useMemo(()=>{let R=e.every($r)?e:b===null?e.map(z=>$r(z)?z:{...z,width:Li}):(b.font=w.current.baseFontFull,e.map((z,Y)=>{if($r(z))return z;if(g.current[z.id]!==void 0)return{...z,width:g.current[z.id]};if(x===void 0||y.current!==e||z.id===void 0)return{...z,width:Li};const E=ss(b,d,z,Y,x,r,i,!0,l);return g.current[z.id]=E.width,E})),W=0,L=0;const A=[];for(const[z,Y]of R.entries())W+=Y.width,Y.grow!==void 0&&Y.grow>0&&(L+=Y.grow,A.push(z));if(W<o&&A.length>0){const z=[...R],Y=o-W;let E=Y;for(let $=0;$<A.length;$++){const X=A[$],B=(R[X].grow??0)/L,D=$===A.length-1?E:Math.min(E,Math.floor(Y*B));z[X]={...R[X],growOffset:D,width:R[X].width+D},E-=D}R=z}return{sizedColumns:R,nonGrowWidth:W}},[o,e,b,x,d,r,i,l])}const Ct='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Va=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},qa=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},ja=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Za=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Ja=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},as=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Qa=e=>{const t=e.bgColor;return`${Ct}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},ec=as,tc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},oc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},rc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},ic=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},lc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},sc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},ac=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},cc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},dc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},uc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},fc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},hc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},gc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},mc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},wc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},bc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},yc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},pc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},vc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},Cc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},xc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),kc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),Sc={headerRowID:Va,headerNumber:ja,headerCode:qa,headerString:Za,headerBoolean:Ja,headerAudioUri:ec,headerVideoUri:tc,headerEmoji:nc,headerImage:oc,headerUri:as,headerPhone:rc,headerMarkdown:ic,headerDate:lc,headerTime:sc,headerEmail:ac,headerReference:cc,headerIfThenElse:dc,headerSingleValue:uc,headerLookup:fc,headerTextTemplate:hc,headerMath:gc,headerRollup:mc,headerJoinStrings:wc,headerSplitString:bc,headerGeoDistance:yc,headerArray:pc,rowOwnerOverlay:vc,protectedColumnOverlay:Cc,renameIcon:Qa,headerArrowDown:xc,headerArrowUp:kc};function Mc(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Rc{constructor(t,n){Le(this,"onSettled");Le(this,"spriteMap",new Map);Le(this,"headerIcons");Le(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,d,l,c=1){const[f,u]=Mc(n,l),w=d*Math.ceil(window.devicePixelRatio),m=`${f}_${u}_${w}_${t}`;let b=this.spriteMap.get(m);if(b===void 0){const g=this.headerIcons[t];if(g===void 0)return;b=document.createElement("canvas");const y=b.getContext("2d");if(y===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(g({fgColor:u,bgColor:f}))}`,this.spriteMap.set(m,b);const k=x.decode();if(k===void 0)return;this.inFlight++,k.then(()=>{y.drawImage(x,0,0,w,w)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(b,0,0,w,w,r,i,d,d),c<1&&(o.globalAlpha=1)}}function cs(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Jr(e,t,n,o,r,i,d,l,c){l=l??t;let f=t,u=e;const w=o-i;let m=!1;for(;f<n&&u<w;){const b=r(u);if(f+b>l&&c(f,u,b,!1,d&&u===o-1)===!0){m=!0;break}f+=b,u++}if(!m){f=n;for(let b=0;b<i;b++){u=o-1-b;const g=r(u);f-=g,c(f,u,g,!0,d&&u===o-1)}}}function to(e,t,n,o,r,i){let d=0,l=0;const c=r+o;for(const f of e){const u=f.sticky?l:d+n;if(i(f,u,c,f.sticky?0:l,t)===!0)break;d+=f.width,l+=f.sticky?f.width:0}}function ds(e,t,n,o,r){let i=0,d=0;for(let l=0;l<e.length;l++){const c=e[l];let f=l+1,u=c.width;for(c.sticky&&(d+=u);f<e.length&&gr(e[f].group,c.group)&&e[f].sticky===e[l].sticky;){const y=e[f];u+=y.width,f++,l++,y.sticky&&(d+=y.width)}const w=c.sticky?0:n,m=i+w,b=c.sticky?0:Math.max(0,d-m),g=Math.min(u-b,t-(m+b));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",m+b,0,g,o),i+=u}}function us(e,t,n,o,r,i,d){var m;const[l,c]=e;let f,u;const w=((m=d.find(b=>!b.sticky))==null?void 0:m.sourceIndex)??0;if(c>w){const b=Math.max(l,w);let g=t,y=o;for(let x=i.sourceIndex-1;x>=b;x--)g-=d[x].width,y+=d[x].width;for(let x=i.sourceIndex+1;x<=c;x++)y+=d[x].width;u={x:g,y:n,width:y,height:r}}if(w>l){const b=Math.min(c,w-1);let g=t,y=o;for(let x=i.sourceIndex-1;x>=l;x--)g-=d[x].width,y+=d[x].width;for(let x=i.sourceIndex+1;x<=b;x++)y+=d[x].width;f={x:g,y:n,width:y,height:r}}return[f,u]}function Ec(e,t,n,o){if(o==="any")return fs(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),ql([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,d=n-e.y+1,l=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:d,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return c===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===d?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function mr(e,t,n,o,r,i,d,l){return e<=r+d&&r<=e+n&&t<=i+l&&i<=t+o}function bo(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function fs(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function Ic(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Dc(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,d=t+4,l=n+4,c=r-e.x,f=e.x+e.width-d,u=i-e.y,w=e.y+e.height-l,m=c>0?e.x+Math.floor(c/o)*o:e.x,b=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,g=u>0?e.y+Math.floor(u/o)*o:e.y,y=w>0?e.y+e.height-Math.floor(w/o)*o:e.y+e.height;return{x:m,y:g,width:b-m,height:y-g}}function Fc(e,t,n,o,r){const[i,d,l,c]=t,[f,u,w,m]=r,{x:b,y:g,width:y,height:x}=e,k=[];if(y<=0||x<=0)return k;const p=b+y,R=g+x,W=b<i,L=g<d,A=b+y>l,z=g+x>c,Y=b>=i&&b<l||p>i&&p<=l||b<i&&p>l,E=g>=d&&g<c||R>d&&R<=c||g<d&&R>c;if(Y&&E){const X=Math.max(b,i),B=Math.max(g,d),D=Math.min(p,l),T=Math.min(R,c);k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:f,y:u,width:w-f+1,height:m-u+1}})}if(W&&L){const X=b,B=g,D=Math.min(p,i),T=Math.min(R,d);k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:0,y:0,width:f+1,height:u+1}})}if(L&&Y){const X=Math.max(b,i),B=g,D=Math.min(p,l),T=Math.min(R,d);k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:f,y:0,width:w-f+1,height:u+1}})}if(L&&A){const X=Math.max(b,l),B=g,D=p,T=Math.min(R,d);k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:w,y:0,width:n-w+1,height:u+1}})}if(W&&E){const X=b,B=Math.max(g,d),D=Math.min(p,i),T=Math.min(R,c);k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:0,y:u,width:f+1,height:m-u+1}})}if(A&&E){const X=Math.max(b,l),B=Math.max(g,d),D=p,T=Math.min(R,c);k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:w,y:u,width:n-w+1,height:m-u+1}})}if(W&&z){const X=b,B=Math.max(g,c),D=Math.min(p,i),T=R;k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:0,y:m,width:f+1,height:o-m+1}})}if(z&&Y){const X=Math.max(b,i),B=Math.max(g,c),D=Math.min(p,l),T=R;k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:f,y:m,width:w-f+1,height:o-m+1}})}if(A&&z){const X=Math.max(b,l),B=Math.max(g,c),D=p,T=R;k.push({rect:{x:X,y:B,width:D-X,height:T-B},clip:{x:w,y:m,width:n-w+1,height:o-m+1}})}return k}const Tc={kind:J.Loading,allowOverlay:!1};function Ml(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y,x,k,p,R,W,L,A,z,Y,E,$,X,B,D,T,ie,U,he,fe){let we=(R==null?void 0:R.size)??Number.MAX_SAFE_INTEGER;const Q=performance.now();let _=D.baseFontFull;e.font=_;const be={ctx:e},ee=[0,0],ge=x>0?po(c,x,f):0;let $e,K;const te=new Yo,He=new Set,je=cs(p);if(to(t,l,i,d,r,(de,Ze,ct,pe,Ae)=>{const Ie=Math.max(0,pe-Ze),pt=Ze+Ie,mt=r+1,wt=de.width-Ie,V=o-r-1;if(p.length>0){let dt=!1;for(let q=0;q<p.length;q++){const se=p[q];if(mr(pt,mt,wt,V,se.x,se.y,se.width,se.height)){dt=!0;break}}if(!dt)return}const me=()=>{e.save(),e.beginPath(),e.rect(pt,mt,wt,V),e.clip()},ve=W.columns.hasIndex(de.sourceIndex),Ee=w(de.group??"").overrideTheme,Ce=de.themeOverride===void 0&&Ee===void 0?D:Nn(D,Ee,de.themeOverride),rt=Ce.baseFontFull;rt!==_&&(_=rt,e.font=rt),me();let et;return Jr(Ae,ct,o,c,f,x,k,je,(dt,q,se,Ne,Xe)=>{var An,Kt,hn;if(q<0)return;if(ee[0]=de.sourceIndex,ee[1]=q,te.has(ee)){we--;return}if(R!==void 0&&!R.has(ee))return;if(p.length>0){let Me=!1;for(let nt=0;nt<p.length;nt++){const tt=p[nt];if(mr(Ze,dt,de.width,se,tt.x,tt.y,tt.width,tt.height)){Me=!0;break}}if(!Me)return}const Et=W.rows.hasIndex(q),It=b.hasIndex(q),Se=q<c?u(ee):Tc;let xe=Ze,ht=de.width,xt=dt,Mt=se,Bt=!1,Ht=!1;if(Se.rowspan!==void 0){const[Me,nt]=Se.rowspan,tt=`${de.sourceIndex}|${Me}`;if(He.has(tt)){we--;return}else{let Ke=dt;for(let Ge=Me;Ge<q;Ge++)Ke-=f(Ge);let Wt=0;for(let Ge=Me;Ge<nt;Ge++)Wt+=f(Ge);if(Ke<mt+V&&Ke+Wt>mt){xt=Ke,Mt=Wt,He.add(tt);for(let Ge=Me;Ge<nt;Ge++)Ge!==q&&te.add([de.sourceIndex,Ge]);Bt=!0}else{He.add(tt);for(let Ge=Me;Ge<nt;Ge++)te.add([de.sourceIndex,Ge]);we--;return}}}if(Se.span!==void 0){const[Me,nt]=Se.span,tt=`${q},${Me},${nt},${de.sticky}`;if(K===void 0&&(K=new Set),K.has(tt)){we--;return}else{const Ke=us(Se.span,Ze,dt,de.width,se,de,n),Wt=de.sticky?Ke[0]:Ke[1];!de.sticky&&Ke[0]!==void 0&&(Ht=!0),Wt!==void 0&&(xe=Wt.x,ht=Wt.width,K.add(tt),Bt=!0)}}if(Bt){e.restore(),et=void 0,e.save(),e.beginPath();const Me=Math.max(0,pe-xe);e.rect(xe+Me,xt,ht-Me,Mt),$e===void 0&&($e=[]),$e.push({x:xe+Me,y:xt,width:ht-Me,height:Mt}),e.clip()}const fn=m==null?void 0:m(q),rn=Xe&&((An=de.trailingRowOptions)==null?void 0:An.themeOverride)!==void 0?(Kt=de.trailingRowOptions)==null?void 0:Kt.themeOverride:void 0,Dt=Se.themeOverride===void 0&&fn===void 0&&rn===void 0?Ce:Nn(Ce,fn,rn,Se.themeOverride);e.beginPath();const qt=Ha(ee,Se,W);let Xt=Aa(ee,Se,W,y);const Cn=Se.span!==void 0&&W.columns.some(Me=>Se.span!==void 0&&Me>=Se.span[0]&&Me<=Se.span[1]);qt&&!g&&y?Xt=0:qt&&y&&(Xt=Math.max(Xt,1)),Cn&&Xt++,qt||(Et&&Xt++,ve&&!Xe&&Xt++);const vt=Se.kind===J.Protected?Dt.bgCellMedium:Dt.bgCell;let gt;if((Ne||vt!==D.bgCell)&&(gt=nn(vt,gt)),Xt>0||It){It&&(gt=nn(Dt.bgHeader,gt));for(let Me=0;Me<Xt;Me++)gt=nn(Dt.accentLight,gt)}else if(L!==void 0){for(const Me of L)if(Me[0]===de.sourceIndex&&Me[1]===q){gt=nn(Dt.bgSearchResult,gt);break}}if(A!==void 0)for(let Me=0;Me<A.length;Me++){const nt=A[Me],tt=nt.range;nt.style!=="solid-outline"&&tt.x<=de.sourceIndex&&de.sourceIndex<tt.x+tt.width&&tt.y<=q&&q<tt.y+tt.height&&(gt=nn(nt.color,gt))}let Ye=!1;if(R!==void 0){const Me=dt+1,tt=(Ne?Me+se-1:Math.min(Me+se-1,o-ge))-Me;(tt!==se-1||xe+1<=pe)&&(Ye=!0,e.save(),e.beginPath(),e.rect(xe+1,Me,ht-1,tt),e.clip()),gt=gt===void 0?Dt.bgCell:nn(gt,Dt.bgCell)}const At=de.sourceIndex===n.length-1,Zt=q===c-1;gt!==void 0&&(e.fillStyle=gt,et!==void 0&&(et.fillStyle=gt),R!==void 0?e.fillRect(xe+1,xt+1,ht-(At?2:1),Mt-(Zt?2:1)):e.fillRect(xe,xt,ht,Mt)),Se.style==="faded"&&(e.globalAlpha=.6);let xn;for(let Me=0;Me<E.length;Me++){const nt=E[Me];if(nt.item[0]===de.sourceIndex&&nt.item[1]===q){xn=nt;break}}if(ht>fe&&!Ht){const Me=Dt.baseFontFull;Me!==_&&(e.font=Me,_=Me);let nt=0;if(Se.rowspan!==void 0){const tt=Se.rowSpanPosition??"top";if(tt==="top")nt=se/2-Mt/2;else if(tt==="bottom"){const[Ke,Wt]=Se.rowspan,Ge=f(Wt-1);nt=Mt/2-Ge/2}}et=hs(e,Se,de.sourceIndex,q,At,Zt,xe,xt,ht,Mt,Xt>0,Dt,gt??Dt.bgCell,z,Y,(xn==null?void 0:xn.hoverAmount)??0,$,B,Q,X,et,T,ie,U,he,nt)}return Ye&&e.restore(),Se.style==="faded"&&(e.globalAlpha=1),we--,Bt&&(e.restore(),(hn=et==null?void 0:et.deprep)==null||hn.call(et,be),et=void 0,me(),_=rt,e.font=rt),we<=0}),e.restore(),we<=0}),$e!==void 0)return $e}const sr=[0,0],ar={x:0,y:0,width:0,height:0},Ri=[void 0,()=>{}];let Bi=!1;function Hc(){Bi=!0}function hs(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y,x,k,p,R,W,L,A,z,Y,E){var U,he;let $,X;x!==void 0&&x[0][0]===n&&x[0][1]===o&&($=x[1][0],X=x[1][1]);let B;sr[0]=n,sr[1]=o,ar.x=d,ar.y=l,ar.width=c,ar.height=f,Ri[0]=A.getValue(sr),Ri[1]=fe=>A.setValue(sr,fe),Bi=!1;const D={ctx:e,theme:w,col:n,row:o,cell:t,rect:ar,highlighted:u,cellFillColor:m,hoverAmount:y,frameTime:p,hoverX:$,drawState:Ri,hoverY:X,imageLoader:b,spriteManager:g,hyperWrapping:k,overrideCursor:$!==void 0?Y:void 0,requestAnimationFrame:Hc},T=$a(D,t.lastUpdated,p,W,r,i),ie=z(t);if(ie!==void 0){(W==null?void 0:W.renderer)!==ie&&((U=W==null?void 0:W.deprep)==null||U.call(W,D),W=void 0);const fe=(he=ie.drawPrep)==null?void 0:he.call(ie,D,W);e.save(),e.translate(0,E),R!==void 0&&!Oo(D.cell)?R(D,()=>ie.draw(D,t)):ie.draw(D,t),e.restore(),B=fe===void 0?void 0:{deprep:fe==null?void 0:fe.deprep,fillStyle:fe==null?void 0:fe.fillStyle,font:fe==null?void 0:fe.font,renderer:ie}}return(T||Bi)&&(L==null||L(sr)),B}function Ur(e,t,n,o,r,i,d,l,c=-20,f=-20,u=void 0,w="center",m="square",b=!1){const g=Math.floor(r+d/2),y=m==="circle"?1e4:t.roundingRadius??4;let x=Kl(u??t.checkboxMaxSize,d,t.cellVerticalPadding),k=x/2;const p=_l(w,o,i,t.cellHorizontalPadding,x),R=Gl(p,g,x),W=Ul(o+c,r+f,R);switch(n){case!0:{e.beginPath(),Tn(e,p-x/2,g-x/2,x,x,y),m==="circle"&&(k*=.8,x*=.8),e.fillStyle=b?t.bgCellMedium:l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(p-k+x/4.23,g-k+x/1.97),e.lineTo(p-k+x/2.42,g-k+x/1.44),e.lineTo(p-k+x/1.29,g-k+x/3.25),e.strokeStyle=b?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Gr:case!1:{e.beginPath(),Tn(e,p-x/2+.5,g-x/2+.5,x-1,x-1,y),e.lineWidth=1,e.strokeStyle=b?t.textLight:W?t.textDark:t.textMedium,e.stroke();break}case $i:{e.beginPath(),Tn(e,p-x/2,g-x/2,x,x,y),e.fillStyle=b?t.bgCellMedium:W?t.textMedium:t.textLight,e.fill(),m==="circle"&&(k*=.8,x*=.8),e.beginPath(),e.moveTo(p-x/3,g),e.lineTo(p+x/3,g),e.strokeStyle=b?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:hr()}}function Ac(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y,x,k,p){var E,$,X,B;const R=d+l;if(R<=0)return;e.fillStyle=w.bgHeader,e.fillRect(0,0,r,R);const W=(E=o==null?void 0:o[0])==null?void 0:E[0],L=($=o==null?void 0:o[0])==null?void 0:$[1],A=(X=o==null?void 0:o[1])==null?void 0:X[0],z=(B=o==null?void 0:o[1])==null?void 0:B[1],Y=w.headerFontFull;e.font=Y,to(t,0,i,0,R,(D,T,ie,U)=>{var He;if(x!==void 0&&!x.has([D.sourceIndex,-1]))return;const he=Math.max(0,U-T);e.save(),e.beginPath(),e.rect(T+he,l,D.width-he,d),e.clip();const fe=y(D.group??"").overrideTheme,we=D.themeOverride===void 0&&fe===void 0?w:Nn(w,fe,D.themeOverride);we.bgHeader!==w.bgHeader&&(e.fillStyle=we.bgHeader,e.fill()),we!==w&&(e.font=we.headerFontFull);const Q=u.columns.hasIndex(D.sourceIndex),_=c!==void 0||f||D.headerRowMarkerDisabled===!0,be=!_&&L===-1&&W===D.sourceIndex,ee=_?0:((He=b.find(je=>je.item[0]===D.sourceIndex&&je.item[1]===-1))==null?void 0:He.hoverAmount)??0,ge=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===D.sourceIndex,$e=Q?we.accentColor:ge?we.bgHeaderHasFocus:we.bgHeader,K=n?l:0,te=D.sourceIndex===0?0:1;Q?(e.fillStyle=$e,e.fillRect(T+te,K,D.width-te,d)):(ge||ee>0)&&(e.beginPath(),e.rect(T+te,K,D.width-te,d),ge&&(e.fillStyle=we.bgHeaderHasFocus,e.fill()),ee>0&&(e.globalAlpha=ee,e.fillStyle=we.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ws(e,T,K,D.width,d,D,Q,we,be,be?A:void 0,be?z:void 0,ge,ee,m,k,p),e.restore()}),n&&zc(e,t,r,i,l,o,w,m,b,g,y,x)}function zc(e,t,n,o,r,i,d,l,c,f,u,w){const[b,g]=(i==null?void 0:i[0])??[];let y=0;ds(t,n,o,r,(x,k,p,R,W,L)=>{if(w!==void 0&&!w.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(p,R,W,L),e.clip();const A=u(k),z=(A==null?void 0:A.overrideTheme)===void 0?d:Nn(d,A.overrideTheme),Y=g===-2&&b!==void 0&&b>=x[0]&&b<=x[1],E=Y?z.bgGroupHeaderHovered??z.bgHeaderHovered:z.bgGroupHeader??z.bgHeader;if(E!==d.bgHeader&&(e.fillStyle=E,e.fill()),e.fillStyle=z.textGroupHeader??z.textHeader,A!==void 0){let $=p;if(A.icon!==void 0&&(l.drawSprite(A.icon,"normal",e,$+8,(r-20)/2,20,z),$+=26),e.fillText(A.name,$+8,r/2+Hn(e,d.headerFontFull)),A.actions!==void 0&&Y){const X=gs({x:p,y:R,width:W,height:L},A.actions);e.beginPath();const B=X[0].x-10,D=p+W-B;e.rect(B,0,D,r);const T=e.createLinearGradient(B,0,B+D,0),ie=yo(E,0);T.addColorStop(0,ie),T.addColorStop(10/D,E),T.addColorStop(1,E),e.fillStyle=T,e.fill(),e.globalAlpha=.6;const[U,he]=(i==null?void 0:i[1])??[-1,-1];for(let fe=0;fe<A.actions.length;fe++){const we=A.actions[fe],Q=X[fe],_=bo(Q,U+p,he);_&&(e.globalAlpha=1),l.drawSprite(we.icon,"normal",e,Q.x+Q.width/2-10,Q.y+Q.height/2-10,20,z),_&&(e.globalAlpha=.6)}e.globalAlpha=1}}p!==0&&f(x[0])&&(e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,r),e.strokeStyle=d.borderColor,e.lineWidth=1,e.stroke()),e.restore(),y=p+W}),e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=d.borderColor,e.lineWidth=1,e.stroke()}const Or=30;function Pc(e,t,n,o,r){return{x:e+n-Or,y:Math.max(t,t+o/2-Or/2),width:Or,height:Math.min(Or,o)}}function gs(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,d=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:d,height:i}),o+=26;return n}function cr(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ms(e,t,n,o,r,i,d,l){var z;const c=d.cellHorizontalPadding,f=d.headerIconSize,u=Pc(n,o,r,i);let w=n+c;const m=t.icon===void 0?void 0:{x:w,y:o+(i-f)/2,width:f,height:f},b=m===void 0||t.overlayIcon===void 0?void 0:{x:m.x+9,y:m.y+6,width:18,height:18};m!==void 0&&(w+=Math.ceil(f*1.3));const g=e===void 0?((z=Ql(t.title,d.headerFontFull))==null?void 0:z.width)??0:Uo(t.title,e,d.headerFontFull).width,y=t.hasMenu===!0?35:0,x=t.indicatorIcon!==void 0?f+c:0,k=g+x,p=r-(m!==void 0?Math.ceil(f*1.3)+c:c)-y-c,R=n+(m!==void 0?Math.ceil(f*1.3)+c:c)+(p-k)/2,W={x:Math.max(w,R),y:o,width:g,height:i};let L;t.indicatorIcon!==void 0&&(L={x:W.x+g+c,y:o+(i-f)/2,width:f,height:f});const A=n+r/2;return{menuBounds:cr(u,A,l),iconBounds:cr(m,A,l),iconOverlayBounds:cr(b,A,l),textBounds:cr(W,A,l),indicatorIconBounds:cr(L,A,l)}}function Rl(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const p=i.rowMarkerChecked;p!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=w);const R=i.headerRowMarkerTheme!==void 0?Nn(l,i.headerRowMarkerTheme):l;Ur(e,R,p,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),p!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=d?l.textHeaderSelected:l.textHeader,k=i.hasMenu===!0&&(c||b&&d)&&y.menuBounds!==void 0;if(i.icon!==void 0&&y.iconBounds!==void 0){let p=d?"selected":"normal";i.style==="highlight"&&(p=d?"selected":"special"),m.drawSprite(i.icon,p,e,y.iconBounds.x,y.iconBounds.y,y.iconBounds.width,l),i.overlayIcon!==void 0&&y.iconOverlayBounds!==void 0&&m.drawSprite(i.overlayIcon,d?"selected":"special",e,y.iconOverlayBounds.x,y.iconOverlayBounds.y,y.iconOverlayBounds.width,l)}if(k&&o>35){const R=g?35:o-35,W=g?35*.7:o-35*.7,L=R/o,A=W/o,z=e.createLinearGradient(t,0,t+o,0),Y=yo(x,0);z.addColorStop(g?1:0,x),z.addColorStop(L,x),z.addColorStop(A,Y),z.addColorStop(g?0:1,Y),e.fillStyle=z}else e.fillStyle=x;if(g&&(e.textAlign="right"),y.textBounds!==void 0&&e.fillText(i.title,g?y.textBounds.x+y.textBounds.width:y.textBounds.x,n+r/2+Hn(e,l.headerFontFull)),g&&(e.textAlign="left"),i.indicatorIcon!==void 0&&y.indicatorIconBounds!==void 0&&(!k||!mr(y.menuBounds.x,y.menuBounds.y,y.menuBounds.width,y.menuBounds.height,y.indicatorIconBounds.x,y.indicatorIconBounds.y,y.indicatorIconBounds.width,y.indicatorIconBounds.height))){let p=d?"selected":"normal";i.style==="highlight"&&(p=d?"selected":"special"),m.drawSprite(i.indicatorIcon,p,e,y.indicatorIconBounds.x,y.indicatorIconBounds.y,y.indicatorIconBounds.width,l)}if(k&&y.menuBounds!==void 0){const p=y.menuBounds,R=f!==void 0&&u!==void 0&&bo(p,f+t,u+n);if(R||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===_r.Triangle){e.beginPath();const W=p.x+p.width/2-5.5,L=p.y+p.height/2-3;Ya(e,[{x:W,y:L},{x:W+11,y:L},{x:W+5.5,y:L+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===_r.Dots){e.beginPath();const W=p.x+p.width/2,L=p.y+p.height/2;Xa(e,W,L),e.fillStyle=x,e.fill()}else{const W=p.x+(p.width-l.headerIconSize)/2,L=p.y+(p.height-l.headerIconSize)/2;m.drawSprite(i.menuIcon,"normal",e,W,L,l.headerIconSize,l)}R||(e.globalAlpha=1)}}function ws(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y){const x=Xi(i.title)==="rtl",k=ms(e,i,t,n,o,r,l,x);g!==void 0?g({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:d,hoverAmount:m,isHovered:c,hasSelectedCell:w,spriteManager:b,menuBounds:(k==null?void 0:k.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>Rl(e,t,n,o,r,i,d,l,c,f,u,m,b,y,x,k)):Rl(e,t,n,o,r,i,d,l,c,f,u,m,b,y,x,k)}function Lc(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y,x,k,p){if(k!==void 0||t[t.length-1]!==n[t.length-1])return;const R=cs(x);to(t,c,d,l,i,(W,L,A,z,Y)=>{if(W!==t[t.length-1])return;L+=W.width;const E=Math.max(L,z);E>o||(e.save(),e.beginPath(),e.rect(E,i+1,1e4,r-i-1),e.clip(),Jr(Y,A,r,f,u,g,y,R,($,X,B,D)=>{if(!D&&x.length>0&&!x.some(fe=>mr(L,$,1e4,B,fe.x,fe.y,fe.width,fe.height)))return;const T=m.hasIndex(X),ie=b.hasIndex(X);e.beginPath();const U=w==null?void 0:w(X),he=U===void 0?p:Nn(p,U);he.bgCell!==p.bgCell&&(e.fillStyle=he.bgCell,e.fillRect(L,$,1e4,B)),ie&&(e.fillStyle=he.bgHeader,e.fillRect(L,$,1e4,B)),T&&(e.fillStyle=he.accentLight,e.fillRect(L,$,1e4,B))}),e.restore())})}function Bc(e,t,n,o,r,i,d,l,c){let f=!1;for(const g of t)if(!g.sticky){f=d(g.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,w=c.borderColor,m=f?Ko(t):0;let b;if(m!==0&&(b=Cl(w,c.bgCell),e.beginPath(),e.moveTo(m+.5,0),e.lineTo(m+.5,o),e.strokeStyle=b,e.stroke()),r>0){const g=w===u&&b!==void 0?b:Cl(u,c.bgCell),y=po(i,r,l);e.beginPath(),e.moveTo(0,o-y+.5),e.lineTo(n,o-y+.5),e.strokeStyle=g,e.stroke()}}const bs=(e,t,n)=>{let o=0,r=t,i=0,d=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),d=Math.max(d,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:d}};function Wc(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g){var B;const y=g.bgCell,{minX:x,maxX:k,minY:p,maxY:R}=bs(l,i,d),W=[],L=d-po(b,m,f);let A=c,z=n,Y=0;for(;A+r<L;){const D=A+r,T=f(z);if(D>=p&&D<=R-1){const ie=u==null?void 0:u(z),U=ie==null?void 0:ie.bgCell;U!==void 0&&U!==y&&z>=b-m&&W.push({x,y:D,w:k-x,h:T,color:U})}A+=T,z<b-m&&(Y=A),z++}let E=0;const $=Math.min(L,R)-Y;if($>0)for(let D=0;D<t.length;D++){const T=t[D];if(T.width===0)continue;const ie=T.sticky?E:E+o,U=(B=T.themeOverride)==null?void 0:B.bgCell;U!==void 0&&U!==y&&ie>=x&&ie<=k&&w(D+1)&&W.push({x:ie,y:Y,w:T.width,h:$,color:U}),E+=T.width}if(W.length===0)return;let X;e.beginPath();for(let D=W.length-1;D>=0;D--){const T=W[D];X===void 0?X=T.color:T.color!==X&&(e.fillStyle=X,e.fill(),e.beginPath(),X=T.color),e.rect(T.x,T.y,T.w,T.h)}X!==void 0&&(e.fillStyle=X,e.fill()),e.beginPath()}function El(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y,x,k=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,d);for(const B of c)e.rect(B.x+1,B.y+1,B.width-1,B.height-1);e.clip("evenodd")}const p=x.horizontalBorderColor??x.borderColor,R=x.borderColor,{minX:W,maxX:L,minY:A,maxY:z}=bs(l,i,d),Y=[];e.beginPath();let E=.5;for(let B=0;B<t.length;B++){const D=t[B];if(D.width===0)continue;E+=D.width;const T=D.sticky?E:E+o;T>=W&&T<=L&&b(B+1)&&Y.push({x1:T,y1:Math.max(f,A),x2:T,y2:Math.min(d,z),color:R})}let $=d+.5;for(let B=y-g;B<y;B++){const D=w(B);$-=D,Y.push({x1:W,y1:$,x2:L,y2:$,color:p})}if(k!==!0){let B=u+.5,D=n;const T=$;for(;B+r<T;){const ie=B+r;if(ie>=A&&ie<=z-1){const U=m==null?void 0:m(D);Y.push({x1:W,y1:ie,x2:L,y2:ie,color:(U==null?void 0:U.horizontalBorderColor)??(U==null?void 0:U.borderColor)??p})}B+=w(D),D++}}const X=aa(Y,B=>B.color);for(const B of Object.keys(X)){e.strokeStyle=B;for(const D of X[B])e.moveTo(D.x1,D.y1),e.lineTo(D.x2,D.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function $c(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y,x,k,p){const R=[];e.imageSmoothingEnabled=!1;const W=Math.min(r.cellYOffset,d),L=Math.max(r.cellYOffset,d);let A=0;if(typeof k=="number")A+=(L-W)*k;else for(let T=W;T<L;T++)A+=k(T);d>r.cellYOffset&&(A=-A),A+=c-r.translateY;const z=Math.min(r.cellXOffset,i),Y=Math.max(r.cellXOffset,i);let E=0;for(let T=z;T<Y;T++)E+=y[T].width;i>r.cellXOffset&&(E=-E),E+=l-r.translateX;const $=Ko(x);if(E!==0&&A!==0)return{regions:[]};const X=f>0?po(m,f,k):0,B=u-$-Math.abs(E),D=w-b-X-Math.abs(A)-1;if(B>150&&D>150){const T={sx:0,sy:0,sw:u*g,sh:w*g,dx:0,dy:0,dw:u*g,dh:w*g};if(A>0?(T.sy=(b+1)*g,T.sh=D*g,T.dy=(A+b+1)*g,T.dh=D*g,R.push({x:0,y:b,width:u,height:A+1})):A<0&&(T.sy=(-A+b+1)*g,T.sh=D*g,T.dy=(b+1)*g,T.dh=D*g,R.push({x:0,y:w+A-X,width:u,height:-A+X})),E>0?(T.sx=$*g,T.sw=B*g,T.dx=(E+$)*g,T.dw=B*g,R.push({x:$-1,y:0,width:E+2,height:w})):E<0&&(T.sx=($-E)*g,T.sw=B*g,T.dx=$*g,T.dw=B*g,R.push({x:u+E,y:0,width:-E,height:w})),e.setTransform(1,0,0,1,0,0),p){if($>0&&E!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const ie=$*g,U=w*g;e.drawImage(t,0,0,ie,U,0,0,ie,U)}if(X>0&&E===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const ie=(w-X)*g,U=u*g,he=X*g;e.drawImage(t,0,ie,U,he,0,ie,U,he)}}e.drawImage(t,T.sx,T.sy,T.sw,T.sh,T.dx,T.dy,T.dw,T.dh),e.scale(g,g)}return e.imageSmoothingEnabled=!0,{regions:R}}function Nc(e,t,n,o,r,i,d,l,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||to(c,n,o,r,l,(w,m,b,g)=>{if(w.sourceIndex===f){const y=Math.max(m,g)+1;return u.push({x:y,y:0,width:i-y,height:d}),!0}}),u}function Oc(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Go(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:d,...l}=r,{width:c,...f}=i;if(!Go(l,f))return!1;n=o}return n===void 0?!0:n}return!0}function Il(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y){const x=g==null?void 0:g.filter(z=>z.style!=="no-outline");if(x===void 0||x.length===0)return;const k=Ko(l),p=po(b,m,w),R=[c,0,l.length,b-m],W=[k,0,t,n-p],L=x.map(z=>{const Y=z.range,E=z.style??"dashed";return Fc(Y,R,t,n,W).map($=>{const X=$.rect,B=Pi(X.x,X.y,t,n,u,f+u,o,r,i,d,b,c,m,l,w),D=X.width===1&&X.height===1?B:Pi(X.x+X.width-1,X.y+X.height-1,t,n,u,f+u,o,r,i,d,b,c,m,l,w);return X.x+X.width>=l.length&&(D.width-=1),X.y+X.height>=b&&(D.height-=1),{color:z.color,style:E,clip:$.clip,rect:Dc({x:B.x,y:B.y,width:D.x+D.width-B.x,height:D.y+D.height-B.y},t,n,8)}})}),A=()=>{e.lineWidth=1;let z=!1;for(const Y of L)for(const E of Y)if((E==null?void 0:E.rect)!==void 0&&mr(0,0,t,n,E.rect.x,E.rect.y,E.rect.width,E.rect.height)){const $=z,X=!Ic(E.clip,E.rect);e.beginPath(),X&&(e.save(),e.rect(E.clip.x,E.clip.y,E.clip.width,E.clip.height),e.clip()),E.style==="dashed"&&!z?(e.setLineDash([5,3]),z=!0):(E.style==="solid"||E.style==="solid-outline")&&z&&(e.setLineDash([]),z=!1),e.strokeStyle=E.style==="solid-outline"?nn(nn(E.color,y.borderColor),y.bgCell):yo(E.color,1),e.closePath(),e.strokeRect(E.rect.x+.5,E.rect.y+.5,E.rect.width-1,E.rect.height-1),X&&(e.restore(),z=$)}z&&e.setLineDash([])};return A(),A}function Dl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Ei(e,t,n,o,r,i,d,l,c,f,u,w,m,b,g,y,x){if(u.current===void 0)return;const k=y!==!1&&y!==void 0;if(!k)return;const p=typeof y=="object"?{...Kr,...y}:Kr,R=u.current.range,W=u.current.cell,L=[R.x+R.width-1,R.y+R.height-1];if(W[1]>=x&&L[1]>=x||!d.some(U=>U.sourceIndex===W[0]||U.sourceIndex===L[0]))return;const[z,Y]=u.current.cell,E=m(u.current.cell),$=E.span??[z,z],X=Y>=x-b,B=b>0&&!X?po(x,b,w)-1:0,D=L[1];let T;if(to(d,o,r,i,f,(U,he,fe,we,Q)=>{if(U.sticky&&z>U.sourceIndex)return;const _=U.sourceIndex<$[0],be=U.sourceIndex>$[1],ee=U.sourceIndex===L[0];if(!(!ee&&(_||be)))return Jr(Q,fe,n,x,w,b,g,void 0,(ge,$e,K)=>{if($e!==Y&&$e!==D)return;let te=he,He=U.width;if(E.span!==void 0){const de=us(E.span,he,ge,U.width,K,U,l),Ze=U.sticky?de[0]:de[1];Ze!==void 0&&(te=Ze.x,He=Ze.width)}return $e===D&&ee&&k&&(T=()=>{var Ae;we>te&&!U.sticky&&(e.beginPath(),e.rect(we,0,t-we,n),e.clip());const de=p.size,Ze=de/2,ct=te+He+p.offsetX-Ze+.5,pe=ge+K+p.offsetY-Ze+.5;e.beginPath(),p.shape==="circle"?e.arc(ct+Ze,pe+Ze,Ze,0,Math.PI*2):e.rect(ct,pe,de,de),e.fillStyle=((Ae=U.themeOverride)==null?void 0:Ae.accentColor)??c.accentColor,e.fill(),p.outline>0&&(e.lineWidth=p.outline,e.strokeStyle=c.bgCell,p.shape==="circle"?(e.beginPath(),e.arc(ct+Ze,pe+Ze,Ze+p.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(ct-p.outline/2,pe-p.outline/2,de+p.outline,de+p.outline))}),T!==void 0}),T!==void 0}),T===void 0)return;const ie=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-B),e.clip(),T==null||T(),e.restore()};return ie(),ie}function Xc(e,t,n,o,r,i,d,l,c){c===void 0||c.size===0||(e.beginPath(),ds(t,n,i,o,(f,u,w,m,b,g)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(w,m,b,g)}),to(t,l,i,d,r,(f,u,w,m)=>{const b=Math.max(0,m-u),g=u+b+1,y=f.width-b-1;c.has([f.sourceIndex,-1])&&e.rect(g,o,y,r-o)}),e.clip())}function Yc(e,t,n,o,r,i,d,l,c,f){let u=0;return to(e,i,o,r,n,(w,m,b,g,y)=>(Jr(y,b,t,d,l,c,f,void 0,(x,k,p,R)=>{R||(u=Math.max(k,u))}),!0)),u}function Fl(e,t){var Cn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:d,cellYOffset:l,translateX:c,translateY:f,mappedColumns:u,enableGroups:w,freezeColumns:m,dragAndDropState:b,theme:g,drawFocus:y,headerHeight:x,groupHeaderHeight:k,disabledRows:p,rowHeight:R,verticalBorder:W,overrideCursor:L,isResizing:A,selection:z,fillHandle:Y,freezeTrailingRows:E,rows:$,getCellContent:X,getGroupDetails:B,getRowThemeOverride:D,isFocused:T,drawHeaderCallback:ie,prelightCells:U,drawCellCallback:he,highlightRegions:fe,resizeCol:we,imageLoader:Q,lastBlitData:_,hoverValues:be,hyperWrapping:ee,hoverInfo:ge,spriteManager:$e,maxScaleFactor:K,hasAppendRow:te,touchMode:He,enqueue:je,renderStateProvider:de,getCellRenderer:Ze,renderStrategy:ct,bufferACtx:pe,bufferBCtx:Ae,damage:Ie,minimumCellWidth:pt,resizeIndicator:mt}=e;if(r===0||i===0)return;const wt=ct==="double-buffer",V=Math.min(K,Math.ceil(window.devicePixelRatio??1)),me=ct!=="direct"&&Oc(e,t),ve=n.canvas;(ve.width!==r*V||ve.height!==i*V)&&(ve.width=r*V,ve.height=i*V,ve.style.width=r+"px",ve.style.height=i+"px");const Ee=o.canvas,Ce=w?k+x:x,rt=Ce+1;(Ee.width!==r*V||Ee.height!==rt*V)&&(Ee.width=r*V,Ee.height=rt*V,Ee.style.width=r+"px",Ee.style.height=rt+"px");const et=pe.canvas,dt=Ae.canvas;wt&&(et.width!==r*V||et.height!==i*V)&&(et.width=r*V,et.height=i*V,_.current!==void 0&&(_.current.aBufferScroll=void 0)),wt&&(dt.width!==r*V||dt.height!==i*V)&&(dt.width=r*V,dt.height=i*V,_.current!==void 0&&(_.current.bBufferScroll=void 0));const q=_.current;if(me===!0&&d===(q==null?void 0:q.cellXOffset)&&l===(q==null?void 0:q.cellYOffset)&&c===(q==null?void 0:q.translateX)&&f===(q==null?void 0:q.translateY))return;let se=null;wt&&(se=n);const Ne=o;let Xe;wt?Ie!==void 0?Xe=(q==null?void 0:q.lastBuffer)==="b"?Ae:pe:Xe=(q==null?void 0:q.lastBuffer)==="b"?pe:Ae:Xe=n;const Et=Xe.canvas,It=wt?Et===et?dt:et:ve,Se=typeof R=="number"?()=>R:R;Ne.save(),Xe.save(),Ne.beginPath(),Xe.beginPath(),Ne.textBaseline="middle",Xe.textBaseline="middle",V!==1&&(Ne.scale(V,V),Xe.scale(V,V));const xe=zi(u,d,r,b,c);let ht=[];const xt=y&&((Cn=z.current)==null?void 0:Cn.cell[1])===l&&f===0;let Mt=!1;if(fe!==void 0){for(const vt of fe)if(vt.style!=="no-outline"&&vt.range.y===l&&f===0){Mt=!0;break}}const Bt=()=>{Ac(Ne,xe,w,ge,r,c,x,k,b,A,z,g,$e,be,W,B,Ie,ie,He),El(Ne,xe,l,c,f,r,i,void 0,void 0,k,Ce,Se,D,W,E,$,g,!0),Ne.beginPath(),Ne.moveTo(0,rt-.5),Ne.lineTo(r,rt-.5),Ne.strokeStyle=nn(g.headerBottomBorderColor??g.horizontalBorderColor??g.borderColor,g.bgHeader),Ne.stroke(),Mt&&Il(Ne,r,i,d,l,c,f,u,m,x,k,R,E,$,fe,g),xt&&Ei(Ne,r,i,l,c,f,xe,u,g,Ce,z,Se,X,E,te,Y,$)};if(Ie!==void 0){const vt=xe[xe.length-1].sourceIndex+1,gt=Ie.hasItemInRegion([{x:d,y:-2,width:vt,height:2},{x:d,y:l,width:vt,height:300},{x:0,y:l,width:m,height:300},{x:0,y:-2,width:m,height:2},{x:d,y:$-E,width:vt,height:E,when:E>0}]),Ye=At=>{Ml(At,xe,u,i,Ce,c,f,l,$,Se,X,B,D,p,T,y,E,te,ht,Ie,z,U,fe,Q,$e,be,ge,he,ee,g,je,de,Ze,L,pt);const Zt=z.current;Y!==!1&&Y!==void 0&&y&&Zt!==void 0&&Ie.has(jl(Zt.range))&&Ei(At,r,i,l,c,f,xe,u,g,Ce,z,Se,X,E,te,Y,$)};gt&&(Ye(Xe),se!==null&&(se.save(),se.scale(V,V),se.textBaseline="middle",Ye(se),se.restore()),Ie.hasHeader()&&(Xc(Ne,xe,r,k,Ce,c,f,l,Ie),Bt())),Xe.restore(),Ne.restore();return}if((me!==!0||d!==(q==null?void 0:q.cellXOffset)||c!==(q==null?void 0:q.translateX)||xt!==(q==null?void 0:q.mustDrawFocusOnHeader)||Mt!==(q==null?void 0:q.mustDrawHighlightRingsOnHeader))&&Bt(),me===!0){tn(It!==void 0&&q!==void 0);const{regions:vt}=$c(Xe,It,It===et?q.aBufferScroll:q.bBufferScroll,It===et?q.bBufferScroll:q.aBufferScroll,q,d,l,c,f,E,r,i,$,Ce,V,u,xe,R,wt);ht=vt}else me!==!1&&(tn(q!==void 0),ht=Nc(q,d,l,c,f,r,i,Ce,xe,me));Bc(Xe,xe,r,i,E,$,W,Se,g);const Ht=Il(Xe,r,i,d,l,c,f,u,m,x,k,R,E,$,fe,g),fn=y?Ei(Xe,r,i,l,c,f,xe,u,g,Ce,z,Se,X,E,te,Y,$):void 0;if(Xe.fillStyle=g.bgCell,ht.length>0){Xe.beginPath();for(const vt of ht)Xe.rect(vt.x,vt.y,vt.width,vt.height);Xe.clip(),Xe.fill(),Xe.beginPath()}else Xe.fillRect(0,0,r,i);const rn=Ml(Xe,xe,u,i,Ce,c,f,l,$,Se,X,B,D,p,T,y,E,te,ht,Ie,z,U,fe,Q,$e,be,ge,he,ee,g,je,de,Ze,L,pt);Lc(Xe,xe,u,r,i,Ce,c,f,l,$,Se,D,z.rows,p,E,te,ht,Ie,g),Wc(Xe,xe,l,c,f,r,i,ht,Ce,Se,D,W,E,$,g),El(Xe,xe,l,c,f,r,i,ht,rn,k,Ce,Se,D,W,E,$,g),Ht==null||Ht(),fn==null||fn(),A&&mt!=="none"&&to(xe,0,c,0,Ce,(vt,gt)=>vt.sourceIndex===we?(Dl(Ne,gt+vt.width,0,Ce+1,nn(g.resizeIndicatorColor??g.accentLight,g.bgHeader)),mt==="full"&&Dl(Xe,gt+vt.width,Ce,i,nn(g.resizeIndicatorColor??g.accentLight,g.bgCell)),!0):!1),se!==null&&(se.fillStyle=g.bgCell,se.fillRect(0,0,r,i),se.drawImage(Xe.canvas,0,0));const Dt=Yc(xe,i,Ce,c,f,l,$,Se,E,te);Q==null||Q.setWindow({x:d,y:l,width:xe.length,height:Dt-l},m,Array.from({length:E},(vt,gt)=>$-1-gt));const qt=q!==void 0&&(d!==q.cellXOffset||c!==q.translateX),Xt=q!==void 0&&(l!==q.cellYOffset||f!==q.translateY);_.current={cellXOffset:d,cellYOffset:l,translateX:c,translateY:f,mustDrawFocusOnHeader:xt,mustDrawHighlightRingsOnHeader:Mt,lastBuffer:wt?Et===et?"a":"b":void 0,aBufferScroll:Et===et?[qt,Xt]:q==null?void 0:q.aBufferScroll,bBufferScroll:Et===dt?[qt,Xt]:q==null?void 0:q.bBufferScroll},Xe.restore(),Ne.restore()}const Gc=80;function _c(e){const t=e-1;return t*t*t+1}class Kc{constructor(t){Le(this,"callback");Le(this,"currentHoveredItem");Le(this,"leavingItems",[]);Le(this,"lastAnimationTime");Le(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>ur(o.item,t.item))||this.leavingItems.push(t)});Le(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>ur(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Le(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Le(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Le(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:_c(t.hoverAmount)})));Le(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Gc;for(const i of this.leavingItems)i.hoverAmount=un(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=un(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Le(this,"setHovered",t=>{var n;if(!ur((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Uc{constructor(t){Le(this,"fn");Le(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Ki(e){return new Uc(e)}const Vc=Ki(()=>window.navigator.userAgent.includes("Firefox")),Vr=Ki(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),qr=Ki(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function qc(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(d),d=()=>{const l=t.current.map(_i);t.current=[],o.current(new Yo(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:d)},[]);return s.useCallback(i=>{t.current.length===0&&r();const d=vn(i[0],i[1]);t.current.includes(d)||t.current.push(d)},[r])}const eo="header",pn="group-header",jr="out-of-bounds";var Xo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Xo||(Xo={}));function ys(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const jc=(e,t)=>{if(e.kind===J.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Zc=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:d,cellYOffset:l,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:w,rows:m,getCellContent:b,getRowThemeOverride:g,onHeaderMenuClick:y,onHeaderIndicatorClick:x,enableGroups:k,isFilling:p,onCanvasFocused:R,onCanvasBlur:W,isFocused:L,selection:A,freezeColumns:z,onContextMenu:Y,freezeTrailingRows:E,fixedShadowX:$=!0,fixedShadowY:X=!0,drawFocusRing:B,onMouseDown:D,onMouseUp:T,onMouseMoveRaw:ie,onMouseMove:U,onItemHovered:he,dragAndDropState:fe,firstColAccessible:we,onKeyDown:Q,onKeyUp:_,highlightRegions:be,canvasRef:ee,onDragStart:ge,onDragEnd:$e,eventTargetRef:K,isResizing:te,resizeColumn:He,isDragging:je,isDraggable:de=!1,allowResize:Ze,disabledRows:ct,hasAppendRow:pe,getGroupDetails:Ae,theme:Ie,prelightCells:pt,headerIcons:mt,verticalBorder:wt,drawCell:V,drawHeader:me,onCellFocused:ve,onDragOverCell:Ee,onDrop:Ce,onDragLeave:rt,imageWindowLoader:et,smoothScrollX:dt=!1,smoothScrollY:q=!1,experimental:se,getCellRenderer:Ne,resizeIndicator:Xe="full"}=e,Et=e.translateX??0,It=e.translateY??0,Se=Math.max(z,Math.min(i.length-1,d)),xe=s.useRef(null),ht=s.useRef((se==null?void 0:se.eventTarget)??window),xt=ht.current,Mt=et,Bt=s.useRef(),[Ht,fn]=s.useState(!1),rn=s.useRef([]),Dt=s.useRef(),[qt,Xt]=s.useState(),[Cn,vt]=s.useState(),gt=s.useRef(null),[Ye,At]=s.useState(),[Zt,xn]=s.useState(!1),An=s.useRef(Zt);An.current=Zt;const Kt=s.useMemo(()=>new Rc(mt,()=>{Co.current=void 0,no.current()}),[mt]),hn=k?u+c:c,Me=s.useRef(-1),nt=((se==null?void 0:se.enableFirefoxRescaling)??!1)&&Vc.value,tt=((se==null?void 0:se.enableSafariRescaling)??!1)&&Vr.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!nt&&!tt||(Me.current!==-1&&fn(!0),window.clearTimeout(Me.current),Me.current=window.setTimeout(()=>{fn(!1),Me.current=-1},200))},[l,Se,Et,It,nt,tt]);const Ke=Fa(i,z),Wt=s.useMemo(()=>$?Ko(Ke,fe):0,[Ke,fe,$]),Ge=s.useCallback((h,O,le)=>{const ue=h.getBoundingClientRect();if(O>=Ke.length||le>=m)return;const Z=ue.width/n,ae=Pi(O,le,n,o,u,hn,Se,l,Et,It,m,z,E,Ke,w);return Z!==1&&(ae.x*=Z,ae.y*=Z,ae.width*=Z,ae.height*=Z),ae.x+=ue.x,ae.y+=ue.y,ae},[n,o,u,hn,Se,l,Et,It,m,z,E,Ke,w]),Ue=s.useCallback((h,O,le,ue)=>{const Z=h.getBoundingClientRect(),ae=Z.width/n,De=(O-Z.left)/ae,Je=(le-Z.top)/ae,S=5,it=zi(Ke,Se,n,void 0,Et);let oe=0,lt=0;const bt=typeof PointerEvent<"u"&&ue instanceof PointerEvent&&ue.pointerType==="mouse"||typeof MouseEvent<"u"&&ue instanceof MouseEvent,st=typeof PointerEvent<"u"&&ue instanceof PointerEvent&&ue.pointerType==="touch"||typeof TouchEvent<"u"&&ue instanceof TouchEvent;bt&&(oe=ue.button,lt=ue.buttons);const Ve=za(De,it,Et),yt=Pa(Je,o,k,c,u,m,w,l,It,E),Tt=(ue==null?void 0:ue.shiftKey)===!0,wn=(ue==null?void 0:ue.ctrlKey)===!0,Rn=(ue==null?void 0:ue.metaKey)===!0,an=[De<0?-1:n<De?1:0,Je<hn?-1:o<Je?1:0];let Ot;if(Ve===-1||Je<0||De<0||yt===void 0||De>n||Je>o){const Fe=De>n?1:De<0?-1:0,kt=Je>o?1:Je<0?-1:0;let ut=Fe*2,zt=kt*2;Fe===0&&(ut=Ve===-1?Xo.EndPadding:Xo.Center),kt===0&&(zt=yt===void 0?Xo.EndPadding:Xo.Center);let En=!1;if(Ve===-1&&yt===-1){const $n=Ge(h,Ke.length-1,-1);tn($n!==void 0),En=O<$n.x+$n.width+S}const so=De>n&&De<n+Ai()||Je>o&&Je<o+Ai();Ot={kind:jr,location:[Ve!==-1?Ve:De<0?0:Ke.length-1,yt??m-1],region:[ut,zt],shiftKey:Tt,ctrlKey:wn,metaKey:Rn,isEdge:En,isTouch:st,button:oe,buttons:lt,scrollEdge:an,isMaybeScrollbar:so}}else if(yt<=-1){let Fe=Ge(h,Ve,yt);tn(Fe!==void 0);let kt=Fe!==void 0&&Fe.x+Fe.width-O<=S;const ut=Ve-1;O-Fe.x<=S&&ut>=0?(kt=!0,Fe=Ge(h,ut,yt),tn(Fe!==void 0),Ot={kind:k&&yt===-2?pn:eo,location:[ut,yt],bounds:Fe,group:Ke[ut].group??"",isEdge:kt,shiftKey:Tt,ctrlKey:wn,metaKey:Rn,isTouch:st,localEventX:O-Fe.x,localEventY:le-Fe.y,button:oe,buttons:lt,scrollEdge:an}):Ot={kind:k&&yt===-2?pn:eo,group:Ke[Ve].group??"",location:[Ve,yt],bounds:Fe,isEdge:kt,shiftKey:Tt,ctrlKey:wn,metaKey:Rn,isTouch:st,localEventX:O-Fe.x,localEventY:le-Fe.y,button:oe,buttons:lt,scrollEdge:an}}else{const Fe=Ge(h,Ve,yt);tn(Fe!==void 0);const kt=Fe!==void 0&&Fe.x+Fe.width-O<S;let ut=!1;if(f!==!1&&f!==void 0&&A.current!==void 0){const En=typeof f=="object"?{...Kr,...f}:Kr,so=En.size,$n=so/2,$t=jl(A.current.range),Nt=Ge(h,$t[0],$t[1]);if(Nt!==void 0){const Mr=Nt.x+Nt.width+En.offsetX-$n+.5,Jo=Nt.y+Nt.height+En.offsetY-$n+.5;ut=Math.abs(Mr-O)<so&&Math.abs(Jo-le)<so}}Ot={kind:"cell",location:[Ve,yt],bounds:Fe,isEdge:kt,shiftKey:Tt,ctrlKey:wn,isFillHandle:ut,metaKey:Rn,isTouch:st,localEventX:O-Fe.x,localEventY:le-Fe.y,button:oe,buttons:lt,scrollEdge:an}}return Ot},[n,Ke,Se,Et,o,k,c,u,m,w,l,It,E,Ge,f,A,hn]),[zn]=qt??[],br=s.useRef(()=>{}),On=s.useRef(qt);On.current=qt;const[Pn,Ln]=s.useMemo(()=>{const h=document.createElement("canvas"),O=document.createElement("canvas");return h.style.display="none",h.style.opacity="0",h.style.position="fixed",O.style.display="none",O.style.opacity="0",O.style.position="fixed",[h.getContext("2d",{alpha:!1}),O.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(Pn===null||Ln===null))return document.documentElement.append(Pn.canvas),document.documentElement.append(Ln.canvas),()=>{Pn.canvas.remove(),Ln.canvas.remove()}},[Pn,Ln]);const vo=s.useMemo(()=>new Ga,[]),yr=nt&&Ht?1:tt&&Ht?2:5,Xn=(se==null?void 0:se.disableMinimumCellWidth)===!0?1:10,Co=s.useRef(),xo=s.useRef(null),ko=s.useRef(null),So=s.useCallback(()=>{var De;const h=xe.current,O=gt.current;if(h===null||O===null||(xo.current===null&&(xo.current=h.getContext("2d",{alpha:!1}),h.width=0,h.height=0),ko.current===null&&(ko.current=O.getContext("2d",{alpha:!1}),O.width=0,O.height=0),xo.current===null||ko.current===null||Pn===null||Ln===null))return;let le=!1;const ue=Je=>{le=!0,At(Je)},Z=Co.current,ae={headerCanvasCtx:ko.current,canvasCtx:xo.current,bufferACtx:Pn,bufferBCtx:Ln,width:n,height:o,cellXOffset:Se,cellYOffset:l,translateX:Math.round(Et),translateY:Math.round(It),mappedColumns:Ke,enableGroups:k,freezeColumns:z,dragAndDropState:fe,theme:Ie,headerHeight:c,groupHeaderHeight:u,disabledRows:ct??ot.empty(),rowHeight:w,verticalBorder:wt,isResizing:te,resizeCol:He,isFocused:L,selection:A,fillHandle:f,drawCellCallback:V,hasAppendRow:pe,overrideCursor:ue,maxScaleFactor:yr,freezeTrailingRows:E,rows:m,drawFocus:B,getCellContent:b,getGroupDetails:Ae??(Je=>({name:Je})),getRowThemeOverride:g,drawHeaderCallback:me,prelightCells:pt,highlightRegions:be,imageLoader:Mt,lastBlitData:Dt,damage:Bt.current,hoverValues:rn.current,hoverInfo:On.current,spriteManager:Kt,scrolling:Ht,hyperWrapping:(se==null?void 0:se.hyperWrapping)??!1,touchMode:Zt,enqueue:br.current,renderStateProvider:vo,renderStrategy:(se==null?void 0:se.renderStrategy)??(Vr.value?"double-buffer":"single-buffer"),getCellRenderer:Ne,minimumCellWidth:Xn,resizeIndicator:Xe};ae.damage===void 0?(Co.current=ae,Fl(ae,Z)):Fl(ae,void 0),!le&&(ae.damage===void 0||ae.damage.has((De=On==null?void 0:On.current)==null?void 0:De[0]))&&At(void 0)},[Pn,Ln,n,o,Se,l,Et,It,Ke,k,z,fe,Ie,c,u,ct,w,wt,te,pe,He,L,A,f,E,m,B,yr,b,Ae,g,V,me,pt,be,Mt,Kt,Ht,se==null?void 0:se.hyperWrapping,se==null?void 0:se.renderStrategy,Zt,vo,Ne,Xn,Xe]),no=s.useRef(So);s.useLayoutEffect(()=>{So(),no.current=So},[So]),s.useLayoutEffect(()=>{(async()=>{var O;((O=document==null?void 0:document.fonts)==null?void 0:O.ready)!==void 0&&(await document.fonts.ready,Co.current=void 0,no.current())})()},[]);const Bn=s.useCallback(h=>{Bt.current=h,no.current(),Bt.current=void 0},[]),Qr=qc(Bn);br.current=Qr;const pr=s.useCallback(h=>{Bn(new Yo(h.map(O=>O.cell)))},[Bn]);Mt.setCallback(Bn);const[ei,ti]=s.useState(!1),[kn,Yn]=zn??[],ni=kn!==void 0&&Yn===-1&&kn>=0&&kn<Ke.length&&Ke[kn].headerRowMarkerDisabled!==!0,oi=kn!==void 0&&Yn===-2;let Mo=!1,vr=!1,oo=Ye;if(oo===void 0&&kn!==void 0&&Yn!==void 0&&Yn>-1&&Yn<m){const h=b([kn,Yn],!0);Mo=h.kind===_t.NewRow||h.kind===_t.Marker&&h.markerKind!=="number",vr=h.kind===J.Boolean&&Ni(h),oo=h.cursor}const Cr=je?"grabbing":(Cn??!1)||te?"col-resize":ei||p?"crosshair":oo!==void 0?oo:ni||Mo||vr||oi?"pointer":"default",Sn=s.useMemo(()=>({contain:"strict",display:"block",cursor:Cr}),[Cr]),ro=s.useRef("default"),Ro=K==null?void 0:K.current;Ro!=null&&ro.current!==Sn.cursor&&(Ro.style.cursor=ro.current=Sn.cursor);const Pe=s.useCallback((h,O,le,ue)=>{if(Ae===void 0)return;const Z=Ae(h);if(Z.actions!==void 0){const ae=gs(O,Z.actions);for(const[De,Je]of ae.entries())if(bo(Je,le+O.x,ue+Je.y))return Z.actions[De]}},[Ae]),Gn=s.useCallback((h,O,le,ue)=>{const Z=Ke[O];if(!je&&!te&&!(Cn??!1)){const ae=Ge(h,O,-1);tn(ae!==void 0);const De=ms(void 0,Z,ae.x,ae.y,ae.width,ae.height,Ie,Xi(Z.title)==="rtl");if(Z.hasMenu===!0&&De.menuBounds!==void 0&&bo(De.menuBounds,le,ue))return{area:"menu",bounds:De.menuBounds};if(Z.indicatorIcon!==void 0&&De.indicatorIconBounds!==void 0&&bo(De.indicatorIconBounds,le,ue))return{area:"indicator",bounds:De.indicatorIconBounds}}},[Ke,Ge,Cn,je,te,Ie]),_n=s.useRef(0),Ut=s.useRef(),Yt=s.useRef(!1),ii=s.useCallback(h=>{const O=xe.current,le=K==null?void 0:K.current;if(O===null||h.target!==O&&h.target!==le)return;Yt.current=!0;const ue=h.clientX,Z=h.clientY;if(h.target===le&&le!==null){const De=le.getBoundingClientRect();if(ue>De.right||Z>De.bottom)return}const ae=Ue(O,ue,Z,h);Ut.current=ae.location,ae.isTouch&&(_n.current=Date.now()),An.current!==ae.isTouch&&xn(ae.isTouch),!(ae.kind===eo&&Gn(O,ae.location[0],ue,Z)!==void 0)&&(ae.kind===pn&&Pe(ae.group,ae.bounds,ae.localEventX,ae.localEventY)!==void 0||(D==null||D(ae),!ae.isTouch&&de!==!0&&de!==ae.kind&&ae.button<3&&ae.button!==1&&h.preventDefault()))},[K,de,Ue,Pe,Gn,D]);Vt("pointerdown",ii,xt,!1);const Eo=s.useRef(0),Vo=s.useCallback(h=>{var lt,bt;const O=Eo.current;Eo.current=Date.now();const le=xe.current;if(Yt.current=!1,T===void 0||le===null)return;const ue=K==null?void 0:K.current,Z=h.target!==le&&h.target!==ue,ae=h.clientX,De=h.clientY,Je=h.pointerType==="mouse"?h.button<3:!0;let S=Ue(le,ae,De,h);S.isTouch&&_n.current!==0&&Date.now()-_n.current>500&&(S={...S,isLongTouch:!0}),O!==0&&Date.now()-O<(S.isTouch?1e3:500)&&(S={...S,isDoubleClick:!0}),An.current!==S.isTouch&&xn(S.isTouch),!Z&&h.cancelable&&Je&&h.preventDefault();const[it]=S.location,oe=Gn(le,it,ae,De);if(S.kind===eo&&oe!==void 0){(S.button!==0||((lt=Ut.current)==null?void 0:lt[0])!==it||((bt=Ut.current)==null?void 0:bt[1])!==-1)&&T(S,!0);return}else if(S.kind===pn){const st=Pe(S.group,S.bounds,S.localEventX,S.localEventY);if(st!==void 0){S.button===0&&st.onClick(S);return}}T(S,Z)},[T,K,Ue,Gn,Pe]);Vt("pointerup",Vo,xt,!1);const qo=s.useCallback(h=>{var it,oe;const O=xe.current;if(O===null)return;const le=K==null?void 0:K.current,ue=h.target!==O&&h.target!==le;let Z,ae,De=!0;h instanceof MouseEvent?(Z=h.clientX,ae=h.clientY,De=h.button<3):(Z=h.changedTouches[0].clientX,ae=h.changedTouches[0].clientY);const Je=Ue(O,Z,ae,h);An.current!==Je.isTouch&&xn(Je.isTouch),!ue&&h.cancelable&&De&&h.preventDefault();const[S]=Je.location;if(Je.kind===eo){const lt=Gn(O,S,Z,ae);lt!==void 0&&Je.button===0&&((it=Ut.current)==null?void 0:it[0])===S&&((oe=Ut.current)==null?void 0:oe[1])===-1&&(lt.area==="menu"?y==null||y(S,lt.bounds):lt.area==="indicator"&&(x==null||x(S,lt.bounds)))}},[K,Ue,Gn,y,x]);Vt("click",qo,xt,!1);const xr=s.useCallback(h=>{const O=xe.current,le=K==null?void 0:K.current;if(O===null||h.target!==O&&h.target!==le||Y===void 0)return;const ue=Ue(O,h.clientX,h.clientY,h);Y(ue,()=>{h.cancelable&&h.preventDefault()})},[K,Ue,Y]);Vt("contextmenu",xr,(K==null?void 0:K.current)??null,!1);const io=s.useCallback(h=>{Bt.current=new Yo(h.map(O=>O.item)),rn.current=h,no.current(),Bt.current=void 0},[]),Wn=s.useMemo(()=>new Kc(io),[io]),kr=s.useRef(Wn);kr.current=Wn,s.useLayoutEffect(()=>{const h=kr.current;if(zn===void 0||zn[1]<0){h.setHovered(zn);return}const O=b(zn,!0),le=Ne(O),ue=le===void 0&&O.kind===J.Custom||(le==null?void 0:le.needsHover)!==void 0&&(typeof le.needsHover=="boolean"?le.needsHover:le.needsHover(O));h.setHovered(ue?zn:void 0)},[b,Ne,zn]);const jo=s.useRef(),Io=s.useCallback(h=>{var Je;const O=xe.current;if(O===null)return;const le=K==null?void 0:K.current,ue=h.target!==O&&h.target!==le,Z=Ue(O,h.clientX,h.clientY,h);if(Z.kind!=="out-of-bounds"&&ue&&!Yt.current&&!Z.isTouch)return;const ae=(S,it)=>{Xt(oe=>oe===S||(oe==null?void 0:oe[0][0])===(S==null?void 0:S[0][0])&&(oe==null?void 0:oe[0][1])===(S==null?void 0:S[0][1])&&((oe==null?void 0:oe[1][0])===(S==null?void 0:S[1][0])&&(oe==null?void 0:oe[1][1])===(S==null?void 0:S[1][1])||!it)?oe:S)};if(!ys(Z,jo.current))At(void 0),he==null||he(Z),ae(Z.kind===jr?void 0:[Z.location,[Z.localEventX,Z.localEventY]],!0),jo.current=Z;else if(Z.kind==="cell"||Z.kind===eo||Z.kind===pn){let S=!1,it=!0;if(Z.kind==="cell"){const lt=b(Z.location);it=((Je=Ne(lt))==null?void 0:Je.needsHoverPosition)??lt.kind===J.Custom,S=it}else S=!0;const oe=[Z.location,[Z.localEventX,Z.localEventY]];ae(oe,it),On.current=oe,S&&Bn(new Yo([Z.location]))}const De=Z.location[0]>=(we?0:1);vt(Z.kind===eo&&Z.isEdge&&De&&Ze===!0),ti(Z.kind==="cell"&&Z.isFillHandle),ie==null||ie(h),U(Z)},[K,Ue,we,Ze,ie,U,he,b,Ne,Bn]);Vt("pointermove",Io,xt,!0);const Kn=s.useCallback(h=>{const O=xe.current;if(O===null)return;let le,ue;A.current!==void 0&&(le=Ge(O,A.current.cell[0],A.current.cell[1]),ue=A.current.cell),Q==null||Q({bounds:le,stopPropagation:()=>h.stopPropagation(),preventDefault:()=>h.preventDefault(),cancel:()=>{},ctrlKey:h.ctrlKey,metaKey:h.metaKey,shiftKey:h.shiftKey,altKey:h.altKey,key:h.key,keyCode:h.keyCode,rawEvent:h,location:ue})},[Q,A,Ge]),Do=s.useCallback(h=>{const O=xe.current;if(O===null)return;let le,ue;A.current!==void 0&&(le=Ge(O,A.current.cell[0],A.current.cell[1]),ue=A.current.cell),_==null||_({bounds:le,stopPropagation:()=>h.stopPropagation(),preventDefault:()=>h.preventDefault(),cancel:()=>{},ctrlKey:h.ctrlKey,metaKey:h.metaKey,shiftKey:h.shiftKey,altKey:h.altKey,key:h.key,keyCode:h.keyCode,rawEvent:h,location:ue})},[_,A,Ge]),li=s.useCallback(h=>{if(xe.current=h,ee!==void 0&&(ee.current=h),se!=null&&se.eventTarget)ht.current=se.eventTarget;else if(h===null)ht.current=window;else{const O=h.getRootNode();O===document&&(ht.current=window),ht.current=O}},[ee,se==null?void 0:se.eventTarget]),Sr=s.useCallback(h=>{const O=xe.current;if(O===null||de===!1||te){h.preventDefault();return}let le,ue;const Z=Ue(O,h.clientX,h.clientY);if(de!==!0&&Z.kind!==de){h.preventDefault();return}const ae=(lt,bt)=>{le=lt,ue=bt};let De,Je,S;const it=(lt,bt,st)=>{De=lt,Je=bt,S=st};let oe=!1;if(ge==null||ge({...Z,setData:ae,setDragImage:it,preventDefault:()=>oe=!0,defaultPrevented:()=>oe}),!oe&&le!==void 0&&ue!==void 0&&h.dataTransfer!==null)if(h.dataTransfer.setData(le,ue),h.dataTransfer.effectAllowed="copyLink",De!==void 0&&Je!==void 0&&S!==void 0)h.dataTransfer.setDragImage(De,Je,S);else{const[lt,bt]=Z.location;if(bt!==void 0){const st=document.createElement("canvas"),Ve=Ge(O,lt,bt);tn(Ve!==void 0);const yt=Math.ceil(window.devicePixelRatio??1);st.width=Ve.width*yt,st.height=Ve.height*yt;const Tt=st.getContext("2d");Tt!==null&&(Tt.scale(yt,yt),Tt.textBaseline="middle",bt===-1?(Tt.font=Ie.headerFontFull,Tt.fillStyle=Ie.bgHeader,Tt.fillRect(0,0,st.width,st.height),ws(Tt,0,0,Ve.width,Ve.height,Ke[lt],!1,Ie,!1,void 0,void 0,!1,0,Kt,me,!1)):(Tt.font=Ie.baseFontFull,Tt.fillStyle=Ie.bgCell,Tt.fillRect(0,0,st.width,st.height),hs(Tt,b([lt,bt]),0,bt,!1,!1,0,0,Ve.width,Ve.height,!1,Ie,Ie.bgCell,Mt,Kt,1,void 0,!1,0,void 0,void 0,void 0,vo,Ne,()=>{},0))),st.style.left="-100%",st.style.position="absolute",st.style.width=`${Ve.width}px`,st.style.height=`${Ve.height}px`,document.body.append(st),h.dataTransfer.setDragImage(st,Ve.width/2,Ve.height/2),window.setTimeout(()=>{st.remove()},0)}}else h.preventDefault()},[de,te,Ue,ge,Ge,Ie,Ke,Kt,me,b,Mt,vo,Ne]);Vt("dragstart",Sr,(K==null?void 0:K.current)??null,!1,!1);const ye=s.useRef(),Zo=s.useCallback(h=>{const O=xe.current;if(Ce!==void 0&&h.preventDefault(),O===null||Ee===void 0)return;const le=Ue(O,h.clientX,h.clientY),[ue,Z]=le.location,ae=ue-(we?0:1),[De,Je]=ye.current??[];(De!==ae||Je!==Z)&&(ye.current=[ae,Z],Ee([ae,Z],h.dataTransfer))},[we,Ue,Ee,Ce]);Vt("dragover",Zo,(K==null?void 0:K.current)??null,!1,!1);const si=s.useCallback(()=>{ye.current=void 0,$e==null||$e()},[$e]);Vt("dragend",si,(K==null?void 0:K.current)??null,!1,!1);const gn=s.useCallback(h=>{const O=xe.current;if(O===null||Ce===void 0)return;h.preventDefault();const le=Ue(O,h.clientX,h.clientY),[ue,Z]=le.location,ae=ue-(we?0:1);Ce([ae,Z],h.dataTransfer)},[we,Ue,Ce]);Vt("drop",gn,(K==null?void 0:K.current)??null,!1,!1);const ai=s.useCallback(()=>{rt==null||rt()},[rt]);Vt("dragleave",ai,(K==null?void 0:K.current)??null,!1,!1);const mn=s.useRef(A);mn.current=A;const Un=s.useRef(null),Fo=s.useCallback(h=>{var O;xe.current===null||!xe.current.contains(document.activeElement)||(h===null&&mn.current.current!==void 0?(O=ee==null?void 0:ee.current)==null||O.focus({preventScroll:!0}):h!==null&&h.focus({preventScroll:!0}),Un.current=h)},[ee]);s.useImperativeHandle(t,()=>({focus:()=>{var O;const h=Un.current;h===null||!document.contains(h)?(O=ee==null?void 0:ee.current)==null||O.focus({preventScroll:!0}):h.focus({preventScroll:!0})},getBounds:(h,O)=>{if(!(ee===void 0||ee.current===null))return Ge(ee.current,h??0,O??-1)},damage:pr,getMouseArgsForPosition:(h,O,le)=>{if(!(ee===void 0||ee.current===null))return Ue(ee.current,h,O,le)}}),[ee,pr,Ge,Ue]);const To=s.useRef(),ci=ba(()=>{var Je,S,it;if(n<50||(se==null?void 0:se.disableAccessibilityTree)===!0)return null;let h=zi(Ke,Se,n,fe,Et);const O=we?0:-1;!we&&((Je=h[0])==null?void 0:Je.sourceIndex)===0&&(h=h.slice(1));const[le,ue]=((S=A.current)==null?void 0:S.cell)??[],Z=(it=A.current)==null?void 0:it.range,ae=h.map(oe=>oe.sourceIndex),De=wo(l,Math.min(m,l+r));return le!==void 0&&ue!==void 0&&!(ae.includes(le)&&De.includes(ue))&&Fo(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":m+1,"aria-multiselectable":"true","aria-colcount":Ke.length+O},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},h.map(oe=>s.createElement("th",{role:"columnheader","aria-selected":A.columns.hasIndex(oe.sourceIndex),"aria-colindex":oe.sourceIndex+1+O,tabIndex:-1,onFocus:lt=>{if(lt.target!==Un.current)return ve==null?void 0:ve([oe.sourceIndex,-1])},key:oe.sourceIndex},oe.title)))),s.createElement("tbody",{role:"rowgroup"},De.map(oe=>s.createElement("tr",{role:"row","aria-selected":A.rows.hasIndex(oe),key:oe,"aria-rowindex":oe+2},h.map(lt=>{const bt=lt.sourceIndex,st=vn(bt,oe),Ve=le===bt&&ue===oe,yt=Z!==void 0&&bt>=Z.x&&bt<Z.x+Z.width&&oe>=Z.y&&oe<Z.y+Z.height,Tt=`glide-cell-${bt}-${oe}`,wn=[bt,oe],Rn=b(wn,!0);return s.createElement("td",{key:st,role:"gridcell","aria-colindex":bt+1+O,"aria-selected":yt,"aria-readonly":Oo(Rn)||!No(Rn),id:Tt,"data-testid":Tt,onClick:()=>{const an=ee==null?void 0:ee.current;if(an!=null)return Q==null?void 0:Q({bounds:Ge(an,bt,oe),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:wn})},onFocusCapture:an=>{var Ot,Fe;if(!(an.target===Un.current||((Ot=To.current)==null?void 0:Ot[0])===bt&&((Fe=To.current)==null?void 0:Fe[1])===oe))return To.current=wn,ve==null?void 0:ve(wn)},ref:Ve?Fo:void 0,tabIndex:-1},jc(Rn,Ne))})))))},[n,Ke,Se,fe,Et,m,l,r,A,Fo,b,ee,Q,Ge,ve],200),Ho=z===0||!$?0:Se>z?1:un(-Et/100,0,1),Mn=-l*32+It,ln=X?un(-Mn/100,0,1):0,sn=s.useMemo(()=>{if(!Ho&&!ln)return null;const h={position:"absolute",top:0,left:Wt,width:n-Wt,height:o,opacity:Ho,pointerEvents:"none",transition:dt?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},O={position:"absolute",top:hn,left:0,width:n,height:o,opacity:ln,pointerEvents:"none",transition:q?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,Ho>0&&s.createElement("div",{id:"shadow-x",style:h}),ln>0&&s.createElement("div",{id:"shadow-y",style:O}))},[Ho,ln,Wt,n,dt,hn,o,q]),lo=s.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:Kn,onKeyUp:Do,onFocus:R,onBlur:W,ref:li,style:Sn},ci),s.createElement("canvas",{ref:gt,style:lo}),sn)},Jc=s.memo(s.forwardRef(Zc));function dr(e,t,n,o){return un(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Qc=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,d]=s.useState(),[l,c]=s.useState(),[f,u]=s.useState(!1),[w,m]=s.useState(),[b,g]=s.useState(),[y,x]=s.useState(),[k,p]=s.useState(!1),[R,W]=s.useState(),{onHeaderMenuClick:L,onHeaderIndicatorClick:A,getCellContent:z,onColumnMoved:Y,onColumnResize:E,onColumnResizeStart:$,onColumnResizeEnd:X,gridRef:B,maxColumnWidth:D,minColumnWidth:T,onRowMoved:ie,lockColumns:U,onColumnProposeMove:he,onMouseDown:fe,onMouseUp:we,onItemHovered:Q,onDragStart:_,canvasRef:be}=e,ee=(E??X??$)!==void 0,{columns:ge,selection:$e}=e,K=$e.columns,te=s.useCallback(V=>{const[me,ve]=V.location;i!==void 0&&l!==me&&me>=U?(u(!0),c(me)):b!==void 0&&ve!==void 0?(p(!0),x(Math.max(0,ve))):o===void 0&&!f&&!k&&(Q==null||Q(V))},[i,b,l,Q,U,o,f,k]),He=Y!==void 0,je=s.useCallback(V=>{var me;if(V.button===0){const[ve,Ee]=V.location;if(V.kind==="out-of-bounds"&&V.isEdge&&ee){const Ce=(me=B==null?void 0:B.current)==null?void 0:me.getBounds(ge.length-1,-1);Ce!==void 0&&(n(Ce.x),r(ge.length-1))}else if(V.kind==="header"&&ve>=U){const Ce=be==null?void 0:be.current;if(V.isEdge&&ee&&Ce){n(V.bounds.x),r(ve);const et=Ce.getBoundingClientRect().width/Ce.offsetWidth,dt=V.bounds.width/et;$==null||$(ge[ve],dt,ve,dt+(ge[ve].growOffset??0))}else V.kind==="header"&&He&&(m(V.bounds.x),d(ve))}else V.kind==="cell"&&U>0&&ve===0&&Ee!==void 0&&ie!==void 0&&(W(V.bounds.y),g(Ee))}fe==null||fe(V)},[fe,ee,U,ie,B,ge,He,$,be]),de=s.useCallback((V,me)=>{f||k||L==null||L(V,me)},[f,k,L]),Ze=s.useCallback((V,me)=>{f||k||A==null||A(V,me)},[f,k,A]),ct=s.useRef(-1),pe=s.useCallback(()=>{ct.current=-1,g(void 0),x(void 0),W(void 0),p(!1),d(void 0),c(void 0),m(void 0),u(!1),r(void 0),n(void 0)},[]),Ae=s.useCallback((V,me)=>{if(V.button===0){if(o!==void 0){if((K==null?void 0:K.hasIndex(o))===!0)for(const Ee of K){if(Ee===o)continue;const Ce=ge[Ee],rt=dr(Ce,ct.current,T,D);E==null||E(Ce,rt,Ee,rt+(Ce.growOffset??0))}const ve=dr(ge[o],ct.current,T,D);if(X==null||X(ge[o],ve,o,ve+(ge[o].growOffset??0)),K.hasIndex(o))for(const Ee of K){if(Ee===o)continue;const Ce=ge[Ee],rt=dr(Ce,ct.current,T,D);X==null||X(Ce,rt,Ee,rt+(Ce.growOffset??0))}}pe(),i!==void 0&&l!==void 0&&(he==null?void 0:he(i,l))!==!1&&(Y==null||Y(i,l)),b!==void 0&&y!==void 0&&(ie==null||ie(b,y))}we==null||we(V,me)},[we,o,i,l,b,y,K,X,ge,T,D,E,Y,ie,pe,he]),Ie=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(he==null?void 0:he(i,l))!==!1)return{src:i,dest:l}},[i,l,he]),pt=s.useCallback(V=>{const me=be==null?void 0:be.current;if(i!==void 0&&w!==void 0)Math.abs(V.clientX-w)>20&&u(!0);else if(b!==void 0&&R!==void 0)Math.abs(V.clientY-R)>20&&p(!0);else if(o!==void 0&&t!==void 0&&me){const Ee=me.getBoundingClientRect().width/me.offsetWidth,Ce=(V.clientX-t)/Ee,rt=ge[o],et=dr(rt,Ce,T,D);if(E==null||E(rt,et,o,et+(rt.growOffset??0)),ct.current=Ce,(K==null?void 0:K.first())===o)for(const dt of K){if(dt===o)continue;const q=ge[dt],se=dr(q,ct.current,T,D);E==null||E(q,se,dt,se+(q.growOffset??0))}}},[i,w,b,R,o,t,ge,T,D,E,K,be]),mt=s.useCallback((V,me)=>{if(b===void 0||y===void 0)return z(V,me);let[ve,Ee]=V;return Ee===y?Ee=b:(Ee>y&&(Ee-=1),Ee>=b&&(Ee+=1)),z([ve,Ee],me)},[b,y,z]),wt=s.useCallback(V=>{_==null||_(V),V.defaultPrevented()||pe()},[pe,_]);return s.createElement(Jc,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:mt,isResizing:o!==void 0,onHeaderMenuClick:de,onHeaderIndicatorClick:Ze,isDragging:f,onItemHovered:te,onDragStart:wt,onMouseDown:je,allowResize:ee,onMouseUp:Ae,dragAndDropState:Ie,onMouseMoveRaw:pt,ref:B})};function ed(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=d=>{for(const l of d){const{width:c,height:f}=l&&l.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const td=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),d=s.useRef(0),l=s.useRef(t);l.current=t;const c=n.current;s.useEffect(()=>{const f=()=>{var m,b;if(r.current===!1&&c!==null){const g=[c.scrollLeft,c.scrollTop];if(((m=i.current)==null?void 0:m[0])===g[0]&&((b=i.current)==null?void 0:b[1])===g[1])if(d.current>10){i.current=null,r.current=null;return}else d.current++;else d.current=0,l.current(g[0],g[1]),i.current=g;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},w=m=>{m.touches.length===0&&(r.current=!1,d.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const m=c;return m.addEventListener("touchstart",u),m.addEventListener("touchend",w),()=>{m.removeEventListener("touchstart",u),m.removeEventListener("touchend",w),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},nd=()=>e=>e.isSafari?"scroll":"auto",od=on("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[nd()]}}),rd=33554400,id=5e6;function ld(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Vt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Vt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const sd=e=>{var $e,K;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:d,className:l,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:w,rightElementProps:m,kineticScrollPerfHack:b=!1,scrollRef:g,initialSize:y}=e,x=[],k=(m==null?void 0:m.sticky)??!1,p=(m==null?void 0:m.fill)??!1,R=s.useRef(0),W=s.useRef(0),L=s.useRef(null),A=typeof window>"u"?1:window.devicePixelRatio,z=s.useRef(A);s.useEffect(()=>{if(z.current!==A){R.current=0,W.current=0,z.current=A;const te=L.current;te!==null&&ie.current(te.scrollLeft,te.scrollTop)}},[A]);const Y=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),E=s.useRef(null),$=ld(200),[X,B]=s.useState(!0),D=s.useRef(0);s.useLayoutEffect(()=>{if(!X||$||Y.current.lockDirection===void 0)return;const te=L.current;if(te===null)return;const[He,je]=Y.current.lockDirection;He!==void 0?te.scrollLeft=He:je!==void 0&&(te.scrollTop=je),Y.current.lockDirection=void 0},[$,X]);const T=s.useCallback((te,He)=>{var ve;const je=L.current;if(je===null)return;He=He??je.scrollTop,te=te??je.scrollLeft;const de=Y.current.scrollTop,Ze=Y.current.scrollLeft,ct=te-Ze,pe=He-de;$&&ct!==0&&pe!==0&&(Math.abs(ct)>3||Math.abs(pe)>3)&&c&&Y.current.lockDirection===void 0&&(Y.current.lockDirection=Math.abs(ct)<Math.abs(pe)?[Ze,void 0]:[void 0,de]);const Ae=Y.current.lockDirection;te=(Ae==null?void 0:Ae[0])??te,He=(Ae==null?void 0:Ae[1])??He,Y.current.scrollLeft=te,Y.current.scrollTop=He;const Ie=je.clientWidth,pt=je.clientHeight,mt=He,wt=W.current-mt,V=je.scrollHeight-pt;W.current=mt;let me;if(V>0&&o>je.scrollHeight+5)if(Math.abs(wt)>2e3||mt===0||mt===V){const Ee=Math.max(0,Math.min(1,mt/V)),Ce=o-pt;me=Ee*Ce,R.current=me}else R.current-=wt,me=R.current;else me=mt,R.current=me;me=Math.max(0,Math.min(me,o-pt)),R.current=me,Ae!==void 0&&(window.clearTimeout(D.current),B(!1),D.current=window.setTimeout(()=>B(!0),200)),i({x:te,y:me,width:Ie-u,height:pt-f,paddingRight:((ve=E.current)==null?void 0:ve.clientWidth)??0})},[f,u,o,i,c,$]);td(b&&Vr.value,T,L);const ie=s.useRef(T);ie.current=T;const U=s.useRef(),he=s.useRef(!1);s.useLayoutEffect(()=>{he.current?T():he.current=!0},[T,f,u]);const fe=s.useCallback(te=>{L.current=te,g!==void 0&&(g.current=te)},[g]);let we=0,Q=0;const _=Math.min(o,rd);for(x.push(s.createElement("div",{key:we++,style:{width:r,height:0}}));Q<_;){const te=Math.min(id,_-Q);x.push(s.createElement("div",{key:we++,style:{width:0,height:te}})),Q+=te}const{ref:be,width:ee,height:ge}=ed(y);return typeof window<"u"&&((($e=U.current)==null?void 0:$e.height)!==ge||((K=U.current)==null?void 0:K.width)!==ee)&&(window.setTimeout(()=>ie.current(),0),U.current={width:ee,height:ge}),(ee??0)===0||(ge??0)===0?s.createElement("div",{ref:be}):s.createElement("div",{ref:be},s.createElement(od,{isSafari:Vr.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:fe,style:U.current,draggable:d,onDragStart:te=>{d||(te.stopPropagation(),te.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>T()},s.createElement("div",{className:"dvn-scroll-inner"+(w===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},x),w!==void 0&&s.createElement(s.Fragment,null,!p&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:E,style:{height:ge,maxHeight:n-Math.ceil(A%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:p?1:void 0,right:k?u??0:void 0,pointerEvents:"auto"}},w))))))},ad=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:d,freezeColumns:l,experimental:c,nonGrowWidth:f,clientSize:u,className:w,onVisibleRegionChanged:m,scrollRef:b,preventDiagonalScrolling:g,rightElement:y,rightElementProps:x,overscrollX:k,overscrollY:p,initialSize:R,smoothScrollX:W=!1,smoothScrollY:L=!1,isDraggable:A}=e,{paddingRight:z,paddingBottom:Y}=c??{},[E,$]=u,X=s.useRef(),B=s.useRef(),D=s.useRef(),T=s.useRef(),ie=f+Math.max(0,k??0);let U=d?r+i:r;if(typeof o=="number")U+=n*o;else for(let Q=0;Q<n;Q++)U+=o(Q);p!==void 0&&(U+=p);const he=s.useRef(),fe=s.useCallback(()=>{var Ze,ct;if(he.current===void 0)return;const Q={...he.current};let _=0,be=Q.x<0?-Q.x:0,ee=0,ge=0;Q.x=Q.x<0?0:Q.x;let $e=0;for(let pe=0;pe<l;pe++)$e+=t[pe].width;for(const pe of t){const Ae=_-$e;if(Q.x>=Ae+pe.width)_+=pe.width,ge++,ee++;else if(Q.x>Ae)_+=pe.width,W?be+=Ae-Q.x:ge++,ee++;else if(Q.x+Q.width>Ae)_+=pe.width,ee++;else break}let K=0,te=0,He=0;if(typeof o=="number")L?(te=Math.floor(Q.y/o),K=te*o-Q.y):te=Math.ceil(Q.y/o),He=Math.ceil(Q.height/o)+te,K<0&&He++;else{let pe=0;for(let Ae=0;Ae<n;Ae++){const Ie=o(Ae),pt=pe+(L?0:Ie/2);if(Q.y>=pe+Ie)pe+=Ie,te++,He++;else if(Q.y>pt)pe+=Ie,L?K+=pt-Q.y:te++,He++;else if(Q.y+Q.height>Ie/2+pe)pe+=Ie,He++;else break}}te=Math.max(0,Math.min(te,n-1)),He=Math.max(te,Math.min(He,n));const je={x:ge,y:te,width:ee-ge,height:He-te},de=X.current;(de===void 0||de.y!==je.y||de.x!==je.x||de.height!==je.height||de.width!==je.width||B.current!==be||D.current!==K||Q.width!==((Ze=T.current)==null?void 0:Ze[0])||Q.height!==((ct=T.current)==null?void 0:ct[1]))&&(m==null||m({x:ge,y:te,width:ee-ge,height:He-te},Q.width,Q.height,Q.paddingRight??0,be,K),X.current=je,B.current=be,D.current=K,T.current=[Q.width,Q.height])},[t,o,n,m,l,W,L]),we=s.useCallback(Q=>{he.current=Q,fe()},[fe]);return s.useEffect(()=>{fe()},[fe]),s.createElement(sd,{scrollRef:b,className:w,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:g,draggable:A===!0||typeof A=="string",scrollWidth:ie+(z??0),scrollHeight:U+(Y??0),clientHeight:$,rightElement:y,paddingBottom:Y,paddingRight:z,rightElementProps:x,update:we,initialSize:R},s.createElement(Qc,{eventTargetRef:b,width:E,height:$,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},cd=on("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),dd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),ud=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),fd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),hd=10,gd=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:d,searchResults:l,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:w=!1,onSearchClose:m}=e,[b]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[g,y]=s.useState(""),x=d??g,k=s.useCallback(_=>{y(_),c==null||c(_)},[c]),[p,R]=s.useState(),W=s.useRef(p);W.current=p,s.useEffect(()=>{l!==void 0&&(l.length>0?R(_=>({rowsSearched:o,results:l.length,selectedIndex:(_==null?void 0:_.selectedIndex)??-1})):R(void 0))},[o,l]);const L=s.useRef();L.current===void 0&&(L.current=new AbortController);const A=s.useRef(),[z,Y]=s.useState([]),E=l??z,$=s.useCallback(()=>{A.current!==void 0&&(window.cancelAnimationFrame(A.current),A.current=void 0),L.current!==void 0&&L.current.abort(),L.current=new AbortController},[]),X=s.useRef(n);X.current=n;const B=s.useCallback(_=>{const be=new RegExp(_.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ee=X.current,ge=Math.min(10,o),$e=0;R(void 0),Y([]);const K=[],te=async()=>{var mt;if(f===void 0)return;const He=performance.now(),je=o-$e;let de=f({x:0,y:ee,width:r.length,height:Math.min(ge,je,o-ee)},L.current.signal);typeof de=="function"&&(de=await de());let Ze=!1;for(const[wt,V]of de.entries())for(const[me,ve]of V.entries()){let Ee;switch(ve.kind){case J.Text:case J.Number:Ee=ve.displayData;break;case J.Uri:case J.Markdown:Ee=ve.data;break;case J.Boolean:Ee=typeof ve.data=="boolean"?ve.data.toString():void 0;break;case J.Image:case J.Bubble:Ee=ve.data.join("🐳");break;case J.Custom:Ee=ve.copyData;break}Ee!==void 0&&be.test(Ee)&&(K.push([me,wt+ee]),Ze=!0)}const ct=performance.now();Ze&&Y([...K]),$e+=de.length,tn($e<=o);const pe=((mt=W.current)==null?void 0:mt.selectedIndex)??-1;R({results:K.length,rowsSearched:$e,selectedIndex:pe}),u==null||u(K,pe),ee+ge>=o?ee=0:ee+=ge;const Ae=ct-He,Ie=Math.max(Ae,1),pt=hd/Ie;ge=Math.ceil(ge*pt),$e<o&&K.length<1e3&&(A.current=window.requestAnimationFrame(te))};$(),A.current=window.requestAnimationFrame(te)},[$,r.length,f,u,o]),D=s.useCallback(()=>{var _;m==null||m(),R(void 0),Y([]),u==null||u([],-1),$(),(_=t==null?void 0:t.current)==null||_.focus()},[$,t,m,u]),T=s.useCallback(_=>{k(_.target.value),l===void 0&&(_.target.value===""?(R(void 0),Y([]),$()):B(_.target.value))},[B,$,k,l]);s.useEffect(()=>{i.current!==null&&(k(""),R(void 0),z.length>0&&(Y([]),u==null||u([],-1)),w?i.current.focus({preventScroll:!0}):$())},[w,i]);const ie=s.useCallback(_=>{var ee;if((ee=_==null?void 0:_.stopPropagation)==null||ee.call(_),p===void 0||p.results===0)return;const be=(p.selectedIndex+1)%p.results;R({...p,selectedIndex:be}),u==null||u(E,be)},[p,u,E]),U=s.useCallback(_=>{var ee;if((ee=_==null?void 0:_.stopPropagation)==null||ee.call(_),p===void 0||p.results===0)return;let be=(p.selectedIndex-1)%p.results;be<0&&(be+=p.results),R({...p,selectedIndex:be}),u==null||u(E,be)},[u,E,p]),he=s.useCallback(_=>{(_.ctrlKey||_.metaKey)&&_.nativeEvent.code==="KeyF"||_.key==="Escape"?(D(),_.stopPropagation(),_.preventDefault()):_.key==="Enter"&&(_.shiftKey?U():ie())},[D,ie,U]);s.useEffect(()=>()=>{$()},[$]);const[fe,we]=s.useState(!1);s.useEffect(()=>{if(w)we(!0);else{const _=setTimeout(()=>we(!1),150);return()=>clearTimeout(_)}},[w]);const Q=s.useMemo(()=>{if(!w&&!fe)return null;let _;p!==void 0&&(_=p.results>=1e3?"over 1000":`${p.results} result${p.results!==1?"s":""}`,p.selectedIndex>=0&&(_=`${p.selectedIndex+1} of ${_}`));const be=$e=>{$e.stopPropagation()},ge={width:`${o>0?Math.floor(((p==null?void 0:p.rowsSearched)??0)/o*100):0}%`};return s.createElement(cd,{className:"gdg-search-bar"+(w?"":" out"),onMouseDown:be,onMouseMove:be,onMouseUp:be,onClick:be},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:b,"aria-hidden":!w,"data-testid":"search-input",ref:i,onChange:T,value:x,tabIndex:w?void 0:-1,onKeyDownCapture:he}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:U,disabled:((p==null?void 0:p.results)??0)===0},dd),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!w,tabIndex:w?void 0:-1,onClick:ie,disabled:((p==null?void 0:p.results)??0)===0},ud),m!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!w,"data-testid":"search-close-button",tabIndex:w?void 0:-1,onClick:D},fd)),p!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},_)),s.createElement("div",{className:"gdg-search-progress",style:ge})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:b},"Type to search")))},[w,fe,p,o,b,i,T,x,he,U,ie,m,D]);return s.createElement(s.Fragment,null,s.createElement(ad,{prelightCells:E,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Q)};class md extends s.PureComponent{constructor(){super(...arguments);Le(this,"wrapperRef",s.createRef());Le(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const wd=()=>e=>Math.max(16,e.targetHeight-10),bd=on("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[wd(),"px"]}}),yd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[d,l]=St.useState(n);return St.createElement(md,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},St.createElement(bd,{targetHeight:t.height,"data-testid":"group-rename-input",value:d,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,d.length),onChange:c=>l(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(d):c.key==="Escape"&&o()},autoFocus:!0}))};function pd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Be(e,t,n){const o=ps(e,t);return o&&(n.didMatch=!0),o}function ps(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(ps(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const d=e.split("+"),l=d.pop();if(!pd(l,t))return!1;if(d[0]==="any")return!0;for(const c of d)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":qr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function vd(e,t,n,o,r,i,d){const l=St.useCallback((u,w,m,b)=>{var R;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!d&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const g=n==="mixed"&&(m||b==="drag")||n==="additive",y=(o==="mixed"||o==="additive")&&g,x=(r==="mixed"||r==="additive")&&g;let k={current:u===void 0?void 0:{...u,rangeStack:b==="drag"?((R=e.current)==null?void 0:R.rangeStack)??[]:[]},columns:y?e.columns:ot.empty(),rows:x?e.rows:ot.empty()};m&&(i==="multi-rect"||i==="multi-cell")&&k.current!==void 0&&e.current!==void 0&&(k={...k,current:{...k.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(k,w)},[o,e,n,i,d,r,t]),c=St.useCallback((u,w,m)=>{u=u??e.rows,w!==void 0&&(u=u.add(w));let b;if(r==="exclusive"&&u.length>0)b={current:void 0,columns:ot.empty(),rows:u};else{const g=m&&n==="mixed"||n==="additive",y=m&&o==="mixed"||o==="additive";b={current:g?e.current:void 0,columns:y?e.columns:ot.empty(),rows:u}}t(b,!1)},[o,e,n,r,t]),f=St.useCallback((u,w,m)=>{u=u??e.columns,w!==void 0&&(u=u.add(w));let b;if(o==="exclusive"&&u.length>0)b={current:void 0,rows:ot.empty(),columns:u};else{const g=m&&n==="mixed"||n==="additive",y=m&&r==="mixed"||r==="additive";b={current:g?e.current:void 0,rows:y?e.rows:ot.empty(),columns:u}}t(b,!1)},[o,e,n,r,t]);return[l,c,f]}function Cd(e,t,n,o,r){const i=s.useCallback(f=>{if(e===!0){const u=[];for(let w=f.y;w<f.y+f.height;w++){const m=[];for(let b=f.x;b<f.x+f.width;b++)b<0||w>=r?m.push({kind:J.Loading,allowOverlay:!1}):m.push(t([b,w]));u.push(m)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),d=e!==void 0?i:void 0,l=s.useCallback(f=>{if(d===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const w=d(u,o.signal);return typeof w=="function"?async()=>(await w()).map(m=>[{kind:J.Loading,allowOverlay:!1},...m]):w.map(m=>[{kind:J.Loading,allowOverlay:!1},...m])}return d(u,o.signal)},[o.signal,d,n]);return[e!==void 0?l:void 0,d]}function xd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case J.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===$i?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case J.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case J.Image:case J.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case J.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case J.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case J.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case J.Markdown:case J.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case J.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case J.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case J.Protected:return{formatted:"************",rawValue:"",format:"string"};default:hr()}}function kd(e,t){return e.map((o,r)=>{const i=t[r];return o.map(d=>d.span!==void 0&&d.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:xd(d))})}function Tl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function Sd(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(d=>Tl(d,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:Tl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Ii(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Hl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function Md(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function Rd(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Ii(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((d,l)=>`<li gdg-raw-value=${Hl(r.rawValue[l])}>`+Ii(d)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Hl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Ii(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function Ed(e,t){const n=kd(e,t),o=Sd(n),r=Rd(n);return{textPlain:o,textHtml:r}}function Al(e){var d;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const c=l.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,w=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",m=c.querySelectorAll("br");for(const y of m)y.replaceWith(`
`);const b=c.getAttribute("gdg-raw-value"),g=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((d=c.querySelector("a"))==null?void 0:d.getAttribute("href"))??"",formatted:c.textContent??"",format:g});else if(c.querySelector("ol")!==null){const y=c.querySelectorAll("li");i==null||i.push({rawValue:[...y].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...y].map(x=>x.textContent??""),format:"string-array"})}else if(b!==null)i==null||i.push({rawValue:Md(b),formatted:c.textContent??"",format:g});else{let y=c.textContent??"";w&&(y=y.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:y??"",formatted:y??"",format:g})}}}return i!==void 0&&r.push(i),r}function Id(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let d=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(l=e.current)==null?void 0:l.range,f=[];if(c.width>2){const m=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m);const b=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof b=="function")return i;f.push(...b)}else{const m=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m)}let u=c.x-n,w=c.x+c.width-1-n;for(const m of f)for(const b of m)b.span!==void 0&&(u=Math.min(b.span[0],u),w=Math.max(b.span[1],w));u===c.x-n&&w===c.x+c.width-1-n?d=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:w-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!d);return e}function zl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Dd(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let d=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,d)),r=d+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(zl(e.slice(r,d))),r=d+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}d++}return r<e.length&&o.push(zl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Pl(e,t,n){var l;const o=Ed(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},d=(c,f)=>{var u,w;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(w=n==null?void 0:n.clipboardData)==null||w.setData("text/html",f)}catch{i(c,f)||r(c)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?d(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function vs(e){return e!==!0}function Ll(e){return typeof e=="string"?e:`${e}px`}const Fd=()=>e=>e.innerWidth,Td=()=>e=>e.innerHeight,Hd=on("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[Fd()],"wmyidgi-1":[Td()]}}),Ad=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(Hd,{innerHeight:Ll(n),innerWidth:Ll(t),...r},o)},zd=2,Pd=1300;function Ld(e,t,n){const o=St.useRef(0),[r,i]=e??[0,0];St.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let d=!1,l=0;const c=f=>{var u;if(!d){if(l===0)l=f;else{const w=f-l;o.current=Math.min(1,o.current+w/Pd);const m=o.current**1.618*w*zd;(u=t.current)==null||u.scrollBy(r*m,i*m),l=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{d=!0}},[t,r,i,n])}function Bd({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:d,remSize:l}){const[c,f,u,w,m,b]=St.useMemo(()=>{if(!d||l===16)return[e,t,n,o,r,i];const g=l/16,y=e,x=is();return[typeof y=="number"?y*g:k=>Math.ceil(y(k)*g),Math.ceil(t*g),Math.ceil(n*g),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*g,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*g,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*g},Math.ceil((r??0)*g),Math.ceil((i??0)*g)]},[n,t,r,i,l,e,d,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:w,overscrollX:m,overscrollY:b}}const Jn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function We(e,t){return e===!0?t:e===!1?"":e}function Bl(e){const t=qr.value;return{activateCell:We(e.activateCell," |Enter|shift+Enter"),clear:We(e.clear,"any+Escape"),closeOverlay:We(e.closeOverlay,"any+Escape"),acceptOverlayDown:We(e.acceptOverlayDown,"Enter"),acceptOverlayUp:We(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:We(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:We(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:We(e.delete,t?"Backspace|Delete":"Delete"),downFill:We(e.downFill,"primary+_68"),scrollToSelectedCell:We(e.scrollToSelectedCell,"primary+Enter"),goDownCell:We(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:We(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:We(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:We(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:We(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:We(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:We(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:We(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:We(e.goToFirstCell,"primary+Home"),goToFirstColumn:We(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:We(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:We(e.goToLastCell,"primary+End"),goToLastColumn:We(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:We(e.goToLastRow,"primary+ArrowDown"),goToNextPage:We(e.goToNextPage,"PageDown"),goToPreviousPage:We(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:We(e.rightFill,"primary+_82"),search:We(e.search,"primary+f"),selectAll:We(e.selectAll,"primary+a"),selectColumn:We(e.selectColumn,"ctrl+ "),selectGrowDown:We(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:We(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:We(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:We(e.selectGrowUp,"shift+ArrowUp"),selectRow:We(e.selectRow,"shift+ "),selectToFirstCell:We(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:We(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:We(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:We(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:We(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:We(e.selectToLastRow,"primary+shift+ArrowDown")}}function Wd(e){const t=xa(e);return St.useMemo(()=>{if(t===void 0)return Bl(Jn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Jn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Jn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Jn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Jn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Jn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Jn.selectToLastCell};return Bl({...Jn,...n})},[t])}function $d(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const d={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(d.subGroups=o.subGroups.map((l,c)=>t(l,r+1,[...i,c])).sort((l,c)=>l.headerIndex-c.headerIndex)),d}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function Ui(e,t){const n=[];function o(l,c,f=!1){let u=c!==null?c-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(u=l.subGroups[0].headerIndex-l.headerIndex),u--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:f,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:u}),l.subGroups)for(let w=0;w<l.subGroups.length;w++){const m=w<l.subGroups.length-1?l.subGroups[w+1].headerIndex:c;o(l.subGroups[w],m,f||l.isCollapsed)}}const r=$d(e.groups);for(let l=0;l<r.length;l++){const c=l<r.length-1?r[l+1].headerIndex:null;o(r[l],c)}let i=0,d=0;for(const l of n)l.contentIndex=d,d+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:c,...f}=l;return f})}function Wi(e,t){if(t===void 0||Ui.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Nd(e,t,n,o){const r=St.useMemo(()=>e===void 0?void 0:Ui(e,t),[e,t]),i=St.useMemo(()=>r==null?void 0:r.reduce((u,w)=>(u[w.rowIndex]=w,u),{}),[r]),d=St.useMemo(()=>r===void 0?t:r.reduce((u,w)=>u+(w.isCollapsed?1:w.rows+1),0),[r,t]),l=St.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),c=St.useCallback(u=>{if(r===void 0)return u;let w=u;for(const m of r){if(w===0)return;if(w--,!m.isCollapsed){if(w<m.rows)return m.contentIndex+w;w-=m.rows}}return u},[r]),f=Qn(o??(e==null?void 0:e.themeOverride),St.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:w,contentIndex:m,groupIndex:b}=Wi(u,r);return w?e.themeOverride:o==null?void 0:o(u,b,m)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:c,getRowThemeOverride:f}:{rowHeight:l,rows:d,rowNumberMapper:c,getRowThemeOverride:f}}function Od(e,t){const n=St.useMemo(()=>e===void 0?void 0:Ui(e,t),[e,t]);return{getRowGroupingForPath:xs,updateRowGroupingByPath:Cs,mapper:St.useCallback(o=>{if(typeof o=="number")return Wi(o,n);const r=Wi(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function Cs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,d)=>d===o?{...i,...n}:i):e.map((i,d)=>d===o?{...i,subGroups:Cs(i.subGroups??[],r,n)}:i)}function xs(e,t){const[n,...o]=t;return o[0]===-1?e[n]:xs(e[n].subGroups??[],o)}function Xd(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Yd(e,t,n,o,r){const[i,d]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:d}),[o,d,i]),[c,f,u]=Ca(l),w=s.useRef(r);w.current=r;const m=Xd(null,y=>{y!==null&&t!==void 0?y.scrollTop=t:y!==null&&e!==void 0&&(y.scrollLeft=e)}),b=(c.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&m.current!==null&&b){if(m.current.scrollTop===t)return;m.current.scrollTop=t,m.current.scrollTop!==t&&u(),w.current()}},[t,b,u,m]);const g=(c.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&m.current!==null&&g){if(m.current.scrollLeft===e)return;m.current.scrollLeft=e,m.current.scrollLeft!==e&&u(),w.current()}},[e,g,u,m]),{visibleRegion:c,setVisibleRegion:f,scrollRef:m}}const Gd=s.lazy(async()=>await Ol(()=>import("./data-grid-overlay-editor-C9WaGkNL.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));let _d=0;function Kd(e){return da(hl(hl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return wo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Xr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const mo={kind:J.Loading,allowOverlay:!1},Di={columns:ot.empty(),rows:ot.empty(),current:void 0},Ud=(e,t)=>{var dl,ul,fl;const[n,o]=s.useState(Di),[r,i]=s.useState(),d=s.useRef(null),l=s.useRef(null),[c,f]=s.useState(),u=s.useRef(void 0),w=typeof window>"u"?null:window,{imageEditorOverride:m,getRowThemeOverride:b,markdownDivCreateNode:g,width:y,height:x,columns:k,rows:p,getCellContent:R,onCellClicked:W,onCellActivated:L,onFillPattern:A,onFinishedEditing:z,coercePasteValue:Y,drawHeader:E,drawCell:$,editorBloom:X,onHeaderClicked:B,onColumnProposeMove:D,rangeSelectionColumnSpanning:T=!0,spanRangeBehavior:ie="default",onGroupHeaderClicked:U,onCellContextMenu:he,className:fe,onHeaderContextMenu:we,getCellsForSelection:Q,onGroupHeaderContextMenu:_,onGroupHeaderRenamed:be,onCellEdited:ee,onCellsEdited:ge,onSearchResultsChanged:$e,searchResults:K,onSearchValueChange:te,searchValue:He,onKeyDown:je,onKeyUp:de,keybindings:Ze,editOnType:ct=!0,onRowAppended:pe,onColumnAppended:Ae,onColumnMoved:Ie,validateCell:pt,highlightRegions:mt,rangeSelect:wt="rect",columnSelect:V="multi",rowSelect:me="multi",rangeSelectionBlending:ve="exclusive",columnSelectionBlending:Ee="exclusive",rowSelectionBlending:Ce="exclusive",onDelete:rt,onDragStart:et,onMouseMove:dt,onPaste:q,copyHeaders:se=!1,freezeColumns:Ne=0,cellActivationBehavior:Xe="second-click",rowSelectionMode:Et="auto",columnSelectionMode:It="auto",onHeaderMenuClick:Se,onHeaderIndicatorClick:xe,getGroupDetails:ht,rowGrouping:xt,onSearchClose:Mt,onItemHovered:Bt,onSelectionCleared:Ht,showSearch:fn,onVisibleRegionChanged:rn,gridSelection:Dt,onGridSelectionChange:qt,minColumnWidth:Xt=50,maxColumnWidth:Cn=500,maxColumnAutoWidth:vt,provideEditor:gt,trailingRowOptions:Ye,freezeTrailingRows:At=0,allowedFillDirections:Zt="orthogonal",scrollOffsetX:xn,scrollOffsetY:An,verticalBorder:Kt,onDragOverCell:hn,onDrop:Me,onColumnResize:nt,onColumnResizeEnd:tt,onColumnResizeStart:Ke,customRenderers:Wt,fillHandle:Ge,experimental:Ue,fixedShadowX:zn,fixedShadowY:br,headerIcons:On,imageWindowLoader:Pn,initialSize:Ln,isDraggable:vo,onDragLeave:yr,onRowMoved:Xn,overscrollX:Co,overscrollY:xo,preventDiagonalScrolling:ko,rightElement:So,rightElementProps:no,trapFocus:Bn=!1,smoothScrollX:Qr,smoothScrollY:pr,scaleToRem:ei=!1,rowHeight:ti=34,headerHeight:kn=36,groupHeaderHeight:Yn=kn,theme:ni,isOutsideClick:oi,renderers:Mo,resizeIndicator:vr,scrollToActiveCell:oo=!0,drawFocusRing:ri=!0,portalElementRef:Cr,isActivationOnEnter:Sn,onRowStatus:ro}=e,Ro=ri==="no-editor"?r===void 0:ri,Pe=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Gn=(Pe==null?void 0:Pe.rowNumber)??!1;let _n=(Pe==null?void 0:Pe.kind)??e.rowMarkers??"none",Ut=Gn;(_n==="both"||_n==="checkbox-and-number")&&(_n="checkbox",Ut=!0);const Yt=_n,ii=(Pe==null?void 0:Pe.width)??e.rowMarkerWidth,Eo=(Pe==null?void 0:Pe.startIndex)??e.rowMarkerStartIndex??1,Vo=(Pe==null?void 0:Pe.theme)??e.rowMarkerTheme,qo=Pe==null?void 0:Pe.headerTheme,xr=Pe==null?void 0:Pe.headerAlwaysVisible,io=me!=="multi"||(Pe==null?void 0:Pe.headerDisabled)===!0,Wn=(Pe==null?void 0:Pe.checkboxStyle)??"square",kr=(Pe==null?void 0:Pe.rowStatus)??!1,jo=(Pe==null?void 0:Pe.rowStatusWidth)??40,Io=Pe==null?void 0:Pe.rowStatusTheme,Kn=Math.max(Xt,20),Do=Math.max(Cn,Kn),li=Math.max(vt??Do,Kn),Sr=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:ye,rowNumberMapper:Zo,rowHeight:si,getRowThemeOverride:gn}=Nd(xt,p,ti,b),ai=s.useMemo(()=>Number.parseFloat(Sr.fontSize),[Sr]),{rowHeight:mn,headerHeight:Un,groupHeaderHeight:Fo,theme:To,overscrollX:ci,overscrollY:Ho}=Bd({groupHeaderHeight:Yn,headerHeight:kn,overscrollX:Co,overscrollY:xo,remSize:ai,rowHeight:si,scaleToRem:ei,theme:ni}),Mn=Wd(Ze),ln=ii??(p>1e4?48:p>1e3?44:p>100?36:32),sn=Yt!=="none",lo=kr===!0,h=(lo?1:0)+(sn?Ut?2:1:0),O=Ye!==void 0,le=(Ye==null?void 0:Ye.sticky)===!0,[ue,Z]=s.useState(!1),ae=fn??ue,De=s.useCallback(()=>{Mt!==void 0?Mt():Z(!1)},[Mt]),S=s.useMemo(()=>Dt===void 0?void 0:Xr(Dt,h),[Dt,h])??n,it=s.useRef(new AbortController);s.useEffect(()=>()=>it==null?void 0:it.current.abort(),[]);const[oe,lt]=Cd(Q,R,h,it.current,ye),bt=s.useCallback((a,v,C)=>{if(pt===void 0)return!0;const M=[a[0]-h,a[1]];return pt==null?void 0:pt(M,v,C)},[h,pt]),st=s.useRef(Dt),Ve=s.useCallback((a,v)=>{v&&(a=Id(a,oe,h,ie,it.current)),qt!==void 0?(st.current=Xr(a,-h),qt(st.current)):o(a)},[qt,oe,h,ie]),yt=Qn(nt,s.useCallback((a,v,C,M)=>{nt==null||nt(k[C-h],v,C-h,M)},[nt,h,k])),Tt=Qn(tt,s.useCallback((a,v,C,M)=>{tt==null||tt(k[C-h],v,C-h,M)},[tt,h,k])),wn=Qn(Ke,s.useCallback((a,v,C,M)=>{Ke==null||Ke(k[C-h],v,C-h,M)},[Ke,h,k])),Rn=Qn(E,s.useCallback((a,v)=>(E==null?void 0:E({...a,columnIndex:a.columnIndex-h},v))??!1,[E,h])),an=Qn($,s.useCallback((a,v)=>($==null?void 0:$({...a,col:a.col-h},v))??!1,[$,h])),Ot=s.useCallback(a=>{if(rt!==void 0){const v=rt(Xr(a,-h));return typeof v=="boolean"?v:Xr(v,h)}return!0},[rt,h]),[Fe,kt,ut]=vd(S,Ve,ve,Ee,Ce,wt,T),zt=s.useMemo(()=>Nn(is(),To),[To]),[En,so]=s.useState([0,0,0]),$n=s.useMemo(()=>{if(Mo===void 0)return{};const a={};for(const v of Mo)a[v.kind]=v;return a},[Mo]),$t=s.useCallback(a=>a.kind!==J.Custom?$n[a.kind]:Wt==null?void 0:Wt.find(v=>v.isMatch(a)),[Wt,$n]);let{sizedColumns:Nt,nonGrowWidth:Mr}=Ua(k,ye,lt,En[0]-(h===0?0:ln)-En[2],Kn,li,zt,$t,it.current);Yt!=="none"&&(Mr+=ln);const Jo=s.useMemo(()=>Nt.some(a=>a.group!==void 0),[Nt]),Qo=Jo?Un+Fo:Un,Vi=S.rows.length,qi=Yt==="none"?void 0:Vi===0?!1:Vi===ye?!0:void 0,qe=s.useMemo(()=>{const a=[];return Yt!=="none"&&(Ut&&a.push({title:"",width:ln,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Vo,rowMarker:Wn,rowMarkerChecked:!1,headerRowMarkerTheme:qo,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),a.push({title:"",width:ln,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Vo,rowMarker:Wn,rowMarkerChecked:qi,headerRowMarkerTheme:qo,headerRowMarkerAlwaysVisible:xr,headerRowMarkerDisabled:io})),lo&&a.push({title:"",width:jo,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Io}),[...a,...Nt]},[lo,jo,Io,Yt,Nt,ln,Vo,Wn,qi,qo,xr,io,Ut]),Jt=s.useRef({height:1,width:1,x:0,y:0}),Rr=s.useRef(!1),{setVisibleRegion:ji,visibleRegion:ao,scrollRef:at}=Yd(xn,An,mn,Jt,()=>Rr.current=!0);Jt.current=ao;const Ms=ao.x+h,Er=ao.y,Pt=s.useRef(null),Gt=s.useCallback(a=>{var v;a===!0?(v=Pt.current)==null||v.focus():window.requestAnimationFrame(()=>{var C;(C=Pt.current)==null||C.focus()})},[]),Lt=O?ye+1:ye,cn=s.useCallback(a=>{const v=h===0?a:a.map(M=>({...M,location:[M.location[0]-h,M.location[1]]})),C=ge==null?void 0:ge(v);if(C!==!0)for(const M of v)ee==null||ee(M.location,M.value);return C},[ee,ge,h]),[co,di]=s.useState(),Ir=S.current!==void 0&&S.current.range.width*S.current.range.height>1?S.current.range:void 0,Ao=Ro?(dl=S.current)==null?void 0:dl.cell:void 0,Dr=Ao==null?void 0:Ao[0],Fr=Ao==null?void 0:Ao[1],Rs=s.useMemo(()=>{if((mt===void 0||mt.length===0)&&(Ir??Dr??Fr??co)===void 0)return;const a=[];if(mt!==void 0)for(const v of mt){const C=qe.length-v.range.x-h;C>0&&a.push({color:v.color,range:{...v.range,x:v.range.x+h,width:Math.min(C,v.range.width)},style:v.style})}return co!==void 0&&a.push({color:yo(zt.accentColor,0),range:co,style:"dashed"}),Ir!==void 0&&a.push({color:yo(zt.accentColor,.5),range:Ir,style:"solid-outline"}),Dr!==void 0&&Fr!==void 0&&a.push({color:zt.accentColor,range:{x:Dr,y:Fr,width:1,height:1},style:"solid-outline"}),a.length>0?a:void 0},[co,Ir,Dr,Fr,mt,qe.length,zt.accentColor,h]),Zi=s.useRef(qe);Zi.current=qe;const Qt=s.useCallback(([a,v],C=!1)=>{var P,G,j,ce,ne,Oe,ke,Qe,ze;const M=O&&v===Lt-1;let H=0;const N=sn&&Ut?H++:-1,F=sn?H++:-1,I=lo?H++:-1;if(a===N){if(M)return mo;const re=Zo(v);return re===void 0?mo:{kind:_t.Marker,allowOverlay:!1,checkboxStyle:Wn,checked:!1,markerKind:"number",row:Eo+re,drawHandle:!1,cursor:void 0,disabled:((P=e.disabledRows)==null?void 0:P.call(e,v))===!0}}if(a===F){if(M)return mo;const re=Zo(v);if(re===void 0)return mo;let Re;return Ut?Re=Yt==="checkbox-visible"?"checkbox-visible":"checkbox":Yt==="clickable-number"?Re="number":Re=Yt,{kind:_t.Marker,allowOverlay:!1,checkboxStyle:Wn,checked:(S==null?void 0:S.rows.hasIndex(v))===!0,markerKind:Re,row:Eo+re,drawHandle:Xn!==void 0,cursor:Ut?void 0:Yt==="clickable-number"?"pointer":void 0,disabled:((G=e.disabledRows)==null?void 0:G.call(e,v))===!0}}if(a===I){if(M)return mo;const re=ro==null?void 0:ro(v);return{kind:_t.RowStatus,allowOverlay:!1,status:re,themeOverride:Io}}if(M){const Re=a===h?(Ye==null?void 0:Ye.hint)??"":"",_e=Zi.current[a];if(((j=_e==null?void 0:_e.trailingRowOptions)==null?void 0:j.disabled)===!0)return mo;{const Te=((ce=_e==null?void 0:_e.trailingRowOptions)==null?void 0:ce.hint)??Re,ft=((ne=_e==null?void 0:_e.trailingRowOptions)==null?void 0:ne.addIcon)??(Ye==null?void 0:Ye.addIcon);return{kind:_t.NewRow,hint:Te,allowOverlay:!1,icon:ft}}}else{const re=a-h;if(C||(Ue==null?void 0:Ue.strict)===!0){const _e=Jt.current,Te=_e.x>re||re>_e.x+_e.width||_e.y>v||v>_e.y+_e.height||v>=gi.current,ft=re===((ke=(Oe=_e.extras)==null?void 0:Oe.selected)==null?void 0:ke[0])&&v===((Qe=_e.extras)==null?void 0:Qe.selected[1]);let Ft=!1;if(((ze=_e.extras)==null?void 0:ze.freezeRegions)!==void 0){for(const en of _e.extras.freezeRegions)if(bo(en,re,v)){Ft=!0;break}}if(Te&&!ft&&!Ft)return mo}let Re=R([re,v]);return h!==0&&Re.span!==void 0&&(Re={...Re,span:[Re.span[0]+h,Re.span[1]+h]}),Re}},[O,Lt,lo,ro,Io,sn,Zo,Wn,S==null?void 0:S.rows,Yt,Eo,Xn,h,Ye==null?void 0:Ye.hint,Ye==null?void 0:Ye.addIcon,Ue==null?void 0:Ue.strict,R,Ut]),ui=s.useCallback(a=>{let v=(ht==null?void 0:ht(a))??{name:a};return be!==void 0&&a!==""&&(v={icon:v.icon,name:v.name,overrideTheme:v.overrideTheme,actions:[...v.actions??[],{title:"Rename",icon:"renameIcon",onClick:C=>wi({group:v.name,bounds:C.bounds})}]}),v},[ht,be]),zo=s.useCallback(a=>{var I;const[v,C]=a.cell,M=qe[v],H=(M==null?void 0:M.group)!==void 0?(I=ui(M.group))==null?void 0:I.overrideTheme:void 0,N=M==null?void 0:M.themeOverride,F=gn==null?void 0:gn(C);i({...a,theme:Nn(zt,H,N,F,a.content.themeOverride)})},[gn,qe,ui,zt]),er=s.useCallback((a,v,C)=>{var F;if(S.current===void 0)return;const[M,H]=S.current.cell,N=Qt([M,H]);if(N.kind!==J.Boolean&&N.allowOverlay){let I=N;if(C!==void 0)switch(I.kind){case J.Number:{const P=fa(()=>C==="-"?-0:Number.parseFloat(C),0);I={...I,data:Number.isNaN(P)?0:P};break}case J.Text:case J.Markdown:case J.Uri:I={...I,data:C};break}zo({target:a,content:I,initialValue:C,cell:[M,H],highlight:C===void 0,forceEditMode:C!==void 0,activation:v})}else N.kind===J.Boolean&&v.inputType==="keyboard"&&N.readonly!==!0&&(cn([{location:S.current.cell,value:{...N,data:vs(N.data)}}]),(F=Pt.current)==null||F.damage([{cell:S.current.cell}]))},[Qt,S,cn,zo]),Ji=s.useCallback((a,v)=>{var H;const C=(H=Pt.current)==null?void 0:H.getBounds(a,v);if(C===void 0||at.current===null)return;const M=Qt([a,v]);M.allowOverlay&&zo({target:C,content:M,initialValue:void 0,highlight:!0,cell:[a,v],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Qt,at,zo]),Rt=s.useCallback((a,v,C="both",M=0,H=0,N=void 0)=>{if(at.current!==null){const F=Pt.current,I=l.current,P=typeof a!="number"?a.unit==="cell"?a.amount:void 0:a,G=typeof v!="number"?v.unit==="cell"?v.amount:void 0:v,j=typeof a!="number"&&a.unit==="px"?a.amount:void 0,ce=typeof v!="number"&&v.unit==="px"?v.amount:void 0;if(F!==null&&I!==null){let ne={x:0,y:0,width:0,height:0},Oe=0,ke=0;if((P!==void 0||G!==void 0)&&(ne=F.getBounds((P??0)+h,G??0)??ne,ne.width===0||ne.height===0))return;const Qe=I.getBoundingClientRect(),ze=Qe.width/I.offsetWidth;if(j!==void 0&&(ne={...ne,x:j-Qe.left-at.current.scrollLeft,width:1}),ce!==void 0&&(ne={...ne,y:ce+Qe.top-at.current.scrollTop,height:1}),ne!==void 0){const re={x:ne.x-M,y:ne.y-H,width:ne.width+2*M,height:ne.height+2*H};let Re=0;for(let ki=0;ki<Ne;ki++)Re+=Nt[ki].width;let _e=0;const Te=At+(le?1:0);Te>0&&(_e=po(Lt,Te,mn));let ft=Re*ze+Qe.left+h*ln*ze,Ft=Qe.right,en=Qe.top+Qo*ze,Dn=Qe.bottom-_e*ze;const Br=ne.width+M*2;switch(N==null?void 0:N.hAlign){case"start":Ft=ft+Br;break;case"end":ft=Ft-Br;break;case"center":ft=Math.floor((ft+Ft)/2)-Br/2,Ft=ft+Br;break}const Wr=ne.height+H*2;switch(N==null?void 0:N.vAlign){case"start":Dn=en+Wr;break;case"end":en=Dn-Wr;break;case"center":en=Math.floor((en+Dn)/2)-Wr/2,Dn=en+Wr;break}ft>re.x?Oe=re.x-ft:Ft<re.x+re.width&&(Oe=re.x+re.width-Ft),en>re.y?ke=re.y-en:Dn<re.y+re.height&&(ke=re.y+re.height-Dn),C==="vertical"||typeof a=="number"&&a<Ne?Oe=0:(C==="horizontal"||typeof v=="number"&&v>=Lt-Te)&&(ke=0),(Oe!==0||ke!==0)&&(ze!==1&&(Oe/=ze,ke/=ze),at.current.scrollTo({left:Oe+at.current.scrollLeft,top:ke+at.current.scrollTop,behavior:(N==null?void 0:N.behavior)??"auto"}))}}}},[h,At,ln,at,Qo,Ne,Nt,Lt,le,mn]),fi=s.useRef(Ji),hi=s.useRef(R);fi.current=Ji,hi.current=R;const gi=s.useRef(ye);gi.current=ye;const Qi=s.useRef(qe.length);Qi.current=qe.length;const Vn=s.useCallback(async(a,v=!0,C)=>{var G;const M=qe[a];if(((G=M==null?void 0:M.trailingRowOptions)==null?void 0:G.disabled)===!0)return;const H=pe==null?void 0:pe();let N,F=!0;H!==void 0&&(N=await H,N==="top"&&(F=!1),typeof N=="number"&&(F=!1));let I=0;const P=()=>{if(gi.current<=ye){I<500&&window.setTimeout(P,I),I=50+I*2;return}const j=typeof N=="number"?N:F?ye:0;Lr.current(a-h,j,"both",0,20,C?{behavior:C}:void 0),Fe({cell:[a,j],range:{x:a,y:j,width:1,height:1}},!1,!1,"edit");const ce=hi.current([a-h,j]);ce.allowOverlay&&No(ce)&&ce.readonly!==!0&&v&&window.setTimeout(()=>{fi.current(a,j)},0)};P()},[qe,pe,h,ye,Fe]),Tr=s.useCallback(async(a,v=!0)=>{const C=Ae==null?void 0:Ae();let M,H=!0;C!==void 0&&(M=await C,M==="left"&&(H=!1),typeof M=="number"&&(H=!1));let N=0;const F=()=>{if(Qi.current<=qe.length){N<500&&window.setTimeout(F,N),N=50+N*2;return}const I=typeof M=="number"?M:H?qe.length:0;Rt(I-h,a),Fe({cell:[I,a],range:{x:I,y:a,width:1,height:1}},!1,!1,"edit");const P=hi.current([I-h,a]);P.allowOverlay&&No(P)&&P.readonly!==!0&&v&&window.setTimeout(()=>{fi.current(I,a)},0)};F()},[qe,Ae,h,Rt,Fe]),Po=s.useCallback(a=>{var C,M;const v=((M=(C=Nt[a])==null?void 0:C.trailingRowOptions)==null?void 0:M.targetColumn)??(Ye==null?void 0:Ye.targetColumn);if(typeof v=="number")return v+(sn?1:0);if(typeof v=="object"){const H=k.indexOf(v);if(H>=0)return H+(sn?1:0)}},[Nt,k,sn,Ye==null?void 0:Ye.targetColumn]),qn=s.useRef(void 0),Lo=s.useRef(void 0),tr=s.useCallback((a,v)=>{var H;const[C,M]=v;return Nn(zt,(H=qe[C])==null?void 0:H.themeOverride,gn==null?void 0:gn(M),a.themeOverride)},[gn,qe,zt]),{mapper:uo}=Od(xt,p),bn=xt==null?void 0:xt.navigationBehavior,nr=s.useCallback(a=>{var G,j,ce;const v=qr.value?a.metaKey:a.ctrlKey,C=v&&me==="multi",[M,H]=a.location,N=S.columns,F=S.rows,[I,P]=((G=S.current)==null?void 0:G.cell)??[];if(a.kind==="cell"){if(Lo.current=void 0,fo.current=[M,H],M===(Ut?1:0)&&sn){if(O===!0&&H===ye||Yt==="number"||me==="none")return;const ke=Qt(a.location);if(ke.kind!==_t.Marker||ke.disabled===!0)return;if(Xn!==void 0){const re=$t(ke);tn((re==null?void 0:re.kind)===_t.Marker);const Re=(j=re==null?void 0:re.onClick)==null?void 0:j.call(re,{...a,cell:ke,posX:a.localEventX,posY:a.localEventY,bounds:a.bounds,theme:tr(ke,a.location),preventDefault:()=>{}});if(Re===void 0||Re.checked===ke.checked)return}i(void 0),Gt();const Qe=F.hasIndex(H),ze=qn.current;if(me==="multi"&&(a.shiftKey||a.isLongTouch===!0)&&ze!==void 0&&F.hasIndex(ze)){const re=[Math.min(ze,H),Math.max(ze,H)+1];C||Et==="multi"?kt(void 0,re,!0):kt(ot.fromSingleSelection(re),void 0,C)}else me==="multi"&&(C||a.isTouch||Et==="multi")?Qe?kt(F.remove(H),void 0,!0):(kt(void 0,H,!0),qn.current=H):Qe&&F.length===1?kt(ot.empty(),void 0,v):(kt(ot.fromSingleSelection(H),void 0,v),qn.current=H)}else if(M>=h&&O&&H===ye){const ke=Po(M);Vn(ke??M)}else if(I!==M||P!==H){const ke=Qt(a.location),Qe=$t(ke);if((Qe==null?void 0:Qe.onSelect)!==void 0){let Re=!1;if(Qe.onSelect({...a,cell:ke,posX:a.localEventX,posY:a.localEventY,bounds:a.bounds,preventDefault:()=>Re=!0,theme:tr(ke,a.location)}),Re)return}if(bn==="block"&&uo(H).isGroupHeader)return;const ze=le&&H===ye,re=le&&S!==void 0&&((ce=S.current)==null?void 0:ce.cell[1])===ye;if((a.shiftKey||a.isLongTouch===!0)&&I!==void 0&&P!==void 0&&S.current!==void 0&&!re){if(ze)return;const Re=Math.min(M,I),_e=Math.max(M,I),Te=Math.min(H,P),ft=Math.max(H,P);Fe({...S.current,range:{x:Re,y:Te,width:_e-Re+1,height:ft-Te+1}},!0,v,"click"),qn.current=void 0,Gt()}else Fe({cell:[M,H],range:{x:M,y:H,width:1,height:1}},!0,v,"click"),qn.current=void 0,i(void 0),Gt()}}else if(a.kind==="header")if(fo.current=[M,H],i(void 0),sn&&M===0)qn.current=void 0,Lo.current=void 0,!io&&me==="multi"&&(F.length!==ye?kt(ot.fromSingleSelection([0,ye]),void 0,v):kt(ot.empty(),void 0,v),Gt());else{const ne=Lo.current;if(V==="multi"&&(a.shiftKey||a.isLongTouch===!0)&&ne!==void 0&&N.hasIndex(ne)){const Oe=[Math.min(ne,M),Math.max(ne,M)+1];v||a.isTouch||It==="multi"?ut(void 0,Oe,v):ut(ot.fromSingleSelection(Oe),void 0,v)}else V==="multi"&&(v||a.isTouch||It==="multi")?(N.hasIndex(M)?ut(N.remove(M),void 0,v):ut(void 0,M,v),Lo.current=M):V!=="none"&&(N.hasIndex(M)?ut(N.remove(M),void 0,v):ut(ot.fromSingleSelection(M),void 0,v),Lo.current=M);qn.current=void 0,Gt()}else a.kind===pn?fo.current=[M,H]:a.kind===jr&&!a.isMaybeScrollbar&&(Ve(Di,!1),i(void 0),Gt(),Ht==null||Ht(),qn.current=void 0,Lo.current=void 0)},[me,V,S,sn,h,O,ye,Yt,Qt,Xn,Gt,Et,It,$t,tr,kt,Po,Vn,bn,uo,le,Fe,io,ut,Ve,Ht]),or=s.useRef(!1),fo=s.useRef(void 0),el=s.useRef(ao),dn=s.useRef(void 0),Es=s.useCallback(a=>{if(Bo.current=!1,el.current=Jt.current,a.button!==0&&a.button!==1){dn.current=void 0;return}const v=performance.now();dn.current={button:a.button,time:v,location:a.location},(a==null?void 0:a.kind)==="header"&&(or.current=!0);const C=a.kind==="cell"&&a.isFillHandle;!C&&a.kind!=="cell"&&a.isEdge||(f({previousSelection:S,fillHandle:C}),fo.current=void 0,!a.isTouch&&a.button===0&&!C?nr(a):!a.isTouch&&a.button===1&&(fo.current=a.location))},[S,nr]),[mi,wi]=s.useState(),tl=s.useCallback(a=>{if(a.kind!==pn||V!=="multi")return;const v=qr.value?a.metaKey:a.ctrlKey,[C]=a.location,M=S.columns;if(C<h)return;const H=qe[C];let N=C,F=C;for(let I=C-1;I>=h&&gr(H.group,qe[I].group);I--)N--;for(let I=C+1;I<qe.length&&gr(H.group,qe[I].group);I++)F++;if(Gt(),v||a.isTouch||It==="multi")if(M.hasAll([N,F+1])){let I=M;for(let P=N;P<=F;P++)I=I.remove(P);ut(I,void 0,v)}else ut(void 0,[N,F+1],v);else ut(ot.fromSingleSelection([N,F+1]),void 0,v)},[V,Gt,S.columns,qe,h,ut,It]),Bo=s.useRef(!1),Hr=s.useCallback(async a=>{if(oe!==void 0&&yt!==void 0){const v=Jt.current.y,C=Jt.current.height;let M=oe({x:a,y:v,width:1,height:Math.min(C,ye-v)},it.current.signal);typeof M!="object"&&(M=await M());const H=Nt[a-h],F=document.createElement("canvas").getContext("2d",{alpha:!1});if(F!==null){F.font=zt.baseFontFull;const I=ss(F,zt,H,0,M,Kn,Do,!1,$t);yt==null||yt(H,I.width,a,I.width)}}},[Nt,oe,Do,zt,Kn,yt,h,ye,$t]),[Is,bi]=s.useState(),Wo=s.useCallback(async(a,v)=>{var I,P;const C=(I=a.current)==null?void 0:I.range;if(C===void 0||oe===void 0||v.current===void 0)return;const M=v.current.range;if(A!==void 0){let G=!1;if(A({fillDestination:{...M,x:M.x-h},patternSource:{...C,x:C.x-h},preventDefault:()=>G=!0}),G)return}let H=oe(C,it.current.signal);typeof H!="object"&&(H=await H());const N=H,F=[];for(let G=0;G<M.width;G++)for(let j=0;j<M.height;j++){const ce=[M.x+G,M.y+j];if(ql(ce,C))continue;const ne=N[j%C.height][G%C.width];Oo(ne)||!No(ne)||F.push({location:ce,value:{...ne}})}cn(F),(P=Pt.current)==null||P.damage(F.map(G=>({cell:G.location})))},[oe,cn,A,h]),nl=s.useCallback(()=>{if(S.current===void 0||S.current.range.width<=1)return;const a={...S,current:{...S.current,range:{...S.current.range,width:1}}};Wo(a,S)},[Wo,S]),ol=s.useCallback(()=>{if(S.current===void 0||S.current.range.height<=1)return;const a={...S,current:{...S.current,range:{...S.current.range,height:1}}};Wo(a,S)},[Wo,S]),Ds=s.useCallback((a,v)=>{var j,ce;const C=c;if(f(void 0),di(void 0),bi(void 0),or.current=!1,v)return;if((C==null?void 0:C.fillHandle)===!0&&S.current!==void 0&&((j=C.previousSelection)==null?void 0:j.current)!==void 0){if(co===void 0)return;const ne={...S,current:{...S.current,range:fs(C.previousSelection.current.range,co)}};Wo(C.previousSelection,ne),Ve(ne,!0);return}const[M,H]=a.location,[N,F]=fo.current??[],I=()=>{Bo.current=!0},P=ne=>{var ke,Qe,ze;const Oe=ne.isTouch||N===M&&F===H;if(Oe&&(W==null||W([M-h,H],{...ne,preventDefault:I})),ne.button===1)return!Bo.current;if(!Bo.current){const re=Qt(a.location),Re=$t(re);if(Re!==void 0&&Re.onClick!==void 0&&Oe){const Te=Re.onClick({...ne,cell:re,posX:ne.localEventX,posY:ne.localEventY,bounds:ne.bounds,theme:tr(re,a.location),preventDefault:I});Te!==void 0&&!Oo(Te)&&$o(Te)&&(cn([{location:ne.location,value:Te}]),(ke=Pt.current)==null||ke.damage([{cell:ne.location}]))}if(Bo.current||S.current===void 0)return!1;let _e=!1;switch(re.activationBehaviorOverride??Xe){case"double-click":case"second-click":{if(((ze=(Qe=C==null?void 0:C.previousSelection)==null?void 0:Qe.current)==null?void 0:ze.cell)===void 0)break;const[Te,ft]=S.current.cell,[Ft,en]=C.previousSelection.current.cell;_e=M===Te&&M===Ft&&H===ft&&H===en&&(ne.isDoubleClick===!0||Xe==="second-click");break}case"single-click":{_e=!0;break}}if(_e){const ft={inputType:"pointer",pointerActivation:ne.isDoubleClick===!0?"double-click":re.activationBehaviorOverride??Xe,pointerType:ne.isTouch?"touch":"mouse"};return L==null||L([M-h,H],ft),er(ne.bounds,ft),!0}}return!1},G=a.location[0]-h;if(a.isTouch){const ne=Jt.current,Oe=el.current;if(ne.x!==Oe.x||ne.y!==Oe.y)return;if(a.isLongTouch===!0){if(a.kind==="cell"&&ur((ce=S.current)==null?void 0:ce.cell,a.location)){he==null||he([G,a.location[1]],{...a,preventDefault:I});return}else if(a.kind==="header"&&S.columns.hasIndex(M)){we==null||we(G,{...a,preventDefault:I});return}else if(a.kind===pn){if(G<0)return;_==null||_(G,{...a,preventDefault:I});return}}a.kind==="cell"?P(a)||nr(a):a.kind===pn?U==null||U(G,{...a,preventDefault:I}):(a.kind===eo&&(B==null||B(G,{...a,preventDefault:I})),nr(a));return}if(a.kind==="header"){if(G<0)return;a.isEdge?a.isDoubleClick===!0&&Hr(M):a.button===0&&M===N&&H===F&&(B==null||B(G,{...a,preventDefault:I}))}if(a.kind===pn){if(G<0)return;a.button===0&&M===N&&H===F&&(U==null||U(G,{...a,preventDefault:I}),Bo.current||tl(a))}a.kind==="cell"&&(a.button===0||a.button===1)&&P(a),fo.current=void 0},[c,S,h,co,Wo,Ve,W,Qt,$t,Xe,tr,cn,L,er,he,we,_,nr,U,B,Hr,tl]),Fs=s.useCallback(a=>{const v={...a,location:[a.location[0]-h,a.location[1]]};dt==null||dt(v),c!==void 0&&a.buttons===0&&(f(void 0),di(void 0),bi(void 0),or.current=!1),bi(C=>{var M;return or.current?[a.scrollEdge[0],0]:a.scrollEdge[0]===(C==null?void 0:C[0])&&a.scrollEdge[1]===C[1]?C:c===void 0||(((M=dn.current)==null?void 0:M.location[0])??0)<h?void 0:a.scrollEdge})},[c,dt,h]),Ts=s.useCallback((a,v)=>{Se==null||Se(a-h,v)},[Se,h]),Hs=s.useCallback((a,v)=>{xe==null||xe(a-h,v)},[xe,h]);s.useEffect(()=>{if(r===void 0)return;const a=M=>{const H=[];let N=M.parentElement;for(;N&&N!==document.documentElement;){const F=window.getComputedStyle(N),I=F.overflow+F.overflowY+F.overflowX;(I.includes("scroll")||I.includes("auto"))&&H.push(N),N=N.parentElement}return H},v=M=>{const H=M.target;at.current&&!at.current.contains(H)&&i(void 0)},C=[];if(at.current){const M=a(at.current);C.push(...M)}return C.forEach(M=>{M.addEventListener("scroll",v)}),window.addEventListener("scroll",v),document.addEventListener("scroll",v,!0),()=>{C.forEach(M=>{M.removeEventListener("scroll",v)}),window.removeEventListener("scroll",v),document.removeEventListener("scroll",v,!0)}},[r,i,at]);const In=(ul=S==null?void 0:S.current)==null?void 0:ul.cell,As=s.useCallback((a,v,C,M,H,N)=>{if(Rr.current=!1,r!==void 0){const j=Jt.current;(j.x!==a.x||j.y!==a.y)&&i(void 0)}let F=In;F!==void 0&&(F=[F[0]-h,F[1]]);const I=Ne===0?void 0:{x:0,y:a.y,width:Ne,height:a.height},P=[];I!==void 0&&P.push(I),At>0&&(P.push({x:a.x-h,y:ye-At,width:a.width,height:At}),Ne>0&&P.push({x:0,y:ye-At,width:Ne,height:At}));const G={x:a.x-h,y:a.y,width:a.width,height:O&&a.y+a.height>=ye?a.height-1:a.height,tx:H,ty:N,extras:{selected:F,freezeRegion:I,freezeRegions:P}};Jt.current=G,ji(G),so([v,C,M]),rn==null||rn(G,G.tx,G.ty,G.extras)},[In,r,h,O,ye,Ne,At,i,ji,rn]),zs=Qn(D,s.useCallback((a,v)=>(D==null?void 0:D(a-h,v-h))!==!1,[D,h])),Ps=Qn(Ie,s.useCallback((a,v)=>{Ie==null||Ie(a-h,v-h),V!=="none"&&ut(ot.fromSingleSelection(v),void 0,!0)},[V,Ie,h,ut])),yi=s.useRef(!1),Ls=s.useCallback(a=>{if(a.location[0]===0&&h>0){a.preventDefault();return}et==null||et({...a,location:[a.location[0]-h,a.location[1]]}),a.defaultPrevented()||(yi.current=!0),f(void 0)},[et,h]),Bs=s.useCallback(()=>{yi.current=!1},[]),rl=xt==null?void 0:xt.selectionBehavior,Ar=s.useCallback(a=>{if(rl!=="block-spanning")return;const{isGroupHeader:v,path:C,groupRows:M}=uo(a);if(v)return[a,a];const H=C[C.length-1],N=a-H,F=a+M-H-1;return[N,F]},[uo,rl]),pi=s.useRef(void 0),vi=s.useCallback(a=>{var v,C,M;if(!ys(a,pi.current)&&(pi.current=a,!(((v=dn==null?void 0:dn.current)==null?void 0:v.button)!==void 0&&dn.current.button>=1))){if(a.buttons!==0&&c!==void 0&&((C=dn.current)==null?void 0:C.location[0])===0&&h===1&&me==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(dn.current.location[1])&&S.rows.hasIndex(dn.current.location[1])){const H=Math.min(dn.current.location[1],a.location[1]),N=Math.max(dn.current.location[1],a.location[1])+1;kt(ot.fromSingleSelection([H,N]),void 0,!1)}else if(a.buttons!==0&&c!==void 0&&S.current!==void 0&&!yi.current&&!or.current&&(wt==="rect"||wt==="multi-rect")){const[H,N]=S.current.cell;let[F,I]=a.location;if(I<0&&(I=Jt.current.y),c.fillHandle===!0&&((M=c.previousSelection)==null?void 0:M.current)!==void 0){const P=c.previousSelection.current.range;I=Math.min(I,O?ye-1:ye);const G=Ec(P,F,I,Zt);di(G)}else{if(O&&N===ye)return;if(O&&I===ye)if(a.kind===jr)I--;else return;F=Math.max(F,h);const j=Ar(N);I=j===void 0?I:un(I,j[0],j[1]);const ce=F-H,ne=I-N,Oe={x:ce>=0?H:F,y:ne>=0?N:I,width:Math.abs(ce)+1,height:Math.abs(ne)+1};Fe({...S.current,range:Oe},!0,!1,"drag")}}Bt==null||Bt({...a,location:[a.location[0]-h,a.location[1]]})}},[c,h,me,S,wt,Bt,kt,O,ye,Zt,Ar,Fe]),Ws=s.useCallback(()=>{var F,I;const a=pi.current;if(a===void 0)return;const[v,C]=a.scrollEdge;let[M,H]=a.location;const N=Jt.current;v===-1?M=((I=(F=N.extras)==null?void 0:F.freezeRegion)==null?void 0:I.x)??N.x:v===1&&(M=N.x+N.width),C===-1?H=Math.max(0,N.y):C===1&&(H=Math.min(ye-1,N.y+N.height)),M=un(M,0,qe.length-1),H=un(H,0,ye-1),vi({...a,location:[M,H]})},[qe.length,vi,ye]);Ld(Is,at,Ws);const yn=s.useCallback(a=>{if(S.current===void 0)return;const[v,C]=a,[M,H]=S.current.cell,N=S.current.range;let F=N.x,I=N.x+N.width,P=N.y,G=N.y+N.height;const[j,ce]=Ar(H)??[0,ye-1],ne=ce+1;if(C!==0)switch(C){case 2:{G=ne,P=H,Rt(0,G,"vertical");break}case-2:{P=j,G=H+1,Rt(0,P,"vertical");break}case 1:{P<H?(P++,Rt(0,P,"vertical")):(G=Math.min(ne,G+1),Rt(0,G,"vertical"));break}case-1:{G>H+1?(G--,Rt(0,G,"vertical")):(P=Math.max(j,P-1),Rt(0,P,"vertical"));break}default:hr()}if(v!==0)if(v===2)I=qe.length,F=M,Rt(I-1-h,0,"horizontal");else if(v===-2)F=h,I=M+1,Rt(F-h,0,"horizontal");else{let Oe=[];if(oe!==void 0){const ke=oe({x:F,y:P,width:I-F-h,height:G-P},it.current.signal);typeof ke=="object"&&(Oe=Kd(ke))}if(v===1){let ke=!1;if(F<M){if(Oe.length>0){const Qe=wo(F+1,M+1).find(ze=>!Oe.includes(ze-h));Qe!==void 0&&(F=Qe,ke=!0)}else F++,ke=!0;ke&&Rt(F,0,"horizontal")}ke||(I=Math.min(qe.length,I+1),Rt(I-1-h,0,"horizontal"))}else if(v===-1){let ke=!1;if(I>M+1){if(Oe.length>0){const Qe=wo(I-1,M,-1).find(ze=>!Oe.includes(ze-h));Qe!==void 0&&(I=Qe,ke=!0)}else I--,ke=!0;ke&&Rt(I-h,0,"horizontal")}ke||(F=Math.max(h,F-1),Rt(F-h,0,"horizontal"))}else hr()}Fe({cell:S.current.cell,range:{x:F,y:P,width:I-F,height:G-P}},!0,!1,"keyboard-select")},[oe,Ar,S,qe.length,h,ye,Rt,Fe]),Ci=s.useRef(oo);Ci.current=oo;const jn=s.useCallback((a,v,C,M)=>{const H=Lt-(C?0:1);a=un(a,h,Nt.length-1+h),v=un(v,0,H);const N=In==null?void 0:In[0],F=In==null?void 0:In[1];if(a===N&&v===F)return!1;if(M&&S.current!==void 0){const I=[...S.current.rangeStack];(S.current.range.width>1||S.current.range.height>1)&&I.push(S.current.range),Ve({...S,current:{cell:[a,v],range:{x:a,y:v,width:1,height:1},rangeStack:I}},!0)}else Fe({cell:[a,v],range:{x:a,y:v,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===a&&u.current[1]===v&&(u.current=void 0),Ci.current&&Rt(a-h,v,"both",0,20),!0},[Lt,h,Nt.length,In,S,Rt,Ve,Fe]),$s=s.useCallback((a,v)=>{(r==null?void 0:r.cell)!==void 0&&a!==void 0&&$o(a)&&(cn([{location:r.cell,value:a}]),window.requestAnimationFrame(()=>{var H;(H=Pt.current)==null||H.damage([{cell:r.cell}])})),Gt(!0),i(void 0);const[C,M]=v;if(S.current!==void 0&&(C!==0||M!==0)){const H=S.current.cell[1]===Lt-1;if(H&&M===1){z==null||z(a,[0,0]);return}const N=S.current.cell[0]===qe.length-1&&a!==void 0;let F=!0;if(H&&M===1&&pe!==void 0){F=!1;const I=S.current.cell[0]+C,P=Po(I);Vn(P??I,!1)}if(N&&C===1&&Ae!==void 0){F=!1;const I=S.current.cell[1]+M;Tr(I,!1)}if(F){let I=S.current.cell[0]+C,P=S.current.cell[1]+M,G=!1;Sn&&C===1&&M===0?I>=qe.length?P>=Lt-1?(I=S.current.cell[0],P=S.current.cell[1],G=!1):(I=h,P+=1,G=!0):G=!0:(I=un(I,h,qe.length-1),P=un(P,0,Lt-1),G=Sn===!0&&C===0&&M===1),jn(I,P,H,!1),G&&window.setTimeout(()=>{var ce;const j=R([I-h,P]);if(No(j)){const ne=(ce=Pt.current)==null?void 0:ce.getBounds(I,P);if(ne&&j.allowOverlay){const Oe={inputType:"keyboard",key:"Enter"};L==null||L([I-h,P],Oe),zo({target:ne,content:j,initialValue:void 0,cell:[I,P],highlight:!0,forceEditMode:!0,activation:Oe})}}},50)}}z==null||z(a,v)},[r==null?void 0:r.cell,Gt,S,z,cn,Lt,jn,qe.length,Vn,Tr,pe,Ae,Po,R,h,L,zo,Sn]),Ns=s.useMemo(()=>`gdg-overlay-${_d++}`,[]),ho=s.useCallback(a=>{var C,M,H,N;Gt();const v=[];for(let F=a.x;F<a.x+a.width;F++)for(let I=a.y;I<a.y+a.height;I++){const P=R([F-h,I]);if(!P.allowOverlay&&P.kind!==J.Boolean)continue;let G;if(P.kind===J.Custom){const j=$t(P),ce=(C=j==null?void 0:j.provideEditor)==null?void 0:C.call(j,{...P,location:[F-h,I]});(j==null?void 0:j.onDelete)!==void 0?G=j.onDelete(P):ha(ce)&&(G=(M=ce==null?void 0:ce.deletedValue)==null?void 0:M.call(ce,P))}else if($o(P)&&P.allowOverlay||P.kind===J.Boolean){const j=$t(P);G=(H=j==null?void 0:j.onDelete)==null?void 0:H.call(j,P)}G!==void 0&&!Oo(G)&&$o(G)&&v.push({location:[F,I],value:G})}cn(v),(N=Pt.current)==null||N.damage(v.map(F=>({cell:F.location})))},[Gt,R,$t,cn,h]),rr=r!==void 0,il=s.useCallback(a=>{var re,Re,_e;const v=()=>{a.stopPropagation(),a.preventDefault()},C={didMatch:!1},{bounds:M}=a,H=S.columns,N=S.rows,F=Mn;if(!rr&&Be(F.clear,a,C)){const Te=((re=S.current)==null?void 0:re.cell)??[h,0];Ve({columns:ot.empty(),rows:ot.empty(),current:{cell:Te,range:{x:Te[0],y:Te[1],width:1,height:1},rangeStack:[]}},!1),Ht==null||Ht(),Gt()}else if(!rr&&Be(F.selectAll,a,C))Ve({columns:ot.empty(),rows:ot.empty(),current:{cell:((Re=S.current)==null?void 0:Re.cell)??[h,0],range:{x:h,y:0,width:k.length,height:ye},rangeStack:[]}},!1);else if(Be(F.search,a,C))(_e=d==null?void 0:d.current)==null||_e.focus({preventScroll:!0}),Z(!0);else if(Be(F.delete,a,C)){const Te=(Ot==null?void 0:Ot(S))??!0;if(Te!==!1){const ft=Te===!0?S:Te;if(ft.current!==void 0){ho(ft.current.range);for(const Ft of ft.current.rangeStack)ho(Ft)}for(const Ft of ft.rows)ho({x:h,y:Ft,width:k.length,height:1});for(const Ft of ft.columns)ho({x:Ft,y:0,width:1,height:ye})}}if(C.didMatch)return v(),!0;if(S.current===void 0)return!1;let[I,P]=S.current.cell;const[,G]=S.current.cell;let j=!1,ce=!1;if(Be(F.scrollToSelectedCell,a,C))Lr.current(I-h,P);else if(V!=="none"&&Be(F.selectColumn,a,C))H.hasIndex(I)?ut(H.remove(I),void 0,!0):V==="single"?ut(ot.fromSingleSelection(I),void 0,!0):ut(void 0,I,!0);else if(me!=="none"&&Be(F.selectRow,a,C))N.hasIndex(P)?kt(N.remove(P),void 0,!0):me==="single"?kt(ot.fromSingleSelection(P),void 0,!0):kt(void 0,P,!0);else if(!rr&&M!==void 0&&Be(F.activateCell,a,C))if(P===ye&&O)window.setTimeout(()=>{const Te=Po(I);Vn(Te??I)},0);else{const Te={inputType:"keyboard",key:a.key};L==null||L([I-h,P],Te),er(M,Te)}else if(S.current.range.height>1&&Be(F.downFill,a,C))ol();else if(S.current.range.width>1&&Be(F.rightFill,a,C))nl();else if(Be(F.goToNextPage,a,C))P+=Math.max(1,Jt.current.height-4);else if(Be(F.goToPreviousPage,a,C))P-=Math.max(1,Jt.current.height-4);else if(Be(F.goToFirstCell,a,C))i(void 0),P=0,I=0;else if(Be(F.goToLastCell,a,C))i(void 0),P=Number.MAX_SAFE_INTEGER,I=Number.MAX_SAFE_INTEGER;else if(Be(F.selectToFirstCell,a,C))i(void 0),yn([-2,-2]);else if(Be(F.selectToLastCell,a,C))i(void 0),yn([2,2]);else if(rr)Be(F.closeOverlay,a,C)&&i(void 0),Be(F.acceptOverlayDown,a,C)&&(i(void 0),P++),Be(F.acceptOverlayUp,a,C)&&(i(void 0),P--),Be(F.acceptOverlayLeft,a,C)&&(i(void 0),I--),Be(F.acceptOverlayRight,a,C)&&(i(void 0),I++);else{if(Be(F.goDownCell,a,C))P+=1;else if(Be(F.goUpCell,a,C))P-=1;else if(Be(F.goRightCell,a,C)){const Te=a.key==="Tab"&&!a.shiftKey;if(Sn===!0&&Te){const ft=qe.length-1;I>=ft?P<Lt-1&&(I=h,P+=1):I+=1}else I+=1}else Be(F.goLeftCell,a,C)?I-=1:Be(F.goDownCellRetainSelection,a,C)?(P+=1,j=!0):Be(F.goUpCellRetainSelection,a,C)?(P-=1,j=!0):Be(F.goRightCellRetainSelection,a,C)?(I+=1,j=!0):Be(F.goLeftCellRetainSelection,a,C)?(I-=1,j=!0):Be(F.goToLastRow,a,C)?P=ye-1:Be(F.goToFirstRow,a,C)?P=Number.MIN_SAFE_INTEGER:Be(F.goToLastColumn,a,C)?I=Number.MAX_SAFE_INTEGER:Be(F.goToFirstColumn,a,C)?I=Number.MIN_SAFE_INTEGER:(wt==="rect"||wt==="multi-rect")&&(Be(F.selectGrowDown,a,C)?yn([0,1]):Be(F.selectGrowUp,a,C)?yn([0,-1]):Be(F.selectGrowRight,a,C)?yn([1,0]):Be(F.selectGrowLeft,a,C)?yn([-1,0]):Be(F.selectToLastRow,a,C)?yn([0,2]):Be(F.selectToFirstRow,a,C)?yn([0,-2]):Be(F.selectToLastColumn,a,C)?yn([2,0]):Be(F.selectToFirstColumn,a,C)&&yn([-2,0]));ce=C.didMatch}if(bn!==void 0&&bn!=="normal"&&P!==G){const Te=bn==="skip-up"||bn==="skip"||bn==="block",ft=bn==="skip-down"||bn==="skip"||bn==="block",Ft=P<G;if(Ft&&Te){for(;P>=0&&uo(P).isGroupHeader;)P--;P<0&&(P=G)}else if(!Ft&&ft){for(;P<ye&&uo(P).isGroupHeader;)P++;P>=ye&&(P=G)}}const Oe=jn(I,P,!1,j),ke=C.didMatch,Qe=a.key==="Tab";return ke&&(Oe||!ce||Bn||Sn===!0&&Qe)&&v(),ke},[bn,rr,S,Mn,V,me,wt,h,uo,ye,jn,Ve,Ht,k.length,Ot,Bn,ho,ut,kt,O,Po,Vn,L,er,ol,nl,yn,Sn,qe.length,Lt]),ir=s.useCallback(a=>{let v=!1;je!==void 0&&je({...a,...a.location&&{location:[a.location[0]-h,a.location[1]]},cancel:()=>{v=!0}}),!v&&(il(a)||S.current)},[ct,je,il,S,R,h,ye,O,L,er]),Os=s.useCallback((a,v)=>{const C=a.location[0]-h;if(a.kind==="header"&&(we==null||we(C,{...a,preventDefault:v})),a.kind===pn){if(C<0)return;_==null||_(C,{...a,preventDefault:v})}if(a.kind==="cell"){const[M,H]=a.location;he==null||he([C,H],{...a,preventDefault:v}),Ta(S,a.location)||jn(M,H,!1,!1)}},[S,he,_,we,h,jn]),xi=s.useCallback(async a=>{var F,I,P;if(!Mn.paste)return;function v(G,j,ce,ne){var ke,Qe;const Oe=typeof ce=="object"?(ce==null?void 0:ce.join(`
`))??"":(ce==null?void 0:ce.toString())??"";if(!Oo(G)&&No(G)&&G.readonly!==!0){const ze=Y==null?void 0:Y(Oe,G);if(ze!==void 0&&$o(ze))return{location:j,value:ze};const re=$t(G);if(re===void 0)return;if(re.kind===J.Custom){tn(G.kind===J.Custom);const Re=(ke=re.onPaste)==null?void 0:ke.call(re,Oe,G.data);return Re===void 0?void 0:{location:j,value:{...G,data:Re}}}else{const Re=(Qe=re.onPaste)==null?void 0:Qe.call(re,Oe,G,{formatted:ne,formattedString:typeof ne=="string"?ne:ne==null?void 0:ne.join(`
`),rawValue:ce});return Re===void 0?void 0:(tn(Re.kind===G.kind),{location:j,value:Re})}}}const C=S.columns,M=S.rows,H=((F=at.current)==null?void 0:F.contains(document.activeElement))===!0||((I=l.current)==null?void 0:I.contains(document.activeElement))===!0;let N;if(S.current!==void 0?N=[S.current.range.x,S.current.range.y]:C.length===1?N=[C.first()??0,0]:M.length===1&&(N=[h,M.first()??0]),H&&N!==void 0){let G,j;const ce="text/plain",ne="text/html";if(navigator.clipboard.read!==void 0){const ze=await navigator.clipboard.read();for(const re of ze){if(re.types.includes(ne)){const _e=await(await re.getType(ne)).text(),Te=Al(_e);if(Te!==void 0){G=Te;break}}re.types.includes(ce)&&(j=await(await re.getType(ce)).text())}}else if(navigator.clipboard.readText!==void 0)j=await navigator.clipboard.readText();else if(a!==void 0&&(a==null?void 0:a.clipboardData)!==null){if(a.clipboardData.types.includes(ne)){const ze=a.clipboardData.getData(ne);G=Al(ze)}G===void 0&&a.clipboardData.types.includes(ce)&&(j=a.clipboardData.getData(ce))}else return;const[Oe,ke]=N,Qe=[];do{if(q===void 0){const ze=Qt(N),re=j??(G==null?void 0:G.map(_e=>_e.map(Te=>Te.rawValue).join("	")).join("	"))??"",Re=v(ze,N,re,void 0);Re!==void 0&&Qe.push(Re);break}if(G===void 0){if(j===void 0)return;G=Dd(j)}if(q===!1||typeof q=="function"&&(q==null?void 0:q([N[0]-h,N[1]],G.map(ze=>ze.map(re=>{var Re;return((Re=re.rawValue)==null?void 0:Re.toString())??""}))))!==!0)return;for(const[ze,re]of G.entries()){if(ze+ke>=ye)break;for(const[Re,_e]of re.entries()){const Te=[Re+Oe,ze+ke],[ft,Ft]=Te;if(ft>=qe.length||Ft>=Lt)continue;const en=Qt(Te),Dn=v(en,Te,_e.rawValue,_e.formatted);Dn!==void 0&&Qe.push(Dn)}}}while(!1);cn(Qe),(P=Pt.current)==null||P.damage(Qe.map(ze=>({cell:ze.location})))}},[Y,$t,Qt,S,Mn.paste,at,qe.length,cn,Lt,q,h,ye]);Vt("paste",xi,w,!1,!0);const lr=s.useCallback(async(a,v)=>{var F,I;if(!Mn.copy)return;const C=v===!0||((F=at.current)==null?void 0:F.contains(document.activeElement))===!0||((I=l.current)==null?void 0:I.contains(document.activeElement))===!0,M=S.columns,H=S.rows,N=(P,G)=>{if(!se)Pl(P,G,a);else{const j=G.map(ce=>({kind:J.Text,data:k[ce].title,displayData:k[ce].title,allowOverlay:!1}));Pl([j,...P],G,a)}};if(C&&oe!==void 0){if(S.current!==void 0){let P=oe(S.current.range,it.current.signal);typeof P!="object"&&(P=await P()),N(P,wo(S.current.range.x-h,S.current.range.x+S.current.range.width-h))}else if(H!==void 0&&H.length>0){const G=[...H].map(j=>{const ce=oe({x:h,y:j,width:k.length,height:1},it.current.signal);return typeof ce=="object"?ce[0]:ce().then(ne=>ne[0])});if(G.some(j=>j instanceof Promise)){const j=await Promise.all(G);N(j,wo(k.length))}else N(G,wo(k.length))}else if(M.length>0){const P=[],G=[];for(const j of M){let ce=oe({x:j,y:0,width:1,height:ye},it.current.signal);typeof ce!="object"&&(ce=await ce()),P.push(ce),G.push(j-h)}if(P.length===1)N(P[0],G);else{const j=P.reduce((ce,ne)=>ce.map((Oe,ke)=>[...Oe,...ne[ke]]));N(j,G)}}}},[k,oe,S,Mn.copy,h,at,ye,se]);Vt("copy",lr,w,!1,!1);const Xs=s.useCallback(async a=>{var C,M;if(!(!Mn.cut||!(((C=at.current)==null?void 0:C.contains(document.activeElement))===!0||((M=l.current)==null?void 0:M.contains(document.activeElement))===!0))&&(await lr(a),S.current!==void 0)){let H={current:{cell:S.current.cell,range:S.current.range,rangeStack:[]},rows:ot.empty(),columns:ot.empty()};const N=Ot==null?void 0:Ot(H);if(N===!1||(H=N===!0?H:N,H.current===void 0))return;ho(H.current.range)}},[ho,S,Mn.cut,lr,at,Ot]);Vt("cut",Xs,w,!1,!1);const Ys=s.useCallback((a,v)=>{if($e!==void 0){h!==0&&(a=a.map(H=>[H[0]-h,H[1]])),$e(a,v);return}if(a.length===0||v===-1)return;const[C,M]=a[v];u.current!==void 0&&u.current[0]===C&&u.current[1]===M||(u.current=[C,M],jn(C,M,!1,!1))},[$e,h,jn]),[zr,Pr]=((fl=Dt==null?void 0:Dt.current)==null?void 0:fl.cell)??[],Lr=s.useRef(Rt);Lr.current=Rt,s.useLayoutEffect(()=>{var a,v,C,M;Ci.current&&!Rr.current&&zr!==void 0&&Pr!==void 0&&(zr!==((v=(a=st.current)==null?void 0:a.current)==null?void 0:v.cell[0])||Pr!==((M=(C=st.current)==null?void 0:C.current)==null?void 0:M.cell[1]))&&Lr.current(zr,Pr),Rr.current=!1},[zr,Pr]);const ll=S.current!==void 0&&(S.current.cell[0]>=qe.length||S.current.cell[1]>=Lt);s.useLayoutEffect(()=>{ll&&Ve(Di,!1)},[ll,Ve]);const Gs=s.useMemo(()=>O===!0&&(Ye==null?void 0:Ye.tint)===!0?ot.fromSingleSelection(Lt-1):ot.empty(),[Lt,O,Ye==null?void 0:Ye.tint]),_s=s.useCallback(a=>typeof Kt=="boolean"?Kt:(Kt==null?void 0:Kt(a-h))??!0,[h,Kt]),Ks=s.useMemo(()=>{if(mi===void 0||l.current===null)return null;const{bounds:a,group:v}=mi,C=l.current.getBoundingClientRect();return s.createElement(yd,{bounds:a,group:v,canvasBounds:C,onClose:()=>wi(void 0),onFinish:M=>{wi(void 0),be==null||be(v,M)}})},[be,mi]),Us=Math.min(qe.length,Ne+h);s.useImperativeHandle(t,()=>({appendRow:(a,v)=>Vn(a+h,v),appendColumn:(a,v)=>Tr(a,v),updateCells:a=>{var v;return h!==0&&(a=a.map(C=>({cell:[C.cell[0]+h,C.cell[1]]}))),(v=Pt.current)==null?void 0:v.damage(a)},getBounds:(a,v)=>{var C;if(!((l==null?void 0:l.current)===null||(at==null?void 0:at.current)===null)){if(a===void 0&&v===void 0){const M=l.current.getBoundingClientRect(),H=M.width/at.current.clientWidth;return{x:M.x-at.current.scrollLeft*H,y:M.y-at.current.scrollTop*H,width:at.current.scrollWidth*H,height:at.current.scrollHeight*H}}return(C=Pt.current)==null?void 0:C.getBounds((a??0)+h,v)}},focus:()=>{var a;return(a=Pt.current)==null?void 0:a.focus()},emit:async a=>{switch(a){case"delete":ir({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":ir({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":ir({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await lr(void 0,!0);break;case"paste":await xi();break}},scrollTo:Rt,remeasureColumns:a=>{for(const v of a)Hr(v+h)},getMouseArgsForPosition:(a,v,C)=>{if((Pt==null?void 0:Pt.current)===null)return;const M=Pt.current.getMouseArgsForPosition(a,v,C);if(M!==void 0)return{...M,location:[M.location[0]-h,M.location[1]]}}}),[Vn,Tr,Hr,at,lr,ir,xi,h,Rt]);const[sl,al]=In??[],Vs=s.useCallback(a=>{const[v,C]=a;if(C===-1){V!=="none"&&(ut(ot.fromSingleSelection(v),void 0,!1),Gt());return}sl===v&&al===C||(Fe({cell:a,range:{x:v,y:C,width:1,height:1}},!0,!1,"keyboard-nav"),Rt(v,C))},[V,Gt,Rt,sl,al,Fe,ut]),[qs,js]=s.useState(!1),cl=s.useRef(Xl(a=>{js(a)},5)),Zs=s.useCallback(()=>{cl.current(!0),S.current===void 0&&S.columns.length===0&&S.rows.length===0&&c===void 0&&Fe({cell:[h,Er],range:{x:h,y:Er,width:1,height:1}},!0,!1,"keyboard-select")},[Er,S,c,h,Fe]),Js=s.useCallback(()=>{cl.current(!1)},[]),[Qs,ea]=s.useMemo(()=>{let a;const v=(Ue==null?void 0:Ue.scrollbarWidthOverride)??Ai(),C=ye+(O?1:0);if(typeof mn=="number")a=Qo+C*mn;else{let H=0;const N=Math.min(C,10);for(let F=0;F<N;F++)H+=mn(F);H=Math.floor(H/N),a=Qo+C*H}a+=v;const M=qe.reduce((H,N)=>N.width+H,0)+v;return[`${Math.min(1e5,M)}px`,`${Math.min(1e5,a)}px`]},[qe,Ue==null?void 0:Ue.scrollbarWidthOverride,mn,ye,O,Qo]),ta=s.useMemo(()=>_a(zt),[zt]);return s.createElement(ls.Provider,{value:zt},s.createElement(Ad,{style:ta,className:fe,inWidth:y??Qs,inHeight:x??ea},s.createElement(gd,{fillHandle:Ge,drawFocusRing:Ro,experimental:Ue,fixedShadowX:zn,fixedShadowY:br,getRowThemeOverride:gn,headerIcons:On,imageWindowLoader:Pn,initialSize:Ln,isDraggable:vo,onDragLeave:yr,onRowMoved:Xn,overscrollX:ci,overscrollY:Ho,preventDiagonalScrolling:ko,rightElement:So,rightElementProps:no,smoothScrollX:Qr,smoothScrollY:pr,className:fe,enableGroups:Jo,onCanvasFocused:Zs,onCanvasBlur:Js,canvasRef:l,onContextMenu:Os,theme:zt,cellXOffset:Ms,cellYOffset:Er,accessibilityHeight:ao.height,onDragEnd:Bs,columns:qe,nonGrowWidth:Mr,drawHeader:Rn,onColumnProposeMove:zs,drawCell:an,disabledRows:Gs,freezeColumns:Us,lockColumns:h,firstColAccessible:h===0,getCellContent:Qt,minColumnWidth:Kn,maxColumnWidth:Do,searchInputRef:d,showSearch:ae,onSearchClose:De,highlightRegions:Rs,getCellsForSelection:oe,getGroupDetails:ui,headerHeight:Un,isFocused:qs,groupHeaderHeight:Jo?Fo:0,freezeTrailingRows:At+(O&&(Ye==null?void 0:Ye.sticky)===!0?1:0),hasAppendRow:O,onColumnResize:yt,onColumnResizeEnd:Tt,onColumnResizeStart:wn,onCellFocused:Vs,onColumnMoved:Ps,onDragStart:Ls,onHeaderMenuClick:Ts,onHeaderIndicatorClick:Hs,onItemHovered:vi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:Fs,onKeyDown:ir,onKeyUp:de,onMouseDown:Es,onMouseUp:Ds,onDragOverCell:hn,onDrop:Me,onSearchResultsChanged:Ys,onVisibleRegionChanged:As,clientSize:En,rowHeight:mn,searchResults:K,searchValue:He,onSearchValueChange:te,rows:Lt,scrollRef:at,selection:S,translateX:ao.tx,translateY:ao.ty,verticalBorder:_s,gridRef:Pt,getCellRenderer:$t,resizeIndicator:vr}),Ks,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Gd,{...r,validateCell:bt,bloom:X,id:Ns,getCellRenderer:$t,className:(Ue==null?void 0:Ue.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:gt,imageEditorOverride:m,portalElementRef:Cr,onFinishEditing:$s,markdownDivCreateNode:g,isOutsideClick:oi,customEventTarget:Ue==null?void 0:Ue.eventTarget}))))},Vd=s.forwardRef(Ud);function Wl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:d,height:l,x:c,y:f}=r,u=t.maxSize??i.checkboxMaxSize,w=Math.floor(r.y+l/2),m=Kl(u,l,i.cellVerticalPadding),b=_l(t.contentAlign??"center",c,d,i.cellHorizontalPadding,m),g=Gl(b,w,m),y=Ul(c+n,f+o,g);return Ni(t)&&y}const qd={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:J.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>jd(e,e.cell.data,Ni(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Wl(e)&&e.preventDefault()},onClick:e=>{if(Wl(e))return{...e.cell,data:vs(e.cell.data)}},onPaste:(e,t)=>{let n=Gr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=$i),n===t.data?void 0:{...t,data:n}}};function jd(e,t,n,o,r){if(!n&&t===Gr)return;const{ctx:i,hoverAmount:d,theme:l,rect:c,highlighted:f,hoverX:u,hoverY:w,cell:{contentAlign:m}}=e,{x:b,y:g,width:y,height:x}=c;let k=!1;if(r>0){let p=n?1-r+r*d:.4;if(t===Gr&&(p*=d),p===0)return;p<1&&(k=!0,i.globalAlpha=p)}Ur(i,l,t,b,g,y,x,f,u,w,o,m),k&&(i.globalAlpha=1)}const Zd=on("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Jd=e=>{const{bubbles:t}=e;return s.createElement(Zd,null,t.map((n,o)=>s.createElement("div",{key:o,className:"boe-bubble"},n)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},Qd={getAccessibilityString:e=>Vl(e.data),kind:J.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>eu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Jd,{bubbles:t.data})},onPaste:()=>{}};function eu(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:d,y:l,width:c,height:f}=n;let u=d+o.cellHorizontalPadding;const w=[];for(const m of t){if(u>d+c)break;const b=Uo(m,r,o.baseFontFull).width;w.push({x:u,width:b}),u+=b+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const m of w)Tn(r,m.x,l+(f-o.bubbleHeight)/2,m.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[m,b]of w.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[m],b.x+o.bubblePadding,l+f/2+Hn(r,o))}const tu=on("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),nu=e=>{const{drilldowns:t}=e;return s.createElement(tu,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},ou={getAccessibilityString:e=>Vl(e.data.map(t=>t.text)),kind:J.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>iu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(nu,{drilldowns:t.data})},onPaste:()=>{}},Fi={};function ru(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,d=n-i*2,l=4,c=n*r,f=o+i,u=o*3,w=(u+i*2)*r,m=`${e},${t},${r},${n}`;if(Fi[m]!==void 0)return{el:Fi[m],height:c,width:w,middleWidth:l*r,sideWidth:f*r,padding:i*r,dpr:r};const b=document.createElement("canvas"),g=b.getContext("2d");return g===null?null:(b.width=w,b.height=c,g.scale(r,r),Fi[m]=b,g.beginPath(),Tn(g,i,i,u,d,o),g.shadowColor="rgba(24, 25, 34, 0.4)",g.shadowBlur=1,g.fillStyle=e,g.fill(),g.shadowColor="rgba(24, 25, 34, 0.3)",g.shadowOffsetY=1,g.shadowBlur=5,g.fillStyle=e,g.fill(),g.shadowOffsetY=0,g.shadowBlur=0,g.shadowBlur=0,g.beginPath(),Tn(g,i+.5,i+.5,u,d,o),g.strokeStyle=t,g.lineWidth=1,g.stroke(),{el:b,height:c,width:w,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function iu(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:d,row:l}=e,{x:c,width:f}=n,u=o.baseFontFull,w=ts(r,u),m=Math.min(n.height,Math.max(16,Math.ceil(w*o.lineHeight)*2)),b=Math.floor(n.y+(n.height-m)/2),g=m-10,y=o.bubblePadding,x=o.bubbleMargin;let k=c+o.cellHorizontalPadding;const p=o.roundingRadius??6,R=ru(o.bgCell,o.drilldownBorder,m,p),W=[];for(const L of t){if(k>c+f)break;const z=Uo(L.text,r,u).width;let Y=0;L.img!==void 0&&i.loadOrGetImage(L.img,d,l)!==void 0&&(Y=g-8+4);const E=z+Y+y*2;W.push({x:k,width:E}),k+=E+x}if(R!==null){const{el:L,height:A,middleWidth:z,sideWidth:Y,width:E,dpr:$,padding:X}=R,B=Y/$,D=X/$;for(const T of W){const ie=Math.floor(T.x),U=Math.floor(T.width),he=U-(B-D)*2;r.imageSmoothingEnabled=!1,r.drawImage(L,0,0,Y,A,ie-D,b,B,m),he>0&&r.drawImage(L,Y,0,z,A,ie+(B-D),b,he,m),r.drawImage(L,E-Y,0,Y,A,ie+U-(B-D),b,B,m),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[L,A]of W.entries()){const z=t[L];let Y=A.x+y;if(z.img!==void 0){const E=i.loadOrGetImage(z.img,d,l);if(E!==void 0){const $=g-8;let X=0,B=0,D=E.width,T=E.height;D>T?(X+=(D-T)/2,D=T):T>D&&(B+=(T-D)/2,T=D),r.beginPath(),Tn(r,Y,b+m/2-$/2,$,$,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(E,X,B,D,T,Y,b+m/2-$/2,$,$),r.restore(),Y+=$+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(z.text,Y,b+m/2+Hn(r,o))}}const lu={getAccessibilityString:e=>e.data.join(", "),kind:J.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>su(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ka;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Ti=4;function su(e,t,n,o){const{rect:r,col:i,row:d,theme:l,ctx:c,imageLoader:f}=e,{x:u,y:w,height:m,width:b}=r,g=m-l.cellVerticalPadding*2,y=[];let x=0;for(let p=0;p<t.length;p++){const R=t[p];if(R.length===0)continue;const W=f.loadOrGetImage(R,i,d);if(W!==void 0){y[p]=W;const L=W.width*(g/W.height);x+=L+Ti}}if(x===0)return;x-=Ti;let k=u+l.cellHorizontalPadding;o==="right"?k=Math.floor(u+b-l.cellHorizontalPadding-x):o==="center"&&(k=Math.floor(u+b/2-x/2));for(const p of y){if(p===void 0)continue;const R=p.width*(g/p.height);n>0&&(c.beginPath(),Tn(c,k,w+l.cellVerticalPadding,R,g,n),c.save(),c.clip()),c.drawImage(p,k,w+l.cellVerticalPadding,R,g),n>0&&c.restore(),k+=R+Ti}}function au(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const cu={getAccessibilityString:()=>"",kind:J.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:d}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(au(n,o)*t.skeletonWidthVariability));const c=d.cellHorizontalPadding;l+c*2>=i.width&&(l=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*d.cellVerticalPadding);Tn(r,i.x+c,i.y+(i.height-f)/2,l,f,d.roundingRadius??3),r.fillStyle=yo(d.textDark,.1),r.fill()},onPaste:()=>{}},du=()=>e=>e.targetWidth,$l=on("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[du(),"px"]}}),uu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:d,validatedSelection:l}=e,c=t.data,f=t.readonly===!0,[u,w]=s.useState(c===""||o),m=s.useCallback(()=>{w(g=>!g)},[]),b=c?"gdg-ml-6":"";return u?s.createElement($l,{targetWidth:i.width-20},s.createElement(Zr,{autoFocus:!0,highlight:!1,validatedSelection:l,value:c,onKeyDown:g=>{g.key==="Enter"&&g.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${b}`,onClick:()=>d(t)},s.createElement(wa,null))):s.createElement($l,{targetWidth:i.width},s.createElement(Ma,{contents:c,createNode:r}),!f&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${b}`,onClick:m},s.createElement(Oi,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},fu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:wr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Fn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:d,validatedSelection:l}=e;return s.createElement(uu,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:c=>t({...n,data:c.target.value}),forceEditMode:d,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},hu={getAccessibilityString:e=>e.row.toString(),kind:_t.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:gu,measure:()=>44,draw:e=>wu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e;if(n.disabled===!0)return;const{width:i,height:d}=t,l=n.drawHandle?7+(i-7)/2:i/2,c=d/2;if(Math.abs(o-l)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function gu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=mu,n.textAlign="center",i}function mu(e){const{ctx:t}=e;t.textAlign="start"}function wu(e,t,n,o,r,i,d){if(d){const{ctx:x,rect:k,theme:p}=e,{x:R,y:W,width:L,height:A}=k,z=o==="checkbox"?"checkbox-visible":o;if(z!=="number"&&(x.globalAlpha=n?1:.4,Ur(x,p,n,r?R+7:R,W,r?L-7:L,A,!1,-20,-20,p.checkboxMaxSize,"center",i,!0),x.globalAlpha=1),z==="number"||z==="both"&&!n){const Y=t.toString(),E=p.markerFontFull,$=R+L/2;x.fillStyle="#cccccc",x.font=E,x.fillText(Y,$,W+A/2+Hn(x,E))}if(r){x.globalAlpha=.4,x.beginPath();for(const Y of[3,6])for(const E of[-5,-1,3])x.rect(R+Y,W+A/2+E,2,2);x.fillStyle="#cccccc",x.fill(),x.beginPath(),x.globalAlpha=1}return}const{ctx:l,rect:c,hoverAmount:f,theme:u}=e,{x:w,y:m,width:b,height:g}=c,y=n?1:o==="checkbox-visible"?.6+.4*f:f;if(o!=="number"&&y>0){l.globalAlpha=y;const x=7*(n?f:1);if(Ur(l,u,n,r?w+x:w,m,r?b-x:b,g,!0,void 0,void 0,u.checkboxMaxSize,"center",i,d),r){l.globalAlpha=f,l.beginPath();for(const k of[3,6])for(const p of[-5,-1,3])l.rect(w+k,m+g/2+p,2,2);l.fillStyle=u.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const x=t.toString(),k=u.markerFontFull,p=w+b/2;o==="both"&&f!==0&&(l.globalAlpha=1-f),l.fillStyle=u.textLight,l.font=k,l.fillText(x,p,m+g/2+Hn(l,k)),f!==0&&(l.globalAlpha=1)}}const bu={getAccessibilityString:()=>"",kind:_t.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>yu(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function yu(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:d,spriteManager:l}=e,{x:c,y:f,width:u,height:w}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,w-2),o.fillStyle=d.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const m=t!=="";let b=0;if(n!==void 0){const y=w-8,x=c+8/2,k=f+8/2;l.drawSprite(n,"normal",o,x,k,y,d,m?1:i),b=y}else{b=24;const g=12,y=m?g:i*g,x=m?0:(1-i)*g*.5,k=d.cellHorizontalPadding+4;y>0&&(o.moveTo(c+k+x,f+w/2),o.lineTo(c+k+x+y,f+w/2),o.moveTo(c+k+x+y*.5,f+w/2-y*.5),o.lineTo(c+k+x+y*.5,f+w/2+y*.5),o.lineWidth=2,o.strokeStyle=d.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=d.textMedium,o.fillText(t,b+c+d.cellHorizontalPadding+.5,f+w/2+Hn(o,d)),o.beginPath()}function ks(e,t,n,o,r,i,d){e.textBaseline="alphabetic";const l=pu(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Tn(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??yo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",d==null||d("text")}function pu(e,t,n,o,r){const i=o.cellHorizontalPadding,d=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+d/2+1,width:t.width-i,height:t.height-d-1};const l=Uo(n,e,o.baseFontFull,"alphabetic"),c=t.height-d,f=Math.min(c,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:l.width+i*3,height:f-1}}const vu=s.lazy(async()=>await Ol(()=>import("./number-overlay-editor-Dbk4NGvZ.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),Cu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:wr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:d}=e,{hoverEffect:l,displayData:c,hoverEffectTheme:f}=n;l===!0&&t>0&&ks(o,r,f,c,i,t,d),Fn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(vu,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},xu={getAccessibilityString:()=>"",measure:()=>108,kind:J.Protected,needsHover:!1,needsHoverPosition:!1,draw:ku,onPaste:()=>{}};function ku(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:d}=o;t.beginPath();const l=2.5;let c=r+n.cellHorizontalPadding+l;const f=i+d/2,u=Math.cos(yl(30))*l,w=Math.sin(yl(30))*l;for(let m=0;m<12;m++)t.moveTo(c,f-l),t.lineTo(c,f+l),t.moveTo(c+u,f-w),t.lineTo(c-u,f+w),t.moveTo(c-u,f-w),t.lineTo(c+u,f+w),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const Su={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>wr(e,t,e.theme.textLight),draw:e=>Fn(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return St.createElement(Zr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},Mu={getAccessibilityString:e=>e.status??"",kind:_t.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:Ru,measure:()=>40,draw:e=>Iu(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function Ru(e,t){const{ctx:n}=e,o="bold 14px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=Eu,n.textAlign="center",r}function Eu(e){const{ctx:t}=e;t.textAlign="start"}function Iu(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:r,y:i,width:d,height:l}=o,c={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=c[t],n.font="bold 14px sans-serif";const f=r+d/2,u=i+l/2;n.fillText(t,f,u+Hn(n,n.font))}const Du={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:wr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:d,overrideCursor:l}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:w,hoverEffectTheme:m}=t;u===!0&&n>0&&ks(r,d,m,c,i,n,l),Fn(e,c,f,w,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Zr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:d=>o({...r,data:d.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Fu=on("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),Tu=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:d}=e,[l,c]=s.useState(!r&&(t===""||o)),f=s.useCallback(()=>{c(!0)},[]);return l?s.createElement(Zr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):s.createElement(Fu,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},d),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:f},s.createElement(Oi,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function Ss(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,d=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-d-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-d/2),{x:r,y:i,width:d,height:l}}function Nl(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,d=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=Ql(d,i.baseFontFull);if(l===void 0)return!1;const c=Ss(l,n,i,t.contentAlign);return bo({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const Hu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:wr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:d,ctx:l}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Uo(c,l,n.baseFontFull),w=Ss(u,d,n,t.contentAlign),{x:m,y:b,width:g,height:y}=w;if(r>=m-4&&r<=m-4+g+8&&i>=b-4&&i<=b-4+y+8){const x=Hn(l,n.baseFontFull);o("pointer");const k=5,p=b-x;l.beginPath(),l.moveTo(d.x+m,Math.floor(d.y+p+y+k)+.5),l.lineTo(d.x+m+g,Math.floor(d.y+p+y+k)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Fn({...e,rect:{...d,x:d.x-1}},c,t.contentAlign),Fn({...e,rect:{...d,x:d.x-2}},c,t.contentAlign),Fn({...e,rect:{...d,x:d.x+1}},c,t.contentAlign),Fn({...e,rect:{...d,x:d.x+2}},c,t.contentAlign),l.restore()}}l.fillStyle=f?n.linkColor:n.textDark,Fn(e,c,t.contentAlign)},onSelect:e=>{Nl(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;Nl(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(Tu,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:d=>n({...o,data:d.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Au=[hu,bu,Mu,qd,Qd,ou,lu,cu,fu,Cu,xu,Su,Du,Hu],Hi=[];class zu extends os{constructor(){super(...arguments);Le(this,"imageLoaded",()=>{});Le(this,"loadedLocations",[]);Le(this,"cache",{});Le(this,"sendLoaded",ca(()=>{this.imageLoaded(new Yo(this.loadedLocations)),this.loadedLocations=[]},20));Le(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let d=0;d<r.cells.length;d++){const l=r.cells[d];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let d=!1;const l=Hi.pop()??new Image;let c=!1;const f={img:void 0,cells:[vn(o,r)],url:n,cancel:()=>{c||(c=!0,Hi.length<12?Hi.unshift(l):d||(l.src=""))}},u=new Promise(w=>l.addEventListener("load",()=>w(null)));requestAnimationFrame(async()=>{try{l.src=n,await u,await l.decode();const w=this.cache[i];if(w!==void 0&&!c){w.img=l;for(const m of w.cells)this.loadedLocations.push(_i(m));d=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,d=this.cache[i];if(d!==void 0){const l=vn(o,r);return d.cells.includes(l)||d.cells.push(l),d.img}else this.loadImage(n,o,r,i)}}const Pu=(e,t)=>{const n=s.useMemo(()=>({...Sc,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??Au,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new zu,[e.imageWindowLoader]);return s.createElement(Vd,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Uu=s.forwardRef(Pu);export{md as C,Uu as D,J as G,ls as T,Zr as a,ts as b,nn as c,_u as d,Gu as e,Xu as f,Hn as g,$o as h,Yu as i,ml as j,Oo as k,ha as l,Uo as m,_a as n,_o as p,Tn as r,Ku as u};
