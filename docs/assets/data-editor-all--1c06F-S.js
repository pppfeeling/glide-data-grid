const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-Bj0JZDL1.js","./iframe-D0SbFLjG.js","./preload-helper-C1FmrZbK.js","./marked.esm-CyWSOd15.js","./react-number-format.es-DACSizUM.js","./index-CONOvmL5.js","./throttle-t991Nh2L.js","./flatten-DQ6IrYXi.js"])))=>i.map(i=>d[i]);
var Sa=Object.defineProperty;var Ma=(e,t,n)=>t in e?Sa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var $e=(e,t,n)=>Ma(e,typeof t!="symbol"?t+"":t,n);import{r as s,R as Rt}from"./iframe-D0SbFLjG.js";import{_ as jl}from"./preload-helper-C1FmrZbK.js";import{r as Zl}from"./index-CONOvmL5.js";import{h as Ra,g as Jl,j as Ea,k as Ia,v as Ha,l as Da,m as wn,r as bo,t as Fa}from"./throttle-t991Nh2L.js";import{u as Ta,f as vl}from"./flatten-DQ6IrYXi.js";import{s as _t,a as Aa}from"./marked.esm-CyWSOd15.js";function Ql(e="This should not happen"){throw new Error(e)}function un(e,t="Assertion failed"){if(!e)return Ql(t)}function fr(e,t){return Ql(t??"Hell froze over")}function Pa(e,t){try{return e()}catch{return t}}const xl=Object.prototype.hasOwnProperty;function Go(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Go(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(xl.call(e,n)&&++o&&!xl.call(t,n)||!(n in t)||!Go(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Gr=null,Bi=void 0;var J;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(J||(J={}));var Sl;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp"})(Sl||(Sl={}));var Xr;(function(e){e.Triangle="triangle",e.Dots="dots"})(Xr||(Xr={}));function Br(e){return"width"in e&&typeof e.width=="number"}async function Ml(e){return typeof e=="object"?e:await e()}function Wn(e){return!(e.kind===J.Loading||e.kind===J.Bubble||e.kind===J.RowID||e.kind===J.Protected||e.kind===J.Drilldown)}function Pf(e){return!(e.kind===J.Loading||e.kind===J.Bubble||e.kind===J.RowID||e.kind===J.Protected||e.kind===J.Drilldown||e.kind===J.Boolean||e.kind===J.Image||e.kind===J.Custom)}function yo(e){return e.kind===Bt.Marker||e.kind===Bt.NewRow||e.kind===Bt.RowStatus}function no(e){if(!Wn(e)||e.kind===J.Image)return!1;switch(e.kind){case J.Text:case J.Number:case J.Markdown:case J.Uri:case J.Custom:case J.Boolean:return e.readonly!==!0;default:fr(e,"A cell was passed with an invalid kind")}}function es(e){return Ra(e,"editor")}function Wi(e){return!(e.readonly??!1)}var Bt;(function(e){e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id"})(Bt||(Bt={}));const Kr={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function ki(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let Rl;const Qt=class Qt{constructor(t){$e(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Qt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=ki([...this.items,n]);return new Qt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[l,c]=a;if(l<=r&&o<=c){const u=[];l<o&&u.push([l,o]),r<c&&u.push([r,c]),n.splice(i,1,...u)}}return new Qt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};$e(Qt,"create",t=>new Qt(ki(t))),$e(Qt,"empty",()=>Rl??(Rl=new Qt([]))),$e(Qt,"fromSingleSelection",t=>Qt.empty().add(t)),$e(Qt,"fromArray",t=>{if(t.length===0)return Qt.empty();const n=t.map(r=>[r,r+1]),o=ki(n);return new Qt(o)});let nt=Qt;const za=_t("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Yt(e,t,n,o,r=!1){const i=s.useRef();i.current=t,s.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,l=c=>{var u;(u=i.current)==null||u.call(a,c)};return a.addEventListener(e,l,{passive:o,capture:r}),()=>{a.removeEventListener(e,l,{capture:r})}},[e,n,o,r])}function Qn(e,t){return e===void 0?void 0:t}const La=Math.PI;function El(e){return e*La/180}const ts=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ns=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},os=(e,t,n)=>Math.min(e,t-n*2),rs=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Oi=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),s.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Ba=e=>{const t=e.fgColor??"currentColor";return s.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Wa(e,t,n){const[o,r]=s.useState(e),i=s.useRef(!0);s.useEffect(()=>()=>{i.current=!1},[]);const a=s.useRef(Jl(l=>{i.current&&r(l)},n));return s.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const Oa="֑-߿יִ-﷽ﹰ-ﻼ",Na="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",$a=new RegExp("^[^"+Na+"]*["+Oa+"]");function Ni(e){return $a.test(e)?"rtl":"not-rtl"}let Wr;function Di(){if(typeof document>"u")return 0;if(Wr!==void 0)return Wr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Wr=n-o,Wr}const po=Symbol();function Ga(e){const t=s.useRef([po,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=s.useState(e),[,r]=s.useState(),i=s.useCallback(l=>{const c=t.current[0];c!==po&&(l=typeof l=="function"?l(c):l,l===c)||(c!==po&&r({}),o(u=>typeof l=="function"?l(c===po?u:c):l),t.current[0]=po)},[]),a=s.useCallback(()=>{t.current[0]=po,r({})},[]);return[t.current[0]===po?n:t.current[0],i,a]}function is(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Xa(e){const t=s.useRef(e);return Go(e,t.current)||(t.current=e),t.current}const Ka=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(l=>l!=="");if(i.length===0)return null;const a=i.length>1;return s.createElement(za,{"data-testid":"GDG-default-image-overlay-editor"},s.createElement(Ea.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(l=>{const c=(r==null?void 0:r(l))??s.createElement("img",{draggable:!1,src:l});return s.createElement("div",{className:"gdg-centering-container",key:l},c)})),n&&o&&s.createElement("button",{className:"gdg-edit-icon",onClick:o},s.createElement(Oi,null)))},Ya=_t("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class _a extends Rt.PureComponent{constructor(){super(...arguments);$e(this,"targetElement",null);$e(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=Aa(r),l=document.createRange();l.selectNodeContents(n),l.deleteContents();let c=i==null?void 0:i(a);if(c===void 0){const d=document.createElement("template");d.innerHTML=a,c=d.content}n.append(c);const u=n.getElementsByTagName("a");for(const d of u)d.target="_blank",d.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),Rt.createElement(Ya,{ref:this.containerRefHook})}}const Va=_t("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),Ua=_t("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),qa=_t("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});class ls extends s.PureComponent{constructor(){super(...arguments);$e(this,"wrapperRef",s.createRef());$e(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return s.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const vi={};let jn=null;function ja(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function Xo(e){const t=e.toLowerCase().trim();if(vi[t]!==void 0)return vi[t];jn=jn||ja(),jn.style.color="#000",jn.style.color=t;const n=getComputedStyle(jn).color;jn.style.color="#fff",jn.style.color=t;const o=getComputedStyle(jn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),vi[t]=r,r}function oo(e,t){const[n,o,r]=Xo(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const Il=new Map;function Hl(e,t){const n=`${e}-${t}`,o=Il.get(n);if(o!==void 0)return o;const r=fn(e,t);return Il.set(n,r),r}function fn(e,t){if(t===void 0)return e;const[n,o,r,i]=Xo(e);if(i===1)return e;const[a,l,c,u]=Xo(t),d=i+u*(1-i),g=(i*n+u*a*(1-i))/d,h=(i*o+u*l*(1-i))/d,m=(i*r+u*c*(1-i))/d;return`rgba(${g}, ${h}, ${m}, ${d})`}function zf(e,t,n){if(n<=0)return e;if(n>=1)return t;const[o,r,i,a]=Xo(e),[l,c,u,d]=Xo(t),g=o*a,h=r*a,m=i*a,f=l*d,w=c*d,C=u*d,k=n,b=1-n,y=a*b+d*k;if(y===0)return"rgba(0, 0, 0, 0)";const H=Math.floor((g*b+f*k)/y),A=Math.floor((h*b+w*k)/y),v=Math.floor((m*b+C*k)/y);return`rgba(${H}, ${A}, ${v}, ${y})`}function Lf(e){if(e==="transparent")return 0;function t(i){const a=i/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}const[n,o,r]=Xo(e);return .2126*t(n)+.7152*t(o)+.0722*t(r)}function ss(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const as={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function cs(){return as}const $i=Rt.createContext(as);function Bf(){return Rt.useContext($i)}function In(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=fn(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Za=()=>e=>e.targetX,Ja=()=>e=>e.targetY,Qa=()=>e=>e.targetWidth,ec=()=>e=>e.targetHeight,tc=()=>e=>e.targetY+10,nc=()=>e=>Math.max(0,(e.targetHeight-28)/2),oc=_t("div")({name:"DataGridOverlayEditorStyle",class:"gdg-d19meir1",propsAsIs:!1,vars:{"d19meir1-0":[Ja(),"px"],"d19meir1-1":[Za(),"px"],"d19meir1-2":[Qa(),"px"],"d19meir1-3":[ec(),"px"],"d19meir1-4":[tc(),"px"],"d19meir1-5":[nc(),"px"]}});function rc(){const[e,t]=s.useState();return[e??void 0,t]}function ic(){const[e,t]=rc(),[n,o]=s.useState(0),[r,i]=s.useState(!0);s.useLayoutEffect(()=>{if(e===void 0||!("IntersectionObserver"in window))return;const l=new IntersectionObserver(c=>{c.length!==0&&i(c[0].isIntersecting)},{threshold:1});return l.observe(e),()=>l.disconnect()},[e]),s.useEffect(()=>{if(r||e===void 0)return;let l;const c=()=>{const{right:u}=e.getBoundingClientRect();o(d=>Math.min(d+window.innerWidth-u-10,0)),l=requestAnimationFrame(c)};return l=requestAnimationFrame(c),()=>{l!==void 0&&cancelAnimationFrame(l)}},[e,r]);const a=s.useMemo(()=>({transform:`translateX(${n}px)`}),[n]);return{ref:t,style:a}}const Yo=s.createContext({isGhostMode:!1,ghostValue:""}),lc=e=>{const{target:t,content:n,onFinishEditing:o,forceEditMode:r,initialValue:i,imageEditorOverride:a,markdownDivCreateNode:l,highlight:c,className:u,theme:d,id:g,cell:h,bloom:m,portalElementRef:f,validateCell:w,getCellRenderer:C,provideEditor:k,isOutsideClick:b,customEventTarget:y,activation:H,ghostValue:A,isGhostMode:v}=e,[P,E]=s.useState(r?n:void 0),M=s.useRef(P??n);M.current=P??n;const[L,I]=s.useState(()=>w===void 0?!0:!(Wn(n)&&(w==null?void 0:w(h,n,M.current))===!1)),D=s.useCallback((N,ee)=>{o(L?N:void 0,ee)},[L,o]),R=s.useCallback(N=>{if(w!==void 0&&N!==void 0&&Wn(N)){const ee=w(h,N,M.current);ee===!1?I(!1):(typeof ee=="object"&&(N=ee),I(!0))}E(N)},[h,w]),x=s.useRef(!1),W=s.useRef(void 0),V=s.useCallback(()=>{D(P,[0,0]),x.current=!0},[P,D]),oe=s.useCallback((N,ee)=>{console.log("[onEditorFinished] newValue:",N),console.log("[onEditorFinished] movement:",ee),console.log("[onEditorFinished] calling onFinishEditing"),D(N,ee??W.current??[0,0]),console.log("[onEditorFinished] onFinishEditing called"),x.current=!0},[D]),ne=s.useCallback(async N=>{if(N.nativeEvent.isComposing)return;let ee=!1;N.key==="Escape"?(N.stopPropagation(),N.preventDefault(),W.current=[0,0]):N.key==="Enter"&&!N.shiftKey?(N.stopPropagation(),N.preventDefault(),W.current=[0,1],ee=!0):N.key==="Tab"&&(N.stopPropagation(),N.preventDefault(),W.current=[N.shiftKey?-1:1,0],ee=!0),window.setTimeout(()=>{!x.current&&W.current!==void 0&&(D(ee?P:void 0,W.current),x.current=!0)},0)},[D,P]),U=P??n,[G,K]=s.useMemo(()=>{var we,Ve;if(yo(n))return[];const N={...n,location:h,activation:H},ee=k==null?void 0:k(N);return ee!==void 0?[ee,!1]:[(Ve=(we=C(n))==null?void 0:we.provideEditor)==null?void 0:Ve.call(we,N),!1]},[h,n,C,k,H]),{ref:Z,style:fe}=ic();let ce=!0,re,se=!0,z;if(G!==void 0){ce=G.disablePadding!==!0,se=G.disableStyling!==!0;const N=es(G);N&&(z=G.styleOverride);const ee=N?G.editor:G;re=s.createElement(ee,{portalElementRef:f,isHighlighted:c,activation:H,onChange:R,value:U,initialValue:i,onFinishedEditing:oe,validatedSelection:Wn(U)?U.selectionRange:void 0,forceEditMode:r,target:t,imageEditorOverride:a,markdownDivCreateNode:l,isValid:L,theme:d})}z={...z,...fe};const X=(f==null?void 0:f.current)??document.getElementById("portal");if(X===null)return console.error('Cannot open Data Grid overlay editor, because portal not found. Please, either provide a portalElementRef or add `<div id="portal" />` as the last child of your `<body>`.'),null;let Y=se?"gdg-style":"gdg-unstyle";L||(Y+=" gdg-invalid"),ce&&(Y+=" gdg-pad");const Q=(m==null?void 0:m[0])??1,ve=(m==null?void 0:m[1])??1,De=s.useMemo(()=>({isGhostMode:v??!1,ghostValue:A??""}),[v,A]);return Zl.createPortal(s.createElement($i.Provider,{value:d},s.createElement(Yo.Provider,{value:De},s.createElement(ls,{style:ss(d),className:u,onClickOutside:V,isOutsideClick:b,customEventTarget:y},s.createElement(oc,{ref:Z,id:g,className:Y,style:v?{...z,visibility:"hidden"}:z,as:K===!0?"label":void 0,targetX:t.x-Q,targetY:t.y-ve,targetWidth:t.width+Q*2,targetHeight:t.height+ve*2},s.createElement("div",{className:"gdg-clip-region",onKeyDown:ne},re))))),X)},sc=Object.freeze(Object.defineProperty({__proto__:null,GhostModeContext:Yo,default:lc},Symbol.toStringTag,{value:"Module"}));let Dl=0;const Gi=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,autoFocus:l,...c}=e,{onChange:u,className:d}=c,g=s.useRef(null),{isGhostMode:h,ghostValue:m}=s.useContext(Yo),f=h&&m?m:n??"";un(u!==void 0,"GrowingEntry must be a controlled input area");const[w]=s.useState(()=>"input-box-"+(Dl=(Dl+1)%1e7));s.useEffect(()=>{if(h)return;const b=g.current;if(b===null||b.disabled)return;const y=f.toString().length;b.focus(),b.setSelectionRange(r?0:y,y)},[h]),s.useLayoutEffect(()=>{var b;if(a!==void 0){const y=typeof a=="number"?[a,null]:a;(b=g.current)==null||b.setSelectionRange(y[0],y[1])}},[a]);const C=s.useCallback(b=>{b.key==="Enter"&&b.shiftKey&&i===!0||o==null||o(b)},[i,o]),k=h?{visibility:"hidden"}:void 0;return s.createElement(qa,{className:"gdg-growing-entry"},s.createElement(Ua,{className:d},f+`
`),s.createElement(Va,{...c,className:(d??"")+" gdg-input",id:w,ref:g,onKeyDown:C,value:f,placeholder:t,dir:"auto",style:k}))};function ac(e,t){return Rt.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function cc(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(dr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function Co(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Fi(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function ds(e,t){const n=Co(e),o=Co(t);return n===o}function Yr(e,t,n,o){for(let r=0;r<=n;r++){const i=Fi(e,r,o)??"",a=Fi(t,r,o)??"";if(i!==a)return!1}return!0}function dc(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function us(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function dr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function fs(e){return[e.x+e.width-1,e.y+e.height-1]}function Fl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[l,c]=e;if(c<i||c>a)return!1;if(t.span===void 0)return l>=o&&l<=r;const[u,d]=t.span;return u>=o&&u<=r||d>=o&&u<=r||u<o&&d>r}function uc(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&Fl(e,t,i)&&r++;for(const a of n.current.rangeStack)Fl(e,t,a)&&r++;return r}function hs(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function Ko(e,t){let n=0;const o=hs(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function ko(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Ti(e,t,n,o,r){const i=hs(e,o),a=[];for(const u of i)if(u.sticky)a.push(u);else break;if(a.length>0)for(const u of a)n-=u.width;let l=t,c=r??0;for(;c<=n&&l<i.length;)c+=i[l].width,l++;for(let u=t;u<l;u++){const d=i[u];d.sticky||a.push(d)}return a}function fc(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function hc(e,t,n,o,r,i,a,l,c,u,d,g){const h=d??(n?1:0),m=g??(n?[r]:[]),f=m.reduce((y,H)=>y+H,0),w=o+f;if(n&&h>0){let y=0;for(let H=0;H<h;H++)if(y+=m[H]??0,e<=y)return-(H+2)}if(e<=w)return-1;let C=t;for(let y=0;y<u;y++){const H=i-1-y,A=typeof a=="number"?a:a(H);if(C-=A,e>=C)return H}const k=i-u,b=e-(c??0);if(typeof a=="number"){const y=Math.floor((b-w)/a)+l;return y>=k?void 0:y}else{let y=w;for(let H=l;H<k;H++){const A=a(H);if(b<=y+A)return H;y+=A}return}}let $r=0,ur={};const gc=typeof window>"u";async function mc(){var e;gc||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,$r=0,ur={},Ha())}mc();function gs(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function vo(e,t,n,o="middle"){const r=gs(e,t,o,n);let i=ur[r];return i===void 0&&(i=t.measureText(e),ur[r]=i,$r++),$r>1e4&&(ur={},$r=0),i}function ms(e,t){const n=gs(e,void 0,"middle",t);return ur[n]}function hn(e,t){return typeof t!="string"&&(t=t.baseFontFull),wc(e,t)}function Tl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Al=[];function wc(e,t){for(const i of Al)if(i.key===t)return i.val;const n=Tl(e,"alphabetic"),r=-(Tl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Al.push({key:t,val:r}),r}function pc(e,t,n,o,r,i){const{ctx:a,rect:l,theme:c}=e;let u=Number.MAX_SAFE_INTEGER;const d=500;if(t!==void 0&&(u=n-t,u<d)){const g=1-u/d;a.globalAlpha=g,a.fillStyle=c.bgSearchResult,a.fillRect(l.x+1,l.y+1,l.width-(r?2:1),l.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return u<d}function qr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function Wf(e,t,n,o,r){const{rect:i,ctx:a,theme:l}=e;a.fillStyle=l.textDark,Bn({ctx:a,rect:i,theme:l},t,n,o,r)}function ws(e,t,n,o,r,i,a,l,c){c==="right"?e.fillText(t,n+r-(l.cellHorizontalPadding+.5),o+i/2+a):c==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+l.cellHorizontalPadding+.5,o+i/2+a)}function ps(e,t){const n=vo("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function bc(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function yc(e,t,n,o,r,i,a,l,c,u){const d=l.baseFontFull,g=Ia(e,t,d,r-l.cellHorizontalPadding*2,u??!1),h=ps(e,d),m=l.lineHeight*h,f=h+m*(g.length-1),w=f+l.cellVerticalPadding>i;w&&(e.save(),e.rect(n,o,r,i),e.clip());const C=o+i/2-f/2;let k=Math.max(o+l.cellVerticalPadding,C);for(const b of g)if(ws(e,b,n,k,r,h,a,l,c),k+=m,k>o+i)break;w&&e.restore()}function Bn(e,t,n,o,r){const{ctx:i,rect:a,theme:l}=e,{x:c,y:u,width:d,height:g}=a;o=o??!1,o||(t=bc(t,d));const h=hn(i,l),m=Ni(t)==="rtl";if(n===void 0&&m&&(n="right"),m&&(i.direction="rtl"),t.length>0){let f=!1;n==="right"?(i.textAlign="right",f=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,f=!0),o?yc(i,t,c,u,d,g,h,l,n,r):ws(i,t,c,u,d,g,h,l,n),f&&(i.textAlign="start"),m&&(i.direction="inherit")}}function Hn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Cc(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function kc(e,t,n){const o=function(l,c){const u=c.x-l.x,d=c.y-l.y,g=Math.sqrt(u*u+d*d),h=u/g,m=d/g;return{x:u,y:c.y-l.y,len:g,nx:h,ny:m,ang:Math.atan2(m,h)}};let r;const i=t.length;let a=t[i-1];for(let l=0;l<i;l++){let c=t[l%i];const u=t[(l+1)%i],d=o(c,a),g=o(c,u),h=d.nx*g.ny-d.ny*g.nx,m=d.nx*g.nx-d.ny*-g.ny;let f=Math.asin(h<-1?-1:h>1?1:h),w=1,C=!1;m<0?f<0?f=Math.PI+f:(f=Math.PI-f,w=-1,C=!0):f>0&&(w=-1,C=!0),r=c.radius!==void 0?c.radius:n;const k=f/2;let b=Math.abs(Math.cos(k)*r/Math.sin(k)),y;b>Math.min(d.len/2,g.len/2)?(b=Math.min(d.len/2,g.len/2),y=Math.abs(b*Math.sin(k)/Math.cos(k))):y=r;let H=c.x+g.nx*b,A=c.y+g.ny*b;H+=-g.ny*y*w,A+=g.nx*y*w,e.arc(H,A,y,d.ang+Math.PI/2*w,g.ang-Math.PI/2*w,C),a=c,c=u}e.closePath()}function Ai(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C){const k={x:0,y:i+u,width:0,height:0},b=w??(r>0?1:0),y=-(b+1);if(e>=m.length||t>=d||t<y||e<0)return k;const H=C??(r>0?[r]:[]),A=H.reduce((P,E)=>P+E,0),v=i-A;if(e>=g){const P=a>e?-1:1,E=Ko(m);k.x+=E+c;for(let M=a;M!==e;M+=P)k.x+=m[P===1?M:M-1].width*P}else for(let P=0;P<e;P++)k.x+=m[P].width;if(k.width=m[e].width+1,t===-1)k.y=A,k.height=v;else if(t<=-2){const P=-(t+2);let E=0;for(let R=0;R<P;R++)E+=H[R]??0;k.y=E,k.height=H[P]??r;let M=e;const L=m[e].group,I=m[e].sticky;for(;M>0&&Yr(m[M-1].group,L,P,b)&&m[M-1].sticky===I;){const R=m[M-1];k.x-=R.width,k.width+=R.width,M--}let D=e;for(;D+1<m.length&&Yr(m[D+1].group,L,P,b)&&m[D+1].sticky===I;){const R=m[D+1];k.width+=R.width,D++}if(!I){const R=Ko(m),x=k.x-R;x<0&&(k.x-=x,k.width+=x),k.x+k.width>n&&(k.width=n-k.x)}}else if(t>=d-h){let P=d-t;for(k.y=o;P>0;){const E=t+P-1;k.height=typeof f=="number"?f:f(E),k.y-=k.height,P--}k.height+=1}else{const P=l>t?-1:1;if(typeof f=="number"){const E=t-l;k.y+=E*f}else for(let E=l;E!==t;E+=P)k.y+=f(E)*P;k.height=(typeof f=="number"?f:f(t))+1}return k}const Xi=1<<21;function Cn(e,t){return(t+2)*Xi+e}function bs(e){return e%Xi}function Ki(e){return Math.floor(e/Xi)-2}function Yi(e){const t=bs(e),n=Ki(e);return[t,n]}class ys{constructor(){$e(this,"visibleWindow",{x:0,y:0,width:0,height:0});$e(this,"freezeCols",0);$e(this,"freezeRows",[]);$e(this,"isInWindow",t=>{const n=bs(t),o=Ki(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Go(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class vc extends ys{constructor(){super(...arguments);$e(this,"cache",new Map);$e(this,"setValue",(n,o)=>{this.cache.set(Cn(n[0],n[1]),o)});$e(this,"getValue",n=>this.cache.get(Cn(n[0],n[1])));$e(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class $o{constructor(t=[]){$e(this,"cells");this.cells=new Set(t.map(n=>Cn(n[0],n[1])))}add(t){this.cells.add(Cn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(Cn(t[0],t[1]))}remove(t){this.cells.delete(Cn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Ki(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(Cn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Yi(t)}}const Pi=150;function xc(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Pi}function Cs(e,t,n,o,r,i,a,l,c){let u=0;const d=r===void 0?[]:r.map(m=>{const f=xc(e,m[o],t,c);return u=Math.max(u,f),f});if(d.length>5&&l){u=0;let m=0;for(const w of d)m+=w;const f=m/d.length;for(let w=0;w<d.length;w++)d[w]>=f*2?d[w]=0:u=Math.max(u,d[w])}const g=e.font;e.font=t.headerFontFull,u=Math.max(u,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=g;const h=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(u)));return{...n,width:h}}function Sc(e,t,n,o,r,i,a,l,c){const u=s.useRef(t),d=s.useRef(n),g=s.useRef(a);u.current=t,d.current=n,g.current=a;const[h,m]=s.useMemo(()=>{if(typeof window>"u")return[null,null];const b=document.createElement("canvas");return b.style.display="none",b.style.opacity="0",b.style.position="fixed",[b,b.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>(h&&document.documentElement.append(h),()=>{h==null||h.remove()}),[h]);const f=s.useRef({}),w=s.useRef(),[C,k]=s.useState();return s.useLayoutEffect(()=>{const b=d.current;if(b===void 0||e.every(Br))return;let y=Math.max(1,10-Math.floor(e.length/1e4)),H=0;y<u.current&&y>1&&(y--,H=1);const A={x:0,y:0,width:e.length,height:Math.min(u.current,y)},v={x:0,y:u.current-1,width:e.length,height:1};(async()=>{const E=b(A,c.signal),M=H>0?b(v,c.signal):void 0;let L;typeof E=="object"?L=E:L=await Ml(E),M!==void 0&&(typeof M=="object"?L=[...L,...M]:L=[...L,...await Ml(M)]),w.current=e,k(L)})()},[c.signal,e]),s.useMemo(()=>{let y=e.every(Br)?e:m===null?e.map(P=>Br(P)?P:{...P,width:Pi}):(m.font=g.current.baseFontFull,e.map((P,E)=>{if(Br(P))return P;if(f.current[P.id]!==void 0)return{...P,width:f.current[P.id]};if(C===void 0||w.current!==e||P.id===void 0)return{...P,width:Pi};const M=Cs(m,a,P,E,C,r,i,!0,l);return f.current[P.id]=M.width,M})),H=0,A=0;const v=[];for(const[P,E]of y.entries())H+=E.width,E.grow!==void 0&&E.grow>0&&(A+=E.grow,v.push(P));if(H<o&&v.length>0){const P=[...y],E=o-H;let M=E;for(let L=0;L<v.length;L++){const I=v[L],D=(y[I].grow??0)/A,R=L===v.length-1?M:Math.min(M,Math.floor(E*D));P[I]={...y[I],growOffset:R,width:y[I].width+R},M-=R}y=P}return{sizedColumns:y,nonGrowWidth:H}},[o,e,m,C,a,r,i,l])}const Ct='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Mc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Rc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Ec=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},Ic=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Hc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},ks=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Dc=e=>{const t=e.bgColor;return`${Ct}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Fc=ks,Tc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},Ac=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Pc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},zc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Lc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Bc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},Wc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Oc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},$c=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},Gc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},Xc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},Kc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},Yc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},_c=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Vc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},Uc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${Ct}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},qc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},jc=e=>{const t=e.fgColor,n=e.bgColor;return`${Ct}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},Zc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},Jc=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},Qc=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),ed=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),td={headerRowID:Mc,headerNumber:Ec,headerCode:Rc,headerString:Ic,headerBoolean:Hc,headerAudioUri:Fc,headerVideoUri:Tc,headerEmoji:Ac,headerImage:Pc,headerUri:ks,headerPhone:zc,headerMarkdown:Lc,headerDate:Bc,headerTime:Wc,headerEmail:Oc,headerReference:Nc,headerIfThenElse:$c,headerSingleValue:Gc,headerLookup:Xc,headerTextTemplate:Kc,headerMath:Yc,headerRollup:_c,headerJoinStrings:Vc,headerSplitString:Uc,headerGeoDistance:qc,headerArray:jc,rowOwnerOverlay:Zc,protectedColumnOverlay:Jc,renameIcon:Dc,headerArrowDown:Qc,headerArrowUp:ed};function nd(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class od{constructor(t,n){$e(this,"onSettled");$e(this,"spriteMap",new Map);$e(this,"headerIcons");$e(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,l,c=1){const[u,d]=nd(n,l),g=a*Math.ceil(window.devicePixelRatio),h=`${u}_${d}_${g}_${t}`;let m=this.spriteMap.get(h);if(m===void 0){const f=this.headerIcons[t];if(f===void 0)return;m=document.createElement("canvas");const w=m.getContext("2d");if(w===null)return;const C=new Image;C.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(f({fgColor:d,bgColor:u}))}`,this.spriteMap.set(h,m);const k=C.decode();if(k===void 0)return;this.inFlight++,k.then(()=>{w.drawImage(C,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(m,0,0,g,g,r,i,a,a),c<1&&(o.globalAlpha=1)}}function vs(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function jr(e,t,n,o,r,i,a,l,c){l=l??t;let u=t,d=e;const g=o-i;let h=!1;for(;u<n&&d<g;){const m=r(d);if(u+m>l&&c(u,d,m,!1,a&&d===o-1)===!0){h=!0;break}u+=m,d++}if(!h){u=n;for(let m=0;m<i;m++){d=o-1-m;const f=r(d);u-=f,c(u,d,f,!0,a&&d===o-1)}}}function ro(e,t,n,o,r,i){let a=0,l=0;const c=r+o;for(const u of e){const d=u.sticky?l:a+n;if(i(u,d,c,u.sticky?0:l,t)===!0)break;a+=u.width,l+=u.sticky?u.width:0}}function rd(e,t,n,o,r){let i=0,a=0;for(let l=0;l<e.length;l++){const c=e[l];let u=l+1,d=c.width;for(c.sticky&&(a+=d);u<e.length&&ds(e[u].group,c.group)&&e[u].sticky===e[l].sticky;){const w=e[u];d+=w.width,u++,l++,w.sticky&&(a+=w.width)}const g=c.sticky?0:n,h=i+g,m=c.sticky?0:Math.max(0,a-h),f=Math.min(d-m,t-(h+m));r([c.sourceIndex,e[u-1].sourceIndex],Co(c.group),h+m,0,f,o),i+=d}}function id(e,t,n,o,r,i){if(r===0)return;const a=[];let l=0;for(let d=0;d<r;d++)a.push(l),l+=o[d]??0;const c=[];let u=0;for(const d of e)c.push(u),u+=d.width;for(let d=0;d<r;d++){const g=a[d],h=o[d]??0;let m=0,f=0;for(;f<e.length;){const w=e[f],C=Fi(w.group,d,r);if(C===void 0){w.sticky&&(m+=w.width),f++;continue}const k=c[f];let b=f+1,y=w.width;for(w.sticky&&(m+=w.width);b<e.length;){const E=e[b],M=Yr(E.group,w.group,d,r),L=E.sticky===w.sticky;if(!M||!L)break;y+=E.width,E.sticky&&(m+=E.width),b++}const H=w.sticky?0:n,A=k+H,v=w.sticky?0:Math.max(0,m-A),P=Math.min(y-v,t-(A+v));P>0&&i([w.sourceIndex,e[b-1].sourceIndex],C,A+v,g,P,h,d),f=b}}}function xs(e,t,n,o,r,i,a){var h;const[l,c]=e;let u,d;const g=((h=a.find(m=>!m.sticky))==null?void 0:h.sourceIndex)??0;if(c>g){const m=Math.max(l,g);let f=t,w=o;for(let C=i.sourceIndex-1;C>=m;C--)f-=a[C].width,w+=a[C].width;for(let C=i.sourceIndex+1;C<=c;C++)w+=a[C].width;d={x:f,y:n,width:w,height:r}}if(g>l){const m=Math.min(c,g-1);let f=t,w=o;for(let C=i.sourceIndex-1;C>=l;C--)f-=a[C].width,w+=a[C].width;for(let C=i.sourceIndex+1;C<=m;C++)w+=a[C].width;u={x:f,y:n,width:w,height:r}}return[u,d]}function ld(e,t,n,o){if(o==="any")return Ss(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),us([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,l=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:l);return c===l?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===a?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function hr(e,t,n,o,r,i,a,l){return e<=r+a&&r<=e+n&&t<=i+l&&i<=t+o}function to(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Ss(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function sd(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function ad(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,l=n+4,c=r-e.x,u=e.x+e.width-a,d=i-e.y,g=e.y+e.height-l,h=c>0?e.x+Math.floor(c/o)*o:e.x,m=u>0?e.x+e.width-Math.floor(u/o)*o:e.x+e.width,f=d>0?e.y+Math.floor(d/o)*o:e.y,w=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:h,y:f,width:m-h,height:w-f}}function cd(e,t,n,o,r){const[i,a,l,c]=t,[u,d,g,h]=r,{x:m,y:f,width:w,height:C}=e,k=[];if(w<=0||C<=0)return k;const b=m+w,y=f+C,H=m<i,A=f<a,v=m+w>l,P=f+C>c,E=m>=i&&m<l||b>i&&b<=l||m<i&&b>l,M=f>=a&&f<c||y>a&&y<=c||f<a&&y>c;if(E&&M){const I=Math.max(m,i),D=Math.max(f,a),R=Math.min(b,l),x=Math.min(y,c);k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:u,y:d,width:g-u+1,height:h-d+1}})}if(H&&A){const I=m,D=f,R=Math.min(b,i),x=Math.min(y,a);k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:0,y:0,width:u+1,height:d+1}})}if(A&&E){const I=Math.max(m,i),D=f,R=Math.min(b,l),x=Math.min(y,a);k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:u,y:0,width:g-u+1,height:d+1}})}if(A&&v){const I=Math.max(m,l),D=f,R=b,x=Math.min(y,a);k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:g,y:0,width:n-g+1,height:d+1}})}if(H&&M){const I=m,D=Math.max(f,a),R=Math.min(b,i),x=Math.min(y,c);k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:0,y:d,width:u+1,height:h-d+1}})}if(v&&M){const I=Math.max(m,l),D=Math.max(f,a),R=b,x=Math.min(y,c);k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:g,y:d,width:n-g+1,height:h-d+1}})}if(H&&P){const I=m,D=Math.max(f,c),R=Math.min(b,i),x=y;k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:0,y:h,width:u+1,height:o-h+1}})}if(P&&E){const I=Math.max(m,i),D=Math.max(f,c),R=Math.min(b,l),x=y;k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:u,y:h,width:g-u+1,height:o-h+1}})}if(v&&P){const I=Math.max(m,l),D=Math.max(f,c),R=b,x=y;k.push({rect:{x:I,y:D,width:R-I,height:x-D},clip:{x:g,y:h,width:n-g+1,height:o-h+1}})}return k}const dd={kind:J.Loading,allowOverlay:!1};function Pl(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C,k,b,y,H,A,v,P,E,M,L,I,D,R,x,W,V,oe,ne){let U=(y==null?void 0:y.size)??Number.MAX_SAFE_INTEGER;const G=performance.now();let K=R.baseFontFull;e.font=K;const Z={ctx:e},fe=[0,0],ce=C>0?ko(c,C,u):0;let re,se;const z=new $o,X=new Set,Y=vs(b);if(ro(t,l,i,a,r,(Q,ve,De,N,ee)=>{const we=Math.max(0,N-ve),Ve=ve+we,Fe=r+1,Et=Q.width-we,Ie=o-r-1;if(b.length>0){let ae=!1;for(let ge=0;ge<b.length;ge++){const Le=b[ge];if(hr(Ve,Fe,Et,Ie,Le.x,Le.y,Le.width,Le.height)){ae=!0;break}}if(!ae)return}const O=()=>{e.save(),e.beginPath(),e.rect(Ve,Fe,Et,Ie),e.clip()},ie=H.columns.hasIndex(Q.sourceIndex),te=g(Co(Q.group)).overrideTheme,pe=Q.themeOverride===void 0&&te===void 0?R:In(R,te,Q.themeOverride),Ee=pe.baseFontFull;Ee!==K&&(K=Ee,e.font=Ee),O();let ze;return jr(ee,De,o,c,u,C,k,Y,(ae,ge,Le,Ye,_)=>{var nn,pn,Dn;if(ge<0)return;if(fe[0]=Q.sourceIndex,fe[1]=ge,z.has(fe)){U--;return}if(y!==void 0&&!y.has(fe))return;if(b.length>0){let he=!1;for(let Ze=0;Ze<b.length;Ze++){const Je=b[Ze];if(hr(ve,ae,Q.width,Le,Je.x,Je.y,Je.width,Je.height)){he=!0;break}}if(!he)return}const Ke=H.rows.hasIndex(ge),He=m.hasIndex(ge),ke=ge<c?d(fe):dd;let ut=ve,lt=Q.width,Be=ae,Ne=Le,ft=!1,Dt=!1;if(ke.rowspan!==void 0){const[he,Ze]=ke.rowspan,Je=`${Q.sourceIndex}|${he}`;if(X.has(Je)){U--;return}else{let Gt=ae;for(let st=he;st<ge;st++)Gt-=u(st);let Xt=0;for(let st=he;st<Ze;st++)Xt+=u(st);if(Gt<Fe+Ie&&Gt+Xt>Fe){Be=Gt,Ne=Xt,X.add(Je);for(let st=he;st<Ze;st++)st!==ge&&z.add([Q.sourceIndex,st]);ft=!0}else{X.add(Je);for(let st=he;st<Ze;st++)z.add([Q.sourceIndex,st]);U--;return}}}if(ke.span!==void 0){const[he,Ze]=ke.span,Je=`${ge},${he},${Ze},${Q.sticky}`;if(se===void 0&&(se=new Set),se.has(Je)){U--;return}else{const Gt=xs(ke.span,ve,ae,Q.width,Le,Q,n),Xt=Q.sticky?Gt[0]:Gt[1];!Q.sticky&&Gt[0]!==void 0&&(Dt=!0),Xt!==void 0&&(ut=Xt.x,lt=Xt.width,se.add(Je),ft=!0)}}if(ft){e.restore(),ze=void 0,e.save(),e.beginPath();const he=Math.max(0,N-ut);e.rect(ut+he,Be,lt-he,Ne),re===void 0&&(re=[]),re.push({x:ut+he,y:Be,width:lt-he,height:Ne}),e.clip()}const pt=h==null?void 0:h(ge),At=_&&((nn=Q.trailingRowOptions)==null?void 0:nn.themeOverride)!==void 0?(pn=Q.trailingRowOptions)==null?void 0:pn.themeOverride:void 0,kt=ke.themeOverride===void 0&&pt===void 0&&At===void 0?pe:In(pe,pt,At,ke.themeOverride);e.beginPath();const Ft=dc(fe,ke,H);let Wt=uc(fe,ke,H,w);const gn=ke.span!==void 0&&H.columns.some(he=>ke.span!==void 0&&he>=ke.span[0]&&he<=ke.span[1]);Ft&&!f&&w?Wt=0:Ft&&w&&(Wt=Math.max(Wt,1)),gn&&Wt++,Ft||(Ke&&Wt++,ie&&!_&&Wt++);const en=ke.kind===J.Protected?kt.bgCellMedium:kt.bgCell;let bt;if((Ye||en!==R.bgCell)&&(bt=fn(en,bt)),Wt>0||He){He&&(bt=fn(kt.bgHeader,bt));for(let he=0;he<Wt;he++)bt=fn(kt.accentLight,bt)}else if(A!==void 0){for(const he of A)if(he[0]===Q.sourceIndex&&he[1]===ge){bt=fn(kt.bgSearchResult,bt);break}}if(v!==void 0)for(let he=0;he<v.length;he++){const Ze=v[he],Je=Ze.range;Ze.style!=="solid-outline"&&Je.x<=Q.sourceIndex&&Q.sourceIndex<Je.x+Je.width&&Je.y<=ge&&ge<Je.y+Je.height&&(bt=fn(Ze.color,bt))}let mn=!1;if(y!==void 0){const he=ae+1,Je=(Ye?he+Le-1:Math.min(he+Le-1,o-ce))-he;(Je!==Le-1||ut+1<=N)&&(mn=!0,e.save(),e.beginPath(),e.rect(ut+1,he,lt-1,Je),e.clip()),bt=bt===void 0?kt.bgCell:fn(bt,kt.bgCell)}const qe=Q.sourceIndex===n.length-1,Nt=ge===c-1;bt!==void 0&&(e.fillStyle=bt,ze!==void 0&&(ze.fillStyle=bt),y!==void 0?e.fillRect(ut+1,Be+1,lt-(qe?2:1),Ne-(Nt?2:1)):e.fillRect(ut,Be,lt,Ne)),ke.style==="faded"&&(e.globalAlpha=.6);let tn;for(let he=0;he<M.length;he++){const Ze=M[he];if(Ze.item[0]===Q.sourceIndex&&Ze.item[1]===ge){tn=Ze;break}}if(lt>ne&&!Dt){const he=kt.baseFontFull;he!==K&&(e.font=he,K=he);let Ze=0;if(ke.rowspan!==void 0){const Je=ke.rowSpanPosition??"top";if(Je==="top")Ze=Le/2-Ne/2;else if(Je==="bottom"){const[Gt,Xt]=ke.rowspan,st=u(Xt-1);Ze=Ne/2-st/2}}ze=Ms(e,ke,Q.sourceIndex,ge,qe,Nt,ut,Be,lt,Ne,Wt>0,kt,bt??kt.bgCell,P,E,(tn==null?void 0:tn.hoverAmount)??0,L,D,G,I,ze,x,W,V,oe,Ze)}return mn&&e.restore(),ke.style==="faded"&&(e.globalAlpha=1),U--,ft&&(e.restore(),(Dn=ze==null?void 0:ze.deprep)==null||Dn.call(ze,Z),ze=void 0,O(),K=Ee,e.font=Ee),U<=0}),e.restore(),U<=0}),re!==void 0)return re}const lr=[0,0],sr={x:0,y:0,width:0,height:0},xi=[void 0,()=>{}];let zi=!1;function ud(){zi=!0}function Ms(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C,k,b,y,H,A,v,P,E,M){var V,oe;let L,I;C!==void 0&&C[0][0]===n&&C[0][1]===o&&(L=C[1][0],I=C[1][1]);let D;lr[0]=n,lr[1]=o,sr.x=a,sr.y=l,sr.width=c,sr.height=u,xi[0]=v.getValue(lr),xi[1]=ne=>v.setValue(lr,ne),zi=!1;const R={ctx:e,theme:g,col:n,row:o,cell:t,rect:sr,highlighted:d,cellFillColor:h,hoverAmount:w,frameTime:b,hoverX:L,drawState:xi,hoverY:I,imageLoader:m,spriteManager:f,hyperWrapping:k,overrideCursor:L!==void 0?E:void 0,requestAnimationFrame:ud},x=pc(R,t.lastUpdated,b,H,r,i),W=P(t);if(W!==void 0){(H==null?void 0:H.renderer)!==W&&((V=H==null?void 0:H.deprep)==null||V.call(H,R),H=void 0);const ne=(oe=W.drawPrep)==null?void 0:oe.call(W,R,H);e.save(),e.translate(0,M),y!==void 0&&!yo(R.cell)?y(R,()=>W.draw(R,t)):W.draw(R,t),e.restore(),D=ne===void 0?void 0:{deprep:ne==null?void 0:ne.deprep,fillStyle:ne==null?void 0:ne.fillStyle,font:ne==null?void 0:ne.font,renderer:W}}return(x||zi)&&(A==null||A(lr)),D}function _r(e,t,n,o,r,i,a,l,c=-20,u=-20,d=void 0,g="center",h="square",m=!1){const f=Math.floor(r+a/2),w=h==="circle"?1e4:t.roundingRadius??4;let C=os(d??t.checkboxMaxSize,a,t.cellVerticalPadding),k=C/2;const b=ns(g,o,i,t.cellHorizontalPadding,C),y=ts(b,f,C),H=rs(o+c,r+u,y);switch(n){case!0:{e.beginPath(),Hn(e,b-C/2,f-C/2,C,C,w),h==="circle"&&(k*=.8,C*=.8),e.fillStyle=m?t.bgCellMedium:l?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(b-k+C/4.23,f-k+C/1.97),e.lineTo(b-k+C/2.42,f-k+C/1.44),e.lineTo(b-k+C/1.29,f-k+C/3.25),e.strokeStyle=m?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Gr:case!1:{e.beginPath(),Hn(e,b-C/2+.5,f-C/2+.5,C-1,C-1,w),e.lineWidth=1,e.strokeStyle=m?t.textLight:H?t.textDark:t.textMedium,e.stroke();break}case Bi:{e.beginPath(),Hn(e,b-C/2,f-C/2,C,C,w),e.fillStyle=m?t.bgCellMedium:H?t.textMedium:t.textLight,e.fill(),h==="circle"&&(k*=.8,C*=.8),e.beginPath(),e.moveTo(b-C/3,f),e.lineTo(b+C/3,f),e.strokeStyle=m?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:fr()}}function fd(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C,k,b,y,H,A){var W,V,oe,ne;const v=H??(o?1:0),P=A??(o?[c]:[]),E=P.reduce((U,G)=>U+G,0),M=l+E;if(M<=0)return;e.fillStyle=h.bgHeader,k!==void 0&&o&&(H??1)>1?e.fillRect(0,E,i,l):e.fillRect(0,0,i,M);const L=(W=r==null?void 0:r[0])==null?void 0:W[0],I=(V=r==null?void 0:r[0])==null?void 0:V[1],D=(oe=r==null?void 0:r[1])==null?void 0:oe[0],R=(ne=r==null?void 0:r[1])==null?void 0:ne[1],x=h.headerFontFull;e.font=x,ro(t,0,a,0,M,(U,G,K,Z)=>{var ee;if(k!==void 0&&!k.has([U.sourceIndex,-1]))return;const fe=Math.max(0,Z-G);e.save(),e.beginPath(),e.rect(G+fe,E,U.width-fe,l),e.clip();const ce=C(Co(U.group)).overrideTheme,re=U.themeOverride===void 0&&ce===void 0?h:In(h,ce,U.themeOverride);re.bgHeader!==h.bgHeader&&(e.fillStyle=re.bgHeader,e.fill()),re!==h&&(e.font=re.headerFontFull);const se=g.columns.hasIndex(U.sourceIndex),z=u!==void 0||d||U.headerRowMarkerDisabled===!0,X=!z&&I===-1&&L===U.sourceIndex,Y=z?0:((ee=f.find(we=>we.item[0]===U.sourceIndex&&we.item[1]===-1))==null?void 0:ee.hoverAmount)??0,Q=(g==null?void 0:g.current)!==void 0&&g.current.cell[0]===U.sourceIndex,ve=se?re.accentColor:Q?re.bgHeaderHasFocus:re.bgHeader,De=o?E:0,N=U.sourceIndex===0?0:1;se?(e.fillStyle=ve,e.fillRect(G+N,De,U.width-N,l)):(Q||Y>0)&&(e.beginPath(),e.rect(G+N,De,U.width-N,l),Q&&(e.fillStyle=re.bgHeaderHasFocus,e.fill()),Y>0&&(e.globalAlpha=Y,e.fillStyle=re.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Es(e,G,De,U.width,l,U,se,re,X,X?D:void 0,X?R:void 0,Q,Y,m,b,y),e.restore()}),o&&(v>1?gd(e,t,i,a,P,v,r,h,m,f,w,C,k):hd(e,t,i,a,c,r,h,m,f,w,C,k)),o&&(H??1)>1&&(e.beginPath(),e.moveTo(0,E+.5),e.lineTo(i,E+.5),e.strokeStyle=h.borderColor,e.lineWidth=1,e.stroke())}function hd(e,t,n,o,r,i,a,l,c,u,d,g){const[h,m]=(i==null?void 0:i[0])??[];let f=0;rd(t,n,o,r,(w,C,k,b,y,H)=>{if(g!==void 0&&!g.hasItemInRectangle({x:w[0],y:-2,width:w[1]-w[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(k,b,y,H),e.clip();const A=d(C),v=(A==null?void 0:A.overrideTheme)===void 0?a:In(a,A.overrideTheme),P=m===-2&&h!==void 0&&h>=w[0]&&h<=w[1],E=P?v.bgGroupHeaderHovered??v.bgHeaderHovered:v.bgGroupHeader??v.bgHeader;if(E!==a.bgHeader&&(e.fillStyle=E,e.fill()),e.fillStyle=v.textGroupHeader??v.textHeader,A!==void 0){const M=A.name,I=e.measureText(M).width,D=A.icon!==void 0?26:0,R=D+I,x=k+(y-R)/2;if(A.icon!==void 0&&l.drawSprite(A.icon,"normal",e,x,(r-20)/2,20,v),e.fillText(M,x+D,r/2+hn(e,a.headerFontFull)),A.actions!==void 0&&P){const W=_i({x:k,y:b,width:y,height:H},A.actions);e.beginPath();const V=W[0].x-10,oe=k+y-V;e.rect(V,0,oe,r);const ne=e.createLinearGradient(V,0,V+oe,0),U=oo(E,0);ne.addColorStop(0,U),ne.addColorStop(10/oe,E),ne.addColorStop(1,E),e.fillStyle=ne,e.fill(),e.globalAlpha=.6;const[G,K]=(i==null?void 0:i[1])??[-1,-1];for(let Z=0;Z<A.actions.length;Z++){const fe=A.actions[Z],ce=W[Z],re=to(ce,G+k,K);re&&(e.globalAlpha=1),l.drawSprite(fe.icon,"normal",e,ce.x+ce.width/2-10,ce.y+ce.height/2-10,20,v),re&&(e.globalAlpha=.6)}e.globalAlpha=1}}k!==0&&u(w[0])&&(e.beginPath(),e.moveTo(k+.5,0),e.lineTo(k+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),f=k+y}),e.beginPath(),e.moveTo(f+.5,0),e.lineTo(f+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}function gd(e,t,n,o,r,i,a,l,c,u,d,g,h){const[m,f]=(a==null?void 0:a[0])??[];e.font=l.headerFontFull;const w=r.reduce((k,b)=>k+b,0);h===void 0&&(e.fillStyle=l.bgHeader,e.fillRect(0,0,n,w));let C=0;if(id(t,n,o,r,i,(k,b,y,H,A,v,P)=>{const E=-(P+2);if(h!==void 0&&!h.hasItemInRectangle({x:k[0],y:E,width:k[1]-k[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,H,A,v),e.clip();const M=g(b),L=(M==null?void 0:M.overrideTheme)===void 0?l:In(l,M.overrideTheme),I=f===E&&m!==void 0&&m>=k[0]&&m<=k[1],D=I?L.bgGroupHeaderHovered??L.bgHeaderHovered:L.bgGroupHeader??L.bgHeader;e.fillStyle=D,e.fillRect(y,H,A,v),e.fillStyle=L.textGroupHeader??L.textHeader;const R=(M==null?void 0:M.name)??b,W=e.measureText(R).width,V=(M==null?void 0:M.icon)!==void 0?26:0,oe=V+W,ne=y+(A-oe)/2;if((M==null?void 0:M.icon)!==void 0&&c.drawSprite(M.icon,"normal",e,ne,H+(v-20)/2,20,L),e.fillText(R,ne+V,H+v/2+hn(e,l.headerFontFull)),M!==void 0&&M.actions!==void 0&&I){const U=_i({x:y,y:H,width:A,height:v},M.actions);e.beginPath();const G=U[0].x-10,K=y+A-G;e.rect(G,H,K,v);const Z=e.createLinearGradient(G,0,G+K,0),fe=oo(D,0);Z.addColorStop(0,fe),Z.addColorStop(10/K,D),Z.addColorStop(1,D),e.fillStyle=Z,e.fill(),e.globalAlpha=.6;const[ce,re]=(a==null?void 0:a[1])??[-1,-1];for(let se=0;se<M.actions.length;se++){const z=M.actions[se],X=U[se],Y=to(X,ce+y,re);Y&&(e.globalAlpha=1),c.drawSprite(z.icon,"normal",e,X.x+X.width/2-10,X.y+X.height/2-10,20,L),Y&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=l.borderColor,e.lineWidth=1,y!==0&&d(k[0])&&(e.beginPath(),e.moveTo(y+.5,H),e.lineTo(y+.5,H+v),e.stroke()),(P<i-1||h===void 0)&&(e.beginPath(),e.moveTo(y,H+v+.5),e.lineTo(y+A,H+v+.5),e.stroke()),e.restore(),C=Math.max(C,y+A)}),h===void 0){e.beginPath(),e.moveTo(C+.5,0),e.lineTo(C+.5,w);let k=0;for(let b=0;b<i-1;b++)k+=r[b],e.moveTo(0,k+.5),e.lineTo(n,k+.5);e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}}const Or=30;function md(e,t,n,o,r){return{x:e+n-Or,y:Math.max(t,t+o/2-Or/2),width:Or,height:Math.min(Or,o)}}function _i(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let l=0;l<t.length;l++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function ar(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Rs(e,t,n,o,r,i,a,l){var H;const c=a.cellHorizontalPadding,u=a.headerIconSize,d=md(n,o,r,i),g=e===void 0?((H=ms(t.title,a.headerFontFull))==null?void 0:H.width)??0:vo(t.title,e,a.headerFontFull).width,h=t.icon!==void 0?Math.ceil(u*1.3):0,m=h+g,f=n+Math.max(c,(r-m)/2),w=t.icon===void 0?void 0:{x:f,y:o+(i-u)/2,width:u,height:u},C=w===void 0||t.overlayIcon===void 0?void 0:{x:w.x+9,y:w.y+6,width:18,height:18},k={x:f+h,y:o,width:g,height:i};let b;t.indicatorIcon!==void 0&&(b={x:k.x+g+c,y:o+(i-u)/2,width:u,height:u});const y=n+r/2;return{menuBounds:ar(d,y,l),iconBounds:ar(w,y,l),iconOverlayBounds:ar(C,y,l),textBounds:ar(k,y,l),indicatorIconBounds:ar(b,y,l)}}function zl(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const b=i.rowMarkerChecked;b!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const y=i.headerRowMarkerTheme!==void 0?In(l,i.headerRowMarkerTheme):l;_r(e,y,b,t,n,o,r,!1,void 0,void 0,l.checkboxMaxSize,"center",i.rowMarker),b!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const C=a?l.textHeaderSelected:l.textHeader,k=i.hasMenu===!0&&(c||m&&a)&&w.menuBounds!==void 0;if(i.icon!==void 0&&w.iconBounds!==void 0){let b=a?"selected":"normal";i.style==="highlight"&&(b=a?"selected":"special"),h.drawSprite(i.icon,b,e,w.iconBounds.x,w.iconBounds.y,w.iconBounds.width,l),i.overlayIcon!==void 0&&w.iconOverlayBounds!==void 0&&h.drawSprite(i.overlayIcon,a?"selected":"special",e,w.iconOverlayBounds.x,w.iconOverlayBounds.y,w.iconOverlayBounds.width,l)}if(k&&o>35){const y=f?35:o-35,H=f?35*.7:o-35*.7,A=y/o,v=H/o,P=e.createLinearGradient(t,0,t+o,0),E=oo(C,0);P.addColorStop(f?1:0,C),P.addColorStop(A,C),P.addColorStop(v,E),P.addColorStop(f?0:1,E),e.fillStyle=P}else e.fillStyle=C;if(f&&(e.textAlign="right"),w.textBounds!==void 0&&e.fillText(i.title,f?w.textBounds.x+w.textBounds.width:w.textBounds.x,n+r/2+hn(e,l.headerFontFull)),f&&(e.textAlign="left"),i.indicatorIcon!==void 0&&w.indicatorIconBounds!==void 0&&(!k||!hr(w.menuBounds.x,w.menuBounds.y,w.menuBounds.width,w.menuBounds.height,w.indicatorIconBounds.x,w.indicatorIconBounds.y,w.indicatorIconBounds.width,w.indicatorIconBounds.height))){let b=a?"selected":"normal";i.style==="highlight"&&(b=a?"selected":"special"),h.drawSprite(i.indicatorIcon,b,e,w.indicatorIconBounds.x,w.indicatorIconBounds.y,w.indicatorIconBounds.width,l)}if(k&&w.menuBounds!==void 0){const b=w.menuBounds,y=u!==void 0&&d!==void 0&&to(b,u+t,d+n);if(y||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Xr.Triangle){e.beginPath();const H=b.x+b.width/2-5.5,A=b.y+b.height/2-3;kc(e,[{x:H,y:A},{x:H+11,y:A},{x:H+5.5,y:A+6}],1),e.fillStyle=C,e.fill()}else if(i.menuIcon===Xr.Dots){e.beginPath();const H=b.x+b.width/2,A=b.y+b.height/2;Cc(e,H,A),e.fillStyle=C,e.fill()}else{const H=b.x+(b.width-l.headerIconSize)/2,A=b.y+(b.height-l.headerIconSize)/2;h.drawSprite(i.menuIcon,"normal",e,H,A,l.headerIconSize,l)}y||(e.globalAlpha=1)}}function Es(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w){const C=Ni(i.title)==="rtl",k=Rs(e,i,t,n,o,r,l,C);f!==void 0?f({ctx:e,theme:l,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:h,isHovered:c,hasSelectedCell:g,spriteManager:m,menuBounds:(k==null?void 0:k.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:u,hoverY:d},()=>zl(e,t,n,o,r,i,a,l,c,u,d,h,m,w,C,k)):zl(e,t,n,o,r,i,a,l,c,u,d,h,m,w,C,k)}function wd(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C,k,b){if(k!==void 0||t[t.length-1]!==n[t.length-1])return;const y=vs(C);ro(t,c,a,l,i,(H,A,v,P,E)=>{if(H!==t[t.length-1])return;A+=H.width;const M=Math.max(A,P);M>o||(e.save(),e.beginPath(),e.rect(M,i+1,1e4,r-i-1),e.clip(),jr(E,v,r,u,d,f,w,y,(L,I,D,R)=>{if(!R&&C.length>0&&!C.some(ne=>hr(A,L,1e4,D,ne.x,ne.y,ne.width,ne.height)))return;const x=h.hasIndex(I),W=m.hasIndex(I);e.beginPath();const V=g==null?void 0:g(I),oe=V===void 0?b:In(b,V);oe.bgCell!==b.bgCell&&(e.fillStyle=oe.bgCell,e.fillRect(A,L,1e4,D)),W&&(e.fillStyle=oe.bgHeader,e.fillRect(A,L,1e4,D)),x&&(e.fillStyle=oe.accentLight,e.fillRect(A,L,1e4,D))}),e.restore())})}function pd(e,t,n,o,r,i,a,l,c){let u=!1;for(const f of t)if(!f.sticky){u=a(f.sourceIndex);break}const d=c.horizontalBorderColor??c.borderColor,g=c.borderColor,h=u?Ko(t):0;let m;if(h!==0&&(m=Hl(g,c.bgCell),e.beginPath(),e.moveTo(h+.5,0),e.lineTo(h+.5,o),e.strokeStyle=m,e.stroke()),r>0){const f=g===d&&m!==void 0?m:Hl(d,c.bgCell),w=ko(i,r,l);e.beginPath(),e.moveTo(0,o-w+.5),e.lineTo(n,o-w+.5),e.strokeStyle=f,e.stroke()}}const Is=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const l of e)o=Math.min(o,l.x-1),r=Math.max(r,l.x+l.width+1),i=Math.min(i,l.y-1),a=Math.max(a,l.y+l.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function bd(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f){var D;const w=f.bgCell,{minX:C,maxX:k,minY:b,maxY:y}=Is(l,i,a),H=[],A=a-ko(m,h,u);let v=c,P=n,E=0;for(;v+r<A;){const R=v+r,x=u(P);if(R>=b&&R<=y-1){const W=d==null?void 0:d(P),V=W==null?void 0:W.bgCell;V!==void 0&&V!==w&&P>=m-h&&H.push({x:C,y:R,w:k-C,h:x,color:V})}v+=x,P<m-h&&(E=v),P++}let M=0;const L=Math.min(A,y)-E;if(L>0)for(let R=0;R<t.length;R++){const x=t[R];if(x.width===0)continue;const W=x.sticky?M:M+o,V=(D=x.themeOverride)==null?void 0:D.bgCell;V!==void 0&&V!==w&&W>=C&&W<=k&&g(R+1)&&H.push({x:W,y:E,w:x.width,h:L,color:V}),M+=x.width}if(H.length===0)return;let I;e.beginPath();for(let R=H.length-1;R>=0;R--){const x=H[R];I===void 0?I=x.color:x.color!==I&&(e.fillStyle=I,e.fill(),e.beginPath(),I=x.color),e.rect(x.x,x.y,x.w,x.h)}I!==void 0&&(e.fillStyle=I,e.fill()),e.beginPath()}function Ll(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C,k=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const D of c)e.rect(D.x+1,D.y+1,D.width-1,D.height-1);e.clip("evenodd")}const b=C.horizontalBorderColor??C.borderColor,y=C.borderColor,{minX:H,maxX:A,minY:v,maxY:P}=Is(l,i,a),E=[];e.beginPath();let M=.5;for(let D=0;D<t.length;D++){const R=t[D];if(R.width===0)continue;M+=R.width;const x=R.sticky?M:M+o;x>=H&&x<=A&&m(D+1)&&E.push({x1:x,y1:Math.max(u,v),x2:x,y2:Math.min(a,P),color:y})}let L=a+.5;for(let D=w-f;D<w;D++){const R=g(D);L-=R,E.push({x1:H,y1:L,x2:A,y2:L,color:b})}if(k!==!0){let D=d+.5,R=n;const x=L;for(;D+r<x;){const W=D+r;if(W>=v&&W<=P-1){const V=h==null?void 0:h(R);E.push({x1:H,y1:W,x2:A,y2:W,color:(V==null?void 0:V.horizontalBorderColor)??(V==null?void 0:V.borderColor)??b})}D+=g(R),R++}}const I=Da(E,D=>D.color);for(const D of Object.keys(I)){e.strokeStyle=D;for(const R of I[D])e.moveTo(R.x1,R.y1),e.lineTo(R.x2,R.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function yd(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C,k,b){const y=[];e.imageSmoothingEnabled=!1;const H=Math.min(r.cellYOffset,a),A=Math.max(r.cellYOffset,a);let v=0;if(typeof k=="number")v+=(A-H)*k;else for(let x=H;x<A;x++)v+=k(x);a>r.cellYOffset&&(v=-v),v+=c-r.translateY;const P=Math.min(r.cellXOffset,i),E=Math.max(r.cellXOffset,i);let M=0;for(let x=P;x<E;x++)M+=w[x].width;i>r.cellXOffset&&(M=-M),M+=l-r.translateX;const L=Ko(C);if(M!==0&&v!==0)return{regions:[]};const I=u>0?ko(h,u,k):0,D=d-L-Math.abs(M),R=g-m-I-Math.abs(v)-1;if(D>150&&R>150){const x={sx:0,sy:0,sw:d*f,sh:g*f,dx:0,dy:0,dw:d*f,dh:g*f};if(v>0?(x.sy=(m+1)*f,x.sh=R*f,x.dy=(v+m+1)*f,x.dh=R*f,y.push({x:0,y:m,width:d,height:v+1})):v<0&&(x.sy=(-v+m+1)*f,x.sh=R*f,x.dy=(m+1)*f,x.dh=R*f,y.push({x:0,y:g+v-I,width:d,height:-v+I})),M>0?(x.sx=L*f,x.sw=D*f,x.dx=(M+L)*f,x.dw=D*f,y.push({x:L-1,y:0,width:M+2,height:g})):M<0&&(x.sx=(L-M)*f,x.sw=D*f,x.dx=L*f,x.dw=D*f,y.push({x:d+M,y:0,width:-M,height:g})),e.setTransform(1,0,0,1,0,0),b){if(L>0&&M!==0&&v===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const W=L*f,V=g*f;e.drawImage(t,0,0,W,V,0,0,W,V)}if(I>0&&M===0&&v!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const W=(g-I)*f,V=d*f,oe=I*f;e.drawImage(t,0,W,V,oe,0,W,V,oe)}}e.drawImage(t,x.sx,x.sy,x.sw,x.sh,x.dx,x.dy,x.dw,x.dh),e.scale(f,f)}return e.imageSmoothingEnabled=!0,{regions:y}}function Cd(e,t,n,o,r,i,a,l,c,u){const d=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||ro(c,n,o,r,l,(g,h,m,f)=>{if(g.sourceIndex===u){const w=Math.max(h,f)+1;return d.push({x:w,y:0,width:i-w,height:a}),!0}}),d}function kd(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Go(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...l}=r,{width:c,...u}=i;if(!Go(l,u))return!1;n=o}return n===void 0?!0:n}return!0}function Bl(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C,k){const b=f==null?void 0:f.filter(M=>M.style!=="no-outline");if(b===void 0||b.length===0)return;const y=Ko(l),H=ko(m,h,g),A=[c,0,l.length,m-h],v=[y,0,t,n-H],P=b.map(M=>{const L=M.range,I=M.style??"dashed";return cd(L,A,t,n,v).map(D=>{const R=D.rect,x=Ai(R.x,R.y,t,n,d,u+d,o,r,i,a,m,c,h,l,g,C,k),W=R.width===1&&R.height===1?x:Ai(R.x+R.width-1,R.y+R.height-1,t,n,d,u+d,o,r,i,a,m,c,h,l,g,C,k);return R.x+R.width>=l.length&&(W.width-=1),R.y+R.height>=m&&(W.height-=1),{color:M.color,style:I,clip:D.clip,rect:ad({x:x.x,y:x.y,width:W.x+W.width-x.x,height:W.y+W.height-x.y},t,n,8)}})}),E=()=>{e.lineWidth=1;let M=!1;for(const L of P)for(const I of L)if((I==null?void 0:I.rect)!==void 0&&hr(0,0,t,n,I.rect.x,I.rect.y,I.rect.width,I.rect.height)){const D=M,R=!sd(I.clip,I.rect);e.beginPath(),R&&(e.save(),e.rect(I.clip.x,I.clip.y,I.clip.width,I.clip.height),e.clip()),I.style==="dashed"&&!M?(e.setLineDash([5,3]),M=!0):(I.style==="solid"||I.style==="solid-outline")&&M&&(e.setLineDash([]),M=!1),e.strokeStyle=I.style==="solid-outline"?fn(fn(I.color,w.borderColor),w.bgCell):oo(I.color,1),e.closePath(),e.strokeRect(I.rect.x+.5,I.rect.y+.5,I.rect.width-1,I.rect.height-1),R&&(e.restore(),M=D)}M&&e.setLineDash([])};return E(),E}function Wl(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Si(e,t,n,o,r,i,a,l,c,u,d,g,h,m,f,w,C){if(d.current===void 0)return;const k=w!==!1&&w!==void 0;if(!k)return;const b=typeof w=="object"?{...Kr,...w}:Kr,y=d.current.range,H=d.current.cell,A=[y.x+y.width-1,y.y+y.height-1];if(H[1]>=C&&A[1]>=C||!a.some(V=>V.sourceIndex===H[0]||V.sourceIndex===A[0]))return;const[P,E]=d.current.cell,M=h(d.current.cell),L=M.span??[P,P],I=E>=C-m,D=m>0&&!I?ko(C,m,g)-1:0,R=A[1];let x;if(ro(a,o,r,i,u,(V,oe,ne,U,G)=>{if(V.sticky&&P>V.sourceIndex)return;const K=V.sourceIndex<L[0],Z=V.sourceIndex>L[1],fe=V.sourceIndex===A[0];if(!(!fe&&(K||Z)))return jr(G,ne,n,C,g,m,f,void 0,(ce,re,se)=>{if(re!==E&&re!==R)return;let z=oe,X=V.width;if(M.span!==void 0){const Q=xs(M.span,oe,ce,V.width,se,V,l),ve=V.sticky?Q[0]:Q[1];ve!==void 0&&(z=ve.x,X=ve.width)}return re===R&&fe&&k&&(x=()=>{var ee;U>z&&!V.sticky&&(e.beginPath(),e.rect(U,0,t-U,n),e.clip());const Q=b.size,ve=Q/2,De=z+X+b.offsetX-ve+.5,N=ce+se+b.offsetY-ve+.5;e.beginPath(),b.shape==="circle"?e.arc(De+ve,N+ve,ve,0,Math.PI*2):e.rect(De,N,Q,Q),e.fillStyle=((ee=V.themeOverride)==null?void 0:ee.accentColor)??c.accentColor,e.fill(),b.outline>0&&(e.lineWidth=b.outline,e.strokeStyle=c.bgCell,b.shape==="circle"?(e.beginPath(),e.arc(De+ve,N+ve,ve+b.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(De-b.outline/2,N-b.outline/2,Q+b.outline,Q+b.outline))}),x!==void 0}),x!==void 0}),x===void 0)return;const W=()=>{e.save(),e.beginPath(),e.rect(0,u,t,n-u-D),e.clip(),x==null||x(),e.restore()};return W(),W}function vd(e,t,n,o,r,i,a,l,c){c===void 0||c.size===0||(e.beginPath(),ro(t,l,i,a,r,(u,d,g,h)=>{const m=Math.max(0,h-d),f=d+m+1,w=u.width-m-1;c.has([u.sourceIndex,-1])&&e.rect(f,o,w,r-o)}),e.clip())}function xd(e,t,n,o,r,i,a,l,c,u){let d=0;return ro(e,i,o,r,n,(g,h,m,f,w)=>(jr(w,m,t,a,l,c,u,void 0,(C,k,b,y)=>{y||(d=Math.max(k,d))}),!0)),d}function Ol(e,t){var mn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:l,translateX:c,translateY:u,mappedColumns:d,enableGroups:g,freezeColumns:h,dragAndDropState:m,theme:f,drawFocus:w,headerHeight:C,groupHeaderHeight:k,groupLevels:b,groupHeaderHeights:y,disabledRows:H,rowHeight:A,verticalBorder:v,overrideCursor:P,isResizing:E,selection:M,fillHandle:L,freezeTrailingRows:I,rows:D,getCellContent:R,getGroupDetails:x,getRowThemeOverride:W,isFocused:V,drawHeaderCallback:oe,prelightCells:ne,drawCellCallback:U,highlightRegions:G,resizeCol:K,imageLoader:Z,lastBlitData:fe,hoverValues:ce,hyperWrapping:re,hoverInfo:se,spriteManager:z,maxScaleFactor:X,hasAppendRow:Y,touchMode:Q,enqueue:ve,renderStateProvider:De,getCellRenderer:N,renderStrategy:ee,bufferACtx:we,bufferBCtx:Ve,damage:Fe,minimumCellWidth:Et,resizeIndicator:Ie}=e;if(r===0||i===0)return;const O=ee==="double-buffer",ie=Math.min(X,Math.ceil(window.devicePixelRatio??1)),te=ee!=="direct"&&kd(e,t),pe=n.canvas;(pe.width!==r*ie||pe.height!==i*ie)&&(pe.width=r*ie,pe.height=i*ie,pe.style.width=r+"px",pe.style.height=i+"px");const Ee=o.canvas,ze=y.reduce((qe,Nt)=>qe+Nt,0),ae=C+ze,ge=ae+1;(Ee.width!==r*ie||Ee.height!==ge*ie)&&(Ee.width=r*ie,Ee.height=ge*ie,Ee.style.width=r+"px",Ee.style.height=ge+"px");const Le=we.canvas,Ye=Ve.canvas;O&&(Le.width!==r*ie||Le.height!==i*ie)&&(Le.width=r*ie,Le.height=i*ie,fe.current!==void 0&&(fe.current.aBufferScroll=void 0)),O&&(Ye.width!==r*ie||Ye.height!==i*ie)&&(Ye.width=r*ie,Ye.height=i*ie,fe.current!==void 0&&(fe.current.bBufferScroll=void 0));const _=fe.current;if(te===!0&&a===(_==null?void 0:_.cellXOffset)&&l===(_==null?void 0:_.cellYOffset)&&c===(_==null?void 0:_.translateX)&&u===(_==null?void 0:_.translateY))return;let Ke=null;O&&(Ke=n);const He=o;let ke;O?Fe!==void 0?ke=(_==null?void 0:_.lastBuffer)==="b"?Ve:we:ke=(_==null?void 0:_.lastBuffer)==="b"?we:Ve:ke=n;const ut=ke.canvas,lt=O?ut===Le?Ye:Le:pe,Be=typeof A=="number"?()=>A:A;He.save(),ke.save(),He.beginPath(),ke.beginPath(),He.textBaseline="middle",ke.textBaseline="middle",ie!==1&&(He.scale(ie,ie),ke.scale(ie,ie));const Ne=Ti(d,a,r,m,c);let ft=[];const Dt=w&&((mn=M.current)==null?void 0:mn.cell[1])===l&&u===0;let pt=!1;if(G!==void 0){for(const qe of G)if(qe.style!=="no-outline"&&qe.range.y===l&&u===0){pt=!0;break}}const At=()=>{He.fillStyle=f.bgHeader,He.fillRect(0,0,r,ae+1),fd(He,Ne,d,g,se,r,c,C,k,m,E,M,f,z,ce,v,x,Fe,oe,Q,b,y),Ll(He,Ne,l,c,u,r,i,void 0,void 0,ze,ae,Be,W,v,I,D,f,!0),He.beginPath(),He.moveTo(0,ge-.5),He.lineTo(r,ge-.5),He.strokeStyle=fn(f.headerBottomBorderColor??f.horizontalBorderColor??f.borderColor,f.bgHeader),He.stroke(),pt&&Bl(He,r,i,a,l,c,u,d,h,C,ze,A,I,D,G,f,b,y),Dt&&Si(He,r,i,l,c,u,Ne,d,f,ae,M,Be,R,I,Y,L,D)};if(Fe!==void 0){const qe=Ne[Ne.length-1].sourceIndex+1,Nt=Fe.hasItemInRegion([{x:a,y:-2,width:qe,height:2},{x:a,y:l,width:qe,height:300},{x:0,y:l,width:h,height:300},{x:0,y:-2,width:h,height:2},{x:a,y:D-I,width:qe,height:I,when:I>0}]),tn=nn=>{Pl(nn,Ne,d,i,ae,c,u,l,D,Be,R,x,W,H,V,w,I,Y,ft,Fe,M,ne,G,Z,z,ce,se,U,re,f,ve,De,N,P,Et);const pn=M.current;L!==!1&&L!==void 0&&w&&pn!==void 0&&Fe.has(fs(pn.range))&&Si(nn,r,i,l,c,u,Ne,d,f,ae,M,Be,R,I,Y,L,D)};Nt&&(tn(ke),Ke!==null&&(Ke.save(),Ke.scale(ie,ie),Ke.textBaseline="middle",tn(Ke),Ke.restore()),Fe.hasHeader()&&(vd(He,Ne,r,ze,ae,c,u,l,Fe),At())),ke.restore(),He.restore();return}if((te!==!0||a!==(_==null?void 0:_.cellXOffset)||l!==(_==null?void 0:_.cellYOffset)||c!==(_==null?void 0:_.translateX)||u!==(_==null?void 0:_.translateY)||Dt!==(_==null?void 0:_.mustDrawFocusOnHeader)||pt!==(_==null?void 0:_.mustDrawHighlightRingsOnHeader))&&At(),te===!0){un(lt!==void 0&&_!==void 0);const{regions:qe}=yd(ke,lt,lt===Le?_.aBufferScroll:_.bBufferScroll,lt===Le?_.bBufferScroll:_.aBufferScroll,_,a,l,c,u,I,r,i,D,ae,ie,d,Ne,A,O);ft=qe}else te!==!1&&(un(_!==void 0),ft=Cd(_,a,l,c,u,r,i,ae,Ne,te));pd(ke,Ne,r,i,I,D,v,Be,f);const kt=Bl(ke,r,i,a,l,c,u,d,h,C,ze,A,I,D,G,f,b,y),Ft=w?Si(ke,r,i,l,c,u,Ne,d,f,ae,M,Be,R,I,Y,L,D):void 0;if(ke.fillStyle=f.bgCell,ft.length>0){ke.beginPath();for(const qe of ft)ke.rect(qe.x,qe.y,qe.width,qe.height);ke.clip(),ke.fill(),ke.beginPath()}else ke.fillRect(0,0,r,i);const Wt=Pl(ke,Ne,d,i,ae,c,u,l,D,Be,R,x,W,H,V,w,I,Y,ft,Fe,M,ne,G,Z,z,ce,se,U,re,f,ve,De,N,P,Et);wd(ke,Ne,d,r,i,ae,c,u,l,D,Be,W,M.rows,H,I,Y,ft,Fe,f),bd(ke,Ne,l,c,u,r,i,ft,ae,Be,W,v,I,D,f),Ll(ke,Ne,l,c,u,r,i,ft,Wt,ze,ae,Be,W,v,I,D,f),kt==null||kt(),Ft==null||Ft(),E&&Ie!=="none"&&ro(Ne,0,c,0,ae,(qe,Nt)=>qe.sourceIndex===K?(Wl(He,Nt+qe.width,0,ae+1,fn(f.resizeIndicatorColor??f.accentLight,f.bgHeader)),Ie==="full"&&Wl(ke,Nt+qe.width,ae,i,fn(f.resizeIndicatorColor??f.accentLight,f.bgCell)),!0):!1),Ke!==null&&(Ke.fillStyle=f.bgCell,Ke.fillRect(0,0,r,i),Ke.drawImage(ke.canvas,0,0));const gn=xd(Ne,i,ae,c,u,l,D,Be,I,Y);Z==null||Z.setWindow({x:a,y:l,width:Ne.length,height:gn-l},h,Array.from({length:I},(qe,Nt)=>D-1-Nt));const en=_!==void 0&&(a!==_.cellXOffset||c!==_.translateX),bt=_!==void 0&&(l!==_.cellYOffset||u!==_.translateY);fe.current={cellXOffset:a,cellYOffset:l,translateX:c,translateY:u,mustDrawFocusOnHeader:Dt,mustDrawHighlightRingsOnHeader:pt,lastBuffer:O?ut===Le?"a":"b":void 0,aBufferScroll:ut===Le?[en,bt]:_==null?void 0:_.aBufferScroll,bBufferScroll:ut===Ye?[en,bt]:_==null?void 0:_.bBufferScroll},ke.restore(),He.restore()}const Sd=80;function Md(e){const t=e-1;return t*t*t+1}class Rd{constructor(t){$e(this,"callback");$e(this,"currentHoveredItem");$e(this,"leavingItems",[]);$e(this,"lastAnimationTime");$e(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>dr(o.item,t.item))||this.leavingItems.push(t)});$e(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>dr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});$e(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});$e(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});$e(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Md(t.hoverAmount)})));$e(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Sd;for(const i of this.leavingItems)i.hoverAmount=wn(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=wn(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});$e(this,"setHovered",t=>{var n;if(!dr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Ed{constructor(t){$e(this,"fn");$e(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Vi(e){return new Ed(e)}const Id=Vi(()=>window.navigator.userAgent.includes("Firefox")),Vr=Vi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Zr=Vi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Hd(e){const t=s.useRef([]),n=s.useRef(0),o=s.useRef(e);o.current=e;const r=s.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const l=t.current.map(Yi);t.current=[],o.current(new $o(l)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return s.useCallback(i=>{t.current.length===0&&r();const a=Cn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const eo="header",kn="group-header",Ur="out-of-bounds";var No;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(No||(No={}));function Hs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Dd=(e,t)=>{if(e.kind===J.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Fd=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:l,headerHeight:c,fillHandle:u=!1,groupHeaderHeight:d,groupLevels:g,groupHeaderHeights:h,rowHeight:m,rows:f,getCellContent:w,getRowThemeOverride:C,onHeaderMenuClick:k,onHeaderIndicatorClick:b,enableGroups:y,isFilling:H,onCanvasFocused:A,onCanvasBlur:v,isFocused:P,selection:E,freezeColumns:M,onContextMenu:L,freezeTrailingRows:I,fixedShadowX:D=!0,fixedShadowY:R=!0,drawFocusRing:x,onMouseDown:W,onMouseUp:V,onMouseMoveRaw:oe,onMouseMove:ne,onItemHovered:U,dragAndDropState:G,firstColAccessible:K,onKeyDown:Z,onKeyUp:fe,highlightRegions:ce,canvasRef:re,onDragStart:se,onDragEnd:z,eventTargetRef:X,isResizing:Y,resizeColumn:Q,isDragging:ve,isDraggable:De=!1,allowResize:N,disabledRows:ee,hasAppendRow:we,getGroupDetails:Ve,theme:Fe,prelightCells:Et,headerIcons:Ie,verticalBorder:O,drawCell:ie,drawHeader:te,onCellFocused:pe,onDragOverCell:Ee,onDrop:ze,onDragLeave:ae,imageWindowLoader:ge,smoothScrollX:Le=!1,smoothScrollY:Ye=!1,experimental:_,getCellRenderer:Ke,resizeIndicator:He="full"}=e,ke=e.translateX??0,ut=e.translateY??0,lt=Math.max(M,Math.min(i.length-1,a)),Be=s.useRef(null),Ne=s.useRef((_==null?void 0:_.eventTarget)??window),ft=Ne.current,Dt=ge,pt=s.useRef(),[At,kt]=s.useState(!1),Ft=s.useRef([]),Wt=s.useRef(),[gn,en]=s.useState(),[bt,mn]=s.useState(),qe=s.useRef(null),[Nt,tn]=s.useState(),[nn,pn]=s.useState(!1),Dn=s.useRef(nn);Dn.current=nn;const he=s.useMemo(()=>new od(Ie,()=>{So.current=void 0,lo.current()}),[Ie]),Ze=y?h.reduce((B,j)=>B+j,0):0,Je=c+Ze,Gt=s.useRef(-1),Xt=((_==null?void 0:_.enableFirefoxRescaling)??!1)&&Id.value,st=((_==null?void 0:_.enableSafariRescaling)??!1)&&Vr.value;s.useLayoutEffect(()=>{window.devicePixelRatio===1||!Xt&&!st||(Gt.current!==-1&&kt(!0),window.clearTimeout(Gt.current),Gt.current=window.setTimeout(()=>{kt(!1),Gt.current=-1},200))},[l,lt,ke,ut,Xt,st]);const vt=ac(i,M),_o=s.useMemo(()=>D?Ko(vt,G):0,[vt,G,D]),xt=s.useCallback((B,j,Se)=>{const xe=B.getBoundingClientRect();if(j>=vt.length||Se>=f)return;const de=xe.width/n,ye=Ai(j,Se,n,o,d,Je,lt,l,ke,ut,f,M,I,vt,m,g,h);return de!==1&&(ye.x*=de,ye.y*=de,ye.width*=de,ye.height*=de),ye.x+=xe.x,ye.y+=xe.y,ye},[n,o,d,Je,lt,l,ke,ut,f,M,I,vt,m,g,h]),St=s.useCallback((B,j,Se,xe)=>{const de=B.getBoundingClientRect(),ye=de.width/n,Te=(j-de.left)/ye,Oe=(Se-de.top)/ye,T=5,It=Ti(vt,lt,n,void 0,ke);let Ce=0,je=0;const gt=typeof PointerEvent<"u"&&xe instanceof PointerEvent&&xe.pointerType==="mouse"||typeof MouseEvent<"u"&&xe instanceof MouseEvent,at=typeof PointerEvent<"u"&&xe instanceof PointerEvent&&xe.pointerType==="touch"||typeof TouchEvent<"u"&&xe instanceof TouchEvent;gt&&(Ce=xe.button,je=xe.buttons);const mt=fc(Te,It,ke),Ht=hc(Oe,o,y,c,d,f,m,l,ut,I,g,h),Pt=(xe==null?void 0:xe.shiftKey)===!0,be=(xe==null?void 0:xe.ctrlKey)===!0,$t=(xe==null?void 0:xe.metaKey)===!0,zt=[Te<0?-1:n<Te?1:0,Oe<Je?-1:o<Oe?1:0];let xn;if(mt===-1||Oe<0||Te<0||Ht===void 0||Te>n||Oe>o){const ct=Te>n?1:Te<0?-1:0,sn=Oe>o?1:Oe<0?-1:0;let Ot=ct*2,Pn=sn*2;ct===0&&(Ot=mt===-1?No.EndPadding:No.Center),sn===0&&(Pn=Ht===void 0?No.EndPadding:No.Center);let an=!1;if(mt===-1&&Ht===-1){const Yn=xt(B,vt.length-1,-1);un(Yn!==void 0),an=j<Yn.x+Yn.width+T}const fo=Te>n&&Te<n+Di()||Oe>o&&Oe<o+Di();xn={kind:Ur,location:[mt!==-1?mt:Te<0?0:vt.length-1,Ht??f-1],region:[Ot,Pn],shiftKey:Pt,ctrlKey:be,metaKey:$t,isEdge:an,isTouch:at,button:Ce,buttons:je,scrollEdge:zt,isMaybeScrollbar:fo}}else if(Ht<=-1){let ct=xt(B,mt,Ht);un(ct!==void 0);let sn=ct!==void 0&&ct.x+ct.width-j<=T;const Ot=y&&Ht<=-2,Pn=Ot?-(Ht+2):void 0,an=mt-1;j-ct.x<=T&&an>=0?(sn=!0,ct=xt(B,an,Ht),un(ct!==void 0),xn={kind:Ot?kn:eo,location:[an,Ht],bounds:ct,group:Co(vt[an].group,Pn),isEdge:sn,shiftKey:Pt,ctrlKey:be,metaKey:$t,isTouch:at,localEventX:j-ct.x,localEventY:Se-ct.y,button:Ce,buttons:je,scrollEdge:zt}):xn={kind:Ot?kn:eo,group:Co(vt[mt].group,Pn),location:[mt,Ht],bounds:ct,isEdge:sn,shiftKey:Pt,ctrlKey:be,metaKey:$t,isTouch:at,localEventX:j-ct.x,localEventY:Se-ct.y,button:Ce,buttons:je,scrollEdge:zt}}else{const ct=xt(B,mt,Ht);un(ct!==void 0);const sn=ct!==void 0&&ct.x+ct.width-j<T;let Ot=!1;if(u!==!1&&u!==void 0&&E.current!==void 0){const an=typeof u=="object"?{...Kr,...u}:Kr,fo=an.size,Yn=fo/2,Cr=fs(E.current.range),_n=xt(B,Cr[0],Cr[1]);if(_n!==void 0){const Lt=_n.x+_n.width+an.offsetX-Yn+.5,qt=_n.y+_n.height+an.offsetY-Yn+.5;Ot=Math.abs(Lt-j)<fo&&Math.abs(qt-Se)<fo}}xn={kind:"cell",location:[mt,Ht],bounds:ct,isEdge:sn,shiftKey:Pt,ctrlKey:be,isFillHandle:Ot,metaKey:$t,isTouch:at,localEventX:j-ct.x,localEventY:Se-ct.y,button:Ce,buttons:je,scrollEdge:zt}}return xn},[n,vt,lt,ke,o,y,c,d,f,m,l,ut,I,xt,u,E,Je,g,h]),[on]=gn??[],io=s.useRef(()=>{}),On=s.useRef(gn);On.current=gn;const[ht,Fn]=s.useMemo(()=>{const B=document.createElement("canvas"),j=document.createElement("canvas");return B.style.display="none",B.style.opacity="0",B.style.position="fixed",j.style.display="none",j.style.opacity="0",j.style.position="fixed",[B.getContext("2d",{alpha:!1}),j.getContext("2d",{alpha:!1})]},[]);s.useLayoutEffect(()=>{if(!(ht===null||Fn===null))return document.documentElement.append(ht.canvas),document.documentElement.append(Fn.canvas),()=>{ht.canvas.remove(),Fn.canvas.remove()}},[ht,Fn]);const xo=s.useMemo(()=>new vc,[]),gr=Xt&&At?1:st&&At?2:5,mr=(_==null?void 0:_.disableMinimumCellWidth)===!0?1:10,So=s.useRef(),Mo=s.useRef(null),Ro=s.useRef(null),vn=s.useCallback(()=>{var Te;const B=Be.current,j=qe.current;if(B===null||j===null||(Mo.current===null&&(Mo.current=B.getContext("2d",{alpha:!1}),B.width=0,B.height=0),Ro.current===null&&(Ro.current=j.getContext("2d",{alpha:!1}),j.width=0,j.height=0),Mo.current===null||Ro.current===null||ht===null||Fn===null))return;let Se=!1;const xe=Oe=>{Se=!0,tn(Oe)},de=So.current,ye={headerCanvasCtx:Ro.current,canvasCtx:Mo.current,bufferACtx:ht,bufferBCtx:Fn,width:n,height:o,cellXOffset:lt,cellYOffset:l,translateX:Math.round(ke),translateY:Math.round(ut),mappedColumns:vt,enableGroups:y,freezeColumns:M,dragAndDropState:G,theme:Fe,headerHeight:c,groupHeaderHeight:d,groupLevels:g,groupHeaderHeights:h,disabledRows:ee??nt.empty(),rowHeight:m,verticalBorder:O,isResizing:Y,resizeCol:Q,isFocused:P,selection:E,fillHandle:u,drawCellCallback:ie,hasAppendRow:we,overrideCursor:xe,maxScaleFactor:gr,freezeTrailingRows:I,rows:f,drawFocus:x,getCellContent:w,getGroupDetails:Ve??(Oe=>({name:Oe})),getRowThemeOverride:C,drawHeaderCallback:te,prelightCells:Et,highlightRegions:ce,imageLoader:Dt,lastBlitData:Wt,damage:pt.current,hoverValues:Ft.current,hoverInfo:On.current,spriteManager:he,scrolling:At,hyperWrapping:(_==null?void 0:_.hyperWrapping)??!1,touchMode:nn,enqueue:io.current,renderStateProvider:xo,renderStrategy:(_==null?void 0:_.renderStrategy)??(Vr.value?"double-buffer":"single-buffer"),getCellRenderer:Ke,minimumCellWidth:mr,resizeIndicator:He};ye.damage===void 0?(So.current=ye,Ol(ye,de)):Ol(ye,void 0),!Se&&(ye.damage===void 0||ye.damage.has((Te=On==null?void 0:On.current)==null?void 0:Te[0]))&&tn(void 0)},[ht,Fn,n,o,lt,l,ke,ut,vt,y,M,G,Fe,c,d,g,h,ee,m,O,Y,we,Q,P,E,u,I,f,x,gr,w,Ve,C,ie,te,Et,ce,Dt,he,At,_==null?void 0:_.hyperWrapping,_==null?void 0:_.renderStrategy,nn,xo,Ke,mr,He]),lo=s.useRef(vn);s.useLayoutEffect(()=>{vn(),lo.current=vn},[vn]),s.useLayoutEffect(()=>{(async()=>{var j;((j=document==null?void 0:document.fonts)==null?void 0:j.ready)!==void 0&&(await document.fonts.ready,So.current=void 0,lo.current())})()},[]);const Nn=s.useCallback(B=>{pt.current=B,lo.current(),pt.current=void 0},[]),Jr=Hd(Nn);io.current=Jr;const wr=s.useCallback(B=>{Nn(new $o(B.map(j=>j.cell)))},[Nn]);Dt.setCallback(Nn);const[Qr,ei]=s.useState(!1),[Tn,$n]=on??[],ti=Tn!==void 0&&$n===-1&&Tn>=0&&Tn<vt.length&&vt[Tn].headerRowMarkerDisabled!==!0,ni=Tn!==void 0&&$n===-2;let Vo=!1,pr=!1,Eo=Nt;if(Eo===void 0&&Tn!==void 0&&$n!==void 0&&$n>-1&&$n<f){const B=w([Tn,$n],!0);Vo=B.kind===Bt.NewRow||B.kind===Bt.Marker&&B.markerKind!=="number",pr=B.kind===J.Boolean&&Wi(B),Eo=B.cursor}const Io=ve?"grabbing":(bt??!1)||Y?"col-resize":Qr||H?"crosshair":Eo!==void 0?Eo:ti||Vo||pr||ni?"pointer":"default",Uo=s.useMemo(()=>({contain:"strict",display:"block",cursor:Io}),[Io]),qo=s.useRef("default"),Ho=X==null?void 0:X.current;Ho!=null&&qo.current!==Uo.cursor&&(Ho.style.cursor=qo.current=Uo.cursor);const An=s.useCallback((B,j,Se,xe)=>{if(Ve===void 0)return;const de=Ve(B);if(de.actions!==void 0){const ye=_i(j,de.actions);for(const[Te,Oe]of ye.entries())if(to(Oe,Se+j.x,xe+Oe.y))return de.actions[Te]}},[Ve]),bn=s.useCallback((B,j,Se,xe)=>{const de=vt[j];if(!ve&&!Y&&!(bt??!1)){const ye=xt(B,j,-1);un(ye!==void 0);const Te=Rs(void 0,de,ye.x,ye.y,ye.width,ye.height,Fe,Ni(de.title)==="rtl");if(de.hasMenu===!0&&Te.menuBounds!==void 0&&to(Te.menuBounds,Se,xe))return{area:"menu",bounds:Te.menuBounds};if(de.indicatorIcon!==void 0&&Te.indicatorIconBounds!==void 0&&to(Te.indicatorIconBounds,Se,xe))return{area:"indicator",bounds:Te.indicatorIconBounds}}},[vt,xt,bt,ve,Y,Fe]),Gn=s.useRef(0),Xn=s.useRef(),Pe=s.useRef(!1),oi=s.useCallback(B=>{const j=Be.current,Se=X==null?void 0:X.current;if(j===null||B.target!==j&&B.target!==Se)return;Pe.current=!0;const xe=B.clientX,de=B.clientY;if(B.target===Se&&Se!==null){const Te=Se.getBoundingClientRect();if(xe>Te.right||de>Te.bottom)return}const ye=St(j,xe,de,B);Xn.current=ye.location,ye.isTouch&&(Gn.current=Date.now()),Dn.current!==ye.isTouch&&pn(ye.isTouch),!(ye.kind===eo&&bn(j,ye.location[0],xe,de)!==void 0)&&(ye.kind===kn&&An(ye.group,ye.bounds,ye.localEventX,ye.localEventY)!==void 0||(W==null||W(ye),!ye.isTouch&&De!==!0&&De!==ye.kind&&ye.button<3&&ye.button!==1&&B.preventDefault()))},[X,De,St,An,bn,W]);Yt("pointerdown",oi,ft,!1);const so=s.useRef(0),Vt=s.useCallback(B=>{var je,gt;const j=so.current;so.current=Date.now();const Se=Be.current;if(Pe.current=!1,V===void 0||Se===null)return;const xe=X==null?void 0:X.current,de=B.target!==Se&&B.target!==xe,ye=B.clientX,Te=B.clientY,Oe=B.pointerType==="mouse"?B.button<3:!0;let T=St(Se,ye,Te,B);T.isTouch&&Gn.current!==0&&Date.now()-Gn.current>500&&(T={...T,isLongTouch:!0}),j!==0&&Date.now()-j<(T.isTouch?1e3:500)&&(T={...T,isDoubleClick:!0}),Dn.current!==T.isTouch&&pn(T.isTouch),!de&&B.cancelable&&Oe&&B.preventDefault();const[It]=T.location,Ce=bn(Se,It,ye,Te);if(T.kind===eo&&Ce!==void 0){(T.button!==0||((je=Xn.current)==null?void 0:je[0])!==It||((gt=Xn.current)==null?void 0:gt[1])!==-1)&&V(T,!0);return}else if(T.kind===kn){const at=An(T.group,T.bounds,T.localEventX,T.localEventY);if(at!==void 0){T.button===0&&at.onClick(T);return}}V(T,de)},[V,X,St,bn,An]);Yt("pointerup",Vt,ft,!1);const rn=s.useCallback(B=>{var It,Ce;const j=Be.current;if(j===null)return;const Se=X==null?void 0:X.current,xe=B.target!==j&&B.target!==Se;let de,ye,Te=!0;B instanceof MouseEvent?(de=B.clientX,ye=B.clientY,Te=B.button<3):(de=B.changedTouches[0].clientX,ye=B.changedTouches[0].clientY);const Oe=St(j,de,ye,B);Dn.current!==Oe.isTouch&&pn(Oe.isTouch),!xe&&B.cancelable&&Te&&B.preventDefault();const[T]=Oe.location;if(Oe.kind===eo){const je=bn(j,T,de,ye);je!==void 0&&Oe.button===0&&((It=Xn.current)==null?void 0:It[0])===T&&((Ce=Xn.current)==null?void 0:Ce[1])===-1&&(je.area==="menu"?k==null||k(T,je.bounds):je.area==="indicator"&&(b==null||b(T,je.bounds)))}},[X,St,bn,k,b]);Yt("click",rn,ft,!1);const ri=s.useCallback(B=>{const j=Be.current,Se=X==null?void 0:X.current;if(j===null||B.target!==j&&B.target!==Se||L===void 0)return;const xe=St(j,B.clientX,B.clientY,B);L(xe,()=>{B.cancelable&&B.preventDefault()})},[X,St,L]);Yt("contextmenu",ri,(X==null?void 0:X.current)??null,!1);const Do=s.useCallback(B=>{pt.current=new $o(B.map(j=>j.item)),Ft.current=B,lo.current(),pt.current=void 0},[]),Fo=s.useMemo(()=>new Rd(Do),[Do]),To=s.useRef(Fo);To.current=Fo,s.useLayoutEffect(()=>{const B=To.current;if(on===void 0||on[1]<0){B.setHovered(on);return}const j=w(on,!0),Se=Ke(j),xe=Se===void 0&&j.kind===J.Custom||(Se==null?void 0:Se.needsHover)!==void 0&&(typeof Se.needsHover=="boolean"?Se.needsHover:Se.needsHover(j));B.setHovered(xe?on:void 0)},[w,Ke,on]);const jo=s.useRef(),Ao=s.useCallback(B=>{var Oe;const j=Be.current;if(j===null)return;const Se=X==null?void 0:X.current,xe=B.target!==j&&B.target!==Se,de=St(j,B.clientX,B.clientY,B);if(de.kind!=="out-of-bounds"&&xe&&!Pe.current&&!de.isTouch)return;const ye=(T,It)=>{en(Ce=>Ce===T||(Ce==null?void 0:Ce[0][0])===(T==null?void 0:T[0][0])&&(Ce==null?void 0:Ce[0][1])===(T==null?void 0:T[0][1])&&((Ce==null?void 0:Ce[1][0])===(T==null?void 0:T[1][0])&&(Ce==null?void 0:Ce[1][1])===(T==null?void 0:T[1][1])||!It)?Ce:T)};if(!Hs(de,jo.current))tn(void 0),U==null||U(de),ye(de.kind===Ur?void 0:[de.location,[de.localEventX,de.localEventY]],!0),jo.current=de;else if(de.kind==="cell"||de.kind===eo||de.kind===kn){let T=!1,It=!0;if(de.kind==="cell"){const je=w(de.location);It=((Oe=Ke(je))==null?void 0:Oe.needsHoverPosition)??je.kind===J.Custom,T=It}else T=!0;const Ce=[de.location,[de.localEventX,de.localEventY]];ye(Ce,It),On.current=Ce,T&&Nn(new $o([de.location]))}const Te=de.location[0]>=(K?0:1);mn(de.kind===eo&&de.isEdge&&Te&&N===!0),ei(de.kind==="cell"&&de.isFillHandle),oe==null||oe(B),ne(de)},[X,St,K,N,oe,ne,U,w,Ke,Nn]);Yt("pointermove",Ao,ft,!0);const Kn=s.useCallback(B=>{const j=Be.current;if(j===null)return;let Se,xe;E.current!==void 0&&(Se=xt(j,E.current.cell[0],E.current.cell[1]),xe=E.current.cell),Z==null||Z({bounds:Se,stopPropagation:()=>B.stopPropagation(),preventDefault:()=>B.preventDefault(),cancel:()=>{},ctrlKey:B.ctrlKey,metaKey:B.metaKey,shiftKey:B.shiftKey,altKey:B.altKey,key:B.key,keyCode:B.keyCode,rawEvent:B,location:xe})},[Z,E,xt]),ii=s.useCallback(B=>{const j=Be.current;if(j===null)return;let Se,xe;E.current!==void 0&&(Se=xt(j,E.current.cell[0],E.current.cell[1]),xe=E.current.cell),fe==null||fe({bounds:Se,stopPropagation:()=>B.stopPropagation(),preventDefault:()=>B.preventDefault(),cancel:()=>{},ctrlKey:B.ctrlKey,metaKey:B.metaKey,shiftKey:B.shiftKey,altKey:B.altKey,key:B.key,keyCode:B.keyCode,rawEvent:B,location:xe})},[fe,E,xt]),Zo=s.useCallback(B=>{if(Be.current=B,re!==void 0&&(re.current=B),_!=null&&_.eventTarget)Ne.current=_.eventTarget;else if(B===null)Ne.current=window;else{const j=B.getRootNode();j===document&&(Ne.current=window),Ne.current=j}},[re,_==null?void 0:_.eventTarget]),Po=s.useCallback(B=>{const j=Be.current;if(j===null||De===!1||Y){B.preventDefault();return}let Se,xe;const de=St(j,B.clientX,B.clientY);if(De!==!0&&de.kind!==De){B.preventDefault();return}const ye=(je,gt)=>{Se=je,xe=gt};let Te,Oe,T;const It=(je,gt,at)=>{Te=je,Oe=gt,T=at};let Ce=!1;if(se==null||se({...de,setData:ye,setDragImage:It,preventDefault:()=>Ce=!0,defaultPrevented:()=>Ce}),!Ce&&Se!==void 0&&xe!==void 0&&B.dataTransfer!==null)if(B.dataTransfer.setData(Se,xe),B.dataTransfer.effectAllowed="copyLink",Te!==void 0&&Oe!==void 0&&T!==void 0)B.dataTransfer.setDragImage(Te,Oe,T);else{const[je,gt]=de.location;if(gt!==void 0){const at=document.createElement("canvas"),mt=xt(j,je,gt);un(mt!==void 0);const Ht=Math.ceil(window.devicePixelRatio??1);at.width=mt.width*Ht,at.height=mt.height*Ht;const Pt=at.getContext("2d");Pt!==null&&(Pt.scale(Ht,Ht),Pt.textBaseline="middle",gt===-1?(Pt.font=Fe.headerFontFull,Pt.fillStyle=Fe.bgHeader,Pt.fillRect(0,0,at.width,at.height),Es(Pt,0,0,mt.width,mt.height,vt[je],!1,Fe,!1,void 0,void 0,!1,0,he,te,!1)):(Pt.font=Fe.baseFontFull,Pt.fillStyle=Fe.bgCell,Pt.fillRect(0,0,at.width,at.height),Ms(Pt,w([je,gt]),0,gt,!1,!1,0,0,mt.width,mt.height,!1,Fe,Fe.bgCell,Dt,he,1,void 0,!1,0,void 0,void 0,void 0,xo,Ke,()=>{},0))),at.style.left="-100%",at.style.position="absolute",at.style.width=`${mt.width}px`,at.style.height=`${mt.height}px`,document.body.append(at),B.dataTransfer.setDragImage(at,mt.width/2,mt.height/2),window.setTimeout(()=>{at.remove()},0)}}else B.preventDefault()},[De,Y,St,se,xt,Fe,vt,he,te,w,Dt,xo,Ke]);Yt("dragstart",Po,(X==null?void 0:X.current)??null,!1,!1);const Jo=s.useRef(),Qo=s.useCallback(B=>{const j=Be.current;if(ze!==void 0&&B.preventDefault(),j===null||Ee===void 0)return;const Se=St(j,B.clientX,B.clientY),[xe,de]=Se.location,ye=xe-(K?0:1),[Te,Oe]=Jo.current??[];(Te!==ye||Oe!==de)&&(Jo.current=[ye,de],Ee([ye,de],B.dataTransfer))},[K,St,Ee,ze]);Yt("dragover",Qo,(X==null?void 0:X.current)??null,!1,!1);const zo=s.useCallback(()=>{Jo.current=void 0,z==null||z()},[z]);Yt("dragend",zo,(X==null?void 0:X.current)??null,!1,!1);const ao=s.useCallback(B=>{const j=Be.current;if(j===null||ze===void 0)return;B.preventDefault();const Se=St(j,B.clientX,B.clientY),[xe,de]=Se.location,ye=xe-(K?0:1);ze([ye,de],B.dataTransfer)},[K,St,ze]);Yt("drop",ao,(X==null?void 0:X.current)??null,!1,!1);const er=s.useCallback(()=>{ae==null||ae()},[ae]);Yt("dragleave",er,(X==null?void 0:X.current)??null,!1,!1);const br=s.useRef(E);br.current=E;const co=s.useRef(null),_e=s.useCallback(B=>{var j;Be.current===null||!Be.current.contains(document.activeElement)||(B===null&&br.current.current!==void 0?(j=re==null?void 0:re.current)==null||j.focus({preventScroll:!0}):B!==null&&B.focus({preventScroll:!0}),co.current=B)},[re]);s.useImperativeHandle(t,()=>({focus:()=>{var j;const B=co.current;B===null||!document.contains(B)?(j=re==null?void 0:re.current)==null||j.focus({preventScroll:!0}):B.focus({preventScroll:!0})},getBounds:(B,j)=>{if(!(re===void 0||re.current===null))return xt(re.current,B??0,j??-1)},damage:wr,getMouseArgsForPosition:(B,j,Se)=>{if(!(re===void 0||re.current===null))return St(re.current,B,j,Se)}}),[re,wr,xt,St]);const uo=s.useRef(),li=Wa(()=>{var Oe,T,It;if(n<50||(_==null?void 0:_.disableAccessibilityTree)===!0)return null;let B=Ti(vt,lt,n,G,ke);const j=K?0:-1;!K&&((Oe=B[0])==null?void 0:Oe.sourceIndex)===0&&(B=B.slice(1));const[Se,xe]=((T=E.current)==null?void 0:T.cell)??[],de=(It=E.current)==null?void 0:It.range,ye=B.map(Ce=>Ce.sourceIndex),Te=bo(l,Math.min(f,l+r));return Se!==void 0&&xe!==void 0&&!(ye.includes(Se)&&Te.includes(xe))&&_e(null),s.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":f+1,"aria-multiselectable":"true","aria-colcount":vt.length+j},s.createElement("thead",{role:"rowgroup"},s.createElement("tr",{role:"row","aria-rowindex":1},B.map(Ce=>s.createElement("th",{role:"columnheader","aria-selected":E.columns.hasIndex(Ce.sourceIndex),"aria-colindex":Ce.sourceIndex+1+j,tabIndex:-1,onFocus:je=>{if(je.target!==co.current)return pe==null?void 0:pe([Ce.sourceIndex,-1])},key:Ce.sourceIndex},Ce.title)))),s.createElement("tbody",{role:"rowgroup"},Te.map(Ce=>s.createElement("tr",{role:"row","aria-selected":E.rows.hasIndex(Ce),key:Ce,"aria-rowindex":Ce+2},B.map(je=>{const gt=je.sourceIndex,at=Cn(gt,Ce),mt=Se===gt&&xe===Ce,Ht=de!==void 0&&gt>=de.x&&gt<de.x+de.width&&Ce>=de.y&&Ce<de.y+de.height,Pt=`glide-cell-${gt}-${Ce}`,be=[gt,Ce],$t=w(be,!0);return s.createElement("td",{key:at,role:"gridcell","aria-colindex":gt+1+j,"aria-selected":Ht,"aria-readonly":yo($t)||!no($t),id:Pt,"data-testid":Pt,onClick:()=>{const zt=re==null?void 0:re.current;if(zt!=null)return Z==null?void 0:Z({bounds:xt(zt,gt,Ce),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:be})},onFocusCapture:zt=>{var xn,ct;if(!(zt.target===co.current||((xn=uo.current)==null?void 0:xn[0])===gt&&((ct=uo.current)==null?void 0:ct[1])===Ce))return uo.current=be,pe==null?void 0:pe(be)},ref:mt?_e:void 0,tabIndex:-1},Dd($t,Ke))})))))},[n,vt,lt,G,ke,f,l,r,E,_e,w,re,Z,xt,pe],200),Ut=M===0||!D?0:lt>M?1:wn(-ke/100,0,1),si=-l*32+ut,ln=R?wn(-si/100,0,1):0,yr=s.useMemo(()=>{if(!Ut&&!ln)return null;const B={position:"absolute",top:0,left:_o,width:n-_o,height:o,opacity:Ut,pointerEvents:"none",transition:Le?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},j={position:"absolute",top:Je,left:0,width:n,height:o,opacity:ln,pointerEvents:"none",transition:Ye?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return s.createElement(s.Fragment,null,Ut>0&&s.createElement("div",{id:"shadow-x",style:B}),ln>0&&s.createElement("div",{id:"shadow-y",style:j}))},[Ut,ln,_o,n,Le,Je,o,Ye]),tr=s.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return s.createElement(s.Fragment,null,s.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:-1,onKeyDown:Kn,onKeyUp:ii,onFocus:A,onBlur:v,ref:Zo,style:Uo},li),s.createElement("canvas",{ref:qe,style:tr}),yr)},Td=s.memo(s.forwardRef(Fd));function cr(e,t,n,o){return wn(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const Ad=e=>{const[t,n]=s.useState(),[o,r]=s.useState(),[i,a]=s.useState(),[l,c]=s.useState(),[u,d]=s.useState(!1),[g,h]=s.useState(),[m,f]=s.useState(),[w,C]=s.useState(),[k,b]=s.useState(!1),[y,H]=s.useState(),{onHeaderMenuClick:A,onHeaderIndicatorClick:v,getCellContent:P,onColumnMoved:E,onColumnResize:M,onColumnResizeStart:L,onColumnResizeEnd:I,gridRef:D,maxColumnWidth:R,minColumnWidth:x,onRowMoved:W,lockColumns:V,onColumnProposeMove:oe,onMouseDown:ne,onMouseUp:U,onItemHovered:G,onDragStart:K,canvasRef:Z}=e,fe=(M??I??L)!==void 0,{columns:ce,selection:re}=e,se=re.columns,z=s.useCallback(Ie=>{const[O,ie]=Ie.location;i!==void 0&&l!==O&&O>=V?(d(!0),c(O)):m!==void 0&&ie!==void 0?(b(!0),C(Math.max(0,ie))):o===void 0&&!u&&!k&&(G==null||G(Ie))},[i,m,l,G,V,o,u,k]),X=E!==void 0,Y=s.useCallback(Ie=>{var O;if(Ie.button===0){const[ie,te]=Ie.location;if(Ie.kind==="out-of-bounds"&&Ie.isEdge&&fe){const pe=(O=D==null?void 0:D.current)==null?void 0:O.getBounds(ce.length-1,-1);pe!==void 0&&(n(pe.x),r(ce.length-1))}else if(Ie.kind==="header"&&ie>=V){const pe=Z==null?void 0:Z.current;if(Ie.isEdge&&fe&&pe){n(Ie.bounds.x),r(ie);const ze=pe.getBoundingClientRect().width/pe.offsetWidth,ae=Ie.bounds.width/ze;L==null||L(ce[ie],ae,ie,ae+(ce[ie].growOffset??0))}else Ie.kind==="header"&&X&&(h(Ie.bounds.x),a(ie))}else Ie.kind==="cell"&&V>0&&ie===0&&te!==void 0&&W!==void 0&&(H(Ie.bounds.y),f(te))}ne==null||ne(Ie)},[ne,fe,V,W,D,ce,X,L,Z]),Q=s.useCallback((Ie,O)=>{u||k||A==null||A(Ie,O)},[u,k,A]),ve=s.useCallback((Ie,O)=>{u||k||v==null||v(Ie,O)},[u,k,v]),De=s.useRef(-1),N=s.useCallback(()=>{De.current=-1,f(void 0),C(void 0),H(void 0),b(!1),a(void 0),c(void 0),h(void 0),d(!1),r(void 0),n(void 0)},[]),ee=s.useCallback((Ie,O)=>{if(Ie.button===0){if(o!==void 0){if((se==null?void 0:se.hasIndex(o))===!0)for(const te of se){if(te===o)continue;const pe=ce[te],Ee=cr(pe,De.current,x,R);M==null||M(pe,Ee,te,Ee+(pe.growOffset??0))}const ie=cr(ce[o],De.current,x,R);if(I==null||I(ce[o],ie,o,ie+(ce[o].growOffset??0)),se.hasIndex(o))for(const te of se){if(te===o)continue;const pe=ce[te],Ee=cr(pe,De.current,x,R);I==null||I(pe,Ee,te,Ee+(pe.growOffset??0))}}N(),i!==void 0&&l!==void 0&&(oe==null?void 0:oe(i,l))!==!1&&(E==null||E(i,l)),m!==void 0&&w!==void 0&&(W==null||W(m,w))}U==null||U(Ie,O)},[U,o,i,l,m,w,se,I,ce,x,R,M,E,W,N,oe]),we=s.useMemo(()=>{if(!(i===void 0||l===void 0)&&i!==l&&(oe==null?void 0:oe(i,l))!==!1)return{src:i,dest:l}},[i,l,oe]),Ve=s.useCallback(Ie=>{const O=Z==null?void 0:Z.current;if(i!==void 0&&g!==void 0)Math.abs(Ie.clientX-g)>20&&d(!0);else if(m!==void 0&&y!==void 0)Math.abs(Ie.clientY-y)>20&&b(!0);else if(o!==void 0&&t!==void 0&&O){const te=O.getBoundingClientRect().width/O.offsetWidth,pe=(Ie.clientX-t)/te,Ee=ce[o],ze=cr(Ee,pe,x,R);if(M==null||M(Ee,ze,o,ze+(Ee.growOffset??0)),De.current=pe,(se==null?void 0:se.first())===o)for(const ae of se){if(ae===o)continue;const ge=ce[ae],Le=cr(ge,De.current,x,R);M==null||M(ge,Le,ae,Le+(ge.growOffset??0))}}},[i,g,m,y,o,t,ce,x,R,M,se,Z]),Fe=s.useCallback((Ie,O)=>{if(m===void 0||w===void 0)return P(Ie,O);let[ie,te]=Ie;return te===w?te=m:(te>w&&(te-=1),te>=m&&(te+=1)),P([ie,te],O)},[m,w,P]),Et=s.useCallback(Ie=>{K==null||K(Ie),Ie.defaultPrevented()||N()},[N,K]);return s.createElement(Td,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:Fe,isResizing:o!==void 0,onHeaderMenuClick:Q,onHeaderIndicatorClick:ve,isDragging:u,onItemHovered:z,onDragStart:Et,onMouseDown:Y,allowResize:fe,onMouseUp:ee,dragAndDropState:we,onMouseMoveRaw:Ve,ref:D})};function Pd(e){const t=s.useRef(null),[n,o]=s.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return s.useLayoutEffect(()=>{const r=a=>{for(const l of a){const{width:c,height:u}=l&&l.contentRect||{};o(d=>d.width===c&&d.height===u?d:{width:c,height:u})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const zd=(e,t,n)=>{const o=s.useRef(null),r=s.useRef(null),i=s.useRef(null),a=s.useRef(0),l=s.useRef(t);l.current=t;const c=n.current;s.useEffect(()=>{const u=()=>{var h,m;if(r.current===!1&&c!==null){const f=[c.scrollLeft,c.scrollTop];if(((h=i.current)==null?void 0:h[0])===f[0]&&((m=i.current)==null?void 0:m[1])===f[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,l.current(f[0],f[1]),i.current=f;o.current=window.setTimeout(u,8.333333333333334)}},d=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},g=h=>{h.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(u,8.333333333333334))};if(e&&c!==null){const h=c;return h.addEventListener("touchstart",d),h.addEventListener("touchend",g),()=>{h.removeEventListener("touchstart",d),h.removeEventListener("touchend",g),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Ld=()=>e=>e.isSafari?"scroll":"auto",Bd=_t("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Ld()]}}),Wd=33554400,Od=5e6;function Nd(e){const[t,n]=s.useState(!1),o=typeof window>"u"?null:window,r=s.useRef(0);return Yt("touchstart",s.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Yt("touchend",s.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const $d=e=>{var re,se;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:l,preventDiagonalScrolling:c=!1,paddingBottom:u=0,paddingRight:d=0,rightElement:g,rightElementProps:h,kineticScrollPerfHack:m=!1,scrollRef:f,initialSize:w}=e,C=[],k=(h==null?void 0:h.sticky)??!1,b=(h==null?void 0:h.fill)??!1,y=s.useRef(0),H=s.useRef(0),A=s.useRef(null),v=typeof window>"u"?1:window.devicePixelRatio,P=s.useRef(v);s.useEffect(()=>{if(P.current!==v){y.current=0,H.current=0,P.current=v;const z=A.current;z!==null&&W.current(z.scrollLeft,z.scrollTop)}},[v]);const E=s.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),M=s.useRef(null),L=Nd(200),[I,D]=s.useState(!0),R=s.useRef(0);s.useLayoutEffect(()=>{if(!I||L||E.current.lockDirection===void 0)return;const z=A.current;if(z===null)return;const[X,Y]=E.current.lockDirection;X!==void 0?z.scrollLeft=X:Y!==void 0&&(z.scrollTop=Y),E.current.lockDirection=void 0},[L,I]);const x=s.useCallback((z,X)=>{var ie;const Y=A.current;if(Y===null)return;X=X??Y.scrollTop,z=z??Y.scrollLeft;const Q=E.current.scrollTop,ve=E.current.scrollLeft,De=z-ve,N=X-Q;L&&De!==0&&N!==0&&(Math.abs(De)>3||Math.abs(N)>3)&&c&&E.current.lockDirection===void 0&&(E.current.lockDirection=Math.abs(De)<Math.abs(N)?[ve,void 0]:[void 0,Q]);const ee=E.current.lockDirection;z=(ee==null?void 0:ee[0])??z,X=(ee==null?void 0:ee[1])??X,E.current.scrollLeft=z,E.current.scrollTop=X;const we=Y.clientWidth,Ve=Y.clientHeight,Fe=X,Et=H.current-Fe,Ie=Y.scrollHeight-Ve;H.current=Fe;let O;if(Ie>0&&o>Y.scrollHeight+5)if(Math.abs(Et)>2e3||Fe===0||Fe===Ie){const te=Math.max(0,Math.min(1,Fe/Ie)),pe=o-Ve;O=te*pe,y.current=O}else y.current-=Et,O=y.current;else O=Fe,y.current=O;O=Math.max(0,Math.min(O,o-Ve)),y.current=O,ee!==void 0&&(window.clearTimeout(R.current),D(!1),R.current=window.setTimeout(()=>D(!0),200)),i({x:z,y:O,width:we-d,height:Ve-u,paddingRight:((ie=M.current)==null?void 0:ie.clientWidth)??0})},[u,d,o,i,c,L]);zd(m&&Vr.value,x,A);const W=s.useRef(x);W.current=x;const V=s.useRef(),oe=s.useRef(!1);s.useLayoutEffect(()=>{oe.current?x():oe.current=!0},[x,u,d]);const ne=s.useCallback(z=>{A.current=z,f!==void 0&&(f.current=z)},[f]);let U=0,G=0;const K=Math.min(o,Wd);for(C.push(s.createElement("div",{key:U++,style:{width:r,height:0}}));G<K;){const z=Math.min(Od,K-G);C.push(s.createElement("div",{key:U++,style:{width:0,height:z}})),G+=z}const{ref:Z,width:fe,height:ce}=Pd(w);return typeof window<"u"&&(((re=V.current)==null?void 0:re.height)!==ce||((se=V.current)==null?void 0:se.width)!==fe)&&(window.setTimeout(()=>W.current(),0),V.current={width:fe,height:ce}),(fe??0)===0||(ce??0)===0?s.createElement("div",{ref:Z}):s.createElement("div",{ref:Z},s.createElement(Bd,{isSafari:Vr.value},s.createElement("div",{className:"dvn-underlay"},t),s.createElement("div",{ref:ne,style:V.current,draggable:a,onDragStart:z=>{a||(z.stopPropagation(),z.preventDefault())},className:"dvn-scroller "+(l??""),onScroll:()=>x()},s.createElement("div",{className:"dvn-scroll-inner"+(g===void 0?" dvn-hidden":"")},s.createElement("div",{className:"dvn-stack"},C),g!==void 0&&s.createElement(s.Fragment,null,!b&&s.createElement("div",{className:"dvn-spacer"}),s.createElement("div",{ref:M,style:{height:ce,maxHeight:n-Math.ceil(v%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:d,flexGrow:b?1:void 0,right:k?d??0:void 0,pointerEvents:"auto"}},g))))))},Gd=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:l,experimental:c,nonGrowWidth:u,clientSize:d,className:g,onVisibleRegionChanged:h,scrollRef:m,preventDiagonalScrolling:f,rightElement:w,rightElementProps:C,overscrollX:k,overscrollY:b,initialSize:y,smoothScrollX:H=!1,smoothScrollY:A=!1,isDraggable:v}=e,{paddingRight:P,paddingBottom:E}=c??{},[M,L]=d,I=s.useRef(),D=s.useRef(),R=s.useRef(),x=s.useRef(),W=u+Math.max(0,k??0);let V=a?r+i:r;if(typeof o=="number")V+=n*o;else for(let G=0;G<n;G++)V+=o(G);b!==void 0&&(V+=b);const oe=s.useRef(),ne=s.useCallback(()=>{var ve,De;if(oe.current===void 0)return;const G={...oe.current};let K=0,Z=G.x<0?-G.x:0,fe=0,ce=0;G.x=G.x<0?0:G.x;let re=0;for(let N=0;N<l;N++)re+=t[N].width;for(const N of t){const ee=K-re;if(G.x>=ee+N.width)K+=N.width,ce++,fe++;else if(G.x>ee)K+=N.width,H?Z+=ee-G.x:ce++,fe++;else if(G.x+G.width>ee)K+=N.width,fe++;else break}let se=0,z=0,X=0;if(typeof o=="number")A?(z=Math.floor(G.y/o),se=z*o-G.y):z=Math.ceil(G.y/o),X=Math.ceil(G.height/o)+z,se<0&&X++;else{let N=0;for(let ee=0;ee<n;ee++){const we=o(ee),Ve=N+(A?0:we/2);if(G.y>=N+we)N+=we,z++,X++;else if(G.y>Ve)N+=we,A?se+=Ve-G.y:z++,X++;else if(G.y+G.height>we/2+N)N+=we,X++;else break}}z=Math.max(0,Math.min(z,n-1)),X=Math.max(z,Math.min(X,n));const Y={x:ce,y:z,width:fe-ce,height:X-z},Q=I.current;(Q===void 0||Q.y!==Y.y||Q.x!==Y.x||Q.height!==Y.height||Q.width!==Y.width||D.current!==Z||R.current!==se||G.width!==((ve=x.current)==null?void 0:ve[0])||G.height!==((De=x.current)==null?void 0:De[1]))&&(h==null||h({x:ce,y:z,width:fe-ce,height:X-z},G.width,G.height,G.paddingRight??0,Z,se),I.current=Y,D.current=Z,R.current=se,x.current=[G.width,G.height])},[t,o,n,h,l,H,A]),U=s.useCallback(G=>{oe.current=G,ne()},[ne]);return s.useEffect(()=>{ne()},[ne]),s.createElement($d,{scrollRef:m,className:g,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:f,draggable:v===!0||typeof v=="string",scrollWidth:W+(P??0),scrollHeight:V+(E??0),clientHeight:L,rightElement:w,paddingBottom:E,paddingRight:P,rightElementProps:C,update:U,initialSize:y},s.createElement(Ad,{eventTargetRef:m,width:M,height:L,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},Xd=_t("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Kd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Yd=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),_d=s.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},s.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Vd=10,Ud=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:l,onSearchValueChange:c,getCellsForSelection:u,onSearchResultsChanged:d,showSearch:g=!1,onSearchClose:h}=e,[m]=s.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[f,w]=s.useState(""),C=a??f,k=s.useCallback(K=>{w(K),c==null||c(K)},[c]),[b,y]=s.useState(),H=s.useRef(b);H.current=b,s.useEffect(()=>{l!==void 0&&(l.length>0?y(K=>({rowsSearched:o,results:l.length,selectedIndex:(K==null?void 0:K.selectedIndex)??-1})):y(void 0))},[o,l]);const A=s.useRef();A.current===void 0&&(A.current=new AbortController);const v=s.useRef(),[P,E]=s.useState([]),M=l??P,L=s.useCallback(()=>{v.current!==void 0&&(window.cancelAnimationFrame(v.current),v.current=void 0),A.current!==void 0&&A.current.abort(),A.current=new AbortController},[]),I=s.useRef(n);I.current=n;const D=s.useCallback(K=>{const Z=new RegExp(K.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let fe=I.current,ce=Math.min(10,o),re=0;y(void 0),E([]);const se=[],z=async()=>{var Fe;if(u===void 0)return;const X=performance.now(),Y=o-re;let Q=u({x:0,y:fe,width:r.length,height:Math.min(ce,Y,o-fe)},A.current.signal);typeof Q=="function"&&(Q=await Q());let ve=!1;for(const[Et,Ie]of Q.entries())for(const[O,ie]of Ie.entries()){let te;switch(ie.kind){case J.Text:case J.Number:te=ie.displayData;break;case J.Uri:case J.Markdown:te=ie.data;break;case J.Boolean:te=typeof ie.data=="boolean"?ie.data.toString():void 0;break;case J.Image:case J.Bubble:te=ie.data.join("🐳");break;case J.Custom:te=ie.copyData;break}te!==void 0&&Z.test(te)&&(se.push([O,Et+fe]),ve=!0)}const De=performance.now();ve&&E([...se]),re+=Q.length,un(re<=o);const N=((Fe=H.current)==null?void 0:Fe.selectedIndex)??-1;y({results:se.length,rowsSearched:re,selectedIndex:N}),d==null||d(se,N),fe+ce>=o?fe=0:fe+=ce;const ee=De-X,we=Math.max(ee,1),Ve=Vd/we;ce=Math.ceil(ce*Ve),re<o&&se.length<1e3&&(v.current=window.requestAnimationFrame(z))};L(),v.current=window.requestAnimationFrame(z)},[L,r.length,u,d,o]),R=s.useCallback(()=>{var K;h==null||h(),y(void 0),E([]),d==null||d([],-1),L(),(K=t==null?void 0:t.current)==null||K.focus()},[L,t,h,d]),x=s.useCallback(K=>{k(K.target.value),l===void 0&&(K.target.value===""?(y(void 0),E([]),L()):D(K.target.value))},[D,L,k,l]);s.useEffect(()=>{i.current!==null&&(k(""),y(void 0),P.length>0&&(E([]),d==null||d([],-1)),g?i.current.focus({preventScroll:!0}):L())},[g,i]);const W=s.useCallback(K=>{var fe;if((fe=K==null?void 0:K.stopPropagation)==null||fe.call(K),b===void 0||b.results===0)return;const Z=(b.selectedIndex+1)%b.results;y({...b,selectedIndex:Z}),d==null||d(M,Z)},[b,d,M]),V=s.useCallback(K=>{var fe;if((fe=K==null?void 0:K.stopPropagation)==null||fe.call(K),b===void 0||b.results===0)return;let Z=(b.selectedIndex-1)%b.results;Z<0&&(Z+=b.results),y({...b,selectedIndex:Z}),d==null||d(M,Z)},[d,M,b]),oe=s.useCallback(K=>{(K.ctrlKey||K.metaKey)&&K.nativeEvent.code==="KeyF"||K.key==="Escape"?(R(),K.stopPropagation(),K.preventDefault()):K.key==="Enter"&&(K.shiftKey?V():W())},[R,W,V]);s.useEffect(()=>()=>{L()},[L]);const[ne,U]=s.useState(!1);s.useEffect(()=>{if(g)U(!0);else{const K=setTimeout(()=>U(!1),150);return()=>clearTimeout(K)}},[g]);const G=s.useMemo(()=>{if(!g&&!ne)return null;let K;b!==void 0&&(K=b.results>=1e3?"over 1000":`${b.results} result${b.results!==1?"s":""}`,b.selectedIndex>=0&&(K=`${b.selectedIndex+1} of ${K}`));const Z=re=>{re.stopPropagation()},ce={width:`${o>0?Math.floor(((b==null?void 0:b.rowsSearched)??0)/o*100):0}%`};return s.createElement(Xd,{className:"gdg-search-bar"+(g?"":" out"),onMouseDown:Z,onMouseMove:Z,onMouseUp:Z,onClick:Z},s.createElement("div",{className:"gdg-search-bar-inner"},s.createElement("input",{id:m,"aria-hidden":!g,"data-testid":"search-input",ref:i,onChange:x,value:C,tabIndex:g?void 0:-1,onKeyDownCapture:oe}),s.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:V,disabled:((b==null?void 0:b.results)??0)===0},Kd),s.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:W,disabled:((b==null?void 0:b.results)??0)===0},Yd),h!==void 0&&s.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!g,"data-testid":"search-close-button",tabIndex:g?void 0:-1,onClick:R},_d)),b!==void 0?s.createElement(s.Fragment,null,s.createElement("div",{className:"gdg-search-status"},s.createElement("div",{"data-testid":"search-result-area"},K)),s.createElement("div",{className:"gdg-search-progress",style:ce})):s.createElement("div",{className:"gdg-search-status"},s.createElement("label",{htmlFor:m},"Type to search")))},[g,ne,b,o,m,i,x,C,oe,V,W,h,R]);return s.createElement(s.Fragment,null,s.createElement(Gd,{prelightCells:M,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),G)},qd=()=>e=>Math.max(16,e.targetHeight-10),jd=_t("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[qd(),"px"]}}),Zd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,l]=Rt.useState(n);return Rt.createElement(ls,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},Rt.createElement(jd,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,a.length),onChange:c=>l(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(a):c.key==="Escape"&&o()},autoFocus:!0}))};function Jd(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function Ge(e,t,n){const o=Ds(e,t);return o&&(n.didMatch=!0),o}function Ds(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const u of c)if(Ds(u,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),l=a.pop();if(!Jd(l,t))return!1;if(a[0]==="any")return!0;for(const c of a)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Zr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function Qd(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case J.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Bi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case J.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case J.Image:case J.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case J.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case J.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case J.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case J.Markdown:case J.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case J.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case J.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case J.Protected:return{formatted:"************",rawValue:"",format:"string"};default:fr()}}function eu(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:Qd(a))})}function Nl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function tu(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>Nl(a,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:Nl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Mi(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function $l(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function nu(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ou(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Mi(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,l)=>`<li gdg-raw-value=${$l(r.rawValue[l])}>`+Mi(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${$l(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Mi(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function ru(e,t){const n=eu(e,t),o=tu(n),r=ou(n);return{textPlain:o,textHtml:r}}function Gl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const l=o.pop();if(l===void 0)break;if(l instanceof HTMLTableElement||l.nodeName==="TBODY")o.push(...[...l.children].reverse());else if(l instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...l.children].reverse());else if(l instanceof HTMLTableCellElement){const c=l.cloneNode(!0),d=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,g=(d==null?void 0:d.children.length)===1&&d.children[0].nodeName==="FONT",h=c.querySelectorAll("br");for(const w of h)w.replaceWith(`
`);const m=c.getAttribute("gdg-raw-value"),f=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((a=c.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:c.textContent??"",format:f});else if(c.querySelector("ol")!==null){const w=c.querySelectorAll("li");i==null||i.push({rawValue:[...w].map(C=>C.getAttribute("gdg-raw-value")??""),formatted:[...w].map(C=>C.textContent??""),format:"string-array"})}else if(m!==null)i==null||i.push({rawValue:nu(m),formatted:c.textContent??"",format:f});else{let w=c.textContent??"";g&&(w=w.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:w??"",formatted:w??"",format:f})}}}return i!==void 0&&r.push(i),r}function iu(e,t,n,o,r){var l;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(l=e.current)==null?void 0:l.range,u=[];if(c.width>2){const h=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof h=="function")return i;u.push(...h);const m=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof m=="function")return i;u.push(...m)}else{const h=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof h=="function")return i;u.push(...h)}let d=c.x-n,g=c.x+c.width-1-n;for(const h of u)for(const m of h)m.span!==void 0&&(d=Math.min(m.span[0],d),g=Math.max(m.span[1],g));d===c.x-n&&g===c.x+c.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:d+n,y:c.y,width:g-d+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function Xl(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function lu(e){let t;(function(l){l[l.None=0]="None",l[l.inString=1]="inString",l[l.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const l of e){switch(i){case t.None:l==="	"||l===`
`?(o.push(e.slice(r,a)),r=a+1,l===`
`&&(n.push(o),o=[])):l==='"'&&(i=t.inString);break;case t.inString:l==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:l==='"'?i=t.inString:((l==="	"||l===`
`)&&(o.push(Xl(e.slice(r,a))),r=a+1,l===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(Xl(e.slice(r,e.length))),n.push(o),n.map(l=>l.map(c=>({rawValue:c,formatted:c,format:"string"})))}function Kl(e,t,n){var l;const o=ru(e,t),r=c=>{var u;(u=window.navigator.clipboard)==null||u.writeText(c)},i=(c,u)=>{var d;return((d=window.navigator.clipboard)==null?void 0:d.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([u],{type:"text/html"})})]),!0)},a=(c,u)=>{var d,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(d=n==null?void 0:n.clipboardData)==null||d.setData("text/plain",c),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",u)}catch{i(c,u)||r(c)}};((l=window.navigator.clipboard)==null?void 0:l.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function Ui(e){return e!==!0}function su(e){const{state:t,keybindings:n,overlayOpen:o,columnSelect:r,rowSelect:i,rangeSelect:a,editOnType:l,trapFocus:c,showTrailingBlankRow:u,columnsInLength:d,rowGroupingNavBehavior:g,mapper:h,onKeyDownIn:m,onSelectionCleared:f,onCellActivated:w,onDelete:C,getCellContent:k,setSelectedColumns:b,setSelectedRows:y,setShowSearchInner:H,searchInputRef:A,adjustSelection:v,updateSelectedCell:P,deleteRange:E,fillDown:M,fillRight:L,appendRow:I,getCustomNewRowTargetColumn:D,scrollToRef:R}=e,{gridSelection:x,gridRef:W,visibleRegionRef:V,rowMarkerOffset:oe,rows:ne,setGridSelection:U,getMangledCellContent:G,mangledOnCellsEdited:K,setOverlay:Z,reselect:fe,focus:ce}=t,re=s.useCallback(z=>{var te,pe,Ee,ze;const X=()=>{z.stopPropagation(),z.preventDefault()},Y={didMatch:!1},{bounds:Q}=z,ve=x.columns,De=x.rows,N=n;if(!o&&Ge(N.clear,z,Y)){const ae=((te=x.current)==null?void 0:te.cell)??[oe,0];U({columns:nt.empty(),rows:nt.empty(),current:{cell:ae,range:{x:ae[0],y:ae[1],width:1,height:1},rangeStack:[]}},!1),f==null||f(),ce()}else if(!o&&Ge(N.selectAll,z,Y))U({columns:nt.empty(),rows:nt.empty(),current:{cell:((pe=x.current)==null?void 0:pe.cell)??[oe,0],range:{x:oe,y:0,width:d,height:ne},rangeStack:[]}},!1);else if(Ge(N.search,z,Y))(Ee=A==null?void 0:A.current)==null||Ee.focus({preventScroll:!0}),H(!0);else if(Ge(N.delete,z,Y)){const ae=(C==null?void 0:C(x))??!0;if(ae!==!1){const ge=ae===!0?x:ae;if(ge.current!==void 0){E(ge.current.range);for(const Le of ge.current.rangeStack)E(Le)}for(const Le of ge.rows)E({x:oe,y:Le,width:d,height:1});for(const Le of ge.columns)E({x:Le,y:0,width:1,height:ne})}}if(Y.didMatch)return X(),!0;if(x.current===void 0)return!1;let[ee,we]=x.current.cell;const[,Ve]=x.current.cell;let Fe=!1,Et=!1;if(Ge(N.scrollToSelectedCell,z,Y))R.current(ee-oe,we);else if(r!=="none"&&Ge(N.selectColumn,z,Y))ve.hasIndex(ee)?b(ve.remove(ee),void 0,!0):r==="single"?b(nt.fromSingleSelection(ee),void 0,!0):b(void 0,ee,!0);else if(i!=="none"&&Ge(N.selectRow,z,Y))De.hasIndex(we)?y(De.remove(we),void 0,!0):i==="single"?y(nt.fromSingleSelection(we),void 0,!0):y(void 0,we,!0);else if(!o&&Q!==void 0&&Ge(N.activateCell,z,Y))if(we===ne&&u)window.setTimeout(()=>{const ae=D(ee);I(ae??ee)},0);else{const ae={inputType:"keyboard",key:z.key},ge=G([ee,we]);ge.kind===J.Boolean&&ge.readonly!==!0?(w==null||w([ee-oe,we],ae),K([{location:[ee,we],value:{...ge,data:Ui(ge.data)}}]),(ze=W.current)==null||ze.damage([{cell:[ee,we]}])):(w==null||w([ee-oe,we],ae),fe(Q,ae))}else x.current.range.height>1&&Ge(N.downFill,z,Y)?M():x.current.range.width>1&&Ge(N.rightFill,z,Y)?L():Ge(N.goToNextPage,z,Y)?we+=Math.max(1,V.current.height-4):Ge(N.goToPreviousPage,z,Y)?we-=Math.max(1,V.current.height-4):Ge(N.goToFirstCell,z,Y)?(Z(void 0),we=0,ee=0):Ge(N.goToLastCell,z,Y)?(Z(void 0),we=Number.MAX_SAFE_INTEGER,ee=Number.MAX_SAFE_INTEGER):Ge(N.selectToFirstCell,z,Y)?(Z(void 0),v([-2,-2])):Ge(N.selectToLastCell,z,Y)?(Z(void 0),v([2,2])):o?(Ge(N.closeOverlay,z,Y)&&Z(void 0),Ge(N.acceptOverlayDown,z,Y)&&(Z(void 0),we++),Ge(N.acceptOverlayUp,z,Y)&&(Z(void 0),we--),Ge(N.acceptOverlayLeft,z,Y)&&(Z(void 0),ee--),Ge(N.acceptOverlayRight,z,Y)&&(Z(void 0),ee++)):(Ge(N.goDownCell,z,Y)?we+=1:Ge(N.goUpCell,z,Y)?we-=1:Ge(N.goRightCell,z,Y)?ee+=1:Ge(N.goLeftCell,z,Y)?ee-=1:Ge(N.goDownCellRetainSelection,z,Y)?(we+=1,Fe=!0):Ge(N.goUpCellRetainSelection,z,Y)?(we-=1,Fe=!0):Ge(N.goRightCellRetainSelection,z,Y)?(ee+=1,Fe=!0):Ge(N.goLeftCellRetainSelection,z,Y)?(ee-=1,Fe=!0):Ge(N.goToLastRow,z,Y)?we=ne-1:Ge(N.goToFirstRow,z,Y)?we=Number.MIN_SAFE_INTEGER:Ge(N.goToLastColumn,z,Y)?ee=Number.MAX_SAFE_INTEGER:Ge(N.goToFirstColumn,z,Y)?ee=Number.MIN_SAFE_INTEGER:(a==="rect"||a==="multi-rect")&&(Ge(N.selectGrowDown,z,Y)?v([0,1]):Ge(N.selectGrowUp,z,Y)?v([0,-1]):Ge(N.selectGrowRight,z,Y)?v([1,0]):Ge(N.selectGrowLeft,z,Y)?v([-1,0]):Ge(N.selectToLastRow,z,Y)?v([0,2]):Ge(N.selectToFirstRow,z,Y)?v([0,-2]):Ge(N.selectToLastColumn,z,Y)?v([2,0]):Ge(N.selectToFirstColumn,z,Y)&&v([-2,0])),Et=Y.didMatch);if(g!==void 0&&g!=="normal"&&we!==Ve){const ae=g==="skip-up"||g==="skip"||g==="block",ge=g==="skip-down"||g==="skip"||g==="block",Le=we<Ve;if(Le&&ae){for(;we>=0&&h(we).isGroupHeader;)we--;we<0&&(we=Ve)}else if(!Le&&ge){for(;we<ne&&h(we).isGroupHeader;)we++;we>=ne&&(we=Ve)}}const O=P(ee,we,!1,Fe),ie=Y.didMatch;return ie&&(O||!Et||c)&&X(),ie},[g,o,x,n,r,i,a,oe,h,ne,P,U,f,d,C,c,E,b,y,u,D,I,w,fe,M,L,v,G,K,W,Z,ce,V,A,H,R]),se=s.useCallback(z=>{let X=!1;if(m!==void 0&&m({...z,...z.location&&{location:[z.location[0]-oe,z.location[1]]},cancel:()=>{X=!0}}),X||re(z)||x.current===void 0)return;const[Y,Q]=x.current.cell,ve=V.current,De=z.keyCode===229,N=l&&!z.metaKey&&!z.ctrlKey&&z.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(z.key);if((De||N)&&z.bounds!==void 0&&no(k([Y-oe,Math.max(0,Math.min(Q,ne-1))]))){if((!u||Q!==ne)&&(ve.y>Q||Q>ve.y+ve.height||ve.x>Y||Y>ve.x+ve.width))return;if(z.stopPropagation(),z.preventDefault(),De){const ee={inputType:"keyboard",key:""};w==null||w([Y-oe,Q],ee),fe(z.bounds,ee,"")}else{const ee={inputType:"keyboard",key:z.key};w==null||w([Y-oe,Q],ee),fe(z.bounds,ee,z.key)}}},[l,m,re,x,k,oe,ne,u,w,fe,V]);return{handleFixedKeybindings:re,onKeyDown:se}}function au(e,t,n,o,r,i,a){const l=Rt.useCallback((d,g,h,m)=>{var y;(i==="cell"||i==="multi-cell")&&d!==void 0&&(d={...d,range:{x:d.cell[0],y:d.cell[1],width:1,height:1}}),!a&&d!==void 0&&d.range.width>1&&(d={...d,range:{...d.range,width:1,x:d.cell[0]}});const f=n==="mixed"&&(h||m==="drag")||n==="additive",w=(o==="mixed"||o==="additive")&&f,C=h||(r==="mixed"||r==="additive")&&f;let k={current:d===void 0?void 0:{...d,rangeStack:m==="drag"?((y=e.current)==null?void 0:y.rangeStack)??[]:[]},columns:w?e.columns:nt.empty(),rows:C?e.rows:nt.empty()};h&&(i==="multi-rect"||i==="multi-cell")&&k.current!==void 0&&e.current!==void 0&&(k={...k,current:{...k.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(k,g)},[o,e,n,i,a,r,t]),c=Rt.useCallback((d,g,h)=>{d=d??e.rows,g!==void 0&&(d=d.add(g));let m;if(r==="exclusive"&&d.length>0)m={current:void 0,columns:nt.empty(),rows:d};else{const f=h&&n==="mixed"||n==="additive",w=h&&o==="mixed"||o==="additive";m={current:f?e.current:void 0,columns:w?e.columns:nt.empty(),rows:d}}t(m,!1)},[o,e,n,r,t]),u=Rt.useCallback((d,g,h)=>{d=d??e.columns,g!==void 0&&(d=d.add(g));let m;if(o==="exclusive"&&d.length>0)m={current:void 0,rows:nt.empty(),columns:d};else{const f=h&&n==="mixed"||n==="additive",w=h&&r==="mixed"||r==="additive";m={current:f?e.current:void 0,rows:w?e.rows:nt.empty(),columns:d}}t(m,!1)},[o,e,n,r,t]);return[l,c,u]}function cu(e,t,n,o,r){const i=s.useCallback(u=>{if(e===!0){const d=[];for(let g=u.y;g<u.y+u.height;g++){const h=[];for(let m=u.x;m<u.x+u.width;m++)m<0||g>=r?h.push({kind:J.Loading,allowOverlay:!1}):h.push(t([m,g]));d.push(h)}return d}return(e==null?void 0:e(u,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,l=s.useCallback(u=>{if(a===void 0)return[];const d={...u,x:u.x-n};if(d.x<0){d.x=0,d.width--;const g=a(d,o.signal);return typeof g=="function"?async()=>(await g()).map(h=>[{kind:J.Loading,allowOverlay:!1},...h]):g.map(h=>[{kind:J.Loading,allowOverlay:!1},...h])}return a(d,o.signal)},[o.signal,a,n]);return[e!==void 0?l:void 0,a]}function Yl(e){return typeof e=="string"?e:`${e}px`}const du=()=>e=>e.innerWidth,uu=()=>e=>e.innerHeight,fu=_t("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[du()],"wmyidgi-1":[uu()]}}),hu=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return s.createElement(fu,{innerHeight:Yl(n),innerWidth:Yl(t),...r},o)},gu=2,mu=1300;function wu(e,t,n){const o=Rt.useRef(0),[r,i]=e??[0,0];Rt.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,l=0;const c=u=>{var d;if(!a){if(l===0)l=u;else{const g=u-l;o.current=Math.min(1,o.current+g/mu);const h=o.current**1.618*g*gu;(d=t.current)==null||d.scrollBy(r*h,i*h),l=u,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{a=!0}},[t,r,i,n])}function pu(e){const{state:t,keybindings:n,getCellsForSelection:o,coercePasteValue:r,onPaste:i,copyHeaders:a,columnsIn:l,onDelete:c,deleteRange:u,safeWindow:d}=e,{gridSelection:g,gridRef:h,scrollRef:m,canvasRef:f,abortControllerRef:w,rowMarkerOffset:C,mangledCols:k,mangledRows:b,rows:y,getMangledCellContent:H,mangledOnCellsEdited:A,getCellRenderer:v}=t,P=s.useCallback(async L=>{var V,oe,ne;if(!n.paste)return;function I(U,G,K,Z){var ce,re;const fe=typeof K=="object"?(K==null?void 0:K.join(`
`))??"":(K==null?void 0:K.toString())??"";if(!yo(U)&&no(U)&&U.readonly!==!0){const se=r==null?void 0:r(fe,U);if(se!==void 0&&Wn(se))return{location:G,value:se};const z=v(U);if(z===void 0)return;if(z.kind===J.Custom){un(U.kind===J.Custom);const X=(ce=z.onPaste)==null?void 0:ce.call(z,fe,U.data);return X===void 0?void 0:{location:G,value:{...U,data:X}}}else{const X=(re=z.onPaste)==null?void 0:re.call(z,fe,U,{formatted:Z,formattedString:typeof Z=="string"?Z:Z==null?void 0:Z.join(`
`),rawValue:K});return X===void 0?void 0:(un(X.kind===U.kind),{location:G,value:X})}}}const D=g.columns,R=g.rows,x=((V=m.current)==null?void 0:V.contains(document.activeElement))===!0||((oe=f.current)==null?void 0:oe.contains(document.activeElement))===!0;let W;if(g.current!==void 0?W=[g.current.range.x,g.current.range.y]:D.length===1?W=[D.first()??0,0]:R.length===1&&(W=[C,R.first()??0]),x&&W!==void 0){let U,G;const K="text/plain",Z="text/html";if(navigator.clipboard.read!==void 0){const se=await navigator.clipboard.read();for(const z of se){if(z.types.includes(Z)){const Y=await(await z.getType(Z)).text(),Q=Gl(Y);if(Q!==void 0){U=Q;break}}z.types.includes(K)&&(G=await(await z.getType(K)).text())}}else if(navigator.clipboard.readText!==void 0)G=await navigator.clipboard.readText();else if(L!==void 0&&(L==null?void 0:L.clipboardData)!==null){if(L.clipboardData.types.includes(Z)){const se=L.clipboardData.getData(Z);U=Gl(se)}U===void 0&&L.clipboardData.types.includes(K)&&(G=L.clipboardData.getData(K))}else return;const[fe,ce]=W,re=[];do{if(i===void 0){const se=H(W),z=G??(U==null?void 0:U.map(Y=>Y.map(Q=>Q.rawValue).join("	")).join("	"))??"",X=I(se,W,z,void 0);X!==void 0&&re.push(X);break}if(U===void 0){if(G===void 0)return;U=lu(G)}if(i===!1||typeof i=="function"&&(i==null?void 0:i([W[0]-C,W[1]],U.map(se=>se.map(z=>{var X;return((X=z.rawValue)==null?void 0:X.toString())??""}))))!==!0)return;for(const[se,z]of U.entries()){if(se+ce>=y)break;for(const[X,Y]of z.entries()){const Q=[X+fe,se+ce],[ve,De]=Q;if(ve>=k.length||De>=b)continue;const N=H(Q),ee=I(N,Q,Y.rawValue,Y.formatted);ee!==void 0&&re.push(ee)}}}while(!1);A(re),(ne=h.current)==null||ne.damage(re.map(se=>({cell:se.location})))}},[r,v,H,g,n.paste,m,f,k.length,A,b,i,C,y,h]);Yt("paste",P,d,!1,!0);const E=s.useCallback(async(L,I)=>{var V,oe;if(!n.copy)return;const D=I===!0||((V=m.current)==null?void 0:V.contains(document.activeElement))===!0||((oe=f.current)==null?void 0:oe.contains(document.activeElement))===!0,R=g.columns,x=g.rows,W=(ne,U)=>{if(!a)Kl(ne,U,L);else{const G=U.map(K=>({kind:J.Text,data:l[K].title,displayData:l[K].title,allowOverlay:!1}));Kl([G,...ne],U,L)}};if(D&&o!==void 0){if(g.current!==void 0){let ne=o(g.current.range,w.current.signal);typeof ne!="object"&&(ne=await ne()),W(ne,bo(g.current.range.x-C,g.current.range.x+g.current.range.width-C))}else if(x!==void 0&&x.length>0){const U=[...x].map(G=>{const K=o({x:C,y:G,width:l.length,height:1},w.current.signal);return typeof K=="object"?K[0]:K().then(Z=>Z[0])});if(U.some(G=>G instanceof Promise)){const G=await Promise.all(U);W(G,bo(l.length))}else W(U,bo(l.length))}else if(R.length>0){const ne=[],U=[];for(const G of R){let K=o({x:G,y:0,width:1,height:y},w.current.signal);typeof K!="object"&&(K=await K()),ne.push(K),U.push(G-C)}if(ne.length===1)W(ne[0],U);else{const G=ne.reduce((K,Z)=>K.map((fe,ce)=>[...fe,...Z[ce]]));W(G,U)}}}},[l,o,g,n.copy,C,m,f,w,y,a]);Yt("copy",E,d,!1,!1);const M=s.useCallback(async L=>{var D,R;if(!(!n.cut||!(((D=m.current)==null?void 0:D.contains(document.activeElement))===!0||((R=f.current)==null?void 0:R.contains(document.activeElement))===!0))&&(await E(L),g.current!==void 0)){let x={current:{cell:g.current.cell,range:g.current.range,rangeStack:[]},rows:nt.empty(),columns:nt.empty()};const W=c==null?void 0:c(x);if(W===!1||(x=W===void 0||W===!0?x:W,x.current===void 0))return;u(x.current.range)}},[u,g,n.cut,E,m,f,c]);return Yt("cut",M,d,!1,!1),{onCopy:E,onCut:M,onPasteInternal:P}}function bu({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:l}){const[c,u,d,g,h,m]=Rt.useMemo(()=>{if(!a||l===16)return[e,t,n,o,r,i];const f=l/16,w=e,C=cs();return[typeof w=="number"?w*f:k=>Math.ceil(w(k)*f),Math.ceil(t*f),Math.ceil(n*f),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??C.headerIconSize)*f,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??C.cellHorizontalPadding)*f,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??C.cellVerticalPadding)*f},Math.ceil((r??0)*f),Math.ceil((i??0)*f)]},[n,t,r,i,l,e,a,o]);return{rowHeight:c,headerHeight:u,groupHeaderHeight:d,theme:g,overscrollX:h,overscrollY:m}}const Zn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Xe(e,t){return e===!0?t:e===!1?"":e}function _l(e){const t=Zr.value;return{activateCell:Xe(e.activateCell," |Enter|shift+Enter"),clear:Xe(e.clear,"any+Escape"),closeOverlay:Xe(e.closeOverlay,"any+Escape"),acceptOverlayDown:Xe(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Xe(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Xe(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Xe(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Xe(e.delete,t?"Backspace|Delete":"Delete"),downFill:Xe(e.downFill,"primary+_68"),scrollToSelectedCell:Xe(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Xe(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Xe(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Xe(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Xe(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Xe(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Xe(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Xe(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Xe(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Xe(e.goToFirstCell,"primary+Home"),goToFirstColumn:Xe(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Xe(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Xe(e.goToLastCell,"primary+End"),goToLastColumn:Xe(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Xe(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Xe(e.goToNextPage,"PageDown"),goToPreviousPage:Xe(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Xe(e.rightFill,"primary+_82"),search:Xe(e.search,"primary+f"),selectAll:Xe(e.selectAll,"primary+a"),selectColumn:Xe(e.selectColumn,"ctrl+ "),selectGrowDown:Xe(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Xe(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Xe(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Xe(e.selectGrowUp,"shift+ArrowUp"),selectRow:Xe(e.selectRow,"shift+ "),selectToFirstCell:Xe(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Xe(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Xe(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Xe(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Xe(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Xe(e.selectToLastRow,"primary+shift+ArrowDown")}}function yu(e){const t=Xa(e);return Rt.useMemo(()=>{if(t===void 0)return _l(Zn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Zn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Zn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Zn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Zn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Zn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Zn.selectToLastCell};return _l({...Zn,...n})},[t])}function Cu(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const a={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(a.subGroups=o.subGroups.map((l,c)=>t(l,r+1,[...i,c])).sort((l,c)=>l.headerIndex-c.headerIndex)),a}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function qi(e,t){const n=[];function o(l,c,u=!1){let d=c!==null?c-l.headerIndex:t-l.headerIndex;if(l.subGroups!==void 0&&(d=l.subGroups[0].headerIndex-l.headerIndex),d--,n.push({rowIndex:-1,headerIndex:l.headerIndex,contentIndex:-1,skip:u,isCollapsed:l.isCollapsed,depth:l.depth,path:l.path,rows:d}),l.subGroups)for(let g=0;g<l.subGroups.length;g++){const h=g<l.subGroups.length-1?l.subGroups[g+1].headerIndex:c;o(l.subGroups[g],h,u||l.isCollapsed)}}const r=Cu(e.groups);for(let l=0;l<r.length;l++){const c=l<r.length-1?r[l+1].headerIndex:null;o(r[l],c)}let i=0,a=0;for(const l of n)l.contentIndex=a,a+=l.rows,l.rowIndex=i,i+=l.isCollapsed?1:l.rows+1;return n.filter(l=>l.skip===!1).map(l=>{const{skip:c,...u}=l;return u})}function Li(e,t){if(t===void 0||qi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function ku(e,t,n,o){const r=Rt.useMemo(()=>e===void 0?void 0:qi(e,t),[e,t]),i=Rt.useMemo(()=>r==null?void 0:r.reduce((d,g)=>(d[g.rowIndex]=g,d),{}),[r]),a=Rt.useMemo(()=>r===void 0?t:r.reduce((d,g)=>d+(g.isCollapsed?1:g.rows+1),0),[r,t]),l=Rt.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:d=>i!=null&&i[d]?e.height:typeof n=="number"?n:n(d),[i,e,n]),c=Rt.useCallback(d=>{if(r===void 0)return d;let g=d;for(const h of r){if(g===0)return;if(g--,!h.isCollapsed){if(g<h.rows)return h.contentIndex+g;g-=h.rows}}return d},[r]),u=Qn(o??(e==null?void 0:e.themeOverride),Rt.useCallback(d=>{if(e===void 0)return o==null?void 0:o(d,d,d);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:g,contentIndex:h,groupIndex:m}=Li(d,r);return g?e.themeOverride:o==null?void 0:o(d,m,h)},[r,o,e]));return e===void 0?{rowHeight:l,rows:t,rowNumberMapper:c,getRowThemeOverride:u}:{rowHeight:l,rows:a,rowNumberMapper:c,getRowThemeOverride:u}}function vu(e,t){const n=Rt.useMemo(()=>e===void 0?void 0:qi(e,t),[e,t]);return{getRowGroupingForPath:Ts,updateRowGroupingByPath:Fs,mapper:Rt.useCallback(o=>{if(typeof o=="number")return Li(o,n);const r=Li(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function Fs(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,a)=>a===o?{...i,...n}:i):e.map((i,a)=>a===o?{...i,subGroups:Fs(i.subGroups??[],r,n)}:i)}function Ts(e,t){const[n,...o]=t;return o[0]===-1?e[n]:Ts(e[n].subGroups??[],o)}function xu(e,t){const[n]=s.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Su(e,t,n,o,r){const[i,a]=s.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),l=s.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:a}),[o,a,i]),[c,u,d]=Ga(l),g=s.useRef(r);g.current=r;const h=xu(null,w=>{w!==null&&t!==void 0?w.scrollTop=t:w!==null&&e!==void 0&&(w.scrollLeft=e)}),m=(c.height??1)>1;s.useLayoutEffect(()=>{if(t!==void 0&&h.current!==null&&m){if(h.current.scrollTop===t)return;h.current.scrollTop=t,h.current.scrollTop!==t&&d(),g.current()}},[t,m,d,h]);const f=(c.width??1)>1;return s.useLayoutEffect(()=>{if(e!==void 0&&h.current!==null&&f){if(h.current.scrollLeft===e)return;h.current.scrollLeft=e,h.current.scrollLeft!==e&&d(),g.current()}},[e,f,d,h]),{visibleRegion:c,setVisibleRegion:u,scrollRef:h}}const Mu=_t("textarea")({name:"GhostInputBox",class:"gdg-g1wsindo",propsAsIs:!1}),Ru=(e,t)=>{const{onInput:n,onCompositionStart:o,onCompositionEnd:r,onKeyDown:i,onKeyUp:a,onFocus:l,onBlur:c,disabled:u=!1}=e,d=s.useRef(null),g=s.useRef(!1),h=s.useRef({width:0,height:0}),m=s.useCallback(()=>{const y=d.current;if(!y||y.style.opacity==="0")return;const H=h.current.width,A=h.current.height;y.style.width=`${H}px`,y.style.height=`${A}px`;const v=Math.max(H,y.scrollWidth+2),P=Math.max(A,y.scrollHeight+2);y.style.width=`${v}px`,y.style.height=`${P}px`},[]);s.useImperativeHandle(t,()=>({focus:()=>{var y;(y=d.current)==null||y.focus({preventScroll:!0})},blur:()=>{var y;(y=d.current)==null||y.blur()},clear:()=>{d.current&&(d.current.value="",d.current.setSelectionRange(0,0))},getValue:()=>{var y;return((y=d.current)==null?void 0:y.value)??""},setValue:y=>{if(d.current){d.current.value=y;const H=y.length;d.current.setSelectionRange(H,H)}},setPosition:(y,H,A,v)=>{const P=d.current;P&&(h.current={width:A,height:v},P.style.left=`${y}px`,P.style.top=`${H}px`,P.style.width=`${A}px`,P.style.height=`${v}px`)},setVisible:y=>{const H=d.current;H&&(y?(H.style.opacity="1",H.style.pointerEvents="auto",H.style.zIndex="10000"):(H.style.left="-9999px",H.style.top="0",H.style.width="1px",H.style.height="1px",H.style.opacity="0",H.style.pointerEvents="none",H.style.zIndex="0"))}}));const f=s.useCallback(y=>{const H=y.currentTarget;n(H.value,g.current),m()},[n,m]),w=s.useCallback(()=>{g.current=!0,o()},[o]),C=s.useCallback(y=>{g.current=!1,r(y.currentTarget.value)},[r]),k=s.useCallback(y=>{i(y)},[i]),b=s.useCallback(y=>{a==null||a(y)},[a]);return s.createElement(Mu,{ref:d,defaultValue:"",tabIndex:u?-1:0,disabled:u,onInput:f,onCompositionStart:w,onCompositionEnd:C,onKeyDown:k,onKeyUp:b,onFocus:l,onBlur:c,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},Eu=s.memo(s.forwardRef(Ru));function Iu(e){const{state:t,onKeyDown:n,onFinishEditing:o,onKeyUpIn:r,onCellActivated:i,setIsFocused:a}=e,{gridSelection:l,overlayRef:c,ghostInputRef:u,ghostInputVisibleRef:d,gridRef:g,rowMarkerOffset:h,getMangledCellContent:m,reselect:f}=t,w=s.useCallback((v,P)=>{var E;if(c.current===void 0&&!P&&v.length>0&&v.trim().length>0&&l.current!==void 0){const[M,L]=l.current.cell,I=m([M,L]);if(I.kind===J.Custom){const D=I.data,R=D==null?void 0:D.kind;if(R!=="number-cell"&&R!=="date-picker-cell")return}if(I.allowOverlay&&no(I)&&I.readonly!==!0){const D=(E=g.current)==null?void 0:E.getBounds(M,L);if(D!==void 0){const R={inputType:"keyboard",key:v};i==null||i([M-h,L],R),f(D,R,v)}}}},[l,m,h,i,f,g,c]),C=s.useCallback(()=>{var M,L,I,D,R;if(l.current===void 0)return;const[v,P]=l.current.cell,E=(M=c.current)==null?void 0:M.cell;if(E!==void 0&&(E[0]!==v||E[1]!==P)&&((L=u.current)==null||L.clear(),(I=u.current)==null||I.setVisible(!1),t.setGhostInputVisible(!1),c.current=void 0,t.setOverlay(void 0)),c.current===void 0){const x=m([v,P]);if(x.kind===J.Custom){const W=x.data,V=W==null?void 0:W.kind;if(V!=="number-cell"&&V!=="date-picker-cell")return}if(x.allowOverlay&&no(x)&&x.readonly!==!0){const W=(D=g.current)==null?void 0:D.getBounds(v,P);if(W!==void 0){(R=u.current)==null||R.clear();const V={inputType:"keyboard",key:""};i==null||i([v-h,P],V),f(W,V,"")}}}},[l,m,h,i,f,u,g,c,t]),k=s.useCallback(v=>{},[]),b=s.useCallback(v=>{var I,D;if(v.nativeEvent.isComposing)return;if(c.current!==void 0&&d.current){const R=v.key;if(c.current.content.kind===J.Custom){const W=v.key;(W==="Enter"||W==="Tab"||W==="Escape")&&(v.preventDefault(),v.stopPropagation());return}if(R==="Escape"){v.preventDefault(),v.stopPropagation(),o(void 0,[0,0]);return}if(R==="Enter"&&!v.shiftKey){v.preventDefault(),v.stopPropagation(),o(void 0,[0,1]);return}if(R==="Tab"){v.preventDefault(),v.stopPropagation(),o(void 0,v.shiftKey?[-1,0]:[1,0]);return}}{const R=v.key;if(R.length===1&&!v.ctrlKey&&!v.metaKey&&!v.altKey)if(R===" "&&l.current!==void 0){const W=l.current.cell,V=m(W);if(!(V.kind===J.Boolean&&V.readonly!==!0))return}else return}if(c.current!==void 0&&d.current){const R=v.key;if(R==="Backspace"||R==="Delete"||(R==="ArrowLeft"||R==="ArrowRight"||R==="ArrowUp"||R==="ArrowDown"||R==="Home"||R==="End"))return}const P=(I=l.current)==null?void 0:I.cell,E=P!==void 0?(D=g.current)==null?void 0:D.getBounds(P[0],P[1]):void 0;let M=!1;const L={bounds:E,cancel:()=>{M=!0},stopPropagation:()=>v.stopPropagation(),preventDefault:()=>v.preventDefault(),ctrlKey:v.ctrlKey,metaKey:v.metaKey,shiftKey:v.shiftKey,altKey:v.altKey,key:v.key,keyCode:v.keyCode,rawEvent:v,location:P};n(L),M&&(v.preventDefault(),v.stopPropagation())},[l,n,o,m,c,d,g]),y=s.useCallback(v=>{var L,I;const P=(L=l.current)==null?void 0:L.cell,M={bounds:P!==void 0?(I=g.current)==null?void 0:I.getBounds(P[0],P[1]):void 0,cancel:()=>{},stopPropagation:()=>v.stopPropagation(),preventDefault:()=>v.preventDefault(),ctrlKey:v.ctrlKey,metaKey:v.metaKey,shiftKey:v.shiftKey,altKey:v.altKey,key:v.key,keyCode:v.keyCode,rawEvent:v,location:P};r==null||r(M)},[l,r,g]),H=s.useCallback(()=>{a(!0)},[a]),A=s.useCallback(()=>{a(!1)},[a]);return{onGhostInput:w,onGhostCompositionStart:C,onGhostCompositionEnd:k,onGhostKeyDown:b,onGhostKeyUp:y,onGhostFocus:H,onGhostBlur:A}}function Hu(e){const{state:t,mouseState:n,setMouseState:o,fillHighlightRegion:r,setFillHighlightRegion:i,setScrollDir:a,handleSelect:l,onMouseMove:c,onCellClicked:u,onCellActivated:d,onCellContextMenu:g,onHeaderContextMenu:h,onGroupHeaderContextMenu:m,onHeaderClicked:f,onGroupHeaderClicked:w,onColumnResize:C,onFillPattern:k,cellActivationBehavior:b,columnSelect:y,columnSelectionMode:H,columns:A,groupLevels:v,mergedTheme:P,minColumnWidth:E,maxColumnWidth:M,themeForCell:L,getCellsForSelection:I,setSelectedColumns:D,visibleRegion:R,lastMouseSelectLocation:x}=e,{gridSelection:W,gridRef:V,visibleRegionRef:oe,abortControllerRef:ne,rowMarkerOffset:U,mangledCols:G,rows:K,setGridSelection:Z,getMangledCellContent:fe,mangledOnCellsEdited:ce,reselect:re,focus:se,getCellRenderer:z}=t,X=s.useRef(!1),Y=s.useRef(R),Q=s.useRef(void 0),ve=s.useRef(!1),De=s.useCallback(O=>{if(ve.current=!1,Y.current=oe.current,O.button!==0&&O.button!==1){Q.current=void 0;return}const ie=performance.now();Q.current={button:O.button,time:ie,location:O.location},(O==null?void 0:O.kind)==="header"&&(X.current=!0);const te=O.kind==="cell"&&O.isFillHandle;!te&&O.kind!=="cell"&&O.isEdge||(o({previousSelection:W,fillHandle:te}),x.current=void 0,!O.isTouch&&O.button===0&&!te?l(O):!O.isTouch&&O.button===1&&(x.current=O.location))},[W,l]),N=s.useCallback(O=>{if(O.kind!==kn||y!=="multi")return;const ie=Zr.value?O.metaKey:O.ctrlKey,[te,pe]=O.location,Ee=W.columns;if(te<U)return;const ze=G[te];let ae=te,ge=te;const Le=pe<=-2?-(pe+2):0,Ye=(_,Ke)=>v>1?Yr(_,Ke,Le,v):ds(_,Ke);for(let _=te-1;_>=U&&Ye(ze.group,G[_].group);_--)ae--;for(let _=te+1;_<G.length&&Ye(ze.group,G[_].group);_++)ge++;if(se(),ie||O.isTouch||H==="multi")if(Ee.hasAll([ae,ge+1])){let _=Ee;for(let Ke=ae;Ke<=ge;Ke++)_=_.remove(Ke);D(_,void 0,ie)}else D(void 0,[ae,ge+1],ie);else D(nt.fromSingleSelection([ae,ge+1]),void 0,ie)},[y,se,W.columns,G,U,D,H,v]),ee=s.useCallback(async O=>{if(I!==void 0&&C!==void 0){const ie=oe.current.y,te=oe.current.height;let pe=I({x:O,y:ie,width:1,height:Math.min(te,K-ie)},ne.current.signal);typeof pe!="object"&&(pe=await pe());const Ee=A[O-U],ae=document.createElement("canvas").getContext("2d",{alpha:!1});if(ae!==null){ae.font=P.baseFontFull;const ge=Cs(ae,P,Ee,0,pe,E,M,!1,z);C==null||C(Ee,ge.width,O,ge.width)}}},[A,I,M,P,E,C,U,K,z]),we=s.useCallback(async(O,ie)=>{var ge,Le;const te=(ge=O.current)==null?void 0:ge.range;if(te===void 0||I===void 0||ie.current===void 0)return;const pe=ie.current.range;if(k!==void 0){let Ye=!1;if(k({fillDestination:{...pe,x:pe.x-U},patternSource:{...te,x:te.x-U},preventDefault:()=>Ye=!0}),Ye)return}let Ee=I(te,ne.current.signal);typeof Ee!="object"&&(Ee=await Ee());const ze=Ee,ae=[];for(let Ye=0;Ye<pe.width;Ye++)for(let _=0;_<pe.height;_++){const Ke=[pe.x+Ye,pe.y+_];if(us(Ke,te))continue;const He=ze[_%te.height][Ye%te.width];yo(He)||!no(He)||ae.push({location:Ke,value:{...He}})}ce(ae),(Le=V.current)==null||Le.damage(ae.map(Ye=>({cell:Ye.location})))},[I,ce,k,U]),Ve=s.useCallback(()=>{if(W.current===void 0||W.current.range.width<=1)return;const O={...W,current:{...W.current,range:{...W.current.range,width:1}}};we(O,W)},[we,W]),Fe=s.useCallback(()=>{if(W.current===void 0||W.current.range.height<=1)return;const O={...W,current:{...W.current,range:{...W.current.range,height:1}}};we(O,W)},[we,W]),Et=s.useCallback((O,ie)=>{var _,Ke;const te=n;if(o(void 0),i(void 0),a(void 0),X.current=!1,ie)return;if((te==null?void 0:te.fillHandle)===!0&&W.current!==void 0&&((_=te.previousSelection)==null?void 0:_.current)!==void 0){if(r===void 0)return;const He={...W,current:{...W.current,range:Ss(te.previousSelection.current.range,r)}};we(te.previousSelection,He),Z(He,!0);return}const[pe,Ee]=O.location,[ze,ae]=x.current??[],ge=()=>{ve.current=!0},Le=He=>{var ut,lt,Be;const ke=He.isTouch||ze===pe&&ae===Ee;if(ke&&(u==null||u([pe-U,Ee],{...He,preventDefault:ge})),He.button===1)return!ve.current;if(!ve.current){const Ne=fe(O.location),ft=z(Ne);if(ft!==void 0&&ft.onClick!==void 0&&ke){const pt=ft.onClick({...He,cell:Ne,posX:He.localEventX,posY:He.localEventY,bounds:He.bounds,theme:L(Ne,O.location),preventDefault:ge});pt!==void 0&&!yo(pt)&&Wn(pt)&&(ce([{location:He.location,value:pt}]),(ut=V.current)==null||ut.damage([{cell:He.location}]))}if(ve.current||W.current===void 0)return!1;let Dt=!1;switch(Ne.activationBehaviorOverride??b){case"double-click":case"second-click":{if(((Be=(lt=te==null?void 0:te.previousSelection)==null?void 0:lt.current)==null?void 0:Be.cell)===void 0)break;const[pt,At]=W.current.cell,[kt,Ft]=te.previousSelection.current.cell;Dt=pe===pt&&pe===kt&&Ee===At&&Ee===Ft&&(He.isDoubleClick===!0||b==="second-click");break}case"single-click":{Dt=!0;break}}if(Dt){const At={inputType:"pointer",pointerActivation:He.isDoubleClick===!0?"double-click":Ne.activationBehaviorOverride??b,pointerType:He.isTouch?"touch":"mouse"};return d==null||d([pe-U,Ee],At),re(He.bounds,At),!0}}return!1},Ye=O.location[0]-U;if(O.isTouch){const He=oe.current,ke=Y.current;if(He.x!==ke.x||He.y!==ke.y)return;if(O.isLongTouch===!0){if(O.kind==="cell"&&dr((Ke=W.current)==null?void 0:Ke.cell,O.location)){g==null||g([Ye,O.location[1]],{...O,preventDefault:ge});return}else if(O.kind==="header"&&W.columns.hasIndex(pe)){h==null||h(Ye,{...O,preventDefault:ge});return}else if(O.kind===kn){if(Ye<0)return;m==null||m(Ye,{...O,preventDefault:ge});return}}O.kind==="cell"?Le(O)||l(O):O.kind===kn?w==null||w(Ye,{...O,preventDefault:ge}):(O.kind===eo&&(f==null||f(Ye,{...O,preventDefault:ge})),l(O));return}if(O.kind==="header"){if(Ye<0)return;O.isEdge?O.isDoubleClick===!0&&ee(pe):O.button===0&&pe===ze&&Ee===ae&&(f==null||f(Ye,{...O,preventDefault:ge}))}if(O.kind===kn){if(Ye<0)return;O.button===0&&pe===ze&&Ee===ae&&(w==null||w(Ye,{...O,preventDefault:ge}),ve.current||N(O))}O.kind==="cell"&&(O.button===0||O.button===1)&&Le(O),x.current=void 0},[n,W,U,r,we,Z,u,fe,z,b,L,ce,d,re,g,h,m,l,w,f,ee,N]),Ie=s.useCallback(O=>{const ie={...O,location:[O.location[0]-U,O.location[1]]};c==null||c(ie),n!==void 0&&O.buttons===0&&(o(void 0),i(void 0),a(void 0),X.current=!1),a(te=>{var pe;return X.current?[O.scrollEdge[0],0]:O.scrollEdge[0]===(te==null?void 0:te[0])&&O.scrollEdge[1]===te[1]?te:n===void 0||(((pe=Q.current)==null?void 0:pe.location[0])??0)<U?void 0:O.scrollEdge})},[n,c,U]);return{onMouseDown:De,onMouseUp:Et,onMouseMoveImpl:Ie,handleGroupHeaderSelection:N,normalSizeColumn:ee,fillDown:Fe,fillRight:Ve,mouseDownData:Q,isActivelyDraggingHeader:X}}const Du=s.lazy(async()=>await jl(()=>Promise.resolve().then(()=>sc),void 0,import.meta.url));let Fu=0;function Tu(e){return Ta(vl(vl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return bo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function Nr(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Jn={kind:J.Loading,allowOverlay:!1},Ri={columns:nt.empty(),rows:nt.empty(),current:void 0},Au=(e,t)=>{var yl,Cl,kl;const[n,o]=s.useState(Ri),[r,i]=s.useState(),a=s.useRef(null),l=s.useRef(null),[c,u]=s.useState(),[d,g]=s.useState(),h=s.useRef(void 0),m=s.useRef(null),[f,w]=s.useState(!1),C=s.useRef(f);C.current=f;const k=s.useRef(r);k.current=r;const b=typeof window>"u"?null:window,{imageEditorOverride:y,getRowThemeOverride:H,markdownDivCreateNode:A,width:v,height:P,columns:E,rows:M,getCellContent:L,onCellClicked:I,onCellActivated:D,onFillPattern:R,onFinishedEditing:x,coercePasteValue:W,drawHeader:V,drawCell:oe,editorBloom:ne,onHeaderClicked:U,onColumnProposeMove:G,rangeSelectionColumnSpanning:K=!0,spanRangeBehavior:Z="default",onGroupHeaderClicked:fe,onCellContextMenu:ce,className:re,onHeaderContextMenu:se,getCellsForSelection:z,onGroupHeaderContextMenu:X,onGroupHeaderRenamed:Y,onCellEdited:Q,onCellsEdited:ve,onSearchResultsChanged:De,searchResults:N,onSearchValueChange:ee,searchValue:we,onKeyDown:Ve,onKeyUp:Fe,keybindings:Et,editOnType:Ie=!0,onRowAppended:O,onColumnAppended:ie,onColumnMoved:te,validateCell:pe,highlightRegions:Ee,rangeSelect:ze="rect",columnSelect:ae="multi",rowSelect:ge="multi",rangeSelectionBlending:Le="exclusive",columnSelectionBlending:Ye="exclusive",rowSelectionBlending:_="exclusive",onDelete:Ke,onDragStart:He,onMouseMove:ke,onPaste:ut,copyHeaders:lt=!1,freezeColumns:Be=0,cellActivationBehavior:Ne="second-click",rowSelectionMode:ft="auto",columnSelectionMode:Dt="auto",onHeaderMenuClick:pt,onHeaderIndicatorClick:At,getGroupDetails:kt,rowGrouping:Ft,onSearchClose:Wt,onItemHovered:gn,onSelectionCleared:en,showSearch:bt,onVisibleRegionChanged:mn,gridSelection:qe,onGridSelectionChange:Nt,minColumnWidth:tn=50,maxColumnWidth:nn=500,maxColumnAutoWidth:pn,provideEditor:Dn,trailingRowOptions:he,freezeTrailingRows:Ze=0,allowedFillDirections:Je="orthogonal",scrollOffsetX:Gt,scrollOffsetY:Xt,verticalBorder:st,onDragOverCell:vt,onDrop:_o,onColumnResize:xt,onColumnResizeEnd:St,onColumnResizeStart:on,customRenderers:io,fillHandle:On,experimental:ht,fixedShadowX:Fn,fixedShadowY:xo,headerIcons:gr,imageWindowLoader:mr,initialSize:So,isDraggable:Mo,onDragLeave:Ro,onRowMoved:vn,overscrollX:lo,overscrollY:Nn,preventDiagonalScrolling:Jr,rightElement:wr,rightElementProps:Qr,trapFocus:ei=!1,smoothScrollX:Tn,smoothScrollY:$n,scaleToRem:ti=!1,rowHeight:ni=34,headerHeight:Vo=36,groupHeaderHeight:pr=Vo,theme:Eo,isOutsideClick:ji,renderers:Io,resizeIndicator:Uo,scrollToActiveCell:qo=!0,drawFocusRing:Ho=!0,portalElementRef:An,onRowStatus:bn,onRowId:Gn}=e,Xn=Ho==="no-editor"?r===void 0:Ho,Pe=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,oi=(Pe==null?void 0:Pe.rowNumber)??!1;let so=(Pe==null?void 0:Pe.kind)??e.rowMarkers??"none",Vt=oi;(so==="both"||so==="checkbox-and-number")&&(so="checkbox",Vt=!0);const rn=so,ri=(Pe==null?void 0:Pe.width)??e.rowMarkerWidth,Do=(Pe==null?void 0:Pe.startIndex)??e.rowMarkerStartIndex??1,Fo=(Pe==null?void 0:Pe.theme)??e.rowMarkerTheme,To=Pe==null?void 0:Pe.headerTheme,jo=Pe==null?void 0:Pe.headerAlwaysVisible,Ao=ge!=="multi"||(Pe==null?void 0:Pe.headerDisabled)===!0,Kn=(Pe==null?void 0:Pe.checkboxStyle)??"square",ii=(Pe==null?void 0:Pe.rowStatus)??!1,Zo=(Pe==null?void 0:Pe.rowStatusWidth)??40,Po=Pe==null?void 0:Pe.rowStatusTheme,Jo=(Pe==null?void 0:Pe.rowId)??!1,Qo=(Pe==null?void 0:Pe.rowIdWidth)??80,zo=Pe==null?void 0:Pe.rowIdTheme,ao=Math.max(tn,20),er=Math.max(nn,ao),br=Math.max(pn??er,ao),co=s.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:_e,rowNumberMapper:uo,rowHeight:li,getRowThemeOverride:Ut}=ku(Ft,M,ni,H),si=s.useMemo(()=>Number.parseFloat(co.fontSize),[co]),{rowHeight:ln,headerHeight:yr,groupHeaderHeight:tr,theme:B,overscrollX:j,overscrollY:Se}=bu({groupHeaderHeight:pr,headerHeight:Vo,overscrollX:lo,overscrollY:Nn,remSize:si,rowHeight:li,scaleToRem:ti,theme:Eo}),xe=yu(Et),de=ri??(M>1e4?48:M>1e3?44:M>100?36:32),ye=rn!=="none",Te=ii===!0,Oe=Jo===!0,T=(ye?Vt?2:1:0)+(Te?1:0)+(Oe?1:0),It=(ye?(Vt?2:1)*de:0)+(Te?Zo:0)+(Oe?Qo:0),Ce=he!==void 0,je=(he==null?void 0:he.sticky)===!0,[gt,at]=s.useState(!1),mt=bt??gt,Ht=s.useCallback(()=>{Wt!==void 0?Wt():at(!1)},[Wt]),be=s.useMemo(()=>qe===void 0?void 0:Nr(qe,T),[qe,T])??n,$t=s.useRef(new AbortController);s.useEffect(()=>()=>$t==null?void 0:$t.current.abort(),[]);const[zt,xn]=cu(z,L,T,$t.current,_e),ct=s.useCallback((p,S,$)=>{if(pe===void 0)return!0;const F=[p[0]-T,p[1]];return pe==null?void 0:pe(F,S,$)},[T,pe]),sn=s.useRef(qe),Ot=s.useCallback((p,S)=>{S&&(p=iu(p,zt,T,Z,$t.current)),Nt!==void 0?(sn.current=Nr(p,-T),Nt(sn.current)):o(p)},[Nt,zt,T,Z]),Pn=Qn(xt,s.useCallback((p,S,$,F)=>{xt==null||xt(E[$-T],S,$-T,F)},[xt,T,E])),an=Qn(St,s.useCallback((p,S,$,F)=>{St==null||St(E[$-T],S,$-T,F)},[St,T,E])),fo=Qn(on,s.useCallback((p,S,$,F)=>{on==null||on(E[$-T],S,$-T,F)},[on,T,E])),Yn=Qn(V,s.useCallback((p,S)=>(V==null?void 0:V({...p,columnIndex:p.columnIndex-T},S))??!1,[V,T])),Cr=Qn(oe,s.useCallback((p,S)=>(oe==null?void 0:oe({...p,col:p.col-T},S))??!1,[oe,T])),_n=s.useCallback(p=>{if(Ke!==void 0){const S=Ke(Nr(p,-T));return typeof S=="boolean"?S:Nr(S,T)}return!0},[Ke,T]),[Lt,qt,cn]=au(be,Ot,Le,Ye,_,ze,K),jt=s.useMemo(()=>In(cs(),B),[B]),[ai,zs]=s.useState([0,0,0]),Zi=s.useMemo(()=>{if(Io===void 0)return{};const p={};for(const S of Io)p[S.kind]=S;return p},[Io]),Sn=s.useCallback(p=>p.kind!==J.Custom?Zi[p.kind]:io==null?void 0:io.find(S=>S.isMatch(p)),[io,Zi]);let{sizedColumns:yn,nonGrowWidth:Ji}=Sc(E,_e,xn,ai[0]-It-ai[2],ao,br,jt,Sn,$t.current);Ji+=It;const Lo=s.useMemo(()=>{let p=0;for(const S of yn)S.group!==void 0&&(typeof S.group=="string"?p=Math.max(p,1):p=Math.max(p,S.group.length));return p},[yn]),Qi=Lo>0,el=s.useMemo(()=>Lo===0?[]:Array(Lo).fill(tr),[Lo,tr]),Ls=el.reduce((p,S)=>p+S,0),nr=yr+Ls,tl=be.rows.length,nl=rn==="none"?void 0:tl===0?!1:tl===_e?!0:void 0,dt=s.useMemo(()=>{const p=[];return rn!=="none"&&(Vt&&p.push({title:"",width:de,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Fo,rowMarker:Kn,rowMarkerChecked:!1,headerRowMarkerTheme:To,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),p.push({title:"",width:de,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Fo,rowMarker:Kn,rowMarkerChecked:nl,headerRowMarkerTheme:To,headerRowMarkerAlwaysVisible:jo,headerRowMarkerDisabled:Ao})),Te&&p.push({title:"",width:Zo,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Po}),Oe&&p.push({title:"ID",width:Qo,icon:void 0,hasMenu:!1,style:"normal",themeOverride:zo}),[...p,...yn]},[Te,Zo,Po,Oe,Qo,zo,rn,yn,de,Fo,Kn,nl,To,jo,Ao,Vt]),Vn=s.useRef({height:1,width:1,x:0,y:0}),kr=s.useRef(!1),{setVisibleRegion:ol,visibleRegion:ho,scrollRef:yt}=Su(Gt,Xt,ln,Vn,()=>kr.current=!0);Vn.current=ho;const Bs=ho.x+T,vr=ho.y,Zt=s.useRef(null),Jt=s.useCallback(p=>{var S;p===!0?(S=m.current)==null||S.focus():window.requestAnimationFrame(()=>{var $;($=m.current)==null||$.focus()})},[]),Kt=Ce?_e+1:_e,go=s.useCallback(p=>{const S=T===0?p:p.map(F=>({...F,location:[F.location[0]-T,F.location[1]]})),$=ve==null?void 0:ve(S);if($!==!0)for(const F of S)Q==null||Q(F.location,F.value);return $},[Q,ve,T]),[or,rl]=s.useState(),xr=be.current!==void 0&&be.current.range.width*be.current.range.height>1?be.current.range:void 0,Bo=Xn?(yl=be.current)==null?void 0:yl.cell:void 0,Sr=Bo==null?void 0:Bo[0],Mr=Bo==null?void 0:Bo[1],Ws=s.useMemo(()=>{if((Ee===void 0||Ee.length===0)&&(xr??Sr??Mr??or)===void 0)return;const p=[];if(Ee!==void 0)for(const S of Ee){const $=dt.length-S.range.x-T;$>0&&p.push({color:S.color,range:{...S.range,x:S.range.x+T,width:Math.min($,S.range.width)},style:S.style})}return or!==void 0&&p.push({color:oo(jt.accentColor,0),range:or,style:"dashed"}),xr!==void 0&&p.push({color:oo(jt.accentColor,.5),range:xr,style:"solid-outline"}),Sr!==void 0&&Mr!==void 0&&p.push({color:jt.accentColor,range:{x:Sr,y:Mr,width:1,height:1},style:"solid-outline"}),p.length>0?p:void 0},[or,xr,Sr,Mr,Ee,dt.length,jt.accentColor,T]),il=s.useRef(dt);il.current=dt;const zn=s.useCallback(([p,S],$=!1)=>{var Ae,We,ot,tt,Qe,Re,it,rt,Ue;const F=Ce&&S===Kt-1;let q=0,le=-1,ue=-1,me=-1,Me=-1;if(ye&&Vt&&(le=q++),ye&&(ue=q++),Te&&(me=q++),Oe&&(Me=q++),p===le){if(F)return Jn;const et=uo(S);return et===void 0?Jn:{kind:Bt.Marker,allowOverlay:!1,checkboxStyle:Kn,checked:!1,markerKind:"number",row:Do+et,drawHandle:!1,cursor:void 0,disabled:((Ae=e.disabledRows)==null?void 0:Ae.call(e,S))===!0}}if(p===ue){if(F)return Jn;const et=uo(S);if(et===void 0)return Jn;let Tt;return Vt?Tt=rn==="checkbox-visible"?"checkbox-visible":"checkbox":rn==="clickable-number"?Tt="number":Tt=rn,{kind:Bt.Marker,allowOverlay:!1,checkboxStyle:Kn,checked:(be==null?void 0:be.rows.hasIndex(S))===!0,markerKind:Tt,row:Do+et,drawHandle:vn!==void 0,cursor:Vt?void 0:rn==="clickable-number"?"pointer":void 0,disabled:((We=e.disabledRows)==null?void 0:We.call(e,S))===!0}}if(p===me){if(F)return Jn;const et=bn==null?void 0:bn(S);return{kind:Bt.RowStatus,allowOverlay:!1,status:et,themeOverride:Po}}if(p===Me){if(F)return Jn;const et=Gn==null?void 0:Gn(S);return{kind:Bt.RowId,allowOverlay:!1,rowId:et,themeOverride:zo}}if(F){const Tt=p===T?(he==null?void 0:he.hint)??"":"",wt=il.current[p];if(((ot=wt==null?void 0:wt.trailingRowOptions)==null?void 0:ot.disabled)===!0)return Jn;{const dn=((tt=wt==null?void 0:wt.trailingRowOptions)==null?void 0:tt.hint)??Tt,Rn=((Qe=wt==null?void 0:wt.trailingRowOptions)==null?void 0:Qe.addIcon)??(he==null?void 0:he.addIcon);return{kind:Bt.NewRow,hint:dn,allowOverlay:!1,icon:Rn}}}else{const et=p-T;if($||(ht==null?void 0:ht.strict)===!0){const wt=Vn.current,dn=wt.x>et||et>wt.x+wt.width||wt.y>S||S>wt.y+wt.height||S>=fi.current,Rn=et===((it=(Re=wt.extras)==null?void 0:Re.selected)==null?void 0:it[0])&&S===((rt=wt.extras)==null?void 0:rt.selected[1]);let En=!1;if(((Ue=wt.extras)==null?void 0:Ue.freezeRegions)!==void 0){for(const qn of wt.extras.freezeRegions)if(to(qn,et,S)){En=!0;break}}if(dn&&!Rn&&!En)return Jn}let Tt=L([et,S]);return T!==0&&Tt.span!==void 0&&(Tt={...Tt,span:[Tt.span[0]+T,Tt.span[1]+T]}),Tt}},[Ce,Kt,Te,bn,Po,Oe,Gn,zo,ye,uo,Kn,be==null?void 0:be.rows,rn,Do,vn,T,he==null?void 0:he.hint,he==null?void 0:he.addIcon,ht==null?void 0:ht.strict,L,Vt]),ci=s.useCallback(p=>{let S=(kt==null?void 0:kt(p))??{name:p};return Y!==void 0&&p!==""&&(S={icon:S.icon,name:S.name,overrideTheme:S.overrideTheme,actions:[...S.actions??[],{title:"Rename",icon:"renameIcon",onClick:$=>mi({group:S.name,bounds:$.bounds})}]}),S},[kt,Y]),Rr=s.useCallback(p=>{var me;const[S,$]=p.cell,F=dt[S],q=(F==null?void 0:F.group)!==void 0?(me=ci(F.group))==null?void 0:me.overrideTheme:void 0,le=F==null?void 0:F.themeOverride,ue=Ut==null?void 0:Ut($);i({...p,theme:In(jt,q,le,ue,p.content.themeOverride)})},[Ut,dt,ci,jt]),Os=s.useCallback((p,S,$)=>{var ue,me,Me,Ae,We,ot,tt;if(be.current===void 0)return;const[F,q]=be.current.cell,le=zn([F,q]);if(le.kind!==J.Boolean&&le.allowOverlay){let Qe=le;if($!==void 0)switch(Qe.kind){case J.Number:{const rt=Pa(()=>$==="-"?-0:Number.parseFloat($),0);Qe={...Qe,data:Number.isNaN(rt)?0:rt};break}case J.Text:case J.Markdown:case J.Uri:Qe={...Qe,data:$};break}Rr({target:p,content:Qe,initialValue:$,cell:[F,q],highlight:$===void 0,forceEditMode:$!==void 0,activation:S});const Re=Qe.kind===J.Custom;$!==void 0&&!Re?((ue=m.current)==null||ue.setPosition(p.x,p.y,p.width,p.height),$.length>0&&((me=m.current)==null||me.setValue($)),(Me=m.current)==null||Me.setVisible(!0),w(!0)):Re&&$!==void 0&&((Ae=m.current)==null||Ae.clear(),(We=m.current)==null||We.setVisible(!1),(ot=m.current)==null||ot.blur(),w(!1))}else le.kind===J.Boolean&&S.inputType==="keyboard"&&le.readonly!==!0&&(go([{location:be.current.cell,value:{...le,data:Ui(le.data)}}]),(tt=Zt.current)==null||tt.damage([{cell:be.current.cell}]))},[zn,be,go,Rr]),ll=s.useCallback((p,S)=>{var q;const $=(q=Zt.current)==null?void 0:q.getBounds(p,S);if($===void 0||yt.current===null)return;const F=zn([p,S]);F.allowOverlay&&Rr({target:$,content:F,initialValue:void 0,highlight:!0,cell:[p,S],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[zn,yt,Rr]),Mt=s.useCallback((p,S,$="both",F=0,q=0,le=void 0)=>{if(yt.current!==null){const ue=Zt.current,me=l.current,Me=typeof p!="number"?p.unit==="cell"?p.amount:void 0:p,Ae=typeof S!="number"?S.unit==="cell"?S.amount:void 0:S,We=typeof p!="number"&&p.unit==="px"?p.amount:void 0,ot=typeof S!="number"&&S.unit==="px"?S.amount:void 0;if(ue!==null&&me!==null){let tt={x:0,y:0,width:0,height:0},Qe=0,Re=0;if((Me!==void 0||Ae!==void 0)&&(tt=ue.getBounds((Me??0)+T,Ae??0)??tt,tt.width===0||tt.height===0))return;const it=me.getBoundingClientRect(),rt=it.width/me.offsetWidth;if(We!==void 0&&(tt={...tt,x:We-it.left-yt.current.scrollLeft,width:1}),ot!==void 0&&(tt={...tt,y:ot+it.top-yt.current.scrollTop,height:1}),tt!==void 0){const Ue={x:tt.x-F,y:tt.y-q,width:tt.width+2*F,height:tt.height+2*q};let et=0;for(let Ci=0;Ci<Be;Ci++)et+=yn[Ci].width;let Tt=0;const wt=Ze+(je?1:0);wt>0&&(Tt=ko(Kt,wt,ln));let dn=et*rt+it.left+It*rt,Rn=it.right,En=it.top+nr*rt,qn=it.bottom-Tt*rt;const zr=tt.width+F*2;switch(le==null?void 0:le.hAlign){case"start":Rn=dn+zr;break;case"end":dn=Rn-zr;break;case"center":dn=Math.floor((dn+Rn)/2)-zr/2,Rn=dn+zr;break}const Lr=tt.height+q*2;switch(le==null?void 0:le.vAlign){case"start":qn=En+Lr;break;case"end":En=qn-Lr;break;case"center":En=Math.floor((En+qn)/2)-Lr/2,qn=En+Lr;break}dn>Ue.x?Qe=Ue.x-dn:Rn<Ue.x+Ue.width&&(Qe=Ue.x+Ue.width-Rn),En>Ue.y?Re=Ue.y-En:qn<Ue.y+Ue.height&&(Re=Ue.y+Ue.height-qn),$==="vertical"||typeof p=="number"&&p<Be?Qe=0:($==="horizontal"||typeof S=="number"&&S>=Kt-wt)&&(Re=0),(Qe!==0||Re!==0)&&(rt!==1&&(Qe/=rt,Re/=rt),yt.current.scrollTo({left:Qe+yt.current.scrollLeft,top:Re+yt.current.scrollTop,behavior:(le==null?void 0:le.behavior)??"auto"}))}}}},[T,Ze,de,yt,nr,Be,yn,Kt,je,ln]),Er=s.useRef(Mt);Er.current=Mt;const di=s.useRef(ll),ui=s.useRef(L);di.current=ll,ui.current=L;const fi=s.useRef(_e);fi.current=_e;const sl=s.useRef(dt.length);sl.current=dt.length;const mo=s.useCallback(async(p,S=!0,$)=>{var Ae;const F=dt[p];if(((Ae=F==null?void 0:F.trailingRowOptions)==null?void 0:Ae.disabled)===!0)return;const q=O==null?void 0:O();let le,ue=!0;q!==void 0&&(le=await q,le==="top"&&(ue=!1),typeof le=="number"&&(ue=!1));let me=0;const Me=()=>{if(fi.current<=_e){me<500&&window.setTimeout(Me,me),me=50+me*2;return}const We=typeof le=="number"?le:ue?_e:0;Er.current(p-T,We,"both",0,20,$?{behavior:$}:void 0),Lt({cell:[p,We],range:{x:p,y:We,width:1,height:1}},!1,!1,"edit");const ot=ui.current([p-T,We]);ot.allowOverlay&&no(ot)&&ot.readonly!==!0&&S&&window.setTimeout(()=>{di.current(p,We)},0)};Me()},[dt,O,T,_e,Lt]),Ir=s.useCallback(async(p,S=!0)=>{const $=ie==null?void 0:ie();let F,q=!0;$!==void 0&&(F=await $,F==="left"&&(q=!1),typeof F=="number"&&(q=!1));let le=0;const ue=()=>{if(sl.current<=dt.length){le<500&&window.setTimeout(ue,le),le=50+le*2;return}const me=typeof F=="number"?F:q?dt.length:0;Mt(me-T,p),Lt({cell:[me,p],range:{x:me,y:p,width:1,height:1}},!1,!1,"edit");const Me=ui.current([me-T,p]);Me.allowOverlay&&no(Me)&&Me.readonly!==!0&&S&&window.setTimeout(()=>{di.current(me,p)},0)};ue()},[dt,ie,T,Mt,Lt]),rr=s.useCallback(p=>{var $,F;const S=((F=($=yn[p])==null?void 0:$.trailingRowOptions)==null?void 0:F.targetColumn)??(he==null?void 0:he.targetColumn);if(typeof S=="number")return S+(ye?1:0);if(typeof S=="object"){const q=E.indexOf(S);if(q>=0)return q+(ye?1:0)}},[yn,E,ye,he==null?void 0:he.targetColumn]),Un=s.useRef(void 0),Wo=s.useRef(void 0),Hr=s.useCallback((p,S)=>{var q;const[$,F]=S;return In(jt,(q=dt[$])==null?void 0:q.themeOverride,Ut==null?void 0:Ut(F),p.themeOverride)},[Ut,dt,jt]),{mapper:ir}=vu(Ft,M),hi=Ft==null?void 0:Ft.navigationBehavior,Dr=s.useRef(void 0),Ns=s.useCallback(p=>{var Ae,We,ot;const S=Zr.value?p.metaKey:p.ctrlKey,$=S&&ge==="multi",[F,q]=p.location,le=be.columns,ue=be.rows,[me,Me]=((Ae=be.current)==null?void 0:Ae.cell)??[];if(p.kind==="cell"){if(Wo.current=void 0,Dr.current=[F,q],F===(Vt?1:0)&&ye){if(Ce===!0&&q===_e||rn==="number"||ge==="none")return;const Re=zn(p.location);if(Re.kind!==Bt.Marker||Re.disabled===!0)return;if(vn!==void 0){const Ue=Sn(Re);un((Ue==null?void 0:Ue.kind)===Bt.Marker);const et=(We=Ue==null?void 0:Ue.onClick)==null?void 0:We.call(Ue,{...p,cell:Re,posX:p.localEventX,posY:p.localEventY,bounds:p.bounds,theme:Hr(Re,p.location),preventDefault:()=>{}});if(et===void 0||et.checked===Re.checked)return}i(void 0),Jt();const it=ue.hasIndex(q),rt=Un.current;if(ge==="multi"&&(p.shiftKey||p.isLongTouch===!0)&&rt!==void 0&&ue.hasIndex(rt)){const Ue=[Math.min(rt,q),Math.max(rt,q)+1];$||ft==="multi"?qt(void 0,Ue,!0):qt(nt.fromSingleSelection(Ue),void 0,$)}else ge==="multi"&&($||p.isTouch||ft==="multi")?it?qt(ue.remove(q),void 0,!0):(qt(void 0,q,!0),Un.current=q):it&&ue.length===1?qt(nt.empty(),void 0,S):(qt(nt.fromSingleSelection(q),void 0,S),Un.current=q)}else if(F>=T&&Ce&&q===_e){const Re=rr(F);mo(Re??F)}else if(me!==F||Me!==q){const Re=zn(p.location),it=Sn(Re);if((it==null?void 0:it.onSelect)!==void 0){let et=!1;if(it.onSelect({...p,cell:Re,posX:p.localEventX,posY:p.localEventY,bounds:p.bounds,preventDefault:()=>et=!0,theme:Hr(Re,p.location)}),et)return}if(hi==="block"&&ir(q).isGroupHeader)return;const rt=je&&q===_e,Ue=je&&be!==void 0&&((ot=be.current)==null?void 0:ot.cell[1])===_e;if((p.shiftKey||p.isLongTouch===!0)&&me!==void 0&&Me!==void 0&&be.current!==void 0&&!Ue){if(rt)return;const et=Math.min(F,me),Tt=Math.max(F,me),wt=Math.min(q,Me),dn=Math.max(q,Me);Lt({...be.current,range:{x:et,y:wt,width:Tt-et+1,height:dn-wt+1}},!0,S,"click"),Un.current=void 0,Jt()}else{const et=be.rows.length>0;Lt({cell:[F,q],range:{x:F,y:q,width:1,height:1}},!0,S||et,"click"),Un.current=void 0,i(void 0),Jt()}}}else if(p.kind==="header")if(Dr.current=[F,q],i(void 0),ye&&F===(Vt?1:0))Un.current=void 0,Wo.current=void 0,!Ao&&ge==="multi"&&(ue.length!==_e?qt(nt.fromSingleSelection([0,_e]),void 0,S):qt(nt.empty(),void 0,S),Jt());else{const Qe=Wo.current;if(ae==="multi"&&(p.shiftKey||p.isLongTouch===!0)&&Qe!==void 0&&le.hasIndex(Qe)){const Re=[Math.min(Qe,F),Math.max(Qe,F)+1];S||p.isTouch||Dt==="multi"?cn(void 0,Re,S):cn(nt.fromSingleSelection(Re),void 0,S)}else ae==="multi"&&(S||p.isTouch||Dt==="multi")?(le.hasIndex(F)?cn(le.remove(F),void 0,S):cn(void 0,F,S),Wo.current=F):ae!=="none"&&(le.hasIndex(F)?cn(le.remove(F),void 0,S):cn(nt.fromSingleSelection(F),void 0,S),Wo.current=F);Un.current=void 0,Jt()}else p.kind===kn?Dr.current=[F,q]:p.kind===Ur&&!p.isMaybeScrollbar&&(Ot(Ri,!1),i(void 0),Jt(),en==null||en(),Un.current=void 0,Wo.current=void 0)},[ge,ae,be,ye,T,Ce,Vt,_e,rn,zn,vn,Jt,ft,Dt,Sn,Hr,qt,rr,mo,hi,ir,je,Lt,Ao,cn,Ot,en]),Fr={gridSelection:be,overlay:r,gridRef:Zt,ghostInputRef:m,overlayRef:k,ghostInputVisibleRef:C,scrollRef:yt,canvasRef:l,visibleRegionRef:Vn,abortControllerRef:$t,rowMarkerOffset:T,mangledCols:dt,mangledRows:Kt,rows:_e,setGridSelection:Ot,getMangledCellContent:zn,mangledOnCellsEdited:go,setOverlay:i,focus:Jt,setGhostInputVisible:w,reselect:Os,getCellRenderer:Sn},{onMouseDown:$s,onMouseUp:Gs,onMouseMoveImpl:Xs,normalSizeColumn:al,fillDown:Ks,fillRight:Ys,mouseDownData:Ln,isActivelyDraggingHeader:_s}=Hu({state:Fr,mouseState:c,setMouseState:u,fillHighlightRegion:or,setFillHighlightRegion:rl,setScrollDir:g,handleSelect:Ns,onMouseMove:ke,onCellClicked:I,onCellActivated:D,onCellContextMenu:ce,onHeaderContextMenu:se,onGroupHeaderContextMenu:X,onHeaderClicked:U,onGroupHeaderClicked:fe,onColumnResize:Pn,onFillPattern:R,cellActivationBehavior:Ne,columnSelect:ae,columnSelectionMode:Dt,columns:yn,groupLevels:Lo,mergedTheme:jt,minColumnWidth:ao,maxColumnWidth:er,themeForCell:Hr,getCellsForSelection:zt,setSelectedColumns:cn,visibleRegion:ho,lastMouseSelectLocation:Dr}),[gi,mi]=s.useState(),Vs=s.useCallback((p,S)=>{pt==null||pt(p-T,S)},[pt,T]),Us=s.useCallback((p,S)=>{At==null||At(p-T,S)},[At,T]);s.useEffect(()=>{if(r===void 0)return;const p=F=>{const q=[];let le=F.parentElement;for(;le&&le!==document.documentElement;){const ue=window.getComputedStyle(le),me=ue.overflow+ue.overflowY+ue.overflowX;(me.includes("scroll")||me.includes("auto"))&&q.push(le),le=le.parentElement}return q},S=F=>{const q=F.target;yt.current&&!yt.current.contains(q)&&i(void 0)},$=[];if(yt.current){const F=p(yt.current);$.push(...F)}return $.forEach(F=>{F.addEventListener("scroll",S)}),window.addEventListener("scroll",S),document.addEventListener("scroll",S,!0),()=>{$.forEach(F=>{F.removeEventListener("scroll",S)}),window.removeEventListener("scroll",S),document.removeEventListener("scroll",S,!0)}},[r,i,yt]);const Mn=(Cl=be==null?void 0:be.current)==null?void 0:Cl.cell,qs=s.useCallback((p,S,$,F,q,le)=>{if(kr.current=!1,r!==void 0){const We=Vn.current;(We.x!==p.x||We.y!==p.y)&&i(void 0)}let ue=Mn;ue!==void 0&&(ue=[ue[0]-T,ue[1]]);const me=Be===0?void 0:{x:0,y:p.y,width:Be,height:p.height},Me=[];me!==void 0&&Me.push(me),Ze>0&&(Me.push({x:p.x-T,y:_e-Ze,width:p.width,height:Ze}),Be>0&&Me.push({x:0,y:_e-Ze,width:Be,height:Ze}));const Ae={x:p.x-T,y:p.y,width:p.width,height:Ce&&p.y+p.height>=_e?p.height-1:p.height,tx:q,ty:le,extras:{selected:ue,freezeRegion:me,freezeRegions:Me}};Vn.current=Ae,ol(Ae),zs([S,$,F]),mn==null||mn(Ae,Ae.tx,Ae.ty,Ae.extras)},[Mn,r,T,Ce,_e,Be,Ze,i,ol,mn]),js=Qn(G,s.useCallback((p,S)=>(G==null?void 0:G(p-T,S-T))!==!1,[G,T])),Zs=Qn(te,s.useCallback((p,S)=>{te==null||te(p-T,S-T),ae!=="none"&&cn(nt.fromSingleSelection(S),void 0,!0)},[ae,te,T,cn])),wi=s.useRef(!1),Js=s.useCallback(p=>{if(p.location[0]===0&&T>0){p.preventDefault();return}He==null||He({...p,location:[p.location[0]-T,p.location[1]]}),p.defaultPrevented()||(wi.current=!0),u(void 0)},[He,T]),Qs=s.useCallback(()=>{wi.current=!1},[]),cl=Ft==null?void 0:Ft.selectionBehavior,Tr=s.useCallback(p=>{if(cl!=="block-spanning")return;const{isGroupHeader:S,path:$,groupRows:F}=ir(p);if(S)return[p,p];const q=$[$.length-1],le=p-q,ue=p+F-q-1;return[le,ue]},[ir,cl]),pi=s.useRef(void 0),bi=s.useCallback(p=>{var S,$,F;if(!Hs(p,pi.current)&&(pi.current=p,!(((S=Ln==null?void 0:Ln.current)==null?void 0:S.button)!==void 0&&Ln.current.button>=1))){if(p.buttons!==0&&c!==void 0&&(($=Ln.current)==null?void 0:$.location[0])===0&&T===1&&ge==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(Ln.current.location[1])&&be.rows.hasIndex(Ln.current.location[1])){const q=Math.min(Ln.current.location[1],p.location[1]),le=Math.max(Ln.current.location[1],p.location[1])+1;qt(nt.fromSingleSelection([q,le]),void 0,!1)}else if(p.buttons!==0&&c!==void 0&&be.current!==void 0&&!wi.current&&!_s.current&&(ze==="rect"||ze==="multi-rect")){const[q,le]=be.current.cell;let[ue,me]=p.location;if(me<0&&(me=Vn.current.y),c.fillHandle===!0&&((F=c.previousSelection)==null?void 0:F.current)!==void 0){const Me=c.previousSelection.current.range;me=Math.min(me,Ce?_e-1:_e);const Ae=ld(Me,ue,me,Je);rl(Ae)}else{if(Ce&&le===_e)return;if(Ce&&me===_e)if(p.kind===Ur)me--;else return;ue=Math.max(ue,T);const We=Tr(le);me=We===void 0?me:wn(me,We[0],We[1]);const ot=ue-q,tt=me-le,Qe={x:ot>=0?q:ue,y:tt>=0?le:me,width:Math.abs(ot)+1,height:Math.abs(tt)+1};Lt({...be.current,range:Qe},!0,!1,"drag")}}gn==null||gn({...p,location:[p.location[0]-T,p.location[1]]})}},[c,T,ge,be,ze,gn,qt,Ce,_e,Je,Tr,Lt]),ea=s.useCallback(()=>{var ue,me;const p=pi.current;if(p===void 0)return;const[S,$]=p.scrollEdge;let[F,q]=p.location;const le=Vn.current;S===-1?F=((me=(ue=le.extras)==null?void 0:ue.freezeRegion)==null?void 0:me.x)??le.x:S===1&&(F=le.x+le.width),$===-1?q=Math.max(0,le.y):$===1&&(q=Math.min(_e-1,le.y+le.height)),F=wn(F,0,dt.length-1),q=wn(q,0,_e-1),bi({...p,location:[F,q]})},[dt.length,bi,_e]);wu(d,yt,ea);const ta=s.useCallback(p=>{if(be.current===void 0)return;const[S,$]=p,[F,q]=be.current.cell,le=be.current.range;let ue=le.x,me=le.x+le.width,Me=le.y,Ae=le.y+le.height;const[We,ot]=Tr(q)??[0,_e-1],tt=ot+1;if($!==0)switch($){case 2:{Ae=tt,Me=q,Mt(0,Ae,"vertical");break}case-2:{Me=We,Ae=q+1,Mt(0,Me,"vertical");break}case 1:{Me<q?(Me++,Mt(0,Me,"vertical")):(Ae=Math.min(tt,Ae+1),Mt(0,Ae,"vertical"));break}case-1:{Ae>q+1?(Ae--,Mt(0,Ae,"vertical")):(Me=Math.max(We,Me-1),Mt(0,Me,"vertical"));break}default:fr()}if(S!==0)if(S===2)me=dt.length,ue=F,Mt(me-1-T,0,"horizontal");else if(S===-2)ue=T,me=F+1,Mt(ue-T,0,"horizontal");else{let Qe=[];if(zt!==void 0){const Re=zt({x:ue,y:Me,width:me-ue-T,height:Ae-Me},$t.current.signal);typeof Re=="object"&&(Qe=Tu(Re))}if(S===1){let Re=!1;if(ue<F){if(Qe.length>0){const it=bo(ue+1,F+1).find(rt=>!Qe.includes(rt-T));it!==void 0&&(ue=it,Re=!0)}else ue++,Re=!0;Re&&Mt(ue,0,"horizontal")}Re||(me=Math.min(dt.length,me+1),Mt(me-1-T,0,"horizontal"))}else if(S===-1){let Re=!1;if(me>F+1){if(Qe.length>0){const it=bo(me-1,F,-1).find(rt=>!Qe.includes(rt-T));it!==void 0&&(me=it,Re=!0)}else me--,Re=!0;Re&&Mt(me-T,0,"horizontal")}Re||(ue=Math.max(T,ue-1),Mt(ue-T,0,"horizontal"))}else fr()}Lt({cell:be.current.cell,range:{x:ue,y:Me,width:me-ue,height:Ae-Me}},!0,!1,"keyboard-select")},[zt,Tr,be,dt.length,T,_e,Mt,Lt]),yi=s.useRef(qo);yi.current=qo;const wo=s.useCallback((p,S,$,F)=>{const q=Kt-($?0:1);p=wn(p,T,yn.length-1+T),S=wn(S,0,q);const le=Mn==null?void 0:Mn[0],ue=Mn==null?void 0:Mn[1];if(p===le&&S===ue)return!1;if(F&&be.current!==void 0){const me=[...be.current.rangeStack];(be.current.range.width>1||be.current.range.height>1)&&me.push(be.current.range),Ot({...be,current:{cell:[p,S],range:{x:p,y:S,width:1,height:1},rangeStack:me}},!0)}else Lt({cell:[p,S],range:{x:p,y:S,width:1,height:1}},!0,!1,"keyboard-nav");return h.current!==void 0&&h.current[0]===p&&h.current[1]===S&&(h.current=void 0),yi.current&&Mt(p-T,S,"both",0,20),!0},[Kt,T,yn.length,Mn,be,Mt,Ot,Lt]),dl=s.useCallback((p,S)=>{var We,ot,tt,Qe;const $=k.current;C.current;let F=p;const q=((We=m.current)==null?void 0:We.getValue())??"",le=((ot=$==null?void 0:$.content)==null?void 0:ot.kind)===J.Custom;if(($==null?void 0:$.cell)!==void 0&&q.length>0&&$.content!==void 0&&!le){const Re=$.content;if(Re.kind===J.Text)F={...Re,data:q,displayData:q};else if(Re.kind===J.Number){const it=Number.parseFloat(q),rt=Number.isNaN(it)?0:it;F={...Re,data:rt,displayData:rt.toLocaleString()}}else Re.kind===J.Uri?F={...Re,data:q,displayData:q}:Re.kind===J.Markdown&&(F={...Re,data:q})}else le&&(F=p);if(F!==void 0&&q.length===0)if(F.kind===J.Text&&F.data!==F.displayData)F={...F,displayData:F.data};else if(F.kind===J.Number){const Re=F.data!==void 0?F.data.toLocaleString():"0";F.displayData!==Re&&(F={...F,displayData:Re})}else F.kind===J.Uri&&F.data!==F.displayData&&(F={...F,displayData:F.data});const ue=$==null?void 0:$.content,me=()=>{if(F===void 0||ue===void 0)return!1;if(F.kind!==ue.kind)return!0;switch(F.kind){case J.Text:case J.Uri:case J.Markdown:return F.data!==ue.data;case J.Number:return F.data!==ue.data;case J.Boolean:return F.data!==ue.data;default:return!0}};($==null?void 0:$.cell)!==void 0&&F!==void 0&&Wn(F)&&me()&&(go([{location:$.cell,value:F}]),window.requestAnimationFrame(()=>{var Re;(Re=Zt.current)==null||Re.damage([{cell:$.cell}])})),(tt=m.current)==null||tt.clear(),(Qe=m.current)==null||Qe.setVisible(!1),w(!1),Jt(!0),k.current=void 0,i(void 0);const[Me,Ae]=S;if(be.current!==void 0&&(Me!==0||Ae!==0)){const Re=be.current.cell[1]===Kt-1;if(Re&&Ae===1){x==null||x(p,[0,0]);return}const it=be.current.cell[0]===dt.length-1&&p!==void 0;let rt=!0;if(Re&&Ae===1&&O!==void 0){rt=!1;const Ue=be.current.cell[0]+Me,et=rr(Ue);mo(et??Ue,!1)}if(it&&Me===1&&ie!==void 0){rt=!1;const Ue=be.current.cell[1]+Ae;Ir(Ue,!1)}if(rt){const Ue=wn(be.current.cell[0]+Me,T,dt.length-1),et=wn(be.current.cell[1]+Ae,0,Kt-1);wo(Ue,et,Re,!1),window.requestAnimationFrame(()=>{var Tt;(Tt=m.current)==null||Tt.focus()})}}x==null||x(p,S)},[Jt,be,x,go,Kt,wo,dt.length,mo,Ir,O,ie,rr,T]),na=s.useMemo(()=>`gdg-overlay-${Fu++}`,[]),ul=s.useCallback(p=>{var $,F,q,le;Jt();const S=[];for(let ue=p.x;ue<p.x+p.width;ue++)for(let me=p.y;me<p.y+p.height;me++){const Me=L([ue-T,me]);if(!Me.allowOverlay&&Me.kind!==J.Boolean)continue;let Ae;if(Me.kind===J.Custom){const We=Sn(Me),ot=($=We==null?void 0:We.provideEditor)==null?void 0:$.call(We,{...Me,location:[ue-T,me]});(We==null?void 0:We.onDelete)!==void 0?Ae=We.onDelete(Me):es(ot)&&(Ae=(F=ot==null?void 0:ot.deletedValue)==null?void 0:F.call(ot,Me))}else if(Wn(Me)&&Me.allowOverlay||Me.kind===J.Boolean){const We=Sn(Me);Ae=(q=We==null?void 0:We.onDelete)==null?void 0:q.call(We,Me)}Ae!==void 0&&!yo(Ae)&&Wn(Ae)&&S.push({location:[ue,me],value:Ae})}go(S),(le=Zt.current)==null||le.damage(S.map(ue=>({cell:ue.location})))},[Jt,L,Sn,go,T]),oa=r!==void 0,{onKeyDown:Oo}=su({state:Fr,keybindings:xe,overlayOpen:oa,columnSelect:ae,rowSelect:ge,rangeSelect:ze,editOnType:Ie,trapFocus:ei,showTrailingBlankRow:Ce,columnsInLength:E.length,rowGroupingNavBehavior:hi,mapper:ir,onKeyDownIn:Ve,onSelectionCleared:en,onCellActivated:D,onDelete:_n,getCellContent:L,setSelectedColumns:cn,setSelectedRows:qt,setShowSearchInner:at,searchInputRef:a,adjustSelection:ta,updateSelectedCell:wo,deleteRange:ul,fillDown:Ks,fillRight:Ys,appendRow:mo,getCustomNewRowTargetColumn:rr,scrollToRef:Er}),[ra,fl]=s.useState(!1),hl=s.useRef(Jl(p=>{fl(p)},5)),{onGhostInput:ia,onGhostCompositionStart:la,onGhostCompositionEnd:sa,onGhostKeyDown:aa,onGhostKeyUp:ca,onGhostFocus:da,onGhostBlur:ua}=Iu({state:Fr,onKeyDown:Oo,onFinishEditing:dl,onKeyUpIn:Fe,onCellActivated:D,setIsFocused:fl}),fa=s.useCallback((p,S)=>{const $=p.location[0]-T;if(p.kind==="header"&&(se==null||se($,{...p,preventDefault:S})),p.kind===kn){if($<0)return;X==null||X($,{...p,preventDefault:S})}if(p.kind==="cell"){const[F,q]=p.location;ce==null||ce([$,q],{...p,preventDefault:S}),cc(be,p.location)||wo(F,q,!1,!1)}},[be,ce,X,se,T,wo]),{onCopy:gl,onPasteInternal:ml}=pu({state:Fr,keybindings:xe,getCellsForSelection:zt,coercePasteValue:W,onPaste:ut,copyHeaders:lt,columnsIn:E,onDelete:_n,deleteRange:ul,safeWindow:b}),ha=s.useCallback((p,S)=>{if(De!==void 0){T!==0&&(p=p.map(q=>[q[0]-T,q[1]])),De(p,S);return}if(p.length===0||S===-1)return;const[$,F]=p[S];h.current!==void 0&&h.current[0]===$&&h.current[1]===F||(h.current=[$,F],wo($,F,!1,!1))},[De,T,wo]),[Ar,Pr]=((kl=qe==null?void 0:qe.current)==null?void 0:kl.cell)??[];s.useLayoutEffect(()=>{var p,S,$,F;yi.current&&!kr.current&&Ar!==void 0&&Pr!==void 0&&(Ar!==((S=(p=sn.current)==null?void 0:p.current)==null?void 0:S.cell[0])||Pr!==((F=($=sn.current)==null?void 0:$.current)==null?void 0:F.cell[1]))&&Er.current(Ar,Pr),kr.current=!1},[Ar,Pr]);const wl=be.current!==void 0&&(be.current.cell[0]>=dt.length||be.current.cell[1]>=Kt);s.useLayoutEffect(()=>{wl&&Ot(Ri,!1)},[wl,Ot]);const ga=s.useMemo(()=>Ce===!0&&(he==null?void 0:he.tint)===!0?nt.fromSingleSelection(Kt-1):nt.empty(),[Kt,Ce,he==null?void 0:he.tint]),ma=s.useCallback(p=>typeof st=="boolean"?st:(st==null?void 0:st(p-T))??!0,[T,st]),wa=s.useMemo(()=>{if(gi===void 0||l.current===null)return null;const{bounds:p,group:S}=gi,$=l.current.getBoundingClientRect();return s.createElement(Zd,{bounds:p,group:S,canvasBounds:$,onClose:()=>mi(void 0),onFinish:F=>{mi(void 0),Y==null||Y(S,F)}})},[Y,gi]),pa=Math.min(dt.length,Be+T);s.useImperativeHandle(t,()=>({appendRow:(p,S)=>mo(p+T,S),appendColumn:(p,S)=>Ir(p,S),updateCells:p=>{var S;return T!==0&&(p=p.map($=>({cell:[$.cell[0]+T,$.cell[1]]}))),(S=Zt.current)==null?void 0:S.damage(p)},getBounds:(p,S)=>{var $;if(!((l==null?void 0:l.current)===null||(yt==null?void 0:yt.current)===null)){if(p===void 0&&S===void 0){const F=l.current.getBoundingClientRect(),q=F.width/yt.current.clientWidth;return{x:F.x-yt.current.scrollLeft*q,y:F.y-yt.current.scrollTop*q,width:yt.current.scrollWidth*q,height:yt.current.scrollHeight*q}}return($=Zt.current)==null?void 0:$.getBounds((p??0)+T,S)}},focus:()=>{var p;return(p=Zt.current)==null?void 0:p.focus()},emit:async p=>{switch(p){case"delete":Oo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":Oo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":Oo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await gl(void 0,!0);break;case"paste":await ml();break}},scrollTo:Mt,remeasureColumns:p=>{for(const S of p)al(S+T)},getMouseArgsForPosition:(p,S,$)=>{if((Zt==null?void 0:Zt.current)===null)return;const F=Zt.current.getMouseArgsForPosition(p,S,$);if(F!==void 0)return{...F,location:[F.location[0]-T,F.location[1]]}}}),[mo,Ir,al,yt,gl,Oo,ml,T,Mt]);const[pl,bl]=Mn??[],ba=s.useCallback(p=>{const[S,$]=p;if($===-1){ae!=="none"&&(cn(nt.fromSingleSelection(S),void 0,!1),Jt());return}pl===S&&bl===$||(Lt({cell:p,range:{x:S,y:$,width:1,height:1}},!0,!1,"keyboard-nav"),Mt(S,$))},[ae,Jt,Mt,pl,bl,Lt,cn]),ya=s.useCallback(()=>{hl.current(!0),be.current===void 0&&be.columns.length===0&&be.rows.length===0&&c===void 0&&Lt({cell:[T,vr],range:{x:T,y:vr,width:1,height:1}},!0,!1,"keyboard-select")},[vr,be,c,T,Lt]),Ca=s.useCallback(()=>{hl.current(!1)},[]),[ka,va]=s.useMemo(()=>{let p;const S=(ht==null?void 0:ht.scrollbarWidthOverride)??Di(),$=_e+(Ce?1:0);if(typeof ln=="number")p=nr+$*ln;else{let q=0;const le=Math.min($,10);for(let ue=0;ue<le;ue++)q+=ln(ue);q=Math.floor(q/le),p=nr+$*q}p+=S;const F=dt.reduce((q,le)=>le.width+q,0)+S;return[`${Math.min(1e5,F)}px`,`${Math.min(1e5,p)}px`]},[dt,ht==null?void 0:ht.scrollbarWidthOverride,ln,_e,Ce,nr]),xa=s.useMemo(()=>ss(jt),[jt]);return s.createElement($i.Provider,{value:jt},s.createElement(hu,{style:xa,className:re,inWidth:v??ka,inHeight:P??va},s.createElement(Ud,{fillHandle:On,drawFocusRing:Xn,experimental:ht,fixedShadowX:Fn,fixedShadowY:xo,getRowThemeOverride:Ut,headerIcons:gr,imageWindowLoader:mr,initialSize:So,isDraggable:Mo,onDragLeave:Ro,onRowMoved:vn,overscrollX:j,overscrollY:Se,preventDiagonalScrolling:Jr,rightElement:wr,rightElementProps:Qr,smoothScrollX:Tn,smoothScrollY:$n,className:re,enableGroups:Qi,onCanvasFocused:ya,onCanvasBlur:Ca,canvasRef:l,onContextMenu:fa,theme:jt,cellXOffset:Bs,cellYOffset:vr,accessibilityHeight:ho.height,onDragEnd:Qs,columns:dt,nonGrowWidth:Ji,drawHeader:Yn,onColumnProposeMove:js,drawCell:Cr,disabledRows:ga,freezeColumns:pa,lockColumns:T,firstColAccessible:T===0,getCellContent:zn,minColumnWidth:ao,maxColumnWidth:er,searchInputRef:a,showSearch:mt,onSearchClose:Ht,highlightRegions:Ws,getCellsForSelection:zt,getGroupDetails:ci,headerHeight:yr,isFocused:ra,groupHeaderHeight:Qi?tr:0,groupLevels:Lo,groupHeaderHeights:el,freezeTrailingRows:Ze+(Ce&&(he==null?void 0:he.sticky)===!0?1:0),hasAppendRow:Ce,onColumnResize:Pn,onColumnResizeEnd:an,onColumnResizeStart:fo,onCellFocused:ba,onColumnMoved:Zs,onDragStart:Js,onHeaderMenuClick:Vs,onHeaderIndicatorClick:Us,onItemHovered:bi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:Xs,onKeyDown:Oo,onKeyUp:Fe,onMouseDown:$s,onMouseUp:Gs,onDragOverCell:vt,onDrop:_o,onSearchResultsChanged:ha,onVisibleRegionChanged:qs,clientSize:ai,rowHeight:ln,searchResults:N,searchValue:we,onSearchValueChange:ee,rows:Kt,scrollRef:yt,selection:be,translateX:ho.tx,translateY:ho.ty,verticalBorder:ma,gridRef:Zt,getCellRenderer:Sn,resizeIndicator:Uo}),wa,r!==void 0&&s.createElement(s.Suspense,{fallback:null},s.createElement(Du,{...r,validateCell:ct,bloom:ne,id:na,getCellRenderer:Sn,className:(ht==null?void 0:ht.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Dn,imageEditorOverride:y,portalElementRef:An,onFinishEditing:dl,markdownDivCreateNode:A,isOutsideClick:ji,customEventTarget:ht==null?void 0:ht.eventTarget,isGhostMode:f}))),(()=>{const p=(An==null?void 0:An.current)??document.getElementById("portal");return p===null?null:Zl.createPortal(s.createElement(Eu,{ref:m,onInput:ia,onCompositionStart:la,onCompositionEnd:sa,onKeyDown:aa,onKeyUp:ca,onFocus:da,onBlur:ua}),p)})())},Pu=s.forwardRef(Au);function Vl(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:l,x:c,y:u}=r,d=t.maxSize??i.checkboxMaxSize,g=Math.floor(r.y+l/2),h=os(d,l,i.cellVerticalPadding),m=ns(t.contentAlign??"center",c,a,i.cellHorizontalPadding,h),f=ts(m,g,h),w=rs(c+n,u+o,f);return Wi(t)&&w}const zu={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:J.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Lu(e,e.cell.data,Wi(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Vl(e)&&e.preventDefault()},onClick:e=>{if(Vl(e))return{...e.cell,data:Ui(e.cell.data)}},onPaste:(e,t)=>{let n=Gr;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Bi),n===t.data?void 0:{...t,data:n}}};function Lu(e,t,n,o,r){if(!n&&t===Gr)return;const{ctx:i,hoverAmount:a,theme:l,rect:c,highlighted:u,hoverX:d,hoverY:g,cell:{contentAlign:h}}=e,{x:m,y:f,width:w,height:C}=c;let k=!1;if(r>0){let b=n?1-r+r*a:.4;if(t===Gr&&(b*=a),b===0)return;b<1&&(k=!0,i.globalAlpha=b)}_r(i,l,t,m,f,w,C,u,d,g,o,h),k&&(i.globalAlpha=1)}const Bu=_t("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Wu=e=>{const{bubbles:t}=e,{isGhostMode:n}=s.useContext(Yo);return s.createElement(Bu,null,t.map((o,r)=>s.createElement("div",{key:r,className:"boe-bubble"},o)),s.createElement("textarea",{className:"gdg-input",autoFocus:!n}))},Ou={getAccessibilityString:e=>is(e.data),kind:J.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Nu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Wu,{bubbles:t.data})},onPaste:()=>{}};function Nu(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:l,width:c,height:u}=n;let d=a+o.cellHorizontalPadding;const g=[];for(const h of t){if(d>a+c)break;const m=vo(h,r,o.baseFontFull).width;g.push({x:d,width:m}),d+=m+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const h of g)Hn(r,h.x,l+(u-o.bubbleHeight)/2,h.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[h,m]of g.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[h],m.x+o.bubblePadding,l+u/2+hn(r,o))}const $u=_t("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Gu=e=>{const{drilldowns:t}=e;return s.createElement($u,null,t.map((n,o)=>s.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&s.createElement("img",{src:n.img}),s.createElement("div",null,n.text))))},Xu={getAccessibilityString:e=>is(e.data.map(t=>t.text)),kind:J.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Yu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return s.createElement(Gu,{drilldowns:t.data})},onPaste:()=>{}},Ei={};function Ku(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,l=4,c=n*r,u=o+i,d=o*3,g=(d+i*2)*r,h=`${e},${t},${r},${n}`;if(Ei[h]!==void 0)return{el:Ei[h],height:c,width:g,middleWidth:l*r,sideWidth:u*r,padding:i*r,dpr:r};const m=document.createElement("canvas"),f=m.getContext("2d");return f===null?null:(m.width=g,m.height=c,f.scale(r,r),Ei[h]=m,f.beginPath(),Hn(f,i,i,d,a,o),f.shadowColor="rgba(24, 25, 34, 0.4)",f.shadowBlur=1,f.fillStyle=e,f.fill(),f.shadowColor="rgba(24, 25, 34, 0.3)",f.shadowOffsetY=1,f.shadowBlur=5,f.fillStyle=e,f.fill(),f.shadowOffsetY=0,f.shadowBlur=0,f.shadowBlur=0,f.beginPath(),Hn(f,i+.5,i+.5,d,a,o),f.strokeStyle=t,f.lineWidth=1,f.stroke(),{el:m,height:c,width:g,sideWidth:u*r,middleWidth:o*r,padding:i*r,dpr:r})}function Yu(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:l}=e,{x:c,width:u}=n,d=o.baseFontFull,g=ps(r,d),h=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),m=Math.floor(n.y+(n.height-h)/2),f=h-10,w=o.bubblePadding,C=o.bubbleMargin;let k=c+o.cellHorizontalPadding;const b=o.roundingRadius??6,y=Ku(o.bgCell,o.drilldownBorder,h,b),H=[];for(const A of t){if(k>c+u)break;const P=vo(A.text,r,d).width;let E=0;A.img!==void 0&&i.loadOrGetImage(A.img,a,l)!==void 0&&(E=f-8+4);const M=P+E+w*2;H.push({x:k,width:M}),k+=M+C}if(y!==null){const{el:A,height:v,middleWidth:P,sideWidth:E,width:M,dpr:L,padding:I}=y,D=E/L,R=I/L;for(const x of H){const W=Math.floor(x.x),V=Math.floor(x.width),oe=V-(D-R)*2;r.imageSmoothingEnabled=!1,r.drawImage(A,0,0,E,v,W-R,m,D,h),oe>0&&r.drawImage(A,E,0,P,v,W+(D-R),m,oe,h),r.drawImage(A,M-E,0,E,v,W+V-(D-R),m,D,h),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[A,v]of H.entries()){const P=t[A];let E=v.x+w;if(P.img!==void 0){const M=i.loadOrGetImage(P.img,a,l);if(M!==void 0){const L=f-8;let I=0,D=0,R=M.width,x=M.height;R>x?(I+=(R-x)/2,R=x):x>R&&(D+=(x-R)/2,x=R),r.beginPath(),Hn(r,E,m+h/2-L/2,L,L,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(M,I,D,R,x,E,m+h/2-L/2,L,L),r.restore(),E+=L+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(P.text,E,m+h/2+hn(r,o))}}const _u={getAccessibilityString:e=>e.data.join(", "),kind:J.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Vu(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??Ka;return s.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Ii=4;function Vu(e,t,n,o){const{rect:r,col:i,row:a,theme:l,ctx:c,imageLoader:u}=e,{x:d,y:g,height:h,width:m}=r,f=h-l.cellVerticalPadding*2,w=[];let C=0;for(let b=0;b<t.length;b++){const y=t[b];if(y.length===0)continue;const H=u.loadOrGetImage(y,i,a);if(H!==void 0){w[b]=H;const A=H.width*(f/H.height);C+=A+Ii}}if(C===0)return;C-=Ii;let k=d+l.cellHorizontalPadding;o==="right"?k=Math.floor(d+m-l.cellHorizontalPadding-C):o==="center"&&(k=Math.floor(d+m/2-C/2));for(const b of w){if(b===void 0)continue;const y=b.width*(f/b.height);n>0&&(c.beginPath(),Hn(c,k,g+l.cellVerticalPadding,y,f,n),c.save(),c.clip()),c.drawImage(b,k,g+l.cellVerticalPadding,y,f),n>0&&c.restore(),k+=y+Ii}}function Uu(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const qu={getAccessibilityString:()=>"",kind:J.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let l=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(l+=Math.round(Uu(n,o)*t.skeletonWidthVariability));const c=a.cellHorizontalPadding;l+c*2>=i.width&&(l=i.width-c*2-1);const u=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);Hn(r,i.x+c,i.y+(i.height-u)/2,l,u,a.roundingRadius??3),r.fillStyle=oo(a.textDark,.1),r.fill()},onPaste:()=>{}},ju=()=>e=>e.targetWidth,Ul=_t("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[ju(),"px"]}}),Zu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:l}=e,{isGhostMode:c}=s.useContext(Yo),u=t.data,d=t.readonly===!0,[g,h]=s.useState(u===""||o),m=s.useCallback(()=>{h(w=>!w)},[]),f=u?"gdg-ml-6":"";return g?s.createElement(Ul,{targetWidth:i.width-20},s.createElement(Gi,{autoFocus:!c,highlight:!1,validatedSelection:l,value:u,onKeyDown:w=>{w.key==="Enter"&&w.stopPropagation()},onChange:n}),s.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${f}`,onClick:()=>a(t)},s.createElement(Ba,null))):s.createElement(Ul,{targetWidth:i.width},s.createElement(_a,{contents:u,createNode:r}),!d&&s.createElement(s.Fragment,null,s.createElement("div",{className:"spacer"}),s.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${f}`,onClick:m},s.createElement(Oi,null))),s.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!c}))},Ju={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:qr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Bn(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:l}=e;return s.createElement(Zu,{onFinish:r,targetRect:o,value:n,validatedSelection:l,onChange:c=>t({...n,data:c.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Qu={getAccessibilityString:e=>e.row.toString(),kind:Bt.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:ef,measure:()=>44,draw:e=>nf(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e;if(n.disabled===!0)return;const{width:i,height:a}=t,l=n.drawHandle?7+(i-7)/2:i/2,c=a/2;if(Math.abs(o-l)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function ef(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=tf,n.textAlign="center",i}function tf(e){const{ctx:t}=e;t.textAlign="start"}function nf(e,t,n,o,r,i,a){if(a){const{ctx:C,rect:k,theme:b}=e,{x:y,y:H,width:A,height:v}=k,P=o==="checkbox"?"checkbox-visible":o;if(P!=="number"&&(C.globalAlpha=n?1:.4,_r(C,b,n,r?y+7:y,H,r?A-7:A,v,!1,-20,-20,b.checkboxMaxSize,"center",i,!0),C.globalAlpha=1),P==="number"||P==="both"&&!n){const E=t.toString(),M=b.markerFontFull,L=y+A/2;C.fillStyle="#cccccc",C.font=M,C.fillText(E,L,H+v/2+hn(C,M))}if(r){C.globalAlpha=.4,C.beginPath();for(const E of[3,6])for(const M of[-5,-1,3])C.rect(y+E,H+v/2+M,2,2);C.fillStyle="#cccccc",C.fill(),C.beginPath(),C.globalAlpha=1}return}const{ctx:l,rect:c,hoverAmount:u,theme:d}=e,{x:g,y:h,width:m,height:f}=c,w=n?1:o==="checkbox-visible"?.6+.4*u:u;if(o!=="number"&&w>0){l.globalAlpha=w;const C=7*(n?u:1);if(_r(l,d,n,r?g+C:g,h,r?m-C:m,f,!0,void 0,void 0,d.checkboxMaxSize,"center",i,a),r){l.globalAlpha=u,l.beginPath();for(const k of[3,6])for(const b of[-5,-1,3])l.rect(g+k,h+f/2+b,2,2);l.fillStyle=d.textLight,l.fill(),l.beginPath()}l.globalAlpha=1}if(o==="number"||o==="both"&&!n){const C=t.toString(),k=d.markerFontFull,b=g+m/2;o==="both"&&u!==0&&(l.globalAlpha=1-u),l.fillStyle=d.textLight,l.font=k,l.fillText(C,b,h+f/2+hn(l,k)),u!==0&&(l.globalAlpha=1)}}const of={getAccessibilityString:()=>"",kind:Bt.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>rf(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function rf(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:l}=e,{x:c,y:u,width:d,height:g}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,u+1,d,g-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const h=t!=="";let m=0;if(n!==void 0){const w=g-8,C=c+8/2,k=u+8/2;l.drawSprite(n,"normal",o,C,k,w,a,h?1:i),m=w}else{m=24;const f=12,w=h?f:i*f,C=h?0:(1-i)*f*.5,k=a.cellHorizontalPadding+4;w>0&&(o.moveTo(c+k+C,u+g/2),o.lineTo(c+k+C+w,u+g/2),o.moveTo(c+k+C+w*.5,u+g/2-w*.5),o.lineTo(c+k+C+w*.5,u+g/2+w*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,m+c+a.cellHorizontalPadding+.5,u+g/2+hn(o,a)),o.beginPath()}function As(e,t,n,o,r,i,a){e.textBaseline="alphabetic";const l=lf(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Hn(e,l.x,l.y,l.width,l.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??oo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function lf(e,t,n,o,r){const i=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+a/2+1,width:t.width-i,height:t.height-a-1};const l=vo(n,e,o.baseFontFull,"alphabetic"),c=t.height-a,u=Math.min(c,l.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-u)/2+1,width:l.width+i*3,height:u-1}}const sf=s.lazy(async()=>await jl(()=>import("./number-overlay-editor-Bj0JZDL1.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),af={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:qr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:a}=e,{hoverEffect:l,displayData:c,hoverEffectTheme:u}=n;l===!0&&t>0&&As(o,r,u,c,i,t,a),Bn(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,onFinishedEditing:o,value:r,validatedSelection:i}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(sf,{highlight:t,disabled:r.readonly===!0,value:r.data,fixedDecimals:r.fixedDecimals,allowNegative:r.allowNegative,thousandSeparator:r.thousandSeparator,decimalSeparator:r.decimalSeparator,validatedSelection:i,onChange:a=>n({...r,data:Number.isNaN(a.floatValue??0)?0:a.floatValue}),onKeyDown:a=>{a.key==="Enter"&&!a.shiftKey?(a.preventDefault(),o(r,[0,1])):a.key==="Tab"?(a.preventDefault(),o(r,[a.shiftKey?-1:1,0])):a.key==="Escape"&&(a.preventDefault(),o(void 0,[0,0]))}}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},cf={getAccessibilityString:()=>"",measure:()=>108,kind:J.Protected,needsHover:!1,needsHoverPosition:!1,draw:df,onPaste:()=>{}};function df(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const l=2.5;let c=r+n.cellHorizontalPadding+l;const u=i+a/2,d=Math.cos(El(30))*l,g=Math.sin(El(30))*l;for(let h=0;h<12;h++)t.moveTo(c,u-l),t.lineTo(c,u+l),t.moveTo(c+d,u-g),t.lineTo(c-d,u+g),t.moveTo(c-d,u-g),t.lineTo(c+d,u+g),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const uf={getAccessibilityString:e=>e.rowId??"",kind:Bt.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>vo(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:r}=e,i=o.rowId;if(!i)return;t.fillStyle=r.textDark,t.font=r.baseFontStyle,t.textAlign="left";const a=n.x+r.cellHorizontalPadding,l=n.y+n.height/2;t.fillText(i,a,l+hn(t,r))},onClick:()=>{},onPaste:()=>{}},ff={getAccessibilityString:e=>e.rowId??"",kind:Bt.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:hf,measure:()=>80,draw:e=>mf(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function hf(e,t){const{ctx:n}=e,o="12px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=gf,n.textAlign="left",r}function gf(e){const{ctx:t}=e;t.textAlign="start"}function mf(e,t){if(!t)return;const{ctx:n,rect:o,theme:r}=e,{x:i,y:a,height:l}=o;n.fillStyle=r.textDark,n.font="12px sans-serif";const c=i+8,u=a+l/2;n.fillText(t,c,u+hn(n,n.font))}const wf={getAccessibilityString:e=>e.status??"",kind:Bt.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:pf,measure:()=>40,draw:e=>yf(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function pf(e,t){const{ctx:n}=e,o="bold 14px sans-serif",r=t??{};return(r==null?void 0:r.font)!==o&&(n.font=o,r.font=o),r.deprep=bf,n.textAlign="center",r}function bf(e){const{ctx:t}=e;t.textAlign="start"}function yf(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:r,y:i,width:a,height:l}=o,c={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=c[t],n.font="bold 14px sans-serif";const u=r+a/2,d=i+l/2;n.fillText(t,u,d+hn(n,n.font))}const Cf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:qr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:l}=e,{displayData:c,contentAlign:u,hoverEffect:d,allowWrapping:g,hoverEffectTheme:h}=t;d===!0&&n>0&&As(r,a,h,c,i,n,l),Bn(e,c,u,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return s.createElement(Gi,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},kf=_t("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),vf=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,{isGhostMode:l}=s.useContext(Yo),[c,u]=s.useState(!r&&(t===""||o)),d=s.useCallback(()=>{u(!0)},[]);return c?s.createElement(Gi,{validatedSelection:i,highlight:!0,autoFocus:!l,value:t,onChange:n}):s.createElement(kf,null,s.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&s.createElement("div",{className:"gdg-edit-icon",onClick:d},s.createElement(Oi,null)),s.createElement("textarea",{className:"gdg-input",autoFocus:!l}))};function Ps(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,l=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:l}}function ql(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const l=ms(a,i.baseFontFull);if(l===void 0)return!1;const c=Ps(l,n,i,t.contentAlign);return to({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const xf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:J.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:qr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:l}=e,c=t.displayData??t.data,u=t.hoverEffect===!0;if(o!==void 0&&u&&r!==void 0&&i!==void 0){const d=vo(c,l,n.baseFontFull),g=Ps(d,a,n,t.contentAlign),{x:h,y:m,width:f,height:w}=g;if(r>=h-4&&r<=h-4+f+8&&i>=m-4&&i<=m-4+w+8){const C=hn(l,n.baseFontFull);o("pointer");const k=5,b=m-C;l.beginPath(),l.moveTo(a.x+h,Math.floor(a.y+b+w+k)+.5),l.lineTo(a.x+h+f,Math.floor(a.y+b+w+k)+.5),l.strokeStyle=n.linkColor,l.stroke(),l.save(),l.fillStyle=e.cellFillColor,Bn({...e,rect:{...a,x:a.x-1}},c,t.contentAlign),Bn({...e,rect:{...a,x:a.x-2}},c,t.contentAlign),Bn({...e,rect:{...a,x:a.x+1}},c,t.contentAlign),Bn({...e,rect:{...a,x:a.x+2}},c,t.contentAlign),l.restore()}}l.fillStyle=u?n.linkColor:n.textDark,Bn(e,c,t.contentAlign)},onSelect:e=>{ql(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;ql(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return s.createElement(vf,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Sf=[Qu,of,wf,ff,zu,Ou,Xu,_u,qu,Ju,af,cf,uf,Cf,xf],Hi=[];class Mf extends ys{constructor(){super(...arguments);$e(this,"imageLoaded",()=>{});$e(this,"loadedLocations",[]);$e(this,"cache",{});$e(this,"sendLoaded",Fa(()=>{this.imageLoaded(new $o(this.loadedLocations)),this.loadedLocations=[]},20));$e(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const l=r.cells[a];if(this.isInWindow(l)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const l=Hi.pop()??new Image;let c=!1;const u={img:void 0,cells:[Cn(o,r)],url:n,cancel:()=>{c||(c=!0,Hi.length<12?Hi.unshift(l):a||(l.src=""))}},d=new Promise(g=>l.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{l.src=n,await d,await l.decode();const g=this.cache[i];if(g!==void 0&&!c){g.img=l;for(const h of g.cells)this.loadedLocations.push(Yi(h));a=!0,this.sendLoaded()}}catch{u.cancel()}}),this.cache[i]=u}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const l=Cn(o,r);return a.cells.includes(l)||a.cells.push(l),a.img}else this.loadImage(n,o,r,i)}}const Rf=(e,t)=>{const n=s.useMemo(()=>({...td,...e.headerIcons}),[e.headerIcons]),o=s.useMemo(()=>e.renderers??Sf,[e.renderers]),r=s.useMemo(()=>e.imageWindowLoader??new Mf,[e.imageWindowLoader]);return s.createElement(Pu,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Of=s.forwardRef(Rf);export{Of as D,J as G,Gi as a,ps as b,fn as c,Wf as d,Lf as e,Pf as f,hn as g,Wn as h,zf as i,Sl as j,Yo as k,vo as m,Xo as p,Hn as r,Bf as u};
