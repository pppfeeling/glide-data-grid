const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-DjS5MuU0.js","./iframe-DXOPYGgQ.js","./preload-helper-C1FmrZbK.js","./index-ngu0pMN8.js","./index-bI8WdHuM.js","./index-D_kXk1yT.js","./throttle-BQcim7ej.js","./flatten-B5nYkQZa.js","./marked.esm-BwtchnN9.js","./throttle--dN168Gr.js","./number-overlay-editor-Db1E5UP0.js","./react-number-format.es-Dx4F3eNY.js"])))=>i.map(i=>d[i]);
var Ca=Object.defineProperty;var xa=(e,t,n)=>t in e?Ca(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Pe=(e,t,n)=>xa(e,typeof t!="symbol"?t+"":t,n);import{s as Wt}from"./index-bI8WdHuM.js";import{r as l,R as at,g as ka}from"./iframe-DXOPYGgQ.js";import{y as Sn}from"./index-D_kXk1yT.js";import{h as Sa,d as ns,j as Ma,_ as Ra,v as Ea,g as Ia,c as ln,r as eo,t as Fa,q as Da,s as Ha,u as Ta,w as Aa,x as za,k as os,y as Ba,z as Pa,A as La,n as Br}from"./throttle-BQcim7ej.js";import{_ as rs}from"./preload-helper-C1FmrZbK.js";import{u as Wa,f as hl}from"./flatten-B5nYkQZa.js";import{d as $a}from"./marked.esm-BwtchnN9.js";import{t as Oa,d as Na}from"./throttle--dN168Gr.js";const Xa=(e,t,n,o)=>{switch(t){case"debounce":return Na(e,n,o);case"throttle":return Oa(e,n,o);default:return e}},Ga=e=>{const t=l.useRef(e);return l.useEffect(()=>{t.current=e}),l.useMemo(()=>(...n)=>{var o;return(o=t.current)===null||o===void 0?void 0:o.call(t,...n)},[])},_a=e=>{const[t,n]=l.useState((e==null?void 0:e.current)||null);return e&&setTimeout(()=>{e.current!==t&&n(e.current)},0),{refProxy:l.useMemo(()=>new Proxy(r=>{r!==t&&n(r)},{get(r,i){return i==="current"?t:r[i]},set(r,i,a){return i==="current"?n(a):r[i]=a,!0}}),[t]),refElement:t,setRefElement:n}},Ua=(e,t)=>{var n,o;const r=(n=e.borderBoxSize)===null||n===void 0?void 0:n[0],i=(o=e.contentBoxSize)===null||o===void 0?void 0:o[0];return t==="border-box"&&r?{width:r.inlineSize,height:r.blockSize}:t==="content-box"&&i?{width:i.inlineSize,height:i.blockSize}:{width:e.contentRect.width,height:e.contentRect.height}};function Ya({skipOnMount:e=!1,refreshMode:t,refreshRate:n=1e3,refreshOptions:o,handleWidth:r=!0,handleHeight:i=!0,targetRef:a,observerOptions:s,onResize:c,disableRerender:f=!1}={}){const u=l.useRef(e),g=Ga(c),[w,m]=l.useState({width:void 0,height:void 0}),h=l.useRef({width:void 0,height:void 0}),{refProxy:p,refElement:x}=_a(a),{box:y}=s||{},b=l.useCallback(T=>{if(!r&&!i)return;if(u.current){u.current=!1;return}const A=(E,D)=>r&&E.width!==D.width||i&&E.height!==D.height;T.forEach(E=>{const D=Ua(E,y);f?A(h.current,D)&&(h.current.width=D.width,h.current.height=D.height,g==null||g({width:D.width,height:D.height,entry:E})):m(_=>A(_,D)?(g==null||g({width:D.width,height:D.height,entry:E}),D):_)})},[r,i,u,y,f]),k=l.useCallback(Xa(b,t,n,o),[b,t,n,o]);return l.useEffect(()=>{let T;if(x)try{T=new window.ResizeObserver(k),T.observe(x,s)}catch(A){console.warn("ResizeObserver not supported or failed to initialize:",A)}else(w.width||w.height)&&(g==null||g({width:null,height:null,entry:null}),h.current.width=void 0,h.current.height=void 0,f||m({width:void 0,height:void 0}));return()=>{var A,E,D;(A=T==null?void 0:T.disconnect)===null||A===void 0||A.call(T),(D=(E=k).cancel)===null||D===void 0||D.call(E)}},[k,x]),Object.assign({ref:p},f?h.current:w)}function is(e="This should not happen"){throw new Error(e)}function Qt(e,t="Assertion failed"){if(!e)return is(t)}function ur(e,t){return is(t??"Hell froze over")}function Ka(e,t){try{return e()}catch{return t}}const gl=Object.prototype.hasOwnProperty;function Uo(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Uo(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(gl.call(e,n)&&++o&&!gl.call(t,n)||!(n in t)||!Uo(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const _r=null,Oi=void 0;var U;(function(e){e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom"})(U||(U={}));var Pn;(function(e){e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay"})(Pn||(Pn={}));var Ur;(function(e){e.Triangle="triangle",e.Dots="dots"})(Ur||(Ur={}));function Pr(e){return"width"in e&&typeof e.width=="number"}async function ml(e){return typeof e=="object"?e:await e()}function to(e){return!(e.kind===U.Loading||e.kind===U.Bubble||e.kind===U.RowID||e.kind===U.Protected||e.kind===U.Drilldown)}function Va(e){return!(e.kind===U.Loading||e.kind===U.Bubble||e.kind===U.RowID||e.kind===U.Protected||e.kind===U.Drilldown||e.kind===U.Boolean||e.kind===U.Image||e.kind===U.Custom)}function No(e){return e.kind===sn.Marker||e.kind===sn.NewRow}function Oo(e){if(!to(e)||e.kind===U.Image)return!1;switch(e.kind){case U.Text:case U.Number:case U.Markdown:case U.Uri:case U.Custom:case U.Boolean:return e.readonly!==!0;default:ur(e,"A cell was passed with an invalid kind")}}function qa(e){return Sa(e,"editor")}function Ni(e){return!(e.readonly??!1)}var sn;(function(e){e.NewRow="new-row",e.Marker="marker"})(sn||(sn={}));const Yr={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Si(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,r){return o[0]-r[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const r=n[n.length-1];r[1]<o[0]?n.push([...o]):r[1]<o[1]&&(r[1]=o[1])}return n}let pl;const qt=class qt{constructor(t){Pe(this,"items");this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new qt(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Si([...this.items,n]);return new qt(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],r=typeof t=="number"?t+1:t[1];for(const[i,a]of n.entries()){const[s,c]=a;if(s<=r&&o<=c){const f=[];s<o&&f.push([s,o]),r<c&&f.push([r,c]),n.splice(i,1,...f)}}return new qt(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,r]=this.items[n];if(t>=o&&t<r)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],r=this.items[n];if(o[0]!==r[0]||o[1]!==r[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let r=n;r<o;r++)t.push(r);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Pe(qt,"create",t=>new qt(Si(t))),Pe(qt,"empty",()=>pl??(pl=new qt([]))),Pe(qt,"fromSingleSelection",t=>qt.empty().add(t)),Pe(qt,"fromArray",t=>{if(t.length===0)return qt.empty();const n=t.map(r=>[r,r+1]),o=Si(n);return new qt(o)});let st=qt;const ja=Wt("div")({name:"ImageOverlayEditorStyle",class:"gdg-i2iowwq",propsAsIs:!1});function Ut(e,t,n,o,r=!1){const i=l.useRef();i.current=t,l.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const a=n,s=c=>{var f;(f=i.current)==null||f.call(a,c)};return a.addEventListener(e,s,{passive:o,capture:r}),()=>{a.removeEventListener(e,s,{capture:r})}},[e,n,o,r])}function Jn(e,t){return e===void 0?void 0:t}const Za=Math.PI;function wl(e){return e*Za/180}const ls=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ss=(e,t,n,o,r)=>{switch(e){case"left":return Math.floor(t)+o+r/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-r/2}},as=(e,t,n)=>Math.min(e,t-n*2),cs=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,Xi=e=>{const t=e.fgColor??"currentColor";return l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),l.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},Ja=e=>{const t=e.fgColor??"currentColor";return l.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function Qa(e,t,n){const[o,r]=l.useState(e),i=l.useRef(!0);l.useEffect(()=>()=>{i.current=!1},[]);const a=l.useRef(ns(s=>{i.current&&r(s)},n));return l.useLayoutEffect(()=>{i.current&&a.current(()=>e())},t),o}const ec="֑-߿יִ-﷽ﹰ-ﻼ",tc="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",nc=new RegExp("^[^"+tc+"]*["+ec+"]");function Gi(e){return nc.test(e)?"rtl":"not-rtl"}let Lr;function Ai(){if(typeof document>"u")return 0;if(Lr!==void 0)return Lr;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Lr=n-o,Lr}const go=Symbol();function oc(e){const t=l.useRef([go,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=l.useState(e),[,r]=l.useState(),i=l.useCallback(s=>{const c=t.current[0];c!==go&&(s=typeof s=="function"?s(c):s,s===c)||(c!==go&&r({}),o(f=>typeof s=="function"?s(c===go?f:c):s),t.current[0]=go)},[]),a=l.useCallback(()=>{t.current[0]=go,r({})},[]);return[t.current[0]===go?n:t.current[0],i,a]}function ds(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function rc(e){const t=l.useRef(e);return Uo(e,t.current)||(t.current=e),t.current}const ic=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:r}=e,i=t.filter(s=>s!=="");if(i.length===0)return null;const a=i.length>1;return l.createElement(ja,{"data-testid":"GDG-default-image-overlay-editor"},l.createElement(Ma.Carousel,{showArrows:a,showThumbs:!1,swipeable:a,emulateTouch:a,infiniteLoop:a},i.map(s=>{const c=(r==null?void 0:r(s))??l.createElement("img",{draggable:!1,src:s});return l.createElement("div",{className:"gdg-centering-container",key:s},c)})),n&&o&&l.createElement("button",{className:"gdg-edit-icon",onClick:o},l.createElement(Xi,null)))},lc=Wt("div")({name:"MarkdownContainer",class:"gdg-mnuv029",propsAsIs:!1});class sc extends at.PureComponent{constructor(){super(...arguments);Pe(this,"targetElement",null);Pe(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:r,createNode:i}=o,a=$a(r),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let c=i==null?void 0:i(a);if(c===void 0){const u=document.createElement("template");u.innerHTML=a,c=u.content}n.append(c);const f=n.getElementsByTagName("a");for(const u of f)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),at.createElement(lc,{ref:this.containerRefHook})}}const ac=Wt("textarea")({name:"InputBox",class:"gdg-izpuzkl",propsAsIs:!1}),cc=Wt("div")({name:"ShadowBox",class:"gdg-s69h75o",propsAsIs:!1}),dc=Wt("div")({name:"GrowingEntryStyle",class:"gdg-g1y0xocz",propsAsIs:!1});let bl=0;const jr=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:r,altNewline:i,validatedSelection:a,...s}=e,{onChange:c,className:f}=s,u=l.useRef(null),g=n??"";Qt(c!==void 0,"GrowingEntry must be a controlled input area");const[w]=l.useState(()=>"input-box-"+(bl=(bl+1)%1e7));l.useEffect(()=>{const h=u.current;if(h===null||h.disabled)return;const p=g.toString().length;h.focus(),h.setSelectionRange(r?0:p,p)},[]),l.useLayoutEffect(()=>{var h;if(a!==void 0){const p=typeof a=="number"?[a,null]:a;(h=u.current)==null||h.setSelectionRange(p[0],p[1])}},[a]);const m=l.useCallback(h=>{h.key==="Enter"&&h.shiftKey&&i===!0||o==null||o(h)},[i,o]);return l.createElement(dc,{className:"gdg-growing-entry"},l.createElement(cc,{className:f},g+`
`),l.createElement(ac,{...s,className:(f??"")+" gdg-input",id:w,ref:u,onKeyDown:m,value:g,placeholder:t,dir:"auto"}))},Mi={};let jn=null;function uc(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function zi(e){const t=e.toLowerCase().trim();if(Mi[t]!==void 0)return Mi[t];jn=jn||uc(),jn.style.color="#000",jn.style.color=t;const n=getComputedStyle(jn).color;jn.style.color="#fff",jn.style.color=t;const o=getComputedStyle(jn).color;if(o!==n)return[0,0,0,1];let r=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return r.length<4&&r.push(1),r=r.map(i=>Number.isNaN(i)?0:i),Mi[t]=r,r}function wo(e,t){const[n,o,r]=zi(e);return`rgba(${n}, ${o}, ${r}, ${t})`}const yl=new Map;function vl(e,t){const n=`${e}-${t}`,o=yl.get(n);if(o!==void 0)return o;const r=en(e,t);return yl.set(n,r),r}function en(e,t){if(t===void 0)return e;const[n,o,r,i]=zi(e);if(i===1)return e;const[a,s,c,f]=zi(t),u=i+f*(1-i),g=(i*n+f*a*(1-i))/u,w=(i*o+f*s*(1-i))/u,m=(i*r+f*c*(1-i))/u;return`rgba(${g}, ${w}, ${m}, ${u})`}function fc(e,t){return at.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled})),[e,t])}function hc(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(sr(e.current.cell,t))return!0;const r=[e.current.range,...e.current.rangeStack];for(const i of r)if(n>=i.x&&n<i.x+i.width&&o>=i.y&&o<i.y+i.height)return!0}return!1}function fr(e,t){return(e??"")===(t??"")}function gc(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function us(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function sr(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function fs(e){return[e.x+e.width-1,e.y+e.height-1]}function Cl(e,t,n){const o=n.x,r=n.x+n.width-1,i=n.y,a=n.y+n.height-1,[s,c]=e;if(c<i||c>a)return!1;if(t.span===void 0)return s>=o&&s<=r;const[f,u]=t.span;return f>=o&&f<=r||u>=o&&f<=r||f<o&&u>r}function mc(e,t,n,o){let r=0;if(n.current===void 0)return r;const i=n.current.range;(o||i.height*i.width>1)&&Cl(e,t,i)&&r++;for(const a of n.current.rangeStack)Cl(e,t,a)&&r++;return r}function hs(e,t){let n=e;if(t!==void 0){let o=[...e];const r=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,r)):(o.splice(t.dest+1,0,r),o.splice(t.src,1)),o=o.map((i,a)=>({...i,sticky:e[a].sticky})),n=o}return n}function Yo(e,t){let n=0;const o=hs(e,t);for(let r=0;r<o.length;r++){const i=o[r];if(i.sticky)n+=i.width;else break}return n}function bo(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let r=e-t;r<e;r++)o+=n(r);return o}}function Bi(e,t,n,o,r){const i=hs(e,o),a=[];for(const f of i)if(f.sticky)a.push(f);else break;if(a.length>0)for(const f of a)n-=f.width;let s=t,c=r??0;for(;c<=n&&s<i.length;)c+=i[s].width,s++;for(let f=t;f<s;f++){const u=i[f];u.sticky||a.push(u)}return a}function pc(e,t,n){let o=0;for(const r of t){const i=r.sticky?o:o+(n??0);if(e<=i+r.width)return r.sourceIndex;o+=r.width}return-1}function wc(e,t,n,o,r,i,a,s,c,f){const u=o+r;if(n&&e<=r)return-2;if(e<=u)return-1;let g=t;for(let h=0;h<f;h++){const p=i-1-h,x=typeof a=="number"?a:a(p);if(g-=x,e>=g)return p}const w=i-f,m=e-(c??0);if(typeof a=="number"){const h=Math.floor((m-u)/a)+s;return h>=w?void 0:h}else{let h=u;for(let p=s;p<w;p++){const x=a(p);if(m<=h+x)return p;h+=x}return}}let Gr=0,ar={};const bc=typeof window>"u";async function yc(){var e;bc||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Gr=0,ar={},Ea())}yc();function gs(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Ko(e,t,n,o="middle"){const r=gs(e,t,o,n);let i=ar[r];return i===void 0&&(i=t.measureText(e),ar[r]=i,Gr++),Gr>1e4&&(ar={},Gr=0),i}function ms(e,t){const n=gs(e,void 0,"middle",t);return ar[n]}function no(e,t){return typeof t!="string"&&(t=t.baseFontFull),vc(e,t)}function xl(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const kl=[];function vc(e,t){for(const i of kl)if(i.key===t)return i.val;const n=xl(e,"alphabetic"),r=-(xl(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return kl.push({key:t,val:r}),r}function Cc(e,t,n,o,r,i){const{ctx:a,rect:s,theme:c}=e;let f=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(f=n-t,f<u)){const g=1-f/u;a.globalAlpha=g,a.fillStyle=c.bgSearchResult,a.fillRect(s.x+1,s.y+1,s.width-(r?2:1),s.height-(i?2:1)),a.globalAlpha=1,o!==void 0&&(o.fillStyle=c.bgSearchResult)}return f<u}function gr(e,t,n){const{ctx:o,theme:r}=e,i=t??{},a=n??r.textDark;return a!==i.fillStyle&&(o.fillStyle=a,i.fillStyle=a),i}function ps(e,t,n,o,r,i,a,s,c){c==="right"?e.fillText(t,n+r-(s.cellHorizontalPadding+.5),o+i/2+a):c==="center"?e.fillText(t,n+r/2,o+i/2+a):e.fillText(t,n+s.cellHorizontalPadding+.5,o+i/2+a)}function ws(e,t){const n=Ko("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function xc(e,t){e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function kc(e,t,n,o,r,i,a,s,c,f){const u=s.baseFontFull,g=Ra(e,t,u,r-s.cellHorizontalPadding*2,f??!1),w=ws(e,u),m=s.lineHeight*w,h=w+m*(g.length-1),p=h+s.cellVerticalPadding>i;p&&(e.save(),e.rect(n,o,r,i),e.clip());const x=o+i/2-h/2;let y=Math.max(o+s.cellVerticalPadding,x);for(const b of g)if(ps(e,b,n,y,r,w,a,s,c),y+=m,y>o+i)break;p&&e.restore()}function Ln(e,t,n,o,r){const{ctx:i,rect:a,theme:s}=e,{x:c,y:f,width:u,height:g}=a;o=o??!1,o||(t=xc(t,u));const w=no(i,s),m=Gi(t)==="rtl";if(n===void 0&&m&&(n="right"),m&&(i.direction="rtl"),t.length>0){let h=!1;n==="right"?(i.textAlign="right",h=!0):n!==void 0&&n!=="left"&&(i.textAlign=n,h=!0),o?kc(i,t,c,f,u,g,w,s,n,r):ps(i,t,c,f,u,g,w,s,n),h&&(i.textAlign="start"),m&&(i.direction="inherit")}}function Mn(e,t,n,o,r,i){typeof i=="number"&&(i={tl:i,tr:i,br:i,bl:i}),i={tl:Math.max(0,Math.min(i.tl,r/2,o/2)),tr:Math.max(0,Math.min(i.tr,r/2,o/2)),bl:Math.max(0,Math.min(i.bl,r/2,o/2)),br:Math.max(0,Math.min(i.br,r/2,o/2))},e.moveTo(t+i.tl,n),e.arcTo(t+o,n,t+o,n+i.tr,i.tr),e.arcTo(t+o,n+r,t+o-i.br,n+r,i.br),e.arcTo(t,n+r,t,n+r-i.bl,i.bl),e.arcTo(t,n,t+i.tl,n,i.tl)}function Sc(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Mc(e,t,n){const o=function(s,c){const f=c.x-s.x,u=c.y-s.y,g=Math.sqrt(f*f+u*u),w=f/g,m=u/g;return{x:f,y:c.y-s.y,len:g,nx:w,ny:m,ang:Math.atan2(m,w)}};let r;const i=t.length;let a=t[i-1];for(let s=0;s<i;s++){let c=t[s%i];const f=t[(s+1)%i],u=o(c,a),g=o(c,f),w=u.nx*g.ny-u.ny*g.nx,m=u.nx*g.nx-u.ny*-g.ny;let h=Math.asin(w<-1?-1:w>1?1:w),p=1,x=!1;m<0?h<0?h=Math.PI+h:(h=Math.PI-h,p=-1,x=!0):h>0&&(p=-1,x=!0),r=c.radius!==void 0?c.radius:n;const y=h/2;let b=Math.abs(Math.cos(y)*r/Math.sin(y)),k;b>Math.min(u.len/2,g.len/2)?(b=Math.min(u.len/2,g.len/2),k=Math.abs(b*Math.sin(y)/Math.cos(y))):k=r;let T=c.x+g.nx*b,A=c.y+g.ny*b;T+=-g.ny*k*p,A+=g.nx*k*p,e.arc(T,A,k,u.ang+Math.PI/2*p,g.ang-Math.PI/2*p,x),a=c,c=f}e.closePath()}function Pi(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h){const p={x:0,y:i+f,width:0,height:0};if(e>=m.length||t>=u||t<-2||e<0)return p;const x=i-r;if(e>=g){const y=a>e?-1:1,b=Yo(m);p.x+=b+c;for(let k=a;k!==e;k+=y)p.x+=m[y===1?k:k-1].width*y}else for(let y=0;y<e;y++)p.x+=m[y].width;if(p.width=m[e].width+1,t===-1)p.y=r,p.height=x;else if(t===-2){p.y=0,p.height=r;let y=e;const b=m[e].group,k=m[e].sticky;for(;y>0&&fr(m[y-1].group,b)&&m[y-1].sticky===k;){const A=m[y-1];p.x-=A.width,p.width+=A.width,y--}let T=e;for(;T+1<m.length&&fr(m[T+1].group,b)&&m[T+1].sticky===k;){const A=m[T+1];p.width+=A.width,T++}if(!k){const A=Yo(m),E=p.x-A;E<0&&(p.x-=E,p.width+=E),p.x+p.width>n&&(p.width=n-p.x)}}else if(t>=u-w){let y=u-t;for(p.y=o;y>0;){const b=t+y-1;p.height=typeof h=="number"?h:h(b),p.y-=p.height,y--}p.height+=1}else{const y=s>t?-1:1;if(typeof h=="number"){const b=t-s;p.y+=b*h}else for(let b=s;b!==t;b+=y)p.y+=h(b)*y;p.height=(typeof h=="number"?h:h(t))+1}return p}const _i=1<<21;function wn(e,t){return(t+2)*_i+e}function bs(e){return e%_i}function Ui(e){return Math.floor(e/_i)-2}function Yi(e){const t=bs(e),n=Ui(e);return[t,n]}class ys{constructor(){Pe(this,"visibleWindow",{x:0,y:0,width:0,height:0});Pe(this,"freezeCols",0);Pe(this,"freezeRows",[]);Pe(this,"isInWindow",t=>{const n=bs(t),o=Ui(t),r=this.visibleWindow,i=n>=r.x&&n<=r.x+r.width||n<this.freezeCols,a=o>=r.y&&o<=r.y+r.height||this.freezeRows.includes(o);return i&&a})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Uo(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Rc extends ys{constructor(){super(...arguments);Pe(this,"cache",new Map);Pe(this,"setValue",(n,o)=>{this.cache.set(wn(n[0],n[1]),o)});Pe(this,"getValue",n=>this.cache.get(wn(n[0],n[1])));Pe(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class cr{constructor(t=[]){Pe(this,"cells");this.cells=new Set(t.map(n=>wn(n[0],n[1])))}add(t){this.cells.add(wn(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(wn(t[0],t[1]))}remove(t){this.cells.delete(wn(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(Ui(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(wn(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield Yi(t)}}function Ec(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const vs={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function Cs(){return vs}const Ic=at.createContext(vs);function Wn(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const r in o)o.hasOwnProperty(r)&&(r==="bgCell"?n[r]=en(o[r],n[r]):n[r]=o[r]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}const Li=150;function Fc(e,t,n,o){var i;const r=o(t);return((i=r==null?void 0:r.measure)==null?void 0:i.call(r,e,t,n))??Li}function xs(e,t,n,o,r,i,a,s,c){let f=0;const u=r===void 0?[]:r.map(m=>{const h=Fc(e,m[o],t,c);return f=Math.max(f,h),h});if(u.length>5&&s){f=0;let m=0;for(const p of u)m+=p;const h=m/u.length;for(let p=0;p<u.length;p++)u[p]>=h*2?u[p]=0:f=Math.max(f,u[p])}const g=e.font;e.font=t.headerFontFull,f=Math.max(f,e.measureText(n.title).width+t.cellHorizontalPadding*2+(n.icon===void 0?0:28)),e.font=g;const w=Math.max(Math.ceil(i),Math.min(Math.floor(a),Math.ceil(f)));return{...n,width:w}}function Dc(e,t,n,o,r,i,a,s,c){const f=l.useRef(t),u=l.useRef(n),g=l.useRef(a);f.current=t,u.current=n,g.current=a;const[w,m]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const b=document.createElement("canvas");return b.style.display="none",b.style.opacity="0",b.style.position="fixed",[b,b.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(w&&document.documentElement.append(w),()=>{w==null||w.remove()}),[w]);const h=l.useRef({}),p=l.useRef(),[x,y]=l.useState();return l.useLayoutEffect(()=>{const b=u.current;if(b===void 0||e.every(Pr))return;let k=Math.max(1,10-Math.floor(e.length/1e4)),T=0;k<f.current&&k>1&&(k--,T=1);const A={x:0,y:0,width:e.length,height:Math.min(f.current,k)},E={x:0,y:f.current-1,width:e.length,height:1};(async()=>{const _=b(A,c.signal),R=T>0?b(E,c.signal):void 0;let $;typeof _=="object"?$=_:$=await ml(_),R!==void 0&&(typeof R=="object"?$=[...$,...R]:$=[...$,...await ml(R)]),p.current=e,y($)})()},[c.signal,e]),l.useMemo(()=>{let k=e.every(Pr)?e:m===null?e.map(D=>Pr(D)?D:{...D,width:Li}):(m.font=g.current.baseFontFull,e.map((D,_)=>{if(Pr(D))return D;if(h.current[D.id]!==void 0)return{...D,width:h.current[D.id]};if(x===void 0||p.current!==e||D.id===void 0)return{...D,width:Li};const R=xs(m,a,D,_,x,r,i,!0,s);return h.current[D.id]=R.width,R})),T=0,A=0;const E=[];for(const[D,_]of k.entries())T+=_.width,_.grow!==void 0&&_.grow>0&&(A+=_.grow,E.push(D));if(T<o&&E.length>0){const D=[...k],_=o-T;let R=_;for(let $=0;$<E.length;$++){const X=E[$],L=(k[X].grow??0)/A,H=$===E.length-1?R:Math.min(R,Math.floor(_*L));D[X]={...k[X],growOffset:H,width:k[X].width+H},R-=H}k=D}return{sizedColumns:k,nonGrowWidth:T}},[o,e,m,x,a,r,i,s])}const vt='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Hc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}<rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${t}"/></svg>`},Tc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}<rect x="2" y="2" width="16" height="16" rx="4" fill="${n}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${t}"/></svg>`},Ac=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${t}"/>
  </svg>`},zc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${t}"/>
</svg>`},Bc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${n}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${t}"
    />
</svg>`},ks=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${t}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${t}"/>
</svg>
  `},Pc=e=>{const t=e.bgColor;return`${vt}
    <path stroke="${t}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${t}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${t}"/>
  </svg>
`},Lc=ks,Wc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${t}"/>
</svg>`},$c=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${t}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${t}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${t}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${t}"/>
  </svg>`},Oc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${t}"/>
</svg>`},Nc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path fill="${t}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${n}"/>
  </svg>`},Xc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${t}"/>
  </svg>`},Gc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${t}"/>
</svg>`},_c=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${t}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${t}"/>
  </svg>`},Uc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${t}"/>
</svg>`},Yc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${n}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${n}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${t}"/>
  </svg>`},Kc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path fill="${t}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${n}"/>
</svg>`},Vc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${t}"/>
  </svg>`},qc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${t}"/>
  </svg>`},jc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${t}"/>
</svg>`},Zc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${t}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${t}"/>
</svg>`},Jc=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${n}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${t}"/>
  </svg>`},Qc=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${t}"/>
</svg>`},ed=e=>{const t=e.fgColor,n=e.bgColor;return`
    ${vt}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${t}"/>
  </svg>`},td=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${n}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${t}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${t}"/>
</svg>`},nd=e=>{const t=e.fgColor,n=e.bgColor;return`${vt}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${n}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${t}"/>
</svg>`},od=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>`},rd=e=>{const t=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${t}" stroke-width="2"/>
  </svg>
`},id={headerRowID:Hc,headerNumber:Ac,headerCode:Tc,headerString:zc,headerBoolean:Bc,headerAudioUri:Lc,headerVideoUri:Wc,headerEmoji:$c,headerImage:Oc,headerUri:ks,headerPhone:Nc,headerMarkdown:Xc,headerDate:Gc,headerTime:_c,headerEmail:Uc,headerReference:Yc,headerIfThenElse:Kc,headerSingleValue:Vc,headerLookup:qc,headerTextTemplate:jc,headerMath:Zc,headerRollup:Jc,headerJoinStrings:Qc,headerSplitString:ed,headerGeoDistance:td,headerArray:nd,rowOwnerOverlay:od,protectedColumnOverlay:rd,renameIcon:Pc};function ld(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class sd{constructor(t,n){Pe(this,"onSettled");Pe(this,"spriteMap",new Map);Pe(this,"headerIcons");Pe(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,r,i,a,s,c=1){const[f,u]=ld(n,s),g=a*Math.ceil(window.devicePixelRatio),w=`${f}_${u}_${g}_${t}`;let m=this.spriteMap.get(w);if(m===void 0){const h=this.headerIcons[t];if(h===void 0)return;m=document.createElement("canvas");const p=m.getContext("2d");if(p===null)return;const x=new Image;x.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(h({fgColor:u,bgColor:f}))}`,this.spriteMap.set(w,m);const y=x.decode();if(y===void 0)return;this.inFlight++,y.then(()=>{p.drawImage(x,0,0,g,g)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else c<1&&(o.globalAlpha=c),o.drawImage(m,0,0,g,g,r,i,a,a),c<1&&(o.globalAlpha=1)}}function Ss(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Zr(e,t,n,o,r,i,a,s,c){s=s??t;let f=t,u=e;const g=o-i;let w=!1;for(;f<n&&u<g;){const m=r(u);if(f+m>s&&c(f,u,m,!1,a&&u===o-1)===!0){w=!0;break}f+=m,u++}if(!w){f=n;for(let m=0;m<i;m++){u=o-1-m;const h=r(u);f-=h,c(f,u,h,!0,a&&u===o-1)}}}function oo(e,t,n,o,r,i){let a=0,s=0;const c=r+o;for(const f of e){const u=f.sticky?s:a+n;if(i(f,u,c,f.sticky?0:s,t)===!0)break;a+=f.width,s+=f.sticky?f.width:0}}function Ms(e,t,n,o,r){let i=0,a=0;for(let s=0;s<e.length;s++){const c=e[s];let f=s+1,u=c.width;for(c.sticky&&(a+=u);f<e.length&&fr(e[f].group,c.group)&&e[f].sticky===e[s].sticky;){const p=e[f];u+=p.width,f++,s++,p.sticky&&(a+=p.width)}const g=c.sticky?0:n,w=i+g,m=c.sticky?0:Math.max(0,a-w),h=Math.min(u-m,t-(w+m));r([c.sourceIndex,e[f-1].sourceIndex],c.group??"",w+m,0,h,o),i+=u}}function Rs(e,t,n,o,r,i,a){var w;const[s,c]=e;let f,u;const g=((w=a.find(m=>!m.sticky))==null?void 0:w.sourceIndex)??0;if(c>g){const m=Math.max(s,g);let h=t,p=o;for(let x=i.sourceIndex-1;x>=m;x--)h-=a[x].width,p+=a[x].width;for(let x=i.sourceIndex+1;x<=c;x++)p+=a[x].width;u={x:h,y:n,width:p,height:r}}if(g>s){const m=Math.min(c,g-1);let h=t,p=o;for(let x=i.sourceIndex-1;x>=s;x--)h-=a[x].width,p+=a[x].width;for(let x=i.sourceIndex+1;x<=m;x++)p+=a[x].width;f={x:h,y:n,width:p,height:r}}return[f,u]}function ad(e,t,n,o){if(o==="any")return Es(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),us([t,n],e))return;const r=t-e.x,i=e.x+e.width-t,a=n-e.y+1,s=e.y+e.height-n,c=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="horizontal"?Number.MAX_SAFE_INTEGER:a,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return c===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:c===a?{x:e.x,y:n,width:e.width,height:e.y-n}:c===i?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function hr(e,t,n,o,r,i,a,s){return e<=r+a&&r<=e+n&&t<=i+s&&i<=t+o}function po(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Es(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),r=Math.max(e.x+e.width,t.x+t.width)-n,i=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:r,height:i}}function cd(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function dd(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const r=-4,i=-4,a=t+4,s=n+4,c=r-e.x,f=e.x+e.width-a,u=i-e.y,g=e.y+e.height-s,w=c>0?e.x+Math.floor(c/o)*o:e.x,m=f>0?e.x+e.width-Math.floor(f/o)*o:e.x+e.width,h=u>0?e.y+Math.floor(u/o)*o:e.y,p=g>0?e.y+e.height-Math.floor(g/o)*o:e.y+e.height;return{x:w,y:h,width:m-w,height:p-h}}function ud(e,t,n,o,r){const[i,a,s,c]=t,[f,u,g,w]=r,{x:m,y:h,width:p,height:x}=e,y=[];if(p<=0||x<=0)return y;const b=m+p,k=h+x,T=m<i,A=h<a,E=m+p>s,D=h+x>c,_=m>=i&&m<s||b>i&&b<=s||m<i&&b>s,R=h>=a&&h<c||k>a&&k<=c||h<a&&k>c;if(_&&R){const X=Math.max(m,i),L=Math.max(h,a),H=Math.min(b,s),I=Math.min(k,c);y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:f,y:u,width:g-f+1,height:w-u+1}})}if(T&&A){const X=m,L=h,H=Math.min(b,i),I=Math.min(k,a);y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:0,y:0,width:f+1,height:u+1}})}if(A&&_){const X=Math.max(m,i),L=h,H=Math.min(b,s),I=Math.min(k,a);y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:f,y:0,width:g-f+1,height:u+1}})}if(A&&E){const X=Math.max(m,s),L=h,H=b,I=Math.min(k,a);y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:g,y:0,width:n-g+1,height:u+1}})}if(T&&R){const X=m,L=Math.max(h,a),H=Math.min(b,i),I=Math.min(k,c);y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:0,y:u,width:f+1,height:w-u+1}})}if(E&&R){const X=Math.max(m,s),L=Math.max(h,a),H=b,I=Math.min(k,c);y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:g,y:u,width:n-g+1,height:w-u+1}})}if(T&&D){const X=m,L=Math.max(h,c),H=Math.min(b,i),I=k;y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:0,y:w,width:f+1,height:o-w+1}})}if(D&&_){const X=Math.max(m,i),L=Math.max(h,c),H=Math.min(b,s),I=k;y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:f,y:w,width:g-f+1,height:o-w+1}})}if(E&&D){const X=Math.max(m,s),L=Math.max(h,c),H=b,I=k;y.push({rect:{x:X,y:L,width:H-X,height:I-L},clip:{x:g,y:w,width:n-g+1,height:o-w+1}})}return y}const fd={kind:U.Loading,allowOverlay:!1};function Sl(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p,x,y,b,k,T,A,E,D,_,R,$,X,L,H,I,le,j,re,Ee){let be=(k==null?void 0:k.size)??Number.MAX_SAFE_INTEGER;const te=performance.now();let K=H.baseFontFull;e.font=K;const ve={ctx:e},ne=[0,0],fe=x>0?bo(c,x,f):0;let Ge,q;const oe=Ss(b);return oo(t,s,i,a,r,(ue,Le,Ne,tt,rt)=>{const Me=Math.max(0,tt-Le),Te=Le+Me,Fe=r+1,gt=ue.width-Me,mt=o-r-1;if(b.length>0){let je=!1;for(let Xe=0;Xe<b.length;Xe++){const Ze=b[Xe];if(hr(Te,Fe,gt,mt,Ze.x,Ze.y,Ze.width,Ze.height)){je=!0;break}}if(!je)return}const ct=()=>{e.save(),e.beginPath(),e.rect(Te,Fe,gt,mt),e.clip()},Z=T.columns.hasIndex(ue.sourceIndex),he=g(ue.group??"").overrideTheme,xe=ue.themeOverride===void 0&&he===void 0?H:Wn(H,he,ue.themeOverride),Re=xe.baseFontFull;Re!==K&&(K=Re,e.font=Re),ct();let me;return Zr(rt,Ne,o,c,f,x,y,oe,(je,Xe,Ze,ie,pe)=>{var Ye,Dt,jt;if(Xe<0||(ne[0]=ue.sourceIndex,ne[1]=Xe,k!==void 0&&!k.has(ne)))return;if(b.length>0){let et=!1;for(let It=0;It<b.length;It++){const it=b[It];if(hr(Le,je,ue.width,Ze,it.x,it.y,it.width,it.height)){et=!0;break}}if(!et)return}const _e=T.rows.hasIndex(Xe),Ue=m.hasIndex(Xe),Qe=Xe<c?u(ne):fd;let pt=Le,ot=ue.width,ze=!1,kt=!1;if(Qe.span!==void 0){const[et,It]=Qe.span,it=`${Xe},${et},${It},${ue.sticky}`;if(q===void 0&&(q=new Set),q.has(it)){be--;return}else{const tn=Rs(Qe.span,Le,je,ue.width,Ze,ue,n),Xt=ue.sticky?tn[0]:tn[1];if(!ue.sticky&&tn[0]!==void 0&&(kt=!0),Xt!==void 0){pt=Xt.x,ot=Xt.width,q.add(it),e.restore(),me=void 0,e.save(),e.beginPath();const Kt=Math.max(0,tt-Xt.x);e.rect(Xt.x+Kt,je,Xt.width-Kt,Ze),Ge===void 0&&(Ge=[]),Ge.push({x:Xt.x+Kt,y:je,width:Xt.width-Kt,height:Ze}),e.clip(),ze=!0}}}const Ft=w==null?void 0:w(Xe),Lt=pe&&((Ye=ue.trailingRowOptions)==null?void 0:Ye.themeOverride)!==void 0?(Dt=ue.trailingRowOptions)==null?void 0:Dt.themeOverride:void 0,Ct=Qe.themeOverride===void 0&&Ft===void 0&&Lt===void 0?xe:Wn(xe,Ft,Lt,Qe.themeOverride);e.beginPath();const Et=gc(ne,Qe,T);let Bt=mc(ne,Qe,T,p);const an=Qe.span!==void 0&&T.columns.some(et=>Qe.span!==void 0&&et>=Qe.span[0]&&et<=Qe.span[1]);Et&&!h&&p?Bt=0:Et&&p&&(Bt=Math.max(Bt,1)),an&&Bt++,Et||(_e&&Bt++,Z&&!pe&&Bt++);const Yt=Qe.kind===U.Protected?Ct.bgCellMedium:Ct.bgCell;let dt;if((ie||Yt!==H.bgCell)&&(dt=en(Yt,dt)),Bt>0||Ue){Ue&&(dt=en(Ct.bgHeader,dt));for(let et=0;et<Bt;et++)dt=en(Ct.accentLight,dt)}else if(A!==void 0){for(const et of A)if(et[0]===ue.sourceIndex&&et[1]===Xe){dt=en(Ct.bgSearchResult,dt);break}}if(E!==void 0)for(let et=0;et<E.length;et++){const It=E[et],it=It.range;It.style!=="solid-outline"&&it.x<=ue.sourceIndex&&ue.sourceIndex<it.x+it.width&&it.y<=Xe&&Xe<it.y+it.height&&(dt=en(It.color,dt))}let Rn=!1;if(k!==void 0){const et=je+1,it=(ie?et+Ze-1:Math.min(et+Ze-1,o-fe))-et;(it!==Ze-1||pt+1<=tt)&&(Rn=!0,e.save(),e.beginPath(),e.rect(pt+1,et,ot-1,it),e.clip()),dt=dt===void 0?Ct.bgCell:en(dt,Ct.bgCell)}const cn=ue.sourceIndex===n.length-1,wt=Xe===c-1;dt!==void 0&&(e.fillStyle=dt,me!==void 0&&(me.fillStyle=dt),k!==void 0?e.fillRect(pt+1,je+1,ot-(cn?2:1),Ze-(wt?2:1)):e.fillRect(pt,je,ot,Ze)),Qe.style==="faded"&&(e.globalAlpha=.6);let $t;for(let et=0;et<R.length;et++){const It=R[et];if(It.item[0]===ue.sourceIndex&&It.item[1]===Xe){$t=It;break}}if(ot>Ee&&!kt){const et=Ct.baseFontFull;et!==K&&(e.font=et,K=et),me=Is(e,Qe,ue.sourceIndex,Xe,cn,wt,pt,je,ot,Ze,Bt>0,Ct,dt??Ct.bgCell,D,_,($t==null?void 0:$t.hoverAmount)??0,$,L,te,X,me,I,le,j,re)}return Rn&&e.restore(),Qe.style==="faded"&&(e.globalAlpha=1),be--,ze&&(e.restore(),(jt=me==null?void 0:me.deprep)==null||jt.call(me,ve),me=void 0,ct(),K=Re,e.font=Re),be<=0}),e.restore(),be<=0}),Ge}const or=[0,0],rr={x:0,y:0,width:0,height:0},Ri=[void 0,()=>{}];let Wi=!1;function hd(){Wi=!0}function Is(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p,x,y,b,k,T,A,E,D,_){var le,j;let R,$;x!==void 0&&x[0][0]===n&&x[0][1]===o&&(R=x[1][0],$=x[1][1]);let X;or[0]=n,or[1]=o,rr.x=a,rr.y=s,rr.width=c,rr.height=f,Ri[0]=E.getValue(or),Ri[1]=re=>E.setValue(or,re),Wi=!1;const L={ctx:e,theme:g,col:n,row:o,cell:t,rect:rr,highlighted:u,cellFillColor:w,hoverAmount:p,frameTime:b,hoverX:R,drawState:Ri,hoverY:$,imageLoader:m,spriteManager:h,hyperWrapping:y,overrideCursor:R!==void 0?_:void 0,requestAnimationFrame:hd},H=Cc(L,t.lastUpdated,b,T,r,i),I=D(t);if(I!==void 0){(T==null?void 0:T.renderer)!==I&&((le=T==null?void 0:T.deprep)==null||le.call(T,L),T=void 0);const re=(j=I.drawPrep)==null?void 0:j.call(I,L,T);k!==void 0&&!No(L.cell)?k(L,()=>I.draw(L,t)):I.draw(L,t),X=re===void 0?void 0:{deprep:re==null?void 0:re.deprep,fillStyle:re==null?void 0:re.fillStyle,font:re==null?void 0:re.font,renderer:I}}return(H||Wi)&&(A==null||A(or)),X}function Ki(e,t,n,o,r,i,a,s,c=-20,f=-20,u=void 0,g="center",w="square"){const m=Math.floor(r+a/2),h=w==="circle"?1e4:t.roundingRadius??4;let p=as(u??t.checkboxMaxSize,a,t.cellVerticalPadding),x=p/2;const y=ss(g,o,i,t.cellHorizontalPadding,p),b=ls(y,m,p),k=cs(o+c,r+f,b);switch(n){case!0:{e.beginPath(),Mn(e,y-p/2,m-p/2,p,p,h),w==="circle"&&(x*=.8,p*=.8),e.fillStyle=s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(y-x+p/4.23,m-x+p/1.97),e.lineTo(y-x+p/2.42,m-x+p/1.44),e.lineTo(y-x+p/1.29,m-x+p/3.25),e.strokeStyle=t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case _r:case!1:{e.beginPath(),Mn(e,y-p/2+.5,m-p/2+.5,p-1,p-1,h),e.lineWidth=1,e.strokeStyle=k?t.textDark:t.textMedium,e.stroke();break}case Oi:{e.beginPath(),Mn(e,y-p/2,m-p/2,p,p,h),e.fillStyle=k?t.textMedium:t.textLight,e.fill(),w==="circle"&&(x*=.8,p*=.8),e.beginPath(),e.moveTo(y-p/3,m),e.lineTo(y+p/3,m),e.strokeStyle=t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:ur()}}function gd(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p,x,y,b){var R,$,X,L;const k=a+s;if(k<=0)return;e.fillStyle=g.bgHeader,e.fillRect(0,0,r,k);const T=(R=o==null?void 0:o[0])==null?void 0:R[0],A=($=o==null?void 0:o[0])==null?void 0:$[1],E=(X=o==null?void 0:o[1])==null?void 0:X[0],D=(L=o==null?void 0:o[1])==null?void 0:L[1],_=g.headerFontFull;e.font=_,oo(t,0,i,0,k,(H,I,le,j)=>{var ue;if(x!==void 0&&!x.has([H.sourceIndex,-1]))return;const re=Math.max(0,j-I);e.save(),e.beginPath(),e.rect(I+re,s,H.width-re,a),e.clip();const Ee=p(H.group??"").overrideTheme,be=H.themeOverride===void 0&&Ee===void 0?g:Wn(g,Ee,H.themeOverride);be.bgHeader!==g.bgHeader&&(e.fillStyle=be.bgHeader,e.fill()),be!==g&&(e.font=be.headerFontFull);const te=u.columns.hasIndex(H.sourceIndex),K=c!==void 0||f||H.headerRowMarkerDisabled===!0,ve=!K&&A===-1&&T===H.sourceIndex,ne=K?0:((ue=m.find(Le=>Le.item[0]===H.sourceIndex&&Le.item[1]===-1))==null?void 0:ue.hoverAmount)??0,fe=(u==null?void 0:u.current)!==void 0&&u.current.cell[0]===H.sourceIndex,Ge=te?be.accentColor:fe?be.bgHeaderHasFocus:be.bgHeader,q=n?s:0,oe=H.sourceIndex===0?0:1;te?(e.fillStyle=Ge,e.fillRect(I+oe,q,H.width-oe,a)):(fe||ne>0)&&(e.beginPath(),e.rect(I+oe,q,H.width-oe,a),fe&&(e.fillStyle=be.bgHeaderHasFocus,e.fill()),ne>0&&(e.globalAlpha=ne,e.fillStyle=be.bgHeaderHovered,e.fill(),e.globalAlpha=1)),Hs(e,I,q,H.width,a,H,te,be,ve,ve?E:void 0,ve?D:void 0,fe,ne,w,y,b),e.restore()}),n&&md(e,t,r,i,s,o,g,w,m,h,p,x)}function md(e,t,n,o,r,i,a,s,c,f,u,g){const[m,h]=(i==null?void 0:i[0])??[];let p=0;Ms(t,n,o,r,(x,y,b,k,T,A)=>{if(g!==void 0&&!g.hasItemInRectangle({x:x[0],y:-2,width:x[1]-x[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(b,k,T,A),e.clip();const E=u(y),D=(E==null?void 0:E.overrideTheme)===void 0?a:Wn(a,E.overrideTheme),_=h===-2&&m!==void 0&&m>=x[0]&&m<=x[1],R=_?D.bgGroupHeaderHovered??D.bgHeaderHovered:D.bgGroupHeader??D.bgHeader;if(R!==a.bgHeader&&(e.fillStyle=R,e.fill()),e.fillStyle=D.textGroupHeader??D.textHeader,E!==void 0){let $=b;if(E.icon!==void 0&&(s.drawSprite(E.icon,"normal",e,$+8,(r-20)/2,20,D),$+=26),e.fillText(E.name,$+8,r/2+no(e,a.headerFontFull)),E.actions!==void 0&&_){const X=Fs({x:b,y:k,width:T,height:A},E.actions);e.beginPath();const L=X[0].x-10,H=b+T-L;e.rect(L,0,H,r);const I=e.createLinearGradient(L,0,L+H,0),le=wo(R,0);I.addColorStop(0,le),I.addColorStop(10/H,R),I.addColorStop(1,R),e.fillStyle=I,e.fill(),e.globalAlpha=.6;const[j,re]=(i==null?void 0:i[1])??[-1,-1];for(let Ee=0;Ee<E.actions.length;Ee++){const be=E.actions[Ee],te=X[Ee],K=po(te,j+b,re);K&&(e.globalAlpha=1),s.drawSprite(be.icon,"normal",e,te.x+te.width/2-10,te.y+te.height/2-10,20,D),K&&(e.globalAlpha=.6)}e.globalAlpha=1}}b!==0&&f(x[0])&&(e.beginPath(),e.moveTo(b+.5,0),e.lineTo(b+.5,r),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()),e.restore(),p=b+T}),e.beginPath(),e.moveTo(p+.5,0),e.lineTo(p+.5,r),e.moveTo(0,r+.5),e.lineTo(n,r+.5),e.strokeStyle=a.borderColor,e.lineWidth=1,e.stroke()}const Wr=30;function pd(e,t,n,o,r){return{x:e+n-Wr,y:Math.max(t,t+o/2-Wr/2),width:Wr,height:Math.min(Wr,o)}}function Fs(e,t){const n=[];let o=e.x+e.width-26*t.length;const r=e.y+e.height/2-13,i=26,a=26;for(let s=0;s<t.length;s++)n.push({x:o,y:r,width:a,height:i}),o+=26;return n}function ir(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function Ds(e,t,n,o,r,i,a,s){var y;const c=a.cellHorizontalPadding,f=a.headerIconSize,u=pd(n,o,r,i);let g=n+c;const w=t.icon===void 0?void 0:{x:g,y:o+(i-f)/2,width:f,height:f},m=w===void 0||t.overlayIcon===void 0?void 0:{x:w.x+9,y:w.y+6,width:18,height:18};w!==void 0&&(g+=Math.ceil(f*1.3));const h={x:g,y:o,width:r-g,height:i};let p;if(t.indicatorIcon!==void 0){const b=e===void 0?((y=ms(t.title,a.headerFontFull))==null?void 0:y.width)??0:Ko(t.title,e,a.headerFontFull).width;h.width=b,g+=b+c,p={x:g,y:o+(i-f)/2,width:f,height:f}}const x=n+r/2;return{menuBounds:ir(u,x,s),iconBounds:ir(w,x,s),iconOverlayBounds:ir(m,x,s),textBounds:ir(h,x,s),indicatorIconBounds:ir(p,x,s)}}function Ml(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p){if(i.rowMarker!==void 0&&i.headerRowMarkerDisabled!==!0){const b=i.rowMarkerChecked;b!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=g);const k=i.headerRowMarkerTheme!==void 0?Wn(s,i.headerRowMarkerTheme):s;Ki(e,k,b,t,n,o,r,!1,void 0,void 0,s.checkboxMaxSize,"center",i.rowMarker),b!==!0&&i.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const x=a?s.textHeaderSelected:s.textHeader,y=i.hasMenu===!0&&(c||m&&a)&&p.menuBounds!==void 0;if(i.icon!==void 0&&p.iconBounds!==void 0){let b=a?"selected":"normal";i.style==="highlight"&&(b=a?"selected":"special"),w.drawSprite(i.icon,b,e,p.iconBounds.x,p.iconBounds.y,p.iconBounds.width,s),i.overlayIcon!==void 0&&p.iconOverlayBounds!==void 0&&w.drawSprite(i.overlayIcon,a?"selected":"special",e,p.iconOverlayBounds.x,p.iconOverlayBounds.y,p.iconOverlayBounds.width,s)}if(y&&o>35){const k=h?35:o-35,T=h?35*.7:o-35*.7,A=k/o,E=T/o,D=e.createLinearGradient(t,0,t+o,0),_=wo(x,0);D.addColorStop(h?1:0,x),D.addColorStop(A,x),D.addColorStop(E,_),D.addColorStop(h?0:1,_),e.fillStyle=D}else e.fillStyle=x;if(h&&(e.textAlign="right"),p.textBounds!==void 0&&e.fillText(i.title,h?p.textBounds.x+p.textBounds.width:p.textBounds.x,n+r/2+no(e,s.headerFontFull)),h&&(e.textAlign="left"),i.indicatorIcon!==void 0&&p.indicatorIconBounds!==void 0&&(!y||!hr(p.menuBounds.x,p.menuBounds.y,p.menuBounds.width,p.menuBounds.height,p.indicatorIconBounds.x,p.indicatorIconBounds.y,p.indicatorIconBounds.width,p.indicatorIconBounds.height))){let b=a?"selected":"normal";i.style==="highlight"&&(b=a?"selected":"special"),w.drawSprite(i.indicatorIcon,b,e,p.indicatorIconBounds.x,p.indicatorIconBounds.y,p.indicatorIconBounds.width,s)}if(y&&p.menuBounds!==void 0){const b=p.menuBounds,k=f!==void 0&&u!==void 0&&po(b,f+t,u+n);if(k||(e.globalAlpha=.7),i.menuIcon===void 0||i.menuIcon===Ur.Triangle){e.beginPath();const T=b.x+b.width/2-5.5,A=b.y+b.height/2-3;Mc(e,[{x:T,y:A},{x:T+11,y:A},{x:T+5.5,y:A+6}],1),e.fillStyle=x,e.fill()}else if(i.menuIcon===Ur.Dots){e.beginPath();const T=b.x+b.width/2,A=b.y+b.height/2;Sc(e,T,A),e.fillStyle=x,e.fill()}else{const T=b.x+(b.width-s.headerIconSize)/2,A=b.y+(b.height-s.headerIconSize)/2;w.drawSprite(i.menuIcon,"normal",e,T,A,s.headerIconSize,s)}k||(e.globalAlpha=1)}}function Hs(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p){const x=Gi(i.title)==="rtl",y=Ds(e,i,t,n,o,r,s,x);h!==void 0?h({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:r},column:i,columnIndex:i.sourceIndex,isSelected:a,hoverAmount:w,isHovered:c,hasSelectedCell:g,spriteManager:m,menuBounds:(y==null?void 0:y.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:f,hoverY:u},()=>Ml(e,t,n,o,r,i,a,s,c,f,u,w,m,p,x,y)):Ml(e,t,n,o,r,i,a,s,c,f,u,w,m,p,x,y)}function wd(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p,x,y,b){if(y!==void 0||t[t.length-1]!==n[t.length-1])return;const k=Ss(x);oo(t,c,a,s,i,(T,A,E,D,_)=>{if(T!==t[t.length-1])return;A+=T.width;const R=Math.max(A,D);R>o||(e.save(),e.beginPath(),e.rect(R,i+1,1e4,r-i-1),e.clip(),Zr(_,E,r,f,u,h,p,k,($,X,L,H)=>{if(!H&&x.length>0&&!x.some(Ee=>hr(A,$,1e4,L,Ee.x,Ee.y,Ee.width,Ee.height)))return;const I=w.hasIndex(X),le=m.hasIndex(X);e.beginPath();const j=g==null?void 0:g(X),re=j===void 0?b:Wn(b,j);re.bgCell!==b.bgCell&&(e.fillStyle=re.bgCell,e.fillRect(A,$,1e4,L)),le&&(e.fillStyle=re.bgHeader,e.fillRect(A,$,1e4,L)),I&&(e.fillStyle=re.accentLight,e.fillRect(A,$,1e4,L))}),e.restore())})}function bd(e,t,n,o,r,i,a,s,c){let f=!1;for(const h of t)if(!h.sticky){f=a(h.sourceIndex);break}const u=c.horizontalBorderColor??c.borderColor,g=c.borderColor,w=f?Yo(t):0;let m;if(w!==0&&(m=vl(g,c.bgCell),e.beginPath(),e.moveTo(w+.5,0),e.lineTo(w+.5,o),e.strokeStyle=m,e.stroke()),r>0){const h=g===u&&m!==void 0?m:vl(u,c.bgCell),p=bo(i,r,s);e.beginPath(),e.moveTo(0,o-p+.5),e.lineTo(n,o-p+.5),e.strokeStyle=h,e.stroke()}}const Ts=(e,t,n)=>{let o=0,r=t,i=0,a=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),r=Math.max(r,s.x+s.width+1),i=Math.min(i,s.y-1),a=Math.max(a,s.y+s.height+1)}return{minX:o,maxX:r,minY:i,maxY:a}};function yd(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h){var L;const p=h.bgCell,{minX:x,maxX:y,minY:b,maxY:k}=Ts(s,i,a),T=[],A=a-bo(m,w,f);let E=c,D=n,_=0;for(;E+r<A;){const H=E+r,I=f(D);if(H>=b&&H<=k-1){const le=u==null?void 0:u(D),j=le==null?void 0:le.bgCell;j!==void 0&&j!==p&&D>=m-w&&T.push({x,y:H,w:y-x,h:I,color:j})}E+=I,D<m-w&&(_=E),D++}let R=0;const $=Math.min(A,k)-_;if($>0)for(let H=0;H<t.length;H++){const I=t[H];if(I.width===0)continue;const le=I.sticky?R:R+o,j=(L=I.themeOverride)==null?void 0:L.bgCell;j!==void 0&&j!==p&&le>=x&&le<=y&&g(H+1)&&T.push({x:le,y:_,w:I.width,h:$,color:j}),R+=I.width}if(T.length===0)return;let X;e.beginPath();for(let H=T.length-1;H>=0;H--){const I=T[H];X===void 0?X=I.color:I.color!==X&&(e.fillStyle=X,e.fill(),e.beginPath(),X=I.color),e.rect(I.x,I.y,I.w,I.h)}X!==void 0&&(e.fillStyle=X,e.fill()),e.beginPath()}function Rl(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p,x,y=!1){if(c!==void 0){e.beginPath(),e.save(),e.rect(0,0,i,a);for(const L of c)e.rect(L.x+1,L.y+1,L.width-1,L.height-1);e.clip("evenodd")}const b=x.horizontalBorderColor??x.borderColor,k=x.borderColor,{minX:T,maxX:A,minY:E,maxY:D}=Ts(s,i,a),_=[];e.beginPath();let R=.5;for(let L=0;L<t.length;L++){const H=t[L];if(H.width===0)continue;R+=H.width;const I=H.sticky?R:R+o;I>=T&&I<=A&&m(L+1)&&_.push({x1:I,y1:Math.max(f,E),x2:I,y2:Math.min(a,D),color:k})}let $=a+.5;for(let L=p-h;L<p;L++){const H=g(L);$-=H,_.push({x1:T,y1:$,x2:A,y2:$,color:b})}if(y!==!0){let L=u+.5,H=n;const I=$;for(;L+r<I;){const le=L+r;if(le>=E&&le<=D-1){const j=w==null?void 0:w(H);_.push({x1:T,y1:le,x2:A,y2:le,color:(j==null?void 0:j.horizontalBorderColor)??(j==null?void 0:j.borderColor)??b})}L+=g(H),H++}}const X=Ia(_,L=>L.color);for(const L of Object.keys(X)){e.strokeStyle=L;for(const H of X[L])e.moveTo(H.x1,H.y1),e.lineTo(H.x2,H.y2);e.stroke(),e.beginPath()}c!==void 0&&e.restore()}function vd(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p,x,y,b){const k=[];e.imageSmoothingEnabled=!1;const T=Math.min(r.cellYOffset,a),A=Math.max(r.cellYOffset,a);let E=0;if(typeof y=="number")E+=(A-T)*y;else for(let I=T;I<A;I++)E+=y(I);a>r.cellYOffset&&(E=-E),E+=c-r.translateY;const D=Math.min(r.cellXOffset,i),_=Math.max(r.cellXOffset,i);let R=0;for(let I=D;I<_;I++)R+=p[I].width;i>r.cellXOffset&&(R=-R),R+=s-r.translateX;const $=Yo(x);if(R!==0&&E!==0)return{regions:[]};const X=f>0?bo(w,f,y):0,L=u-$-Math.abs(R),H=g-m-X-Math.abs(E)-1;if(L>150&&H>150){const I={sx:0,sy:0,sw:u*h,sh:g*h,dx:0,dy:0,dw:u*h,dh:g*h};if(E>0?(I.sy=(m+1)*h,I.sh=H*h,I.dy=(E+m+1)*h,I.dh=H*h,k.push({x:0,y:m,width:u,height:E+1})):E<0&&(I.sy=(-E+m+1)*h,I.sh=H*h,I.dy=(m+1)*h,I.dh=H*h,k.push({x:0,y:g+E-X,width:u,height:-E+X})),R>0?(I.sx=$*h,I.sw=L*h,I.dx=(R+$)*h,I.dw=L*h,k.push({x:$-1,y:0,width:R+2,height:g})):R<0&&(I.sx=($-R)*h,I.sw=L*h,I.dx=$*h,I.dw=L*h,k.push({x:u+R,y:0,width:-R,height:g})),e.setTransform(1,0,0,1,0,0),b){if($>0&&R!==0&&E===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const le=$*h,j=g*h;e.drawImage(t,0,0,le,j,0,0,le,j)}if(X>0&&R===0&&E!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const le=(g-X)*h,j=u*h,re=X*h;e.drawImage(t,0,le,j,re,0,le,j,re)}}e.drawImage(t,I.sx,I.sy,I.sw,I.sh,I.dx,I.dy,I.dw,I.dh),e.scale(h,h)}return e.imageSmoothingEnabled=!0,{regions:k}}function Cd(e,t,n,o,r,i,a,s,c,f){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||r!==e.translateY||oo(c,n,o,r,s,(g,w,m,h)=>{if(g.sourceIndex===f){const p=Math.max(w,h)+1;return u.push({x:p,y:0,width:i-p,height:a}),!0}}),u}function xd(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const r=e.mappedColumns[o],i=t.mappedColumns[o];if(Uo(r,i))continue;if(n!==void 0||r.width===i.width)return!1;const{width:a,...s}=r,{width:c,...f}=i;if(!Uo(s,f))return!1;n=o}return n===void 0?!0:n}return!0}function El(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p){const x=h==null?void 0:h.filter(D=>D.style!=="no-outline");if(x===void 0||x.length===0)return;const y=Yo(s),b=bo(m,w,g),k=[c,0,s.length,m-w],T=[y,0,t,n-b],A=x.map(D=>{const _=D.range,R=D.style??"dashed";return ud(_,k,t,n,T).map($=>{const X=$.rect,L=Pi(X.x,X.y,t,n,u,f+u,o,r,i,a,m,c,w,s,g),H=X.width===1&&X.height===1?L:Pi(X.x+X.width-1,X.y+X.height-1,t,n,u,f+u,o,r,i,a,m,c,w,s,g);return X.x+X.width>=s.length&&(H.width-=1),X.y+X.height>=m&&(H.height-=1),{color:D.color,style:R,clip:$.clip,rect:dd({x:L.x,y:L.y,width:H.x+H.width-L.x,height:H.y+H.height-L.y},t,n,8)}})}),E=()=>{e.lineWidth=1;let D=!1;for(const _ of A)for(const R of _)if((R==null?void 0:R.rect)!==void 0&&hr(0,0,t,n,R.rect.x,R.rect.y,R.rect.width,R.rect.height)){const $=D,X=!cd(R.clip,R.rect);e.beginPath(),X&&(e.save(),e.rect(R.clip.x,R.clip.y,R.clip.width,R.clip.height),e.clip()),R.style==="dashed"&&!D?(e.setLineDash([5,3]),D=!0):(R.style==="solid"||R.style==="solid-outline")&&D&&(e.setLineDash([]),D=!1),e.strokeStyle=R.style==="solid-outline"?en(en(R.color,p.borderColor),p.bgCell):wo(R.color,1),e.closePath(),e.strokeRect(R.rect.x+.5,R.rect.y+.5,R.rect.width-1,R.rect.height-1),X&&(e.restore(),D=$)}D&&e.setLineDash([])};return E(),E}function Il(e,t,n,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=r,e.stroke(),e.globalAlpha=1}function Ei(e,t,n,o,r,i,a,s,c,f,u,g,w,m,h,p,x){if(u.current===void 0)return;const y=p!==!1&&p!==void 0;if(!y)return;const b=typeof p=="object"?{...Yr,...p}:Yr,k=u.current.range,T=u.current.cell,A=[k.x+k.width-1,k.y+k.height-1];if(T[1]>=x&&A[1]>=x||!a.some(j=>j.sourceIndex===T[0]||j.sourceIndex===A[0]))return;const[D,_]=u.current.cell,R=w(u.current.cell),$=R.span??[D,D],X=_>=x-m,L=m>0&&!X?bo(x,m,g)-1:0,H=A[1];let I;if(oo(a,o,r,i,f,(j,re,Ee,be,te)=>{if(j.sticky&&D>j.sourceIndex)return;const K=j.sourceIndex<$[0],ve=j.sourceIndex>$[1],ne=j.sourceIndex===A[0];if(!(!ne&&(K||ve)))return Zr(te,Ee,n,x,g,m,h,void 0,(fe,Ge,q)=>{if(Ge!==_&&Ge!==H)return;let oe=re,ue=j.width;if(R.span!==void 0){const Ne=Rs(R.span,re,fe,j.width,q,j,s),tt=j.sticky?Ne[0]:Ne[1];tt!==void 0&&(oe=tt.x,ue=tt.width)}return Ge===H&&ne&&y&&(I=()=>{var Te;be>oe&&!j.sticky&&(e.beginPath(),e.rect(be,0,t-be,n),e.clip());const Ne=b.size,tt=Ne/2,rt=oe+ue+b.offsetX-tt+.5,Me=fe+q+b.offsetY-tt+.5;e.beginPath(),b.shape==="circle"?e.arc(rt+tt,Me+tt,tt,0,Math.PI*2):e.rect(rt,Me,Ne,Ne),e.fillStyle=((Te=j.themeOverride)==null?void 0:Te.accentColor)??c.accentColor,e.fill(),b.outline>0&&(e.lineWidth=b.outline,e.strokeStyle=c.bgCell,b.shape==="circle"?(e.beginPath(),e.arc(rt+tt,Me+tt,tt+b.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(rt-b.outline/2,Me-b.outline/2,Ne+b.outline,Ne+b.outline))}),I!==void 0}),I!==void 0}),I===void 0)return;const le=()=>{e.save(),e.beginPath(),e.rect(0,f,t,n-f-L),e.clip(),I==null||I(),e.restore()};return le(),le}function kd(e,t,n,o,r,i,a,s,c){c===void 0||c.size===0||(e.beginPath(),Ms(t,n,i,o,(f,u,g,w,m,h)=>{c.hasItemInRectangle({x:f[0],y:-2,width:f[1]-f[0]+1,height:1})&&e.rect(g,w,m,h)}),oo(t,s,i,a,r,(f,u,g,w)=>{const m=Math.max(0,w-u),h=u+m+1,p=f.width-m-1;c.has([f.sourceIndex,-1])&&e.rect(h,o,p,r-o)}),e.clip())}function Sd(e,t,n,o,r,i,a,s,c,f){let u=0;return oo(e,i,o,r,n,(g,w,m,h,p)=>(Zr(p,m,t,a,s,c,f,void 0,(x,y,b,k)=>{k||(u=Math.max(y,u))}),!0)),u}function Fl(e,t){var cn;const{canvasCtx:n,headerCanvasCtx:o,width:r,height:i,cellXOffset:a,cellYOffset:s,translateX:c,translateY:f,mappedColumns:u,enableGroups:g,freezeColumns:w,dragAndDropState:m,theme:h,drawFocus:p,headerHeight:x,groupHeaderHeight:y,disabledRows:b,rowHeight:k,verticalBorder:T,overrideCursor:A,isResizing:E,selection:D,fillHandle:_,freezeTrailingRows:R,rows:$,getCellContent:X,getGroupDetails:L,getRowThemeOverride:H,isFocused:I,drawHeaderCallback:le,prelightCells:j,drawCellCallback:re,highlightRegions:Ee,resizeCol:be,imageLoader:te,lastBlitData:K,hoverValues:ve,hyperWrapping:ne,hoverInfo:fe,spriteManager:Ge,maxScaleFactor:q,hasAppendRow:oe,touchMode:ue,enqueue:Le,renderStateProvider:Ne,getCellRenderer:tt,renderStrategy:rt,bufferACtx:Me,bufferBCtx:Te,damage:Fe,minimumCellWidth:gt,resizeIndicator:mt}=e;if(r===0||i===0)return;const ct=rt==="double-buffer",Z=Math.min(q,Math.ceil(window.devicePixelRatio??1)),he=rt!=="direct"&&xd(e,t),xe=n.canvas;(xe.width!==r*Z||xe.height!==i*Z)&&(xe.width=r*Z,xe.height=i*Z,xe.style.width=r+"px",xe.style.height=i+"px");const Re=o.canvas,me=g?y+x:x,je=me+1;(Re.width!==r*Z||Re.height!==je*Z)&&(Re.width=r*Z,Re.height=je*Z,Re.style.width=r+"px",Re.style.height=je+"px");const Xe=Me.canvas,Ze=Te.canvas;ct&&(Xe.width!==r*Z||Xe.height!==i*Z)&&(Xe.width=r*Z,Xe.height=i*Z,K.current!==void 0&&(K.current.aBufferScroll=void 0)),ct&&(Ze.width!==r*Z||Ze.height!==i*Z)&&(Ze.width=r*Z,Ze.height=i*Z,K.current!==void 0&&(K.current.bBufferScroll=void 0));const ie=K.current;if(he===!0&&a===(ie==null?void 0:ie.cellXOffset)&&s===(ie==null?void 0:ie.cellYOffset)&&c===(ie==null?void 0:ie.translateX)&&f===(ie==null?void 0:ie.translateY))return;let pe=null;ct&&(pe=n);const _e=o;let Ue;ct?Fe!==void 0?Ue=(ie==null?void 0:ie.lastBuffer)==="b"?Te:Me:Ue=(ie==null?void 0:ie.lastBuffer)==="b"?Me:Te:Ue=n;const Qe=Ue.canvas,pt=ct?Qe===Xe?Ze:Xe:xe,ot=typeof k=="number"?()=>k:k;_e.save(),Ue.save(),_e.beginPath(),Ue.beginPath(),_e.textBaseline="middle",Ue.textBaseline="middle",Z!==1&&(_e.scale(Z,Z),Ue.scale(Z,Z));const ze=Bi(u,a,r,m,c);let kt=[];const Ft=p&&((cn=D.current)==null?void 0:cn.cell[1])===s&&f===0;let Lt=!1;if(Ee!==void 0){for(const wt of Ee)if(wt.style!=="no-outline"&&wt.range.y===s&&f===0){Lt=!0;break}}const Ct=()=>{gd(_e,ze,g,fe,r,c,x,y,m,E,D,h,Ge,ve,T,L,Fe,le,ue),Rl(_e,ze,s,c,f,r,i,void 0,void 0,y,me,ot,H,T,R,$,h,!0),_e.beginPath(),_e.moveTo(0,je-.5),_e.lineTo(r,je-.5),_e.strokeStyle=en(h.headerBottomBorderColor??h.horizontalBorderColor??h.borderColor,h.bgHeader),_e.stroke(),Lt&&El(_e,r,i,a,s,c,f,u,w,x,y,k,R,$,Ee,h),Ft&&Ei(_e,r,i,s,c,f,ze,u,h,me,D,ot,X,R,oe,_,$)};if(Fe!==void 0){const wt=ze[ze.length-1].sourceIndex+1,$t=Fe.hasItemInRegion([{x:a,y:-2,width:wt,height:2},{x:a,y:s,width:wt,height:300},{x:0,y:s,width:w,height:300},{x:0,y:-2,width:w,height:2},{x:a,y:$-R,width:wt,height:R,when:R>0}]),Ye=Dt=>{Sl(Dt,ze,u,i,me,c,f,s,$,ot,X,L,H,b,I,p,R,oe,kt,Fe,D,j,Ee,te,Ge,ve,fe,re,ne,h,Le,Ne,tt,A,gt);const jt=D.current;_!==!1&&_!==void 0&&p&&jt!==void 0&&Fe.has(fs(jt.range))&&Ei(Dt,r,i,s,c,f,ze,u,h,me,D,ot,X,R,oe,_,$)};$t&&(Ye(Ue),pe!==null&&(pe.save(),pe.scale(Z,Z),pe.textBaseline="middle",Ye(pe),pe.restore()),Fe.hasHeader()&&(kd(_e,ze,r,y,me,c,f,s,Fe),Ct())),Ue.restore(),_e.restore();return}if((he!==!0||a!==(ie==null?void 0:ie.cellXOffset)||c!==(ie==null?void 0:ie.translateX)||Ft!==(ie==null?void 0:ie.mustDrawFocusOnHeader)||Lt!==(ie==null?void 0:ie.mustDrawHighlightRingsOnHeader))&&Ct(),he===!0){Qt(pt!==void 0&&ie!==void 0);const{regions:wt}=vd(Ue,pt,pt===Xe?ie.aBufferScroll:ie.bBufferScroll,pt===Xe?ie.bBufferScroll:ie.aBufferScroll,ie,a,s,c,f,R,r,i,$,me,Z,u,ze,k,ct);kt=wt}else he!==!1&&(Qt(ie!==void 0),kt=Cd(ie,a,s,c,f,r,i,me,ze,he));bd(Ue,ze,r,i,R,$,T,ot,h);const Et=El(Ue,r,i,a,s,c,f,u,w,x,y,k,R,$,Ee,h),Bt=p?Ei(Ue,r,i,s,c,f,ze,u,h,me,D,ot,X,R,oe,_,$):void 0;if(Ue.fillStyle=h.bgCell,kt.length>0){Ue.beginPath();for(const wt of kt)Ue.rect(wt.x,wt.y,wt.width,wt.height);Ue.clip(),Ue.fill(),Ue.beginPath()}else Ue.fillRect(0,0,r,i);const an=Sl(Ue,ze,u,i,me,c,f,s,$,ot,X,L,H,b,I,p,R,oe,kt,Fe,D,j,Ee,te,Ge,ve,fe,re,ne,h,Le,Ne,tt,A,gt);wd(Ue,ze,u,r,i,me,c,f,s,$,ot,H,D.rows,b,R,oe,kt,Fe,h),yd(Ue,ze,s,c,f,r,i,kt,me,ot,H,T,R,$,h),Rl(Ue,ze,s,c,f,r,i,kt,an,y,me,ot,H,T,R,$,h),Et==null||Et(),Bt==null||Bt(),E&&mt!=="none"&&oo(ze,0,c,0,me,(wt,$t)=>wt.sourceIndex===be?(Il(_e,$t+wt.width,0,me+1,en(h.resizeIndicatorColor??h.accentLight,h.bgHeader)),mt==="full"&&Il(Ue,$t+wt.width,me,i,en(h.resizeIndicatorColor??h.accentLight,h.bgCell)),!0):!1),pe!==null&&(pe.fillStyle=h.bgCell,pe.fillRect(0,0,r,i),pe.drawImage(Ue.canvas,0,0));const Yt=Sd(ze,i,me,c,f,s,$,ot,R,oe);te==null||te.setWindow({x:a,y:s,width:ze.length,height:Yt-s},w,Array.from({length:R},(wt,$t)=>$-1-$t));const dt=ie!==void 0&&(a!==ie.cellXOffset||c!==ie.translateX),Rn=ie!==void 0&&(s!==ie.cellYOffset||f!==ie.translateY);K.current={cellXOffset:a,cellYOffset:s,translateX:c,translateY:f,mustDrawFocusOnHeader:Ft,mustDrawHighlightRingsOnHeader:Lt,lastBuffer:ct?Qe===Xe?"a":"b":void 0,aBufferScroll:Qe===Xe?[dt,Rn]:ie==null?void 0:ie.aBufferScroll,bBufferScroll:Qe===Ze?[dt,Rn]:ie==null?void 0:ie.bBufferScroll},Ue.restore(),_e.restore()}const Md=80;function Rd(e){const t=e-1;return t*t*t+1}class Ed{constructor(t){Pe(this,"callback");Pe(this,"currentHoveredItem");Pe(this,"leavingItems",[]);Pe(this,"lastAnimationTime");Pe(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>sr(o.item,t.item))||this.leavingItems.push(t)});Pe(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>sr(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Pe(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Pe(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Pe(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:Rd(t.hoverAmount)})));Pe(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/Md;for(const i of this.leavingItems)i.hoverAmount=ln(i.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=ln(this.currentHoveredItem.hoverAmount+o,0,1));const r=this.getAnimatingItems();this.callback(r),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Pe(this,"setHovered",t=>{var n;if(!sr((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class Id{constructor(t){Pe(this,"fn");Pe(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function Vi(e){return new Id(e)}const Fd=Vi(()=>window.navigator.userAgent.includes("Firefox")),Kr=Vi(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),Vr=Vi(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function Dd(e){const t=l.useRef([]),n=l.useRef(0),o=l.useRef(e);o.current=e;const r=l.useCallback(()=>{const i=()=>window.requestAnimationFrame(a),a=()=>{const s=t.current.map(Yi);t.current=[],o.current(new cr(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?i:a)},[]);return l.useCallback(i=>{t.current.length===0&&r();const a=wn(i[0],i[1]);t.current.includes(a)||t.current.push(a)},[r])}const Qn="header",pn="group-header",qr="out-of-bounds";var Xo;(function(e){e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End"})(Xo||(Xo={}));function As(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const Hd=(e,t)=>{if(e.kind===U.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},Td=(e,t)=>{const{width:n,height:o,accessibilityHeight:r,columns:i,cellXOffset:a,cellYOffset:s,headerHeight:c,fillHandle:f=!1,groupHeaderHeight:u,rowHeight:g,rows:w,getCellContent:m,getRowThemeOverride:h,onHeaderMenuClick:p,onHeaderIndicatorClick:x,enableGroups:y,isFilling:b,onCanvasFocused:k,onCanvasBlur:T,isFocused:A,selection:E,freezeColumns:D,onContextMenu:_,freezeTrailingRows:R,fixedShadowX:$=!0,fixedShadowY:X=!0,drawFocusRing:L,onMouseDown:H,onMouseUp:I,onMouseMoveRaw:le,onMouseMove:j,onItemHovered:re,dragAndDropState:Ee,firstColAccessible:be,onKeyDown:te,onKeyUp:K,highlightRegions:ve,canvasRef:ne,onDragStart:fe,onDragEnd:Ge,eventTargetRef:q,isResizing:oe,resizeColumn:ue,isDragging:Le,isDraggable:Ne=!1,allowResize:tt,disabledRows:rt,hasAppendRow:Me,getGroupDetails:Te,theme:Fe,prelightCells:gt,headerIcons:mt,verticalBorder:ct,drawCell:Z,drawHeader:he,onCellFocused:xe,onDragOverCell:Re,onDrop:me,onDragLeave:je,imageWindowLoader:Xe,smoothScrollX:Ze=!1,smoothScrollY:ie=!1,experimental:pe,getCellRenderer:_e,resizeIndicator:Ue="full"}=e,Qe=e.translateX??0,pt=e.translateY??0,ot=Math.max(D,Math.min(i.length-1,a)),ze=l.useRef(null),kt=l.useRef((pe==null?void 0:pe.eventTarget)??window),Ft=kt.current,Lt=Xe,Ct=l.useRef(),[Et,Bt]=l.useState(!1),an=l.useRef([]),Yt=l.useRef(),[dt,Rn]=l.useState(),[cn,wt]=l.useState(),$t=l.useRef(null),[Ye,Dt]=l.useState(),[jt,et]=l.useState(!1),It=l.useRef(jt);It.current=jt;const it=l.useMemo(()=>new sd(mt,()=>{vo.current=void 0,ro.current()}),[mt]),tn=y?u+c:c,Xt=l.useRef(-1),Kt=((pe==null?void 0:pe.enableFirefoxRescaling)??!1)&&Fd.value,En=((pe==null?void 0:pe.enableSafariRescaling)??!1)&&Kr.value;l.useLayoutEffect(()=>{window.devicePixelRatio===1||!Kt&&!En||(Xt.current!==-1&&Bt(!0),window.clearTimeout(Xt.current),Xt.current=window.setTimeout(()=>{Bt(!1),Xt.current=-1},200))},[s,ot,Qe,pt,Kt,En]);const ut=fc(i,D),$n=l.useMemo(()=>$?Yo(ut,Ee):0,[ut,Ee,$]),Ht=l.useCallback((M,G,se)=>{const ae=M.getBoundingClientRect();if(G>=ut.length||se>=w)return;const J=ae.width/n,Q=Pi(G,se,n,o,u,tn,ot,s,Qe,pt,w,D,R,ut,g);return J!==1&&(Q.x*=J,Q.y*=J,Q.width*=J,Q.height*=J),Q.x+=ae.x,Q.y+=ae.y,Q},[n,o,u,tn,ot,s,Qe,pt,w,D,R,ut,g]),Ke=l.useCallback((M,G,se,ae)=>{const J=M.getBoundingClientRect(),Q=J.width/n,ke=(G-J.left)/Q,Ve=(se-J.top)/Q,ge=5,Tt=Bi(ut,ot,n,void 0,Qe);let we=0,qe=0;const Ae=typeof PointerEvent<"u"&&ae instanceof PointerEvent&&ae.pointerType==="mouse"||typeof MouseEvent<"u"&&ae instanceof MouseEvent,Be=typeof PointerEvent<"u"&&ae instanceof PointerEvent&&ae.pointerType==="touch"||typeof TouchEvent<"u"&&ae instanceof TouchEvent;Ae&&(we=ae.button,qe=ae.buttons);const De=pc(ke,Tt,Qe),Je=wc(Ve,o,y,c,u,w,g,s,pt,R),St=(ae==null?void 0:ae.shiftKey)===!0,un=(ae==null?void 0:ae.ctrlKey)===!0,fn=(ae==null?void 0:ae.metaKey)===!0,yt=[ke<0?-1:n<ke?1:0,Ve<tn?-1:o<Ve?1:0];let Rt;if(De===-1||Ve<0||ke<0||Je===void 0||ke>n||Ve>o){const lt=ke>n?1:ke<0?-1:0,nn=Ve>o?1:Ve<0?-1:0;let Ot=lt*2,Ao=nn*2;lt===0&&(Ot=De===-1?Xo.EndPadding:Xo.Center),nn===0&&(Ao=Je===void 0?Xo.EndPadding:Xo.Center);let zn=!1;if(De===-1&&Je===-1){const At=Ht(M,ut.length-1,-1);Qt(At!==void 0),zn=G<At.x+At.width+ge}const We=ke>n&&ke<n+Ai()||Ve>o&&Ve<o+Ai();Rt={kind:qr,location:[De!==-1?De:ke<0?0:ut.length-1,Je??w-1],region:[Ot,Ao],shiftKey:St,ctrlKey:un,metaKey:fn,isEdge:zn,isTouch:Be,button:we,buttons:qe,scrollEdge:yt,isMaybeScrollbar:We}}else if(Je<=-1){let lt=Ht(M,De,Je);Qt(lt!==void 0);let nn=lt!==void 0&&lt.x+lt.width-G<=ge;const Ot=De-1;G-lt.x<=ge&&Ot>=0?(nn=!0,lt=Ht(M,Ot,Je),Qt(lt!==void 0),Rt={kind:y&&Je===-2?pn:Qn,location:[Ot,Je],bounds:lt,group:ut[Ot].group??"",isEdge:nn,shiftKey:St,ctrlKey:un,metaKey:fn,isTouch:Be,localEventX:G-lt.x,localEventY:se-lt.y,button:we,buttons:qe,scrollEdge:yt}):Rt={kind:y&&Je===-2?pn:Qn,group:ut[De].group??"",location:[De,Je],bounds:lt,isEdge:nn,shiftKey:St,ctrlKey:un,metaKey:fn,isTouch:Be,localEventX:G-lt.x,localEventY:se-lt.y,button:we,buttons:qe,scrollEdge:yt}}else{const lt=Ht(M,De,Je);Qt(lt!==void 0);const nn=lt!==void 0&&lt.x+lt.width-G<ge;let Ot=!1;if(f!==!1&&f!==void 0&&E.current!==void 0){const zn=typeof f=="object"?{...Yr,...f}:Yr,We=zn.size,At=We/2,ao=fs(E.current.range),Yn=Ht(M,ao[0],ao[1]);if(Yn!==void 0){const Bn=Yn.x+Yn.width+zn.offsetX-At+.5,ft=Yn.y+Yn.height+zn.offsetY-At+.5;Ot=Math.abs(Bn-G)<We&&Math.abs(ft-se)<We}}Rt={kind:"cell",location:[De,Je],bounds:lt,isEdge:nn,shiftKey:St,ctrlKey:un,isFillHandle:Ot,metaKey:fn,isTouch:Be,localEventX:G-lt.x,localEventY:se-lt.y,button:we,buttons:qe,scrollEdge:yt}}return Rt},[n,ut,ot,Qe,o,y,c,u,w,g,s,pt,R,Ht,f,E,tn]),[In]=dt??[],mr=l.useRef(()=>{}),On=l.useRef(dt);On.current=dt;const[Fn,Dn]=l.useMemo(()=>{const M=document.createElement("canvas"),G=document.createElement("canvas");return M.style.display="none",M.style.opacity="0",M.style.position="fixed",G.style.display="none",G.style.opacity="0",G.style.position="fixed",[M.getContext("2d",{alpha:!1}),G.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>{if(!(Fn===null||Dn===null))return document.documentElement.append(Fn.canvas),document.documentElement.append(Dn.canvas),()=>{Fn.canvas.remove(),Dn.canvas.remove()}},[Fn,Dn]);const yo=l.useMemo(()=>new Rc,[]),pr=Kt&&Et?1:En&&Et?2:5,Nn=(pe==null?void 0:pe.disableMinimumCellWidth)===!0?1:10,vo=l.useRef(),Co=l.useRef(null),xo=l.useRef(null),ko=l.useCallback(()=>{var ke;const M=ze.current,G=$t.current;if(M===null||G===null||(Co.current===null&&(Co.current=M.getContext("2d",{alpha:!1}),M.width=0,M.height=0),xo.current===null&&(xo.current=G.getContext("2d",{alpha:!1}),G.width=0,G.height=0),Co.current===null||xo.current===null||Fn===null||Dn===null))return;let se=!1;const ae=Ve=>{se=!0,Dt(Ve)},J=vo.current,Q={headerCanvasCtx:xo.current,canvasCtx:Co.current,bufferACtx:Fn,bufferBCtx:Dn,width:n,height:o,cellXOffset:ot,cellYOffset:s,translateX:Math.round(Qe),translateY:Math.round(pt),mappedColumns:ut,enableGroups:y,freezeColumns:D,dragAndDropState:Ee,theme:Fe,headerHeight:c,groupHeaderHeight:u,disabledRows:rt??st.empty(),rowHeight:g,verticalBorder:ct,isResizing:oe,resizeCol:ue,isFocused:A,selection:E,fillHandle:f,drawCellCallback:Z,hasAppendRow:Me,overrideCursor:ae,maxScaleFactor:pr,freezeTrailingRows:R,rows:w,drawFocus:L,getCellContent:m,getGroupDetails:Te??(Ve=>({name:Ve})),getRowThemeOverride:h,drawHeaderCallback:he,prelightCells:gt,highlightRegions:ve,imageLoader:Lt,lastBlitData:Yt,damage:Ct.current,hoverValues:an.current,hoverInfo:On.current,spriteManager:it,scrolling:Et,hyperWrapping:(pe==null?void 0:pe.hyperWrapping)??!1,touchMode:jt,enqueue:mr.current,renderStateProvider:yo,renderStrategy:(pe==null?void 0:pe.renderStrategy)??(Kr.value?"double-buffer":"single-buffer"),getCellRenderer:_e,minimumCellWidth:Nn,resizeIndicator:Ue};Q.damage===void 0?(vo.current=Q,Fl(Q,J)):Fl(Q,void 0),!se&&(Q.damage===void 0||Q.damage.has((ke=On==null?void 0:On.current)==null?void 0:ke[0]))&&Dt(void 0)},[Fn,Dn,n,o,ot,s,Qe,pt,ut,y,D,Ee,Fe,c,u,rt,g,ct,oe,Me,ue,A,E,f,R,w,L,pr,m,Te,h,Z,he,gt,ve,Lt,it,Et,pe==null?void 0:pe.hyperWrapping,pe==null?void 0:pe.renderStrategy,jt,yo,_e,Nn,Ue]),ro=l.useRef(ko);l.useLayoutEffect(()=>{ko(),ro.current=ko},[ko]),l.useLayoutEffect(()=>{(async()=>{var G;((G=document==null?void 0:document.fonts)==null?void 0:G.ready)!==void 0&&(await document.fonts.ready,vo.current=void 0,ro.current())})()},[]);const Hn=l.useCallback(M=>{Ct.current=M,ro.current(),Ct.current=void 0},[]),Jr=Dd(Hn);mr.current=Jr;const wr=l.useCallback(M=>{Hn(new cr(M.map(G=>G.cell)))},[Hn]);Lt.setCallback(Hn);const[Qr,ei]=l.useState(!1),[bn,Xn]=In??[],ti=bn!==void 0&&Xn===-1&&bn>=0&&bn<ut.length&&ut[bn].headerRowMarkerDisabled!==!0,ni=bn!==void 0&&Xn===-2;let So=!1,br=!1,io=Ye;if(io===void 0&&bn!==void 0&&Xn!==void 0&&Xn>-1&&Xn<w){const M=m([bn,Xn],!0);So=M.kind===sn.NewRow||M.kind===sn.Marker&&M.markerKind!=="number",br=M.kind===U.Boolean&&Ni(M),io=M.cursor}const yr=Le?"grabbing":(cn??!1)||oe?"col-resize":Qr||b?"crosshair":io!==void 0?io:ti||So||br||ni?"pointer":"default",Mo=l.useMemo(()=>({contain:"strict",display:"block",cursor:yr}),[yr]),ht=l.useRef("default"),Gt=q==null?void 0:q.current;Gt!=null&&ht.current!==Mo.cursor&&(Gt.style.cursor=ht.current=Mo.cursor);const Ro=l.useCallback((M,G,se,ae)=>{if(Te===void 0)return;const J=Te(M);if(J.actions!==void 0){const Q=Fs(G,J.actions);for(const[ke,Ve]of Q.entries())if(po(Ve,se+G.x,ae+Ve.y))return J.actions[ke]}},[Te]),Tn=l.useCallback((M,G,se,ae)=>{const J=ut[G];if(!Le&&!oe&&!(cn??!1)){const Q=Ht(M,G,-1);Qt(Q!==void 0);const ke=Ds(void 0,J,Q.x,Q.y,Q.width,Q.height,Fe,Gi(J.title)==="rtl");if(J.hasMenu===!0&&ke.menuBounds!==void 0&&po(ke.menuBounds,se,ae))return{area:"menu",bounds:ke.menuBounds};if(J.indicatorIcon!==void 0&&ke.indicatorIconBounds!==void 0&&po(ke.indicatorIconBounds,se,ae))return{area:"indicator",bounds:ke.indicatorIconBounds}}},[ut,Ht,cn,Le,oe,Fe]),Eo=l.useRef(0),Gn=l.useRef(),Io=l.useRef(!1),Fo=l.useCallback(M=>{const G=ze.current,se=q==null?void 0:q.current;if(G===null||M.target!==G&&M.target!==se)return;Io.current=!0;const ae=M.clientX,J=M.clientY;if(M.target===se&&se!==null){const ke=se.getBoundingClientRect();if(ae>ke.right||J>ke.bottom)return}const Q=Ke(G,ae,J,M);Gn.current=Q.location,Q.isTouch&&(Eo.current=Date.now()),It.current!==Q.isTouch&&et(Q.isTouch),!(Q.kind===Qn&&Tn(G,Q.location[0],ae,J)!==void 0)&&(Q.kind===pn&&Ro(Q.group,Q.bounds,Q.localEventX,Q.localEventY)!==void 0||(H==null||H(Q),!Q.isTouch&&Ne!==!0&&Ne!==Q.kind&&Q.button<3&&Q.button!==1&&M.preventDefault()))},[q,Ne,Ke,Ro,Tn,H]);Ut("pointerdown",Fo,Ft,!1);const lo=l.useRef(0),_n=l.useCallback(M=>{var qe,Ae;const G=lo.current;lo.current=Date.now();const se=ze.current;if(Io.current=!1,I===void 0||se===null)return;const ae=q==null?void 0:q.current,J=M.target!==se&&M.target!==ae,Q=M.clientX,ke=M.clientY,Ve=M.pointerType==="mouse"?M.button<3:!0;let ge=Ke(se,Q,ke,M);ge.isTouch&&Eo.current!==0&&Date.now()-Eo.current>500&&(ge={...ge,isLongTouch:!0}),G!==0&&Date.now()-G<(ge.isTouch?1e3:500)&&(ge={...ge,isDoubleClick:!0}),It.current!==ge.isTouch&&et(ge.isTouch),!J&&M.cancelable&&Ve&&M.preventDefault();const[Tt]=ge.location,we=Tn(se,Tt,Q,ke);if(ge.kind===Qn&&we!==void 0){(ge.button!==0||((qe=Gn.current)==null?void 0:qe[0])!==Tt||((Ae=Gn.current)==null?void 0:Ae[1])!==-1)&&I(ge,!0);return}else if(ge.kind===pn){const Be=Ro(ge.group,ge.bounds,ge.localEventX,ge.localEventY);if(Be!==void 0){ge.button===0&&Be.onClick(ge);return}}I(ge,J)},[I,q,Ke,Tn,Ro]);Ut("pointerup",_n,Ft,!1);const Do=l.useCallback(M=>{var Tt,we;const G=ze.current;if(G===null)return;const se=q==null?void 0:q.current,ae=M.target!==G&&M.target!==se;let J,Q,ke=!0;M instanceof MouseEvent?(J=M.clientX,Q=M.clientY,ke=M.button<3):(J=M.changedTouches[0].clientX,Q=M.changedTouches[0].clientY);const Ve=Ke(G,J,Q,M);It.current!==Ve.isTouch&&et(Ve.isTouch),!ae&&M.cancelable&&ke&&M.preventDefault();const[ge]=Ve.location;if(Ve.kind===Qn){const qe=Tn(G,ge,J,Q);qe!==void 0&&Ve.button===0&&((Tt=Gn.current)==null?void 0:Tt[0])===ge&&((we=Gn.current)==null?void 0:we[1])===-1&&(qe.area==="menu"?p==null||p(ge,qe.bounds):qe.area==="indicator"&&(x==null||x(ge,qe.bounds)))}},[q,Ke,Tn,p,x]);Ut("click",Do,Ft,!1);const ri=l.useCallback(M=>{const G=ze.current,se=q==null?void 0:q.current;if(G===null||M.target!==G&&M.target!==se||_===void 0)return;const ae=Ke(G,M.clientX,M.clientY,M);_(ae,()=>{M.cancelable&&M.preventDefault()})},[q,Ke,_]);Ut("contextmenu",ri,(q==null?void 0:q.current)??null,!1);const Vo=l.useCallback(M=>{Ct.current=new cr(M.map(G=>G.item)),an.current=M,ro.current(),Ct.current=void 0},[]),Ce=l.useMemo(()=>new Ed(Vo),[Vo]),qo=l.useRef(Ce);qo.current=Ce,l.useLayoutEffect(()=>{const M=qo.current;if(In===void 0||In[1]<0){M.setHovered(In);return}const G=m(In,!0),se=_e(G),ae=se===void 0&&G.kind===U.Custom||(se==null?void 0:se.needsHover)!==void 0&&(typeof se.needsHover=="boolean"?se.needsHover:se.needsHover(G));M.setHovered(ae?In:void 0)},[m,_e,In]);const vr=l.useRef(),dn=l.useCallback(M=>{var Ve;const G=ze.current;if(G===null)return;const se=q==null?void 0:q.current,ae=M.target!==G&&M.target!==se,J=Ke(G,M.clientX,M.clientY,M);if(J.kind!=="out-of-bounds"&&ae&&!Io.current&&!J.isTouch)return;const Q=(ge,Tt)=>{Rn(we=>we===ge||(we==null?void 0:we[0][0])===(ge==null?void 0:ge[0][0])&&(we==null?void 0:we[0][1])===(ge==null?void 0:ge[0][1])&&((we==null?void 0:we[1][0])===(ge==null?void 0:ge[1][0])&&(we==null?void 0:we[1][1])===(ge==null?void 0:ge[1][1])||!Tt)?we:ge)};if(!As(J,vr.current))Dt(void 0),re==null||re(J),Q(J.kind===qr?void 0:[J.location,[J.localEventX,J.localEventY]],!0),vr.current=J;else if(J.kind==="cell"||J.kind===Qn||J.kind===pn){let ge=!1,Tt=!0;if(J.kind==="cell"){const qe=m(J.location);Tt=((Ve=_e(qe))==null?void 0:Ve.needsHoverPosition)??qe.kind===U.Custom,ge=Tt}else ge=!0;const we=[J.location,[J.localEventX,J.localEventY]];Q(we,Tt),On.current=we,ge&&Hn(new cr([J.location]))}const ke=J.location[0]>=(be?0:1);wt(J.kind===Qn&&J.isEdge&&ke&&tt===!0),ei(J.kind==="cell"&&J.isFillHandle),le==null||le(M),j(J)},[q,Ke,be,tt,le,j,re,m,_e,Hn]);Ut("pointermove",dn,Ft,!0);const ii=l.useCallback(M=>{const G=ze.current;if(G===null)return;let se,ae;E.current!==void 0&&(se=Ht(G,E.current.cell[0],E.current.cell[1]),ae=E.current.cell),te==null||te({bounds:se,stopPropagation:()=>M.stopPropagation(),preventDefault:()=>M.preventDefault(),cancel:()=>{},ctrlKey:M.ctrlKey,metaKey:M.metaKey,shiftKey:M.shiftKey,altKey:M.altKey,key:M.key,keyCode:M.keyCode,rawEvent:M,location:ae})},[te,E,Ht]),yn=l.useCallback(M=>{const G=ze.current;if(G===null)return;let se,ae;E.current!==void 0&&(se=Ht(G,E.current.cell[0],E.current.cell[1]),ae=E.current.cell),K==null||K({bounds:se,stopPropagation:()=>M.stopPropagation(),preventDefault:()=>M.preventDefault(),cancel:()=>{},ctrlKey:M.ctrlKey,metaKey:M.metaKey,shiftKey:M.shiftKey,altKey:M.altKey,key:M.key,keyCode:M.keyCode,rawEvent:M,location:ae})},[K,E,Ht]),jo=l.useCallback(M=>{if(ze.current=M,ne!==void 0&&(ne.current=M),pe!=null&&pe.eventTarget)kt.current=pe.eventTarget;else if(M===null)kt.current=window;else{const G=M.getRootNode();G===document&&(kt.current=window),kt.current=G}},[ne,pe==null?void 0:pe.eventTarget]),Cr=l.useCallback(M=>{const G=ze.current;if(G===null||Ne===!1||oe){M.preventDefault();return}let se,ae;const J=Ke(G,M.clientX,M.clientY);if(Ne!==!0&&J.kind!==Ne){M.preventDefault();return}const Q=(qe,Ae)=>{se=qe,ae=Ae};let ke,Ve,ge;const Tt=(qe,Ae,Be)=>{ke=qe,Ve=Ae,ge=Be};let we=!1;if(fe==null||fe({...J,setData:Q,setDragImage:Tt,preventDefault:()=>we=!0,defaultPrevented:()=>we}),!we&&se!==void 0&&ae!==void 0&&M.dataTransfer!==null)if(M.dataTransfer.setData(se,ae),M.dataTransfer.effectAllowed="copyLink",ke!==void 0&&Ve!==void 0&&ge!==void 0)M.dataTransfer.setDragImage(ke,Ve,ge);else{const[qe,Ae]=J.location;if(Ae!==void 0){const Be=document.createElement("canvas"),De=Ht(G,qe,Ae);Qt(De!==void 0);const Je=Math.ceil(window.devicePixelRatio??1);Be.width=De.width*Je,Be.height=De.height*Je;const St=Be.getContext("2d");St!==null&&(St.scale(Je,Je),St.textBaseline="middle",Ae===-1?(St.font=Fe.headerFontFull,St.fillStyle=Fe.bgHeader,St.fillRect(0,0,Be.width,Be.height),Hs(St,0,0,De.width,De.height,ut[qe],!1,Fe,!1,void 0,void 0,!1,0,it,he,!1)):(St.font=Fe.baseFontFull,St.fillStyle=Fe.bgCell,St.fillRect(0,0,Be.width,Be.height),Is(St,m([qe,Ae]),0,Ae,!1,!1,0,0,De.width,De.height,!1,Fe,Fe.bgCell,Lt,it,1,void 0,!1,0,void 0,void 0,void 0,yo,_e,()=>{}))),Be.style.left="-100%",Be.style.position="absolute",Be.style.width=`${De.width}px`,Be.style.height=`${De.height}px`,document.body.append(Be),M.dataTransfer.setDragImage(Be,De.width/2,De.height/2),window.setTimeout(()=>{Be.remove()},0)}}else M.preventDefault()},[Ne,oe,Ke,fe,Ht,Fe,ut,it,he,m,Lt,yo,_e]);Ut("dragstart",Cr,(q==null?void 0:q.current)??null,!1,!1);const Ho=l.useRef(),li=l.useCallback(M=>{const G=ze.current;if(me!==void 0&&M.preventDefault(),G===null||Re===void 0)return;const se=Ke(G,M.clientX,M.clientY),[ae,J]=se.location,Q=ae-(be?0:1),[ke,Ve]=Ho.current??[];(ke!==Q||Ve!==J)&&(Ho.current=[Q,J],Re([Q,J],M.dataTransfer))},[be,Ke,Re,me]);Ut("dragover",li,(q==null?void 0:q.current)??null,!1,!1);const si=l.useCallback(()=>{Ho.current=void 0,Ge==null||Ge()},[Ge]);Ut("dragend",si,(q==null?void 0:q.current)??null,!1,!1);const vn=l.useCallback(M=>{const G=ze.current;if(G===null||me===void 0)return;M.preventDefault();const se=Ke(G,M.clientX,M.clientY),[ae,J]=se.location,Q=ae-(be?0:1);me([Q,J],M.dataTransfer)},[be,Ke,me]);Ut("drop",vn,(q==null?void 0:q.current)??null,!1,!1);const Un=l.useCallback(()=>{je==null||je()},[je]);Ut("dragleave",Un,(q==null?void 0:q.current)??null,!1,!1);const Zt=l.useRef(E);Zt.current=E;const F=l.useRef(null),bt=l.useCallback(M=>{var G;ze.current===null||!ze.current.contains(document.activeElement)||(M===null&&Zt.current.current!==void 0?(G=ne==null?void 0:ne.current)==null||G.focus({preventScroll:!0}):M!==null&&M.focus({preventScroll:!0}),F.current=M)},[ne]);l.useImperativeHandle(t,()=>({focus:()=>{var G;const M=F.current;M===null||!document.contains(M)?(G=ne==null?void 0:ne.current)==null||G.focus({preventScroll:!0}):M.focus({preventScroll:!0})},getBounds:(M,G)=>{if(!(ne===void 0||ne.current===null))return Ht(ne.current,M??0,G??-1)},damage:wr,getMouseArgsForPosition:(M,G,se)=>{if(!(ne===void 0||ne.current===null))return Ke(ne.current,M,G,se)}}),[ne,wr,Ht,Ke]);const An=l.useRef(),ai=Qa(()=>{var Ve,ge,Tt;if(n<50||(pe==null?void 0:pe.disableAccessibilityTree)===!0)return null;let M=Bi(ut,ot,n,Ee,Qe);const G=be?0:-1;!be&&((Ve=M[0])==null?void 0:Ve.sourceIndex)===0&&(M=M.slice(1));const[se,ae]=((ge=E.current)==null?void 0:ge.cell)??[],J=(Tt=E.current)==null?void 0:Tt.range,Q=M.map(we=>we.sourceIndex),ke=eo(s,Math.min(w,s+r));return se!==void 0&&ae!==void 0&&!(Q.includes(se)&&ke.includes(ae))&&bt(null),l.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":w+1,"aria-multiselectable":"true","aria-colcount":ut.length+G},l.createElement("thead",{role:"rowgroup"},l.createElement("tr",{role:"row","aria-rowindex":1},M.map(we=>l.createElement("th",{role:"columnheader","aria-selected":E.columns.hasIndex(we.sourceIndex),"aria-colindex":we.sourceIndex+1+G,tabIndex:-1,onFocus:qe=>{if(qe.target!==F.current)return xe==null?void 0:xe([we.sourceIndex,-1])},key:we.sourceIndex},we.title)))),l.createElement("tbody",{role:"rowgroup"},ke.map(we=>l.createElement("tr",{role:"row","aria-selected":E.rows.hasIndex(we),key:we,"aria-rowindex":we+2},M.map(qe=>{const Ae=qe.sourceIndex,Be=wn(Ae,we),De=se===Ae&&ae===we,Je=J!==void 0&&Ae>=J.x&&Ae<J.x+J.width&&we>=J.y&&we<J.y+J.height,St=`glide-cell-${Ae}-${we}`,un=[Ae,we],fn=m(un,!0);return l.createElement("td",{key:Be,role:"gridcell","aria-colindex":Ae+1+G,"aria-selected":Je,"aria-readonly":No(fn)||!Oo(fn),id:St,"data-testid":St,onClick:()=>{const yt=ne==null?void 0:ne.current;if(yt!=null)return te==null?void 0:te({bounds:Ht(yt,Ae,we),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:un})},onFocusCapture:yt=>{var Rt,lt;if(!(yt.target===F.current||((Rt=An.current)==null?void 0:Rt[0])===Ae&&((lt=An.current)==null?void 0:lt[1])===we))return An.current=un,xe==null?void 0:xe(un)},ref:De?bt:void 0,tabIndex:-1},Hd(fn,_e))})))))},[n,ut,ot,Ee,Qe,w,s,r,E,bt,m,ne,te,Ht,xe],200),so=D===0||!$?0:ot>D?1:ln(-Qe/100,0,1),ci=-s*32+pt,To=X?ln(-ci/100,0,1):0,ji=l.useMemo(()=>{if(!so&&!To)return null;const M={position:"absolute",top:0,left:$n,width:n-$n,height:o,opacity:so,pointerEvents:"none",transition:Ze?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},G={position:"absolute",top:tn,left:0,width:n,height:o,opacity:To,pointerEvents:"none",transition:ie?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return l.createElement(l.Fragment,null,so>0&&l.createElement("div",{id:"shadow-x",style:M}),To>0&&l.createElement("div",{id:"shadow-y",style:G}))},[so,To,$n,n,Ze,tn,o,ie]),W=l.useMemo(()=>({position:"absolute",top:0,left:0}),[]);return l.createElement(l.Fragment,null,l.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:0,onKeyDown:ii,onKeyUp:yn,onFocus:k,onBlur:T,ref:jo,style:Mo},ai),l.createElement("canvas",{ref:$t,style:W}),ji)},Ad=l.memo(l.forwardRef(Td));function lr(e,t,n,o){return ln(Math.round(t-(e.growOffset??0)),Math.ceil(n),Math.floor(o))}const zd=e=>{const[t,n]=l.useState(),[o,r]=l.useState(),[i,a]=l.useState(),[s,c]=l.useState(),[f,u]=l.useState(!1),[g,w]=l.useState(),[m,h]=l.useState(),[p,x]=l.useState(),[y,b]=l.useState(!1),[k,T]=l.useState(),{onHeaderMenuClick:A,onHeaderIndicatorClick:E,getCellContent:D,onColumnMoved:_,onColumnResize:R,onColumnResizeStart:$,onColumnResizeEnd:X,gridRef:L,maxColumnWidth:H,minColumnWidth:I,onRowMoved:le,lockColumns:j,onColumnProposeMove:re,onMouseDown:Ee,onMouseUp:be,onItemHovered:te,onDragStart:K,canvasRef:ve}=e,ne=(R??X??$)!==void 0,{columns:fe,selection:Ge}=e,q=Ge.columns,oe=l.useCallback(Z=>{const[he,xe]=Z.location;i!==void 0&&s!==he&&he>=j?(u(!0),c(he)):m!==void 0&&xe!==void 0?(b(!0),x(Math.max(0,xe))):o===void 0&&!f&&!y&&(te==null||te(Z))},[i,m,s,te,j,o,f,y]),ue=_!==void 0,Le=l.useCallback(Z=>{var he;if(Z.button===0){const[xe,Re]=Z.location;if(Z.kind==="out-of-bounds"&&Z.isEdge&&ne){const me=(he=L==null?void 0:L.current)==null?void 0:he.getBounds(fe.length-1,-1);me!==void 0&&(n(me.x),r(fe.length-1))}else if(Z.kind==="header"&&xe>=j){const me=ve==null?void 0:ve.current;if(Z.isEdge&&ne&&me){n(Z.bounds.x),r(xe);const Xe=me.getBoundingClientRect().width/me.offsetWidth,Ze=Z.bounds.width/Xe;$==null||$(fe[xe],Ze,xe,Ze+(fe[xe].growOffset??0))}else Z.kind==="header"&&ue&&(w(Z.bounds.x),a(xe))}else Z.kind==="cell"&&j>0&&xe===0&&Re!==void 0&&le!==void 0&&(T(Z.bounds.y),h(Re))}Ee==null||Ee(Z)},[Ee,ne,j,le,L,fe,ue,$,ve]),Ne=l.useCallback((Z,he)=>{f||y||A==null||A(Z,he)},[f,y,A]),tt=l.useCallback((Z,he)=>{f||y||E==null||E(Z,he)},[f,y,E]),rt=l.useRef(-1),Me=l.useCallback(()=>{rt.current=-1,h(void 0),x(void 0),T(void 0),b(!1),a(void 0),c(void 0),w(void 0),u(!1),r(void 0),n(void 0)},[]),Te=l.useCallback((Z,he)=>{if(Z.button===0){if(o!==void 0){if((q==null?void 0:q.hasIndex(o))===!0)for(const Re of q){if(Re===o)continue;const me=fe[Re],je=lr(me,rt.current,I,H);R==null||R(me,je,Re,je+(me.growOffset??0))}const xe=lr(fe[o],rt.current,I,H);if(X==null||X(fe[o],xe,o,xe+(fe[o].growOffset??0)),q.hasIndex(o))for(const Re of q){if(Re===o)continue;const me=fe[Re],je=lr(me,rt.current,I,H);X==null||X(me,je,Re,je+(me.growOffset??0))}}Me(),i!==void 0&&s!==void 0&&(re==null?void 0:re(i,s))!==!1&&(_==null||_(i,s)),m!==void 0&&p!==void 0&&(le==null||le(m,p))}be==null||be(Z,he)},[be,o,i,s,m,p,q,X,fe,I,H,R,_,le,Me,re]),Fe=l.useMemo(()=>{if(!(i===void 0||s===void 0)&&i!==s&&(re==null?void 0:re(i,s))!==!1)return{src:i,dest:s}},[i,s,re]),gt=l.useCallback(Z=>{const he=ve==null?void 0:ve.current;if(i!==void 0&&g!==void 0)Math.abs(Z.clientX-g)>20&&u(!0);else if(m!==void 0&&k!==void 0)Math.abs(Z.clientY-k)>20&&b(!0);else if(o!==void 0&&t!==void 0&&he){const Re=he.getBoundingClientRect().width/he.offsetWidth,me=(Z.clientX-t)/Re,je=fe[o],Xe=lr(je,me,I,H);if(R==null||R(je,Xe,o,Xe+(je.growOffset??0)),rt.current=me,(q==null?void 0:q.first())===o)for(const Ze of q){if(Ze===o)continue;const ie=fe[Ze],pe=lr(ie,rt.current,I,H);R==null||R(ie,pe,Ze,pe+(ie.growOffset??0))}}},[i,g,m,k,o,t,fe,I,H,R,q,ve]),mt=l.useCallback((Z,he)=>{if(m===void 0||p===void 0)return D(Z,he);let[xe,Re]=Z;return Re===p?Re=m:(Re>p&&(Re-=1),Re>=m&&(Re+=1)),D([xe,Re],he)},[m,p,D]),ct=l.useCallback(Z=>{K==null||K(Z),Z.defaultPrevented()||Me()},[Me,K]);return l.createElement(Ad,{accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,enableGroups:e.enableGroups,eventTargetRef:e.eventTargetRef,experimental:e.experimental,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,headerIcons:e.headerIcons,height:e.height,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,resizeColumn:o,isDraggable:e.isDraggable,isFilling:e.isFilling,isFocused:e.isFocused,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDrop:e.onDrop,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,resizeIndicator:e.resizeIndicator,verticalBorder:e.verticalBorder,width:e.width,getCellContent:mt,isResizing:o!==void 0,onHeaderMenuClick:Ne,onHeaderIndicatorClick:tt,isDragging:f,onItemHovered:oe,onDragStart:ct,onMouseDown:Le,allowResize:ne,onMouseUp:Te,dragAndDropState:Fe,onMouseMoveRaw:gt,ref:L})};function Bd(e){const t=l.useRef(null),[n,o]=l.useState({width:e==null?void 0:e[0],height:e==null?void 0:e[1]});return l.useLayoutEffect(()=>{const r=a=>{for(const s of a){const{width:c,height:f}=s&&s.contentRect||{};o(u=>u.width===c&&u.height===f?u:{width:c,height:f})}},i=new window.ResizeObserver(r);return t.current&&i.observe(t.current,void 0),()=>{i.disconnect()}},[t.current]),{ref:t,...n}}const Pd=(e,t,n)=>{const o=l.useRef(null),r=l.useRef(null),i=l.useRef(null),a=l.useRef(0),s=l.useRef(t);s.current=t;const c=n.current;l.useEffect(()=>{const f=()=>{var w,m;if(r.current===!1&&c!==null){const h=[c.scrollLeft,c.scrollTop];if(((w=i.current)==null?void 0:w[0])===h[0]&&((m=i.current)==null?void 0:m[1])===h[1])if(a.current>10){i.current=null,r.current=null;return}else a.current++;else a.current=0,s.current(h[0],h[1]),i.current=h;o.current=window.setTimeout(f,8.333333333333334)}},u=()=>{r.current=!0,i.current=null,o.current!==null&&(window.clearTimeout(o.current),o.current=null)},g=w=>{w.touches.length===0&&(r.current=!1,a.current=0,o.current=window.setTimeout(f,8.333333333333334))};if(e&&c!==null){const w=c;return w.addEventListener("touchstart",u),w.addEventListener("touchend",g),()=>{w.removeEventListener("touchstart",u),w.removeEventListener("touchend",g),o.current!==null&&window.clearTimeout(o.current)}}},[e,c])},Ld=()=>e=>e.isSafari?"scroll":"auto",Wd=Wt("div")({name:"ScrollRegionStyle",class:"gdg-s1dgczr6",propsAsIs:!1,vars:{"s1dgczr6-0":[Ld()]}}),$d=33554400,Od=5e6;function Nd(e){const[t,n]=l.useState(!1),o=typeof window>"u"?null:window,r=l.useRef(0);return Ut("touchstart",l.useCallback(()=>{window.clearTimeout(r.current),n(!0)},[]),o,!0,!1),Ut("touchend",l.useCallback(i=>{i.touches.length===0&&(r.current=window.setTimeout(()=>n(!1),e))},[e]),o,!0,!1),t}const Xd=e=>{var Ge,q;const{children:t,clientHeight:n,scrollHeight:o,scrollWidth:r,update:i,draggable:a,className:s,preventDiagonalScrolling:c=!1,paddingBottom:f=0,paddingRight:u=0,rightElement:g,rightElementProps:w,kineticScrollPerfHack:m=!1,scrollRef:h,initialSize:p}=e,x=[],y=(w==null?void 0:w.sticky)??!1,b=(w==null?void 0:w.fill)??!1,k=l.useRef(0),T=l.useRef(0),A=l.useRef(null),E=typeof window>"u"?1:window.devicePixelRatio,D=l.useRef(E);l.useEffect(()=>{if(D.current!==E){k.current=0,T.current=0,D.current=E;const oe=A.current;oe!==null&&le.current(oe.scrollLeft,oe.scrollTop)}},[E]);const _=l.useRef({scrollLeft:0,scrollTop:0,lockDirection:void 0}),R=l.useRef(null),$=Nd(200),[X,L]=l.useState(!0),H=l.useRef(0);l.useLayoutEffect(()=>{if(!X||$||_.current.lockDirection===void 0)return;const oe=A.current;if(oe===null)return;const[ue,Le]=_.current.lockDirection;ue!==void 0?oe.scrollLeft=ue:Le!==void 0&&(oe.scrollTop=Le),_.current.lockDirection=void 0},[$,X]);const I=l.useCallback((oe,ue)=>{var xe;const Le=A.current;if(Le===null)return;ue=ue??Le.scrollTop,oe=oe??Le.scrollLeft;const Ne=_.current.scrollTop,tt=_.current.scrollLeft,rt=oe-tt,Me=ue-Ne;$&&rt!==0&&Me!==0&&(Math.abs(rt)>3||Math.abs(Me)>3)&&c&&_.current.lockDirection===void 0&&(_.current.lockDirection=Math.abs(rt)<Math.abs(Me)?[tt,void 0]:[void 0,Ne]);const Te=_.current.lockDirection;oe=(Te==null?void 0:Te[0])??oe,ue=(Te==null?void 0:Te[1])??ue,_.current.scrollLeft=oe,_.current.scrollTop=ue;const Fe=Le.clientWidth,gt=Le.clientHeight,mt=ue,ct=T.current-mt,Z=Le.scrollHeight-gt;T.current=mt;let he;if(Z>0&&o>Le.scrollHeight+5)if(Math.abs(ct)>2e3||mt===0||mt===Z){const Re=Math.max(0,Math.min(1,mt/Z)),me=o-gt;he=Re*me,k.current=he}else k.current-=ct,he=k.current;else he=mt,k.current=he;he=Math.max(0,Math.min(he,o-gt)),k.current=he,Te!==void 0&&(window.clearTimeout(H.current),L(!1),H.current=window.setTimeout(()=>L(!0),200)),i({x:oe,y:he,width:Fe-u,height:gt-f,paddingRight:((xe=R.current)==null?void 0:xe.clientWidth)??0})},[f,u,o,i,c,$]);Pd(m&&Kr.value,I,A);const le=l.useRef(I);le.current=I;const j=l.useRef(),re=l.useRef(!1);l.useLayoutEffect(()=>{re.current?I():re.current=!0},[I,f,u]);const Ee=l.useCallback(oe=>{A.current=oe,h!==void 0&&(h.current=oe)},[h]);let be=0,te=0;const K=Math.min(o,$d);for(x.push(l.createElement("div",{key:be++,style:{width:r,height:0}}));te<K;){const oe=Math.min(Od,K-te);x.push(l.createElement("div",{key:be++,style:{width:0,height:oe}})),te+=oe}const{ref:ve,width:ne,height:fe}=Bd(p);return typeof window<"u"&&(((Ge=j.current)==null?void 0:Ge.height)!==fe||((q=j.current)==null?void 0:q.width)!==ne)&&(window.setTimeout(()=>le.current(),0),j.current={width:ne,height:fe}),(ne??0)===0||(fe??0)===0?l.createElement("div",{ref:ve}):l.createElement("div",{ref:ve},l.createElement(Wd,{isSafari:Kr.value},l.createElement("div",{className:"dvn-underlay"},t),l.createElement("div",{ref:Ee,style:j.current,draggable:a,onDragStart:oe=>{a||(oe.stopPropagation(),oe.preventDefault())},className:"dvn-scroller "+(s??""),onScroll:()=>I()},l.createElement("div",{className:"dvn-scroll-inner"+(g===void 0?" dvn-hidden":"")},l.createElement("div",{className:"dvn-stack"},x),g!==void 0&&l.createElement(l.Fragment,null,!b&&l.createElement("div",{className:"dvn-spacer"}),l.createElement("div",{ref:R,style:{height:fe,maxHeight:n-Math.ceil(E%1),position:"sticky",top:0,paddingLeft:1,marginBottom:-40,marginRight:u,flexGrow:b?1:void 0,right:y?u??0:void 0,pointerEvents:"auto"}},g))))))},Gd=e=>{const{columns:t,rows:n,rowHeight:o,headerHeight:r,groupHeaderHeight:i,enableGroups:a,freezeColumns:s,experimental:c,nonGrowWidth:f,clientSize:u,className:g,onVisibleRegionChanged:w,scrollRef:m,preventDiagonalScrolling:h,rightElement:p,rightElementProps:x,overscrollX:y,overscrollY:b,initialSize:k,smoothScrollX:T=!1,smoothScrollY:A=!1,isDraggable:E}=e,{paddingRight:D,paddingBottom:_}=c??{},[R,$]=u,X=l.useRef(),L=l.useRef(),H=l.useRef(),I=l.useRef(),le=f+Math.max(0,y??0);let j=a?r+i:r;if(typeof o=="number")j+=n*o;else for(let te=0;te<n;te++)j+=o(te);b!==void 0&&(j+=b);const re=l.useRef(),Ee=l.useCallback(()=>{var tt,rt;if(re.current===void 0)return;const te={...re.current};let K=0,ve=te.x<0?-te.x:0,ne=0,fe=0;te.x=te.x<0?0:te.x;let Ge=0;for(let Me=0;Me<s;Me++)Ge+=t[Me].width;for(const Me of t){const Te=K-Ge;if(te.x>=Te+Me.width)K+=Me.width,fe++,ne++;else if(te.x>Te)K+=Me.width,T?ve+=Te-te.x:fe++,ne++;else if(te.x+te.width>Te)K+=Me.width,ne++;else break}let q=0,oe=0,ue=0;if(typeof o=="number")A?(oe=Math.floor(te.y/o),q=oe*o-te.y):oe=Math.ceil(te.y/o),ue=Math.ceil(te.height/o)+oe,q<0&&ue++;else{let Me=0;for(let Te=0;Te<n;Te++){const Fe=o(Te),gt=Me+(A?0:Fe/2);if(te.y>=Me+Fe)Me+=Fe,oe++,ue++;else if(te.y>gt)Me+=Fe,A?q+=gt-te.y:oe++,ue++;else if(te.y+te.height>Fe/2+Me)Me+=Fe,ue++;else break}}oe=Math.max(0,Math.min(oe,n-1)),ue=Math.max(oe,Math.min(ue,n));const Le={x:fe,y:oe,width:ne-fe,height:ue-oe},Ne=X.current;(Ne===void 0||Ne.y!==Le.y||Ne.x!==Le.x||Ne.height!==Le.height||Ne.width!==Le.width||L.current!==ve||H.current!==q||te.width!==((tt=I.current)==null?void 0:tt[0])||te.height!==((rt=I.current)==null?void 0:rt[1]))&&(w==null||w({x:fe,y:oe,width:ne-fe,height:ue-oe},te.width,te.height,te.paddingRight??0,ve,q),X.current=Le,L.current=ve,H.current=q,I.current=[te.width,te.height])},[t,o,n,w,s,T,A]),be=l.useCallback(te=>{re.current=te,Ee()},[Ee]);return l.useEffect(()=>{Ee()},[Ee]),l.createElement(Xd,{scrollRef:m,className:g,kineticScrollPerfHack:c==null?void 0:c.kineticScrollPerfHack,preventDiagonalScrolling:h,draggable:E===!0||typeof E=="string",scrollWidth:le+(D??0),scrollHeight:j+(_??0),clientHeight:$,rightElement:p,paddingBottom:_,paddingRight:D,rightElementProps:x,update:be,initialSize:k},l.createElement(zd,{eventTargetRef:m,width:R,height:$,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,prelightCells:e.prelightCells,rowHeight:e.rowHeight,rows:e.rows,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,onColumnProposeMove:e.onColumnProposeMove,verticalBorder:e.verticalBorder,drawFocusRing:e.drawFocusRing,drawHeader:e.drawHeader,drawCell:e.drawCell,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}))},_d=Wt("div")({name:"SearchWrapper",class:"gdg-seveqep",propsAsIs:!1}),Ud=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Yd=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Kd=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Vd=10,qd=e=>{const{canvasRef:t,cellYOffset:n,rows:o,columns:r,searchInputRef:i,searchValue:a,searchResults:s,onSearchValueChange:c,getCellsForSelection:f,onSearchResultsChanged:u,showSearch:g=!1,onSearchClose:w}=e,[m]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[h,p]=l.useState(""),x=a??h,y=l.useCallback(K=>{p(K),c==null||c(K)},[c]),[b,k]=l.useState(),T=l.useRef(b);T.current=b,l.useEffect(()=>{s!==void 0&&(s.length>0?k(K=>({rowsSearched:o,results:s.length,selectedIndex:(K==null?void 0:K.selectedIndex)??-1})):k(void 0))},[o,s]);const A=l.useRef();A.current===void 0&&(A.current=new AbortController);const E=l.useRef(),[D,_]=l.useState([]),R=s??D,$=l.useCallback(()=>{E.current!==void 0&&(window.cancelAnimationFrame(E.current),E.current=void 0),A.current!==void 0&&A.current.abort(),A.current=new AbortController},[]),X=l.useRef(n);X.current=n;const L=l.useCallback(K=>{const ve=new RegExp(K.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let ne=X.current,fe=Math.min(10,o),Ge=0;k(void 0),_([]);const q=[],oe=async()=>{var mt;if(f===void 0)return;const ue=performance.now(),Le=o-Ge;let Ne=f({x:0,y:ne,width:r.length,height:Math.min(fe,Le,o-ne)},A.current.signal);typeof Ne=="function"&&(Ne=await Ne());let tt=!1;for(const[ct,Z]of Ne.entries())for(const[he,xe]of Z.entries()){let Re;switch(xe.kind){case U.Text:case U.Number:Re=xe.displayData;break;case U.Uri:case U.Markdown:Re=xe.data;break;case U.Boolean:Re=typeof xe.data=="boolean"?xe.data.toString():void 0;break;case U.Image:case U.Bubble:Re=xe.data.join("🐳");break;case U.Custom:Re=xe.copyData;break}Re!==void 0&&ve.test(Re)&&(q.push([he,ct+ne]),tt=!0)}const rt=performance.now();tt&&_([...q]),Ge+=Ne.length,Qt(Ge<=o);const Me=((mt=T.current)==null?void 0:mt.selectedIndex)??-1;k({results:q.length,rowsSearched:Ge,selectedIndex:Me}),u==null||u(q,Me),ne+fe>=o?ne=0:ne+=fe;const Te=rt-ue,Fe=Math.max(Te,1),gt=Vd/Fe;fe=Math.ceil(fe*gt),Ge<o&&q.length<1e3&&(E.current=window.requestAnimationFrame(oe))};$(),E.current=window.requestAnimationFrame(oe)},[$,r.length,f,u,o]),H=l.useCallback(()=>{var K;w==null||w(),k(void 0),_([]),u==null||u([],-1),$(),(K=t==null?void 0:t.current)==null||K.focus()},[$,t,w,u]),I=l.useCallback(K=>{y(K.target.value),s===void 0&&(K.target.value===""?(k(void 0),_([]),$()):L(K.target.value))},[L,$,y,s]);l.useEffect(()=>{i.current!==null&&(y(""),k(void 0),D.length>0&&(_([]),u==null||u([],-1)),g?i.current.focus({preventScroll:!0}):$())},[g,i]);const le=l.useCallback(K=>{var ne;if((ne=K==null?void 0:K.stopPropagation)==null||ne.call(K),b===void 0||b.results===0)return;const ve=(b.selectedIndex+1)%b.results;k({...b,selectedIndex:ve}),u==null||u(R,ve)},[b,u,R]),j=l.useCallback(K=>{var ne;if((ne=K==null?void 0:K.stopPropagation)==null||ne.call(K),b===void 0||b.results===0)return;let ve=(b.selectedIndex-1)%b.results;ve<0&&(ve+=b.results),k({...b,selectedIndex:ve}),u==null||u(R,ve)},[u,R,b]),re=l.useCallback(K=>{(K.ctrlKey||K.metaKey)&&K.nativeEvent.code==="KeyF"||K.key==="Escape"?(H(),K.stopPropagation(),K.preventDefault()):K.key==="Enter"&&(K.shiftKey?j():le())},[H,le,j]);l.useEffect(()=>()=>{$()},[$]);const[Ee,be]=l.useState(!1);l.useEffect(()=>{if(g)be(!0);else{const K=setTimeout(()=>be(!1),150);return()=>clearTimeout(K)}},[g]);const te=l.useMemo(()=>{if(!g&&!Ee)return null;let K;b!==void 0&&(K=b.results>=1e3?"over 1000":`${b.results} result${b.results!==1?"s":""}`,b.selectedIndex>=0&&(K=`${b.selectedIndex+1} of ${K}`));const ve=Ge=>{Ge.stopPropagation()},fe={width:`${o>0?Math.floor(((b==null?void 0:b.rowsSearched)??0)/o*100):0}%`};return l.createElement(_d,{className:"gdg-search-bar"+(g?"":" out"),onMouseDown:ve,onMouseMove:ve,onMouseUp:ve,onClick:ve},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:m,"aria-hidden":!g,"data-testid":"search-input",ref:i,onChange:I,value:x,tabIndex:g?void 0:-1,onKeyDownCapture:re}),l.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:j,disabled:((b==null?void 0:b.results)??0)===0},Ud),l.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!g,tabIndex:g?void 0:-1,onClick:le,disabled:((b==null?void 0:b.results)??0)===0},Yd),w!==void 0&&l.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!g,"data-testid":"search-close-button",tabIndex:g?void 0:-1,onClick:H},Kd)),b!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},K)),l.createElement("div",{className:"gdg-search-progress",style:fe})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:m},"Type to search")))},[g,Ee,b,o,m,i,I,x,re,j,le,w,H]);return l.createElement(l.Fragment,null,l.createElement(Gd,{prelightCells:R,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),te)};class jd extends l.PureComponent{constructor(){super(...arguments);Pe(this,"wrapperRef",l.createRef());Pe(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:r,...i}=this.props;return l.createElement("div",{...i,ref:this.wrapperRef},this.props.children)}}const Zd=()=>e=>Math.max(16,e.targetHeight-10),Jd=Wt("input")({name:"RenameInput",class:"gdg-r17m35ur",propsAsIs:!1,vars:{"r17m35ur-0":[Zd(),"px"]}}),Qd=e=>{const{bounds:t,group:n,onClose:o,canvasBounds:r,onFinish:i}=e,[a,s]=at.useState(n);return at.createElement(jd,{style:{position:"absolute",left:t.x-r.left+1,top:t.y-r.top,width:t.width-2,height:t.height},className:"gdg-c1tqibwd",onClickOutside:o},at.createElement(Jd,{targetHeight:t.height,"data-testid":"group-rename-input",value:a,onBlur:o,onFocus:c=>c.target.setSelectionRange(0,a.length),onChange:c=>s(c.target.value),onKeyDown:c=>{c.key==="Enter"?i(a):c.key==="Escape"&&o()},autoFocus:!0}))};function eu(e,t){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===t.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===t.keyCode:e===t.key}function $e(e,t,n){const o=zs(e,t);return o&&(n.didMatch=!0),o}function zs(e,t){if(e.length===0)return!1;if(e.includes("|")){const c=e.split("|");for(const f of c)if(zs(f,t))return!0;return!1}let n=!1,o=!1,r=!1,i=!1;const a=e.split("+"),s=a.pop();if(!eu(s,t))return!1;if(a[0]==="any")return!0;for(const c of a)switch(c){case"ctrl":n=!0;break;case"shift":o=!0;break;case"alt":r=!0;break;case"meta":i=!0;break;case"primary":Vr.value?i=!0:n=!0;break}return t.altKey===r&&t.ctrlKey===n&&t.shiftKey===o&&t.metaKey===i}function tu(e,t,n,o,r,i,a){const s=at.useCallback((u,g,w,m)=>{var k;(i==="cell"||i==="multi-cell")&&u!==void 0&&(u={...u,range:{x:u.cell[0],y:u.cell[1],width:1,height:1}}),!a&&u!==void 0&&u.range.width>1&&(u={...u,range:{...u.range,width:1,x:u.cell[0]}});const h=n==="mixed"&&(w||m==="drag")||n==="additive",p=(o==="mixed"||o==="additive")&&h,x=(r==="mixed"||r==="additive")&&h;let y={current:u===void 0?void 0:{...u,rangeStack:m==="drag"?((k=e.current)==null?void 0:k.rangeStack)??[]:[]},columns:p?e.columns:st.empty(),rows:x?e.rows:st.empty()};w&&(i==="multi-rect"||i==="multi-cell")&&y.current!==void 0&&e.current!==void 0&&(y={...y,current:{...y.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),t(y,g)},[o,e,n,i,a,r,t]),c=at.useCallback((u,g,w)=>{u=u??e.rows,g!==void 0&&(u=u.add(g));let m;if(r==="exclusive"&&u.length>0)m={current:void 0,columns:st.empty(),rows:u};else{const h=w&&n==="mixed"||n==="additive",p=w&&o==="mixed"||o==="additive";m={current:h?e.current:void 0,columns:p?e.columns:st.empty(),rows:u}}t(m,!1)},[o,e,n,r,t]),f=at.useCallback((u,g,w)=>{u=u??e.columns,g!==void 0&&(u=u.add(g));let m;if(o==="exclusive"&&u.length>0)m={current:void 0,rows:st.empty(),columns:u};else{const h=w&&n==="mixed"||n==="additive",p=w&&r==="mixed"||r==="additive";m={current:h?e.current:void 0,rows:p?e.rows:st.empty(),columns:u}}t(m,!1)},[o,e,n,r,t]);return[s,c,f]}function nu(e,t,n,o,r){const i=l.useCallback(f=>{if(e===!0){const u=[];for(let g=f.y;g<f.y+f.height;g++){const w=[];for(let m=f.x;m<f.x+f.width;m++)m<0||g>=r?w.push({kind:U.Loading,allowOverlay:!1}):w.push(t([m,g]));u.push(w)}return u}return(e==null?void 0:e(f,o.signal))??[]},[o.signal,t,e,r]),a=e!==void 0?i:void 0,s=l.useCallback(f=>{if(a===void 0)return[];const u={...f,x:f.x-n};if(u.x<0){u.x=0,u.width--;const g=a(u,o.signal);return typeof g=="function"?async()=>(await g()).map(w=>[{kind:U.Loading,allowOverlay:!1},...w]):g.map(w=>[{kind:U.Loading,allowOverlay:!1},...w])}return a(u,o.signal)},[o.signal,a,n]);return[e!==void 0?s:void 0,a]}function ou(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case U.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===Oi?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case U.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case U.Image:case U.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case U.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case U.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case U.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case U.Markdown:case U.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case U.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case U.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case U.Protected:return{formatted:"************",rawValue:"",format:"string"};default:ur()}}function ru(e,t){return e.map((o,r)=>{const i=t[r];return o.map(a=>a.span!==void 0&&a.span[0]!==i?{formatted:"",rawValue:"",format:"string"}:ou(a))})}function Dl(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function iu(e){var n;const t=[];for(const o of e){const r=[];for(const i of o)i.format==="url"?r.push(((n=i.rawValue)==null?void 0:n.toString())??""):i.format==="string-array"?r.push(i.formatted.map(a=>Dl(a,!0)).join(",")):r.push(i.doNotEscape===!0?i.formatted:Dl(i.formatted,!1));t.push(r.join("	"))}return t.join(`
`)}function Ii(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Hl(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function lu(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function su(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const r of o){const i=`gdg-format="${r.format}"`;r.format==="url"?t.push(`<td ${i}><a href="${r.rawValue}">${Ii(r.formatted)}</a></td>`):r.format==="string-array"?t.push(`<td ${i}><ol>${r.formatted.map((a,s)=>`<li gdg-raw-value=${Hl(r.rawValue[s])}>`+Ii(a)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Hl(((n=r.rawValue)==null?void 0:n.toString())??"")} ${i}>${Ii(r.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function au(e,t){const n=ru(e,t),o=iu(n),r=su(n);return{textPlain:o,textHtml:r}}function Tl(e){var a;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],r=[];let i;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)i!==void 0&&r.push(i),i=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const c=s.cloneNode(!0),u=c.children.length===1&&c.children[0].nodeName==="P"?c.children[0]:null,g=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",w=c.querySelectorAll("br");for(const p of w)p.replaceWith(`
`);const m=c.getAttribute("gdg-raw-value"),h=c.getAttribute("gdg-format")??"string";if(c.querySelector("a")!==null)i==null||i.push({rawValue:((a=c.querySelector("a"))==null?void 0:a.getAttribute("href"))??"",formatted:c.textContent??"",format:h});else if(c.querySelector("ol")!==null){const p=c.querySelectorAll("li");i==null||i.push({rawValue:[...p].map(x=>x.getAttribute("gdg-raw-value")??""),formatted:[...p].map(x=>x.textContent??""),format:"string-array"})}else if(m!==null)i==null||i.push({rawValue:lu(m),formatted:c.textContent??"",format:h});else{let p=c.textContent??"";g&&(p=p.replace(/\n(?!\n)/g,"")),i==null||i.push({rawValue:p??"",formatted:p??"",format:h})}}}return i!==void 0&&r.push(i),r}function cu(e,t,n,o,r){var s;const i=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let a=!1;do{if((e==null?void 0:e.current)===void 0)break;const c=(s=e.current)==null?void 0:s.range,f=[];if(c.width>2){const w=t({x:c.x,y:c.y,width:1,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w);const m=t({x:c.x+c.width-1,y:c.y,width:1,height:c.height},r.signal);if(typeof m=="function")return i;f.push(...m)}else{const w=t({x:c.x,y:c.y,width:c.width,height:c.height},r.signal);if(typeof w=="function")return i;f.push(...w)}let u=c.x-n,g=c.x+c.width-1-n;for(const w of f)for(const m of w)m.span!==void 0&&(u=Math.min(m.span[0],u),g=Math.max(m.span[1],g));u===c.x-n&&g===c.x+c.width-1-n?a=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:c.y,width:g-u+1,height:c.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!a);return e}function Al(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function du(e){let t;(function(s){s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],r=0,i=t.None;e=e.replace(/\r\n/g,`
`);let a=0;for(const s of e){switch(i){case t.None:s==="	"||s===`
`?(o.push(e.slice(r,a)),r=a+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(i=t.inString);break;case t.inString:s==='"'&&(i=t.inStringPostQuote);break;case t.inStringPostQuote:s==='"'?i=t.inString:((s==="	"||s===`
`)&&(o.push(Al(e.slice(r,a))),r=a+1,s===`
`&&(n.push(o),o=[])),i=t.None);break}a++}return r<e.length&&o.push(Al(e.slice(r,e.length))),n.push(o),n.map(s=>s.map(c=>({rawValue:c,formatted:c,format:"string"})))}function zl(e,t,n){var s;const o=au(e,t),r=c=>{var f;(f=window.navigator.clipboard)==null||f.writeText(c)},i=(c,f)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"}),"text/html":new Blob([f],{type:"text/html"})})]),!0)},a=(c,f)=>{var u,g;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",c),(g=n==null?void 0:n.clipboardData)==null||g.setData("text/html",f)}catch{i(c,f)||r(c)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?a(o.textPlain,o.textHtml):r(o.textPlain),n==null||n.preventDefault()}function Bs(e){return e!==!0}function Bl(e){return typeof e=="string"?e:`${e}px`}const uu=()=>e=>e.innerWidth,fu=()=>e=>e.innerHeight,hu=Wt("div")({name:"Wrapper",class:"gdg-wmyidgi",propsAsIs:!1,vars:{"wmyidgi-0":[uu()],"wmyidgi-1":[fu()]}}),gu=e=>{const{inWidth:t,inHeight:n,children:o,...r}=e;return l.createElement(hu,{innerHeight:Bl(n),innerWidth:Bl(t),...r},o)},mu=2,pu=1300;function wu(e,t,n){const o=at.useRef(0),[r,i]=e??[0,0];at.useEffect(()=>{if(r===0&&i===0){o.current=0;return}let a=!1,s=0;const c=f=>{var u;if(!a){if(s===0)s=f;else{const g=f-s;o.current=Math.min(1,o.current+g/pu);const w=o.current**1.618*g*mu;(u=t.current)==null||u.scrollBy(r*w,i*w),s=f,n==null||n()}window.requestAnimationFrame(c)}};return window.requestAnimationFrame(c),()=>{a=!0}},[t,r,i,n])}function bu({rowHeight:e,headerHeight:t,groupHeaderHeight:n,theme:o,overscrollX:r,overscrollY:i,scaleToRem:a,remSize:s}){const[c,f,u,g,w,m]=at.useMemo(()=>{if(!a||s===16)return[e,t,n,o,r,i];const h=s/16,p=e,x=Cs();return[typeof p=="number"?p*h:y=>Math.ceil(p(y)*h),Math.ceil(t*h),Math.ceil(n*h),{...o,headerIconSize:((o==null?void 0:o.headerIconSize)??x.headerIconSize)*h,cellHorizontalPadding:((o==null?void 0:o.cellHorizontalPadding)??x.cellHorizontalPadding)*h,cellVerticalPadding:((o==null?void 0:o.cellVerticalPadding)??x.cellVerticalPadding)*h},Math.ceil((r??0)*h),Math.ceil((i??0)*h)]},[n,t,r,i,s,e,a,o]);return{rowHeight:c,headerHeight:f,groupHeaderHeight:u,theme:g,overscrollX:w,overscrollY:m}}const Zn={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function Oe(e,t){return e===!0?t:e===!1?"":e}function Pl(e){const t=Vr.value;return{activateCell:Oe(e.activateCell," |Enter|shift+Enter"),clear:Oe(e.clear,"any+Escape"),closeOverlay:Oe(e.closeOverlay,"any+Escape"),acceptOverlayDown:Oe(e.acceptOverlayDown,"Enter"),acceptOverlayUp:Oe(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:Oe(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:Oe(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:Oe(e.delete,t?"Backspace|Delete":"Delete"),downFill:Oe(e.downFill,"primary+_68"),scrollToSelectedCell:Oe(e.scrollToSelectedCell,"primary+Enter"),goDownCell:Oe(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:Oe(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:Oe(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:Oe(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:Oe(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:Oe(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:Oe(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:Oe(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:Oe(e.goToFirstCell,"primary+Home"),goToFirstColumn:Oe(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:Oe(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:Oe(e.goToLastCell,"primary+End"),goToLastColumn:Oe(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:Oe(e.goToLastRow,"primary+ArrowDown"),goToNextPage:Oe(e.goToNextPage,"PageDown"),goToPreviousPage:Oe(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:Oe(e.rightFill,"primary+_82"),search:Oe(e.search,"primary+f"),selectAll:Oe(e.selectAll,"primary+a"),selectColumn:Oe(e.selectColumn,"ctrl+ "),selectGrowDown:Oe(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:Oe(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:Oe(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:Oe(e.selectGrowUp,"shift+ArrowUp"),selectRow:Oe(e.selectRow,"shift+ "),selectToFirstCell:Oe(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:Oe(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:Oe(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:Oe(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:Oe(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:Oe(e.selectToLastRow,"primary+shift+ArrowDown")}}function yu(e){const t=rc(e);return at.useMemo(()=>{if(t===void 0)return Pl(Zn);const n={...t,goToNextPage:(t==null?void 0:t.goToNextPage)??(t==null?void 0:t.pageDown)??Zn.goToNextPage,goToPreviousPage:(t==null?void 0:t.goToPreviousPage)??(t==null?void 0:t.pageUp)??Zn.goToPreviousPage,goToFirstCell:(t==null?void 0:t.goToFirstCell)??(t==null?void 0:t.first)??Zn.goToFirstCell,goToLastCell:(t==null?void 0:t.goToLastCell)??(t==null?void 0:t.last)??Zn.goToLastCell,selectToFirstCell:(t==null?void 0:t.selectToFirstCell)??(t==null?void 0:t.first)??Zn.selectToFirstCell,selectToLastCell:(t==null?void 0:t.selectToLastCell)??(t==null?void 0:t.last)??Zn.selectToLastCell};return Pl({...Zn,...n})},[t])}function vu(e){function t(o,r,i){if(typeof o=="number")return{headerIndex:o,isCollapsed:!1,depth:r,path:i};const a={headerIndex:o.headerIndex,isCollapsed:o.isCollapsed,depth:r,path:i};return o.subGroups!==void 0&&(a.subGroups=o.subGroups.map((s,c)=>t(s,r+1,[...i,c])).sort((s,c)=>s.headerIndex-c.headerIndex)),a}return e.map((o,r)=>t(o,0,[r])).sort((o,r)=>o.headerIndex-r.headerIndex)}function qi(e,t){const n=[];function o(s,c,f=!1){let u=c!==null?c-s.headerIndex:t-s.headerIndex;if(s.subGroups!==void 0&&(u=s.subGroups[0].headerIndex-s.headerIndex),u--,n.push({rowIndex:-1,headerIndex:s.headerIndex,contentIndex:-1,skip:f,isCollapsed:s.isCollapsed,depth:s.depth,path:s.path,rows:u}),s.subGroups)for(let g=0;g<s.subGroups.length;g++){const w=g<s.subGroups.length-1?s.subGroups[g+1].headerIndex:c;o(s.subGroups[g],w,f||s.isCollapsed)}}const r=vu(e.groups);for(let s=0;s<r.length;s++){const c=s<r.length-1?r[s+1].headerIndex:null;o(r[s],c)}let i=0,a=0;for(const s of n)s.contentIndex=a,a+=s.rows,s.rowIndex=i,i+=s.isCollapsed?1:s.rows+1;return n.filter(s=>s.skip===!1).map(s=>{const{skip:c,...f}=s;return f})}function $i(e,t){if(t===void 0||qi.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let n=e;for(const o of t){if(n===0)return{path:[...o.path,-1],originalIndex:o.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:o.rows};if(o.isCollapsed)n--;else{if(n<=o.rows)return{path:[...o.path,n-1],originalIndex:o.headerIndex+n,isGroupHeader:!1,groupIndex:n-1,contentIndex:o.contentIndex+n-1,groupRows:o.rows};n=n-o.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function Cu(e,t,n,o){const r=at.useMemo(()=>e===void 0?void 0:qi(e,t),[e,t]),i=at.useMemo(()=>r==null?void 0:r.reduce((u,g)=>(u[g.rowIndex]=g,u),{}),[r]),a=at.useMemo(()=>r===void 0?t:r.reduce((u,g)=>u+(g.isCollapsed?1:g.rows+1),0),[r,t]),s=at.useMemo(()=>e===void 0||typeof n=="number"&&e.height===n?n:u=>i!=null&&i[u]?e.height:typeof n=="number"?n:n(u),[i,e,n]),c=at.useCallback(u=>{if(r===void 0)return u;let g=u;for(const w of r){if(g===0)return;if(g--,!w.isCollapsed){if(g<w.rows)return w.contentIndex+g;g-=w.rows}}return u},[r]),f=Jn(o??(e==null?void 0:e.themeOverride),at.useCallback(u=>{if(e===void 0)return o==null?void 0:o(u,u,u);if(o===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:g,contentIndex:w,groupIndex:m}=$i(u,r);return g?e.themeOverride:o==null?void 0:o(u,m,w)},[r,o,e]));return e===void 0?{rowHeight:s,rows:t,rowNumberMapper:c,getRowThemeOverride:f}:{rowHeight:s,rows:a,rowNumberMapper:c,getRowThemeOverride:f}}function xu(e,t){const n=at.useMemo(()=>e===void 0?void 0:qi(e,t),[e,t]);return{getRowGroupingForPath:Ls,updateRowGroupingByPath:Ps,mapper:at.useCallback(o=>{if(typeof o=="number")return $i(o,n);const r=$i(o[1],n);return{...r,originalIndex:[o[0],r.originalIndex]}},[n])}}function Ps(e,t,n){const[o,...r]=t;return r[0]===-1?e.map((i,a)=>a===o?{...i,...n}:i):e.map((i,a)=>a===o?{...i,subGroups:Ps(i.subGroups??[],r,n)}:i)}function Ls(e,t){const[n,...o]=t;return o[0]===-1?e[n]:Ls(e[n].subGroups??[],o)}function ku(e,t){const[n]=l.useState(()=>({value:e,callback:t,facade:{get current(){return n.value},set current(o){const r=n.value;r!==o&&(n.value=o,n.callback(o,r))}}}));return n.callback=t,n.facade}function Su(e,t,n,o,r){const[i,a]=l.useMemo(()=>[t!==void 0&&typeof n=="number"?Math.floor(t/n):0,t!==void 0&&typeof n=="number"?-(t%n):0],[t,n]),s=l.useMemo(()=>({x:o.current.x,y:i,width:o.current.width??1,height:o.current.height??1,ty:a}),[o,a,i]),[c,f,u]=oc(s),g=l.useRef(r);g.current=r;const w=ku(null,p=>{p!==null&&t!==void 0?p.scrollTop=t:p!==null&&e!==void 0&&(p.scrollLeft=e)}),m=(c.height??1)>1;l.useLayoutEffect(()=>{if(t!==void 0&&w.current!==null&&m){if(w.current.scrollTop===t)return;w.current.scrollTop=t,w.current.scrollTop!==t&&u(),g.current()}},[t,m,u,w]);const h=(c.width??1)>1;return l.useLayoutEffect(()=>{if(e!==void 0&&w.current!==null&&h){if(w.current.scrollLeft===e)return;w.current.scrollLeft=e,w.current.scrollLeft!==e&&u(),g.current()}},[e,h,u,w]),{visibleRegion:c,setVisibleRegion:f,scrollRef:w}}const Mu=l.lazy(async()=>await rs(()=>import("./data-grid-overlay-editor-DjS5MuU0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url));let Ru=0;function Eu(e){return Wa(hl(hl(e).filter(t=>t.span!==void 0).map(t=>{var n,o;return eo((((n=t.span)==null?void 0:n[0])??0)+1,(((o=t.span)==null?void 0:o[1])??0)+1)})))}function $r(e,t){return e===void 0||t===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+t,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+t},rangeStack:e.current.rangeStack.map(n=>({...n,x:n.x+t}))},rows:e.rows,columns:e.columns.offset(t)}}const Or={kind:U.Loading,allowOverlay:!1},Nr={columns:st.empty(),rows:st.empty(),current:void 0},Iu=(e,t)=>{var dl,ul,fl;const[n,o]=l.useState(Nr),[r,i]=l.useState(),a=l.useRef(null),s=l.useRef(null),[c,f]=l.useState(),u=l.useRef(),g=typeof window>"u"?null:window,{imageEditorOverride:w,getRowThemeOverride:m,markdownDivCreateNode:h,width:p,height:x,columns:y,rows:b,getCellContent:k,onCellClicked:T,onCellActivated:A,onFillPattern:E,onFinishedEditing:D,coercePasteValue:_,drawHeader:R,drawCell:$,editorBloom:X,onHeaderClicked:L,onColumnProposeMove:H,rangeSelectionColumnSpanning:I=!0,spanRangeBehavior:le="default",onGroupHeaderClicked:j,onCellContextMenu:re,className:Ee,onHeaderContextMenu:be,getCellsForSelection:te,onGroupHeaderContextMenu:K,onGroupHeaderRenamed:ve,onCellEdited:ne,onCellsEdited:fe,onSearchResultsChanged:Ge,searchResults:q,onSearchValueChange:oe,searchValue:ue,onKeyDown:Le,onKeyUp:Ne,keybindings:tt,editOnType:rt=!0,onRowAppended:Me,onColumnAppended:Te,onColumnMoved:Fe,validateCell:gt,highlightRegions:mt,rangeSelect:ct="rect",columnSelect:Z="multi",rowSelect:he="multi",rangeSelectionBlending:xe="exclusive",columnSelectionBlending:Re="exclusive",rowSelectionBlending:me="exclusive",onDelete:je,onDragStart:Xe,onMouseMove:Ze,onPaste:ie,copyHeaders:pe=!1,freezeColumns:_e=0,cellActivationBehavior:Ue="second-click",rowSelectionMode:Qe="auto",columnSelectionMode:pt="auto",onHeaderMenuClick:ot,onHeaderIndicatorClick:ze,getGroupDetails:kt,rowGrouping:Ft,onSearchClose:Lt,onItemHovered:Ct,onSelectionCleared:Et,showSearch:Bt,onVisibleRegionChanged:an,gridSelection:Yt,onGridSelectionChange:dt,minColumnWidth:Rn=50,maxColumnWidth:cn=500,maxColumnAutoWidth:wt,provideEditor:$t,trailingRowOptions:Ye,freezeTrailingRows:Dt=0,allowedFillDirections:jt="orthogonal",scrollOffsetX:et,scrollOffsetY:It,verticalBorder:it,onDragOverCell:tn,onDrop:Xt,onColumnResize:Kt,onColumnResizeEnd:En,onColumnResizeStart:ut,customRenderers:$n,fillHandle:Ht,experimental:Ke,fixedShadowX:In,fixedShadowY:mr,headerIcons:On,imageWindowLoader:Fn,initialSize:Dn,isDraggable:yo,onDragLeave:pr,onRowMoved:Nn,overscrollX:vo,overscrollY:Co,preventDiagonalScrolling:xo,rightElement:ko,rightElementProps:ro,trapFocus:Hn=!1,smoothScrollX:Jr,smoothScrollY:wr,scaleToRem:Qr=!1,rowHeight:ei=34,headerHeight:bn=36,groupHeaderHeight:Xn=bn,theme:ti,isOutsideClick:ni,renderers:So,resizeIndicator:br,scrollToActiveCell:io=!0,drawFocusRing:oi=!0,portalElementRef:yr}=e,Mo=oi==="no-editor"?r===void 0:oi,ht=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Gt=(ht==null?void 0:ht.kind)??e.rowMarkers??"none",Ro=(ht==null?void 0:ht.width)??e.rowMarkerWidth,Tn=(ht==null?void 0:ht.startIndex)??e.rowMarkerStartIndex??1,Eo=(ht==null?void 0:ht.theme)??e.rowMarkerTheme,Gn=ht==null?void 0:ht.headerTheme,Io=ht==null?void 0:ht.headerAlwaysVisible,Fo=he!=="multi"||(ht==null?void 0:ht.headerDisabled)===!0,lo=(ht==null?void 0:ht.checkboxStyle)??"square",_n=Math.max(Rn,20),Do=Math.max(cn,_n),ri=Math.max(wt??Do,_n),Vo=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:Ce,rowNumberMapper:qo,rowHeight:vr,getRowThemeOverride:dn}=Cu(Ft,b,ei,m),ii=l.useMemo(()=>Number.parseFloat(Vo.fontSize),[Vo]),{rowHeight:yn,headerHeight:jo,groupHeaderHeight:Cr,theme:Ho,overscrollX:li,overscrollY:si}=bu({groupHeaderHeight:Xn,headerHeight:bn,overscrollX:vo,overscrollY:Co,remSize:ii,rowHeight:vr,scaleToRem:Qr,theme:ti}),vn=yu(tt),Un=Ro??(b>1e4?48:b>1e3?44:b>100?36:32),Zt=Gt!=="none",F=Zt?1:0,bt=Ye!==void 0,An=(Ye==null?void 0:Ye.sticky)===!0,[ai,so]=l.useState(!1),ci=Bt??ai,To=l.useCallback(()=>{Lt!==void 0?Lt():so(!1)},[Lt]),W=l.useMemo(()=>Yt===void 0?void 0:$r(Yt,F),[Yt,F])??n,M=l.useRef();M.current===void 0&&(M.current=new AbortController),l.useEffect(()=>()=>M==null?void 0:M.current.abort(),[]);const[G,se]=nu(te,k,F,M.current,Ce),ae=l.useCallback((d,v,C)=>{if(gt===void 0)return!0;const S=[d[0]-F,d[1]];return gt==null?void 0:gt(S,v,C)},[F,gt]),J=l.useRef(Yt),Q=l.useCallback((d,v)=>{v&&(d=cu(d,G,F,le,M.current)),dt!==void 0?(J.current=$r(d,-F),dt(J.current)):o(d)},[dt,G,F,le]),ke=Jn(Kt,l.useCallback((d,v,C,S)=>{Kt==null||Kt(y[C-F],v,C-F,S)},[Kt,F,y])),Ve=Jn(En,l.useCallback((d,v,C,S)=>{En==null||En(y[C-F],v,C-F,S)},[En,F,y])),ge=Jn(ut,l.useCallback((d,v,C,S)=>{ut==null||ut(y[C-F],v,C-F,S)},[ut,F,y])),Tt=Jn(R,l.useCallback((d,v)=>(R==null?void 0:R({...d,columnIndex:d.columnIndex-F},v))??!1,[R,F])),we=Jn($,l.useCallback((d,v)=>($==null?void 0:$({...d,col:d.col-F},v))??!1,[$,F])),qe=l.useCallback(d=>{if(je!==void 0){const v=je($r(d,-F));return typeof v=="boolean"?v:$r(v,F)}return!0},[je,F]),[Ae,Be,De]=tu(W,Q,xe,Re,me,ct,I),Je=l.useMemo(()=>Wn(Cs(),Ho),[Ho]),[St,un]=l.useState([0,0,0]),fn=l.useMemo(()=>{if(So===void 0)return{};const d={};for(const v of So)d[v.kind]=v;return d},[So]),yt=l.useCallback(d=>d.kind!==U.Custom?fn[d.kind]:$n==null?void 0:$n.find(v=>v.isMatch(d)),[$n,fn]);let{sizedColumns:Rt,nonGrowWidth:lt}=Dc(y,Ce,se,St[0]-(F===0?0:Un)-St[2],_n,ri,Je,yt,M.current);Gt!=="none"&&(lt+=Un);const nn=l.useMemo(()=>Rt.some(d=>d.group!==void 0),[Rt]),Ot=nn?jo+Cr:jo,Ao=W.rows.length,zn=Gt==="none"?void 0:Ao===0?!1:Ao===Ce?!0:void 0,We=l.useMemo(()=>Gt==="none"?Rt:[{title:"",width:Un,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Eo,rowMarker:lo,rowMarkerChecked:zn,headerRowMarkerTheme:Gn,headerRowMarkerAlwaysVisible:Io,headerRowMarkerDisabled:Fo},...Rt],[Gt,Rt,Un,Eo,lo,zn,Gn,Io,Fo]),At=l.useRef({height:1,width:1,x:0,y:0}),ao=l.useRef(!1),{setVisibleRegion:Yn,visibleRegion:Bn,scrollRef:ft}=Su(et,It,yn,At,()=>ao.current=!0);At.current=Bn;const _s=Bn.x+F,xr=Bn.y,Pt=l.useRef(null),_t=l.useCallback(d=>{var v;d===!0?(v=Pt.current)==null||v.focus():window.requestAnimationFrame(()=>{var C;(C=Pt.current)==null||C.focus()})},[]),Nt=bt?Ce+1:Ce,on=l.useCallback(d=>{const v=F===0?d:d.map(S=>({...S,location:[S.location[0]-F,S.location[1]]})),C=fe==null?void 0:fe(v);if(C!==!0)for(const S of v)ne==null||ne(S.location,S.value);return C},[ne,fe,F]),[co,di]=l.useState(),kr=W.current!==void 0&&W.current.range.width*W.current.range.height>1?W.current.range:void 0,zo=Mo?(dl=W.current)==null?void 0:dl.cell:void 0,Sr=zo==null?void 0:zo[0],Mr=zo==null?void 0:zo[1],Us=l.useMemo(()=>{if((mt===void 0||mt.length===0)&&(kr??Sr??Mr??co)===void 0)return;const d=[];if(mt!==void 0)for(const v of mt){const C=We.length-v.range.x-F;C>0&&d.push({color:v.color,range:{...v.range,x:v.range.x+F,width:Math.min(C,v.range.width)},style:v.style})}return co!==void 0&&d.push({color:wo(Je.accentColor,0),range:co,style:"dashed"}),kr!==void 0&&d.push({color:wo(Je.accentColor,.5),range:kr,style:"solid-outline"}),Sr!==void 0&&Mr!==void 0&&d.push({color:Je.accentColor,range:{x:Sr,y:Mr,width:1,height:1},style:"solid-outline"}),d.length>0?d:void 0},[co,kr,Sr,Mr,mt,We.length,Je.accentColor,F]),Zi=l.useRef(We);Zi.current=We;const Jt=l.useCallback(([d,v],C=!1)=>{var O,z,P,N,Y,ee,ce;const S=bt&&v===Nt-1;if(d===0&&Zt){if(S)return Or;const V=qo(v);return V===void 0?Or:{kind:sn.Marker,allowOverlay:!1,checkboxStyle:lo,checked:(W==null?void 0:W.rows.hasIndex(v))===!0,markerKind:Gt==="clickable-number"?"number":Gt,row:Tn+V,drawHandle:Nn!==void 0,cursor:Gt==="clickable-number"?"pointer":void 0}}else if(S){const Se=d===F?(Ye==null?void 0:Ye.hint)??"":"",de=Zi.current[d];if(((O=de==null?void 0:de.trailingRowOptions)==null?void 0:O.disabled)===!0)return Or;{const He=((z=de==null?void 0:de.trailingRowOptions)==null?void 0:z.hint)??Se,Ie=((P=de==null?void 0:de.trailingRowOptions)==null?void 0:P.addIcon)??(Ye==null?void 0:Ye.addIcon);return{kind:sn.NewRow,hint:He,allowOverlay:!1,icon:Ie}}}else{const V=d-F;if(C||(Ke==null?void 0:Ke.strict)===!0){const de=At.current,He=de.x>V||V>de.x+de.width||de.y>v||v>de.y+de.height||v>=gi.current,Ie=V===((Y=(N=de.extras)==null?void 0:N.selected)==null?void 0:Y[0])&&v===((ee=de.extras)==null?void 0:ee.selected[1]);let ye=!1;if(((ce=de.extras)==null?void 0:ce.freezeRegions)!==void 0){for(const nt of de.extras.freezeRegions)if(po(nt,V,v)){ye=!0;break}}if(He&&!Ie&&!ye)return Or}let Se=k([V,v]);return F!==0&&Se.span!==void 0&&(Se={...Se,span:[Se.span[0]+F,Se.span[1]+F]}),Se}},[bt,Nt,Zt,qo,lo,W==null?void 0:W.rows,Gt,Tn,Nn,F,Ye==null?void 0:Ye.hint,Ye==null?void 0:Ye.addIcon,Ke==null?void 0:Ke.strict,k]),ui=l.useCallback(d=>{let v=(kt==null?void 0:kt(d))??{name:d};return ve!==void 0&&d!==""&&(v={icon:v.icon,name:v.name,overrideTheme:v.overrideTheme,actions:[...v.actions??[],{title:"Rename",icon:"renameIcon",onClick:C=>pi({group:v.name,bounds:C.bounds})}]}),v},[kt,ve]),Rr=l.useCallback(d=>{var P;const[v,C]=d.cell,S=We[v],B=(S==null?void 0:S.group)!==void 0?(P=ui(S.group))==null?void 0:P.overrideTheme:void 0,O=S==null?void 0:S.themeOverride,z=dn==null?void 0:dn(C);i({...d,theme:Wn(Je,B,O,z,d.content.themeOverride)})},[dn,We,ui,Je]),Bo=l.useCallback((d,v,C)=>{var z;if(W.current===void 0)return;const[S,B]=W.current.cell,O=Jt([S,B]);if(O.kind!==U.Boolean&&O.allowOverlay){let P=O;if(C!==void 0)switch(P.kind){case U.Number:{const N=Ka(()=>C==="-"?-0:Number.parseFloat(C),0);P={...P,data:Number.isNaN(N)?0:N};break}case U.Text:case U.Markdown:case U.Uri:P={...P,data:C};break}Rr({target:d,content:P,initialValue:C,cell:[S,B],highlight:C===void 0,forceEditMode:C!==void 0,activation:v})}else O.kind===U.Boolean&&v.inputType==="keyboard"&&O.readonly!==!0&&(on([{location:W.current.cell,value:{...O,data:Bs(O.data)}}]),(z=Pt.current)==null||z.damage([{cell:W.current.cell}]))},[Jt,W,on,Rr]),Ji=l.useCallback((d,v)=>{var B;const C=(B=Pt.current)==null?void 0:B.getBounds(d,v);if(C===void 0||ft.current===null)return;const S=Jt([d,v]);S.allowOverlay&&Rr({target:C,content:S,initialValue:void 0,highlight:!0,cell:[d,v],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[Jt,ft,Rr]),Mt=l.useCallback((d,v,C="both",S=0,B=0,O=void 0)=>{if(ft.current!==null){const z=Pt.current,P=s.current,N=typeof d!="number"?d.unit==="cell"?d.amount:void 0:d,Y=typeof v!="number"?v.unit==="cell"?v.amount:void 0:v,ee=typeof d!="number"&&d.unit==="px"?d.amount:void 0,ce=typeof v!="number"&&v.unit==="px"?v.amount:void 0;if(z!==null&&P!==null){let V={x:0,y:0,width:0,height:0},Se=0,de=0;if((N!==void 0||Y!==void 0)&&(V=z.getBounds((N??0)+F,Y??0)??V,V.width===0||V.height===0))return;const He=P.getBoundingClientRect(),Ie=He.width/P.offsetWidth;if(ee!==void 0&&(V={...V,x:ee-He.left-ft.current.scrollLeft,width:1}),ce!==void 0&&(V={...V,y:ce+He.top-ft.current.scrollTop,height:1}),V!==void 0){const ye={x:V.x-S,y:V.y-B,width:V.width+2*S,height:V.height+2*B};let nt=0;for(let ki=0;ki<_e;ki++)nt+=Rt[ki].width;let xt=0;const zt=Dt+(An?1:0);zt>0&&(xt=bo(Nt,zt,yn));let Vt=nt*Ie+He.left+F*Un*Ie,xn=He.right,mn=He.top+Ot*Ie,kn=He.bottom-xt*Ie;const Ar=V.width+S*2;switch(O==null?void 0:O.hAlign){case"start":xn=Vt+Ar;break;case"end":Vt=xn-Ar;break;case"center":Vt=Math.floor((Vt+xn)/2)-Ar/2,xn=Vt+Ar;break}const zr=V.height+B*2;switch(O==null?void 0:O.vAlign){case"start":kn=mn+zr;break;case"end":mn=kn-zr;break;case"center":mn=Math.floor((mn+kn)/2)-zr/2,kn=mn+zr;break}Vt>ye.x?Se=ye.x-Vt:xn<ye.x+ye.width&&(Se=ye.x+ye.width-xn),mn>ye.y?de=ye.y-mn:kn<ye.y+ye.height&&(de=ye.y+ye.height-kn),C==="vertical"||typeof d=="number"&&d<_e?Se=0:(C==="horizontal"||typeof v=="number"&&v>=Nt-zt)&&(de=0),(Se!==0||de!==0)&&(Ie!==1&&(Se/=Ie,de/=Ie),ft.current.scrollTo({left:Se+ft.current.scrollLeft,top:de+ft.current.scrollTop,behavior:(O==null?void 0:O.behavior)??"auto"}))}}}},[F,Dt,Un,ft,Ot,_e,Rt,Nt,An,yn]),fi=l.useRef(Ji),hi=l.useRef(k);fi.current=Ji,hi.current=k;const gi=l.useRef(Ce);gi.current=Ce;const Qi=l.useRef(We.length);Qi.current=We.length;const Kn=l.useCallback(async(d,v=!0,C)=>{var Y;const S=We[d];if(((Y=S==null?void 0:S.trailingRowOptions)==null?void 0:Y.disabled)===!0)return;const B=Me==null?void 0:Me();let O,z=!0;B!==void 0&&(O=await B,O==="top"&&(z=!1),typeof O=="number"&&(z=!1));let P=0;const N=()=>{if(gi.current<=Ce){P<500&&window.setTimeout(N,P),P=50+P*2;return}const ee=typeof O=="number"?O:z?Ce:0;Tr.current(d-F,ee,"both",0,0,C?{behavior:C}:void 0),Ae({cell:[d,ee],range:{x:d,y:ee,width:1,height:1}},!1,!1,"edit");const ce=hi.current([d-F,ee]);ce.allowOverlay&&Oo(ce)&&ce.readonly!==!0&&v&&window.setTimeout(()=>{fi.current(d,ee)},0)};N()},[We,Me,F,Ce,Ae]),Er=l.useCallback(async(d,v=!0)=>{const C=Te==null?void 0:Te();let S,B=!0;C!==void 0&&(S=await C,S==="left"&&(B=!1),typeof S=="number"&&(B=!1));let O=0;const z=()=>{if(Qi.current<=We.length){O<500&&window.setTimeout(z,O),O=50+O*2;return}const P=typeof S=="number"?S:B?We.length:0;Mt(P-F,d),Ae({cell:[P,d],range:{x:P,y:d,width:1,height:1}},!1,!1,"edit");const N=hi.current([P-F,d]);N.allowOverlay&&Oo(N)&&N.readonly!==!0&&v&&window.setTimeout(()=>{fi.current(P,d)},0)};z()},[We,Te,F,Mt,Ae]),Po=l.useCallback(d=>{var C,S;const v=((S=(C=Rt[d])==null?void 0:C.trailingRowOptions)==null?void 0:S.targetColumn)??(Ye==null?void 0:Ye.targetColumn);if(typeof v=="number")return v+(Zt?1:0);if(typeof v=="object"){const B=y.indexOf(v);if(B>=0)return B+(Zt?1:0)}},[Rt,y,Zt,Ye==null?void 0:Ye.targetColumn]),Vn=l.useRef(),Lo=l.useRef(),Zo=l.useCallback((d,v)=>{var B;const[C,S]=v;return Wn(Je,(B=We[C])==null?void 0:B.themeOverride,dn==null?void 0:dn(S),d.themeOverride)},[dn,We,Je]),{mapper:uo}=xu(Ft,b),hn=Ft==null?void 0:Ft.navigationBehavior,Jo=l.useCallback(d=>{var Y,ee,ce;const v=Vr.value?d.metaKey:d.ctrlKey,C=v&&he==="multi",[S,B]=d.location,O=W.columns,z=W.rows,[P,N]=((Y=W.current)==null?void 0:Y.cell)??[];if(d.kind==="cell"){if(Lo.current=void 0,fo.current=[S,B],S===0&&Zt){if(bt===!0&&B===Ce||Gt==="number"||he==="none")return;const V=Jt(d.location);if(V.kind!==sn.Marker)return;if(Nn!==void 0){const He=yt(V);Qt((He==null?void 0:He.kind)===sn.Marker);const Ie=(ee=He==null?void 0:He.onClick)==null?void 0:ee.call(He,{...d,cell:V,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,theme:Zo(V,d.location),preventDefault:()=>{}});if(Ie===void 0||Ie.checked===V.checked)return}i(void 0),_t();const Se=z.hasIndex(B),de=Vn.current;if(he==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&de!==void 0&&z.hasIndex(de)){const He=[Math.min(de,B),Math.max(de,B)+1];C||Qe==="multi"?Be(void 0,He,!0):Be(st.fromSingleSelection(He),void 0,C)}else he==="multi"&&(C||d.isTouch||Qe==="multi")?Se?Be(z.remove(B),void 0,!0):(Be(void 0,B,!0),Vn.current=B):Se&&z.length===1?Be(st.empty(),void 0,v):(Be(st.fromSingleSelection(B),void 0,v),Vn.current=B)}else if(S>=F&&bt&&B===Ce){const V=Po(S);Kn(V??S)}else if(P!==S||N!==B){const V=Jt(d.location),Se=yt(V);if((Se==null?void 0:Se.onSelect)!==void 0){let Ie=!1;if(Se.onSelect({...d,cell:V,posX:d.localEventX,posY:d.localEventY,bounds:d.bounds,preventDefault:()=>Ie=!0,theme:Zo(V,d.location)}),Ie)return}if(hn==="block"&&uo(B).isGroupHeader)return;const de=An&&B===Ce,He=An&&W!==void 0&&((ce=W.current)==null?void 0:ce.cell[1])===Ce;if((d.shiftKey||d.isLongTouch===!0)&&P!==void 0&&N!==void 0&&W.current!==void 0&&!He){if(de)return;const Ie=Math.min(S,P),ye=Math.max(S,P),nt=Math.min(B,N),xt=Math.max(B,N);Ae({...W.current,range:{x:Ie,y:nt,width:ye-Ie+1,height:xt-nt+1}},!0,v,"click"),Vn.current=void 0,_t()}else Ae({cell:[S,B],range:{x:S,y:B,width:1,height:1}},!0,v,"click"),Vn.current=void 0,i(void 0),_t()}}else if(d.kind==="header")if(fo.current=[S,B],i(void 0),Zt&&S===0)Vn.current=void 0,Lo.current=void 0,!Fo&&he==="multi"&&(z.length!==Ce?Be(st.fromSingleSelection([0,Ce]),void 0,v):Be(st.empty(),void 0,v),_t());else{const V=Lo.current;if(Z==="multi"&&(d.shiftKey||d.isLongTouch===!0)&&V!==void 0&&O.hasIndex(V)){const Se=[Math.min(V,S),Math.max(V,S)+1];v||d.isTouch||pt==="multi"?De(void 0,Se,v):De(st.fromSingleSelection(Se),void 0,v)}else Z==="multi"&&(v||d.isTouch||pt==="multi")?(O.hasIndex(S)?De(O.remove(S),void 0,v):De(void 0,S,v),Lo.current=S):Z!=="none"&&(O.hasIndex(S)?De(O.remove(S),void 0,v):De(st.fromSingleSelection(S),void 0,v),Lo.current=S);Vn.current=void 0,_t()}else d.kind===pn?fo.current=[S,B]:d.kind===qr&&!d.isMaybeScrollbar&&(Q(Nr,!1),i(void 0),_t(),Et==null||Et(),Vn.current=void 0,Lo.current=void 0)},[he,Z,W,Zt,F,bt,Ce,Gt,Jt,Nn,_t,Qe,pt,yt,Zo,Be,Po,Kn,hn,uo,An,Ae,Fo,De,Q,Et]),Qo=l.useRef(!1),fo=l.useRef(),el=l.useRef(Bn),rn=l.useRef(),Ys=l.useCallback(d=>{if(Wo.current=!1,el.current=At.current,d.button!==0&&d.button!==1){rn.current=void 0;return}const v=performance.now();rn.current={button:d.button,time:v,location:d.location},(d==null?void 0:d.kind)==="header"&&(Qo.current=!0);const C=d.kind==="cell"&&d.isFillHandle;!C&&d.kind!=="cell"&&d.isEdge||(f({previousSelection:W,fillHandle:C}),fo.current=void 0,!d.isTouch&&d.button===0&&!C?Jo(d):!d.isTouch&&d.button===1&&(fo.current=d.location))},[W,Jo]),[mi,pi]=l.useState(),tl=l.useCallback(d=>{if(d.kind!==pn||Z!=="multi")return;const v=Vr.value?d.metaKey:d.ctrlKey,[C]=d.location,S=W.columns;if(C<F)return;const B=We[C];let O=C,z=C;for(let P=C-1;P>=F&&fr(B.group,We[P].group);P--)O--;for(let P=C+1;P<We.length&&fr(B.group,We[P].group);P++)z++;if(_t(),v||d.isTouch||pt==="multi")if(S.hasAll([O,z+1])){let P=S;for(let N=O;N<=z;N++)P=P.remove(N);De(P,void 0,v)}else De(void 0,[O,z+1],v);else De(st.fromSingleSelection([O,z+1]),void 0,v)},[Z,_t,W.columns,We,F,De,pt]),Wo=l.useRef(!1),Ir=l.useCallback(async d=>{if(G!==void 0&&ke!==void 0){const v=At.current.y,C=At.current.height;let S=G({x:d,y:v,width:1,height:Math.min(C,Ce-v)},M.current.signal);typeof S!="object"&&(S=await S());const B=Rt[d-F],z=document.createElement("canvas").getContext("2d",{alpha:!1});if(z!==null){z.font=Je.baseFontFull;const P=xs(z,Je,B,0,S,_n,Do,!1,yt);ke==null||ke(B,P.width,d,P.width)}}},[Rt,G,Do,Je,_n,ke,F,Ce,yt]),[Ks,wi]=l.useState(),$o=l.useCallback(async(d,v)=>{var P,N;const C=(P=d.current)==null?void 0:P.range;if(C===void 0||G===void 0||v.current===void 0)return;const S=v.current.range;if(E!==void 0){let Y=!1;if(E({fillDestination:{...S,x:S.x-F},patternSource:{...C,x:C.x-F},preventDefault:()=>Y=!0}),Y)return}let B=G(C,M.current.signal);typeof B!="object"&&(B=await B());const O=B,z=[];for(let Y=0;Y<S.width;Y++)for(let ee=0;ee<S.height;ee++){const ce=[S.x+Y,S.y+ee];if(us(ce,C))continue;const V=O[ee%C.height][Y%C.width];No(V)||!Oo(V)||z.push({location:ce,value:{...V}})}on(z),(N=Pt.current)==null||N.damage(z.map(Y=>({cell:Y.location})))},[G,on,E,F]),nl=l.useCallback(()=>{if(W.current===void 0||W.current.range.width<=1)return;const d={...W,current:{...W.current,range:{...W.current.range,width:1}}};$o(d,W)},[$o,W]),ol=l.useCallback(()=>{if(W.current===void 0||W.current.range.height<=1)return;const d={...W,current:{...W.current,range:{...W.current.range,height:1}}};$o(d,W)},[$o,W]),Vs=l.useCallback((d,v)=>{var ee,ce;const C=c;if(f(void 0),di(void 0),wi(void 0),Qo.current=!1,v)return;if((C==null?void 0:C.fillHandle)===!0&&W.current!==void 0&&((ee=C.previousSelection)==null?void 0:ee.current)!==void 0){if(co===void 0)return;const V={...W,current:{...W.current,range:Es(C.previousSelection.current.range,co)}};$o(C.previousSelection,V),Q(V,!0);return}const[S,B]=d.location,[O,z]=fo.current??[],P=()=>{Wo.current=!0},N=V=>{var de,He,Ie;const Se=V.isTouch||O===S&&z===B;if(Se&&(T==null||T([S-F,B],{...V,preventDefault:P})),V.button===1)return!Wo.current;if(!Wo.current){const ye=Jt(d.location),nt=yt(ye);if(nt!==void 0&&nt.onClick!==void 0&&Se){const zt=nt.onClick({...V,cell:ye,posX:V.localEventX,posY:V.localEventY,bounds:V.bounds,theme:Zo(ye,d.location),preventDefault:P});zt!==void 0&&!No(zt)&&to(zt)&&(on([{location:V.location,value:zt}]),(de=Pt.current)==null||de.damage([{cell:V.location}]))}if(Wo.current||W.current===void 0)return!1;let xt=!1;switch(ye.activationBehaviorOverride??Ue){case"double-click":case"second-click":{if(((Ie=(He=C==null?void 0:C.previousSelection)==null?void 0:He.current)==null?void 0:Ie.cell)===void 0)break;const[zt,Vt]=W.current.cell,[xn,mn]=C.previousSelection.current.cell;xt=S===zt&&S===xn&&B===Vt&&B===mn&&(V.isDoubleClick===!0||Ue==="second-click");break}case"single-click":{xt=!0;break}}if(xt){const Vt={inputType:"pointer",pointerActivation:V.isDoubleClick===!0?"double-click":ye.activationBehaviorOverride??Ue,pointerType:V.isTouch?"touch":"mouse"};return A==null||A([S-F,B],Vt),Bo(V.bounds,Vt),!0}}return!1},Y=d.location[0]-F;if(d.isTouch){const V=At.current,Se=el.current;if(V.x!==Se.x||V.y!==Se.y)return;if(d.isLongTouch===!0){if(d.kind==="cell"&&sr((ce=W.current)==null?void 0:ce.cell,d.location)){re==null||re([Y,d.location[1]],{...d,preventDefault:P});return}else if(d.kind==="header"&&W.columns.hasIndex(S)){be==null||be(Y,{...d,preventDefault:P});return}else if(d.kind===pn){if(Y<0)return;K==null||K(Y,{...d,preventDefault:P});return}}d.kind==="cell"?N(d)||Jo(d):d.kind===pn?j==null||j(Y,{...d,preventDefault:P}):(d.kind===Qn&&(L==null||L(Y,{...d,preventDefault:P})),Jo(d));return}if(d.kind==="header"){if(Y<0)return;d.isEdge?d.isDoubleClick===!0&&Ir(S):d.button===0&&S===O&&B===z&&(L==null||L(Y,{...d,preventDefault:P}))}if(d.kind===pn){if(Y<0)return;d.button===0&&S===O&&B===z&&(j==null||j(Y,{...d,preventDefault:P}),Wo.current||tl(d))}d.kind==="cell"&&(d.button===0||d.button===1)&&N(d),fo.current=void 0},[c,W,F,co,$o,Q,T,Jt,yt,Ue,Zo,on,A,Bo,re,be,K,Jo,j,L,Ir,tl]),qs=l.useCallback(d=>{const v={...d,location:[d.location[0]-F,d.location[1]]};Ze==null||Ze(v),c!==void 0&&d.buttons===0&&(f(void 0),di(void 0),wi(void 0),Qo.current=!1),wi(C=>{var S;return Qo.current?[d.scrollEdge[0],0]:d.scrollEdge[0]===(C==null?void 0:C[0])&&d.scrollEdge[1]===C[1]?C:c===void 0||(((S=rn.current)==null?void 0:S.location[0])??0)<F?void 0:d.scrollEdge})},[c,Ze,F]),js=l.useCallback((d,v)=>{ot==null||ot(d-F,v)},[ot,F]),Zs=l.useCallback((d,v)=>{ze==null||ze(d-F,v)},[ze,F]),Cn=(ul=W==null?void 0:W.current)==null?void 0:ul.cell,Js=l.useCallback((d,v,C,S,B,O)=>{ao.current=!1;let z=Cn;z!==void 0&&(z=[z[0]-F,z[1]]);const P=_e===0?void 0:{x:0,y:d.y,width:_e,height:d.height},N=[];P!==void 0&&N.push(P),Dt>0&&(N.push({x:d.x-F,y:Ce-Dt,width:d.width,height:Dt}),_e>0&&N.push({x:0,y:Ce-Dt,width:_e,height:Dt}));const Y={x:d.x-F,y:d.y,width:d.width,height:bt&&d.y+d.height>=Ce?d.height-1:d.height,tx:B,ty:O,extras:{selected:z,freezeRegion:P,freezeRegions:N}};At.current=Y,Yn(Y),un([v,C,S]),an==null||an(Y,Y.tx,Y.ty,Y.extras)},[Cn,F,bt,Ce,_e,Dt,Yn,an]),Qs=Jn(H,l.useCallback((d,v)=>(H==null?void 0:H(d-F,v-F))!==!1,[H,F])),ea=Jn(Fe,l.useCallback((d,v)=>{Fe==null||Fe(d-F,v-F),Z!=="none"&&De(st.fromSingleSelection(v),void 0,!0)},[Z,Fe,F,De])),bi=l.useRef(!1),ta=l.useCallback(d=>{if(d.location[0]===0&&F>0){d.preventDefault();return}Xe==null||Xe({...d,location:[d.location[0]-F,d.location[1]]}),d.defaultPrevented()||(bi.current=!0),f(void 0)},[Xe,F]),na=l.useCallback(()=>{bi.current=!1},[]),rl=Ft==null?void 0:Ft.selectionBehavior,Fr=l.useCallback(d=>{if(rl!=="block-spanning")return;const{isGroupHeader:v,path:C,groupRows:S}=uo(d);if(v)return[d,d];const B=C[C.length-1],O=d-B,z=d+S-B-1;return[O,z]},[uo,rl]),yi=l.useRef(),vi=l.useCallback(d=>{var v,C,S;if(!As(d,yi.current)&&(yi.current=d,!(((v=rn==null?void 0:rn.current)==null?void 0:v.button)!==void 0&&rn.current.button>=1))){if(d.buttons!==0&&c!==void 0&&((C=rn.current)==null?void 0:C.location[0])===0&&F===1&&he==="multi"&&c.previousSelection&&!c.previousSelection.rows.hasIndex(rn.current.location[1])&&W.rows.hasIndex(rn.current.location[1])){const B=Math.min(rn.current.location[1],d.location[1]),O=Math.max(rn.current.location[1],d.location[1])+1;Be(st.fromSingleSelection([B,O]),void 0,!1)}else if(d.buttons!==0&&c!==void 0&&W.current!==void 0&&!bi.current&&!Qo.current&&(ct==="rect"||ct==="multi-rect")){const[B,O]=W.current.cell;let[z,P]=d.location;if(P<0&&(P=At.current.y),c.fillHandle===!0&&((S=c.previousSelection)==null?void 0:S.current)!==void 0){const N=c.previousSelection.current.range;P=Math.min(P,bt?Ce-1:Ce);const Y=ad(N,z,P,jt);di(Y)}else{if(bt&&O===Ce)return;if(bt&&P===Ce)if(d.kind===qr)P--;else return;z=Math.max(z,F);const ee=Fr(O);P=ee===void 0?P:ln(P,ee[0],ee[1]);const ce=z-B,V=P-O,Se={x:ce>=0?B:z,y:V>=0?O:P,width:Math.abs(ce)+1,height:Math.abs(V)+1};Ae({...W.current,range:Se},!0,!1,"drag")}}Ct==null||Ct({...d,location:[d.location[0]-F,d.location[1]]})}},[c,F,he,W,ct,Ct,Be,bt,Ce,jt,Fr,Ae]),oa=l.useCallback(()=>{var z,P;const d=yi.current;if(d===void 0)return;const[v,C]=d.scrollEdge;let[S,B]=d.location;const O=At.current;v===-1?S=((P=(z=O.extras)==null?void 0:z.freezeRegion)==null?void 0:P.x)??O.x:v===1&&(S=O.x+O.width),C===-1?B=Math.max(0,O.y):C===1&&(B=Math.min(Ce-1,O.y+O.height)),S=ln(S,0,We.length-1),B=ln(B,0,Ce-1),vi({...d,location:[S,B]})},[We.length,vi,Ce]);wu(Ks,ft,oa);const gn=l.useCallback(d=>{if(W.current===void 0)return;const[v,C]=d,[S,B]=W.current.cell,O=W.current.range;let z=O.x,P=O.x+O.width,N=O.y,Y=O.y+O.height;const[ee,ce]=Fr(B)??[0,Ce-1],V=ce+1;if(C!==0)switch(C){case 2:{Y=V,N=B,Mt(0,Y,"vertical");break}case-2:{N=ee,Y=B+1,Mt(0,N,"vertical");break}case 1:{N<B?(N++,Mt(0,N,"vertical")):(Y=Math.min(V,Y+1),Mt(0,Y,"vertical"));break}case-1:{Y>B+1?(Y--,Mt(0,Y,"vertical")):(N=Math.max(ee,N-1),Mt(0,N,"vertical"));break}default:ur()}if(v!==0)if(v===2)P=We.length,z=S,Mt(P-1-F,0,"horizontal");else if(v===-2)z=F,P=S+1,Mt(z-F,0,"horizontal");else{let Se=[];if(G!==void 0){const de=G({x:z,y:N,width:P-z-F,height:Y-N},M.current.signal);typeof de=="object"&&(Se=Eu(de))}if(v===1){let de=!1;if(z<S){if(Se.length>0){const He=eo(z+1,S+1).find(Ie=>!Se.includes(Ie-F));He!==void 0&&(z=He,de=!0)}else z++,de=!0;de&&Mt(z,0,"horizontal")}de||(P=Math.min(We.length,P+1),Mt(P-1-F,0,"horizontal"))}else if(v===-1){let de=!1;if(P>S+1){if(Se.length>0){const He=eo(P-1,S,-1).find(Ie=>!Se.includes(Ie-F));He!==void 0&&(P=He,de=!0)}else P--,de=!0;de&&Mt(P-F,0,"horizontal")}de||(z=Math.max(F,z-1),Mt(z-F,0,"horizontal"))}else ur()}Ae({cell:W.current.cell,range:{x:z,y:N,width:P-z,height:Y-N}},!0,!1,"keyboard-select")},[G,Fr,W,We.length,F,Ce,Mt,Ae]),Ci=l.useRef(io);Ci.current=io;const qn=l.useCallback((d,v,C,S)=>{const B=Nt-(C?0:1);d=ln(d,F,Rt.length-1+F),v=ln(v,0,B);const O=Cn==null?void 0:Cn[0],z=Cn==null?void 0:Cn[1];if(d===O&&v===z)return!1;if(S&&W.current!==void 0){const P=[...W.current.rangeStack];(W.current.range.width>1||W.current.range.height>1)&&P.push(W.current.range),Q({...W,current:{cell:[d,v],range:{x:d,y:v,width:1,height:1},rangeStack:P}},!0)}else Ae({cell:[d,v],range:{x:d,y:v,width:1,height:1}},!0,!1,"keyboard-nav");return u.current!==void 0&&u.current[0]===d&&u.current[1]===v&&(u.current=void 0),Ci.current&&Mt(d-F,v),!0},[Nt,F,Rt.length,Cn,W,Mt,Q,Ae]),ra=l.useCallback((d,v)=>{(r==null?void 0:r.cell)!==void 0&&d!==void 0&&to(d)&&(on([{location:r.cell,value:d}]),window.requestAnimationFrame(()=>{var B;(B=Pt.current)==null||B.damage([{cell:r.cell}])})),_t(!0),i(void 0);const[C,S]=v;if(W.current!==void 0&&(C!==0||S!==0)){const B=W.current.cell[1]===Nt-1&&d!==void 0,O=W.current.cell[0]===We.length-1&&d!==void 0;let z=!0;if(B&&S===1&&Me!==void 0){z=!1;const P=W.current.cell[0]+C,N=Po(P);Kn(N??P,!1)}if(O&&C===1&&Te!==void 0){z=!1;const P=W.current.cell[1]+S;Er(P,!1)}z&&qn(ln(W.current.cell[0]+C,0,We.length-1),ln(W.current.cell[1]+S,0,Nt-1),B,!1)}D==null||D(d,v)},[r==null?void 0:r.cell,_t,W,D,on,Nt,qn,We.length,Kn,Er,Me,Te,Po]),ia=l.useMemo(()=>`gdg-overlay-${Ru++}`,[]),ho=l.useCallback(d=>{var C,S,B,O;_t();const v=[];for(let z=d.x;z<d.x+d.width;z++)for(let P=d.y;P<d.y+d.height;P++){const N=k([z-F,P]);if(!N.allowOverlay&&N.kind!==U.Boolean)continue;let Y;if(N.kind===U.Custom){const ee=yt(N),ce=(C=ee==null?void 0:ee.provideEditor)==null?void 0:C.call(ee,{...N,location:[z-F,P]});(ee==null?void 0:ee.onDelete)!==void 0?Y=ee.onDelete(N):qa(ce)&&(Y=(S=ce==null?void 0:ce.deletedValue)==null?void 0:S.call(ce,N))}else if(to(N)&&N.allowOverlay||N.kind===U.Boolean){const ee=yt(N);Y=(B=ee==null?void 0:ee.onDelete)==null?void 0:B.call(ee,N)}Y!==void 0&&!No(Y)&&to(Y)&&v.push({location:[z,P],value:Y})}on(v),(O=Pt.current)==null||O.damage(v.map(z=>({cell:z.location})))},[_t,k,yt,on,F]),er=r!==void 0,il=l.useCallback(d=>{var He,Ie;const v=()=>{d.stopPropagation(),d.preventDefault()},C={didMatch:!1},{bounds:S}=d,B=W.columns,O=W.rows,z=vn;if(!er&&$e(z.clear,d,C))Q(Nr,!1),Et==null||Et();else if(!er&&$e(z.selectAll,d,C))Q({columns:st.empty(),rows:st.empty(),current:{cell:((He=W.current)==null?void 0:He.cell)??[F,0],range:{x:F,y:0,width:y.length,height:Ce},rangeStack:[]}},!1);else if($e(z.search,d,C))(Ie=a==null?void 0:a.current)==null||Ie.focus({preventScroll:!0}),so(!0);else if($e(z.delete,d,C)){const ye=(qe==null?void 0:qe(W))??!0;if(ye!==!1){const nt=ye===!0?W:ye;if(nt.current!==void 0){ho(nt.current.range);for(const xt of nt.current.rangeStack)ho(xt)}for(const xt of nt.rows)ho({x:F,y:xt,width:y.length,height:1});for(const xt of nt.columns)ho({x:xt,y:0,width:1,height:Ce})}}if(C.didMatch)return v(),!0;if(W.current===void 0)return!1;let[P,N]=W.current.cell;const[,Y]=W.current.cell;let ee=!1,ce=!1;if($e(z.scrollToSelectedCell,d,C))Tr.current(P-F,N);else if(Z!=="none"&&$e(z.selectColumn,d,C))B.hasIndex(P)?De(B.remove(P),void 0,!0):Z==="single"?De(st.fromSingleSelection(P),void 0,!0):De(void 0,P,!0);else if(he!=="none"&&$e(z.selectRow,d,C))O.hasIndex(N)?Be(O.remove(N),void 0,!0):he==="single"?Be(st.fromSingleSelection(N),void 0,!0):Be(void 0,N,!0);else if(!er&&S!==void 0&&$e(z.activateCell,d,C))if(N===Ce&&bt)window.setTimeout(()=>{const ye=Po(P);Kn(ye??P)},0);else{const ye={inputType:"keyboard",key:d.key};A==null||A([P-F,N],ye),Bo(S,ye)}else W.current.range.height>1&&$e(z.downFill,d,C)?ol():W.current.range.width>1&&$e(z.rightFill,d,C)?nl():$e(z.goToNextPage,d,C)?N+=Math.max(1,At.current.height-4):$e(z.goToPreviousPage,d,C)?N-=Math.max(1,At.current.height-4):$e(z.goToFirstCell,d,C)?(i(void 0),N=0,P=0):$e(z.goToLastCell,d,C)?(i(void 0),N=Number.MAX_SAFE_INTEGER,P=Number.MAX_SAFE_INTEGER):$e(z.selectToFirstCell,d,C)?(i(void 0),gn([-2,-2])):$e(z.selectToLastCell,d,C)?(i(void 0),gn([2,2])):er?($e(z.closeOverlay,d,C)&&i(void 0),$e(z.acceptOverlayDown,d,C)&&(i(void 0),N++),$e(z.acceptOverlayUp,d,C)&&(i(void 0),N--),$e(z.acceptOverlayLeft,d,C)&&(i(void 0),P--),$e(z.acceptOverlayRight,d,C)&&(i(void 0),P++)):($e(z.goDownCell,d,C)?N+=1:$e(z.goUpCell,d,C)?N-=1:$e(z.goRightCell,d,C)?P+=1:$e(z.goLeftCell,d,C)?P-=1:$e(z.goDownCellRetainSelection,d,C)?(N+=1,ee=!0):$e(z.goUpCellRetainSelection,d,C)?(N-=1,ee=!0):$e(z.goRightCellRetainSelection,d,C)?(P+=1,ee=!0):$e(z.goLeftCellRetainSelection,d,C)?(P-=1,ee=!0):$e(z.goToLastRow,d,C)?N=Ce-1:$e(z.goToFirstRow,d,C)?N=Number.MIN_SAFE_INTEGER:$e(z.goToLastColumn,d,C)?P=Number.MAX_SAFE_INTEGER:$e(z.goToFirstColumn,d,C)?P=Number.MIN_SAFE_INTEGER:(ct==="rect"||ct==="multi-rect")&&($e(z.selectGrowDown,d,C)?gn([0,1]):$e(z.selectGrowUp,d,C)?gn([0,-1]):$e(z.selectGrowRight,d,C)?gn([1,0]):$e(z.selectGrowLeft,d,C)?gn([-1,0]):$e(z.selectToLastRow,d,C)?gn([0,2]):$e(z.selectToFirstRow,d,C)?gn([0,-2]):$e(z.selectToLastColumn,d,C)?gn([2,0]):$e(z.selectToFirstColumn,d,C)&&gn([-2,0])),ce=C.didMatch);if(hn!==void 0&&hn!=="normal"&&N!==Y){const ye=hn==="skip-up"||hn==="skip"||hn==="block",nt=hn==="skip-down"||hn==="skip"||hn==="block",xt=N<Y;if(xt&&ye){for(;N>=0&&uo(N).isGroupHeader;)N--;N<0&&(N=Y)}else if(!xt&&nt){for(;N<Ce&&uo(N).isGroupHeader;)N++;N>=Ce&&(N=Y)}}const Se=qn(P,N,!1,ee),de=C.didMatch;return de&&(Se||!ce||Hn)&&v(),de},[hn,er,W,vn,Z,he,ct,F,uo,Ce,qn,Q,Et,y.length,qe,Hn,ho,De,Be,bt,Po,Kn,A,Bo,ol,nl,gn]),tr=l.useCallback(d=>{let v=!1;if(Le!==void 0&&Le({...d,...d.location&&{location:[d.location[0]-F,d.location[1]]},cancel:()=>{v=!0}}),v||il(d)||W.current===void 0)return;const[C,S]=W.current.cell,B=At.current;if(rt&&!d.metaKey&&!d.ctrlKey&&W.current!==void 0&&d.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(d.key)&&d.bounds!==void 0&&Oo(k([C-F,Math.max(0,Math.min(S,Ce-1))]))){if((!bt||S!==Ce)&&(B.y>S||S>B.y+B.height||B.x>C||C>B.x+B.width))return;const O={inputType:"keyboard",key:d.key};A==null||A([C-F,S],O),Bo(d.bounds,O,d.key),d.stopPropagation(),d.preventDefault()}},[rt,Le,il,W,k,F,Ce,bt,A,Bo]),la=l.useCallback((d,v)=>{const C=d.location[0]-F;if(d.kind==="header"&&(be==null||be(C,{...d,preventDefault:v})),d.kind===pn){if(C<0)return;K==null||K(C,{...d,preventDefault:v})}if(d.kind==="cell"){const[S,B]=d.location;re==null||re([C,B],{...d,preventDefault:v}),hc(W,d.location)||qn(S,B,!1,!1)}},[W,re,K,be,F,qn]),xi=l.useCallback(async d=>{var z,P,N;if(!vn.paste)return;function v(Y,ee,ce,V){var de,He;const Se=typeof ce=="object"?(ce==null?void 0:ce.join(`
`))??"":(ce==null?void 0:ce.toString())??"";if(!No(Y)&&Oo(Y)&&Y.readonly!==!0){const Ie=_==null?void 0:_(Se,Y);if(Ie!==void 0&&to(Ie))return{location:ee,value:Ie};const ye=yt(Y);if(ye===void 0)return;if(ye.kind===U.Custom){Qt(Y.kind===U.Custom);const nt=(de=ye.onPaste)==null?void 0:de.call(ye,Se,Y.data);return nt===void 0?void 0:{location:ee,value:{...Y,data:nt}}}else{const nt=(He=ye.onPaste)==null?void 0:He.call(ye,Se,Y,{formatted:V,formattedString:typeof V=="string"?V:V==null?void 0:V.join(`
`),rawValue:ce});return nt===void 0?void 0:(Qt(nt.kind===Y.kind),{location:ee,value:nt})}}}const C=W.columns,S=W.rows,B=((z=ft.current)==null?void 0:z.contains(document.activeElement))===!0||((P=s.current)==null?void 0:P.contains(document.activeElement))===!0;let O;if(W.current!==void 0?O=[W.current.range.x,W.current.range.y]:C.length===1?O=[C.first()??0,0]:S.length===1&&(O=[F,S.first()??0]),B&&O!==void 0){let Y,ee;const ce="text/plain",V="text/html";if(navigator.clipboard.read!==void 0){const Ie=await navigator.clipboard.read();for(const ye of Ie){if(ye.types.includes(V)){const xt=await(await ye.getType(V)).text(),zt=Tl(xt);if(zt!==void 0){Y=zt;break}}ye.types.includes(ce)&&(ee=await(await ye.getType(ce)).text())}}else if(navigator.clipboard.readText!==void 0)ee=await navigator.clipboard.readText();else if(d!==void 0&&(d==null?void 0:d.clipboardData)!==null){if(d.clipboardData.types.includes(V)){const Ie=d.clipboardData.getData(V);Y=Tl(Ie)}Y===void 0&&d.clipboardData.types.includes(ce)&&(ee=d.clipboardData.getData(ce))}else return;const[Se,de]=O,He=[];do{if(ie===void 0){const Ie=Jt(O),ye=ee??(Y==null?void 0:Y.map(xt=>xt.map(zt=>zt.rawValue).join("	")).join("	"))??"",nt=v(Ie,O,ye,void 0);nt!==void 0&&He.push(nt);break}if(Y===void 0){if(ee===void 0)return;Y=du(ee)}if(ie===!1||typeof ie=="function"&&(ie==null?void 0:ie([O[0]-F,O[1]],Y.map(Ie=>Ie.map(ye=>{var nt;return((nt=ye.rawValue)==null?void 0:nt.toString())??""}))))!==!0)return;for(const[Ie,ye]of Y.entries()){if(Ie+de>=Ce)break;for(const[nt,xt]of ye.entries()){const zt=[nt+Se,Ie+de],[Vt,xn]=zt;if(Vt>=We.length||xn>=Nt)continue;const mn=Jt(zt),kn=v(mn,zt,xt.rawValue,xt.formatted);kn!==void 0&&He.push(kn)}}}while(!1);on(He),(N=Pt.current)==null||N.damage(He.map(Ie=>({cell:Ie.location})))}},[_,yt,Jt,W,vn.paste,ft,We.length,on,Nt,ie,F,Ce]);Ut("paste",xi,g,!1,!0);const nr=l.useCallback(async(d,v)=>{var z,P;if(!vn.copy)return;const C=v===!0||((z=ft.current)==null?void 0:z.contains(document.activeElement))===!0||((P=s.current)==null?void 0:P.contains(document.activeElement))===!0,S=W.columns,B=W.rows,O=(N,Y)=>{if(!pe)zl(N,Y,d);else{const ee=Y.map(ce=>({kind:U.Text,data:y[ce].title,displayData:y[ce].title,allowOverlay:!1}));zl([ee,...N],Y,d)}};if(C&&G!==void 0){if(W.current!==void 0){let N=G(W.current.range,M.current.signal);typeof N!="object"&&(N=await N()),O(N,eo(W.current.range.x-F,W.current.range.x+W.current.range.width-F))}else if(B!==void 0&&B.length>0){const Y=[...B].map(ee=>{const ce=G({x:F,y:ee,width:y.length,height:1},M.current.signal);return typeof ce=="object"?ce[0]:ce().then(V=>V[0])});if(Y.some(ee=>ee instanceof Promise)){const ee=await Promise.all(Y);O(ee,eo(y.length))}else O(Y,eo(y.length))}else if(S.length>0){const N=[],Y=[];for(const ee of S){let ce=G({x:ee,y:0,width:1,height:Ce},M.current.signal);typeof ce!="object"&&(ce=await ce()),N.push(ce),Y.push(ee-F)}if(N.length===1)O(N[0],Y);else{const ee=N.reduce((ce,V)=>ce.map((Se,de)=>[...Se,...V[de]]));O(ee,Y)}}}},[y,G,W,vn.copy,F,ft,Ce,pe]);Ut("copy",nr,g,!1,!1);const sa=l.useCallback(async d=>{var C,S;if(!(!vn.cut||!(((C=ft.current)==null?void 0:C.contains(document.activeElement))===!0||((S=s.current)==null?void 0:S.contains(document.activeElement))===!0))&&(await nr(d),W.current!==void 0)){let B={current:{cell:W.current.cell,range:W.current.range,rangeStack:[]},rows:st.empty(),columns:st.empty()};const O=qe==null?void 0:qe(B);if(O===!1||(B=O===!0?B:O,B.current===void 0))return;ho(B.current.range)}},[ho,W,vn.cut,nr,ft,qe]);Ut("cut",sa,g,!1,!1);const aa=l.useCallback((d,v)=>{if(Ge!==void 0){F!==0&&(d=d.map(B=>[B[0]-F,B[1]])),Ge(d,v);return}if(d.length===0||v===-1)return;const[C,S]=d[v];u.current!==void 0&&u.current[0]===C&&u.current[1]===S||(u.current=[C,S],qn(C,S,!1,!1))},[Ge,F,qn]),[Dr,Hr]=((fl=Yt==null?void 0:Yt.current)==null?void 0:fl.cell)??[],Tr=l.useRef(Mt);Tr.current=Mt,l.useLayoutEffect(()=>{var d,v,C,S;Ci.current&&!ao.current&&Dr!==void 0&&Hr!==void 0&&(Dr!==((v=(d=J.current)==null?void 0:d.current)==null?void 0:v.cell[0])||Hr!==((S=(C=J.current)==null?void 0:C.current)==null?void 0:S.cell[1]))&&Tr.current(Dr,Hr),ao.current=!1},[Dr,Hr]);const ll=W.current!==void 0&&(W.current.cell[0]>=We.length||W.current.cell[1]>=Nt);l.useLayoutEffect(()=>{ll&&Q(Nr,!1)},[ll,Q]);const ca=l.useMemo(()=>bt===!0&&(Ye==null?void 0:Ye.tint)===!0?st.fromSingleSelection(Nt-1):st.empty(),[Nt,bt,Ye==null?void 0:Ye.tint]),da=l.useCallback(d=>typeof it=="boolean"?it:(it==null?void 0:it(d-F))??!0,[F,it]),ua=l.useMemo(()=>{if(mi===void 0||s.current===null)return null;const{bounds:d,group:v}=mi,C=s.current.getBoundingClientRect();return l.createElement(Qd,{bounds:d,group:v,canvasBounds:C,onClose:()=>pi(void 0),onFinish:S=>{pi(void 0),ve==null||ve(v,S)}})},[ve,mi]),fa=Math.min(We.length,_e+(Zt?1:0));l.useImperativeHandle(t,()=>({appendRow:(d,v)=>Kn(d+F,v),appendColumn:(d,v)=>Er(d,v),updateCells:d=>{var v;return F!==0&&(d=d.map(C=>({cell:[C.cell[0]+F,C.cell[1]]}))),(v=Pt.current)==null?void 0:v.damage(d)},getBounds:(d,v)=>{var C;if(!((s==null?void 0:s.current)===null||(ft==null?void 0:ft.current)===null)){if(d===void 0&&v===void 0){const S=s.current.getBoundingClientRect(),B=S.width/ft.current.clientWidth;return{x:S.x-ft.current.scrollLeft*B,y:S.y-ft.current.scrollTop*B,width:ft.current.scrollWidth*B,height:ft.current.scrollHeight*B}}return(C=Pt.current)==null?void 0:C.getBounds((d??0)+F,v)}},focus:()=>{var d;return(d=Pt.current)==null?void 0:d.focus()},emit:async d=>{switch(d){case"delete":tr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":tr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":tr({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await nr(void 0,!0);break;case"paste":await xi();break}},scrollTo:Mt,remeasureColumns:d=>{for(const v of d)Ir(v+F)},getMouseArgsForPosition:(d,v,C)=>{if((Pt==null?void 0:Pt.current)===null)return;const S=Pt.current.getMouseArgsForPosition(d,v,C);if(S!==void 0)return{...S,location:[S.location[0]-F,S.location[1]]}}}),[Kn,Er,Ir,ft,nr,tr,xi,F,Mt]);const[sl,al]=Cn??[],ha=l.useCallback(d=>{const[v,C]=d;if(C===-1){Z!=="none"&&(De(st.fromSingleSelection(v),void 0,!1),_t());return}sl===v&&al===C||(Ae({cell:d,range:{x:v,y:C,width:1,height:1}},!0,!1,"keyboard-nav"),Mt(v,C))},[Z,_t,Mt,sl,al,Ae,De]),[ga,ma]=l.useState(!1),cl=l.useRef(ns(d=>{ma(d)},5)),pa=l.useCallback(()=>{cl.current(!0),W.current===void 0&&W.columns.length===0&&W.rows.length===0&&c===void 0&&Ae({cell:[F,xr],range:{x:F,y:xr,width:1,height:1}},!0,!1,"keyboard-select")},[xr,W,c,F,Ae]),wa=l.useCallback(()=>{cl.current(!1)},[]),[ba,ya]=l.useMemo(()=>{let d;const v=(Ke==null?void 0:Ke.scrollbarWidthOverride)??Ai(),C=Ce+(bt?1:0);if(typeof yn=="number")d=Ot+C*yn;else{let B=0;const O=Math.min(C,10);for(let z=0;z<O;z++)B+=yn(z);B=Math.floor(B/O),d=Ot+C*B}d+=v;const S=We.reduce((B,O)=>O.width+B,0)+v;return[`${Math.min(1e5,S)}px`,`${Math.min(1e5,d)}px`]},[We,Ke==null?void 0:Ke.scrollbarWidthOverride,yn,Ce,bt,Ot]),va=l.useMemo(()=>Ec(Je),[Je]);return l.createElement(Ic.Provider,{value:Je},l.createElement(gu,{style:va,className:Ee,inWidth:p??ba,inHeight:x??ya},l.createElement(qd,{fillHandle:Ht,drawFocusRing:Mo,experimental:Ke,fixedShadowX:In,fixedShadowY:mr,getRowThemeOverride:dn,headerIcons:On,imageWindowLoader:Fn,initialSize:Dn,isDraggable:yo,onDragLeave:pr,onRowMoved:Nn,overscrollX:li,overscrollY:si,preventDiagonalScrolling:xo,rightElement:ko,rightElementProps:ro,smoothScrollX:Jr,smoothScrollY:wr,className:Ee,enableGroups:nn,onCanvasFocused:pa,onCanvasBlur:wa,canvasRef:s,onContextMenu:la,theme:Je,cellXOffset:_s,cellYOffset:xr,accessibilityHeight:Bn.height,onDragEnd:na,columns:We,nonGrowWidth:lt,drawHeader:Tt,onColumnProposeMove:Qs,drawCell:we,disabledRows:ca,freezeColumns:fa,lockColumns:F,firstColAccessible:F===0,getCellContent:Jt,minColumnWidth:_n,maxColumnWidth:Do,searchInputRef:a,showSearch:ci,onSearchClose:To,highlightRegions:Us,getCellsForSelection:G,getGroupDetails:ui,headerHeight:jo,isFocused:ga,groupHeaderHeight:nn?Cr:0,freezeTrailingRows:Dt+(bt&&(Ye==null?void 0:Ye.sticky)===!0?1:0),hasAppendRow:bt,onColumnResize:ke,onColumnResizeEnd:Ve,onColumnResizeStart:ge,onCellFocused:ha,onColumnMoved:ea,onDragStart:ta,onHeaderMenuClick:js,onHeaderIndicatorClick:Zs,onItemHovered:vi,isFilling:(c==null?void 0:c.fillHandle)===!0,onMouseMove:qs,onKeyDown:tr,onKeyUp:Ne,onMouseDown:Ys,onMouseUp:Vs,onDragOverCell:tn,onDrop:Xt,onSearchResultsChanged:aa,onVisibleRegionChanged:Js,clientSize:St,rowHeight:yn,searchResults:q,searchValue:ue,onSearchValueChange:oe,rows:Nt,scrollRef:ft,selection:W,translateX:Bn.tx,translateY:Bn.ty,verticalBorder:da,gridRef:Pt,getCellRenderer:yt,resizeIndicator:br}),ua,r!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(Mu,{...r,validateCell:ae,bloom:X,id:ia,getCellRenderer:yt,className:(Ke==null?void 0:Ke.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:$t,imageEditorOverride:w,portalElementRef:yr,onFinishEditing:ra,markdownDivCreateNode:h,isOutsideClick:ni,customEventTarget:Ke==null?void 0:Ke.eventTarget}))))},Fu=l.forwardRef(Iu);function Ll(e){const{cell:t,posX:n,posY:o,bounds:r,theme:i}=e,{width:a,height:s,x:c,y:f}=r,u=t.maxSize??i.checkboxMaxSize,g=Math.floor(r.y+s/2),w=as(u,s,i.cellVerticalPadding),m=ss(t.contentAlign??"center",c,a,i.cellHorizontalPadding,w),h=ls(m,g,w),p=cs(c+n,f+o,h);return Ni(t)&&p}const Du={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:U.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>Hu(e,e.cell.data,Ni(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Ll(e)&&e.preventDefault()},onClick:e=>{if(Ll(e))return{...e.cell,data:Bs(e.cell.data)}},onPaste:(e,t)=>{let n=_r;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=Oi),n===t.data?void 0:{...t,data:n}}};function Hu(e,t,n,o,r){if(!n&&t===_r)return;const{ctx:i,hoverAmount:a,theme:s,rect:c,highlighted:f,hoverX:u,hoverY:g,cell:{contentAlign:w}}=e,{x:m,y:h,width:p,height:x}=c;let y=!1;if(r>0){let b=n?1-r+r*a:.4;if(t===_r&&(b*=a),b===0)return;b<1&&(y=!0,i.globalAlpha=b)}Ki(i,s,t,m,h,p,x,f,u,g,o,w),y&&(i.globalAlpha=1)}const Tu=Wt("div")({name:"BubblesOverlayEditorStyle",class:"gdg-b1ygi5by",propsAsIs:!1}),Au=e=>{const{bubbles:t}=e;return l.createElement(Tu,null,t.map((n,o)=>l.createElement("div",{key:o,className:"boe-bubble"},n)),l.createElement("textarea",{className:"gdg-input",autoFocus:!0}))},zu={getAccessibilityString:e=>ds(e.data),kind:U.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((r,i)=>e.measureText(i).width+r+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Bu(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return l.createElement(Au,{bubbles:t.data})},onPaste:()=>{}};function Bu(e,t){const{rect:n,theme:o,ctx:r,highlighted:i}=e,{x:a,y:s,width:c,height:f}=n;let u=a+o.cellHorizontalPadding;const g=[];for(const w of t){if(u>a+c)break;const m=Ko(w,r,o.baseFontFull).width;g.push({x:u,width:m}),u+=m+o.bubblePadding*2+o.bubbleMargin}r.beginPath();for(const w of g)Mn(r,w.x,s+(f-o.bubbleHeight)/2,w.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);r.fillStyle=i?o.bgBubbleSelected:o.bgBubble,r.fill();for(const[w,m]of g.entries())r.beginPath(),r.fillStyle=o.textBubble,r.fillText(t[w],m.x+o.bubblePadding,s+f/2+no(r,o))}const Pu=Wt("div")({name:"DrilldownOverlayEditorStyle",class:"gdg-d4zsq0x",propsAsIs:!1}),Lu=e=>{const{drilldowns:t}=e;return l.createElement(Pu,null,t.map((n,o)=>l.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&l.createElement("img",{src:n.img}),l.createElement("div",null,n.text))))},Wu={getAccessibilityString:e=>ds(e.data.map(t=>t.text)),kind:U.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,r)=>e.measureText(r.text).width+o+n.bubblePadding*2+n.bubbleMargin+(r.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Ou(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return l.createElement(Lu,{drilldowns:t.data})},onPaste:()=>{}},Fi={};function $u(e,t,n,o){const r=Math.ceil(window.devicePixelRatio),i=5,a=n-i*2,s=4,c=n*r,f=o+i,u=o*3,g=(u+i*2)*r,w=`${e},${t},${r},${n}`;if(Fi[w]!==void 0)return{el:Fi[w],height:c,width:g,middleWidth:s*r,sideWidth:f*r,padding:i*r,dpr:r};const m=document.createElement("canvas"),h=m.getContext("2d");return h===null?null:(m.width=g,m.height=c,h.scale(r,r),Fi[w]=m,h.beginPath(),Mn(h,i,i,u,a,o),h.shadowColor="rgba(24, 25, 34, 0.4)",h.shadowBlur=1,h.fillStyle=e,h.fill(),h.shadowColor="rgba(24, 25, 34, 0.3)",h.shadowOffsetY=1,h.shadowBlur=5,h.fillStyle=e,h.fill(),h.shadowOffsetY=0,h.shadowBlur=0,h.shadowBlur=0,h.beginPath(),Mn(h,i+.5,i+.5,u,a,o),h.strokeStyle=t,h.lineWidth=1,h.stroke(),{el:m,height:c,width:g,sideWidth:f*r,middleWidth:o*r,padding:i*r,dpr:r})}function Ou(e,t){const{rect:n,theme:o,ctx:r,imageLoader:i,col:a,row:s}=e,{x:c,width:f}=n,u=o.baseFontFull,g=ws(r,u),w=Math.min(n.height,Math.max(16,Math.ceil(g*o.lineHeight)*2)),m=Math.floor(n.y+(n.height-w)/2),h=w-10,p=o.bubblePadding,x=o.bubbleMargin;let y=c+o.cellHorizontalPadding;const b=o.roundingRadius??6,k=$u(o.bgCell,o.drilldownBorder,w,b),T=[];for(const A of t){if(y>c+f)break;const D=Ko(A.text,r,u).width;let _=0;A.img!==void 0&&i.loadOrGetImage(A.img,a,s)!==void 0&&(_=h-8+4);const R=D+_+p*2;T.push({x:y,width:R}),y+=R+x}if(k!==null){const{el:A,height:E,middleWidth:D,sideWidth:_,width:R,dpr:$,padding:X}=k,L=_/$,H=X/$;for(const I of T){const le=Math.floor(I.x),j=Math.floor(I.width),re=j-(L-H)*2;r.imageSmoothingEnabled=!1,r.drawImage(A,0,0,_,E,le-H,m,L,w),re>0&&r.drawImage(A,_,0,D,E,le+(L-H),m,re,w),r.drawImage(A,R-_,0,_,E,le+j-(L-H),m,L,w),r.imageSmoothingEnabled=!0}}r.beginPath();for(const[A,E]of T.entries()){const D=t[A];let _=E.x+p;if(D.img!==void 0){const R=i.loadOrGetImage(D.img,a,s);if(R!==void 0){const $=h-8;let X=0,L=0,H=R.width,I=R.height;H>I?(X+=(H-I)/2,H=I):I>H&&(L+=(I-H)/2,I=H),r.beginPath(),Mn(r,_,m+w/2-$/2,$,$,o.roundingRadius??3),r.save(),r.clip(),r.drawImage(R,X,L,H,I,_,m+w/2-$/2,$,$),r.restore(),_+=$+4}}r.beginPath(),r.fillStyle=o.textBubble,r.fillText(D.text,_,m+w/2+no(r,o))}}const Nu={getAccessibilityString:e=>e.data.join(", "),kind:U.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Xu(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,r=o??ic;return l.createElement(r,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:i=>{n({...t,data:[i]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(r=>{try{return new URL(r),r}catch{return}}).filter(r=>r!==void 0);if(!(o.length===t.data.length&&o.every((r,i)=>r===t.data[i])))return{...t,data:o}}},Di=4;function Xu(e,t,n,o){const{rect:r,col:i,row:a,theme:s,ctx:c,imageLoader:f}=e,{x:u,y:g,height:w,width:m}=r,h=w-s.cellVerticalPadding*2,p=[];let x=0;for(let b=0;b<t.length;b++){const k=t[b];if(k.length===0)continue;const T=f.loadOrGetImage(k,i,a);if(T!==void 0){p[b]=T;const A=T.width*(h/T.height);x+=A+Di}}if(x===0)return;x-=Di;let y=u+s.cellHorizontalPadding;o==="right"?y=Math.floor(u+m-s.cellHorizontalPadding-x):o==="center"&&(y=Math.floor(u+m/2-x/2));for(const b of p){if(b===void 0)continue;const k=b.width*(h/b.height);n>0&&(c.beginPath(),Mn(c,y,g+s.cellVerticalPadding,k,h,n),c.save(),c.clip()),c.drawImage(b,y,g+s.cellVerticalPadding,k,h),n>0&&c.restore(),y+=k+Di}}function Gu(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const _u={getAccessibilityString:()=>"",kind:U.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:r,rect:i,theme:a}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Gu(n,o)*t.skeletonWidthVariability));const c=a.cellHorizontalPadding;s+c*2>=i.width&&(s=i.width-c*2-1);const f=t.skeletonHeight??Math.min(18,i.height-2*a.cellVerticalPadding);Mn(r,i.x+c,i.y+(i.height-f)/2,s,f,a.roundingRadius??3),r.fillStyle=wo(a.textDark,.1),r.fill()},onPaste:()=>{}},Uu=()=>e=>e.targetWidth,Wl=Wt("div")({name:"MarkdownOverlayEditorStyle",class:"gdg-m1pnx84e",propsAsIs:!1,vars:{"m1pnx84e-0":[Uu(),"px"]}}),Yu=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:r,targetRect:i,onFinish:a,validatedSelection:s}=e,c=t.data,f=t.readonly===!0,[u,g]=l.useState(c===""||o),w=l.useCallback(()=>{g(h=>!h)},[]),m=c?"gdg-ml-6":"";return u?l.createElement(Wl,{targetWidth:i.width-20},l.createElement(jr,{autoFocus:!0,highlight:!1,validatedSelection:s,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),l.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${m}`,onClick:()=>a(t)},l.createElement(Ja,null))):l.createElement(Wl,{targetWidth:i.width},l.createElement(sc,{contents:c,createNode:r}),!f&&l.createElement(l.Fragment,null,l.createElement("div",{className:"spacer"}),l.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${m}`,onClick:w},l.createElement(Xi,null))),l.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!0}))},Ku={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:gr,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Ln(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:r,markdownDivCreateNode:i,forceEditMode:a,validatedSelection:s}=e;return l.createElement(Yu,{onFinish:r,targetRect:o,value:n,validatedSelection:s,onChange:c=>t({...n,data:c.target.value}),forceEditMode:a,createNode:i})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},Vu={getAccessibilityString:e=>e.row.toString(),kind:sn.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:qu,measure:()=>44,draw:e=>Zu(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:r}=e,{width:i,height:a}=t,s=n.drawHandle?7+(i-7)/2:i/2,c=a/2;if(Math.abs(o-s)<=10&&Math.abs(r-c)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function qu(e,t){const{ctx:n,theme:o}=e,r=o.markerFontFull,i=t??{};return(i==null?void 0:i.font)!==r&&(n.font=r,i.font=r),i.deprep=ju,n.textAlign="center",i}function ju(e){const{ctx:t}=e;t.textAlign="start"}function Zu(e,t,n,o,r,i){const{ctx:a,rect:s,hoverAmount:c,theme:f}=e,{x:u,y:g,width:w,height:m}=s,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){a.globalAlpha=h;const p=7*(n?c:1);if(Ki(a,f,n,r?u+p:u,g,r?w-p:w,m,!0,void 0,void 0,f.checkboxMaxSize,"center",i),r){a.globalAlpha=c,a.beginPath();for(const x of[3,6])for(const y of[-5,-1,3])a.rect(u+x,g+m/2+y,2,2);a.fillStyle=f.textLight,a.fill(),a.beginPath()}a.globalAlpha=1}if(o==="number"||o==="both"&&!n){const p=t.toString(),x=f.markerFontFull,y=u+w/2;o==="both"&&c!==0&&(a.globalAlpha=1-c),a.fillStyle=f.textLight,a.font=x,a.fillText(p,y,g+m/2+no(a,x)),c!==0&&(a.globalAlpha=1)}}const Ju={getAccessibilityString:()=>"",kind:sn.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>Qu(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function Qu(e,t,n){const{ctx:o,rect:r,hoverAmount:i,theme:a,spriteManager:s}=e,{x:c,y:f,width:u,height:g}=r;o.beginPath(),o.globalAlpha=i,o.rect(c+1,f+1,u,g-2),o.fillStyle=a.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const w=t!=="";let m=0;if(n!==void 0){const p=g-8,x=c+8/2,y=f+8/2;s.drawSprite(n,"normal",o,x,y,p,a,w?1:i),m=p}else{m=24;const h=12,p=w?h:i*h,x=w?0:(1-i)*h*.5,y=a.cellHorizontalPadding+4;p>0&&(o.moveTo(c+y+x,f+g/2),o.lineTo(c+y+x+p,f+g/2),o.moveTo(c+y+x+p*.5,f+g/2-p*.5),o.lineTo(c+y+x+p*.5,f+g/2+p*.5),o.lineWidth=2,o.strokeStyle=a.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=a.textMedium,o.fillText(t,m+c+a.cellHorizontalPadding+.5,f+g/2+no(o,a)),o.beginPath()}function Ws(e,t,n,o,r,i,a){e.textBaseline="alphabetic";const s=ef(e,r,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),Mn(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=i,e.fillStyle=(n==null?void 0:n.bgColor)??wo(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",a==null||a("text")}function ef(e,t,n,o,r){const i=o.cellHorizontalPadding,a=o.cellVerticalPadding;if(r)return{x:t.x+i/2,y:t.y+a/2+1,width:t.width-i,height:t.height-a-1};const s=Ko(n,e,o.baseFontFull,"alphabetic"),c=t.height-a,f=Math.min(c,s.actualBoundingBoxAscent*2.5);return{x:t.x+i/2,y:t.y+(t.height-f)/2+1,width:s.width+i*3,height:f-1}}const tf=l.lazy(async()=>await rs(()=>import("./number-overlay-editor-Db1E5UP0.js"),__vite__mapDeps([10,1,2,4,11]),import.meta.url)),nf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:gr,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:r,rect:i,overrideCursor:a}=e,{hoverEffect:s,displayData:c,hoverEffectTheme:f}=n;s===!0&&t>0&&Ws(o,r,f,c,i,t,a),Ln(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return l.createElement(l.Suspense,{fallback:null},l.createElement(tf,{highlight:t,disabled:o.readonly===!0,value:o.data,fixedDecimals:o.fixedDecimals,allowNegative:o.allowNegative,thousandSeparator:o.thousandSeparator,decimalSeparator:o.decimalSeparator,validatedSelection:r,onChange:i=>n({...o,data:Number.isNaN(i.floatValue??0)?0:i.floatValue})}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},of={getAccessibilityString:()=>"",measure:()=>108,kind:U.Protected,needsHover:!1,needsHoverPosition:!1,draw:rf,onPaste:()=>{}};function rf(e){const{ctx:t,theme:n,rect:o}=e,{x:r,y:i,height:a}=o;t.beginPath();const s=2.5;let c=r+n.cellHorizontalPadding+s;const f=i+a/2,u=Math.cos(wl(30))*s,g=Math.sin(wl(30))*s;for(let w=0;w<12;w++)t.moveTo(c,f-s),t.lineTo(c,f+s),t.moveTo(c+u,f-g),t.lineTo(c-u,f+g),t.moveTo(c-u,f-g),t.lineTo(c+u,f+g),c+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const lf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.RowID,needsHover:!1,needsHoverPosition:!1,drawPrep:(e,t)=>gr(e,t,e.theme.textLight),draw:e=>Ln(e,e.cell.data,e.cell.contentAlign),measure:(e,t,n)=>e.measureText(t.data).width+n.cellHorizontalPadding*2,provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,value:o,validatedSelection:r}=e;return at.createElement(jr,{highlight:t,autoFocus:o.readonly!==!0,disabled:o.readonly!==!1,value:o.data,validatedSelection:r,onChange:i=>n({...o,data:i.target.value})})},onPaste:()=>{}},sf={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:gr,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:r,rect:i,theme:a,overrideCursor:s}=e,{displayData:c,contentAlign:f,hoverEffect:u,allowWrapping:g,hoverEffectTheme:w}=t;u===!0&&n>0&&Ws(r,a,w,c,i,n,s),Ln(e,c,f,g,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let r=0;for(const i of o)r=Math.max(r,e.measureText(i).width);return r+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:r,validatedSelection:i}=t;return l.createElement(jr,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:r.readonly!==!0,disabled:r.readonly===!0,altNewline:!0,value:r.data,validatedSelection:i,onChange:a=>o({...r,data:a.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},af=Wt("div")({name:"UriOverlayEditorStyle",class:"gdg-u1rrojo",propsAsIs:!1}),cf=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:r,validatedSelection:i,preview:a}=e,[s,c]=l.useState(!r&&(t===""||o)),f=l.useCallback(()=>{c(!0)},[]);return s?l.createElement(jr,{validatedSelection:i,highlight:!0,autoFocus:!0,value:t,onChange:n}):l.createElement(af,null,l.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},a),!r&&l.createElement("div",{className:"gdg-edit-icon",onClick:f},l.createElement(Xi,null)),l.createElement("textarea",{className:"gdg-input",autoFocus:!0}))};function $s(e,t,n,o){let r=n.cellHorizontalPadding;const i=t.height/2-e.actualBoundingBoxAscent/2,a=e.width,s=e.actualBoundingBoxAscent;return o==="right"?r=t.width-a-n.cellHorizontalPadding:o==="center"&&(r=t.width/2-a/2),{x:r,y:i,width:a,height:s}}function $l(e){const{cell:t,bounds:n,posX:o,posY:r,theme:i}=e,a=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=ms(a,i.baseFontFull);if(s===void 0)return!1;const c=$s(s,n,i,t.contentAlign);return po({x:c.x-4,y:c.y-4,width:c.width+8,height:c.height+8},o,r)}const df={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:U.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:gr,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:r,hoverY:i,rect:a,ctx:s}=e,c=t.displayData??t.data,f=t.hoverEffect===!0;if(o!==void 0&&f&&r!==void 0&&i!==void 0){const u=Ko(c,s,n.baseFontFull),g=$s(u,a,n,t.contentAlign),{x:w,y:m,width:h,height:p}=g;if(r>=w-4&&r<=w-4+h+8&&i>=m-4&&i<=m-4+p+8){const x=no(s,n.baseFontFull);o("pointer");const y=5,b=m-x;s.beginPath(),s.moveTo(a.x+w,Math.floor(a.y+b+p+y)+.5),s.lineTo(a.x+w+h,Math.floor(a.y+b+p+y)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,Ln({...e,rect:{...a,x:a.x-1}},c,t.contentAlign),Ln({...e,rect:{...a,x:a.x-2}},c,t.contentAlign),Ln({...e,rect:{...a,x:a.x+1}},c,t.contentAlign),Ln({...e,rect:{...a,x:a.x+2}},c,t.contentAlign),s.restore()}}s.fillStyle=f?n.linkColor:n.textDark,Ln(e,c,t.contentAlign)},onSelect:e=>{$l(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;$l(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:r,validatedSelection:i}=t;return l.createElement(cf,{forceEditMode:o.readonly!==!0&&(r||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:i,readonly:o.readonly===!0,onChange:a=>n({...o,data:a.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},uf=[Vu,Ju,Du,zu,Wu,Nu,_u,Ku,nf,of,lf,sf,df],Hi=[];class ff extends ys{constructor(){super(...arguments);Pe(this,"imageLoaded",()=>{});Pe(this,"loadedLocations",[]);Pe(this,"cache",{});Pe(this,"sendLoaded",Fa(()=>{this.imageLoaded(new cr(this.loadedLocations)),this.loadedLocations=[]},20));Pe(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const r=this.cache[o];let i=!1;for(let a=0;a<r.cells.length;a++){const s=r.cells[a];if(this.isInWindow(s)){i=!0;break}}i?r.cells=r.cells.filter(this.isInWindow):(r.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,r,i){let a=!1;const s=Hi.pop()??new Image;let c=!1;const f={img:void 0,cells:[wn(o,r)],url:n,cancel:()=>{c||(c=!0,Hi.length<12?Hi.unshift(s):a||(s.src=""))}},u=new Promise(g=>s.addEventListener("load",()=>g(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const g=this.cache[i];if(g!==void 0&&!c){g.img=s;for(const w of g.cells)this.loadedLocations.push(Yi(w));a=!0,this.sendLoaded()}}catch{f.cancel()}}),this.cache[i]=f}loadOrGetImage(n,o,r){const i=n,a=this.cache[i];if(a!==void 0){const s=wn(o,r);return a.cells.includes(s)||a.cells.push(s),a.img}else this.loadImage(n,o,r,i)}}const hf=(e,t)=>{const n=l.useMemo(()=>({...id,...e.headerIcons}),[e.headerIcons]),o=l.useMemo(()=>e.renderers??uf,[e.renderers]),r=l.useMemo(()=>e.imageWindowLoader??new ff,[e.imageWindowLoader]);return l.createElement(Fu,{...e,renderers:o,headerIcons:n,ref:t,imageWindowLoader:r})},Os=l.forwardRef(hf);function Xr(e){return e===void 0?"":typeof e=="string"?e:e.length>0?e[e.length-1]:""}function gf(e){const[t,n]=at.useState([]),[o,r]=at.useState(void 0),{columns:i,onGroupHeaderClicked:a,onGridSelectionChange:s,getGroupDetails:c,gridSelection:f,freezeColumns:u=0,theme:g}=e,w=f??o,m=at.useMemo(()=>{const b=[];let k=[-1,-1],T;for(let A=u;A<i.length;A++){const E=i[A],D=Xr(E.group),_=t.includes(D);T!==D&&k[0]!==-1&&(b.push(k),k=[-1,-1]),_&&k[0]!==-1?k[1]+=1:_?k=[A,1]:k[0]!==-1&&(b.push(k),k=[-1,-1]),T=Xr(E.group)}return k[0]!==-1&&b.push(k),b},[t,i,u]),h=at.useMemo(()=>m.length===0?i:i.map((b,k)=>{for(const[T,A]of m)if(k>=T&&k<T+A){let E=8;return k===T+A-1&&(E=36),{...b,width:E,themeOverride:{bgCell:g.bgCellMedium}}}return b}),[i,m,g.bgCellMedium]),p=at.useCallback((b,k)=>{var A;a==null||a(b,k);const T=Xr((A=h[b])==null?void 0:A.group);T!==""&&(k.preventDefault(),n(E=>E.includes(T)?E.filter(D=>D!==T):[...E,T]))},[h,a]),x=at.useCallback(b=>{if(b.current!==void 0){const k=b.current.cell[0],T=h[k],A=Xr(T==null?void 0:T.group);n(E=>E.includes(A)?E.filter(D=>D!==A):E)}s!==void 0?s(b):r(b)},[h,s]),y=at.useCallback(b=>{const k=c==null?void 0:c(b),T=b??"";return{...k,name:T,overrideTheme:t.includes(T)?{bgHeader:g.bgHeaderHasFocus}:void 0}},[t,c,g.bgHeaderHasFocus]);return{columns:h,onGroupHeaderClicked:p,onGridSelectionChange:x,getGroupDetails:y,gridSelection:w}}var mf=Ha,pf=Da;function wf(e,t){var n=-1,o=pf(e)?Array(e.length):[];return mf(e,function(r,i,a){o[++n]=t(r,i,a)}),o}var bf=wf;function yf(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var vf=yf,Ol=Ta;function Cf(e,t){if(e!==t){var n=e!==void 0,o=e===null,r=e===e,i=Ol(e),a=t!==void 0,s=t===null,c=t===t,f=Ol(t);if(!s&&!f&&!i&&e>t||i&&a&&c&&!s&&!f||o&&a&&c||!n&&c||!r)return 1;if(!o&&!i&&!f&&e<t||f&&n&&r&&!o&&!i||s&&n&&r||!a&&r||!c)return-1}return 0}var xf=Cf,kf=xf;function Sf(e,t,n){for(var o=-1,r=e.criteria,i=t.criteria,a=r.length,s=n.length;++o<a;){var c=kf(r[o],i[o]);if(c){if(o>=s)return c;var f=n[o];return c*(f=="desc"?-1:1)}}return e.index-t.index}var Mf=Sf,Ti=Aa,Rf=Ba,Ef=La,If=bf,Ff=vf,Df=Pa,Hf=Mf,Tf=za,Af=os;function zf(e,t,n){t.length?t=Ti(t,function(i){return Af(i)?function(a){return Rf(a,i.length===1?i[0]:i)}:i}):t=[Tf];var o=-1;t=Ti(t,Df(Ef));var r=If(e,function(i,a,s){var c=Ti(t,function(f){return f(i)});return{criteria:c,index:++o,value:i}});return Ff(r,function(i,a){return Hf(i,a,n)})}var Bf=zf,Pf=Bf,Nl=os;function Lf(e,t,n,o){return e==null?[]:(Nl(t)||(t=t==null?[]:[t]),n=o?void 0:n,Nl(n)||(n=n==null?[]:[n]),Pf(e,t,n))}var Wf=Lf;const Xl=ka(Wf);function dr(e){return e.id??`${e.group??""}/${e.title}`}function Gl(e,t){return typeof t=="string"?dr(e)===t:dr(e)===dr(t)}function _l(e,t,n){const o=t.indexOf(e);if(o===-1)return Number.MAX_SAFE_INTEGER;const r=n.findIndex(i=>Gl(e,i));if(r!==-1)return r;for(let i=o;i>=0;i--){const a=n.findIndex(s=>Gl(t[i],s));if(a!==-1)return a+.5}return-1}function $f(e){const{columns:t,getCellContent:n,onColumnMoved:o}=e,[r,i]=l.useState(()=>t.map(dr)),a=l.useMemo(()=>Xl(t,u=>_l(u,t,r)),[r,t]),s=l.useRef(o);s.current=o;const c=l.useCallback((u,g)=>{var w;i(m=>{const h=[...m],[p]=h.splice(u,1);return h.splice(g,0,p),h}),(w=s.current)==null||w.call(s,u,g)},[]);l.useEffect(()=>{i(u=>Xl(t,g=>_l(g,t,u)).map(dr))},[t]);const f=l.useCallback(u=>{const[g,w]=u,m=a[g],h=t.indexOf(m);return n([h,w])},[a,t,n]);return{columns:a,onColumnMoved:c,getCellContent:f}}function Of(e){var t,n;switch(e.kind){case U.Number:return((t=e.data)==null?void 0:t.toString())??"";case U.Boolean:return((n=e.data)==null?void 0:n.toString())??"";case U.Markdown:case U.RowID:case U.Text:case U.Uri:return e.data??"";case U.Bubble:case U.Image:return e.data.join("");case U.Drilldown:return e.data.map(o=>o.text).join("");case U.Protected:case U.Loading:return"";case U.Custom:return e.copyData}}function Ul(e){if(typeof e=="number")return e;if(e.length>0){const t=Number(e);isNaN(t)||(e=t)}return e}function Nf(e,t){return e=Ul(e),t=Ul(t),typeof e=="string"&&typeof t=="string"?e.localeCompare(t):typeof e=="number"&&typeof t=="number"?e===t?0:e>t?1:-1:e==t?0:e>t?1:-1}function Xf(e,t){return e>t?1:e===t?0:-1}function Gf(e){const{sort:t,rows:n,getCellContent:o}=e,r=l.useMemo(()=>t===void 0?[]:Array.isArray(t)?t:[t],[t]),i=l.useMemo(()=>r.map(f=>{const u=e.columns.findIndex(g=>f.column===g||g.id!==void 0&&f.column.id===g.id);return u===-1?void 0:u}),[r,e.columns]),a=l.useMemo(()=>{const f=r.map((g,w)=>({sort:g,col:i[w]})).filter(g=>g.col!==void 0);if(f.length===0)return;const u=f.map(()=>new Array(n));for(let g=0;g<f.length;g++){const{col:w}=f[g],m=[w,0];for(let h=0;h<n;h++)m[1]=h,u[g][h]=Of(o(m))}return eo(n).sort((g,w)=>{for(let m=0;m<f.length;m++){const{sort:h}=f[m],p=u[m][g],x=u[m][w];let y;if(h.mode==="raw"?y=Xf(p,x):h.mode==="smart"?y=Nf(p,x):y=p.localeCompare(x),y!==0)return(h.direction??"asc")==="desc"&&(y=-y),y}return 0})},[o,n,r,i]),s=l.useCallback(f=>a===void 0?f:a[f],[a]),c=l.useCallback(([f,u])=>a===void 0?o([f,u]):(u=a[u],o([f,u])),[o,a]);return a===void 0?{getCellContent:e.getCellContent,getOriginalIndex:s}:{getOriginalIndex:s,getCellContent:c}}const _f={undoHistory:[],redoHistory:[],canUndo:!1,canRedo:!1,isApplyingUndo:!1,isApplyingRedo:!1};function Uf(e,t){const n={...e};switch(t.type){case"undo":if(e.canUndo){n.undoHistory=[...e.undoHistory];const o=n.undoHistory.pop();return n.operation=o,n.canUndo=n.undoHistory.length>0,n.isApplyingUndo=!0,n}return e;case"redo":if(e.canRedo){n.redoHistory=[...e.redoHistory];const o=n.redoHistory.pop();return n.operation=o,n.canRedo=n.redoHistory.length>0,n.isApplyingRedo=!0,n}return e;case"operationApplied":return n.operation=void 0,n.isApplyingRedo=!1,n.isApplyingUndo=!1,n;case"edit":return!e.isApplyingRedo&&!e.isApplyingUndo&&(n.undoHistory=[...e.undoHistory,t.batch],n.redoHistory=[],n.canUndo=!0,n.canRedo=!1),e.isApplyingUndo&&(n.redoHistory=[...e.redoHistory,t.batch],n.canRedo=!0),e.isApplyingRedo&&(n.undoHistory=[...e.undoHistory,t.batch],n.canUndo=!0),n;default:throw new Error("Invalid action")}}function Yf(e,t,n,o){const[r,i]=l.useReducer(Uf,_f),a=l.useRef(null),s=l.useRef(null),c=l.useRef(!1),f=l.useRef(!1);l.useEffect(()=>{c.current=r.isApplyingUndo,f.current=r.isApplyingRedo},[r.isApplyingUndo,r.isApplyingRedo]);const[u,g]=l.useState(null),w=l.useRef(null),m=l.useCallback(y=>{g(y),w.current=y},[o]),h=l.useCallback((y,b)=>{if(!(c.current||f.current)&&w.current){clearTimeout(s.current);const T=t(y);a.current===null&&(a.current={edits:[],selection:w.current}),a.current.edits.push({cell:y,newValue:T}),s.current=setTimeout(()=>{a.current&&(i({type:"edit",batch:a.current}),a.current=null)},0)}n(y,b)},[n,t]),p=l.useCallback(()=>{i({type:"undo"})},[i]),x=l.useCallback(()=>{i({type:"redo"})},[i]);return l.useEffect(()=>{if(r.operation&&w.current&&e.current){const y=[],b={edits:[],selection:w.current};for(const k of r.operation.edits){const T=t(k.cell);b.edits.push({cell:k.cell,newValue:T}),n(k.cell,k.newValue),y.push({cell:k.cell})}g(r.operation.selection),w.current=r.operation.selection,e.current.updateCells(y),i({type:"edit",batch:b}),i({type:"operationApplied"})}},[r.operation,e,n,g,t]),l.useEffect(()=>{const y=b=>{b.key==="z"&&(b.metaKey||b.ctrlKey)&&(b.shiftKey?x():p()),b.key==="y"&&(b.metaKey||b.ctrlKey)&&x()};return window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",y)}},[p,x]),l.useMemo(()=>({undo:p,redo:x,canUndo:r.canUndo,canRedo:r.canRedo,onCellEdited:h,onGridSelectionChange:m,gridSelection:u}),[p,x,h,r.canUndo,r.canRedo,m,u])}Sn.seed(1337);function Kf(e){return!!e}function Vf(e,t){var o;const n=e.data;if(typeof n==typeof t.data)return{...t,data:n};switch(t.kind){case U.Uri:return Br(n)?{...t,data:n[0]}:{...t,data:(n==null?void 0:n.toString())??""};case U.Boolean:return Br(n)?{...t,data:n[0]!==void 0}:e.kind===U.Boolean?{...t,data:e.data}:{...t,data:!!Kf(n)};case U.Image:return Br(n)?{...t,data:[n[0]]}:{...t,data:[(n==null?void 0:n.toString())??""]};case U.Number:return{...t,data:0};case U.Text:case U.Markdown:return Br(n)?{...t,data:n[0].toString()??""}:{...t,data:((o=e.data)==null?void 0:o.toString())??""};case U.Custom:return t}eh()}function qf(e){const{getContent:t,...n}=e;return n}function Yl(e,t){const n=[{title:"First name",id:"First name",group:t?"Name":void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const i=Sn.name.firstName();return{kind:U.Text,displayData:i,data:i,allowOverlay:!0,readonly:!0}}},{title:"Last name",id:"Last name",group:t?"Name":void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const i=Sn.name.lastName();return{kind:U.Text,displayData:i,data:i,allowOverlay:!0,readonly:!0}}},{title:"Avatar",id:"Avatar",group:t?"Info":void 0,icon:Pn.HeaderImage,hasMenu:!1,getContent:()=>{const i=Math.round(Math.random()*100);return{kind:U.Image,data:[`https://picsum.photos/id/${i}/900/900`],displayData:[`https://picsum.photos/id/${i}/40/40`],allowOverlay:!0,readonly:!0}}},{title:"Email",id:"Email",group:t?"Info":void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const i=Sn.internet.email();return{kind:U.Text,displayData:i,data:i,allowOverlay:!0,readonly:!0}}},{title:"Title",id:"Title",group:t?"Info":void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const i=Sn.name.jobTitle();return{kind:U.Text,displayData:i,data:i,allowOverlay:!0,readonly:!0}}},{title:"More Info",id:"More Info",group:t?"Info":void 0,icon:Pn.HeaderUri,hasMenu:!1,getContent:()=>{const i=Sn.internet.url();return{kind:U.Uri,displayData:i,data:i,allowOverlay:!0,readonly:!0}}}];if(e<n.length)return n.slice(0,e);const o=e-n.length,r=[...new Array(o)].map((i,a)=>jf(a+n.length,t));return[...n,...r]}function jf(e,t){return{title:`Column ${e}`,id:`Column ${e}`,group:t?`Group ${Math.round(e/3)}`:void 0,icon:Pn.HeaderString,hasMenu:!1,getContent:()=>{const n=Sn.lorem.word();return{kind:U.Text,data:n,displayData:n,allowOverlay:!0,readonly:!0}}}}class Zf{constructor(){Pe(this,"cachedContent",new Map)}get(t,n){const o=this.cachedContent.get(t);if(o!==void 0)return o[n]}set(t,n,o){let r=this.cachedContent.get(t);r===void 0&&this.cachedContent.set(t,r=[]),r[n]=o}}function Jf(e,t=!0,n=!1){const o=l.useRef(new Zf),[r,i]=l.useState(()=>Yl(e,n));l.useEffect(()=>{i(Yl(e,n))},[n,e]);const a=l.useCallback((m,h)=>{i(p=>{const x=p.findIndex(b=>b.title===m.title),y=[...p];return y.splice(x,1,{...p[x],width:h}),y})},[]),s=l.useMemo(()=>r.map(qf),[r]),c=l.useRef(r);c.current=r;const f=l.useCallback(([m,h])=>{let p=o.current.get(m,h);return p===void 0&&(p=c.current[m].getContent(),!t&&Va(p)&&(p={...p,readonly:t}),o.current.set(m,h,p)),p},[t]),u=l.useCallback(m=>{const h=[];for(let p=m.y;p<m.y+m.height;p++){const x=[];for(let y=m.x;y<m.x+m.width;y++)x.push(f([y,p]));h.push(x)}return h},[f]),g=l.useCallback(([m,h],p)=>{o.current.set(m,h,p)},[]),w=l.useCallback(([m,h],p)=>{let x=o.current.get(m,h);if(x===void 0&&(x=r[m].getContent()),to(p)&&to(x)){const y=Vf(p,x);o.current.set(m,h,{...y,displayData:typeof y.data=="string"?y.data:y.displayData,lastUpdated:performance.now()})}},[r]);return{cols:s,getCellContent:f,onColumnResize:a,setCellValue:w,getCellsForSelection:u,setCellValueRaw:g}}function Qf(e="This should not happen"){throw new Error(e)}function eh(e){return Qf("Hell froze over")}Sn.seed(1337);const th=Wt("div")({name:"SimpleWrapper",class:"ss4kmn3",propsAsIs:!1}),nh=e=>l.createElement(th,null,l.createElement("div",{className:"content"},e.children)),oh={title:"Extra Packages/Source",decorators:[e=>l.createElement(nh,null,l.createElement(e,null))]},rh=Wt("div")({name:"BeautifulStyle",class:"bkh67gx",propsAsIs:!1}),Ns=e=>{const{title:t,children:n,description:o}=e,{ref:r,width:i,height:a}=Ya();return l.createElement(rh,null,l.createElement("h1",null,t),o,l.createElement("div",{className:"sizer"},l.createElement("div",{className:"sizer-clip",ref:r},l.createElement("div",{style:{position:"relative",width:i??100,height:a??100}},n))))},Xs=Wt("p")({name:"Description",class:"d1deot3s",propsAsIs:!1}),mo=Wt("p")({name:"MoreInfo",class:"m1ml0sw1",propsAsIs:!1}),Gs={smoothScrollX:!0,smoothScrollY:!0,isDraggable:!1,rowMarkers:"none",width:"100%"},ih={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,headerIconSize:20,markerFontStyle:"13px",bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",horizontalBorderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#4F5DFF",cellHorizontalPadding:8,cellVerticalPadding:3,headerFontStyle:"600 13px",baseFontStyle:"13px",editorFontSize:"13px",lineHeight:1.4,fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif"},lh=[{title:"A",width:200,group:"Group 1"},{title:"B",width:200,group:"Group 1"},{title:"C",width:200,group:"Group 2"},{title:"D",width:200,group:"Group 2"},{title:"E",width:200,group:"Group 2"}],Go=()=>{const e=l.useRef({}),t=1e5,n=$f({columns:lh,getCellContent:l.useCallback(([c,f])=>{if(c===0)return{kind:U.Text,allowOverlay:!0,data:`${f}`,displayData:`${f}`};const u=`${c},${f}`;e.current[u]===void 0&&(e.current[u]=Sn.name.firstName()+" "+Sn.name.lastName());const g=e.current[u];return{kind:U.Text,allowOverlay:!0,data:g,displayData:g}},[])}),[o,r]=l.useState(),i=Gf({columns:n.columns,getCellContent:n.getCellContent,rows:t,sort:o===void 0?void 0:{column:n.columns[o],direction:"desc",mode:"smart"}}),a=gf({columns:n.columns,theme:ih,freezeColumns:0}),s=l.useCallback(c=>{r(c)},[]);return l.createElement(Ns,{title:"Custom source extensions",description:l.createElement(Xs,null,"Fixme.")},l.createElement(Os,{...Gs,...n,...i,...a,rows:t,onColumnMoved:n.onColumnMoved,onHeaderClicked:s}))};Go.parameters={options:{showPanel:!1}};const _o=()=>{const{cols:e,getCellContent:t,setCellValue:n}=Jf(6),o=l.useRef(null),{gridSelection:r,onCellEdited:i,onGridSelectionChange:a,undo:s,canRedo:c,canUndo:f,redo:u}=Yf(o,t,n);return l.createElement(Ns,{title:"Undo / Redo Support",description:l.createElement(Xs,null,"A simple undo/redo implementation",l.createElement(mo,null,"Use keyboard shortcuts CMD+Z and CMD+SHIFT+Z / CTRL+Z and CTRL+Y. Or click these buttons:",l.createElement("button",{onClick:s,disabled:!f,style:{opacity:f?1:.4}},"Undo"),l.createElement("button",{onClick:u,disabled:!c,style:{opacity:c?1:.4}},"Redo")),l.createElement(mo,null,"It works by taking a snapshot of the content of a cell before it is edited and replaying any edits back."))},l.createElement(Os,{...Gs,ref:o,onCellEdited:i,getCellContent:t,gridSelection:r??void 0,onGridSelectionChange:a,columns:e,rows:1e3}))};_o.parameters={options:{showPanel:!1}};var Kl,Vl,ql;mo.parameters={...mo.parameters,docs:{...(Kl=mo.parameters)==null?void 0:Kl.docs,source:{originalSource:`styled.p\`
    font-size: 14px;
    flex-shrink: 0;
    margin: 0 0 20px 0;

    button {
        background-color: #f4f4f4;
        color: #2b2b2b;
        padding: 2px 6px;
        font-family: monospace;
        font-size: 14px;
        border-radius: 4px;
        box-shadow: 0px 1px 2px #00000040;
        margin: 0 0.1em;
        border: none;
        cursor: pointer;
    }
\``,...(ql=(Vl=mo.parameters)==null?void 0:Vl.docs)==null?void 0:ql.source}}};var jl,Zl,Jl;Go.parameters={...Go.parameters,docs:{...(jl=Go.parameters)==null?void 0:jl.docs,source:{originalSource:`() => {
  const cache = React.useRef<Record<string, string>>({});
  const rows = 100_000;
  const moveArgs = useMoveableColumns({
    columns: cols,
    getCellContent: React.useCallback(([col, row]) => {
      if (col === 0) {
        return {
          kind: GridCellKind.Text,
          allowOverlay: true,
          data: \`\${row}\`,
          displayData: \`\${row}\`
        };
      }
      const key = \`\${col},\${row}\`;
      if (cache.current[key] === undefined) {
        cache.current[key] = faker.name.firstName() + " " + faker.name.lastName();
      }
      const d = cache.current[key];
      return {
        kind: GridCellKind.Text,
        allowOverlay: true,
        data: d,
        displayData: d
      };
    }, [])
  });
  const [sort, setSort] = React.useState<number>();
  const sortArgs = useColumnSort({
    columns: moveArgs.columns,
    getCellContent: moveArgs.getCellContent,
    rows,
    sort: sort === undefined ? undefined : {
      column: moveArgs.columns[sort],
      direction: "desc",
      mode: "smart"
    }
  });
  const collapseArgs = useCollapsingGroups({
    columns: moveArgs.columns,
    theme: testTheme,
    freezeColumns: 0
  });
  const onHeaderClick = React.useCallback((index: number) => {
    setSort(index);
  }, []);
  return <BeautifulWrapper title="Custom source extensions" description={<Description>Fixme.</Description>}>
            <DataEditor {...defaultProps} {...moveArgs} {...sortArgs} {...collapseArgs} rows={rows} onColumnMoved={moveArgs.onColumnMoved} onHeaderClicked={onHeaderClick} />
        </BeautifulWrapper>;
}`,...(Jl=(Zl=Go.parameters)==null?void 0:Zl.docs)==null?void 0:Jl.source}}};var Ql,es,ts;_o.parameters={..._o.parameters,docs:{...(Ql=_o.parameters)==null?void 0:Ql.docs,source:{originalSource:`() => {
  const {
    cols: columns,
    getCellContent,
    setCellValue
  } = useMockDataGenerator(6);
  const gridRef = React.useRef<DataEditorRef>(null);
  const {
    gridSelection,
    onCellEdited,
    onGridSelectionChange,
    undo,
    canRedo,
    canUndo,
    redo
  } = useUndoRedo(gridRef, getCellContent, setCellValue);
  return <BeautifulWrapper title="Undo / Redo Support" description={<Description>
                    A simple undo/redo implementation
                    <MoreInfo>
                        Use keyboard shortcuts CMD+Z and CMD+SHIFT+Z / CTRL+Z and CTRL+Y. Or click these buttons:
                        <button onClick={undo} disabled={!canUndo} style={{
        opacity: canUndo ? 1 : 0.4
      }}>
                            Undo
                        </button>
                        <button onClick={redo} disabled={!canRedo} style={{
        opacity: canRedo ? 1 : 0.4
      }}>
                            Redo
                        </button>
                    </MoreInfo>
                    <MoreInfo>
                        It works by taking a snapshot of the content of a cell before it is edited and replaying any
                        edits back.
                    </MoreInfo>
                </Description>}>
            <DataEditor {...defaultProps} ref={gridRef} onCellEdited={onCellEdited} getCellContent={getCellContent} gridSelection={gridSelection ?? undefined} onGridSelectionChange={onGridSelectionChange} columns={columns} rows={1000} />
        </BeautifulWrapper>;
}`,...(ts=(es=_o.parameters)==null?void 0:es.docs)==null?void 0:ts.source}}};const sh=["MoreInfo","UseDataSource","UndoRedo"],wh=Object.freeze(Object.defineProperty({__proto__:null,MoreInfo:mo,UndoRedo:_o,UseDataSource:Go,__namedExportsOrder:sh,default:oh},Symbol.toStringTag,{value:"Module"}));export{jd as C,Ic as T,No as a,qa as b,to as i,Ec as m,wh as u};
