const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-C_JOTlX8.js","./iframe-D0SbFLjG.js","./preload-helper-C1FmrZbK.js","./marked.esm-CyWSOd15.js","./react-number-format.es-DACSizUM.js","./throttle-t991Nh2L.js","./index-CONOvmL5.js","./number-overlay-editor-DjcVbkae.css"])))=>i.map(i=>d[i]);
var Ki=Object.defineProperty;var Ji=(e,t,n)=>t in e?Ki(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Z=(e,t,n)=>Ji(e,typeof t!="symbol"?t+"":t,n);import{r as m,R as un}from"./iframe-D0SbFLjG.js";import{h as Qi,g as Zi,k as er,v as tr,l as nr,m as Fn,r as or,j as ir,t as rr}from"./throttle-t991Nh2L.js";import{s as gt,a as sr}from"./marked.esm-CyWSOd15.js";import{r as lr}from"./index-CONOvmL5.js";import{_ as ar}from"./preload-helper-C1FmrZbK.js";function ni(e="This should not happen"){throw new Error(e)}function pt(e,t="Assertion failed"){if(!e)return ni(t)}function io(e,t){return ni(t??"Hell froze over")}function Dl(e,t){try{return e()}catch{return t}}const Ao=Object.prototype.hasOwnProperty;function jt(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&jt(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Ao.call(e,n)&&++o&&!Ao.call(t,n)||!(n in t)||!jt(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Hn=null,ro=void 0;var he=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(he||{}),cr=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp",e))(cr||{}),Kn=(e=>(e.Triangle="triangle",e.Dots="dots",e))(Kn||{});function Rl(e){return"width"in e&&typeof e.width=="number"}async function Tl(e){return typeof e=="object"?e:await e()}function En(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function Wl(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function so(e){return e.kind==="marker"||e.kind==="new-row"||e.kind==="row-status"}function dr(e){if(!En(e)||e.kind==="image")return!1;switch(e.kind){case"text":case"number":case"markdown":case"uri":case"custom":case"boolean":return e.readonly!==!0;default:io(e,"A cell was passed with an invalid kind")}}function ur(e){return Qi(e,"editor")}function lo(e){return!(e.readonly??!1)}var Mt=(e=>(e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id",e))(Mt||{});const Pn={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Yn(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Do;const Ge=class Ge{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new Ge(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Yn([...this.items,n]);return new Ge(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const c=[];s<o&&c.push([s,o]),i<a&&c.push([i,a]),n.splice(r,1,...c)}}return new Ge(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};Z(Ge,"create",t=>new Ge(Yn(t))),Z(Ge,"empty",()=>Do??(Do=new Ge([]))),Z(Ge,"fromSingleSelection",t=>Ge.empty().add(t)),Z(Ge,"fromArray",t=>{if(t.length===0)return Ge.empty();const n=t.map(i=>[i,i+1]),o=Yn(n);return new Ge(o)});let Jn=Ge;function ft(e,t,n,o,i=!1){const r=m.useRef();r.current=t,m.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var c;(c=r.current)==null||c.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function Ol(e,t){return e===void 0?void 0:t}const fr=Math.PI;function Ro(e){return e*fr/180}const oi=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),ii=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},ri=(e,t,n)=>Math.min(e,t-n*2),si=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,ao=e=>{const t=e.fgColor??"currentColor";return m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),m.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},hr=e=>{const t=e.fgColor??"currentColor";return m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function gr(e,t,n){const[o,i]=m.useState(e),r=m.useRef(!0);m.useEffect(()=>()=>{r.current=!1},[]);const l=m.useRef(Zi(s=>{r.current&&i(s)},n));return m.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const mr="֑-߿יִ-﷽ﹰ-ﻼ",br="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",vr=new RegExp("^[^"+br+"]*["+mr+"]");function co(e){return vr.test(e)?"rtl":"not-rtl"}let Sn;function To(){if(typeof document>"u")return 0;if(Sn!==void 0)return Sn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),Sn=n-o,Sn}const Wt=Symbol();function zl(e){const t=m.useRef([Wt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=m.useState(e),[,i]=m.useState(),r=m.useCallback(s=>{const a=t.current[0];a!==Wt&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Wt&&i({}),o(c=>typeof s=="function"?s(a===Wt?c:a):s),t.current[0]=Wt)},[]),l=m.useCallback(()=>{t.current[0]=Wt,i({})},[]);return[t.current[0]===Wt?n:t.current[0],r,l]}function li(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function Ll(e){const t=m.useRef(e);return jt(e,t.current)||(t.current=e),t.current}function yr(e,t){return un.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function Nl(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(Mn(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function Lt(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Qn(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function pr(e,t){const n=Lt(e),o=Lt(t);return n===o}function Zn(e,t,n,o){for(let i=0;i<=n;i++){const r=Qn(e,i,o)??"",l=Qn(t,i,o)??"";if(r!==l)return!1}return!0}function wr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function kr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function Mn(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function ai(e){return[e.x+e.width-1,e.y+e.height-1]}function Wo(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[c,u]=t.span;return c>=o&&c<=i||u>=o&&c<=i||c<o&&u>i}function xr(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&Wo(e,t,r)&&i++;for(const l of n.current.rangeStack)Wo(e,t,l)&&i++;return i}function ci(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function Kt(e,t){let n=0;const o=ci(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Jt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function eo(e,t,n,o,i){const r=ci(e,o),l=[];for(const c of r)if(c.sticky)l.push(c);else break;if(l.length>0)for(const c of l)n-=c.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let c=t;c<s;c++){const u=r[c];u.sticky||l.push(u)}return l}function Sr(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function Cr(e,t,n,o,i,r,l,s,a,c,u,b){const g=u??(n?1:0),f=b??(n?[i]:[]),d=f.reduce((k,I)=>k+I,0),h=o+d;if(n&&g>0){let k=0;for(let I=0;I<g;I++)if(k+=f[I]??0,e<=k)return-(I+2)}if(e<=h)return-1;let v=t;for(let k=0;k<c;k++){const I=r-1-k,H=typeof l=="number"?l:l(I);if(v-=H,e>=v)return I}const y=r-c,p=e-(a??0);if(typeof l=="number"){const k=Math.floor((p-h)/l)+s;return k>=y?void 0:k}else{let k=h;for(let I=s;I<y;I++){const H=l(I);if(p<=k+H)return I;k+=H}return}}let In=0,dn={};const Er=typeof window>"u";async function Mr(){var e;Er||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,In=0,dn={},tr())}Mr();function di(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Xt(e,t,n,o="middle"){const i=di(e,t,o,n);let r=dn[i];return r===void 0&&(r=t.measureText(e),dn[i]=r,In++),In>1e4&&(dn={},In=0),r}function ui(e,t){const n=di(e,void 0,"middle",t);return dn[n]}function nt(e,t){return typeof t!="string"&&(t=t.baseFontFull),Ir(e,t)}function Oo(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const zo=[];function Ir(e,t){for(const r of zo)if(r.key===t)return r.val;const n=Oo(e,"alphabetic"),i=-(Oo(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return zo.push({key:t,val:i}),i}function Fr(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let c=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(c=n-t,c<u)){const b=1-c/u;l.globalAlpha=b,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return c<u}function An(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function fi(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function hi(e,t){const n=Xt("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Hr(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Pr(e,t,n,o,i,r,l,s,a,c){const u=s.baseFontFull,b=er(e,t,u,i-s.cellHorizontalPadding*2,c??!1),g=hi(e,u),f=s.lineHeight*g,d=g+f*(b.length-1),h=d+s.cellVerticalPadding>r;h&&(e.save(),e.rect(n,o,i,r),e.clip());const v=o+r/2-d/2;let y=Math.max(o+s.cellVerticalPadding,v);for(const p of b)if(fi(e,p,n,y,i,g,l,s,a),y+=f,y>o+r)break;h&&e.restore()}function Et(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:c,width:u,height:b}=l;o=o??!1,o||(t=Hr(t,u));const g=nt(r,s),f=co(t)==="rtl";if(n===void 0&&f&&(n="right"),f&&(r.direction="rtl"),t.length>0){let d=!1;n==="right"?(r.textAlign="right",d=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,d=!0),o?Pr(r,t,a,c,u,b,g,s,n,i):fi(r,t,a,c,u,b,g,s,n),d&&(r.textAlign="start"),f&&(r.direction="inherit")}}function ht(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function Br(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Ar(e,t,n){const o=function(s,a){const c=a.x-s.x,u=a.y-s.y,b=Math.sqrt(c*c+u*u),g=c/b,f=u/b;return{x:c,y:a.y-s.y,len:b,nx:g,ny:f,ang:Math.atan2(f,g)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const c=t[(s+1)%r],u=o(a,l),b=o(a,c),g=u.nx*b.ny-u.ny*b.nx,f=u.nx*b.nx-u.ny*-b.ny;let d=Math.asin(g<-1?-1:g>1?1:g),h=1,v=!1;f<0?d<0?d=Math.PI+d:(d=Math.PI-d,h=-1,v=!0):d>0&&(h=-1,v=!0),i=a.radius!==void 0?a.radius:n;const y=d/2;let p=Math.abs(Math.cos(y)*i/Math.sin(y)),k;p>Math.min(u.len/2,b.len/2)?(p=Math.min(u.len/2,b.len/2),k=Math.abs(p*Math.sin(y)/Math.cos(y))):k=i;let I=a.x+b.nx*p,H=a.y+b.ny*p;I+=-b.ny*k*h,H+=b.nx*k*h,e.arc(I,H,k,u.ang+Math.PI/2*h,b.ang-Math.PI/2*h,v),l=a,a=c}e.closePath()}function to(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v){const y={x:0,y:r+c,width:0,height:0},p=h??(i>0?1:0),k=-(p+1);if(e>=f.length||t>=u||t<k||e<0)return y;const I=v??(i>0?[i]:[]),H=I.reduce((D,F)=>D+F,0),A=r-H;if(e>=b){const D=l>e?-1:1,F=Kt(f);y.x+=F+a;for(let x=l;x!==e;x+=D)y.x+=f[D===1?x:x-1].width*D}else for(let D=0;D<e;D++)y.x+=f[D].width;if(y.width=f[e].width+1,t===-1)y.y=H,y.height=A;else if(t<=-2){const D=-(t+2);let F=0;for(let M=0;M<D;M++)F+=I[M]??0;y.y=F,y.height=I[D]??i;let x=e;const R=f[e].group,C=f[e].sticky;for(;x>0&&Zn(f[x-1].group,R,D,p)&&f[x-1].sticky===C;){const M=f[x-1];y.x-=M.width,y.width+=M.width,x--}let S=e;for(;S+1<f.length&&Zn(f[S+1].group,R,D,p)&&f[S+1].sticky===C;){const M=f[S+1];y.width+=M.width,S++}if(!C){const M=Kt(f),E=y.x-M;E<0&&(y.x-=E,y.width+=E),y.x+y.width>n&&(y.width=n-y.x)}}else if(t>=u-g){let D=u-t;for(y.y=o;D>0;){const F=t+D-1;y.height=typeof d=="number"?d:d(F),y.y-=y.height,D--}y.height+=1}else{const D=s>t?-1:1;if(typeof d=="number"){const F=t-s;y.y+=F*d}else for(let F=s;F!==t;F+=D)y.y+=d(F)*D;y.height=(typeof d=="number"?d:d(t))+1}return y}const uo=1<<21;function at(e,t){return(t+2)*uo+e}function gi(e){return e%uo}function fo(e){return Math.floor(e/uo)-2}function ho(e){const t=gi(e),n=fo(e);return[t,n]}class mi{constructor(){Z(this,"visibleWindow",{x:0,y:0,width:0,height:0});Z(this,"freezeCols",0);Z(this,"freezeRows",[]);Z(this,"isInWindow",t=>{const n=gi(t),o=fo(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&jt(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Dr extends mi{constructor(){super(...arguments);Z(this,"cache",new Map);Z(this,"setValue",(n,o)=>{this.cache.set(at(n[0],n[1]),o)});Z(this,"getValue",n=>this.cache.get(at(n[0],n[1])));Z(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Gt{constructor(t=[]){Z(this,"cells");this.cells=new Set(t.map(n=>at(n[0],n[1])))}add(t){this.cells.add(at(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(at(t[0],t[1]))}remove(t){this.cells.delete(at(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(fo(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(at(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield ho(t)}}function Rr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Tr{constructor(t,n){Z(this,"spriteMap",new Map);Z(this,"headerIcons");Z(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[c,u]=Rr(n,s),b=l*Math.ceil(window.devicePixelRatio),g=`${c}_${u}_${b}_${t}`;let f=this.spriteMap.get(g);if(f===void 0){const d=this.headerIcons[t];if(d===void 0)return;f=document.createElement("canvas");const h=f.getContext("2d");if(h===null)return;const v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(d({fgColor:u,bgColor:c}))}`,this.spriteMap.set(g,f);const y=v.decode();if(y===void 0)return;this.inFlight++,y.then(()=>{h.drawImage(v,0,0,b,b)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(f,0,0,b,b,i,r,l,l),a<1&&(o.globalAlpha=1)}}const $n={};let Ct=null;function Wr(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function no(e){const t=e.toLowerCase().trim();if($n[t]!==void 0)return $n[t];Ct=Ct||Wr(),Ct.style.color="#000",Ct.style.color=t;const n=getComputedStyle(Ct).color;Ct.style.color="#fff",Ct.style.color=t;const o=getComputedStyle(Ct).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),$n[t]=i,i}function Qt(e,t){const[n,o,i]=no(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const Lo=new Map;function No(e,t){const n=`${e}-${t}`,o=Lo.get(n);if(o!==void 0)return o;const i=tt(e,t);return Lo.set(n,i),i}function tt(e,t){if(t===void 0)return e;const[n,o,i,r]=no(e);if(r===1)return e;const[l,s,a,c]=no(t),u=r+c*(1-r),b=(r*n+c*l*(1-r))/u,g=(r*o+c*s*(1-r))/u,f=(r*i+c*a*(1-r))/u;return`rgba(${b}, ${g}, ${f}, ${u})`}function bi(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function Dn(e,t,n,o,i,r,l,s,a){s=s??t;let c=t,u=e;const b=o-r;let g=!1;for(;c<n&&u<b;){const f=i(u);if(c+f>s&&a(c,u,f,!1,l&&u===o-1)===!0){g=!0;break}c+=f,u++}if(!g){c=n;for(let f=0;f<r;f++){u=o-1-f;const d=i(u);c-=d,a(c,u,d,!0,l&&u===o-1)}}}function It(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const c of e){const u=c.sticky?s:l+n;if(r(c,u,a,c.sticky?0:s,t)===!0)break;l+=c.width,s+=c.sticky?c.width:0}}function Or(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let c=s+1,u=a.width;for(a.sticky&&(l+=u);c<e.length&&pr(e[c].group,a.group)&&e[c].sticky===e[s].sticky;){const h=e[c];u+=h.width,c++,s++,h.sticky&&(l+=h.width)}const b=a.sticky?0:n,g=r+b,f=a.sticky?0:Math.max(0,l-g),d=Math.min(u-f,t-(g+f));i([a.sourceIndex,e[c-1].sourceIndex],Lt(a.group),g+f,0,d,o),r+=u}}function zr(e,t,n,o,i,r){if(i===0)return;const l=[];let s=0;for(let u=0;u<i;u++)l.push(s),s+=o[u]??0;const a=[];let c=0;for(const u of e)a.push(c),c+=u.width;for(let u=0;u<i;u++){const b=l[u],g=o[u]??0;let f=0,d=0;for(;d<e.length;){const h=e[d],v=Qn(h.group,u,i);if(v===void 0){h.sticky&&(f+=h.width),d++;continue}const y=a[d];let p=d+1,k=h.width;for(h.sticky&&(f+=h.width);p<e.length;){const F=e[p],x=Zn(F.group,h.group,u,i),R=F.sticky===h.sticky;if(!x||!R)break;k+=F.width,F.sticky&&(f+=F.width),p++}const I=h.sticky?0:n,H=y+I,A=h.sticky?0:Math.max(0,f-H),D=Math.min(k-A,t-(H+A));D>0&&r([h.sourceIndex,e[p-1].sourceIndex],v,H+A,b,D,g,u),d=p}}}function vi(e,t,n,o,i,r,l){var g;const[s,a]=e;let c,u;const b=((g=l.find(f=>!f.sticky))==null?void 0:g.sourceIndex)??0;if(a>b){const f=Math.max(s,b);let d=t,h=o;for(let v=r.sourceIndex-1;v>=f;v--)d-=l[v].width,h+=l[v].width;for(let v=r.sourceIndex+1;v<=a;v++)h+=l[v].width;u={x:d,y:n,width:h,height:i}}if(b>s){const f=Math.min(a,b-1);let d=t,h=o;for(let v=r.sourceIndex-1;v>=s;v--)d-=l[v].width,h+=l[v].width;for(let v=r.sourceIndex+1;v<=f;v++)h+=l[v].width;c={x:d,y:n,width:h,height:i}}return[c,u]}function Lr(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const yi={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function Xl(){return yi}const pi=un.createContext(yi);function Yl(){return un.useContext(pi)}function Nt(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=tt(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function $l(e,t,n,o){if(o==="any")return Nr(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),kr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function fn(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function zt(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Nr(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Xr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Yr(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,c=e.x+e.width-l,u=r-e.y,b=e.y+e.height-s,g=a>0?e.x+Math.floor(a/o)*o:e.x,f=c>0?e.x+e.width-Math.floor(c/o)*o:e.x+e.width,d=u>0?e.y+Math.floor(u/o)*o:e.y,h=b>0?e.y+e.height-Math.floor(b/o)*o:e.y+e.height;return{x:g,y:d,width:f-g,height:h-d}}function $r(e,t,n,o,i){const[r,l,s,a]=t,[c,u,b,g]=i,{x:f,y:d,width:h,height:v}=e,y=[];if(h<=0||v<=0)return y;const p=f+h,k=d+v,I=f<r,H=d<l,A=f+h>s,D=d+v>a,F=f>=r&&f<s||p>r&&p<=s||f<r&&p>s,x=d>=l&&d<a||k>l&&k<=a||d<l&&k>a;if(F&&x){const C=Math.max(f,r),S=Math.max(d,l),M=Math.min(p,s),E=Math.min(k,a);y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:c,y:u,width:b-c+1,height:g-u+1}})}if(I&&H){const C=f,S=d,M=Math.min(p,r),E=Math.min(k,l);y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:0,y:0,width:c+1,height:u+1}})}if(H&&F){const C=Math.max(f,r),S=d,M=Math.min(p,s),E=Math.min(k,l);y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:c,y:0,width:b-c+1,height:u+1}})}if(H&&A){const C=Math.max(f,s),S=d,M=p,E=Math.min(k,l);y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:b,y:0,width:n-b+1,height:u+1}})}if(I&&x){const C=f,S=Math.max(d,l),M=Math.min(p,r),E=Math.min(k,a);y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:0,y:u,width:c+1,height:g-u+1}})}if(A&&x){const C=Math.max(f,s),S=Math.max(d,l),M=p,E=Math.min(k,a);y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:b,y:u,width:n-b+1,height:g-u+1}})}if(I&&D){const C=f,S=Math.max(d,a),M=Math.min(p,r),E=k;y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:0,y:g,width:c+1,height:o-g+1}})}if(D&&F){const C=Math.max(f,r),S=Math.max(d,a),M=Math.min(p,s),E=k;y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:c,y:g,width:b-c+1,height:o-g+1}})}if(A&&D){const C=Math.max(f,s),S=Math.max(d,a),M=p,E=k;y.push({rect:{x:C,y:S,width:M-C,height:E-S},clip:{x:b,y:g,width:n-b+1,height:o-g+1}})}return y}const _r={kind:he.Loading,allowOverlay:!1};function Xo(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v,y,p,k,I,H,A,D,F,x,R,C,S,M,E,W,O,ee,J){let G=(k==null?void 0:k.size)??Number.MAX_SAFE_INTEGER;const Q=performance.now();let ge=M.baseFontFull;e.font=ge;const ie={ctx:e},se=[0,0],Se=v>0?Jt(a,v,c):0;let _,me;const ve=new Gt,z=new Set,ce=bi(p);if(It(t,s,r,l,i,(j,de,Be,q,le)=>{const $e=Math.max(0,q-de),qe=de+$e,be=i+1,wt=j.width-$e,mt=o-i-1;if(p.length>0){let re=!1;for(let ye=0;ye<p.length;ye++){const ke=p[ye];if(fn(qe,be,wt,mt,ke.x,ke.y,ke.width,ke.height)){re=!0;break}}if(!re)return}const je=()=>{e.save(),e.beginPath(),e.rect(qe,be,wt,mt),e.clip()},ue=I.columns.hasIndex(j.sourceIndex),Ke=b(Lt(j.group)).overrideTheme,Oe=j.themeOverride===void 0&&Ke===void 0?M:Nt(M,Ke,j.themeOverride),Ve=Oe.baseFontFull;Ve!==ge&&(ge=Ve,e.font=Ve),je();let Ie;return Dn(le,Be,o,a,c,v,y,ce,(re,ye,ke,ot,B)=>{var st,bt,Bt;if(ye<0)return;if(se[0]=j.sourceIndex,se[1]=ye,ve.has(se)){G--;return}if(k!==void 0&&!k.has(se))return;if(p.length>0){let U=!1;for(let Pe=0;Pe<p.length;Pe++){const ae=p[Pe];if(fn(de,re,j.width,ke,ae.x,ae.y,ae.width,ae.height)){U=!0;break}}if(!U)return}const Ae=I.rows.hasIndex(ye),Ce=f.hasIndex(ye),N=ye<a?u(se):_r;let De=de,Fe=j.width,oe=re,ne=ke,ze=!1,it=!1;if(N.rowspan!==void 0){const[U,Pe]=N.rowspan,ae=`${j.sourceIndex}|${U}`;if(z.has(ae)){G--;return}else{let Ue=re;for(let Re=U;Re<ye;Re++)Ue-=c(Re);let et=0;for(let Re=U;Re<Pe;Re++)et+=c(Re);if(Ue<be+mt&&Ue+et>be){oe=Ue,ne=et,z.add(ae);for(let Re=U;Re<Pe;Re++)Re!==ye&&ve.add([j.sourceIndex,Re]);ze=!0}else{z.add(ae);for(let Re=U;Re<Pe;Re++)ve.add([j.sourceIndex,Re]);G--;return}}}if(N.span!==void 0){const[U,Pe]=N.span,ae=`${ye},${U},${Pe},${j.sticky}`;if(me===void 0&&(me=new Set),me.has(ae)){G--;return}else{const Ue=vi(N.span,de,re,j.width,ke,j,n),et=j.sticky?Ue[0]:Ue[1];!j.sticky&&Ue[0]!==void 0&&(it=!0),et!==void 0&&(De=et.x,Fe=et.width,me.add(ae),ze=!0)}}if(ze){e.restore(),Ie=void 0,e.save(),e.beginPath();const U=Math.max(0,q-De);e.rect(De+U,oe,Fe-U,ne),_===void 0&&(_=[]),_.push({x:De+U,y:oe,width:Fe-U,height:ne}),e.clip()}const Je=g==null?void 0:g(ye),ct=B&&((st=j.trailingRowOptions)==null?void 0:st.themeOverride)!==void 0?(bt=j.trailingRowOptions)==null?void 0:bt.themeOverride:void 0,_e=N.themeOverride===void 0&&Je===void 0&&ct===void 0?Oe:Nt(Oe,Je,ct,N.themeOverride);e.beginPath();const dt=wr(se,N,I);let Qe=xr(se,N,I,h);const Ft=N.span!==void 0&&I.columns.some(U=>N.span!==void 0&&U>=N.span[0]&&U<=N.span[1]);dt&&!d&&h?Qe=0:dt&&h&&(Qe=Math.max(Qe,1)),Ft&&Qe++,dt||(Ae&&Qe++,ue&&!B&&Qe++);const Ht=N.kind===he.Protected?_e.bgCellMedium:_e.bgCell;let He;if((ot||Ht!==M.bgCell)&&(He=tt(Ht,He)),Qe>0||Ce){Ce&&(He=tt(_e.bgHeader,He));for(let U=0;U<Qe;U++)He=tt(_e.accentLight,He)}else if(H!==void 0){for(const U of H)if(U[0]===j.sourceIndex&&U[1]===ye){He=tt(_e.bgSearchResult,He);break}}if(A!==void 0)for(let U=0;U<A.length;U++){const Pe=A[U],ae=Pe.range;Pe.style!=="solid-outline"&&ae.x<=j.sourceIndex&&j.sourceIndex<ae.x+ae.width&&ae.y<=ye&&ye<ae.y+ae.height&&(He=tt(Pe.color,He))}let Pt=!1;if(k!==void 0){const U=re+1,ae=(ot?U+ke-1:Math.min(U+ke-1,o-Se))-U;(ae!==ke-1||De+1<=q)&&(Pt=!0,e.save(),e.beginPath(),e.rect(De+1,U,Fe-1,ae),e.clip()),He=He===void 0?_e.bgCell:tt(He,_e.bgCell)}const pe=j.sourceIndex===n.length-1,Ze=ye===a-1;He!==void 0&&(e.fillStyle=He,Ie!==void 0&&(Ie.fillStyle=He),k!==void 0?e.fillRect(De+1,oe+1,Fe-(pe?2:1),ne-(Ze?2:1)):e.fillRect(De,oe,Fe,ne)),N.style==="faded"&&(e.globalAlpha=.6);let rt;for(let U=0;U<x.length;U++){const Pe=x[U];if(Pe.item[0]===j.sourceIndex&&Pe.item[1]===ye){rt=Pe;break}}if(Fe>J&&!it){const U=_e.baseFontFull;U!==ge&&(e.font=U,ge=U);let Pe=0;if(N.rowspan!==void 0){const ae=N.rowSpanPosition??"top";if(ae==="top")Pe=ke/2-ne/2;else if(ae==="bottom"){const[Ue,et]=N.rowspan,Re=c(et-1);Pe=ne/2-Re/2}}Ie=wi(e,N,j.sourceIndex,ye,pe,Ze,De,oe,Fe,ne,Qe>0,_e,He??_e.bgCell,D,F,(rt==null?void 0:rt.hoverAmount)??0,R,S,Q,C,Ie,E,W,O,ee,Pe)}return Pt&&e.restore(),N.style==="faded"&&(e.globalAlpha=1),G--,ze&&(e.restore(),(Bt=Ie==null?void 0:Ie.deprep)==null||Bt.call(Ie,ie),Ie=void 0,je(),ge=Ve,e.font=Ve),G<=0}),e.restore(),G<=0}),_!==void 0)return _}const rn=[0,0],sn={x:0,y:0,width:0,height:0},_n=[void 0,()=>{}];let oo=!1;function Vr(){oo=!0}function wi(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v,y,p,k,I,H,A,D,F,x){var O,ee;let R,C;v!==void 0&&v[0][0]===n&&v[0][1]===o&&(R=v[1][0],C=v[1][1]);let S;rn[0]=n,rn[1]=o,sn.x=l,sn.y=s,sn.width=a,sn.height=c,_n[0]=A.getValue(rn),_n[1]=J=>A.setValue(rn,J),oo=!1;const M={ctx:e,theme:b,col:n,row:o,cell:t,rect:sn,highlighted:u,cellFillColor:g,hoverAmount:h,frameTime:p,hoverX:R,drawState:_n,hoverY:C,imageLoader:f,spriteManager:d,hyperWrapping:y,overrideCursor:R!==void 0?F:void 0,requestAnimationFrame:Vr},E=Fr(M,t.lastUpdated,p,I,i,r),W=D(t);if(W!==void 0){(I==null?void 0:I.renderer)!==W&&((O=I==null?void 0:I.deprep)==null||O.call(I,M),I=void 0);const J=(ee=W.drawPrep)==null?void 0:ee.call(W,M,I);e.save(),e.translate(0,x),k!==void 0&&!so(M.cell)?k(M,()=>W.draw(M,t)):W.draw(M,t),e.restore(),S=J===void 0?void 0:{deprep:J==null?void 0:J.deprep,fillStyle:J==null?void 0:J.fillStyle,font:J==null?void 0:J.font,renderer:W}}return(E||oo)&&(H==null||H(rn)),S}function Bn(e,t,n,o,i,r,l,s,a=-20,c=-20,u=void 0,b="center",g="square",f=!1){const d=Math.floor(i+l/2),h=g==="circle"?1e4:t.roundingRadius??4;let v=ri(u??t.checkboxMaxSize,l,t.cellVerticalPadding),y=v/2;const p=ii(b,o,r,t.cellHorizontalPadding,v),k=oi(p,d,v),I=si(o+a,i+c,k);switch(n){case!0:{e.beginPath(),ht(e,p-v/2,d-v/2,v,v,h),g==="circle"&&(y*=.8,v*=.8),e.fillStyle=f?t.bgCellMedium:s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(p-y+v/4.23,d-y+v/1.97),e.lineTo(p-y+v/2.42,d-y+v/1.44),e.lineTo(p-y+v/1.29,d-y+v/3.25),e.strokeStyle=f?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Hn:case!1:{e.beginPath(),ht(e,p-v/2+.5,d-v/2+.5,v-1,v-1,h),e.lineWidth=1,e.strokeStyle=f?t.textLight:I?t.textDark:t.textMedium,e.stroke();break}case ro:{e.beginPath(),ht(e,p-v/2,d-v/2,v,v,h),e.fillStyle=f?t.bgCellMedium:I?t.textMedium:t.textLight,e.fill(),g==="circle"&&(y*=.8,v*=.8),e.beginPath(),e.moveTo(p-v/3,d),e.lineTo(p+v/3,d),e.strokeStyle=f?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:io()}}function qr(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v,y,p,k,I,H){var W,O,ee,J;const A=I??(o?1:0),D=H??(o?[a]:[]),F=D.reduce((G,Q)=>G+Q,0),x=s+F;if(x<=0)return;e.fillStyle=g.bgHeader,y!==void 0&&o&&(I??1)>1?e.fillRect(0,F,r,s):e.fillRect(0,0,r,x);const R=(W=i==null?void 0:i[0])==null?void 0:W[0],C=(O=i==null?void 0:i[0])==null?void 0:O[1],S=(ee=i==null?void 0:i[1])==null?void 0:ee[0],M=(J=i==null?void 0:i[1])==null?void 0:J[1],E=g.headerFontFull;e.font=E,It(t,0,l,0,x,(G,Q,ge,ie)=>{var le;if(y!==void 0&&!y.has([G.sourceIndex,-1]))return;const se=Math.max(0,ie-Q);e.save(),e.beginPath(),e.rect(Q+se,F,G.width-se,s),e.clip();const Se=v(Lt(G.group)).overrideTheme,_=G.themeOverride===void 0&&Se===void 0?g:Nt(g,Se,G.themeOverride);_.bgHeader!==g.bgHeader&&(e.fillStyle=_.bgHeader,e.fill()),_!==g&&(e.font=_.headerFontFull);const me=b.columns.hasIndex(G.sourceIndex),ve=c!==void 0||u||G.headerRowMarkerDisabled===!0,z=!ve&&C===-1&&R===G.sourceIndex,ce=ve?0:((le=d.find($e=>$e.item[0]===G.sourceIndex&&$e.item[1]===-1))==null?void 0:le.hoverAmount)??0,j=(b==null?void 0:b.current)!==void 0&&b.current.cell[0]===G.sourceIndex,de=me?_.accentColor:j?_.bgHeaderHasFocus:_.bgHeader,Be=o?F:0,q=G.sourceIndex===0?0:1;me?(e.fillStyle=de,e.fillRect(Q+q,Be,G.width-q,s)):(j||ce>0)&&(e.beginPath(),e.rect(Q+q,Be,G.width-q,s),j&&(e.fillStyle=_.bgHeaderHasFocus,e.fill()),ce>0&&(e.globalAlpha=ce,e.fillStyle=_.bgHeaderHovered,e.fill(),e.globalAlpha=1)),xi(e,Q,Be,G.width,s,G,me,_,z,z?S:void 0,z?M:void 0,j,ce,f,p,k),e.restore()}),o&&(A>1?Gr(e,t,r,l,D,A,i,g,f,d,h,v,y):Ur(e,t,r,l,a,i,g,f,d,h,v,y)),o&&(I??1)>1&&(e.beginPath(),e.moveTo(0,F+.5),e.lineTo(r,F+.5),e.strokeStyle=g.borderColor,e.lineWidth=1,e.stroke())}function Ur(e,t,n,o,i,r,l,s,a,c,u,b){const[g,f]=(r==null?void 0:r[0])??[];let d=0;Or(t,n,o,i,(h,v,y,p,k,I)=>{if(b!==void 0&&!b.hasItemInRectangle({x:h[0],y:-2,width:h[1]-h[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,p,k,I),e.clip();const H=u(v),A=(H==null?void 0:H.overrideTheme)===void 0?l:Nt(l,H.overrideTheme),D=f===-2&&g!==void 0&&g>=h[0]&&g<=h[1],F=D?A.bgGroupHeaderHovered??A.bgHeaderHovered:A.bgGroupHeader??A.bgHeader;if(F!==l.bgHeader&&(e.fillStyle=F,e.fill()),e.fillStyle=A.textGroupHeader??A.textHeader,H!==void 0){const x=H.name,C=e.measureText(x).width,S=H.icon!==void 0?26:0,M=S+C,E=y+(k-M)/2;if(H.icon!==void 0&&s.drawSprite(H.icon,"normal",e,E,(i-20)/2,20,A),e.fillText(x,E+S,i/2+nt(e,l.headerFontFull)),H.actions!==void 0&&D){const W=go({x:y,y:p,width:k,height:I},H.actions);e.beginPath();const O=W[0].x-10,ee=y+k-O;e.rect(O,0,ee,i);const J=e.createLinearGradient(O,0,O+ee,0),G=Qt(F,0);J.addColorStop(0,G),J.addColorStop(10/ee,F),J.addColorStop(1,F),e.fillStyle=J,e.fill(),e.globalAlpha=.6;const[Q,ge]=(r==null?void 0:r[1])??[-1,-1];for(let ie=0;ie<H.actions.length;ie++){const se=H.actions[ie],Se=W[ie],_=zt(Se,Q+y,ge);_&&(e.globalAlpha=1),s.drawSprite(se.icon,"normal",e,Se.x+Se.width/2-10,Se.y+Se.height/2-10,20,A),_&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&c(h[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),d=y+k}),e.beginPath(),e.moveTo(d+.5,0),e.lineTo(d+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}function Gr(e,t,n,o,i,r,l,s,a,c,u,b,g){const[f,d]=(l==null?void 0:l[0])??[];e.font=s.headerFontFull;const h=i.reduce((y,p)=>y+p,0);g===void 0&&(e.fillStyle=s.bgHeader,e.fillRect(0,0,n,h));let v=0;if(zr(t,n,o,i,r,(y,p,k,I,H,A,D)=>{const F=-(D+2);if(g!==void 0&&!g.hasItemInRectangle({x:y[0],y:F,width:y[1]-y[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(k,I,H,A),e.clip();const x=b(p),R=(x==null?void 0:x.overrideTheme)===void 0?s:Nt(s,x.overrideTheme),C=d===F&&f!==void 0&&f>=y[0]&&f<=y[1],S=C?R.bgGroupHeaderHovered??R.bgHeaderHovered:R.bgGroupHeader??R.bgHeader;e.fillStyle=S,e.fillRect(k,I,H,A),e.fillStyle=R.textGroupHeader??R.textHeader;const M=(x==null?void 0:x.name)??p,W=e.measureText(M).width,O=(x==null?void 0:x.icon)!==void 0?26:0,ee=O+W,J=k+(H-ee)/2;if((x==null?void 0:x.icon)!==void 0&&a.drawSprite(x.icon,"normal",e,J,I+(A-20)/2,20,R),e.fillText(M,J+O,I+A/2+nt(e,s.headerFontFull)),x!==void 0&&x.actions!==void 0&&C){const G=go({x:k,y:I,width:H,height:A},x.actions);e.beginPath();const Q=G[0].x-10,ge=k+H-Q;e.rect(Q,I,ge,A);const ie=e.createLinearGradient(Q,0,Q+ge,0),se=Qt(S,0);ie.addColorStop(0,se),ie.addColorStop(10/ge,S),ie.addColorStop(1,S),e.fillStyle=ie,e.fill(),e.globalAlpha=.6;const[Se,_]=(l==null?void 0:l[1])??[-1,-1];for(let me=0;me<x.actions.length;me++){const ve=x.actions[me],z=G[me],ce=zt(z,Se+k,_);ce&&(e.globalAlpha=1),a.drawSprite(ve.icon,"normal",e,z.x+z.width/2-10,z.y+z.height/2-10,20,R),ce&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=s.borderColor,e.lineWidth=1,k!==0&&u(y[0])&&(e.beginPath(),e.moveTo(k+.5,I),e.lineTo(k+.5,I+A),e.stroke()),(D<r-1||g===void 0)&&(e.beginPath(),e.moveTo(k,I+A+.5),e.lineTo(k+H,I+A+.5),e.stroke()),e.restore(),v=Math.max(v,k+H)}),g===void 0){e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,h);let y=0;for(let p=0;p<r-1;p++)y+=i[p],e.moveTo(0,y+.5),e.lineTo(n,y+.5);e.strokeStyle=s.borderColor,e.lineWidth=1,e.stroke()}}const Cn=30;function jr(e,t,n,o,i){return{x:e+n-Cn,y:Math.max(t,t+o/2-Cn/2),width:Cn,height:Math.min(Cn,o)}}function go(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function ln(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function ki(e,t,n,o,i,r,l,s){var I;const a=l.cellHorizontalPadding,c=l.headerIconSize,u=jr(n,o,i,r),b=e===void 0?((I=ui(t.title,l.headerFontFull))==null?void 0:I.width)??0:Xt(t.title,e,l.headerFontFull).width,g=t.icon!==void 0?Math.ceil(c*1.3):0,f=g+b,d=n+Math.max(a,(i-f)/2),h=t.icon===void 0?void 0:{x:d,y:o+(r-c)/2,width:c,height:c},v=h===void 0||t.overlayIcon===void 0?void 0:{x:h.x+9,y:h.y+6,width:18,height:18},y={x:d+g,y:o,width:b,height:r};let p;t.indicatorIcon!==void 0&&(p={x:y.x+b+a,y:o+(r-c)/2,width:c,height:c});const k=n+i/2;return{menuBounds:ln(u,k,s),iconBounds:ln(h,k,s),iconOverlayBounds:ln(v,k,s),textBounds:ln(y,k,s),indicatorIconBounds:ln(p,k,s)}}function Yo(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const p=r.rowMarkerChecked;p!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=b);const k=r.headerRowMarkerTheme!==void 0?Nt(s,r.headerRowMarkerTheme):s;Bn(e,k,p,t,n,o,i,!1,void 0,void 0,s.checkboxMaxSize,"center",r.rowMarker),p!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const v=l?s.textHeaderSelected:s.textHeader,y=r.hasMenu===!0&&(a||f&&l)&&h.menuBounds!==void 0;if(r.icon!==void 0&&h.iconBounds!==void 0){let p=l?"selected":"normal";r.style==="highlight"&&(p=l?"selected":"special"),g.drawSprite(r.icon,p,e,h.iconBounds.x,h.iconBounds.y,h.iconBounds.width,s),r.overlayIcon!==void 0&&h.iconOverlayBounds!==void 0&&g.drawSprite(r.overlayIcon,l?"selected":"special",e,h.iconOverlayBounds.x,h.iconOverlayBounds.y,h.iconOverlayBounds.width,s)}if(y&&o>35){const k=d?35:o-35,I=d?35*.7:o-35*.7,H=k/o,A=I/o,D=e.createLinearGradient(t,0,t+o,0),F=Qt(v,0);D.addColorStop(d?1:0,v),D.addColorStop(H,v),D.addColorStop(A,F),D.addColorStop(d?0:1,F),e.fillStyle=D}else e.fillStyle=v;if(d&&(e.textAlign="right"),h.textBounds!==void 0&&e.fillText(r.title,d?h.textBounds.x+h.textBounds.width:h.textBounds.x,n+i/2+nt(e,s.headerFontFull)),d&&(e.textAlign="left"),r.indicatorIcon!==void 0&&h.indicatorIconBounds!==void 0&&(!y||!fn(h.menuBounds.x,h.menuBounds.y,h.menuBounds.width,h.menuBounds.height,h.indicatorIconBounds.x,h.indicatorIconBounds.y,h.indicatorIconBounds.width,h.indicatorIconBounds.height))){let p=l?"selected":"normal";r.style==="highlight"&&(p=l?"selected":"special"),g.drawSprite(r.indicatorIcon,p,e,h.indicatorIconBounds.x,h.indicatorIconBounds.y,h.indicatorIconBounds.width,s)}if(y&&h.menuBounds!==void 0){const p=h.menuBounds,k=c!==void 0&&u!==void 0&&zt(p,c+t,u+n);if(k||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===Kn.Triangle){e.beginPath();const I=p.x+p.width/2-5.5,H=p.y+p.height/2-3;Ar(e,[{x:I,y:H},{x:I+11,y:H},{x:I+5.5,y:H+6}],1),e.fillStyle=v,e.fill()}else if(r.menuIcon===Kn.Dots){e.beginPath();const I=p.x+p.width/2,H=p.y+p.height/2;Br(e,I,H),e.fillStyle=v,e.fill()}else{const I=p.x+(p.width-s.headerIconSize)/2,H=p.y+(p.height-s.headerIconSize)/2;g.drawSprite(r.menuIcon,"normal",e,I,H,s.headerIconSize,s)}k||(e.globalAlpha=1)}}function xi(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h){const v=co(r.title)==="rtl",y=ki(e,r,t,n,o,i,s,v);d!==void 0?d({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:g,isHovered:a,hasSelectedCell:b,spriteManager:f,menuBounds:(y==null?void 0:y.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:c,hoverY:u},()=>Yo(e,t,n,o,i,r,l,s,a,c,u,g,f,h,v,y)):Yo(e,t,n,o,i,r,l,s,a,c,u,g,f,h,v,y)}function Kr(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v,y,p){if(y!==void 0||t[t.length-1]!==n[t.length-1])return;const k=bi(v);It(t,a,l,s,r,(I,H,A,D,F)=>{if(I!==t[t.length-1])return;H+=I.width;const x=Math.max(H,D);x>o||(e.save(),e.beginPath(),e.rect(x,r+1,1e4,i-r-1),e.clip(),Dn(F,A,i,c,u,d,h,k,(R,C,S,M)=>{if(!M&&v.length>0&&!v.some(J=>fn(H,R,1e4,S,J.x,J.y,J.width,J.height)))return;const E=g.hasIndex(C),W=f.hasIndex(C);e.beginPath();const O=b==null?void 0:b(C),ee=O===void 0?p:Nt(p,O);ee.bgCell!==p.bgCell&&(e.fillStyle=ee.bgCell,e.fillRect(H,R,1e4,S)),W&&(e.fillStyle=ee.bgHeader,e.fillRect(H,R,1e4,S)),E&&(e.fillStyle=ee.accentLight,e.fillRect(H,R,1e4,S))}),e.restore())})}function Jr(e,t,n,o,i,r,l,s,a){let c=!1;for(const d of t)if(!d.sticky){c=l(d.sourceIndex);break}const u=a.horizontalBorderColor??a.borderColor,b=a.borderColor,g=c?Kt(t):0;let f;if(g!==0&&(f=No(b,a.bgCell),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,o),e.strokeStyle=f,e.stroke()),i>0){const d=b===u&&f!==void 0?f:No(u,a.bgCell),h=Jt(r,i,s);e.beginPath(),e.moveTo(0,o-h+.5),e.lineTo(n,o-h+.5),e.strokeStyle=d,e.stroke()}}const Si=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function Qr(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d){var S;const h=d.bgCell,{minX:v,maxX:y,minY:p,maxY:k}=Si(s,r,l),I=[],H=l-Jt(f,g,c);let A=a,D=n,F=0;for(;A+i<H;){const M=A+i,E=c(D);if(M>=p&&M<=k-1){const W=u==null?void 0:u(D),O=W==null?void 0:W.bgCell;O!==void 0&&O!==h&&D>=f-g&&I.push({x:v,y:M,w:y-v,h:E,color:O})}A+=E,D<f-g&&(F=A),D++}let x=0;const R=Math.min(H,k)-F;if(R>0)for(let M=0;M<t.length;M++){const E=t[M];if(E.width===0)continue;const W=E.sticky?x:x+o,O=(S=E.themeOverride)==null?void 0:S.bgCell;O!==void 0&&O!==h&&W>=v&&W<=y&&b(M+1)&&I.push({x:W,y:F,w:E.width,h:R,color:O}),x+=E.width}if(I.length===0)return;let C;e.beginPath();for(let M=I.length-1;M>=0;M--){const E=I[M];C===void 0?C=E.color:E.color!==C&&(e.fillStyle=C,e.fill(),e.beginPath(),C=E.color),e.rect(E.x,E.y,E.w,E.h)}C!==void 0&&(e.fillStyle=C,e.fill()),e.beginPath()}function $o(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v,y=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const S of a)e.rect(S.x+1,S.y+1,S.width-1,S.height-1);e.clip("evenodd")}const p=v.horizontalBorderColor??v.borderColor,k=v.borderColor,{minX:I,maxX:H,minY:A,maxY:D}=Si(s,r,l),F=[];e.beginPath();let x=.5;for(let S=0;S<t.length;S++){const M=t[S];if(M.width===0)continue;x+=M.width;const E=M.sticky?x:x+o;E>=I&&E<=H&&f(S+1)&&F.push({x1:E,y1:Math.max(c,A),x2:E,y2:Math.min(l,D),color:k})}let R=l+.5;for(let S=h-d;S<h;S++){const M=b(S);R-=M,F.push({x1:I,y1:R,x2:H,y2:R,color:p})}if(y!==!0){let S=u+.5,M=n;const E=R;for(;S+i<E;){const W=S+i;if(W>=A&&W<=D-1){const O=g==null?void 0:g(M);F.push({x1:I,y1:W,x2:H,y2:W,color:(O==null?void 0:O.horizontalBorderColor)??(O==null?void 0:O.borderColor)??p})}S+=b(M),M++}}const C=nr(F,S=>S.color);for(const S of Object.keys(C)){e.strokeStyle=S;for(const M of C[S])e.moveTo(M.x1,M.y1),e.lineTo(M.x2,M.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function Zr(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v,y,p){const k=[];e.imageSmoothingEnabled=!1;const I=Math.min(i.cellYOffset,l),H=Math.max(i.cellYOffset,l);let A=0;if(typeof y=="number")A+=(H-I)*y;else for(let E=I;E<H;E++)A+=y(E);l>i.cellYOffset&&(A=-A),A+=a-i.translateY;const D=Math.min(i.cellXOffset,r),F=Math.max(i.cellXOffset,r);let x=0;for(let E=D;E<F;E++)x+=h[E].width;r>i.cellXOffset&&(x=-x),x+=s-i.translateX;const R=Kt(v);if(x!==0&&A!==0)return{regions:[]};const C=c>0?Jt(g,c,y):0,S=u-R-Math.abs(x),M=b-f-C-Math.abs(A)-1;if(S>150&&M>150){const E={sx:0,sy:0,sw:u*d,sh:b*d,dx:0,dy:0,dw:u*d,dh:b*d};if(A>0?(E.sy=(f+1)*d,E.sh=M*d,E.dy=(A+f+1)*d,E.dh=M*d,k.push({x:0,y:f,width:u,height:A+1})):A<0&&(E.sy=(-A+f+1)*d,E.sh=M*d,E.dy=(f+1)*d,E.dh=M*d,k.push({x:0,y:b+A-C,width:u,height:-A+C})),x>0?(E.sx=R*d,E.sw=S*d,E.dx=(x+R)*d,E.dw=S*d,k.push({x:R-1,y:0,width:x+2,height:b})):x<0&&(E.sx=(R-x)*d,E.sw=S*d,E.dx=R*d,E.dw=S*d,k.push({x:u+x,y:0,width:-x,height:b})),e.setTransform(1,0,0,1,0,0),p){if(R>0&&x!==0&&A===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const W=R*d,O=b*d;e.drawImage(t,0,0,W,O,0,0,W,O)}if(C>0&&x===0&&A!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const W=(b-C)*d,O=u*d,ee=C*d;e.drawImage(t,0,W,O,ee,0,W,O,ee)}}e.drawImage(t,E.sx,E.sy,E.sw,E.sh,E.dx,E.dy,E.dw,E.dh),e.scale(d,d)}return e.imageSmoothingEnabled=!0,{regions:k}}function es(e,t,n,o,i,r,l,s,a,c){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||It(a,n,o,i,s,(b,g,f,d)=>{if(b.sourceIndex===c){const h=Math.max(g,d)+1;return u.push({x:h,y:0,width:r-h,height:l}),!0}}),u}function ts(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(jt(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...c}=r;if(!jt(s,c))return!1;n=o}return n===void 0?!0:n}return!0}function _o(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v,y){const p=d==null?void 0:d.filter(x=>x.style!=="no-outline");if(p===void 0||p.length===0)return;const k=Kt(s),I=Jt(f,g,b),H=[a,0,s.length,f-g],A=[k,0,t,n-I],D=p.map(x=>{const R=x.range,C=x.style??"dashed";return $r(R,H,t,n,A).map(S=>{const M=S.rect,E=to(M.x,M.y,t,n,u,c+u,o,i,r,l,f,a,g,s,b,v,y),W=M.width===1&&M.height===1?E:to(M.x+M.width-1,M.y+M.height-1,t,n,u,c+u,o,i,r,l,f,a,g,s,b,v,y);return M.x+M.width>=s.length&&(W.width-=1),M.y+M.height>=f&&(W.height-=1),{color:x.color,style:C,clip:S.clip,rect:Yr({x:E.x,y:E.y,width:W.x+W.width-E.x,height:W.y+W.height-E.y},t,n,8)}})}),F=()=>{e.lineWidth=1;let x=!1;for(const R of D)for(const C of R)if((C==null?void 0:C.rect)!==void 0&&fn(0,0,t,n,C.rect.x,C.rect.y,C.rect.width,C.rect.height)){const S=x,M=!Xr(C.clip,C.rect);e.beginPath(),M&&(e.save(),e.rect(C.clip.x,C.clip.y,C.clip.width,C.clip.height),e.clip()),C.style==="dashed"&&!x?(e.setLineDash([5,3]),x=!0):(C.style==="solid"||C.style==="solid-outline")&&x&&(e.setLineDash([]),x=!1),e.strokeStyle=C.style==="solid-outline"?tt(tt(C.color,h.borderColor),h.bgCell):Qt(C.color,1),e.closePath(),e.strokeRect(C.rect.x+.5,C.rect.y+.5,C.rect.width-1,C.rect.height-1),M&&(e.restore(),x=S)}x&&e.setLineDash([])};return F(),F}function Vo(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function Vn(e,t,n,o,i,r,l,s,a,c,u,b,g,f,d,h,v){if(u.current===void 0)return;const y=h!==!1&&h!==void 0;if(!y)return;const p=typeof h=="object"?{...Pn,...h}:Pn,k=u.current.range,I=u.current.cell,H=[k.x+k.width-1,k.y+k.height-1];if(I[1]>=v&&H[1]>=v||!l.some(O=>O.sourceIndex===I[0]||O.sourceIndex===H[0]))return;const[D,F]=u.current.cell,x=g(u.current.cell),R=x.span??[D,D],C=F>=v-f,S=f>0&&!C?Jt(v,f,b)-1:0,M=H[1];let E;if(It(l,o,i,r,c,(O,ee,J,G,Q)=>{if(O.sticky&&D>O.sourceIndex)return;const ge=O.sourceIndex<R[0],ie=O.sourceIndex>R[1],se=O.sourceIndex===H[0];if(!(!se&&(ge||ie)))return Dn(Q,J,n,v,b,f,d,void 0,(Se,_,me)=>{if(_!==F&&_!==M)return;let ve=ee,z=O.width;if(x.span!==void 0){const j=vi(x.span,ee,Se,O.width,me,O,s),de=O.sticky?j[0]:j[1];de!==void 0&&(ve=de.x,z=de.width)}return _===M&&se&&y&&(E=()=>{var le;G>ve&&!O.sticky&&(e.beginPath(),e.rect(G,0,t-G,n),e.clip());const j=p.size,de=j/2,Be=ve+z+p.offsetX-de+.5,q=Se+me+p.offsetY-de+.5;e.beginPath(),p.shape==="circle"?e.arc(Be+de,q+de,de,0,Math.PI*2):e.rect(Be,q,j,j),e.fillStyle=((le=O.themeOverride)==null?void 0:le.accentColor)??a.accentColor,e.fill(),p.outline>0&&(e.lineWidth=p.outline,e.strokeStyle=a.bgCell,p.shape==="circle"?(e.beginPath(),e.arc(Be+de,q+de,de+p.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(Be-p.outline/2,q-p.outline/2,j+p.outline,j+p.outline))}),E!==void 0}),E!==void 0}),E===void 0)return;const W=()=>{e.save(),e.beginPath(),e.rect(0,c,t,n-c-S),e.clip(),E==null||E(),e.restore()};return W(),W}function ns(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),It(t,s,r,l,i,(c,u,b,g)=>{const f=Math.max(0,g-u),d=u+f+1,h=c.width-f-1;a.has([c.sourceIndex,-1])&&e.rect(d,o,h,i-o)}),e.clip())}function os(e,t,n,o,i,r,l,s,a,c){let u=0;return It(e,r,o,i,n,(b,g,f,d,h)=>(Dn(h,f,t,l,s,a,c,void 0,(v,y,p,k)=>{k||(u=Math.max(y,u))}),!0)),u}function qo(e,t){var Pt;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mappedColumns:u,enableGroups:b,freezeColumns:g,dragAndDropState:f,theme:d,drawFocus:h,headerHeight:v,groupHeaderHeight:y,groupLevels:p,groupHeaderHeights:k,disabledRows:I,rowHeight:H,verticalBorder:A,overrideCursor:D,isResizing:F,selection:x,fillHandle:R,freezeTrailingRows:C,rows:S,getCellContent:M,getGroupDetails:E,getRowThemeOverride:W,isFocused:O,drawHeaderCallback:ee,prelightCells:J,drawCellCallback:G,highlightRegions:Q,resizeCol:ge,imageLoader:ie,lastBlitData:se,hoverValues:Se,hyperWrapping:_,hoverInfo:me,spriteManager:ve,maxScaleFactor:z,hasAppendRow:ce,touchMode:j,enqueue:de,renderStateProvider:Be,getCellRenderer:q,renderStrategy:le,bufferACtx:$e,bufferBCtx:qe,damage:be,minimumCellWidth:wt,resizeIndicator:mt}=e;if(i===0||r===0)return;const je=le==="double-buffer",ue=Math.min(z,Math.ceil(window.devicePixelRatio??1)),Ke=le!=="direct"&&ts(e,t),Oe=n.canvas;(Oe.width!==i*ue||Oe.height!==r*ue)&&(Oe.width=i*ue,Oe.height=r*ue,Oe.style.width=i+"px",Oe.style.height=r+"px");const Ve=o.canvas,Ie=k.reduce((pe,Ze)=>pe+Ze,0),re=v+Ie,ye=re+1;(Ve.width!==i*ue||Ve.height!==ye*ue)&&(Ve.width=i*ue,Ve.height=ye*ue,Ve.style.width=i+"px",Ve.style.height=ye+"px");const ke=$e.canvas,ot=qe.canvas;je&&(ke.width!==i*ue||ke.height!==r*ue)&&(ke.width=i*ue,ke.height=r*ue,se.current!==void 0&&(se.current.aBufferScroll=void 0)),je&&(ot.width!==i*ue||ot.height!==r*ue)&&(ot.width=i*ue,ot.height=r*ue,se.current!==void 0&&(se.current.bBufferScroll=void 0));const B=se.current;if(Ke===!0&&l===(B==null?void 0:B.cellXOffset)&&s===(B==null?void 0:B.cellYOffset)&&a===(B==null?void 0:B.translateX)&&c===(B==null?void 0:B.translateY))return;let Ae=null;je&&(Ae=n);const Ce=o;let N;je?be!==void 0?N=(B==null?void 0:B.lastBuffer)==="b"?qe:$e:N=(B==null?void 0:B.lastBuffer)==="b"?$e:qe:N=n;const De=N.canvas,Fe=je?De===ke?ot:ke:Oe,oe=typeof H=="number"?()=>H:H;Ce.save(),N.save(),Ce.beginPath(),N.beginPath(),Ce.textBaseline="middle",N.textBaseline="middle",ue!==1&&(Ce.scale(ue,ue),N.scale(ue,ue));const ne=eo(u,l,i,f,a);let ze=[];const it=h&&((Pt=x.current)==null?void 0:Pt.cell[1])===s&&c===0;let Je=!1;if(Q!==void 0){for(const pe of Q)if(pe.style!=="no-outline"&&pe.range.y===s&&c===0){Je=!0;break}}const ct=()=>{Ce.fillStyle=d.bgHeader,Ce.fillRect(0,0,i,re+1),qr(Ce,ne,u,b,me,i,a,v,y,f,F,x,d,ve,Se,A,E,be,ee,j,p,k),$o(Ce,ne,s,a,c,i,r,void 0,void 0,Ie,re,oe,W,A,C,S,d,!0),Ce.beginPath(),Ce.moveTo(0,ye-.5),Ce.lineTo(i,ye-.5),Ce.strokeStyle=tt(d.headerBottomBorderColor??d.horizontalBorderColor??d.borderColor,d.bgHeader),Ce.stroke(),Je&&_o(Ce,i,r,l,s,a,c,u,g,v,Ie,H,C,S,Q,d,p,k),it&&Vn(Ce,i,r,s,a,c,ne,u,d,re,x,oe,M,C,ce,R,S)};if(be!==void 0){const pe=ne[ne.length-1].sourceIndex+1,Ze=be.hasItemInRegion([{x:l,y:-2,width:pe,height:2},{x:l,y:s,width:pe,height:300},{x:0,y:s,width:g,height:300},{x:0,y:-2,width:g,height:2},{x:l,y:S-C,width:pe,height:C,when:C>0}]),rt=st=>{Xo(st,ne,u,r,re,a,c,s,S,oe,M,E,W,I,O,h,C,ce,ze,be,x,J,Q,ie,ve,Se,me,G,_,d,de,Be,q,D,wt);const bt=x.current;R!==!1&&R!==void 0&&h&&bt!==void 0&&be.has(ai(bt.range))&&Vn(st,i,r,s,a,c,ne,u,d,re,x,oe,M,C,ce,R,S)};Ze&&(rt(N),Ae!==null&&(Ae.save(),Ae.scale(ue,ue),Ae.textBaseline="middle",rt(Ae),Ae.restore()),be.hasHeader()&&(ns(Ce,ne,i,Ie,re,a,c,s,be),ct())),N.restore(),Ce.restore();return}if((Ke!==!0||l!==(B==null?void 0:B.cellXOffset)||s!==(B==null?void 0:B.cellYOffset)||a!==(B==null?void 0:B.translateX)||c!==(B==null?void 0:B.translateY)||it!==(B==null?void 0:B.mustDrawFocusOnHeader)||Je!==(B==null?void 0:B.mustDrawHighlightRingsOnHeader))&&ct(),Ke===!0){pt(Fe!==void 0&&B!==void 0);const{regions:pe}=Zr(N,Fe,Fe===ke?B.aBufferScroll:B.bBufferScroll,Fe===ke?B.bBufferScroll:B.aBufferScroll,B,l,s,a,c,C,i,r,S,re,ue,u,ne,H,je);ze=pe}else Ke!==!1&&(pt(B!==void 0),ze=es(B,l,s,a,c,i,r,re,ne,Ke));Jr(N,ne,i,r,C,S,A,oe,d);const _e=_o(N,i,r,l,s,a,c,u,g,v,Ie,H,C,S,Q,d,p,k),dt=h?Vn(N,i,r,s,a,c,ne,u,d,re,x,oe,M,C,ce,R,S):void 0;if(N.fillStyle=d.bgCell,ze.length>0){N.beginPath();for(const pe of ze)N.rect(pe.x,pe.y,pe.width,pe.height);N.clip(),N.fill(),N.beginPath()}else N.fillRect(0,0,i,r);const Qe=Xo(N,ne,u,r,re,a,c,s,S,oe,M,E,W,I,O,h,C,ce,ze,be,x,J,Q,ie,ve,Se,me,G,_,d,de,Be,q,D,wt);Kr(N,ne,u,i,r,re,a,c,s,S,oe,W,x.rows,I,C,ce,ze,be,d),Qr(N,ne,s,a,c,i,r,ze,re,oe,W,A,C,S,d),$o(N,ne,s,a,c,i,r,ze,Qe,Ie,re,oe,W,A,C,S,d),_e==null||_e(),dt==null||dt(),F&&mt!=="none"&&It(ne,0,a,0,re,(pe,Ze)=>pe.sourceIndex===ge?(Vo(Ce,Ze+pe.width,0,re+1,tt(d.resizeIndicatorColor??d.accentLight,d.bgHeader)),mt==="full"&&Vo(N,Ze+pe.width,re,r,tt(d.resizeIndicatorColor??d.accentLight,d.bgCell)),!0):!1),Ae!==null&&(Ae.fillStyle=d.bgCell,Ae.fillRect(0,0,i,r),Ae.drawImage(N.canvas,0,0));const Ft=os(ne,r,re,a,c,s,S,oe,C,ce);ie==null||ie.setWindow({x:l,y:s,width:ne.length,height:Ft-s},g,Array.from({length:C},(pe,Ze)=>S-1-Ze));const Ht=B!==void 0&&(l!==B.cellXOffset||a!==B.translateX),He=B!==void 0&&(s!==B.cellYOffset||c!==B.translateY);se.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mustDrawFocusOnHeader:it,mustDrawHighlightRingsOnHeader:Je,lastBuffer:je?De===ke?"a":"b":void 0,aBufferScroll:De===ke?[Ht,He]:B==null?void 0:B.aBufferScroll,bBufferScroll:De===ot?[Ht,He]:B==null?void 0:B.bBufferScroll},N.restore(),Ce.restore()}const is=80;function rs(e){const t=e-1;return t*t*t+1}class ss{constructor(t){Z(this,"currentHoveredItem");Z(this,"leavingItems",[]);Z(this,"lastAnimationTime");Z(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>Mn(o.item,t.item))||this.leavingItems.push(t)});Z(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>Mn(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});Z(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});Z(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});Z(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:rs(t.hoverAmount)})));Z(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/is;for(const r of this.leavingItems)r.hoverAmount=Fn(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=Fn(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});Z(this,"setHovered",t=>{var n;if(!Mn((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class ls{constructor(t){Z(this,"fn");Z(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function mo(e){return new ls(e)}const as=mo(()=>window.navigator.userAgent.includes("Firefox")),Uo=mo(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),_l=mo(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function cs(e){const t=m.useRef([]),n=m.useRef(0),o=m.useRef(e);o.current=e;const i=m.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(ho);t.current=[],o.current(new Gt(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return m.useCallback(r=>{t.current.length===0&&i();const l=at(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const Ot="header",an="group-header",Go="out-of-bounds";var cn=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(cn||{});function ds(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const us=(e,t)=>{if(e.kind===he.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},fs=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:c=!1,groupHeaderHeight:u,groupLevels:b,groupHeaderHeights:g,rowHeight:f,rows:d,getCellContent:h,getRowThemeOverride:v,onHeaderMenuClick:y,onHeaderIndicatorClick:p,enableGroups:k,isFilling:I,onCanvasFocused:H,onCanvasBlur:A,isFocused:D,selection:F,freezeColumns:x,onContextMenu:R,freezeTrailingRows:C,fixedShadowX:S=!0,fixedShadowY:M=!0,drawFocusRing:E,onMouseDown:W,onMouseUp:O,onMouseMoveRaw:ee,onMouseMove:J,onItemHovered:G,dragAndDropState:Q,firstColAccessible:ge,onKeyDown:ie,onKeyUp:se,highlightRegions:Se,canvasRef:_,onDragStart:me,onDragEnd:ve,eventTargetRef:z,isResizing:ce,resizeColumn:j,isDragging:de,isDraggable:Be=!1,allowResize:q,disabledRows:le,hasAppendRow:$e,getGroupDetails:qe,theme:be,prelightCells:wt,headerIcons:mt,verticalBorder:je,drawCell:ue,drawHeader:Ke,onCellFocused:Oe,onDragOverCell:Ve,onDrop:Ie,onDragLeave:re,imageWindowLoader:ye,smoothScrollX:ke=!1,smoothScrollY:ot=!1,experimental:B,getCellRenderer:Ae,resizeIndicator:Ce="full"}=e,N=e.translateX??0,De=e.translateY??0,Fe=Math.max(x,Math.min(r.length-1,l)),oe=m.useRef(null),ne=m.useRef((B==null?void 0:B.eventTarget)??window),ze=ne.current,it=ye,Je=m.useRef(),[ct,_e]=m.useState(!1),dt=m.useRef([]),Qe=m.useRef(),[Ft,Ht]=m.useState(),[He,Pt]=m.useState(),pe=m.useRef(null),[Ze,rt]=m.useState(),[st,bt]=m.useState(!1),Bt=m.useRef(st);Bt.current=st;const U=m.useMemo(()=>new Tr(mt,()=>{gn.current=void 0,en.current()}),[mt]),Pe=k?g.reduce((w,P)=>w+P,0):0,ae=a+Pe,Ue=m.useRef(-1),et=((B==null?void 0:B.enableFirefoxRescaling)??!1)&&as.value,Re=((B==null?void 0:B.enableSafariRescaling)??!1)&&Uo.value;m.useLayoutEffect(()=>{window.devicePixelRatio===1||!et&&!Re||(Ue.current!==-1&&_e(!0),window.clearTimeout(Ue.current),Ue.current=window.setTimeout(()=>{_e(!1),Ue.current=-1},200))},[s,Fe,N,De,et,Re]);const Te=yr(r,x),Rn=m.useMemo(()=>S?Kt(Te,Q):0,[Te,Q,S]),Ne=m.useCallback((w,P,X)=>{const Y=w.getBoundingClientRect();if(P>=Te.length||X>=d)return;const T=Y.width/n,L=to(P,X,n,o,u,ae,Fe,s,N,De,d,x,C,Te,f,b,g);return T!==1&&(L.x*=T,L.y*=T,L.width*=T,L.height*=T),L.x+=Y.x,L.y+=Y.y,L},[n,o,u,ae,Fe,s,N,De,d,x,C,Te,f,b,g]),Xe=m.useCallback((w,P,X,Y)=>{const T=w.getBoundingClientRect(),L=T.width/n,K=(P-T.left)/L,te=(X-T.top)/L,$=5,Ye=eo(Te,Fe,n,void 0,N);let V=0,fe=0;const Ee=typeof PointerEvent<"u"&&Y instanceof PointerEvent&&Y.pointerType==="mouse"||typeof MouseEvent<"u"&&Y instanceof MouseEvent,xe=typeof PointerEvent<"u"&&Y instanceof PointerEvent&&Y.pointerType==="touch"||typeof TouchEvent<"u"&&Y instanceof TouchEvent;Ee&&(V=Y.button,fe=Y.buttons);const Me=Sr(K,Ye,N),We=Cr(te,o,k,a,u,d,f,s,De,C,b,g),Le=(Y==null?void 0:Y.shiftKey)===!0,vt=(Y==null?void 0:Y.ctrlKey)===!0,kt=(Y==null?void 0:Y.metaKey)===!0,ut=[K<0?-1:n<K?1:0,te<ae?-1:o<te?1:0];let xt;if(Me===-1||te<0||K<0||We===void 0||K>n||te>o){const we=K>n?1:K<0?-1:0,St=te>o?1:te<0?-1:0;let yt=we*2,qt=St*2;we===0&&(yt=Me===-1?cn.EndPadding:cn.Center),St===0&&(qt=We===void 0?cn.EndPadding:cn.Center);let lt=!1;if(Me===-1&&We===-1){const Ut=Ne(w,Te.length-1,-1);pt(Ut!==void 0),lt=P<Ut.x+Ut.width+$}const nn=K>n&&K<n+To()||te>o&&te<o+To();xt={kind:Go,location:[Me!==-1?Me:K<0?0:Te.length-1,We??d-1],region:[yt,qt],shiftKey:Le,ctrlKey:vt,metaKey:kt,isEdge:lt,isTouch:xe,button:V,buttons:fe,scrollEdge:ut,isMaybeScrollbar:nn}}else if(We<=-1){let we=Ne(w,Me,We);pt(we!==void 0);let St=we!==void 0&&we.x+we.width-P<=$;const yt=k&&We<=-2,qt=yt?-(We+2):void 0,lt=Me-1;P-we.x<=$&&lt>=0?(St=!0,we=Ne(w,lt,We),pt(we!==void 0),xt={kind:yt?an:Ot,location:[lt,We],bounds:we,group:Lt(Te[lt].group,qt),isEdge:St,shiftKey:Le,ctrlKey:vt,metaKey:kt,isTouch:xe,localEventX:P-we.x,localEventY:X-we.y,button:V,buttons:fe,scrollEdge:ut}):xt={kind:yt?an:Ot,group:Lt(Te[Me].group,qt),location:[Me,We],bounds:we,isEdge:St,shiftKey:Le,ctrlKey:vt,metaKey:kt,isTouch:xe,localEventX:P-we.x,localEventY:X-we.y,button:V,buttons:fe,scrollEdge:ut}}else{const we=Ne(w,Me,We);pt(we!==void 0);const St=we!==void 0&&we.x+we.width-P<$;let yt=!1;if(c!==!1&&c!==void 0&&F.current!==void 0){const lt=typeof c=="object"?{...Pn,...c}:Pn,nn=lt.size,Ut=nn/2,Bo=ai(F.current.range),on=Ne(w,Bo[0],Bo[1]);if(on!==void 0){const Gi=on.x+on.width+lt.offsetX-Ut+.5,ji=on.y+on.height+lt.offsetY-Ut+.5;yt=Math.abs(Gi-P)<nn&&Math.abs(ji-X)<nn}}xt={kind:"cell",location:[Me,We],bounds:we,isEdge:St,shiftKey:Le,ctrlKey:vt,isFillHandle:yt,metaKey:kt,isTouch:xe,localEventX:P-we.x,localEventY:X-we.y,button:V,buttons:fe,scrollEdge:ut}}return xt},[n,Te,Fe,N,o,k,a,u,d,f,s,De,C,Ne,c,F,ae,b,g]),[At]=Ft??[],vo=m.useRef(()=>{}),Yt=m.useRef(Ft);Yt.current=Ft;const[Dt,Rt]=m.useMemo(()=>{const w=document.createElement("canvas"),P=document.createElement("canvas");return w.style.display="none",w.style.opacity="0",w.style.position="fixed",P.style.display="none",P.style.opacity="0",P.style.position="fixed",[w.getContext("2d",{alpha:!1}),P.getContext("2d",{alpha:!1})]},[]);m.useLayoutEffect(()=>{if(!(Dt===null||Rt===null))return document.documentElement.append(Dt.canvas),document.documentElement.append(Rt.canvas),()=>{Dt.canvas.remove(),Rt.canvas.remove()}},[Dt,Rt]);const hn=m.useMemo(()=>new Dr,[]),yo=et&&ct?1:Re&&ct?2:5,po=(B==null?void 0:B.disableMinimumCellWidth)===!0?1:10,gn=m.useRef(),mn=m.useRef(null),bn=m.useRef(null),vn=m.useCallback(()=>{var K;const w=oe.current,P=pe.current;if(w===null||P===null||(mn.current===null&&(mn.current=w.getContext("2d",{alpha:!1}),w.width=0,w.height=0),bn.current===null&&(bn.current=P.getContext("2d",{alpha:!1}),P.width=0,P.height=0),mn.current===null||bn.current===null||Dt===null||Rt===null))return;let X=!1;const Y=te=>{X=!0,rt(te)},T=gn.current,L={headerCanvasCtx:bn.current,canvasCtx:mn.current,bufferACtx:Dt,bufferBCtx:Rt,width:n,height:o,cellXOffset:Fe,cellYOffset:s,translateX:Math.round(N),translateY:Math.round(De),mappedColumns:Te,enableGroups:k,freezeColumns:x,dragAndDropState:Q,theme:be,headerHeight:a,groupHeaderHeight:u,groupLevels:b,groupHeaderHeights:g,disabledRows:le??Jn.empty(),rowHeight:f,verticalBorder:je,isResizing:ce,resizeCol:j,isFocused:D,selection:F,fillHandle:c,drawCellCallback:ue,hasAppendRow:$e,overrideCursor:Y,maxScaleFactor:yo,freezeTrailingRows:C,rows:d,drawFocus:E,getCellContent:h,getGroupDetails:qe??(te=>({name:te})),getRowThemeOverride:v,drawHeaderCallback:Ke,prelightCells:wt,highlightRegions:Se,imageLoader:it,lastBlitData:Qe,damage:Je.current,hoverValues:dt.current,hoverInfo:Yt.current,spriteManager:U,scrolling:ct,hyperWrapping:(B==null?void 0:B.hyperWrapping)??!1,touchMode:st,enqueue:vo.current,renderStateProvider:hn,renderStrategy:(B==null?void 0:B.renderStrategy)??(Uo.value?"double-buffer":"single-buffer"),getCellRenderer:Ae,minimumCellWidth:po,resizeIndicator:Ce};L.damage===void 0?(gn.current=L,qo(L,T)):qo(L,void 0),!X&&(L.damage===void 0||L.damage.has((K=Yt==null?void 0:Yt.current)==null?void 0:K[0]))&&rt(void 0)},[Dt,Rt,n,o,Fe,s,N,De,Te,k,x,Q,be,a,u,b,g,le,f,je,ce,$e,j,D,F,c,C,d,E,yo,h,qe,v,ue,Ke,wt,Se,it,U,ct,B==null?void 0:B.hyperWrapping,B==null?void 0:B.renderStrategy,st,hn,Ae,po,Ce]),en=m.useRef(vn);m.useLayoutEffect(()=>{vn(),en.current=vn},[vn]),m.useLayoutEffect(()=>{(async()=>{var P;((P=document==null?void 0:document.fonts)==null?void 0:P.ready)!==void 0&&(await document.fonts.ready,gn.current=void 0,en.current())})()},[]);const $t=m.useCallback(w=>{Je.current=w,en.current(),Je.current=void 0},[]),Mi=cs($t);vo.current=Mi;const wo=m.useCallback(w=>{$t(new Gt(w.map(P=>P.cell)))},[$t]);it.setCallback($t);const[Ii,Fi]=m.useState(!1),[Tt,_t]=At??[],Hi=Tt!==void 0&&_t===-1&&Tt>=0&&Tt<Te.length&&Te[Tt].headerRowMarkerDisabled!==!0,Pi=Tt!==void 0&&_t===-2;let ko=!1,xo=!1,yn=Ze;if(yn===void 0&&Tt!==void 0&&_t!==void 0&&_t>-1&&_t<d){const w=h([Tt,_t],!0);ko=w.kind===Mt.NewRow||w.kind===Mt.Marker&&w.markerKind!=="number",xo=w.kind===he.Boolean&&lo(w),yn=w.cursor}const So=de?"grabbing":(He??!1)||ce?"col-resize":Ii||I?"crosshair":yn!==void 0?yn:Hi||ko||xo||Pi?"pointer":"default",Tn=m.useMemo(()=>({contain:"strict",display:"block",cursor:So}),[So]),Co=m.useRef("default"),Wn=z==null?void 0:z.current;Wn!=null&&Co.current!==Tn.cursor&&(Wn.style.cursor=Co.current=Tn.cursor);const pn=m.useCallback((w,P,X,Y)=>{if(qe===void 0)return;const T=qe(w);if(T.actions!==void 0){const L=go(P,T.actions);for(const[K,te]of L.entries())if(zt(te,X+P.x,Y+te.y))return T.actions[K]}},[qe]),Vt=m.useCallback((w,P,X,Y)=>{const T=Te[P];if(!de&&!ce&&!(He??!1)){const L=Ne(w,P,-1);pt(L!==void 0);const K=ki(void 0,T,L.x,L.y,L.width,L.height,be,co(T.title)==="rtl");if(T.hasMenu===!0&&K.menuBounds!==void 0&&zt(K.menuBounds,X,Y))return{area:"menu",bounds:K.menuBounds};if(T.indicatorIcon!==void 0&&K.indicatorIconBounds!==void 0&&zt(K.indicatorIconBounds,X,Y))return{area:"indicator",bounds:K.indicatorIconBounds}}},[Te,Ne,He,de,ce,be]),On=m.useRef(0),tn=m.useRef(),zn=m.useRef(!1),Bi=m.useCallback(w=>{const P=oe.current,X=z==null?void 0:z.current;if(P===null||w.target!==P&&w.target!==X)return;zn.current=!0;const Y=w.clientX,T=w.clientY;if(w.target===X&&X!==null){const K=X.getBoundingClientRect();if(Y>K.right||T>K.bottom)return}const L=Xe(P,Y,T,w);tn.current=L.location,L.isTouch&&(On.current=Date.now()),Bt.current!==L.isTouch&&bt(L.isTouch),!(L.kind===Ot&&Vt(P,L.location[0],Y,T)!==void 0)&&(L.kind===an&&pn(L.group,L.bounds,L.localEventX,L.localEventY)!==void 0||(W==null||W(L),!L.isTouch&&Be!==!0&&Be!==L.kind&&L.button<3&&L.button!==1&&w.preventDefault()))},[z,Be,Xe,pn,Vt,W]);ft("pointerdown",Bi,ze,!1);const Eo=m.useRef(0),Ai=m.useCallback(w=>{var fe,Ee;const P=Eo.current;Eo.current=Date.now();const X=oe.current;if(zn.current=!1,O===void 0||X===null)return;const Y=z==null?void 0:z.current,T=w.target!==X&&w.target!==Y,L=w.clientX,K=w.clientY,te=w.pointerType==="mouse"?w.button<3:!0;let $=Xe(X,L,K,w);$.isTouch&&On.current!==0&&Date.now()-On.current>500&&($={...$,isLongTouch:!0}),P!==0&&Date.now()-P<($.isTouch?1e3:500)&&($={...$,isDoubleClick:!0}),Bt.current!==$.isTouch&&bt($.isTouch),!T&&w.cancelable&&te&&w.preventDefault();const[Ye]=$.location,V=Vt(X,Ye,L,K);if($.kind===Ot&&V!==void 0){($.button!==0||((fe=tn.current)==null?void 0:fe[0])!==Ye||((Ee=tn.current)==null?void 0:Ee[1])!==-1)&&O($,!0);return}else if($.kind===an){const xe=pn($.group,$.bounds,$.localEventX,$.localEventY);if(xe!==void 0){$.button===0&&xe.onClick($);return}}O($,T)},[O,z,Xe,Vt,pn]);ft("pointerup",Ai,ze,!1);const Di=m.useCallback(w=>{var Ye,V;const P=oe.current;if(P===null)return;const X=z==null?void 0:z.current,Y=w.target!==P&&w.target!==X;let T,L,K=!0;w instanceof MouseEvent?(T=w.clientX,L=w.clientY,K=w.button<3):(T=w.changedTouches[0].clientX,L=w.changedTouches[0].clientY);const te=Xe(P,T,L,w);Bt.current!==te.isTouch&&bt(te.isTouch),!Y&&w.cancelable&&K&&w.preventDefault();const[$]=te.location;if(te.kind===Ot){const fe=Vt(P,$,T,L);fe!==void 0&&te.button===0&&((Ye=tn.current)==null?void 0:Ye[0])===$&&((V=tn.current)==null?void 0:V[1])===-1&&(fe.area==="menu"?y==null||y($,fe.bounds):fe.area==="indicator"&&(p==null||p($,fe.bounds)))}},[z,Xe,Vt,y,p]);ft("click",Di,ze,!1);const Ri=m.useCallback(w=>{const P=oe.current,X=z==null?void 0:z.current;if(P===null||w.target!==P&&w.target!==X||R===void 0)return;const Y=Xe(P,w.clientX,w.clientY,w);R(Y,()=>{w.cancelable&&w.preventDefault()})},[z,Xe,R]);ft("contextmenu",Ri,(z==null?void 0:z.current)??null,!1);const Mo=m.useCallback(w=>{Je.current=new Gt(w.map(P=>P.item)),dt.current=w,en.current(),Je.current=void 0},[]),Io=m.useMemo(()=>new ss(Mo),[Mo]),Fo=m.useRef(Io);Fo.current=Io,m.useLayoutEffect(()=>{const w=Fo.current;if(At===void 0||At[1]<0){w.setHovered(At);return}const P=h(At,!0),X=Ae(P),Y=X===void 0&&P.kind===he.Custom||(X==null?void 0:X.needsHover)!==void 0&&(typeof X.needsHover=="boolean"?X.needsHover:X.needsHover(P));w.setHovered(Y?At:void 0)},[h,Ae,At]);const Ho=m.useRef(),Ti=m.useCallback(w=>{var te;const P=oe.current;if(P===null)return;const X=z==null?void 0:z.current,Y=w.target!==P&&w.target!==X,T=Xe(P,w.clientX,w.clientY,w);if(T.kind!=="out-of-bounds"&&Y&&!zn.current&&!T.isTouch)return;const L=($,Ye)=>{Ht(V=>V===$||(V==null?void 0:V[0][0])===($==null?void 0:$[0][0])&&(V==null?void 0:V[0][1])===($==null?void 0:$[0][1])&&((V==null?void 0:V[1][0])===($==null?void 0:$[1][0])&&(V==null?void 0:V[1][1])===($==null?void 0:$[1][1])||!Ye)?V:$)};if(!ds(T,Ho.current))rt(void 0),G==null||G(T),L(T.kind===Go?void 0:[T.location,[T.localEventX,T.localEventY]],!0),Ho.current=T;else if(T.kind==="cell"||T.kind===Ot||T.kind===an){let $=!1,Ye=!0;if(T.kind==="cell"){const fe=h(T.location);Ye=((te=Ae(fe))==null?void 0:te.needsHoverPosition)??fe.kind===he.Custom,$=Ye}else $=!0;const V=[T.location,[T.localEventX,T.localEventY]];L(V,Ye),Yt.current=V,$&&$t(new Gt([T.location]))}const K=T.location[0]>=(ge?0:1);Pt(T.kind===Ot&&T.isEdge&&K&&q===!0),Fi(T.kind==="cell"&&T.isFillHandle),ee==null||ee(w),J(T)},[z,Xe,ge,q,ee,J,G,h,Ae,$t]);ft("pointermove",Ti,ze,!0);const Wi=m.useCallback(w=>{const P=oe.current;if(P===null)return;let X,Y;F.current!==void 0&&(X=Ne(P,F.current.cell[0],F.current.cell[1]),Y=F.current.cell),ie==null||ie({bounds:X,stopPropagation:()=>w.stopPropagation(),preventDefault:()=>w.preventDefault(),cancel:()=>{},ctrlKey:w.ctrlKey,metaKey:w.metaKey,shiftKey:w.shiftKey,altKey:w.altKey,key:w.key,keyCode:w.keyCode,rawEvent:w,location:Y})},[ie,F,Ne]),Oi=m.useCallback(w=>{const P=oe.current;if(P===null)return;let X,Y;F.current!==void 0&&(X=Ne(P,F.current.cell[0],F.current.cell[1]),Y=F.current.cell),se==null||se({bounds:X,stopPropagation:()=>w.stopPropagation(),preventDefault:()=>w.preventDefault(),cancel:()=>{},ctrlKey:w.ctrlKey,metaKey:w.metaKey,shiftKey:w.shiftKey,altKey:w.altKey,key:w.key,keyCode:w.keyCode,rawEvent:w,location:Y})},[se,F,Ne]),zi=m.useCallback(w=>{if(oe.current=w,_!==void 0&&(_.current=w),B!=null&&B.eventTarget)ne.current=B.eventTarget;else if(w===null)ne.current=window;else{const P=w.getRootNode();P===document&&(ne.current=window),ne.current=P}},[_,B==null?void 0:B.eventTarget]),Li=m.useCallback(w=>{const P=oe.current;if(P===null||Be===!1||ce){w.preventDefault();return}let X,Y;const T=Xe(P,w.clientX,w.clientY);if(Be!==!0&&T.kind!==Be){w.preventDefault();return}const L=(fe,Ee)=>{X=fe,Y=Ee};let K,te,$;const Ye=(fe,Ee,xe)=>{K=fe,te=Ee,$=xe};let V=!1;if(me==null||me({...T,setData:L,setDragImage:Ye,preventDefault:()=>V=!0,defaultPrevented:()=>V}),!V&&X!==void 0&&Y!==void 0&&w.dataTransfer!==null)if(w.dataTransfer.setData(X,Y),w.dataTransfer.effectAllowed="copyLink",K!==void 0&&te!==void 0&&$!==void 0)w.dataTransfer.setDragImage(K,te,$);else{const[fe,Ee]=T.location;if(Ee!==void 0){const xe=document.createElement("canvas"),Me=Ne(P,fe,Ee);pt(Me!==void 0);const We=Math.ceil(window.devicePixelRatio??1);xe.width=Me.width*We,xe.height=Me.height*We;const Le=xe.getContext("2d");Le!==null&&(Le.scale(We,We),Le.textBaseline="middle",Ee===-1?(Le.font=be.headerFontFull,Le.fillStyle=be.bgHeader,Le.fillRect(0,0,xe.width,xe.height),xi(Le,0,0,Me.width,Me.height,Te[fe],!1,be,!1,void 0,void 0,!1,0,U,Ke,!1)):(Le.font=be.baseFontFull,Le.fillStyle=be.bgCell,Le.fillRect(0,0,xe.width,xe.height),wi(Le,h([fe,Ee]),0,Ee,!1,!1,0,0,Me.width,Me.height,!1,be,be.bgCell,it,U,1,void 0,!1,0,void 0,void 0,void 0,hn,Ae,()=>{},0))),xe.style.left="-100%",xe.style.position="absolute",xe.style.width=`${Me.width}px`,xe.style.height=`${Me.height}px`,document.body.append(xe),w.dataTransfer.setDragImage(xe,Me.width/2,Me.height/2),window.setTimeout(()=>{xe.remove()},0)}}else w.preventDefault()},[Be,ce,Xe,me,Ne,be,Te,U,Ke,h,it,hn,Ae]);ft("dragstart",Li,(z==null?void 0:z.current)??null,!1,!1);const Ln=m.useRef(),Ni=m.useCallback(w=>{const P=oe.current;if(Ie!==void 0&&w.preventDefault(),P===null||Ve===void 0)return;const X=Xe(P,w.clientX,w.clientY),[Y,T]=X.location,L=Y-(ge?0:1),[K,te]=Ln.current??[];(K!==L||te!==T)&&(Ln.current=[L,T],Ve([L,T],w.dataTransfer))},[ge,Xe,Ve,Ie]);ft("dragover",Ni,(z==null?void 0:z.current)??null,!1,!1);const Xi=m.useCallback(()=>{Ln.current=void 0,ve==null||ve()},[ve]);ft("dragend",Xi,(z==null?void 0:z.current)??null,!1,!1);const Yi=m.useCallback(w=>{const P=oe.current;if(P===null||Ie===void 0)return;w.preventDefault();const X=Xe(P,w.clientX,w.clientY),[Y,T]=X.location,L=Y-(ge?0:1);Ie([L,T],w.dataTransfer)},[ge,Xe,Ie]);ft("drop",Yi,(z==null?void 0:z.current)??null,!1,!1);const $i=m.useCallback(()=>{re==null||re()},[re]);ft("dragleave",$i,(z==null?void 0:z.current)??null,!1,!1);const Po=m.useRef(F);Po.current=F;const wn=m.useRef(null),Nn=m.useCallback(w=>{var P;oe.current===null||!oe.current.contains(document.activeElement)||(w===null&&Po.current.current!==void 0?(P=_==null?void 0:_.current)==null||P.focus({preventScroll:!0}):w!==null&&w.focus({preventScroll:!0}),wn.current=w)},[_]);m.useImperativeHandle(t,()=>({focus:()=>{var P;const w=wn.current;w===null||!document.contains(w)?(P=_==null?void 0:_.current)==null||P.focus({preventScroll:!0}):w.focus({preventScroll:!0})},getBounds:(w,P)=>{if(!(_===void 0||_.current===null))return Ne(_.current,w??0,P??-1)},damage:wo,getMouseArgsForPosition:(w,P,X)=>{if(!(_===void 0||_.current===null))return Xe(_.current,w,P,X)}}),[_,wo,Ne,Xe]);const Xn=m.useRef(),_i=gr(()=>{var te,$,Ye;if(n<50||(B==null?void 0:B.disableAccessibilityTree)===!0)return null;let w=eo(Te,Fe,n,Q,N);const P=ge?0:-1;!ge&&((te=w[0])==null?void 0:te.sourceIndex)===0&&(w=w.slice(1));const[X,Y]=(($=F.current)==null?void 0:$.cell)??[],T=(Ye=F.current)==null?void 0:Ye.range,L=w.map(V=>V.sourceIndex),K=or(s,Math.min(d,s+i));return X!==void 0&&Y!==void 0&&!(L.includes(X)&&K.includes(Y))&&Nn(null),m.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":d+1,"aria-multiselectable":"true","aria-colcount":Te.length+P},m.createElement("thead",{role:"rowgroup"},m.createElement("tr",{role:"row","aria-rowindex":1},w.map(V=>m.createElement("th",{role:"columnheader","aria-selected":F.columns.hasIndex(V.sourceIndex),"aria-colindex":V.sourceIndex+1+P,tabIndex:-1,onFocus:fe=>{if(fe.target!==wn.current)return Oe==null?void 0:Oe([V.sourceIndex,-1])},key:V.sourceIndex},V.title)))),m.createElement("tbody",{role:"rowgroup"},K.map(V=>m.createElement("tr",{role:"row","aria-selected":F.rows.hasIndex(V),key:V,"aria-rowindex":V+2},w.map(fe=>{const Ee=fe.sourceIndex,xe=at(Ee,V),Me=X===Ee&&Y===V,We=T!==void 0&&Ee>=T.x&&Ee<T.x+T.width&&V>=T.y&&V<T.y+T.height,Le=`glide-cell-${Ee}-${V}`,vt=[Ee,V],kt=h(vt,!0);return m.createElement("td",{key:xe,role:"gridcell","aria-colindex":Ee+1+P,"aria-selected":We,"aria-readonly":so(kt)||!dr(kt),id:Le,"data-testid":Le,onClick:()=>{const ut=_==null?void 0:_.current;if(ut!=null)return ie==null?void 0:ie({bounds:Ne(ut,Ee,V),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:vt})},onFocusCapture:ut=>{var xt,we;if(!(ut.target===wn.current||((xt=Xn.current)==null?void 0:xt[0])===Ee&&((we=Xn.current)==null?void 0:we[1])===V))return Xn.current=vt,Oe==null?void 0:Oe(vt)},ref:Me?Nn:void 0,tabIndex:-1},us(kt,Ae))})))))},[n,Te,Fe,Q,N,d,s,i,F,Nn,h,_,ie,Ne,Oe],200),kn=x===0||!S?0:Fe>x?1:Fn(-N/100,0,1),Vi=-s*32+De,xn=M?Fn(-Vi/100,0,1):0,qi=m.useMemo(()=>{if(!kn&&!xn)return null;const w={position:"absolute",top:0,left:Rn,width:n-Rn,height:o,opacity:kn,pointerEvents:"none",transition:ke?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},P={position:"absolute",top:ae,left:0,width:n,height:o,opacity:xn,pointerEvents:"none",transition:ot?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return m.createElement(m.Fragment,null,kn>0&&m.createElement("div",{id:"shadow-x",style:w}),xn>0&&m.createElement("div",{id:"shadow-y",style:P}))},[kn,xn,Rn,n,ke,ae,o,ot]),Ui=m.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return m.createElement(m.Fragment,null,m.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:-1,onKeyDown:Wi,onKeyUp:Oi,onFocus:H,onBlur:A,ref:zi,style:Tn},_i),m.createElement("canvas",{ref:pe,style:Ui}),qi)},Vl=m.memo(m.forwardRef(fs));class hs extends m.PureComponent{constructor(){super(...arguments);Z(this,"wrapperRef",m.createRef());Z(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:i,...r}=this.props;return m.createElement("div",{...r,ref:this.wrapperRef},this.props.children)}}function gs(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case he.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===ro?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case he.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case he.Image:case he.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case he.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case he.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case he.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case he.Markdown:case he.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case he.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case he.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case he.Protected:return{formatted:"************",rawValue:"",format:"string"};default:io()}}function ms(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:gs(l))})}function jo(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function bs(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>jo(l,!0)).join(",")):i.push(r.doNotEscape===!0?r.formatted:jo(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function qn(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function Ko(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function vs(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ys(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${qn(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${Ko(i.rawValue[s])}>`+qn(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${Ko(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${qn(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function ps(e,t){const n=ms(e,t),o=bs(n),i=ys(n);return{textPlain:o,textHtml:i}}function ql(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),u=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,b=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",g=a.querySelectorAll("br");for(const h of g)h.replaceWith(`
`);const f=a.getAttribute("gdg-raw-value"),d=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:d});else if(a.querySelector("ol")!==null){const h=a.querySelectorAll("li");r==null||r.push({rawValue:[...h].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...h].map(v=>v.textContent??""),format:"string-array"})}else if(f!==null)r==null||r.push({rawValue:vs(f),formatted:a.textContent??"",format:d});else{let h=a.textContent??"";b&&(h=h.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:h??"",formatted:h??"",format:d})}}}return r!==void 0&&i.push(r),i}function Ul(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,c=[];if(a.width>2){const g=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof g=="function")return r;c.push(...g);const f=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof f=="function")return r;c.push(...f)}else{const g=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof g=="function")return r;c.push(...g)}let u=a.x-n,b=a.x+a.width-1-n;for(const g of c)for(const f of g)f.span!==void 0&&(u=Math.min(f.span[0],u),b=Math.max(f.span[1],b));u===a.x-n&&b===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:a.y,width:b-u+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function Jo(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Gl(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push(Jo(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push(Jo(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function jl(e,t,n){var s;const o=ps(e,t),i=a=>{var c;(c=window.navigator.clipboard)==null||c.writeText(a)},r=(a,c)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([c],{type:"text/html"})})]),!0)},l=(a,c)=>{var u,b;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",a),(b=n==null?void 0:n.clipboardData)==null||b.setData("text/html",c)}catch{r(a,c)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function ws(e){return e!==!0}function Qo(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:c}=i,u=t.maxSize??r.checkboxMaxSize,b=Math.floor(i.y+s/2),g=ri(u,s,r.cellVerticalPadding),f=ii(t.contentAlign??"center",a,l,r.cellHorizontalPadding,g),d=oi(f,b,g),h=si(a+n,c+o,d);return lo(t)&&h}const ks={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:he.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>xs(e,e.cell.data,lo(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Qo(e)&&e.preventDefault()},onClick:e=>{if(Qo(e))return{...e.cell,data:ws(e.cell.data)}},onPaste:(e,t)=>{let n=Hn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=ro),n===t.data?void 0:{...t,data:n}}};function xs(e,t,n,o,i){if(!n&&t===Hn)return;const{ctx:r,hoverAmount:l,theme:s,rect:a,highlighted:c,hoverX:u,hoverY:b,cell:{contentAlign:g}}=e,{x:f,y:d,width:h,height:v}=a;let y=!1;if(i>0){let p=n?1-i+i*l:.4;if(t===Hn&&(p*=l),p===0)return;p<1&&(y=!0,r.globalAlpha=p)}Bn(r,s,t,f,d,h,v,c,u,b,o,g),y&&(r.globalAlpha=1)}const Ss=gt("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),Cs=()=>e=>e.targetX,Es=()=>e=>e.targetY,Ms=()=>e=>e.targetWidth,Is=()=>e=>e.targetHeight,Fs=()=>e=>e.targetY+10,Hs=()=>e=>Math.max(0,(e.targetHeight-28)/2),Ps=gt("div")({name:"DataGridOverlayEditorStyle",class:"d16c1ze1",propsAsIs:!1,vars:{"d16c1ze1-0":[Es(),"px"],"d16c1ze1-1":[Cs(),"px"],"d16c1ze1-2":[Ms(),"px"],"d16c1ze1-3":[Is(),"px"],"d16c1ze1-4":[Fs(),"px"],"d16c1ze1-5":[Hs(),"px"]}});function Bs(){const[e,t]=m.useState();return[e??void 0,t]}function As(){const[e,t]=Bs(),[n,o]=m.useState(0),[i,r]=m.useState(!0);m.useLayoutEffect(()=>{if(e===void 0||!("IntersectionObserver"in window))return;const s=new IntersectionObserver(a=>{a.length!==0&&r(a[0].isIntersecting)},{threshold:1});return s.observe(e),()=>s.disconnect()},[e]),m.useEffect(()=>{if(i||e===void 0)return;let s;const a=()=>{const{right:c}=e.getBoundingClientRect();o(u=>Math.min(u+window.innerWidth-c-10,0)),s=requestAnimationFrame(a)};return s=requestAnimationFrame(a),()=>{s!==void 0&&cancelAnimationFrame(s)}},[e,i]);const l=m.useMemo(()=>({transform:`translateX(${n}px)`}),[n]);return{ref:t,style:l}}const Zt=m.createContext({isGhostMode:!1,ghostValue:""}),Ds=e=>{const{target:t,content:n,onFinishEditing:o,forceEditMode:i,initialValue:r,imageEditorOverride:l,markdownDivCreateNode:s,highlight:a,className:c,theme:u,id:b,cell:g,bloom:f,portalElementRef:d,validateCell:h,getCellRenderer:v,provideEditor:y,isOutsideClick:p,customEventTarget:k,activation:I,ghostValue:H,isGhostMode:A}=e,[D,F]=m.useState(i?n:void 0),x=m.useRef(D??n);x.current=D??n;const[R,C]=m.useState(()=>h===void 0?!0:!(En(n)&&(h==null?void 0:h(g,n,x.current))===!1)),S=m.useCallback((q,le)=>{o(R?q:void 0,le)},[R,o]),M=m.useCallback(q=>{if(h!==void 0&&q!==void 0&&En(q)){const le=h(g,q,x.current);le===!1?C(!1):(typeof le=="object"&&(q=le),C(!0))}F(q)},[g,h]),E=m.useRef(!1),W=m.useRef(void 0),O=m.useCallback(()=>{S(D,[0,0]),E.current=!0},[D,S]),ee=m.useCallback((q,le)=>{console.log("[onEditorFinished] newValue:",q),console.log("[onEditorFinished] movement:",le),console.log("[onEditorFinished] calling onFinishEditing"),S(q,le??W.current??[0,0]),console.log("[onEditorFinished] onFinishEditing called"),E.current=!0},[S]),J=m.useCallback(async q=>{if(q.nativeEvent.isComposing)return;let le=!1;q.key==="Escape"?(q.stopPropagation(),q.preventDefault(),W.current=[0,0]):q.key==="Enter"&&!q.shiftKey?(q.stopPropagation(),q.preventDefault(),W.current=[0,1],le=!0):q.key==="Tab"&&(q.stopPropagation(),q.preventDefault(),W.current=[q.shiftKey?-1:1,0],le=!0),window.setTimeout(()=>{!E.current&&W.current!==void 0&&(S(le?D:void 0,W.current),E.current=!0)},0)},[S,D]),G=D??n,[Q,ge]=m.useMemo(()=>{var $e,qe;if(so(n))return[];const q={...n,location:g,activation:I},le=y==null?void 0:y(q);return le!==void 0?[le,!1]:[(qe=($e=v(n))==null?void 0:$e.provideEditor)==null?void 0:qe.call($e,q),!1]},[g,n,v,y,I]),{ref:ie,style:se}=As();let Se=!0,_,me=!0,ve;if(Q!==void 0){Se=Q.disablePadding!==!0,me=Q.disableStyling!==!0;const q=ur(Q);q&&(ve=Q.styleOverride);const le=q?Q.editor:Q;_=m.createElement(le,{portalElementRef:d,isHighlighted:a,activation:I,onChange:M,value:G,initialValue:r,onFinishedEditing:ee,validatedSelection:En(G)?G.selectionRange:void 0,forceEditMode:i,target:t,imageEditorOverride:l,markdownDivCreateNode:s,isValid:R,theme:u})}ve={...ve,...se};const z=(d==null?void 0:d.current)??document.getElementById("portal");if(z===null)return console.error('Cannot open Data Grid overlay editor, because portal not found. Please, either provide a portalElementRef or add `<div id="portal" />` as the last child of your `<body>`.'),null;let ce=me?"gdg-style":"gdg-unstyle";R||(ce+=" gdg-invalid"),Se&&(ce+=" gdg-pad");const j=(f==null?void 0:f[0])??1,de=(f==null?void 0:f[1])??1,Be=m.useMemo(()=>({isGhostMode:A??!1,ghostValue:H??""}),[A,H]);return lr.createPortal(m.createElement(pi.Provider,{value:u},m.createElement(Zt.Provider,{value:Be},m.createElement(hs,{style:Lr(u),className:c,onClickOutside:O,isOutsideClick:p,customEventTarget:k},m.createElement(Ps,{ref:ie,id:b,className:ce,style:A?{...ve,visibility:"hidden"}:ve,as:ge===!0?"label":void 0,targetX:t.x-j,targetY:t.y-de,targetWidth:t.width+j*2,targetHeight:t.height+de*2},m.createElement("div",{className:"gdg-clip-region",onKeyDown:J},_))))),z)},Kl=Object.freeze(Object.defineProperty({__proto__:null,GhostModeContext:Zt,default:Ds},Symbol.toStringTag,{value:"Module"})),Rs=e=>{const{bubbles:t}=e,{isGhostMode:n}=m.useContext(Zt);return m.createElement(Ss,null,t.map((o,i)=>m.createElement("div",{key:i,className:"boe-bubble"},o)),m.createElement("textarea",{className:"gdg-input",autoFocus:!n}))},Ts={getAccessibilityString:e=>li(e.data),kind:he.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((i,r)=>e.measureText(r).width+i+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Ws(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return m.createElement(Rs,{bubbles:t.data})},onPaste:()=>{}};function Ws(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:c}=n;let u=l+o.cellHorizontalPadding;const b=[];for(const g of t){if(u>l+a)break;const f=Xt(g,i,o.baseFontFull).width;b.push({x:u,width:f}),u+=f+o.bubblePadding*2+o.bubbleMargin}i.beginPath();for(const g of b)ht(i,g.x,s+(c-o.bubbleHeight)/2,g.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[g,f]of b.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[g],f.x+o.bubblePadding,s+c/2+nt(i,o))}const Os=gt("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),zs=e=>{const{drilldowns:t}=e;return m.createElement(Os,null,t.map((n,o)=>m.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&m.createElement("img",{src:n.img}),m.createElement("div",null,n.text))))},Ls={getAccessibilityString:e=>li(e.data.map(t=>t.text)),kind:he.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+n.bubblePadding*2+n.bubbleMargin+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Xs(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return m.createElement(zs,{drilldowns:t.data})},onPaste:()=>{}},Un={};function Ns(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,c=o+r,u=o*3,b=(u+r*2)*i,g=`${e},${t},${i},${n}`;if(Un[g]!==void 0)return{el:Un[g],height:a,width:b,middleWidth:s*i,sideWidth:c*i,padding:r*i,dpr:i};const f=document.createElement("canvas"),d=f.getContext("2d");return d===null?null:(f.width=b,f.height=a,d.scale(i,i),Un[g]=f,d.beginPath(),ht(d,r,r,u,l,o),d.shadowColor="rgba(24, 25, 34, 0.4)",d.shadowBlur=1,d.fillStyle=e,d.fill(),d.shadowColor="rgba(24, 25, 34, 0.3)",d.shadowOffsetY=1,d.shadowBlur=5,d.fillStyle=e,d.fill(),d.shadowOffsetY=0,d.shadowBlur=0,d.shadowBlur=0,d.beginPath(),ht(d,r+.5,r+.5,u,l,o),d.strokeStyle=t,d.lineWidth=1,d.stroke(),{el:f,height:a,width:b,sideWidth:c*i,middleWidth:o*i,padding:r*i,dpr:i})}function Xs(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:c}=n,u=o.baseFontFull,b=hi(i,u),g=Math.min(n.height,Math.max(16,Math.ceil(b*o.lineHeight)*2)),f=Math.floor(n.y+(n.height-g)/2),d=g-10,h=o.bubblePadding,v=o.bubbleMargin;let y=a+o.cellHorizontalPadding;const p=o.roundingRadius??6,k=Ns(o.bgCell,o.drilldownBorder,g,p),I=[];for(const H of t){if(y>a+c)break;const D=Xt(H.text,i,u).width;let F=0;H.img!==void 0&&r.loadOrGetImage(H.img,l,s)!==void 0&&(F=d-8+4);const x=D+F+h*2;I.push({x:y,width:x}),y+=x+v}if(k!==null){const{el:H,height:A,middleWidth:D,sideWidth:F,width:x,dpr:R,padding:C}=k,S=F/R,M=C/R;for(const E of I){const W=Math.floor(E.x),O=Math.floor(E.width),ee=O-(S-M)*2;i.imageSmoothingEnabled=!1,i.drawImage(H,0,0,F,A,W-M,f,S,g),ee>0&&i.drawImage(H,F,0,D,A,W+(S-M),f,ee,g),i.drawImage(H,x-F,0,F,A,W+O-(S-M),f,S,g),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[H,A]of I.entries()){const D=t[H];let F=A.x+h;if(D.img!==void 0){const x=r.loadOrGetImage(D.img,l,s);if(x!==void 0){const R=d-8;let C=0,S=0,M=x.width,E=x.height;M>E?(C+=(M-E)/2,M=E):E>M&&(S+=(E-M)/2,E=M),i.beginPath(),ht(i,F,f+g/2-R/2,R,R,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(x,C,S,M,E,F,f+g/2-R/2,R,R),i.restore(),F+=R+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(D.text,F,f+g/2+nt(i,o))}}const Ys=gt("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),$s=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return m.createElement(Ys,{"data-testid":"GDG-default-image-overlay-editor"},m.createElement(ir.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},r.map(s=>{const a=(i==null?void 0:i(s))??m.createElement("img",{draggable:!1,src:s});return m.createElement("div",{className:"gdg-centering-container",key:s},a)})),n&&o&&m.createElement("button",{className:"gdg-edit-icon",onClick:o},m.createElement(ao,null)))},_s={getAccessibilityString:e=>e.data.join(", "),kind:he.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>Vs(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??$s;return m.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},Gn=4;function Vs(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:c}=e,{x:u,y:b,height:g,width:f}=i,d=g-s.cellVerticalPadding*2,h=[];let v=0;for(let p=0;p<t.length;p++){const k=t[p];if(k.length===0)continue;const I=c.loadOrGetImage(k,r,l);if(I!==void 0){h[p]=I;const H=I.width*(d/I.height);v+=H+Gn}}if(v===0)return;v-=Gn;let y=u+s.cellHorizontalPadding;o==="right"?y=Math.floor(u+f-s.cellHorizontalPadding-v):o==="center"&&(y=Math.floor(u+f/2-v/2));for(const p of h){if(p===void 0)continue;const k=p.width*(d/p.height);n>0&&(a.beginPath(),ht(a,y,b+s.cellVerticalPadding,k,d,n),a.save(),a.clip()),a.drawImage(p,y,b+s.cellVerticalPadding,k,d),n>0&&a.restore(),y+=k+Gn}}function qs(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const Us={getAccessibilityString:()=>"",kind:he.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(qs(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding;s+a*2>=r.width&&(s=r.width-a*2-1);const c=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);ht(i,r.x+a,r.y+(r.height-c)/2,s,c,l.roundingRadius??3),i.fillStyle=Qt(l.textDark,.1),i.fill()},onPaste:()=>{}},Gs=gt("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class js extends un.PureComponent{constructor(){super(...arguments);Z(this,"targetElement",null);Z(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=sr(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const u=document.createElement("template");u.innerHTML=l,a=u.content}n.append(a);const c=n.getElementsByTagName("a");for(const u of c)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),un.createElement(Gs,{ref:this.containerRefHook})}}const Ks=gt("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Js=gt("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Qs=gt("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let Zo=0;const bo=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,autoFocus:s,...a}=e,{onChange:c,className:u}=a,b=m.useRef(null),{isGhostMode:g,ghostValue:f}=m.useContext(Zt),d=g&&f?f:n??"";pt(c!==void 0,"GrowingEntry must be a controlled input area");const[h]=m.useState(()=>"input-box-"+(Zo=(Zo+1)%1e7));m.useEffect(()=>{if(g)return;const p=b.current;if(p===null||p.disabled)return;const k=d.toString().length;p.focus(),p.setSelectionRange(i?0:k,k)},[g]),m.useLayoutEffect(()=>{var p;if(l!==void 0){const k=typeof l=="number"?[l,null]:l;(p=b.current)==null||p.setSelectionRange(k[0],k[1])}},[l]);const v=m.useCallback(p=>{p.key==="Enter"&&p.shiftKey&&r===!0||o==null||o(p)},[r,o]),y=g?{visibility:"hidden"}:void 0;return m.createElement(Qs,{className:"gdg-growing-entry"},m.createElement(Js,{className:u},d+`
`),m.createElement(Ks,{...a,className:(u??"")+" gdg-input",id:h,ref:b,onKeyDown:v,value:d,placeholder:t,dir:"auto",style:y}))},Zs=()=>e=>e.targetWidth,ei=gt("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Zs(),"px"]}}),el=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,{isGhostMode:a}=m.useContext(Zt),c=t.data,u=t.readonly===!0,[b,g]=m.useState(c===""||o),f=m.useCallback(()=>{g(h=>!h)},[]),d=c?"gdg-ml-6":"";return b?m.createElement(ei,{targetWidth:r.width-20},m.createElement(bo,{autoFocus:!a,highlight:!1,validatedSelection:s,value:c,onKeyDown:h=>{h.key==="Enter"&&h.stopPropagation()},onChange:n}),m.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${d}`,onClick:()=>l(t)},m.createElement(hr,null))):m.createElement(ei,{targetWidth:r.width},m.createElement(js,{contents:c,createNode:i}),!u&&m.createElement(m.Fragment,null,m.createElement("div",{className:"spacer"}),m.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${d}`,onClick:f},m.createElement(ao,null))),m.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!a}))},tl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:he.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:An,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Et(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return m.createElement(el,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},nl={getAccessibilityString:e=>e.row.toString(),kind:Mt.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:ol,measure:()=>44,draw:e=>rl(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e;if(n.disabled===!0)return;const{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function ol(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=il,n.textAlign="center",r}function il(e){const{ctx:t}=e;t.textAlign="start"}function rl(e,t,n,o,i,r,l){if(l){const{ctx:v,rect:y,theme:p}=e,{x:k,y:I,width:H,height:A}=y,D=o==="checkbox"?"checkbox-visible":o;if(D!=="number"&&(v.globalAlpha=n?1:.4,Bn(v,p,n,i?k+7:k,I,i?H-7:H,A,!1,-20,-20,p.checkboxMaxSize,"center",r,!0),v.globalAlpha=1),D==="number"||D==="both"&&!n){const F=t.toString(),x=p.markerFontFull,R=k+H/2;v.fillStyle="#cccccc",v.font=x,v.fillText(F,R,I+A/2+nt(v,x))}if(i){v.globalAlpha=.4,v.beginPath();for(const F of[3,6])for(const x of[-5,-1,3])v.rect(k+F,I+A/2+x,2,2);v.fillStyle="#cccccc",v.fill(),v.beginPath(),v.globalAlpha=1}return}const{ctx:s,rect:a,hoverAmount:c,theme:u}=e,{x:b,y:g,width:f,height:d}=a,h=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&h>0){s.globalAlpha=h;const v=7*(n?c:1);if(Bn(s,u,n,i?b+v:b,g,i?f-v:f,d,!0,void 0,void 0,u.checkboxMaxSize,"center",r,l),i){s.globalAlpha=c,s.beginPath();for(const y of[3,6])for(const p of[-5,-1,3])s.rect(b+y,g+d/2+p,2,2);s.fillStyle=u.textLight,s.fill(),s.beginPath()}s.globalAlpha=1}if(o==="number"||o==="both"&&!n){const v=t.toString(),y=u.markerFontFull,p=b+f/2;o==="both"&&c!==0&&(s.globalAlpha=1-c),s.fillStyle=u.textLight,s.font=y,s.fillText(v,p,g+d/2+nt(s,y)),c!==0&&(s.globalAlpha=1)}}const sl={getAccessibilityString:()=>"",kind:Mt.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>ll(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function ll(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:c,width:u,height:b}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,c+1,u,b-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const g=t!=="";let f=0;if(n!==void 0){const h=b-8,v=a+8/2,y=c+8/2;s.drawSprite(n,"normal",o,v,y,h,l,g?1:r),f=h}else{f=24;const d=12,h=g?d:r*d,v=g?0:(1-r)*d*.5,y=l.cellHorizontalPadding+4;h>0&&(o.moveTo(a+y+v,c+b/2),o.lineTo(a+y+v+h,c+b/2),o.moveTo(a+y+v+h*.5,c+b/2-h*.5),o.lineTo(a+y+v+h*.5,c+b/2+h*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,f+a+l.cellHorizontalPadding+.5,c+b/2+nt(o,l)),o.beginPath()}function Ci(e,t,n,o,i,r,l){e.textBaseline="alphabetic";const s=al(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),ht(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??Qt(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function al(e,t,n,o,i){const r=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+l/2+1,width:t.width-r,height:t.height-l-1};const s=Xt(n,e,o.baseFontFull,"alphabetic"),a=t.height-l,c=Math.min(a,s.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-c)/2+1,width:s.width+r*3,height:c-1}}const cl=m.lazy(async()=>await ar(()=>import("./number-overlay-editor-C_JOTlX8.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),dl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:he.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:An,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:l}=e,{hoverEffect:s,displayData:a,hoverEffectTheme:c}=n;s===!0&&t>0&&Ci(o,i,c,a,r,t,l),Et(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,onFinishedEditing:o,value:i,validatedSelection:r}=e;return m.createElement(m.Suspense,{fallback:null},m.createElement(cl,{highlight:t,disabled:i.readonly===!0,value:i.data,fixedDecimals:i.fixedDecimals,allowNegative:i.allowNegative,thousandSeparator:i.thousandSeparator,decimalSeparator:i.decimalSeparator,validatedSelection:r,onChange:l=>n({...i,data:Number.isNaN(l.floatValue??0)?0:l.floatValue}),onKeyDown:l=>{l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),o(i,[0,1])):l.key==="Tab"?(l.preventDefault(),o(i,[l.shiftKey?-1:1,0])):l.key==="Escape"&&(l.preventDefault(),o(void 0,[0,0]))}}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},ul={getAccessibilityString:()=>"",measure:()=>108,kind:he.Protected,needsHover:!1,needsHoverPosition:!1,draw:fl,onPaste:()=>{}};function fl(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const c=r+l/2,u=Math.cos(Ro(30))*s,b=Math.sin(Ro(30))*s;for(let g=0;g<12;g++)t.moveTo(a,c-s),t.lineTo(a,c+s),t.moveTo(a+u,c-b),t.lineTo(a-u,c+b),t.moveTo(a-u,c-b),t.lineTo(a+u,c+b),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const hl={getAccessibilityString:e=>e.rowId??"",kind:Mt.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>Xt(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:i}=e,r=o.rowId;if(!r)return;t.fillStyle=i.textDark,t.font=i.baseFontStyle,t.textAlign="left";const l=n.x+i.cellHorizontalPadding,s=n.y+n.height/2;t.fillText(r,l,s+nt(t,i))},onClick:()=>{},onPaste:()=>{}},gl={getAccessibilityString:e=>e.rowId??"",kind:Mt.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:ml,measure:()=>80,draw:e=>vl(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function ml(e,t){const{ctx:n}=e,o="12px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=bl,n.textAlign="left",i}function bl(e){const{ctx:t}=e;t.textAlign="start"}function vl(e,t){if(!t)return;const{ctx:n,rect:o,theme:i}=e,{x:r,y:l,height:s}=o;n.fillStyle=i.textDark,n.font="12px sans-serif";const a=r+8,c=l+s/2;n.fillText(t,a,c+nt(n,n.font))}const yl={getAccessibilityString:e=>e.status??"",kind:Mt.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:pl,measure:()=>40,draw:e=>kl(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function pl(e,t){const{ctx:n}=e,o="bold 14px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=wl,n.textAlign="center",i}function wl(e){const{ctx:t}=e;t.textAlign="start"}function kl(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:i,y:r,width:l,height:s}=o,a={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=a[t],n.font="bold 14px sans-serif";const c=i+l/2,u=r+s/2;n.fillText(t,c,u+nt(n,n.font))}const xl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:he.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:An,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:c,hoverEffect:u,allowWrapping:b,hoverEffectTheme:g}=t;u===!0&&n>0&&Ci(i,l,g,a,r,n,s),Et(e,a,c,b,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return m.createElement(bo,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Sl=gt("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),Cl=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,{isGhostMode:s}=m.useContext(Zt),[a,c]=m.useState(!i&&(t===""||o)),u=m.useCallback(()=>{c(!0)},[]);return a?m.createElement(bo,{validatedSelection:r,highlight:!0,autoFocus:!s,value:t,onChange:n}):m.createElement(Sl,null,m.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!i&&m.createElement("div",{className:"gdg-edit-icon",onClick:u},m.createElement(ao,null)),m.createElement("textarea",{className:"gdg-input",autoFocus:!s}))};function Ei(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}function ti(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=ui(l,r.baseFontFull);if(s===void 0)return!1;const a=Ei(s,n,r,t.contentAlign);return zt({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)}const El={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:he.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:An,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,c=t.hoverEffect===!0;if(o!==void 0&&c&&i!==void 0&&r!==void 0){const u=Xt(a,s,n.baseFontFull),b=Ei(u,l,n,t.contentAlign),{x:g,y:f,width:d,height:h}=b;if(i>=g-4&&i<=g-4+d+8&&r>=f-4&&r<=f-4+h+8){const v=nt(s,n.baseFontFull);o("pointer");const y=5,p=f-v;s.beginPath(),s.moveTo(l.x+g,Math.floor(l.y+p+h+y)+.5),s.lineTo(l.x+g+d,Math.floor(l.y+p+h+y)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,Et({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),Et({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),Et({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),Et({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=c?n.linkColor:n.textDark,Et(e,a,t.contentAlign)},onSelect:e=>{ti(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;ti(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return m.createElement(Cl,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Jl=[nl,sl,yl,gl,ks,Ts,Ls,_s,Us,tl,dl,ul,hl,xl,El],jn=[];class Ql extends mi{constructor(){super(...arguments);Z(this,"imageLoaded",()=>{});Z(this,"loadedLocations",[]);Z(this,"cache",{});Z(this,"sendLoaded",rr(()=>{this.imageLoaded(new Gt(this.loadedLocations)),this.loadedLocations=[]},20));Z(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=jn.pop()??new Image;let a=!1;const c={img:void 0,cells:[at(o,i)],url:n,cancel:()=>{a||(a=!0,jn.length<12?jn.unshift(s):l||(s.src=""))}},u=new Promise(b=>s.addEventListener("load",()=>b(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const b=this.cache[r];if(b!==void 0&&!a){b.img=s;for(const g of b.cells)this.loadedLocations.push(ho(g));l=!0,this.sendLoaded()}}catch{c.cancel()}}),this.cache[r]=c}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=at(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}export{Kl as $,Jl as A,Zn as B,Jn as C,pr as D,Ul as E,Nt as F,he as G,Qt as H,Mt as I,zt as J,Dl as K,Jt as L,Go as M,ds as N,$l as O,io as P,ur as Q,Nl as R,To as S,Lr as T,pi as U,Ql as V,Vl as W,Uo as X,as as Y,Wl as Z,Zt as _,cr as a,ft as b,Lt as c,pt as d,hs as e,Rl as f,Xl as g,_l as h,En as i,dr as j,ql as k,Gl as l,nl as m,so as n,jl as o,Ll as p,zl as q,Tl as r,an as s,ws as t,Yl as u,kr as v,Ol as w,Nr as x,Mn as y,Ot as z};
