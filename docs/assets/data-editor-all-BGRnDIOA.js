const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./image-window-loader-DNV8iqrv.js","./iframe-DXOPYGgQ.js","./preload-helper-C1FmrZbK.js","./throttle-BQcim7ej.js","./index-bI8WdHuM.js","./index-ngu0pMN8.js","./marked.esm-CZUX9RwD.js","./marked-FY3qVesh.css","./image-window-loader-Bm61kU6i.css"])))=>i.map(i=>d[i]);
import{r as c,R as Qe}from"./iframe-DXOPYGgQ.js";import{_ as fi}from"./preload-helper-C1FmrZbK.js";import{r as hi}from"./index-ngu0pMN8.js";import{G as Z,d as ko,e as gi,f as So,r as nr,h as Eo,j as Ht,C as Se,t as fr,b as ln,k as rr,l as vi,n as To,i as Qt,o as lr,g as hr,p as mi,w as Rt,q as pi,s as Bt,v as wi,x as Ci,y as yi,z as bi,B as xi,D as Ri,E as sn,F as ir,H as Si,I as Mi,T as ki,J as Ti,K as Ei,L as Ii,M as zi,N as sr,O as Dt,P as Di,Q as Li,R as Hi,S as Fi,U as cr,A as $i,V as Gi}from"./image-window-loader-DNV8iqrv.js";import{r as Ut,d as Ki,c as Lt}from"./throttle-BQcim7ej.js";import{u as Pi,f as ar}from"./flatten-B5nYkQZa.js";import{G as Ni}from"./scrolling-data-grid-DzF-1NV7.js";import{s as Io}from"./index-bI8WdHuM.js";const ze='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Wi=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}<rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},Vi=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}<rect x="2" y="2" width="16" height="16" rx="4" fill="${r}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},Oi=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},Ai=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},Bi=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${r}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},gr=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},Ui=e=>{const o=e.bgColor;return`${ze}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Xi=gr,_i=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},Yi=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},qi=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Zi=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${r}"/>
  </svg>`},Ji=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},Qi=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},ji=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},es=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},ts=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${r}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${r}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},os=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${r}"/>
</svg>`},ns=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},rs=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},ls=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},is=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},ss=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${r}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},cs=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},as=e=>{const o=e.fgColor,r=e.bgColor;return`
    ${ze}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},us=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${r}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},ds=e=>{const o=e.fgColor,r=e.bgColor;return`${ze}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${r}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},fs=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},hs=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},gs=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
 <g transform="scale(0.833) translate(2, 2)">
    <path d="M8 18L12 22L16 18"/>
    <path d="M12 2V22"/>
  </g>
</svg>
  `),vs=e=>(e.fgColor,`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e.bgColor}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" >
  <g transform="scale(0.833) translate(-4, 2)">
    <path d="M8 6L12 2L16 6"/>
    <path d="M12 2V22"/>
  </g>
</svg>
`),ms={headerRowID:Wi,headerNumber:Oi,headerCode:Vi,headerString:Ai,headerBoolean:Bi,headerAudioUri:Xi,headerVideoUri:_i,headerEmoji:Yi,headerImage:qi,headerUri:gr,headerPhone:Zi,headerMarkdown:Ji,headerDate:Qi,headerTime:ji,headerEmail:es,headerReference:ts,headerIfThenElse:os,headerSingleValue:ns,headerLookup:rs,headerTextTemplate:ls,headerMath:is,headerRollup:ss,headerJoinStrings:cs,headerSplitString:as,headerGeoDistance:us,headerArray:ds,rowOwnerOverlay:fs,protectedColumnOverlay:hs,renameIcon:Ui,headerArrowDown:gs,headerArrowUp:vs},ps=Io("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),ws=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Cs=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),ys=c.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},c.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),bs=10,xs=e=>{const{canvasRef:o,cellYOffset:r,rows:i,columns:f,searchInputRef:v,searchValue:z,searchResults:h,onSearchValueChange:C,getCellsForSelection:T,onSearchResultsChanged:s,showSearch:d=!1,onSearchClose:w}=e,[M]=c.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[P,H]=c.useState(""),se=z??P,Me=c.useCallback(x=>{H(x),C==null||C(x)},[C]),[X,I]=c.useState(),ne=c.useRef(X);ne.current=X,c.useEffect(()=>{h!==void 0&&(h.length>0?I(x=>({rowsSearched:i,results:h.length,selectedIndex:(x==null?void 0:x.selectedIndex)??-1})):I(void 0))},[i,h]);const S=c.useRef();S.current===void 0&&(S.current=new AbortController);const O=c.useRef(),[F,A]=c.useState([]),oe=h??F,$=c.useCallback(()=>{O.current!==void 0&&(window.cancelAnimationFrame(O.current),O.current=void 0),S.current!==void 0&&S.current.abort(),S.current=new AbortController},[]),le=c.useRef(r);le.current=r;const B=c.useCallback(x=>{const Y=new RegExp(x.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let Re=le.current,De=Math.min(10,i),Ge=0;I(void 0),A([]);const be=[],g=async()=>{var Ze;if(T===void 0)return;const fe=performance.now(),E=i-Ge;let me=T({x:0,y:Re,width:f.length,height:Math.min(De,E,i-Re)},S.current.signal);typeof me=="function"&&(me=await me());let Le=!1;for(const[St,Xt]of me.entries())for(const[p,we]of Xt.entries()){let W;switch(we.kind){case Z.Text:case Z.Number:W=we.displayData;break;case Z.Uri:case Z.Markdown:W=we.data;break;case Z.Boolean:W=typeof we.data=="boolean"?we.data.toString():void 0;break;case Z.Image:case Z.Bubble:W=we.data.join("üê≥");break;case Z.Custom:W=we.copyData;break}W!==void 0&&Y.test(W)&&(be.push([p,St+Re]),Le=!0)}const Ue=performance.now();Le&&A([...be]),Ge+=me.length,ko(Ge<=i);const N=((Ze=ne.current)==null?void 0:Ze.selectedIndex)??-1;I({results:be.length,rowsSearched:Ge,selectedIndex:N}),s==null||s(be,N),Re+De>=i?Re=0:Re+=De;const re=Ue-fe,q=Math.max(re,1),ct=bs/q;De=Math.ceil(De*ct),Ge<i&&be.length<1e3&&(O.current=window.requestAnimationFrame(g))};$(),O.current=window.requestAnimationFrame(g)},[$,f.length,T,s,i]),ce=c.useCallback(()=>{var x;w==null||w(),I(void 0),A([]),s==null||s([],-1),$(),(x=o==null?void 0:o.current)==null||x.focus()},[$,o,w,s]),G=c.useCallback(x=>{Me(x.target.value),h===void 0&&(x.target.value===""?(I(void 0),A([]),$()):B(x.target.value))},[B,$,Me,h]);c.useEffect(()=>{v.current!==null&&(Me(""),I(void 0),F.length>0&&(A([]),s==null||s([],-1)),d?v.current.focus({preventScroll:!0}):$())},[d,v]);const k=c.useCallback(x=>{var Re;if((Re=x==null?void 0:x.stopPropagation)==null||Re.call(x),X===void 0||X.results===0)return;const Y=(X.selectedIndex+1)%X.results;I({...X,selectedIndex:Y}),s==null||s(oe,Y)},[X,s,oe]),Ke=c.useCallback(x=>{var Re;if((Re=x==null?void 0:x.stopPropagation)==null||Re.call(x),X===void 0||X.results===0)return;let Y=(X.selectedIndex-1)%X.results;Y<0&&(Y+=X.results),I({...X,selectedIndex:Y}),s==null||s(oe,Y)},[s,oe,X]),ye=c.useCallback(x=>{(x.ctrlKey||x.metaKey)&&x.nativeEvent.code==="KeyF"||x.key==="Escape"?(ce(),x.stopPropagation(),x.preventDefault()):x.key==="Enter"&&(x.shiftKey?Ke():k())},[ce,k,Ke]);c.useEffect(()=>()=>{$()},[$]);const[ve,V]=c.useState(!1);c.useEffect(()=>{if(d)V(!0);else{const x=setTimeout(()=>V(!1),150);return()=>clearTimeout(x)}},[d]);const ie=c.useMemo(()=>{if(!d&&!ve)return null;let x;X!==void 0&&(x=X.results>=1e3?"over 1000":`${X.results} result${X.results!==1?"s":""}`,X.selectedIndex>=0&&(x=`${X.selectedIndex+1} of ${x}`));const Y=Ge=>{Ge.stopPropagation()},De={width:`${i>0?Math.floor(((X==null?void 0:X.rowsSearched)??0)/i*100):0}%`};return c.createElement(ps,{className:"gdg-search-bar"+(d?"":" out"),onMouseDown:Y,onMouseMove:Y,onMouseUp:Y,onClick:Y},c.createElement("div",{className:"gdg-search-bar-inner"},c.createElement("input",{id:M,"aria-hidden":!d,"data-testid":"search-input",ref:v,onChange:G,value:se,tabIndex:d?void 0:-1,onKeyDownCapture:ye}),c.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!d,tabIndex:d?void 0:-1,onClick:Ke,disabled:((X==null?void 0:X.results)??0)===0},ws),c.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!d,tabIndex:d?void 0:-1,onClick:k,disabled:((X==null?void 0:X.results)??0)===0},Cs),w!==void 0&&c.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!d,"data-testid":"search-close-button",tabIndex:d?void 0:-1,onClick:ce},ys)),X!==void 0?c.createElement(c.Fragment,null,c.createElement("div",{className:"gdg-search-status"},c.createElement("div",{"data-testid":"search-result-area"},x)),c.createElement("div",{className:"gdg-search-progress",style:De})):c.createElement("div",{className:"gdg-search-status"},c.createElement("label",{htmlFor:M},"Type to search")))},[d,ve,X,i,M,v,G,se,ye,Ke,k,w,ce]);return c.createElement(c.Fragment,null,c.createElement(Ni,{prelightCells:oe,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,groupLevels:e.groupLevels,groupHeaderHeights:e.groupHeaderHeights,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),ie)},Rs=()=>e=>Math.max(16,e.targetHeight-10),Ss=Io("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[Rs(),"px"]}}),Ms=e=>{const{bounds:o,group:r,onClose:i,canvasBounds:f,onFinish:v}=e,[z,h]=Qe.useState(r);return Qe.createElement(gi,{style:{position:"absolute",left:o.x-f.left+1,top:o.y-f.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:i},Qe.createElement(Ss,{targetHeight:o.height,"data-testid":"group-rename-input",value:z,onBlur:i,onFocus:C=>C.target.setSelectionRange(0,z.length),onChange:C=>h(C.target.value),onKeyDown:C=>{C.key==="Enter"?v(z):C.key==="Escape"&&i()},autoFocus:!0}))},an=150;function ks(e,o,r,i){var v;const f=i(o);return((v=f==null?void 0:f.measure)==null?void 0:v.call(f,e,o,r))??an}function vr(e,o,r,i,f,v,z,h,C){let T=0;const s=f===void 0?[]:f.map(M=>{const P=ks(e,M[i],o,C);return T=Math.max(T,P),P});if(s.length>5&&h){T=0;let M=0;for(const H of s)M+=H;const P=M/s.length;for(let H=0;H<s.length;H++)s[H]>=P*2?s[H]=0:T=Math.max(T,s[H])}const d=e.font;e.font=o.headerFontFull,T=Math.max(T,e.measureText(r.title).width+o.cellHorizontalPadding*2+(r.icon===void 0?0:28)),e.font=d;const w=Math.max(Math.ceil(v),Math.min(Math.floor(z),Math.ceil(T)));return{...r,width:w}}function Ts(e,o,r,i,f,v,z,h,C){const T=c.useRef(o),s=c.useRef(r),d=c.useRef(z);T.current=o,s.current=r,d.current=z;const[w,M]=(()=>{if(typeof window>"u")return[null,null];const F=document.createElement("canvas");return F.style.display="none",F.style.opacity="0",F.style.position="fixed",[F,F.getContext("2d",{alpha:!1})]})();c.useLayoutEffect(()=>(w&&document.documentElement.append(w),()=>{w==null||w.remove()}),[w]);const P=c.useRef({}),H=c.useRef(),[se,Me]=c.useState();c.useLayoutEffect(()=>{const F=s.current;if(F===void 0||e.every(So))return;let A=Math.max(1,10-Math.floor(e.length/1e4)),oe=0;A<T.current&&A>1&&(A--,oe=1);const $={x:0,y:0,width:e.length,height:Math.min(T.current,A)},le={x:0,y:T.current-1,width:e.length,height:1};(async()=>{const ce=F($,C.signal),G=oe>0?F(le,C.signal):void 0;let k;typeof ce=="object"?k=ce:k=await nr(ce),G!==void 0&&(typeof G=="object"?k=[...k,...G]:k=[...k,...await nr(G)]),H.current=e,Me(k)})()},[C.signal,e]);let I=e.every(So)?e:M===null?e.map(F=>So(F)?F:{...F,width:an}):(M.font=d.current.baseFontFull,e.map((F,A)=>{if(So(F))return F;if(P.current[F.id]!==void 0)return{...F,width:P.current[F.id]};if(se===void 0||H.current!==e||F.id===void 0)return{...F,width:an};const oe=vr(M,z,F,A,se,f,v,!0,h);return P.current[F.id]=oe.width,oe})),ne=0,S=0;const O=[];for(const[F,A]of I.entries())ne+=A.width,A.grow!==void 0&&A.grow>0&&(S+=A.grow,O.push(F));if(ne<i&&O.length>0){const F=[...I],A=i-ne;let oe=A;for(let $=0;$<O.length;$++){const le=O[$],B=(I[le].grow??0)/S,ce=$===O.length-1?oe:Math.min(oe,Math.floor(A*B));F[le]={...I[le],growOffset:ce,width:I[le].width+ce},oe-=ce}I=F}return{sizedColumns:I,nonGrowWidth:ne}}function Es(e,o){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===o.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===o.keyCode:e===o.key}function ee(e,o,r){const i=mr(e,o);return i&&(r.didMatch=!0),i}function mr(e,o){if(e.length===0)return!1;if(e.includes("|")){const C=e.split("|");for(const T of C)if(mr(T,o))return!0;return!1}let r=!1,i=!1,f=!1,v=!1;const z=e.split("+"),h=z.pop();if(!Es(h,o))return!1;if(z[0]==="any")return!0;for(const C of z)switch(C){case"ctrl":r=!0;break;case"shift":i=!0;break;case"alt":f=!0;break;case"meta":v=!0;break;case"primary":Eo.value?v=!0:r=!0;break}return o.altKey===f&&o.ctrlKey===r&&o.shiftKey===i&&o.metaKey===v}function Is(e){const{state:o,keybindings:r,overlayOpen:i,columnSelect:f,rowSelect:v,rangeSelect:z,editOnType:h,trapFocus:C,showTrailingBlankRow:T,columnsInLength:s,rowGroupingNavBehavior:d,mapper:w,onKeyDownIn:M,onSelectionCleared:P,onCellActivated:H,onDelete:se,getCellContent:Me,setSelectedColumns:X,setSelectedRows:I,setShowSearchInner:ne,searchInputRef:S,adjustSelection:O,updateSelectedCell:F,deleteRange:A,fillDown:oe,fillRight:$,appendRow:le,getCustomNewRowTargetColumn:B,scrollToRef:ce}=e,{gridSelection:G,gridRef:k,visibleRegionRef:Ke,rowMarkerOffset:ye,rows:ve,setGridSelection:V,getMangledCellContent:ie,mangledOnCellsEdited:x,setOverlay:Y,reselect:Re,focus:De}=o,Ge=g=>{var W,de,Ie,Ae;const fe=()=>{g.stopPropagation(),g.preventDefault()},E={didMatch:!1},{bounds:me}=g,Le=G.columns,Ue=G.rows,N=r;if(!i&&ee(N.clear,g,E)){const j=((W=G.current)==null?void 0:W.cell)??[ye,0];V({columns:Se.empty(),rows:Se.empty(),current:{cell:j,range:{x:j[0],y:j[1],width:1,height:1},rangeStack:[]}},!1),P==null||P(),De()}else if(!i&&ee(N.selectAll,g,E))V({columns:Se.empty(),rows:Se.empty(),current:{cell:((de=G.current)==null?void 0:de.cell)??[ye,0],range:{x:ye,y:0,width:s,height:ve},rangeStack:[]}},!1);else if(ee(N.search,g,E))(Ie=S==null?void 0:S.current)==null||Ie.focus({preventScroll:!0}),ne(!0);else if(ee(N.delete,g,E)){const j=(se==null?void 0:se(G))??!0;if(j!==!1){const J=j===!0?G:j;if(J.current!==void 0){A(J.current.range);for(const Oe of J.current.rangeStack)A(Oe)}for(const Oe of J.rows)A({x:ye,y:Oe,width:s,height:1});for(const Oe of J.columns)A({x:Oe,y:0,width:1,height:ve})}}if(E.didMatch)return fe(),!0;if(G.current===void 0)return!1;let[re,q]=G.current.cell;const[,ct]=G.current.cell;let Ze=!1,St=!1;if(ee(N.scrollToSelectedCell,g,E))ce.current(re-ye,q);else if(f!=="none"&&ee(N.selectColumn,g,E))Le.hasIndex(re)?X(Le.remove(re),void 0,!0):f==="single"?X(Se.fromSingleSelection(re),void 0,!0):X(void 0,re,!0);else if(v!=="none"&&ee(N.selectRow,g,E))Ue.hasIndex(q)?I(Ue.remove(q),void 0,!0):v==="single"?I(Se.fromSingleSelection(q),void 0,!0):I(void 0,q,!0);else if(!i&&me!==void 0&&ee(N.activateCell,g,E))if(q===ve&&T)window.setTimeout(()=>{const j=B(re);le(j??re)},0);else{const j={inputType:"keyboard",key:g.key},J=ie([re,q]);J.kind===Z.Boolean&&J.readonly!==!0?(H==null||H([re-ye,q],j),x([{location:[re,q],value:{...J,data:fr(J.data)}}]),(Ae=k.current)==null||Ae.damage([{cell:[re,q]}])):(H==null||H([re-ye,q],j),Re(me,j))}else G.current.range.height>1&&ee(N.downFill,g,E)?oe():G.current.range.width>1&&ee(N.rightFill,g,E)?$():ee(N.goToNextPage,g,E)?q+=Math.max(1,Ke.current.height-4):ee(N.goToPreviousPage,g,E)?q-=Math.max(1,Ke.current.height-4):ee(N.goToFirstCell,g,E)?(Y(void 0),q=0,re=0):ee(N.goToLastCell,g,E)?(Y(void 0),q=Number.MAX_SAFE_INTEGER,re=Number.MAX_SAFE_INTEGER):ee(N.selectToFirstCell,g,E)?(Y(void 0),O([-2,-2])):ee(N.selectToLastCell,g,E)?(Y(void 0),O([2,2])):i?(ee(N.closeOverlay,g,E)&&Y(void 0),ee(N.acceptOverlayDown,g,E)&&(Y(void 0),q++),ee(N.acceptOverlayUp,g,E)&&(Y(void 0),q--),ee(N.acceptOverlayLeft,g,E)&&(Y(void 0),re--),ee(N.acceptOverlayRight,g,E)&&(Y(void 0),re++)):(ee(N.goDownCell,g,E)?q+=1:ee(N.goUpCell,g,E)?q-=1:ee(N.goRightCell,g,E)?re+=1:ee(N.goLeftCell,g,E)?re-=1:ee(N.goDownCellRetainSelection,g,E)?(q+=1,Ze=!0):ee(N.goUpCellRetainSelection,g,E)?(q-=1,Ze=!0):ee(N.goRightCellRetainSelection,g,E)?(re+=1,Ze=!0):ee(N.goLeftCellRetainSelection,g,E)?(re-=1,Ze=!0):ee(N.goToLastRow,g,E)?q=ve-1:ee(N.goToFirstRow,g,E)?q=Number.MIN_SAFE_INTEGER:ee(N.goToLastColumn,g,E)?re=Number.MAX_SAFE_INTEGER:ee(N.goToFirstColumn,g,E)?re=Number.MIN_SAFE_INTEGER:(z==="rect"||z==="multi-rect")&&(ee(N.selectGrowDown,g,E)?O([0,1]):ee(N.selectGrowUp,g,E)?O([0,-1]):ee(N.selectGrowRight,g,E)?O([1,0]):ee(N.selectGrowLeft,g,E)?O([-1,0]):ee(N.selectToLastRow,g,E)?O([0,2]):ee(N.selectToFirstRow,g,E)?O([0,-2]):ee(N.selectToLastColumn,g,E)?O([2,0]):ee(N.selectToFirstColumn,g,E)&&O([-2,0])),St=E.didMatch);if(d!==void 0&&d!=="normal"&&q!==ct){const j=d==="skip-up"||d==="skip"||d==="block",J=d==="skip-down"||d==="skip"||d==="block",Oe=q<ct;if(Oe&&j){for(;q>=0&&w(q).isGroupHeader;)q--;q<0&&(q=ct)}else if(!Oe&&J){for(;q<ve&&w(q).isGroupHeader;)q++;q>=ve&&(q=ct)}}const p=F(re,q,!1,Ze),we=E.didMatch;return we&&(p||!St||C)&&fe(),we};return{handleFixedKeybindings:Ge,onKeyDown:g=>{let fe=!1;if(M!==void 0&&M({...g,...g.location&&{location:[g.location[0]-ye,g.location[1]]},cancel:()=>{fe=!0}}),fe||Ge(g)||G.current===void 0)return;const[E,me]=G.current.cell,Le=Ke.current,Ue=g.keyCode===229,N=h&&!g.metaKey&&!g.ctrlKey&&g.key.length===1&&/[\p{L}\p{M}\p{N}\p{S}\p{P}]/u.test(g.key);if((Ue||N)&&g.bounds!==void 0&&Ht(Me([E-ye,Math.max(0,Math.min(me,ve-1))]))){if((!T||me!==ve)&&(Le.y>me||me>Le.y+Le.height||Le.x>E||E>Le.x+Le.width))return;if(g.stopPropagation(),g.preventDefault(),Ue){const re={inputType:"keyboard",key:""};H==null||H([E-ye,me],re),Re(g.bounds,re,"")}else{const re={inputType:"keyboard",key:g.key};H==null||H([E-ye,me],re),Re(g.bounds,re,g.key)}}}}}function zs(e,o,r,i,f,v,z){const h=Qe.useCallback((s,d,w,M)=>{var I;(v==="cell"||v==="multi-cell")&&s!==void 0&&(s={...s,range:{x:s.cell[0],y:s.cell[1],width:1,height:1}}),!z&&s!==void 0&&s.range.width>1&&(s={...s,range:{...s.range,width:1,x:s.cell[0]}});const P=r==="mixed"&&(w||M==="drag")||r==="additive",H=(i==="mixed"||i==="additive")&&P,se=w||(f==="mixed"||f==="additive")&&P;let Me={current:s===void 0?void 0:{...s,rangeStack:M==="drag"?((I=e.current)==null?void 0:I.rangeStack)??[]:[]},columns:H?e.columns:Se.empty(),rows:se?e.rows:Se.empty()};w&&(v==="multi-rect"||v==="multi-cell")&&Me.current!==void 0&&e.current!==void 0&&(Me={...Me,current:{...Me.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),o(Me,d)},[i,e,r,v,z,f,o]),C=Qe.useCallback((s,d,w)=>{s=s??e.rows,d!==void 0&&(s=s.add(d));let M;if(f==="exclusive"&&s.length>0)M={current:void 0,columns:Se.empty(),rows:s};else{const P=w&&r==="mixed"||r==="additive",H=w&&i==="mixed"||i==="additive";M={current:P?e.current:void 0,columns:H?e.columns:Se.empty(),rows:s}}o(M,!1)},[i,e,r,f,o]),T=Qe.useCallback((s,d,w)=>{s=s??e.columns,d!==void 0&&(s=s.add(d));let M;if(i==="exclusive"&&s.length>0)M={current:void 0,rows:Se.empty(),columns:s};else{const P=w&&r==="mixed"||r==="additive",H=w&&f==="mixed"||f==="additive";M={current:P?e.current:void 0,rows:H?e.rows:Se.empty(),columns:s}}o(M,!1)},[i,e,r,f,o]);return[h,C,T]}function Ds(e,o,r,i,f){const z=e!==void 0?T=>{if(e===!0){const s=[];for(let d=T.y;d<T.y+T.height;d++){const w=[];for(let M=T.x;M<T.x+T.width;M++)M<0||d>=f?w.push({kind:Z.Loading,allowOverlay:!1}):w.push(o([M,d]));s.push(w)}return s}return(e==null?void 0:e(T,i.signal))??[]}:void 0;return[e!==void 0?T=>{if(z===void 0)return[];const s={...T,x:T.x-r};if(s.x<0){s.x=0,s.width--;const d=z(s,i.signal);return typeof d=="function"?async()=>(await d()).map(w=>[{kind:Z.Loading,allowOverlay:!1},...w]):d.map(w=>[{kind:Z.Loading,allowOverlay:!1},...w])}return z(s,i.signal)}:void 0,z]}function ur(e){return typeof e=="string"?e:`${e}px`}const Ls=()=>e=>e.innerWidth,Hs=()=>e=>e.innerHeight,Fs=Io("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[Ls()],"w2q57ts-1":[Hs()]}}),$s=e=>{const{inWidth:o,inHeight:r,children:i,...f}=e;return c.createElement(Fs,{innerHeight:ur(r),innerWidth:ur(o),...f},i)},Gs=2,Ks=1300;function Ps(e,o,r){const i=Qe.useRef(0),[f,v]=e??[0,0];Qe.useEffect(()=>{if(f===0&&v===0){i.current=0;return}let z=!1,h=0;const C=T=>{var s;if(!z){if(h===0)h=T;else{const d=T-h;i.current=Math.min(1,i.current+d/Ks);const w=i.current**1.618*d*Gs;(s=o.current)==null||s.scrollBy(f*w,v*w),h=T,r==null||r()}window.requestAnimationFrame(C)}};return window.requestAnimationFrame(C),()=>{z=!0}},[o,f,v,r])}function Ns(e){const{state:o,keybindings:r,getCellsForSelection:i,coercePasteValue:f,onPaste:v,copyHeaders:z,columnsIn:h,onDelete:C,deleteRange:T,safeWindow:s}=e,{gridSelection:d,gridRef:w,scrollRef:M,canvasRef:P,abortControllerRef:H,rowMarkerOffset:se,mangledCols:Me,mangledRows:X,rows:I,getMangledCellContent:ne,mangledOnCellsEdited:S,getCellRenderer:O}=o,F=async $=>{var Ke,ye,ve;if(!r.paste)return;function le(V,ie,x,Y){var De,Ge;const Re=typeof x=="object"?(x==null?void 0:x.join(`
`))??"":(x==null?void 0:x.toString())??"";if(!To(V)&&Ht(V)&&V.readonly!==!0){const be=f==null?void 0:f(Re,V);if(be!==void 0&&Qt(be))return{location:ie,value:be};const g=O(V);if(g===void 0)return;if(g.kind===Z.Custom){ko(V.kind===Z.Custom);const fe=(De=g.onPaste)==null?void 0:De.call(g,Re,V.data);return fe===void 0?void 0:{location:ie,value:{...V,data:fe}}}else{const fe=(Ge=g.onPaste)==null?void 0:Ge.call(g,Re,V,{formatted:Y,formattedString:typeof Y=="string"?Y:Y==null?void 0:Y.join(`
`),rawValue:x});return fe===void 0?void 0:(ko(fe.kind===V.kind),{location:ie,value:fe})}}}const B=d.columns,ce=d.rows,G=((Ke=M.current)==null?void 0:Ke.contains(document.activeElement))===!0||((ye=P.current)==null?void 0:ye.contains(document.activeElement))===!0;let k;if(d.current!==void 0?k=[d.current.range.x,d.current.range.y]:B.length===1?k=[B.first()??0,0]:ce.length===1&&(k=[se,ce.first()??0]),G&&k!==void 0){let V,ie;const x="text/plain",Y="text/html";if(navigator.clipboard.read!==void 0){const be=await navigator.clipboard.read();for(const g of be){if(g.types.includes(Y)){const E=await(await g.getType(Y)).text(),me=rr(E);if(me!==void 0){V=me;break}}g.types.includes(x)&&(ie=await(await g.getType(x)).text())}}else if(navigator.clipboard.readText!==void 0)ie=await navigator.clipboard.readText();else if($!==void 0&&($==null?void 0:$.clipboardData)!==null){if($.clipboardData.types.includes(Y)){const be=$.clipboardData.getData(Y);V=rr(be)}V===void 0&&$.clipboardData.types.includes(x)&&(ie=$.clipboardData.getData(x))}else return;const[Re,De]=k,Ge=[];do{if(v===void 0){const be=ne(k),g=ie??(V==null?void 0:V.map(E=>E.map(me=>me.rawValue).join("	")).join("	"))??"",fe=le(be,k,g,void 0);fe!==void 0&&Ge.push(fe);break}if(V===void 0){if(ie===void 0)return;V=vi(ie)}if(v===!1||typeof v=="function"&&(v==null?void 0:v([k[0]-se,k[1]],V.map(be=>be.map(g=>{var fe;return((fe=g.rawValue)==null?void 0:fe.toString())??""}))))!==!0)return;for(const[be,g]of V.entries()){if(be+De>=I)break;for(const[fe,E]of g.entries()){const me=[fe+Re,be+De],[Le,Ue]=me;if(Le>=Me.length||Ue>=X)continue;const N=ne(me),re=le(N,me,E.rawValue,E.formatted);re!==void 0&&Ge.push(re)}}}while(!1);S(Ge),(ve=w.current)==null||ve.damage(Ge.map(be=>({cell:be.location})))}};ln("paste",F,s,!1,!0);const A=async($,le)=>{var Ke,ye;if(!r.copy)return;const B=le===!0||((Ke=M.current)==null?void 0:Ke.contains(document.activeElement))===!0||((ye=P.current)==null?void 0:ye.contains(document.activeElement))===!0,ce=d.columns,G=d.rows,k=(ve,V)=>{if(!z)lr(ve,V,$);else{const ie=V.map(x=>({kind:Z.Text,data:h[x].title,displayData:h[x].title,allowOverlay:!1}));lr([ie,...ve],V,$)}};if(B&&i!==void 0){if(d.current!==void 0){let ve=i(d.current.range,H.current.signal);typeof ve!="object"&&(ve=await ve()),k(ve,Ut(d.current.range.x-se,d.current.range.x+d.current.range.width-se))}else if(G!==void 0&&G.length>0){const V=[...G].map(ie=>{const x=i({x:se,y:ie,width:h.length,height:1},H.current.signal);return typeof x=="object"?x[0]:x().then(Y=>Y[0])});if(V.some(ie=>ie instanceof Promise)){const ie=await Promise.all(V);k(ie,Ut(h.length))}else k(V,Ut(h.length))}else if(ce.length>0){const ve=[],V=[];for(const ie of ce){let x=i({x:ie,y:0,width:1,height:I},H.current.signal);typeof x!="object"&&(x=await x()),ve.push(x),V.push(ie-se)}if(ve.length===1)k(ve[0],V);else{const ie=ve.reduce((x,Y)=>x.map((Re,De)=>[...Re,...Y[De]]));k(ie,V)}}}};ln("copy",A,s,!1,!1);const oe=async $=>{var B,ce;if(!(!r.cut||!(((B=M.current)==null?void 0:B.contains(document.activeElement))===!0||((ce=P.current)==null?void 0:ce.contains(document.activeElement))===!0))&&(await A($),d.current!==void 0)){let G={current:{cell:d.current.cell,range:d.current.range,rangeStack:[]},rows:Se.empty(),columns:Se.empty()};const k=C==null?void 0:C(G);if(k===!1||(G=k===void 0||k===!0?G:k,G.current===void 0))return;T(G.current.range)}};return ln("cut",oe,s,!1,!1),{onCopy:A,onCut:oe,onPasteInternal:F}}function Ws({rowHeight:e,headerHeight:o,groupHeaderHeight:r,theme:i,overscrollX:f,overscrollY:v,scaleToRem:z,remSize:h}){const[C,T,s,d,w,M]=(()=>{if(!z||h===16)return[e,o,r,i,f,v];const P=h/16,H=e,se=hr();return[typeof H=="number"?H*P:Me=>Math.ceil(H(Me)*P),Math.ceil(o*P),Math.ceil(r*P),{...i,headerIconSize:((i==null?void 0:i.headerIconSize)??se.headerIconSize)*P,cellHorizontalPadding:((i==null?void 0:i.cellHorizontalPadding)??se.cellHorizontalPadding)*P,cellVerticalPadding:((i==null?void 0:i.cellVerticalPadding)??se.cellVerticalPadding)*P},Math.ceil((f??0)*P),Math.ceil((v??0)*P)]})();return{rowHeight:C,headerHeight:T,groupHeaderHeight:s,theme:d,overscrollX:w,overscrollY:M}}const bt={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function te(e,o){return e===!0?o:e===!1?"":e}function dr(e){const o=Eo.value;return{activateCell:te(e.activateCell," |Enter|shift+Enter"),clear:te(e.clear,"any+Escape"),closeOverlay:te(e.closeOverlay,"any+Escape"),acceptOverlayDown:te(e.acceptOverlayDown,"Enter"),acceptOverlayUp:te(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:te(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:te(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:te(e.delete,o?"Backspace|Delete":"Delete"),downFill:te(e.downFill,"primary+_68"),scrollToSelectedCell:te(e.scrollToSelectedCell,"primary+Enter"),goDownCell:te(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:te(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:te(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:te(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:te(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:te(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:te(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:te(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:te(e.goToFirstCell,"primary+Home"),goToFirstColumn:te(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:te(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:te(e.goToLastCell,"primary+End"),goToLastColumn:te(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:te(e.goToLastRow,"primary+ArrowDown"),goToNextPage:te(e.goToNextPage,"PageDown"),goToPreviousPage:te(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:te(e.rightFill,"primary+_82"),search:te(e.search,"primary+f"),selectAll:te(e.selectAll,"primary+a"),selectColumn:te(e.selectColumn,"ctrl+ "),selectGrowDown:te(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:te(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:te(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:te(e.selectGrowUp,"shift+ArrowUp"),selectRow:te(e.selectRow,"shift+ "),selectToFirstCell:te(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:te(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:te(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:te(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:te(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:te(e.selectToLastRow,"primary+shift+ArrowDown")}}function Vs(e){const o=mi(e);return Qe.useMemo(()=>{if(o===void 0)return dr(bt);const r={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??bt.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??bt.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??bt.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??bt.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??bt.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??bt.selectToLastCell};return dr({...bt,...r})},[o])}function Os(e){function o(i,f,v){if(typeof i=="number")return{headerIndex:i,isCollapsed:!1,depth:f,path:v};const z={headerIndex:i.headerIndex,isCollapsed:i.isCollapsed,depth:f,path:v};return i.subGroups!==void 0&&(z.subGroups=i.subGroups.map((h,C)=>o(h,f+1,[...v,C])).sort((h,C)=>h.headerIndex-C.headerIndex)),z}return e.map((i,f)=>o(i,0,[f])).sort((i,f)=>i.headerIndex-f.headerIndex)}function dn(e,o){const r=[];function i(h,C,T=!1){let s=C!==null?C-h.headerIndex:o-h.headerIndex;if(h.subGroups!==void 0&&(s=h.subGroups[0].headerIndex-h.headerIndex),s--,r.push({rowIndex:-1,headerIndex:h.headerIndex,contentIndex:-1,skip:T,isCollapsed:h.isCollapsed,depth:h.depth,path:h.path,rows:s}),h.subGroups)for(let d=0;d<h.subGroups.length;d++){const w=d<h.subGroups.length-1?h.subGroups[d+1].headerIndex:C;i(h.subGroups[d],w,T||h.isCollapsed)}}const f=Os(e.groups);for(let h=0;h<f.length;h++){const C=h<f.length-1?f[h+1].headerIndex:null;i(f[h],C)}let v=0,z=0;for(const h of r)h.contentIndex=z,z+=h.rows,h.rowIndex=v,v+=h.isCollapsed?1:h.rows+1;return r.filter(h=>h.skip===!1).map(h=>{const{skip:C,...T}=h;return T})}function un(e,o){if(o===void 0||dn.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let r=e;for(const i of o){if(r===0)return{path:[...i.path,-1],originalIndex:i.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:i.rows};if(i.isCollapsed)r--;else{if(r<=i.rows)return{path:[...i.path,r-1],originalIndex:i.headerIndex+r,isGroupHeader:!1,groupIndex:r-1,contentIndex:i.contentIndex+r-1,groupRows:i.rows};r=r-i.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function As(e,o,r,i){const f=e===void 0?void 0:dn(e,o),v=f==null?void 0:f.reduce((s,d)=>(s[d.rowIndex]=d,s),{}),z=f===void 0?o:f.reduce((s,d)=>s+(d.isCollapsed?1:d.rows+1),0),h=e===void 0||typeof r=="number"&&e.height===r?r:s=>v!=null&&v[s]?e.height:typeof r=="number"?r:r(s),C=s=>{if(f===void 0)return s;let d=s;for(const w of f){if(d===0)return;if(d--,!w.isCollapsed){if(d<w.rows)return w.contentIndex+d;d-=w.rows}}return s},T=Rt(i??(e==null?void 0:e.themeOverride),s=>{if(e===void 0)return i==null?void 0:i(s,s,s);if(i===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:d,contentIndex:w,groupIndex:M}=un(s,f);return d?e.themeOverride:i==null?void 0:i(s,M,w)});return e===void 0?{rowHeight:h,rows:o,rowNumberMapper:C,getRowThemeOverride:T}:{rowHeight:h,rows:z,rowNumberMapper:C,getRowThemeOverride:T}}function Bs(e,o){const r=Qe.useMemo(()=>e===void 0?void 0:dn(e,o),[e,o]);return{getRowGroupingForPath:wr,updateRowGroupingByPath:pr,mapper:Qe.useCallback(i=>{if(typeof i=="number")return un(i,r);const f=un(i[1],r);return{...f,originalIndex:[i[0],f.originalIndex]}},[r])}}function pr(e,o,r){const[i,...f]=o;return f[0]===-1?e.map((v,z)=>z===i?{...v,...r}:v):e.map((v,z)=>z===i?{...v,subGroups:pr(v.subGroups??[],f,r)}:v)}function wr(e,o){const[r,...i]=o;return i[0]===-1?e[r]:wr(e[r].subGroups??[],i)}function Us(e,o){const[r]=c.useState(()=>({value:e,callback:o,facade:{get current(){return r.value},set current(i){const f=r.value;f!==i&&(r.value=i,r.callback(i,f))}}}));return r.callback=o,r.facade}function Xs(e,o,r,i,f){const[v,z]=[o!==void 0&&typeof r=="number"?Math.floor(o/r):0,o!==void 0&&typeof r=="number"?-(o%r):0],h={x:i.current.x,y:v,width:i.current.width??1,height:i.current.height??1,ty:z},[C,T,s]=pi(h),d=c.useRef(f);d.current=f;const w=Us(null,H=>{H!==null&&o!==void 0?H.scrollTop=o:H!==null&&e!==void 0&&(H.scrollLeft=e)}),M=(C.height??1)>1;c.useLayoutEffect(()=>{if(o!==void 0&&w.current!==null&&M){if(w.current.scrollTop===o)return;w.current.scrollTop=o,w.current.scrollTop!==o&&s(),d.current()}},[o,M,s,w]);const P=(C.width??1)>1;return c.useLayoutEffect(()=>{if(e!==void 0&&w.current!==null&&P){if(w.current.scrollLeft===e)return;w.current.scrollLeft=e,w.current.scrollLeft!==e&&s(),d.current()}},[e,P,s,w]),{visibleRegion:C,setVisibleRegion:T,scrollRef:w}}const _s=Io("textarea")({name:"GhostInputBox",class:"gxeqqyx",propsAsIs:!1}),Ys=(e,o)=>{const{onInput:r,onCompositionStart:i,onCompositionEnd:f,onKeyDown:v,onKeyUp:z,onFocus:h,onBlur:C,disabled:T=!1}=e,s=c.useRef(null),d=c.useRef(!1),w=c.useRef({width:0,height:0}),M=c.useCallback(()=>{const I=s.current;if(!I||I.style.opacity==="0")return;const ne=w.current.width,S=w.current.height;I.style.width=`${ne}px`,I.style.height=`${S}px`;const O=Math.max(ne,I.scrollWidth+2),F=Math.max(S,I.scrollHeight+2);I.style.width=`${O}px`,I.style.height=`${F}px`},[]);c.useImperativeHandle(o,()=>({focus:()=>{var I;(I=s.current)==null||I.focus({preventScroll:!0})},blur:()=>{var I;(I=s.current)==null||I.blur()},clear:()=>{s.current&&(s.current.value="",s.current.setSelectionRange(0,0))},getValue:()=>{var I;return((I=s.current)==null?void 0:I.value)??""},setValue:I=>{if(s.current){s.current.value=I;const ne=I.length;s.current.setSelectionRange(ne,ne)}},setPosition:(I,ne,S,O)=>{const F=s.current;F&&(w.current={width:S,height:O},F.style.left=`${I}px`,F.style.top=`${ne}px`,F.style.width=`${S}px`,F.style.height=`${O}px`)},setVisible:I=>{const ne=s.current;ne&&(I?(ne.style.opacity="1",ne.style.pointerEvents="auto",ne.style.zIndex="10000"):(ne.style.left="-9999px",ne.style.top="0",ne.style.width="1px",ne.style.height="1px",ne.style.opacity="0",ne.style.pointerEvents="none",ne.style.zIndex="0"))}}));const P=c.useCallback(I=>{const ne=I.currentTarget;r(ne.value,d.current),M()},[r,M]),H=c.useCallback(()=>{d.current=!0,i()},[i]),se=c.useCallback(I=>{d.current=!1,f(I.currentTarget.value)},[f]),Me=c.useCallback(I=>{v(I)},[v]),X=c.useCallback(I=>{z==null||z(I)},[z]);return c.createElement(_s,{ref:s,defaultValue:"",tabIndex:T?-1:0,disabled:T,onInput:P,onCompositionStart:H,onCompositionEnd:se,onKeyDown:Me,onKeyUp:X,onFocus:h,onBlur:C,"aria-label":"Grid input",wrap:"off",rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})},qs=c.memo(c.forwardRef(Ys)),Zs=e=>{};function Js(e){const{state:o,onKeyDown:r,onFinishEditing:i,onKeyUpIn:f,onCellActivated:v,setIsFocused:z}=e,{gridSelection:h,overlayRef:C,ghostInputRef:T,ghostInputVisibleRef:s,gridRef:d,rowMarkerOffset:w,getMangledCellContent:M,reselect:P}=o;return{onGhostInput:(S,O)=>{var F;if(C.current===void 0&&!O&&S.length>0&&S.trim().length>0&&h.current!==void 0){const[A,oe]=h.current.cell,$=M([A,oe]);if($.kind===Z.Custom){const le=$.data,B=le==null?void 0:le.kind;if(B!=="number-cell"&&B!=="date-picker-cell")return}if($.allowOverlay&&Ht($)&&$.readonly!==!0){const le=(F=d.current)==null?void 0:F.getBounds(A,oe);if(le!==void 0){const B={inputType:"keyboard",key:S};v==null||v([A-w,oe],B),P(le,B,S)}}}},onGhostCompositionStart:()=>{var A,oe,$,le,B;if(h.current===void 0)return;const[S,O]=h.current.cell,F=(A=C.current)==null?void 0:A.cell;if(F!==void 0&&(F[0]!==S||F[1]!==O)&&((oe=T.current)==null||oe.clear(),($=T.current)==null||$.setVisible(!1),o.setGhostInputVisible(!1),C.current=void 0,o.setOverlay(void 0)),C.current===void 0){const ce=M([S,O]);if(ce.kind===Z.Custom){const G=ce.data,k=G==null?void 0:G.kind;if(k!=="number-cell"&&k!=="date-picker-cell")return}if(ce.allowOverlay&&Ht(ce)&&ce.readonly!==!0){const G=(le=d.current)==null?void 0:le.getBounds(S,O);if(G!==void 0){(B=T.current)==null||B.clear();const k={inputType:"keyboard",key:""};v==null||v([S-w,O],k),P(G,k,"")}}}},onGhostCompositionEnd:Zs,onGhostKeyDown:S=>{var $,le;if(S.nativeEvent.isComposing)return;if(C.current!==void 0&&s.current){const B=S.key;if(C.current.content.kind===Z.Custom){(B==="Enter"||B==="Tab"||B==="Escape")&&(S.preventDefault(),S.stopPropagation());return}if(B==="Escape"){S.preventDefault(),S.stopPropagation(),i(void 0,[0,0]);return}if(B==="Enter"&&!S.shiftKey){S.preventDefault(),S.stopPropagation(),i(void 0,[0,1]);return}if(B==="Tab"){S.preventDefault(),S.stopPropagation(),i(void 0,S.shiftKey?[-1,0]:[1,0]);return}}{const B=S.key;if(B.length===1&&!S.ctrlKey&&!S.metaKey&&!S.altKey)if(B===" "&&h.current!==void 0){const G=h.current.cell,k=M(G);if(!(k.kind===Z.Boolean&&k.readonly!==!0))return}else return}if(C.current!==void 0&&s.current){const B=S.key;if(B==="Backspace"||B==="Delete"||(B==="ArrowLeft"||B==="ArrowRight"||B==="ArrowUp"||B==="ArrowDown"||B==="Home"||B==="End"))return}const O=($=h.current)==null?void 0:$.cell,F=O!==void 0?(le=d.current)==null?void 0:le.getBounds(O[0],O[1]):void 0;let A=!1;const oe={bounds:F,cancel:()=>{A=!0},stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:O};r(oe),A&&(S.preventDefault(),S.stopPropagation())},onGhostKeyUp:S=>{var oe,$;const O=(oe=h.current)==null?void 0:oe.cell,A={bounds:O!==void 0?($=d.current)==null?void 0:$.getBounds(O[0],O[1]):void 0,cancel:()=>{},stopPropagation:()=>S.stopPropagation(),preventDefault:()=>S.preventDefault(),ctrlKey:S.ctrlKey,metaKey:S.metaKey,shiftKey:S.shiftKey,altKey:S.altKey,key:S.key,keyCode:S.keyCode,rawEvent:S,location:O};f==null||f(A)},onGhostFocus:()=>{z(!0)},onGhostBlur:()=>{z(!1)}}}function Qs(e){const{state:o,mouseState:r,setMouseState:i,fillHighlightRegion:f,setFillHighlightRegion:v,setScrollDir:z,handleSelect:h,onMouseMove:C,onCellClicked:T,onCellActivated:s,onCellContextMenu:d,onHeaderContextMenu:w,onGroupHeaderContextMenu:M,onHeaderClicked:P,onGroupHeaderClicked:H,onColumnResize:se,onFillPattern:Me,cellActivationBehavior:X,columnSelect:I,columnSelectionMode:ne,columns:S,groupLevels:O,mergedTheme:F,minColumnWidth:A,maxColumnWidth:oe,themeForCell:$,getCellsForSelection:le,setSelectedColumns:B,visibleRegion:ce,lastMouseSelectLocation:G}=e,{gridSelection:k,gridRef:Ke,visibleRegionRef:ye,abortControllerRef:ve,rowMarkerOffset:V,mangledCols:ie,rows:x,setGridSelection:Y,getMangledCellContent:Re,mangledOnCellsEdited:De,reselect:Ge,focus:be,getCellRenderer:g}=o,fe=c.useRef(!1),E=c.useRef(ce),me=c.useRef(void 0),Le=c.useRef(!1),Ue=p=>{if(Le.current=!1,E.current=ye.current,p.button!==0&&p.button!==1){me.current=void 0;return}const we=performance.now();me.current={button:p.button,time:we,location:p.location},(p==null?void 0:p.kind)==="header"&&(fe.current=!0);const W=p.kind==="cell"&&p.isFillHandle;!W&&p.kind!=="cell"&&p.isEdge||(i({previousSelection:k,fillHandle:W}),G.current=void 0,!p.isTouch&&p.button===0&&!W?h(p):!p.isTouch&&p.button===1&&(G.current=p.location))},N=p=>{if(p.kind!==Bt||I!=="multi")return;const we=Eo.value?p.metaKey:p.ctrlKey,[W,de]=p.location,Ie=k.columns;if(W<V)return;const Ae=ie[W];let j=W,J=W;const Oe=de<=-2?-(de+2):0,He=(Fe,Be)=>O>1?xi(Fe,Be,Oe,O):Ri(Fe,Be);for(let Fe=W-1;Fe>=V&&He(Ae.group,ie[Fe].group);Fe--)j--;for(let Fe=W+1;Fe<ie.length&&He(Ae.group,ie[Fe].group);Fe++)J++;if(be(),we||p.isTouch||ne==="multi")if(Ie.hasAll([j,J+1])){let Fe=Ie;for(let Be=j;Be<=J;Be++)Fe=Fe.remove(Be);B(Fe,void 0,we)}else B(void 0,[j,J+1],we);else B(Se.fromSingleSelection([j,J+1]),void 0,we)},re=async p=>{if(le!==void 0&&se!==void 0){const we=ye.current.y,W=ye.current.height;let de=le({x:p,y:we,width:1,height:Math.min(W,x-we)},ve.current.signal);typeof de!="object"&&(de=await de());const Ie=S[p-V],j=document.createElement("canvas").getContext("2d",{alpha:!1});if(j!==null){j.font=F.baseFontFull;const J=vr(j,F,Ie,0,de,A,oe,!1,g);se==null||se(Ie,J.width,p,J.width)}}},q=async(p,we)=>{var J,Oe;const W=(J=p.current)==null?void 0:J.range;if(W===void 0||le===void 0||we.current===void 0)return;const de=we.current.range;if(Me!==void 0){let He=!1;if(Me({fillDestination:{...de,x:de.x-V},patternSource:{...W,x:W.x-V},preventDefault:()=>He=!0}),He)return}let Ie=le(W,ve.current.signal);typeof Ie!="object"&&(Ie=await Ie());const Ae=Ie,j=[];for(let He=0;He<de.width;He++)for(let Fe=0;Fe<de.height;Fe++){const Be=[de.x+He,de.y+Fe];if(bi(Be,W))continue;const ke=Ae[Fe%W.height][He%W.width];To(ke)||!Ht(ke)||j.push({location:Be,value:{...ke}})}De(j),(Oe=Ke.current)==null||Oe.damage(j.map(He=>({cell:He.location})))};return{onMouseDown:Ue,onMouseUp:(p,we)=>{var Fe,Be;const W=r;if(i(void 0),v(void 0),z(void 0),fe.current=!1,we)return;if((W==null?void 0:W.fillHandle)===!0&&k.current!==void 0&&((Fe=W.previousSelection)==null?void 0:Fe.current)!==void 0){if(f===void 0)return;const ke={...k,current:{...k.current,range:wi(W.previousSelection.current.range,f)}};q(W.previousSelection,ke),Y(ke,!0);return}const[de,Ie]=p.location,[Ae,j]=G.current??[],J=()=>{Le.current=!0},Oe=ke=>{var jt,eo,je;const Mt=ke.isTouch||Ae===de&&j===Ie;if(Mt&&(T==null||T([de-V,Ie],{...ke,preventDefault:J})),ke.button===1)return!Le.current;if(!Le.current){const kt=Re(p.location),Ft=g(kt);if(Ft!==void 0&&Ft.onClick!==void 0&&Mt){const Je=Ft.onClick({...ke,cell:kt,posX:ke.localEventX,posY:ke.localEventY,bounds:ke.bounds,theme:$(kt,p.location),preventDefault:J});Je!==void 0&&!To(Je)&&Qt(Je)&&(De([{location:ke.location,value:Je}]),(jt=Ke.current)==null||jt.damage([{cell:ke.location}]))}if(Le.current||k.current===void 0)return!1;let Tt=!1;switch(kt.activationBehaviorOverride??X){case"double-click":case"second-click":{if(((je=(eo=W==null?void 0:W.previousSelection)==null?void 0:eo.current)==null?void 0:je.cell)===void 0)break;const[Je,ft]=k.current.cell,[_t,et]=W.previousSelection.current.cell;Tt=de===Je&&de===_t&&Ie===ft&&Ie===et&&(ke.isDoubleClick===!0||X==="second-click");break}case"single-click":{Tt=!0;break}}if(Tt){const ft={inputType:"pointer",pointerActivation:ke.isDoubleClick===!0?"double-click":kt.activationBehaviorOverride??X,pointerType:ke.isTouch?"touch":"mouse"};return s==null||s([de-V,Ie],ft),Ge(ke.bounds,ft),!0}}return!1},He=p.location[0]-V;if(p.isTouch){const ke=ye.current,Mt=E.current;if(ke.x!==Mt.x||ke.y!==Mt.y)return;if(p.isLongTouch===!0){if(p.kind==="cell"&&Ci((Be=k.current)==null?void 0:Be.cell,p.location)){d==null||d([He,p.location[1]],{...p,preventDefault:J});return}else if(p.kind==="header"&&k.columns.hasIndex(de)){w==null||w(He,{...p,preventDefault:J});return}else if(p.kind===Bt){if(He<0)return;M==null||M(He,{...p,preventDefault:J});return}}p.kind==="cell"?Oe(p)||h(p):p.kind===Bt?H==null||H(He,{...p,preventDefault:J}):(p.kind===yi&&(P==null||P(He,{...p,preventDefault:J})),h(p));return}if(p.kind==="header"){if(He<0)return;p.isEdge?p.isDoubleClick===!0&&re(de):p.button===0&&de===Ae&&Ie===j&&(P==null||P(He,{...p,preventDefault:J}))}if(p.kind===Bt){if(He<0)return;p.button===0&&de===Ae&&Ie===j&&(H==null||H(He,{...p,preventDefault:J}),Le.current||N(p))}p.kind==="cell"&&(p.button===0||p.button===1)&&Oe(p),G.current=void 0},onMouseMoveImpl:p=>{const we={...p,location:[p.location[0]-V,p.location[1]]};C==null||C(we),r!==void 0&&p.buttons===0&&(i(void 0),v(void 0),z(void 0),fe.current=!1),z(W=>{var de;return fe.current?[p.scrollEdge[0],0]:p.scrollEdge[0]===(W==null?void 0:W[0])&&p.scrollEdge[1]===W[1]?W:r===void 0||(((de=me.current)==null?void 0:de.location[0])??0)<V?void 0:p.scrollEdge})},handleGroupHeaderSelection:N,normalSizeColumn:re,fillDown:()=>{if(k.current===void 0||k.current.range.height<=1)return;const p={...k,current:{...k.current,range:{...k.current.range,height:1}}};q(p,k)},fillRight:()=>{if(k.current===void 0||k.current.range.width<=1)return;const p={...k,current:{...k.current,range:{...k.current.range,width:1}}};q(p,k)},mouseDownData:me,isActivelyDraggingHeader:fe}}const js=c.lazy(async()=>await fi(()=>import("./image-window-loader-DNV8iqrv.js").then(e=>e.$),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url));let ec=0;function tc(e){return Pi(ar(ar(e).filter(o=>o.span!==void 0).map(o=>{var r,i;return Ut((((r=o.span)==null?void 0:r[0])??0)+1,(((i=o.span)==null?void 0:i[1])??0)+1)})))}function Mo(e,o){return e===void 0||o===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+o,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+o},rangeStack:e.current.rangeStack.map(r=>({...r,x:r.x+o}))},rows:e.rows,columns:e.columns.offset(o)}}const xt={kind:Z.Loading,allowOverlay:!1},cn={columns:Se.empty(),rows:Se.empty(),current:void 0},oc=(e,o)=>{var er,tr,or;const[r,i]=c.useState(cn),[f,v]=c.useState(),z=c.useRef(null),h=c.useRef(null),[C,T]=c.useState(),[s,d]=c.useState(),w=c.useRef(void 0),M=c.useRef(null),[P,H]=c.useState(!1),se=c.useRef(P);se.current=P;const Me=c.useRef(f);Me.current=f;const X=typeof window>"u"?null:window,{imageEditorOverride:I,getRowThemeOverride:ne,markdownDivCreateNode:S,width:O,height:F,columns:A,rows:oe,getCellContent:$,onCellClicked:le,onCellActivated:B,onFillPattern:ce,onFinishedEditing:G,coercePasteValue:k,drawHeader:Ke,drawCell:ye,editorBloom:ve,onHeaderClicked:V,onColumnProposeMove:ie,rangeSelectionColumnSpanning:x=!0,spanRangeBehavior:Y="default",onGroupHeaderClicked:Re,onCellContextMenu:De,className:Ge,onHeaderContextMenu:be,getCellsForSelection:g,onGroupHeaderContextMenu:fe,onGroupHeaderRenamed:E,onCellEdited:me,onCellsEdited:Le,onSearchResultsChanged:Ue,searchResults:N,onSearchValueChange:re,searchValue:q,onKeyDown:ct,onKeyUp:Ze,keybindings:St,editOnType:Xt=!0,onRowAppended:p,onColumnAppended:we,onColumnMoved:W,validateCell:de,highlightRegions:Ie,rangeSelect:Ae="rect",columnSelect:j="multi",rowSelect:J="multi",rangeSelectionBlending:Oe="exclusive",columnSelectionBlending:He="exclusive",rowSelectionBlending:Fe="exclusive",onDelete:Be,onDragStart:ke,onMouseMove:Mt,onPaste:jt,copyHeaders:eo=!1,freezeColumns:je=0,cellActivationBehavior:kt="second-click",rowSelectionMode:Ft="auto",columnSelectionMode:Tt="auto",onHeaderMenuClick:Je,onHeaderIndicatorClick:ft,getGroupDetails:_t,rowGrouping:et,onSearchClose:zo,onItemHovered:Do,onSelectionCleared:to,showSearch:Cr,onVisibleRegionChanged:Lo,gridSelection:$t,onGridSelectionChange:fn,minColumnWidth:yr=50,maxColumnWidth:br=500,maxColumnAutoWidth:xr,provideEditor:Rr,trailingRowOptions:We,freezeTrailingRows:Et=0,allowedFillDirections:Sr="orthogonal",scrollOffsetX:Mr,scrollOffsetY:kr,verticalBorder:Yt,onDragOverCell:Tr,onDrop:Er,onColumnResize:oo,onColumnResizeEnd:no,onColumnResizeStart:ro,customRenderers:Ho,fillHandle:Ir,experimental:_e,fixedShadowX:zr,fixedShadowY:Dr,headerIcons:Lr,imageWindowLoader:Hr,initialSize:Fr,isDraggable:$r,onDragLeave:Gr,onRowMoved:Fo,overscrollX:Kr,overscrollY:Pr,preventDiagonalScrolling:Nr,rightElement:Wr,rightElementProps:Vr,trapFocus:Or=!1,smoothScrollX:Ar,smoothScrollY:Br,scaleToRem:Ur=!1,rowHeight:Xr=34,headerHeight:hn=36,groupHeaderHeight:_r=hn,theme:Yr,isOutsideClick:qr,renderers:gn,resizeIndicator:Zr,scrollToActiveCell:vn=!0,drawFocusRing:mn=!0,portalElementRef:lo,onRowStatus:$o,onRowId:Go}=e,pn=mn==="no-editor"?f===void 0:mn,_=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Jr=(_==null?void 0:_.rowNumber)??!1;let io=(_==null?void 0:_.kind)??e.rowMarkers??"none",at=Jr;(io==="both"||io==="checkbox-and-number")&&(io="checkbox",at=!0);const ht=io,Qr=(_==null?void 0:_.width)??e.rowMarkerWidth,wn=(_==null?void 0:_.startIndex)??e.rowMarkerStartIndex??1,Cn=(_==null?void 0:_.theme)??e.rowMarkerTheme,yn=_==null?void 0:_.headerTheme,jr=_==null?void 0:_.headerAlwaysVisible,bn=J!=="multi"||(_==null?void 0:_.headerDisabled)===!0,so=(_==null?void 0:_.checkboxStyle)??"square",el=(_==null?void 0:_.rowStatus)??!1,xn=(_==null?void 0:_.rowStatusWidth)??40,Rn=_==null?void 0:_.rowStatusTheme,tl=(_==null?void 0:_.rowId)??!1,Sn=(_==null?void 0:_.rowIdWidth)??80,Mn=_==null?void 0:_.rowIdTheme,qt=Math.max(yr,20),Ko=Math.max(br,qt),ol=Math.max(xr??Ko,qt),nl=typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),{rows:Te,rowNumberMapper:kn,rowHeight:rl,getRowThemeOverride:It}=As(et,oe,Xr,ne),ll=Number.parseFloat(nl.fontSize),{rowHeight:Gt,headerHeight:Tn,groupHeaderHeight:En,theme:il,overscrollX:sl,overscrollY:cl}=Ws({groupHeaderHeight:_r,headerHeight:hn,overscrollX:Kr,overscrollY:Pr,remSize:ll,rowHeight:rl,scaleToRem:Ur,theme:Yr}),In=Vs(St),Po=Qr??(oe>1e4?48:oe>1e3?44:oe>100?36:32),gt=ht!=="none",co=el===!0,ao=tl===!0,b=(gt?at?2:1:0)+(co?1:0)+(ao?1:0),No=(gt?(at?2:1)*Po:0)+(co?xn:0)+(ao?Sn:0),Ye=We!==void 0,Wo=(We==null?void 0:We.sticky)===!0,[al,zn]=c.useState(!1),ul=Cr??al,dl=()=>{zo!==void 0?zo():zn(!1)},K=($t===void 0?void 0:Mo($t,b))??r,vt=c.useRef(new AbortController);c.useEffect(()=>()=>vt==null?void 0:vt.current.abort(),[]);const[Kt,fl]=Ds(g,$,b,vt.current,Te),hl=(t,n,a)=>{if(de===void 0)return!0;const l=[t[0]-b,t[1]];return de==null?void 0:de(l,n,a)},uo=c.useRef($t),Pt=(t,n)=>{n&&(t=Ei(t,Kt,b,Y,vt.current)),fn!==void 0?(uo.current=Mo(t,-b),fn(uo.current)):i(t)},Dn=Rt(oo,(t,n,a,l)=>{oo==null||oo(A[a-b],n,a-b,l)}),gl=Rt(no,(t,n,a,l)=>{no==null||no(A[a-b],n,a-b,l)}),vl=Rt(ro,(t,n,a,l)=>{ro==null||ro(A[a-b],n,a-b,l)}),ml=Rt(Ke,(t,n)=>(Ke==null?void 0:Ke({...t,columnIndex:t.columnIndex-b},n))??!1),pl=Rt(ye,(t,n)=>(ye==null?void 0:ye({...t,col:t.col-b},n))??!1),Ln=t=>{if(Be!==void 0){const n=Be(Mo(t,-b));return typeof n=="boolean"?n:Mo(n,b)}return!0},[ut,tt,ot]=zs(K,Pt,Oe,He,Fe,Ae,x),nt=sn(hr(),il),[Vo,wl]=c.useState([0,0,0]),Cl=(()=>{if(gn===void 0)return{};const t={};for(const n of gn)t[n.kind]=n;return t})(),mt=t=>t.kind!==Z.Custom?Cl[t.kind]:Ho==null?void 0:Ho.find(n=>n.isMatch(t));let{sizedColumns:Nt,nonGrowWidth:Hn}=Ts(A,Te,fl,Vo[0]-No-Vo[2],qt,ol,nt,mt,vt.current);Hn+=No;const Zt=(()=>{let t=0;for(const n of Nt)n.group!==void 0&&(typeof n.group=="string"?t=Math.max(t,1):t=Math.max(t,n.group.length));return t})(),Fn=Zt>0,$n=Zt===0?[]:Array(Zt).fill(En),yl=$n.reduce((t,n)=>t+n,0),Oo=Tn+yl,Gn=K.rows.length,bl=ht==="none"?void 0:Gn===0?!1:Gn===Te?!0:void 0,Ne=(()=>{const t=[];return ht!=="none"&&(at&&t.push({title:"",width:Po,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Cn,rowMarker:so,rowMarkerChecked:!1,headerRowMarkerTheme:yn,headerRowMarkerAlwaysVisible:!1,headerRowMarkerDisabled:!0}),t.push({title:"",width:Po,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Cn,rowMarker:so,rowMarkerChecked:bl,headerRowMarkerTheme:yn,headerRowMarkerAlwaysVisible:jr,headerRowMarkerDisabled:bn})),co&&t.push({title:"",width:xn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Rn}),ao&&t.push({title:"ID",width:Sn,icon:void 0,hasMenu:!1,style:"normal",themeOverride:Mn}),[...t,...Nt]})(),pt=c.useRef({height:1,width:1,x:0,y:0}),fo=c.useRef(!1),{setVisibleRegion:xl,visibleRegion:zt,scrollRef:$e}=Xs(Mr,kr,Gt,pt,()=>fo.current=!0);pt.current=zt;const Rl=zt.x+b,Ao=zt.y,Xe=c.useRef(null),rt=t=>{var n;t===!0?(n=M.current)==null||n.focus():window.requestAnimationFrame(()=>{var a;(a=M.current)==null||a.focus()})},lt=Ye?Te+1:Te,ho=t=>{const n=b===0?t:t.map(l=>({...l,location:[l.location[0]-b,l.location[1]]})),a=Le==null?void 0:Le(n);if(a!==!0)for(const l of n)me==null||me(l.location,l.value);return a},[go,Kn]=c.useState(),Bo=K.current!==void 0&&K.current.range.width*K.current.range.height>1?K.current.range:void 0,Wt=pn?(er=K.current)==null?void 0:er.cell:void 0,Uo=Wt==null?void 0:Wt[0],Xo=Wt==null?void 0:Wt[1],Sl=(()=>{if((Ie===void 0||Ie.length===0)&&(Bo??Uo??Xo??go)===void 0)return;const t=[];if(Ie!==void 0)for(const n of Ie){const a=Ne.length-n.range.x-b;a>0&&t.push({color:n.color,range:{...n.range,x:n.range.x+b,width:Math.min(a,n.range.width)},style:n.style})}return go!==void 0&&t.push({color:ir(nt.accentColor,0),range:go,style:"dashed"}),Bo!==void 0&&t.push({color:ir(nt.accentColor,.5),range:Bo,style:"solid-outline"}),Uo!==void 0&&Xo!==void 0&&t.push({color:nt.accentColor,range:{x:Uo,y:Xo,width:1,height:1},style:"solid-outline"}),t.length>0?t:void 0})(),Pn=c.useRef(Ne);Pn.current=Ne;const Vt=([t,n],a=!1)=>{var U,Q,pe,ae,he,L,xe,Ce,ue;const l=Ye&&n===lt-1;let u=0,m=-1,y=-1,R=-1,D=-1;if(gt&&at&&(m=u++),gt&&(y=u++),co&&(R=u++),ao&&(D=u++),t===m){if(l)return xt;const ge=kn(n);return ge===void 0?xt:{kind:Dt.Marker,allowOverlay:!1,checkboxStyle:so,checked:!1,markerKind:"number",row:wn+ge,drawHandle:!1,cursor:void 0,disabled:((U=e.disabledRows)==null?void 0:U.call(e,n))===!0}}if(t===y){if(l)return xt;const ge=kn(n);if(ge===void 0)return xt;let Pe;return at?Pe=ht==="checkbox-visible"?"checkbox-visible":"checkbox":ht==="clickable-number"?Pe="number":Pe=ht,{kind:Dt.Marker,allowOverlay:!1,checkboxStyle:so,checked:(K==null?void 0:K.rows.hasIndex(n))===!0,markerKind:Pe,row:wn+ge,drawHandle:Fo!==void 0,cursor:at?void 0:ht==="clickable-number"?"pointer":void 0,disabled:((Q=e.disabledRows)==null?void 0:Q.call(e,n))===!0}}if(t===R){if(l)return xt;const ge=$o==null?void 0:$o(n);return{kind:Dt.RowStatus,allowOverlay:!1,status:ge,themeOverride:Rn}}if(t===D){if(l)return xt;const ge=Go==null?void 0:Go(n);return{kind:Dt.RowId,allowOverlay:!1,rowId:ge,themeOverride:Mn}}if(l){const Pe=t===b?(We==null?void 0:We.hint)??"":"",Ee=Pn.current[t];if(((pe=Ee==null?void 0:Ee.trailingRowOptions)==null?void 0:pe.disabled)===!0)return xt;{const qe=((ae=Ee==null?void 0:Ee.trailingRowOptions)==null?void 0:ae.hint)??Pe,it=((he=Ee==null?void 0:Ee.trailingRowOptions)==null?void 0:he.addIcon)??(We==null?void 0:We.addIcon);return{kind:Dt.NewRow,hint:qe,allowOverlay:!1,icon:it}}}else{const ge=t-b;if(a||(_e==null?void 0:_e.strict)===!0){const Ee=pt.current,qe=Ee.x>ge||ge>Ee.x+Ee.width||Ee.y>n||n>Ee.y+Ee.height||n>=qo.current,it=ge===((xe=(L=Ee.extras)==null?void 0:L.selected)==null?void 0:xe[0])&&n===((Ce=Ee.extras)==null?void 0:Ce.selected[1]);let st=!1;if(((ue=Ee.extras)==null?void 0:ue.freezeRegions)!==void 0){for(const yt of Ee.extras.freezeRegions)if(Di(yt,ge,n)){st=!0;break}}if(qe&&!it&&!st)return xt}let Pe=$([ge,n]);return b!==0&&Pe.span!==void 0&&(Pe={...Pe,span:[Pe.span[0]+b,Pe.span[1]+b]}),Pe}},Nn=t=>{let n=(_t==null?void 0:_t(t))??{name:t};return E!==void 0&&t!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:a=>en({group:n.name,bounds:a.bounds})}]}),n},Wn=t=>{var R;const[n,a]=t.cell,l=Ne[n],u=(l==null?void 0:l.group)!==void 0?(R=Nn(l.group))==null?void 0:R.overrideTheme:void 0,m=l==null?void 0:l.themeOverride,y=It==null?void 0:It(a);v({...t,theme:sn(nt,u,m,y,t.content.themeOverride)})},Ml=(t,n,a)=>{var y,R,D,U,Q,pe,ae;if(K.current===void 0)return;const[l,u]=K.current.cell,m=Vt([l,u]);if(m.kind!==Z.Boolean&&m.allowOverlay){let he=m;if(a!==void 0)switch(he.kind){case Z.Number:{const Ce=Hi(()=>a==="-"?-0:Number.parseFloat(a),0);he={...he,data:Number.isNaN(Ce)?0:Ce};break}case Z.Text:case Z.Markdown:case Z.Uri:he={...he,data:a};break}Wn({target:t,content:he,initialValue:a,cell:[l,u],highlight:a===void 0,forceEditMode:a!==void 0,activation:n});const L=he.kind===Z.Custom;a!==void 0&&!L?((y=M.current)==null||y.setPosition(t.x,t.y,t.width,t.height),a.length>0&&((R=M.current)==null||R.setValue(a)),(D=M.current)==null||D.setVisible(!0),H(!0)):L&&a!==void 0&&((U=M.current)==null||U.clear(),(Q=M.current)==null||Q.setVisible(!1),(pe=M.current)==null||pe.blur(),H(!1))}else m.kind===Z.Boolean&&n.inputType==="keyboard"&&m.readonly!==!0&&(ho([{location:K.current.cell,value:{...m,data:fr(m.data)}}]),(ae=Xe.current)==null||ae.damage([{cell:K.current.cell}]))},Vn=(t,n)=>{var u;const a=(u=Xe.current)==null?void 0:u.getBounds(t,n);if(a===void 0||$e.current===null)return;const l=Vt([t,n]);l.allowOverlay&&Wn({target:a,content:l,initialValue:void 0,highlight:!0,cell:[t,n],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},Ve=(t,n,a="both",l=0,u=0,m=void 0)=>{if($e.current!==null){const y=Xe.current,R=h.current,D=typeof t!="number"?t.unit==="cell"?t.amount:void 0:t,U=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,Q=typeof t!="number"&&t.unit==="px"?t.amount:void 0,pe=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(y!==null&&R!==null){let ae={x:0,y:0,width:0,height:0},he=0,L=0;if((D!==void 0||U!==void 0)&&(ae=y.getBounds((D??0)+b,U??0)??ae,ae.width===0||ae.height===0))return;const xe=R.getBoundingClientRect(),Ce=xe.width/R.offsetWidth;if(Q!==void 0&&(ae={...ae,x:Q-xe.left-$e.current.scrollLeft,width:1}),pe!==void 0&&(ae={...ae,y:pe+xe.top-$e.current.scrollTop,height:1}),ae!==void 0){const ue={x:ae.x-l,y:ae.y-u,width:ae.width+2*l,height:ae.height+2*u};let ge=0;for(let rn=0;rn<je;rn++)ge+=Nt[rn].width;let Pe=0;const Ee=Et+(Wo?1:0);Ee>0&&(Pe=Ti(lt,Ee,Gt));let qe=ge*Ce+xe.left+No*Ce,it=xe.right,st=xe.top+Oo*Ce,yt=xe.bottom-Pe*Ce;const xo=ae.width+l*2;switch(m==null?void 0:m.hAlign){case"start":it=qe+xo;break;case"end":qe=it-xo;break;case"center":qe=Math.floor((qe+it)/2)-xo/2,it=qe+xo;break}const Ro=ae.height+u*2;switch(m==null?void 0:m.vAlign){case"start":yt=st+Ro;break;case"end":st=yt-Ro;break;case"center":st=Math.floor((st+yt)/2)-Ro/2,yt=st+Ro;break}qe>ue.x?he=ue.x-qe:it<ue.x+ue.width&&(he=ue.x+ue.width-it),st>ue.y?L=ue.y-st:yt<ue.y+ue.height&&(L=ue.y+ue.height-yt),a==="vertical"||typeof t=="number"&&t<je?he=0:(a==="horizontal"||typeof n=="number"&&n>=lt-Ee)&&(L=0),(he!==0||L!==0)&&(Ce!==1&&(he/=Ce,L/=Ce),$e.current.scrollTo({left:he+$e.current.scrollLeft,top:L+$e.current.scrollTop,behavior:(m==null?void 0:m.behavior)??"auto"}))}}}},vo=c.useRef(Ve);vo.current=Ve;const _o=c.useRef(Vn),Yo=c.useRef($);_o.current=Vn,Yo.current=$;const qo=c.useRef(Te);qo.current=Te;const On=c.useRef(Ne.length);On.current=Ne.length;const Jt=async(t,n=!0,a)=>{var U,Q;const l=Ne[t],u=(Q=((U=l==null?void 0:l.trailingRowOptions)==null?void 0:U.onRowAppended)??p)==null?void 0:Q();let m,y=!0;u!==void 0&&(m=await u,m==="top"&&(y=!1),typeof m=="number"&&(y=!1));let R=0;const D=()=>{if(qo.current<=Te){R<500&&window.setTimeout(D,R),R=50+R*2;return}const pe=typeof m=="number"?m:y?Te:0;vo.current(t-b,pe,"both",0,20,a?{behavior:a}:void 0),ut({cell:[t,pe],range:{x:t,y:pe,width:1,height:1}},!1,!1,"edit");const ae=Yo.current([t-b,pe]);ae.allowOverlay&&Ht(ae)&&ae.readonly!==!0&&n&&window.setTimeout(()=>{_o.current(t,pe)},0)};D()},Zo=async(t,n=!0)=>{const a=we==null?void 0:we();let l,u=!0;a!==void 0&&(l=await a,l==="left"&&(u=!1),typeof l=="number"&&(u=!1));let m=0;const y=()=>{if(On.current<=Ne.length){m<500&&window.setTimeout(y,m),m=50+m*2;return}const R=typeof l=="number"?l:u?Ne.length:0;Ve(R-b,t),ut({cell:[R,t],range:{x:R,y:t,width:1,height:1}},!1,!1,"edit");const D=Yo.current([R-b,t]);D.allowOverlay&&Ht(D)&&D.readonly!==!0&&n&&window.setTimeout(()=>{_o.current(R,t)},0)};y()},Jo=t=>{var a,l;const n=((l=(a=Nt[t])==null?void 0:a.trailingRowOptions)==null?void 0:l.targetColumn)??(We==null?void 0:We.targetColumn);if(typeof n=="number")return n+(gt?1:0);if(typeof n=="object"){const u=A.indexOf(n);if(u>=0)return u+(gt?1:0)}},wt=c.useRef(void 0),Ot=c.useRef(void 0),Qo=(t,n)=>{var u;const[a,l]=n;return sn(nt,(u=Ne[a])==null?void 0:u.themeOverride,It==null?void 0:It(l),t.themeOverride)},{mapper:jo}=Bs(et,oe),An=et==null?void 0:et.navigationBehavior,mo=c.useRef(void 0),kl=t=>{var U,Q,pe;const n=Eo.value?t.metaKey:t.ctrlKey,a=n&&J==="multi",[l,u]=t.location,m=K.columns,y=K.rows,[R,D]=((U=K.current)==null?void 0:U.cell)??[];if(t.kind==="cell"){if(Ot.current=void 0,mo.current=[l,u],l===(at?1:0)&&gt){if(Ye===!0&&u===Te||ht==="number"||J==="none")return;const L=Vt(t.location);if(L.kind!==Dt.Marker||L.disabled===!0)return;if(Fo!==void 0){const ue=mt(L);ko((ue==null?void 0:ue.kind)===Dt.Marker);const ge=(Q=ue==null?void 0:ue.onClick)==null?void 0:Q.call(ue,{...t,cell:L,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,theme:Qo(L,t.location),preventDefault:()=>{}});if(ge===void 0||ge.checked===L.checked)return}v(void 0),rt();const xe=y.hasIndex(u),Ce=wt.current;if(J==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&Ce!==void 0&&y.hasIndex(Ce)){const ue=[Math.min(Ce,u),Math.max(Ce,u)+1];a||Ft==="multi"?tt(void 0,ue,!0):tt(Se.fromSingleSelection(ue),void 0,a)}else J==="multi"&&(a||t.isTouch||Ft==="multi")?xe?tt(y.remove(u),void 0,!0):(tt(void 0,u,!0),wt.current=u):xe&&y.length===1?tt(Se.empty(),void 0,n):(tt(Se.fromSingleSelection(u),void 0,n),wt.current=u)}else if(l>=b&&Ye&&u===Te){const L=Jo(l);Jt(L??l)}else if(R!==l||D!==u){const L=Vt(t.location),xe=mt(L);if((xe==null?void 0:xe.onSelect)!==void 0){let ge=!1;if(xe.onSelect({...t,cell:L,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,preventDefault:()=>ge=!0,theme:Qo(L,t.location)}),ge)return}if(An==="block"&&jo(u).isGroupHeader)return;const Ce=Wo&&u===Te,ue=Wo&&K!==void 0&&((pe=K.current)==null?void 0:pe.cell[1])===Te;if((t.shiftKey||t.isLongTouch===!0)&&R!==void 0&&D!==void 0&&K.current!==void 0&&!ue){if(Ce)return;const ge=Math.min(l,R),Pe=Math.max(l,R),Ee=Math.min(u,D),qe=Math.max(u,D);ut({...K.current,range:{x:ge,y:Ee,width:Pe-ge+1,height:qe-Ee+1}},!0,n,"click"),wt.current=void 0,rt()}else{const ge=K.rows.length>0;ut({cell:[l,u],range:{x:l,y:u,width:1,height:1}},!0,n||ge,"click"),wt.current=void 0,v(void 0),rt()}}}else if(t.kind==="header")if(mo.current=[l,u],v(void 0),gt&&l===(at?1:0))wt.current=void 0,Ot.current=void 0,!bn&&J==="multi"&&(y.length!==Te?tt(Se.fromSingleSelection([0,Te]),void 0,n):tt(Se.empty(),void 0,n),rt());else{const he=Ot.current;if(j==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&he!==void 0&&m.hasIndex(he)){const L=[Math.min(he,l),Math.max(he,l)+1];n||t.isTouch||Tt==="multi"?ot(void 0,L,n):ot(Se.fromSingleSelection(L),void 0,n)}else j==="multi"&&(n||t.isTouch||Tt==="multi")?(m.hasIndex(l)?ot(m.remove(l),void 0,n):ot(void 0,l,n),Ot.current=l):j!=="none"&&(m.hasIndex(l)?ot(m.remove(l),void 0,n):ot(Se.fromSingleSelection(l),void 0,n),Ot.current=l);wt.current=void 0,rt()}else t.kind===Bt?mo.current=[l,u]:t.kind===sr&&!t.isMaybeScrollbar&&(Pt(cn,!1),v(void 0),rt(),to==null||to(),wt.current=void 0,Ot.current=void 0)},po={gridSelection:K,overlay:f,gridRef:Xe,ghostInputRef:M,overlayRef:Me,ghostInputVisibleRef:se,scrollRef:$e,canvasRef:h,visibleRegionRef:pt,abortControllerRef:vt,rowMarkerOffset:b,mangledCols:Ne,mangledRows:lt,rows:Te,setGridSelection:Pt,getMangledCellContent:Vt,mangledOnCellsEdited:ho,setOverlay:v,focus:rt,setGhostInputVisible:H,reselect:Ml,getCellRenderer:mt},{onMouseDown:Tl,onMouseUp:El,onMouseMoveImpl:Il,normalSizeColumn:Bn,fillDown:zl,fillRight:Dl,mouseDownData:dt,isActivelyDraggingHeader:Ll}=Qs({state:po,mouseState:C,setMouseState:T,fillHighlightRegion:go,setFillHighlightRegion:Kn,setScrollDir:d,handleSelect:kl,onMouseMove:Mt,onCellClicked:le,onCellActivated:B,onCellContextMenu:De,onHeaderContextMenu:be,onGroupHeaderContextMenu:fe,onHeaderClicked:V,onGroupHeaderClicked:Re,onColumnResize:Dn,onFillPattern:ce,cellActivationBehavior:kt,columnSelect:j,columnSelectionMode:Tt,columns:Nt,groupLevels:Zt,mergedTheme:nt,minColumnWidth:qt,maxColumnWidth:Ko,themeForCell:Qo,getCellsForSelection:Kt,setSelectedColumns:ot,visibleRegion:zt,lastMouseSelectLocation:mo}),[wo,en]=c.useState(),Hl=(t,n)=>{Je==null||Je(t-b,n)},Fl=(t,n)=>{ft==null||ft(t-b,n)};c.useEffect(()=>{if(f===void 0)return;const t=l=>{const u=[];let m=l.parentElement;for(;m&&m!==document.documentElement;){const y=window.getComputedStyle(m),R=y.overflow+y.overflowY+y.overflowX;(R.includes("scroll")||R.includes("auto"))&&u.push(m),m=m.parentElement}return u},n=l=>{const u=l.target;$e.current&&!$e.current.contains(u)&&v(void 0)},a=[];if($e.current){const l=t($e.current);a.push(...l)}return a.forEach(l=>{l.addEventListener("scroll",n)}),window.addEventListener("scroll",n),document.addEventListener("scroll",n,!0),()=>{a.forEach(l=>{l.removeEventListener("scroll",n)}),window.removeEventListener("scroll",n),document.removeEventListener("scroll",n,!0)}},[f,v,$e]);const Ct=(tr=K==null?void 0:K.current)==null?void 0:tr.cell,$l=(t,n,a,l,u,m)=>{if(fo.current=!1,f!==void 0){const Q=pt.current;(Q.x!==t.x||Q.y!==t.y)&&v(void 0)}let y=Ct;y!==void 0&&(y=[y[0]-b,y[1]]);const R=je===0?void 0:{x:0,y:t.y,width:je,height:t.height},D=[];R!==void 0&&D.push(R),Et>0&&(D.push({x:t.x-b,y:Te-Et,width:t.width,height:Et}),je>0&&D.push({x:0,y:Te-Et,width:je,height:Et}));const U={x:t.x-b,y:t.y,width:t.width,height:Ye&&t.y+t.height>=Te?t.height-1:t.height,tx:u,ty:m,extras:{selected:y,freezeRegion:R,freezeRegions:D}};pt.current=U,xl(U),wl([n,a,l]),Lo==null||Lo(U,U.tx,U.ty,U.extras)},Gl=Rt(ie,(t,n)=>(ie==null?void 0:ie(t-b,n-b))!==!1),Kl=Rt(W,(t,n)=>{W==null||W(t-b,n-b),j!=="none"&&ot(Se.fromSingleSelection(n),void 0,!0)}),tn=c.useRef(!1),Pl=t=>{if(t.location[0]===0&&b>0){t.preventDefault();return}ke==null||ke({...t,location:[t.location[0]-b,t.location[1]]}),t.defaultPrevented()||(tn.current=!0),T(void 0)},Nl=()=>{tn.current=!1},Wl=et==null?void 0:et.selectionBehavior,Un=t=>{if(Wl!=="block-spanning")return;const{isGroupHeader:n,path:a,groupRows:l}=jo(t);if(n)return[t,t];const u=a[a.length-1],m=t-u,y=t+l-u-1;return[m,y]},on=c.useRef(void 0),Xn=t=>{var n,a,l;if(!Ii(t,on.current)&&(on.current=t,!(((n=dt==null?void 0:dt.current)==null?void 0:n.button)!==void 0&&dt.current.button>=1))){if(t.buttons!==0&&C!==void 0&&((a=dt.current)==null?void 0:a.location[0])===0&&b===1&&J==="multi"&&C.previousSelection&&!C.previousSelection.rows.hasIndex(dt.current.location[1])&&K.rows.hasIndex(dt.current.location[1])){const u=Math.min(dt.current.location[1],t.location[1]),m=Math.max(dt.current.location[1],t.location[1])+1;tt(Se.fromSingleSelection([u,m]),void 0,!1)}else if(t.buttons!==0&&C!==void 0&&K.current!==void 0&&!tn.current&&!Ll.current&&(Ae==="rect"||Ae==="multi-rect")){const[u,m]=K.current.cell;let[y,R]=t.location;if(R<0&&(R=pt.current.y),C.fillHandle===!0&&((l=C.previousSelection)==null?void 0:l.current)!==void 0){const D=C.previousSelection.current.range;R=Math.min(R,Ye?Te-1:Te);const U=zi(D,y,R,Sr);Kn(U)}else{if(Ye&&m===Te)return;if(Ye&&R===Te)if(t.kind===sr)R--;else return;y=Math.max(y,b);const Q=Un(m);R=Q===void 0?R:Lt(R,Q[0],Q[1]);const pe=y-u,ae=R-m,he={x:pe>=0?u:y,y:ae>=0?m:R,width:Math.abs(pe)+1,height:Math.abs(ae)+1};ut({...K.current,range:he},!0,!1,"drag")}}Do==null||Do({...t,location:[t.location[0]-b,t.location[1]]})}};Ps(s,$e,()=>{var y,R;const t=on.current;if(t===void 0)return;const[n,a]=t.scrollEdge;let[l,u]=t.location;const m=pt.current;n===-1?l=((R=(y=m.extras)==null?void 0:y.freezeRegion)==null?void 0:R.x)??m.x:n===1&&(l=m.x+m.width),a===-1?u=Math.max(0,m.y):a===1&&(u=Math.min(Te-1,m.y+m.height)),l=Lt(l,0,Ne.length-1),u=Lt(u,0,Te-1),Xn({...t,location:[l,u]})});const Vl=t=>{if(K.current===void 0)return;const[n,a]=t,[l,u]=K.current.cell,m=K.current.range;let y=m.x,R=m.x+m.width,D=m.y,U=m.y+m.height;const[Q,pe]=Un(u)??[0,Te-1],ae=pe+1;if(a!==0)switch(a){case 2:{U=ae,D=u,Ve(0,U,"vertical");break}case-2:{D=Q,U=u+1,Ve(0,D,"vertical");break}case 1:{D<u?(D++,Ve(0,D,"vertical")):(U=Math.min(ae,U+1),Ve(0,U,"vertical"));break}case-1:{U>u+1?(U--,Ve(0,U,"vertical")):(D=Math.max(Q,D-1),Ve(0,D,"vertical"));break}default:cr()}if(n!==0)if(n===2)R=Ne.length,y=l,Ve(R-1-b,0,"horizontal");else if(n===-2)y=b,R=l+1,Ve(y-b,0,"horizontal");else{let he=[];if(Kt!==void 0){const L=Kt({x:y,y:D,width:R-y-b,height:U-D},vt.current.signal);typeof L=="object"&&(he=tc(L))}if(n===1){let L=!1;if(y<l){if(he.length>0){const xe=Ut(y+1,l+1).find(Ce=>!he.includes(Ce-b));xe!==void 0&&(y=xe,L=!0)}else y++,L=!0;L&&Ve(y,0,"horizontal")}L||(R=Math.min(Ne.length,R+1),Ve(R-1-b,0,"horizontal"))}else if(n===-1){let L=!1;if(R>l+1){if(he.length>0){const xe=Ut(R-1,l,-1).find(Ce=>!he.includes(Ce-b));xe!==void 0&&(R=xe,L=!0)}else R--,L=!0;L&&Ve(R-b,0,"horizontal")}L||(y=Math.max(b,y-1),Ve(y-b,0,"horizontal"))}else cr()}ut({cell:K.current.cell,range:{x:y,y:D,width:R-y,height:U-D}},!0,!1,"keyboard-select")},nn=c.useRef(vn);nn.current=vn;const Co=(t,n,a,l)=>{const u=lt-(a?0:1);t=Lt(t,b,Nt.length-1+b),n=Lt(n,0,u);const m=Ct==null?void 0:Ct[0],y=Ct==null?void 0:Ct[1];if(t===m&&n===y)return!1;if(l&&K.current!==void 0){const R=[...K.current.rangeStack];(K.current.range.width>1||K.current.range.height>1)&&R.push(K.current.range),Pt({...K,current:{cell:[t,n],range:{x:t,y:n,width:1,height:1},rangeStack:R}},!0)}else ut({cell:[t,n],range:{x:t,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return w.current!==void 0&&w.current[0]===t&&w.current[1]===n&&(w.current=void 0),nn.current&&Ve(t-b,n,"both",0,20),!0},_n=(t,n)=>{var Q,pe,ae,he;const a=Me.current;se.current;let l=t;const u=((Q=M.current)==null?void 0:Q.getValue())??"",m=((pe=a==null?void 0:a.content)==null?void 0:pe.kind)===Z.Custom;if((a==null?void 0:a.cell)!==void 0&&u.length>0&&a.content!==void 0&&!m){const L=a.content;if(L.kind===Z.Text)l={...L,data:u,displayData:u};else if(L.kind===Z.Number){const xe=Number.parseFloat(u),Ce=Number.isNaN(xe)?0:xe;l={...L,data:Ce,displayData:Ce.toLocaleString()}}else L.kind===Z.Uri?l={...L,data:u,displayData:u}:L.kind===Z.Markdown&&(l={...L,data:u})}else m&&(l=t);if(l!==void 0&&u.length===0)if(l.kind===Z.Text&&l.data!==l.displayData)l={...l,displayData:l.data};else if(l.kind===Z.Number){const L=l.data!==void 0?l.data.toLocaleString():"0";l.displayData!==L&&(l={...l,displayData:L})}else l.kind===Z.Uri&&l.data!==l.displayData&&(l={...l,displayData:l.data});const y=a==null?void 0:a.content,R=()=>{if(l===void 0||y===void 0)return!1;if(l.kind!==y.kind)return!0;switch(l.kind){case Z.Text:case Z.Uri:case Z.Markdown:return l.data!==y.data;case Z.Number:return l.data!==y.data;case Z.Boolean:return l.data!==y.data;default:return!0}};(a==null?void 0:a.cell)!==void 0&&l!==void 0&&Qt(l)&&R()&&(ho([{location:a.cell,value:l}]),window.requestAnimationFrame(()=>{var L;(L=Xe.current)==null||L.damage([{cell:a.cell}])})),(ae=M.current)==null||ae.clear(),(he=M.current)==null||he.setVisible(!1),H(!1),rt(!0),Me.current=void 0,v(void 0);const[D,U]=n;if(K.current!==void 0&&(D!==0||U!==0)){const L=K.current.cell[1]===lt-1;if(L&&U===1){G==null||G(t,[0,0]);return}const xe=K.current.cell[0]===Ne.length-1&&t!==void 0;let Ce=!0;if(L&&U===1&&p!==void 0){Ce=!1;const ue=K.current.cell[0]+D,ge=Jo(ue);Jt(ge??ue,!1)}if(xe&&D===1&&we!==void 0){Ce=!1;const ue=K.current.cell[1]+U;Zo(ue,!1)}if(Ce){const ue=Lt(K.current.cell[0]+D,b,Ne.length-1),ge=Lt(K.current.cell[1]+U,0,lt-1);Co(ue,ge,L,!1),window.requestAnimationFrame(()=>{var Pe;(Pe=M.current)==null||Pe.focus()})}}G==null||G(t,n)},[Ol]=c.useState(()=>`gdg-overlay-${ec++}`),Yn=t=>{var a,l,u,m;rt();const n=[];for(let y=t.x;y<t.x+t.width;y++)for(let R=t.y;R<t.y+t.height;R++){const D=$([y-b,R]);if(!D.allowOverlay&&D.kind!==Z.Boolean)continue;let U;if(D.kind===Z.Custom){const Q=mt(D),pe=(a=Q==null?void 0:Q.provideEditor)==null?void 0:a.call(Q,{...D,location:[y-b,R]});(Q==null?void 0:Q.onDelete)!==void 0?U=Q.onDelete(D):Fi(pe)&&(U=(l=pe==null?void 0:pe.deletedValue)==null?void 0:l.call(pe,D))}else if(Qt(D)&&D.allowOverlay||D.kind===Z.Boolean){const Q=mt(D);U=(u=Q==null?void 0:Q.onDelete)==null?void 0:u.call(Q,D)}U!==void 0&&!To(U)&&Qt(U)&&n.push({location:[y,R],value:U})}ho(n),(m=Xe.current)==null||m.damage(n.map(y=>({cell:y.location})))},Al=f!==void 0,{onKeyDown:At}=Is({state:po,keybindings:In,overlayOpen:Al,columnSelect:j,rowSelect:J,rangeSelect:Ae,editOnType:Xt,trapFocus:Or,showTrailingBlankRow:Ye,columnsInLength:A.length,rowGroupingNavBehavior:An,mapper:jo,onKeyDownIn:ct,onSelectionCleared:to,onCellActivated:B,onDelete:Ln,getCellContent:$,setSelectedColumns:ot,setSelectedRows:tt,setShowSearchInner:zn,searchInputRef:z,adjustSelection:Vl,updateSelectedCell:Co,deleteRange:Yn,fillDown:zl,fillRight:Dl,appendRow:Jt,getCustomNewRowTargetColumn:Jo,scrollToRef:vo}),[Bl,qn]=c.useState(!1),Zn=c.useRef(Ki(t=>{qn(t)},5)),{onGhostInput:Ul,onGhostCompositionStart:Xl,onGhostCompositionEnd:_l,onGhostKeyDown:Yl,onGhostKeyUp:ql,onGhostFocus:Zl,onGhostBlur:Jl}=Js({state:po,onKeyDown:At,onFinishEditing:_n,onKeyUpIn:Ze,onCellActivated:B,setIsFocused:qn}),Ql=(t,n)=>{const a=t.location[0]-b;if(t.kind==="header"&&(be==null||be(a,{...t,preventDefault:n})),t.kind===Bt){if(a<0)return;fe==null||fe(a,{...t,preventDefault:n})}if(t.kind==="cell"){const[l,u]=t.location;De==null||De([a,u],{...t,preventDefault:n}),Li(K,t.location)||Co(l,u,!1,!1)}},{onCopy:Jn,onPasteInternal:Qn}=Ns({state:po,keybindings:In,getCellsForSelection:Kt,coercePasteValue:k,onPaste:jt,copyHeaders:eo,columnsIn:A,onDelete:Ln,deleteRange:Yn,safeWindow:X}),jl=(t,n)=>{if(Ue!==void 0){b!==0&&(t=t.map(u=>[u[0]-b,u[1]])),Ue(t,n);return}if(t.length===0||n===-1)return;const[a,l]=t[n];w.current!==void 0&&w.current[0]===a&&w.current[1]===l||(w.current=[a,l],Co(a,l,!1,!1))},[yo,bo]=((or=$t==null?void 0:$t.current)==null?void 0:or.cell)??[];c.useLayoutEffect(()=>{var t,n,a,l;nn.current&&!fo.current&&yo!==void 0&&bo!==void 0&&(yo!==((n=(t=uo.current)==null?void 0:t.current)==null?void 0:n.cell[0])||bo!==((l=(a=uo.current)==null?void 0:a.current)==null?void 0:l.cell[1]))&&vo.current(yo,bo),fo.current=!1},[yo,bo]);const jn=K.current!==void 0&&(K.current.cell[0]>=Ne.length||K.current.cell[1]>=lt);c.useLayoutEffect(()=>{jn&&Pt(cn,!1)},[jn,Pt]);const ei=Ye===!0&&(We==null?void 0:We.tint)===!0?Se.fromSingleSelection(lt-1):Se.empty(),ti=t=>typeof Yt=="boolean"?Yt:(Yt==null?void 0:Yt(t-b))??!0,oi=wo===void 0||h.current===null?null:c.createElement(Ms,{bounds:wo.bounds,group:wo.group,canvasBounds:h.current.getBoundingClientRect(),onClose:()=>en(void 0),onFinish:t=>{en(void 0),E==null||E(wo.group,t)}}),ni=Math.min(Ne.length,je+b);c.useImperativeHandle(o,()=>({appendRow:(t,n)=>Jt(t+b,n),appendColumn:(t,n)=>Zo(t,n),updateCells:t=>{var n;return b!==0&&(t=t.map(a=>({cell:[a.cell[0]+b,a.cell[1]]}))),(n=Xe.current)==null?void 0:n.damage(t)},getBounds:(t,n)=>{var a;if(!((h==null?void 0:h.current)===null||($e==null?void 0:$e.current)===null)){if(t===void 0&&n===void 0){const l=h.current.getBoundingClientRect(),u=l.width/$e.current.clientWidth;return{x:l.x-$e.current.scrollLeft*u,y:l.y-$e.current.scrollTop*u,width:$e.current.scrollWidth*u,height:$e.current.scrollHeight*u}}return(a=Xe.current)==null?void 0:a.getBounds((t??0)+b,n)}},focus:()=>{var t;return(t=Xe.current)==null?void 0:t.focus()},emit:async t=>{switch(t){case"delete":At({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":At({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":At({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await Jn(void 0,!0);break;case"paste":await Qn();break}},scrollTo:Ve,remeasureColumns:t=>{for(const n of t)Bn(n+b)},getMouseArgsForPosition:(t,n,a)=>{if((Xe==null?void 0:Xe.current)===null)return;const l=Xe.current.getMouseArgsForPosition(t,n,a);if(l!==void 0)return{...l,location:[l.location[0]-b,l.location[1]]}}}),[Jt,Zo,Bn,$e,Jn,At,Qn,b,Ve]);const[ri,li]=Ct??[],ii=t=>{const[n,a]=t;if(a===-1){j!=="none"&&(ot(Se.fromSingleSelection(n),void 0,!1),rt());return}ri===n&&li===a||(ut({cell:t,range:{x:n,y:a,width:1,height:1}},!0,!1,"keyboard-nav"),Ve(n,a))},si=()=>{Zn.current(!0),K.current===void 0&&K.columns.length===0&&K.rows.length===0&&C===void 0&&ut({cell:[b,Ao],range:{x:b,y:Ao,width:1,height:1}},!0,!1,"keyboard-select")},ci=()=>{Zn.current(!1)},[ai,ui]=(()=>{let t;const n=(_e==null?void 0:_e.scrollbarWidthOverride)??Si(),a=Te+(Ye?1:0);if(typeof Gt=="number")t=Oo+a*Gt;else{let u=0;const m=Math.min(a,10);for(let y=0;y<m;y++)u+=Gt(y);u=Math.floor(u/m),t=Oo+a*u}t+=n;const l=Ne.reduce((u,m)=>m.width+u,0)+n;return[`${Math.min(1e5,l)}px`,`${Math.min(1e5,t)}px`]})(),di=Mi(nt);return c.createElement(ki.Provider,{value:nt},c.createElement($s,{style:di,className:Ge,inWidth:O??ai,inHeight:F??ui},c.createElement(xs,{fillHandle:Ir,drawFocusRing:pn,experimental:_e,fixedShadowX:zr,fixedShadowY:Dr,getRowThemeOverride:It,headerIcons:Lr,imageWindowLoader:Hr,initialSize:Fr,isDraggable:$r,onDragLeave:Gr,onRowMoved:Fo,overscrollX:sl,overscrollY:cl,preventDiagonalScrolling:Nr,rightElement:Wr,rightElementProps:Vr,smoothScrollX:Ar,smoothScrollY:Br,className:Ge,enableGroups:Fn,onCanvasFocused:si,onCanvasBlur:ci,canvasRef:h,onContextMenu:Ql,theme:nt,cellXOffset:Rl,cellYOffset:Ao,accessibilityHeight:zt.height,onDragEnd:Nl,columns:Ne,nonGrowWidth:Hn,drawHeader:ml,onColumnProposeMove:Gl,drawCell:pl,disabledRows:ei,freezeColumns:ni,lockColumns:b,firstColAccessible:b===0,getCellContent:Vt,minColumnWidth:qt,maxColumnWidth:Ko,searchInputRef:z,showSearch:ul,onSearchClose:dl,highlightRegions:Sl,getCellsForSelection:Kt,getGroupDetails:Nn,headerHeight:Tn,isFocused:Bl,groupHeaderHeight:Fn?En:0,groupLevels:Zt,groupHeaderHeights:$n,freezeTrailingRows:Et+(Ye&&(We==null?void 0:We.sticky)===!0?1:0),hasAppendRow:Ye,onColumnResize:Dn,onColumnResizeEnd:gl,onColumnResizeStart:vl,onCellFocused:ii,onColumnMoved:Kl,onDragStart:Pl,onHeaderMenuClick:Hl,onHeaderIndicatorClick:Fl,onItemHovered:Xn,isFilling:(C==null?void 0:C.fillHandle)===!0,onMouseMove:Il,onKeyDown:At,onKeyUp:Ze,onMouseDown:Tl,onMouseUp:El,onDragOverCell:Tr,onDrop:Er,onSearchResultsChanged:jl,onVisibleRegionChanged:$l,clientSize:Vo,rowHeight:Gt,searchResults:N,searchValue:q,onSearchValueChange:re,rows:lt,scrollRef:$e,selection:K,translateX:zt.tx,translateY:zt.ty,verticalBorder:ti,gridRef:Xe,getCellRenderer:mt,resizeIndicator:Zr}),oi,f!==void 0&&c.createElement(c.Suspense,{fallback:null},c.createElement(js,{...f,validateCell:hl,bloom:ve,id:Ol,getCellRenderer:mt,className:(_e==null?void 0:_e.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Rr,imageEditorOverride:I,portalElementRef:lo,onFinishEditing:_n,markdownDivCreateNode:S,isOutsideClick:qr,customEventTarget:_e==null?void 0:_e.eventTarget,isGhostMode:P}))),(()=>{const t=(lo==null?void 0:lo.current)??document.getElementById("portal");return t===null?null:hi.createPortal(c.createElement(qs,{ref:M,onInput:Ul,onCompositionStart:Xl,onCompositionEnd:_l,onKeyDown:Yl,onKeyUp:ql,onFocus:Zl,onBlur:Jl}),t)})())},nc=c.forwardRef(oc),rc=(e,o)=>{const r=c.useMemo(()=>({...ms,...e.headerIcons}),[e.headerIcons]),i=c.useMemo(()=>e.renderers??$i,[e.renderers]),f=c.useMemo(()=>e.imageWindowLoader??new Gi,[e.imageWindowLoader]);return c.createElement(nc,{...e,renderers:i,headerIcons:r,ref:o,imageWindowLoader:f})},vc=c.forwardRef(rc);export{vc as D,bt as k,Bs as u};
