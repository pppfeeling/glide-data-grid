const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./data-grid-overlay-editor-C_BCg8zk.js","./iframe-DR0htr12.js","./preload-helper-C1FmrZbK.js","./index-oN29dYrM.js","./image-window-loader-CRAGQmiw.js","./throttle-DxPOdbKn.js","./marked.esm-u7llhJro.js","./image-window-loader-DhbFCWIb.css","./flatten-Cxl3d27c.js","./scrolling-data-grid-DH2GRZHx.js","./scrolling-data-grid-wZ406GJK.css","./data-grid-overlay-editor-Cmj_ecGQ.css"])))=>i.map(i=>d[i]);
var Bl=Object.defineProperty;var Xl=(e,o,c)=>o in e?Bl(e,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[o]=c;var fn=(e,o,c)=>Xl(e,typeof o!="symbol"?o+"":o,c);import{r as l,R as fe}from"./iframe-DR0htr12.js";import{_ as _l}from"./preload-helper-C1FmrZbK.js";import{G as te,c as Ko,d as Fo,r as nr,e as No,C as _,g as hr,f as Yl,w as ht,h as ql,j as jl,k as hn,l as rr,I as $o,p as Zl,n as Jl,t as Ql,o as ei,q as Kt,s as lr,v as ir,x as ti,y as Ao,z as oo,B as oi,D as ni,E as ri,F as li,H as ii,J as cr,i as no,K as ci,L as si,M as sr,N as ai,b as gn,O as ui,P as di,T as fi,Q as ar,A as hi,R as gi}from"./image-window-loader-CRAGQmiw.js";import{m as St,r as Nt,g as vi}from"./throttle-DxPOdbKn.js";import{u as mi,f as ur}from"./flatten-Cxl3d27c.js";import{G as wi}from"./scrolling-data-grid-DH2GRZHx.js";import{s as Cn}from"./marked.esm-u7llhJro.js";const J='<svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">',Ci=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}<rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/><path d="M15.75 4h-1.5a.25.25 0 0 0-.177.074L9.308 8.838a3.75 3.75 0 1 0 1.854 1.854l1.155-1.157.967.322a.5.5 0 0 0 .65-.55l-.18-1.208.363-.363.727.331a.5.5 0 0 0 .69-.59l-.254-.904.647-.647A.25.25 0 0 0 16 5.75v-1.5a.25.25 0 0 0-.25-.25zM7.5 13.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z" fill="${o}"/></svg>`},pi=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}<rect x="2" y="2" width="16" height="16" rx="4" fill="${c}"/><path d="m12.223 13.314 3.052-2.826a.65.65 0 0 0 0-.984l-3.052-2.822c-.27-.25-.634-.242-.865.022-.232.263-.206.636.056.882l2.601 2.41-2.601 2.41c-.262.245-.288.619-.056.882.231.263.595.277.865.026Zm-4.444.005c.266.25.634.241.866-.027.231-.263.206-.636-.06-.882L5.983 10l2.602-2.405c.266-.25.291-.62.06-.887-.232-.263-.596-.272-.866-.022L4.723 9.51a.653.653 0 0 0 0 .983l3.056 2.827Z" fill="${o}"/></svg>`},bi=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="M6.52 12.78H5.51V8.74l-1.33.47v-.87l2.29-.83h.05v5.27zm5.2 0H8.15v-.69l1.7-1.83a6.38 6.38 0 0 0 .34-.4c.09-.11.16-.22.22-.32s.1-.19.12-.27a.9.9 0 0 0 0-.56.63.63 0 0 0-.15-.23.58.58 0 0 0-.22-.15.75.75 0 0 0-.29-.05c-.27 0-.48.08-.62.23a.95.95 0 0 0-.2.65H8.03c0-.24.04-.46.13-.67a1.67 1.67 0 0 1 .97-.91c.23-.1.49-.14.77-.14.26 0 .5.04.7.11.21.08.38.18.52.32.14.13.25.3.32.48a1.74 1.74 0 0 1 .03 1.13 2.05 2.05 0 0 1-.24.47 4.16 4.16 0 0 1-.35.47l-.47.5-1 1.05h2.32v.8zm1.8-3.08h.55c.28 0 .48-.06.61-.2a.76.76 0 0 0 .2-.55.8.8 0 0 0-.05-.28.56.56 0 0 0-.13-.22.6.6 0 0 0-.23-.15.93.93 0 0 0-.32-.05.92.92 0 0 0-.29.05.72.72 0 0 0-.23.12.57.57 0 0 0-.21.46H12.4a1.3 1.3 0 0 1 .5-1.04c.15-.13.33-.23.54-.3a2.48 2.48 0 0 1 1.4 0c.2.06.4.15.55.28.15.13.27.28.36.47.08.19.13.4.13.65a1.15 1.15 0 0 1-.2.65 1.36 1.36 0 0 1-.58.49c.15.05.28.12.38.2a1.14 1.14 0 0 1 .43.62c.03.13.05.26.05.4 0 .25-.05.47-.14.66a1.42 1.42 0 0 1-.4.49c-.16.13-.35.23-.58.3a2.51 2.51 0 0 1-.73.1c-.22 0-.44-.03-.65-.09a1.8 1.8 0 0 1-.57-.28 1.43 1.43 0 0 1-.4-.47 1.41 1.41 0 0 1-.15-.66h1a.66.66 0 0 0 .22.5.87.87 0 0 0 .58.2c.25 0 .45-.07.6-.2a.71.71 0 0 0 .21-.56.97.97 0 0 0-.06-.36.61.61 0 0 0-.18-.25.74.74 0 0 0-.28-.15 1.33 1.33 0 0 0-.37-.04h-.55V9.7z" fill="${o}"/>
  </svg>`},yi=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path d="M8.182 12.4h3.636l.655 1.6H14l-3.454-8H9.455L6 14h1.527l.655-1.6zM10 7.44l1.36 3.651H8.64L10 7.441z" fill="${o}"/>
</svg>`},xi=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
    <path
        d="M16.2222 2H3.77778C2.8 2 2 2.8 2 3.77778V16.2222C2 17.2 2.8 18 3.77778 18H16.2222C17.2 18 17.9911 17.2 17.9911 16.2222L18 3.77778C18 2.8 17.2 2 16.2222 2Z"
        fill="${c}"
    />
    <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M7.66667 6.66669C5.73368 6.66669 4.16667 8.15907 4.16667 10C4.16667 11.841 5.73368 13.3334 7.66667 13.3334H12.3333C14.2663 13.3334 15.8333 11.841 15.8333 10C15.8333 8.15907 14.2663 6.66669 12.3333 6.66669H7.66667ZM12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61931 13.8807 7.50002 12.5 7.50002C11.1193 7.50002 10 8.61931 10 10C10 11.3807 11.1193 12.5 12.5 12.5Z"
        fill="${o}"
    />
</svg>`},gr=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
<path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.29 4.947a3.368 3.368 0 014.723.04 3.375 3.375 0 01.041 4.729l-.009.009-1.596 1.597a3.367 3.367 0 01-5.081-.364.71.71 0 011.136-.85 1.95 1.95 0 002.942.21l1.591-1.593a1.954 1.954 0 00-.027-2.733 1.95 1.95 0 00-2.732-.027l-.91.907a.709.709 0 11-1.001-1.007l.915-.911.007-.007z" fill="${o}"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.55 8.678a3.368 3.368 0 015.082.364.71.71 0 01-1.136.85 1.95 1.95 0 00-2.942-.21l-1.591 1.593a1.954 1.954 0 00.027 2.733 1.95 1.95 0 002.73.028l.906-.906a.709.709 0 111.003 1.004l-.91.91-.008.01a3.368 3.368 0 01-4.724-.042 3.375 3.375 0 01-.041-4.728l.009-.009L6.55 8.678z" fill="${o}"/>
</svg>
  `},Ri=e=>{const o=e.bgColor;return`${J}
    <path stroke="${o}" stroke-width="2" d="M12 3v14"/>
    <path stroke="${o}" stroke-width="2" stroke-linecap="round" d="M10 4h4m-4 12h4"/>
    <path d="M11 14h4a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3h-4v2h4a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4v2ZM9.5 8H5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5v2H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h4.5v2Z" fill="${o}"/>
  </svg>
`},Mi=gr,ki=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.138a.5.5 0 00.748.434l5.492-3.138a.5.5 0 000-.868L7.748 6.427A.5.5 0 007 6.862v6.276z" fill="${o}"/>
</svg>`},Si=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <path d="M10 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 9.17A4.17 4.17 0 0 1 5.83 10 4.17 4.17 0 0 1 10 5.83 4.17 4.17 0 0 1 14.17 10 4.17 4.17 0 0 1 10 14.17z" fill="${o}"/>
    <path d="M8.33 8.21a.83.83 0 1 0-.03 1.67.83.83 0 0 0 .03-1.67zm3.34 0a.83.83 0 1 0-.04 1.67.83.83 0 0 0 .04-1.67z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M14.53 13.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="M10 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 11a5 5 0 1 1 .01-10.01A5 5 0 0 1 10 15z" fill="${o}"/>
    <path d="M8 7.86a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2zm4 0a1 1 0 1 0-.04 2 1 1 0 0 0 .04-2z" fill="${o}"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 11.9a2.82 2.82 0 0 1-5.06 0l.77-.38a1.97 1.97 0 0 0 3.52 0l.77.39z" fill="${o}"/>
  </svg>`},Ti=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M12.499 10.801a.5.5 0 01.835 0l2.698 4.098a.5.5 0 01-.418.775H10.22a.5.5 0 01-.417-.775l2.697-4.098z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.07 8.934a.5.5 0 01.824 0l4.08 5.958a.5.5 0 01-.412.782h-8.16a.5.5 0 01-.413-.782l4.08-5.958zM13.75 8.333a2.083 2.083 0 100-4.166 2.083 2.083 0 000 4.166z" fill="${o}"/>
</svg>`},Ei=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <path fill="${o}" d="M3 3h14v14H3z"/>
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2zm-7.24 9.78h1.23c.15 0 .27.06.36.18l.98 1.28a.43.43 0 0 1-.05.58l-1.2 1.21a.45.45 0 0 1-.6.04A6.72 6.72 0 0 1 7.33 10c0-.61.1-1.2.25-1.78a6.68 6.68 0 0 1 2.12-3.3.44.44 0 0 1 .6.04l1.2 1.2c.16.17.18.42.05.59l-.98 1.29a.43.43 0 0 1-.36.17H8.98A5.38 5.38 0 0 0 8.67 10c0 .62.11 1.23.3 1.79z" fill="${c}"/>
  </svg>`},zi=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="m13.49 13.15-2.32-3.27h1.4V7h1.86v2.88h1.4l-2.34 3.27zM11 13H9v-3l-1.5 1.92L6 10v3H4V7h2l1.5 2L9 7h2v6z" fill="${o}"/>
  </svg>`},Li=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path d="M14.8 4.182h-.6V3H13v1.182H7V3H5.8v1.182h-.6c-.66 0-1.2.532-1.2 1.182v9.454C4 15.468 4.54 16 5.2 16h9.6c.66 0 1.2-.532 1.2-1.182V5.364c0-.65-.54-1.182-1.2-1.182zm0 10.636H5.2V7.136h9.6v7.682z" fill="${o}"/>
</svg>`},Hi=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="M10 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6 6 6 0 0 0-6-6zm0 10.8A4.8 4.8 0 0 1 5.2 10a4.8 4.8 0 1 1 4.8 4.8z" fill="${o}"/>
    <path d="M10 7H9v3.93L12.5 13l.5-.8-3-1.76V7z" fill="${o}"/>
  </svg>`},Di=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 8.643a1.357 1.357 0 100 2.714 1.357 1.357 0 000-2.714zM7.357 10a2.643 2.643 0 115.286 0 2.643 2.643 0 01-5.286 0z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.589 4.898A5.643 5.643 0 0115.643 10v.5a2.143 2.143 0 01-4.286 0V8a.643.643 0 011.286 0v2.5a.857.857 0 001.714 0V10a4.357 4.357 0 10-1.708 3.46.643.643 0 01.782 1.02 5.643 5.643 0 11-5.842-9.582z" fill="${o}"/>
</svg>`},Ii=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <rect x="2" y="8" width="10" height="8" rx="2" fill="${c}"/>
    <rect x="8" y="4" width="10" height="8" rx="2" fill="${c}"/>
    <path d="M10.68 7.73V6l2.97 3.02-2.97 3.02v-1.77c-2.13 0-3.62.7-4.68 2.2.43-2.15 1.7-4.31 4.68-4.74z" fill="${o}"/>
  </svg>`},Fi=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <path fill="${o}" d="M4 3h12v14H4z"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.6 2A1.6 1.6 0 002 3.6v12.8A1.6 1.6 0 003.6 18h12.8a1.6 1.6 0 001.6-1.6V3.6A1.6 1.6 0 0016.4 2H3.6zm11.3 10.8a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7h-1.4a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.6-.693.117.117 0 00.1-.115V10.35a.117.117 0 00-.117-.116h-2.8a.117.117 0 00-.117.116v2.333c0 .064.053.117.117.117h.117a.7.7 0 01.7.7v1.4a.7.7 0 01-.7.7H9.3a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.117a.117.117 0 00.117-.117V10.35a.117.117 0 00-.117-.117h-2.8a.117.117 0 00-.117.117v2.342c0 .058.042.106.1.115a.7.7 0 01.6.693v1.4a.7.7 0 01-.7.7H5.1a.7.7 0 01-.7-.7v-1.4a.7.7 0 01.7-.7h.35a.116.116 0 00.116-.117v-2.45c0-.515.418-.933.934-.933h2.917a.117.117 0 00.117-.117V6.85a.117.117 0 00-.117-.116h-2.45a.7.7 0 01-.7-.7V5.1a.7.7 0 01.7-.7h6.067a.7.7 0 01.7.7v.934a.7.7 0 01-.7.7h-2.45a.117.117 0 00-.118.116v2.333c0 .064.053.117.117.117H13.5c.516 0 .934.418.934.934v2.45c0 .063.052.116.116.116h.35z" fill="${c}"/>
</svg>`},$i=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
    <path d="M9.98 13.33c.45 0 .74-.3.73-.75l-.01-.1-.16-1.67 1.45 1.05a.81.81 0 0 0 .5.18c.37 0 .72-.32.72-.76 0-.3-.17-.54-.49-.68l-1.63-.77 1.63-.77c.32-.14.49-.37.49-.67 0-.45-.34-.76-.71-.76a.81.81 0 0 0-.5.18l-1.47 1.03.16-1.74.01-.08c.01-.46-.27-.76-.72-.76-.46 0-.76.32-.75.76l.01.08.16 1.74-1.47-1.03a.77.77 0 0 0-.5-.18.74.74 0 0 0-.72.76c0 .3.17.53.49.67l1.63.77-1.62.77c-.32.14-.5.37-.5.68 0 .44.35.75.72.75a.78.78 0 0 0 .5-.17L9.4 10.8l-.16 1.68v.09c-.02.44.28.75.74.75z" fill="${o}"/>
  </svg>`},Ai=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
    <path d="M8 5.83H5.83a.83.83 0 0 0 0 1.67h1.69A4.55 4.55 0 0 1 8 5.83zm-.33 3.34H5.83a.83.83 0 0 0 0 1.66h2.72a4.57 4.57 0 0 1-.88-1.66zM5.83 12.5a.83.83 0 0 0 0 1.67h7.5a.83.83 0 1 0 0-1.67h-7.5zm8.8-2.9a3.02 3.02 0 0 0 .46-1.6c0-1.66-1.32-3-2.94-3C10.52 5 9.2 6.34 9.2 8s1.31 3 2.93 3c.58 0 1.11-.17 1.56-.47l2.04 2.08.93-.94-2.04-2.08zm-2.48.07c-.9 0-1.63-.75-1.63-1.67s.73-1.67 1.63-1.67c.9 0 1.63.75 1.63 1.67s-.73 1.67-1.63 1.67z" fill="${o}"/>
  </svg>`},Pi=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path d="M7.676 4.726V3l2.976 3.021-2.976 3.022v-1.77c-2.125 0-3.613.69-4.676 2.201.425-2.158 1.7-4.316 4.676-4.748zM10.182 14.4h3.636l.655 1.6H16l-3.454-8h-1.091L8 16h1.527l.655-1.6zM12 9.44l1.36 3.65h-2.72L12 9.44z" fill="${o}"/>
</svg>`},Gi=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.167 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666H4.167z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.083 4.167a.833.833 0 10-1.666 0v4.166a.833.833 0 101.666 0V4.167zM11.667 5.417a.833.833 0 100 1.666h4.166a.833.833 0 100-1.666h-4.166zM5.367 11.688a.833.833 0 00-1.179 1.179l2.947 2.946a.833.833 0 001.178-1.178l-2.946-2.947z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.313 12.867a.833.833 0 10-1.178-1.179l-2.947 2.947a.833.833 0 101.179 1.178l2.946-2.946z" fill="${o}"/>
  <path d="M10.833 12.5c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833zM10.833 15c0-.46.373-.833.834-.833h4.166a.833.833 0 110 1.666h-4.166a.833.833 0 01-.834-.833z" fill="${o}"/>
</svg>`},Ki=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <path d="M16.22 2H3.78C2.8 2 2 2.8 2 3.78v12.44C2 17.2 2.8 18 3.78 18h12.44c.98 0 1.77-.8 1.77-1.78L18 3.78C18 2.8 17.2 2 16.22 2z" fill="${c}"/>
    <path d="M10 8.84a1.16 1.16 0 1 0 0 2.32 1.16 1.16 0 0 0 0-2.32zm3.02 3.61a3.92 3.92 0 0 0 .78-3.28.49.49 0 1 0-.95.2c.19.87-.02 1.78-.58 2.47a2.92 2.92 0 1 1-4.13-4.08 2.94 2.94 0 0 1 2.43-.62.49.49 0 1 0 .17-.96 3.89 3.89 0 1 0 2.28 6.27zM10 4.17a5.84 5.84 0 0 0-5.44 7.93.49.49 0 1 0 .9-.35 4.86 4.86 0 1 1 2.5 2.67.49.49 0 1 0-.4.88c.76.35 1.6.54 2.44.53a5.83 5.83 0 0 0 0-11.66zm3.02 3.5a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0zm-6.97 5.35a.7.7 0 1 1 0 1.4.7.7 0 0 1 0-1.4z" fill="${o}"/>
  </svg>`},Ni=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path d="M12.4 13.565c1.865-.545 3.645-2.083 3.645-4.396 0-1.514-.787-2.604-2.071-2.604C12.69 6.565 12 7.63 12 8.939c1.114.072 1.865.726 1.865 1.683 0 .933-.8 1.647-1.84 2.023l.375.92zM4 5h6v2H4zM4 9h5v2H4zM4 13h4v2H4z" fill="${o}"/>
</svg>`},Oi=e=>{const o=e.fgColor,c=e.bgColor;return`
    ${J}
    <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
    <path d="M12.4 13.56c1.86-.54 3.65-2.08 3.65-4.4 0-1.5-.8-2.6-2.08-2.6S12 7.64 12 8.95c1.11.07 1.86.73 1.86 1.68 0 .94-.8 1.65-1.83 2.03l.37.91zM4 5h6v2H4zm0 4h5v2H4zm0 4h4v2H4z" fill="${o}"/>
  </svg>`},Wi=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <path d="M16.222 2H3.778C2.8 2 2 2.8 2 3.778v12.444C2 17.2 2.8 18 3.778 18h12.444c.978 0 1.77-.8 1.77-1.778L18 3.778C18 2.8 17.2 2 16.222 2z" fill="${c}"/>
  <path d="M10 7a1 1 0 100-2v2zm0 6a1 1 0 100 2v-2zm0-8H7v2h3V5zm-3 6h5V9H7v2zm5 2h-2v2h2v-2zm1-1a1 1 0 01-1 1v2a3 3 0 003-3h-2zm-1-1a1 1 0 011 1h2a3 3 0 00-3-3v2zM4 8a3 3 0 003 3V9a1 1 0 01-1-1H4zm3-3a3 3 0 00-3 3h2a1 1 0 011-1V5z" fill="${o}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.856 12.014a.5.5 0 00-.712.702L5.409 14l-1.265 1.284a.5.5 0 00.712.702l1.255-1.274 1.255 1.274a.5.5 0 00.712-.702L6.813 14l1.265-1.284a.5.5 0 00-.712-.702L6.11 13.288l-1.255-1.274zM12.856 4.014a.5.5 0 00-.712.702L13.409 6l-1.265 1.284a.5.5 0 10.712.702l1.255-1.274 1.255 1.274a.5.5 0 10.712-.702L14.813 6l1.265-1.284a.5.5 0 00-.712-.702L14.11 5.288l-1.255-1.274z" fill="${o}"/>
</svg>`},Ui=e=>{const o=e.fgColor,c=e.bgColor;return`${J}
  <rect x="2" y="2" width="16" height="16" rx="2" fill="${c}"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M14.25 7.25a.75.75 0 000-1.5h-6.5a.75.75 0 100 1.5h6.5zM15 10a.75.75 0 01-.75.75h-6.5a.75.75 0 010-1.5h6.5A.75.75 0 0115 10zm-.75 4.25a.75.75 0 000-1.5h-6.5a.75.75 0 000 1.5h6.5zm-8.987-7a.75.75 0 100-1.5.75.75 0 000 1.5zm.75 2.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm-.75 4.25a.75.75 0 100-1.5.75.75 0 000 1.5z" fill="${o}"/>
</svg>`},Vi=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 15v1h14v-2.5c0-.87-.44-1.55-.98-2.04a6.19 6.19 0 0 0-1.9-1.14 12.1 12.1 0 0 0-2.48-.67A4 4 0 1 0 5 6a4 4 0 0 0 2.36 3.65c-.82.13-1.7.36-2.48.67-.69.28-1.37.65-1.9 1.13A2.8 2.8 0 0 0 2 13.5V15z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>`},Bi=e=>{const o=e.fgColor;return`
    <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.43 6.04v-.18a3.86 3.86 0 0 0-7.72 0v.18A2.15 2.15 0 0 0 3 8.14v5.72C3 15.04 3.96 16 5.14 16H12c1.18 0 2.14-.96 2.14-2.14V8.14c0-1.03-.73-1.9-1.71-2.1zM7.86 6v-.14a.71.71 0 1 1 1.43 0V6H7.86z" fill="${e.bgColor}" stroke="${o}" stroke-width="2"/>
  </svg>
`},Xi=e=>{const o=e.fgColor;return e.bgColor,`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="${o}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-icon lucide-arrow-down"><path d="M12 5v14"/><path d="m19 12-7 7-7-7"/></svg>
  `},_i=e=>{const o=e.fgColor;return e.bgColor,`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="${o}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-icon lucide-arrow-up"><path d="m5 12 7-7 7 7"/><path d="M12 19V5"/></svg>
`},Yi={headerRowID:Ci,headerNumber:bi,headerCode:pi,headerString:yi,headerBoolean:xi,headerAudioUri:Mi,headerVideoUri:ki,headerEmoji:Si,headerImage:Ti,headerUri:gr,headerPhone:Ei,headerMarkdown:zi,headerDate:Li,headerTime:Hi,headerEmail:Di,headerReference:Ii,headerIfThenElse:Fi,headerSingleValue:$i,headerLookup:Ai,headerTextTemplate:Pi,headerMath:Gi,headerRollup:Ki,headerJoinStrings:Ni,headerSplitString:Oi,headerGeoDistance:Wi,headerArray:Ui,rowOwnerOverlay:Vi,protectedColumnOverlay:Bi,renameIcon:Ri,headerArrowDown:Xi,headerArrowUp:_i},qi=Cn("div")({name:"SearchWrapper",class:"slyseh9",propsAsIs:!1}),ji=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})),Zi=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})),Ji=l.createElement("svg",{className:"button-icon",viewBox:"0 0 512 512"},l.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368L144 144M368 144L144 368"})),Qi=10,ec=e=>{const{canvasRef:o,cellYOffset:c,rows:f,columns:C,searchInputRef:x,searchValue:H,searchResults:b,onSearchValueChange:M,getCellsForSelection:z,onSearchResultsChanged:m,showSearch:R=!1,onSearchClose:T}=e,[N]=l.useState(()=>"search-box-"+Math.round(Math.random()*1e3)),[U,q]=l.useState(""),me=H??U,V=l.useCallback(L=>{q(L),M==null||M(L)},[M]),[D,O]=l.useState(),be=l.useRef(D);be.current=D,l.useEffect(()=>{b!==void 0&&(b.length>0?O(L=>({rowsSearched:f,results:b.length,selectedIndex:(L==null?void 0:L.selectedIndex)??-1})):O(void 0))},[f,b]);const Q=l.useRef();Q.current===void 0&&(Q.current=new AbortController);const he=l.useRef(),[Y,oe]=l.useState([]),re=b??Y,Z=l.useCallback(()=>{he.current!==void 0&&(window.cancelAnimationFrame(he.current),he.current=void 0),Q.current!==void 0&&Q.current.abort(),Q.current=new AbortController},[]),Ye=l.useRef(c);Ye.current=c;const Le=l.useCallback(L=>{const ce=new RegExp(L.replace(/([$()*+.?[\\\]^{|}-])/g,"\\$1"),"i");let de=Ye.current,De=Math.min(10,f),Ke=0;O(void 0),oe([]);const vt=[],lo=async()=>{var nt;if(z===void 0)return;const Wo=performance.now(),Wt=f-Ke;let mt=z({x:0,y:de,width:C.length,height:Math.min(De,Wt,f-de)},Q.current.signal);typeof mt=="function"&&(mt=await mt());let io=!1;for(const[je,ye]of mt.entries())for(const[ke,Ze]of ye.entries()){let Je;switch(Ze.kind){case te.Text:case te.Number:Je=Ze.displayData;break;case te.Uri:case te.Markdown:Je=Ze.data;break;case te.Boolean:Je=typeof Ze.data=="boolean"?Ze.data.toString():void 0;break;case te.Image:case te.Bubble:Je=Ze.data.join("üê≥");break;case te.Custom:Je=Ze.copyData;break}Je!==void 0&&ce.test(Je)&&(vt.push([ke,je+de]),io=!0)}const Uo=performance.now();io&&oe([...vt]),Ke+=mt.length,Ko(Ke<=f);const qe=((nt=be.current)==null?void 0:nt.selectedIndex)??-1;O({results:vt.length,rowsSearched:Ke,selectedIndex:qe}),m==null||m(vt,qe),de+De>=f?de=0:de+=De;const ot=Uo-Wo,wt=Math.max(ot,1),Ct=Qi/wt;De=Math.ceil(De*Ct),Ke<f&&vt.length<1e3&&(he.current=window.requestAnimationFrame(lo))};Z(),he.current=window.requestAnimationFrame(lo)},[Z,C.length,z,m,f]),Me=l.useCallback(()=>{var L;T==null||T(),O(void 0),oe([]),m==null||m([],-1),Z(),(L=o==null?void 0:o.current)==null||L.focus()},[Z,o,T,m]),ro=l.useCallback(L=>{V(L.target.value),b===void 0&&(L.target.value===""?(O(void 0),oe([]),Z()):Le(L.target.value))},[Le,Z,V,b]);l.useEffect(()=>{x.current!==null&&(V(""),O(void 0),Y.length>0&&(oe([]),m==null||m([],-1)),R?x.current.focus({preventScroll:!0}):Z())},[R,x]);const gt=l.useCallback(L=>{var de;if((de=L==null?void 0:L.stopPropagation)==null||de.call(L),D===void 0||D.results===0)return;const ce=(D.selectedIndex+1)%D.results;O({...D,selectedIndex:ce}),m==null||m(re,ce)},[D,m,re]),He=l.useCallback(L=>{var de;if((de=L==null?void 0:L.stopPropagation)==null||de.call(L),D===void 0||D.results===0)return;let ce=(D.selectedIndex-1)%D.results;ce<0&&(ce+=D.results),O({...D,selectedIndex:ce}),m==null||m(re,ce)},[m,re,D]),Pe=l.useCallback(L=>{(L.ctrlKey||L.metaKey)&&L.nativeEvent.code==="KeyF"||L.key==="Escape"?(Me(),L.stopPropagation(),L.preventDefault()):L.key==="Enter"&&(L.shiftKey?He():gt())},[Me,gt,He]);l.useEffect(()=>()=>{Z()},[Z]);const[Ot,Ge]=l.useState(!1);l.useEffect(()=>{if(R)Ge(!0);else{const L=setTimeout(()=>Ge(!1),150);return()=>clearTimeout(L)}},[R]);const Oo=l.useMemo(()=>{if(!R&&!Ot)return null;let L;D!==void 0&&(L=D.results>=1e3?"over 1000":`${D.results} result${D.results!==1?"s":""}`,D.selectedIndex>=0&&(L=`${D.selectedIndex+1} of ${L}`));const ce=Ke=>{Ke.stopPropagation()},De={width:`${f>0?Math.floor(((D==null?void 0:D.rowsSearched)??0)/f*100):0}%`};return l.createElement(qi,{className:"gdg-search-bar"+(R?"":" out"),onMouseDown:ce,onMouseMove:ce,onMouseUp:ce,onClick:ce},l.createElement("div",{className:"gdg-search-bar-inner"},l.createElement("input",{id:N,"aria-hidden":!R,"data-testid":"search-input",ref:x,onChange:ro,value:me,tabIndex:R?void 0:-1,onKeyDownCapture:Pe}),l.createElement("button",{type:"button","aria-label":"Previous Result","aria-hidden":!R,tabIndex:R?void 0:-1,onClick:He,disabled:((D==null?void 0:D.results)??0)===0},ji),l.createElement("button",{type:"button","aria-label":"Next Result","aria-hidden":!R,tabIndex:R?void 0:-1,onClick:gt,disabled:((D==null?void 0:D.results)??0)===0},Zi),T!==void 0&&l.createElement("button",{type:"button","aria-label":"Close Search","aria-hidden":!R,"data-testid":"search-close-button",tabIndex:R?void 0:-1,onClick:Me},Ji)),D!==void 0?l.createElement(l.Fragment,null,l.createElement("div",{className:"gdg-search-status"},l.createElement("div",{"data-testid":"search-result-area"},L)),l.createElement("div",{className:"gdg-search-progress",style:De})):l.createElement("div",{className:"gdg-search-status"},l.createElement("label",{htmlFor:N},"Type to search")))},[R,Ot,D,f,N,x,ro,me,Pe,He,gt,T,Me]);return l.createElement(l.Fragment,null,l.createElement(wi,{prelightCells:re,accessibilityHeight:e.accessibilityHeight,canvasRef:e.canvasRef,cellXOffset:e.cellXOffset,cellYOffset:e.cellYOffset,className:e.className,clientSize:e.clientSize,columns:e.columns,disabledRows:e.disabledRows,enableGroups:e.enableGroups,fillHandle:e.fillHandle,firstColAccessible:e.firstColAccessible,nonGrowWidth:e.nonGrowWidth,fixedShadowX:e.fixedShadowX,fixedShadowY:e.fixedShadowY,freezeColumns:e.freezeColumns,getCellContent:e.getCellContent,getCellRenderer:e.getCellRenderer,getGroupDetails:e.getGroupDetails,getRowThemeOverride:e.getRowThemeOverride,groupHeaderHeight:e.groupHeaderHeight,headerHeight:e.headerHeight,highlightRegions:e.highlightRegions,imageWindowLoader:e.imageWindowLoader,initialSize:e.initialSize,isFilling:e.isFilling,isFocused:e.isFocused,lockColumns:e.lockColumns,maxColumnWidth:e.maxColumnWidth,minColumnWidth:e.minColumnWidth,onHeaderMenuClick:e.onHeaderMenuClick,onHeaderIndicatorClick:e.onHeaderIndicatorClick,onMouseMove:e.onMouseMove,onVisibleRegionChanged:e.onVisibleRegionChanged,overscrollX:e.overscrollX,overscrollY:e.overscrollY,preventDiagonalScrolling:e.preventDiagonalScrolling,rightElement:e.rightElement,rightElementProps:e.rightElementProps,rowHeight:e.rowHeight,rows:e.rows,scrollRef:e.scrollRef,selection:e.selection,theme:e.theme,freezeTrailingRows:e.freezeTrailingRows,hasAppendRow:e.hasAppendRow,translateX:e.translateX,translateY:e.translateY,verticalBorder:e.verticalBorder,onColumnProposeMove:e.onColumnProposeMove,drawFocusRing:e.drawFocusRing,drawCell:e.drawCell,drawHeader:e.drawHeader,experimental:e.experimental,gridRef:e.gridRef,headerIcons:e.headerIcons,isDraggable:e.isDraggable,onCanvasBlur:e.onCanvasBlur,onCanvasFocused:e.onCanvasFocused,onCellFocused:e.onCellFocused,onColumnMoved:e.onColumnMoved,onColumnResize:e.onColumnResize,onColumnResizeEnd:e.onColumnResizeEnd,onColumnResizeStart:e.onColumnResizeStart,onContextMenu:e.onContextMenu,onDragEnd:e.onDragEnd,onDragLeave:e.onDragLeave,onDragOverCell:e.onDragOverCell,onDragStart:e.onDragStart,onDrop:e.onDrop,onItemHovered:e.onItemHovered,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onRowMoved:e.onRowMoved,smoothScrollX:e.smoothScrollX,smoothScrollY:e.smoothScrollY,resizeIndicator:e.resizeIndicator}),Oo)};class tc extends l.PureComponent{constructor(){super(...arguments);fn(this,"wrapperRef",l.createRef());fn(this,"clickOutside",c=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(c))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(c.target)){let f=c.target;for(;f!==null;){if(f.classList.contains("click-outside-ignore"))return;f=f.parentElement}this.props.onClickOutside()}})}componentDidMount(){const c=this.props.customEventTarget??document;c.addEventListener("pointerdown",this.clickOutside,!0),c.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const c=this.props.customEventTarget??document;c.removeEventListener("pointerdown",this.clickOutside,!0),c.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:c,isOutsideClick:f,customEventTarget:C,...x}=this.props;return l.createElement("div",{...x,ref:this.wrapperRef},this.props.children)}}const oc=()=>e=>Math.max(16,e.targetHeight-10),nc=Cn("input")({name:"RenameInput",class:"r1fzhvm4",propsAsIs:!1,vars:{"r1fzhvm4-0":[oc(),"px"]}}),rc=e=>{const{bounds:o,group:c,onClose:f,canvasBounds:C,onFinish:x}=e,[H,b]=fe.useState(c);return fe.createElement(tc,{style:{position:"absolute",left:o.x-C.left+1,top:o.y-C.top,width:o.width-2,height:o.height},className:"c181oggi",onClickOutside:f},fe.createElement(nc,{targetHeight:o.height,"data-testid":"group-rename-input",value:H,onBlur:f,onFocus:M=>M.target.setSelectionRange(0,H.length),onChange:M=>b(M.target.value),onKeyDown:M=>{M.key==="Enter"?x(H):M.key==="Escape"&&f()},autoFocus:!0}))},mn=150;function lc(e,o,c,f){var x;const C=f(o);return((x=C==null?void 0:C.measure)==null?void 0:x.call(C,e,o,c))??mn}function vr(e,o,c,f,C,x,H,b,M){let z=0;const m=C===void 0?[]:C.map(N=>{const U=lc(e,N[f],o,M);return z=Math.max(z,U),U});if(m.length>5&&b){z=0;let N=0;for(const q of m)N+=q;const U=N/m.length;for(let q=0;q<m.length;q++)m[q]>=U*2?m[q]=0:z=Math.max(z,m[q])}const R=e.font;e.font=o.headerFontFull,z=Math.max(z,e.measureText(c.title).width+o.cellHorizontalPadding*2+(c.icon===void 0?0:28)),e.font=R;const T=Math.max(Math.ceil(x),Math.min(Math.floor(H),Math.ceil(z)));return{...c,width:T}}function ic(e,o,c,f,C,x,H,b,M){const z=l.useRef(o),m=l.useRef(c),R=l.useRef(H);z.current=o,m.current=c,R.current=H;const[T,N]=l.useMemo(()=>{if(typeof window>"u")return[null,null];const D=document.createElement("canvas");return D.style.display="none",D.style.opacity="0",D.style.position="fixed",[D,D.getContext("2d",{alpha:!1})]},[]);l.useLayoutEffect(()=>(T&&document.documentElement.append(T),()=>{T==null||T.remove()}),[T]);const U=l.useRef({}),q=l.useRef(),[me,V]=l.useState();return l.useLayoutEffect(()=>{const D=m.current;if(D===void 0||e.every(Fo))return;let O=Math.max(1,10-Math.floor(e.length/1e4)),be=0;O<z.current&&O>1&&(O--,be=1);const Q={x:0,y:0,width:e.length,height:Math.min(z.current,O)},he={x:0,y:z.current-1,width:e.length,height:1};(async()=>{const oe=D(Q,M.signal),re=be>0?D(he,M.signal):void 0;let Z;typeof oe=="object"?Z=oe:Z=await nr(oe),re!==void 0&&(typeof re=="object"?Z=[...Z,...re]:Z=[...Z,...await nr(re)]),q.current=e,V(Z)})()},[M.signal,e]),l.useMemo(()=>{let O=e.every(Fo)?e:N===null?e.map(Y=>Fo(Y)?Y:{...Y,width:mn}):(N.font=R.current.baseFontFull,e.map((Y,oe)=>{if(Fo(Y))return Y;if(U.current[Y.id]!==void 0)return{...Y,width:U.current[Y.id]};if(me===void 0||q.current!==e||Y.id===void 0)return{...Y,width:mn};const re=vr(N,H,Y,oe,me,C,x,!0,b);return U.current[Y.id]=re.width,re})),be=0,Q=0;const he=[];for(const[Y,oe]of O.entries())be+=oe.width,oe.grow!==void 0&&oe.grow>0&&(Q+=oe.grow,he.push(Y));if(be<f&&he.length>0){const Y=[...O],oe=f-be;let re=oe;for(let Z=0;Z<he.length;Z++){const Ye=he[Z],Le=(O[Ye].grow??0)/Q,Me=Z===he.length-1?re:Math.min(re,Math.floor(oe*Le));Y[Ye]={...O[Ye],growOffset:Me,width:O[Ye].width+Me},re-=Me}O=Y}return{sizedColumns:O,nonGrowWidth:be}},[f,e,N,me,H,C,x,b])}function cc(e,o){return e===void 0?!1:e.length>1&&e.startsWith("_")?Number.parseInt(e.slice(1))===o.keyCode:e.length===1&&e>="a"&&e<="z"?e.toUpperCase().codePointAt(0)===o.keyCode:e===o.key}function G(e,o,c){const f=mr(e,o);return f&&(c.didMatch=!0),f}function mr(e,o){if(e.length===0)return!1;if(e.includes("|")){const M=e.split("|");for(const z of M)if(mr(z,o))return!0;return!1}let c=!1,f=!1,C=!1,x=!1;const H=e.split("+"),b=H.pop();if(!cc(b,o))return!1;if(H[0]==="any")return!0;for(const M of H)switch(M){case"ctrl":c=!0;break;case"shift":f=!0;break;case"alt":C=!0;break;case"meta":x=!0;break;case"primary":No.value?x=!0:c=!0;break}return o.altKey===C&&o.ctrlKey===c&&o.shiftKey===f&&o.metaKey===x}function sc(e,o,c,f,C,x,H){const b=fe.useCallback((m,R,T,N)=>{var O;(x==="cell"||x==="multi-cell")&&m!==void 0&&(m={...m,range:{x:m.cell[0],y:m.cell[1],width:1,height:1}}),!H&&m!==void 0&&m.range.width>1&&(m={...m,range:{...m.range,width:1,x:m.cell[0]}});const U=c==="mixed"&&(T||N==="drag")||c==="additive",q=(f==="mixed"||f==="additive")&&U,me=(C==="mixed"||C==="additive")&&U;let V={current:m===void 0?void 0:{...m,rangeStack:N==="drag"?((O=e.current)==null?void 0:O.rangeStack)??[]:[]},columns:q?e.columns:_.empty(),rows:me?e.rows:_.empty()};T&&(x==="multi-rect"||x==="multi-cell")&&V.current!==void 0&&e.current!==void 0&&(V={...V,current:{...V.current,rangeStack:[...e.current.rangeStack,e.current.range]}}),o(V,R)},[f,e,c,x,H,C,o]),M=fe.useCallback((m,R,T)=>{m=m??e.rows,R!==void 0&&(m=m.add(R));let N;if(C==="exclusive"&&m.length>0)N={current:void 0,columns:_.empty(),rows:m};else{const U=T&&c==="mixed"||c==="additive",q=T&&f==="mixed"||f==="additive";N={current:U?e.current:void 0,columns:q?e.columns:_.empty(),rows:m}}o(N,!1)},[f,e,c,C,o]),z=fe.useCallback((m,R,T)=>{m=m??e.columns,R!==void 0&&(m=m.add(R));let N;if(f==="exclusive"&&m.length>0)N={current:void 0,rows:_.empty(),columns:m};else{const U=T&&c==="mixed"||c==="additive",q=T&&C==="mixed"||C==="additive";N={current:U?e.current:void 0,rows:q?e.rows:_.empty(),columns:m}}o(N,!1)},[f,e,c,C,o]);return[b,M,z]}function ac(e,o,c,f,C){const x=l.useCallback(z=>{if(e===!0){const m=[];for(let R=z.y;R<z.y+z.height;R++){const T=[];for(let N=z.x;N<z.x+z.width;N++)N<0||R>=C?T.push({kind:te.Loading,allowOverlay:!1}):T.push(o([N,R]));m.push(T)}return m}return(e==null?void 0:e(z,f.signal))??[]},[f.signal,o,e,C]),H=e!==void 0?x:void 0,b=l.useCallback(z=>{if(H===void 0)return[];const m={...z,x:z.x-c};if(m.x<0){m.x=0,m.width--;const R=H(m,f.signal);return typeof R=="function"?async()=>(await R()).map(T=>[{kind:te.Loading,allowOverlay:!1},...T]):R.map(T=>[{kind:te.Loading,allowOverlay:!1},...T])}return H(m,f.signal)},[f.signal,H,c]);return[e!==void 0?b:void 0,H]}function dr(e){return typeof e=="string"?e:`${e}px`}const uc=()=>e=>e.innerWidth,dc=()=>e=>e.innerHeight,fc=Cn("div")({name:"Wrapper",class:"w2q57ts",propsAsIs:!1,vars:{"w2q57ts-0":[uc()],"w2q57ts-1":[dc()]}}),hc=e=>{const{inWidth:o,inHeight:c,children:f,...C}=e;return l.createElement(fc,{innerHeight:dr(c),innerWidth:dr(o),...C},f)},gc=2,vc=1300;function mc(e,o,c){const f=fe.useRef(0),[C,x]=e??[0,0];fe.useEffect(()=>{if(C===0&&x===0){f.current=0;return}let H=!1,b=0;const M=z=>{var m;if(!H){if(b===0)b=z;else{const R=z-b;f.current=Math.min(1,f.current+R/vc);const T=f.current**1.618*R*gc;(m=o.current)==null||m.scrollBy(C*T,x*T),b=z,c==null||c()}window.requestAnimationFrame(M)}};return window.requestAnimationFrame(M),()=>{H=!0}},[o,C,x,c])}function wc({rowHeight:e,headerHeight:o,groupHeaderHeight:c,theme:f,overscrollX:C,overscrollY:x,scaleToRem:H,remSize:b}){const[M,z,m,R,T,N]=fe.useMemo(()=>{if(!H||b===16)return[e,o,c,f,C,x];const U=b/16,q=e,me=hr();return[typeof q=="number"?q*U:V=>Math.ceil(q(V)*U),Math.ceil(o*U),Math.ceil(c*U),{...f,headerIconSize:((f==null?void 0:f.headerIconSize)??me.headerIconSize)*U,cellHorizontalPadding:((f==null?void 0:f.cellHorizontalPadding)??me.cellHorizontalPadding)*U,cellVerticalPadding:((f==null?void 0:f.cellVerticalPadding)??me.cellVerticalPadding)*U},Math.ceil((C??0)*U),Math.ceil((x??0)*U)]},[c,o,C,x,b,e,H,f]);return{rowHeight:M,headerHeight:z,groupHeaderHeight:m,theme:R,overscrollX:T,overscrollY:N}}const ft={downFill:!1,rightFill:!1,clear:!0,closeOverlay:!0,acceptOverlayDown:!0,acceptOverlayUp:!0,acceptOverlayLeft:!0,acceptOverlayRight:!0,copy:!0,paste:!0,cut:!0,search:!1,delete:!0,activateCell:!0,scrollToSelectedCell:!0,goToFirstCell:!0,goToFirstColumn:!0,goToFirstRow:!0,goToLastCell:!0,goToLastColumn:!0,goToLastRow:!0,goToNextPage:!0,goToPreviousPage:!0,selectToFirstCell:!0,selectToFirstColumn:!0,selectToFirstRow:!0,selectToLastCell:!0,selectToLastColumn:!0,selectToLastRow:!0,selectAll:!0,selectRow:!0,selectColumn:!0,goUpCell:!0,goRightCell:!0,goDownCell:!0,goLeftCell:!0,goUpCellRetainSelection:!0,goRightCellRetainSelection:!0,goDownCellRetainSelection:!0,goLeftCellRetainSelection:!0,selectGrowUp:!0,selectGrowRight:!0,selectGrowDown:!0,selectGrowLeft:!0};function K(e,o){return e===!0?o:e===!1?"":e}function fr(e){const o=No.value;return{activateCell:K(e.activateCell," |Enter|shift+Enter"),clear:K(e.clear,"any+Escape"),closeOverlay:K(e.closeOverlay,"any+Escape"),acceptOverlayDown:K(e.acceptOverlayDown,"Enter"),acceptOverlayUp:K(e.acceptOverlayUp,"shift+Enter"),acceptOverlayLeft:K(e.acceptOverlayLeft,"shift+Tab"),acceptOverlayRight:K(e.acceptOverlayRight,"Tab"),copy:e.copy,cut:e.cut,delete:K(e.delete,o?"Backspace|Delete":"Delete"),downFill:K(e.downFill,"primary+_68"),scrollToSelectedCell:K(e.scrollToSelectedCell,"primary+Enter"),goDownCell:K(e.goDownCell,"ArrowDown"),goDownCellRetainSelection:K(e.goDownCellRetainSelection,"alt+ArrowDown"),goLeftCell:K(e.goLeftCell,"ArrowLeft|shift+Tab"),goLeftCellRetainSelection:K(e.goLeftCellRetainSelection,"alt+ArrowLeft"),goRightCell:K(e.goRightCell,"ArrowRight|Tab"),goRightCellRetainSelection:K(e.goRightCellRetainSelection,"alt+ArrowRight"),goUpCell:K(e.goUpCell,"ArrowUp"),goUpCellRetainSelection:K(e.goUpCellRetainSelection,"alt+ArrowUp"),goToFirstCell:K(e.goToFirstCell,"primary+Home"),goToFirstColumn:K(e.goToFirstColumn,"Home|primary+ArrowLeft"),goToFirstRow:K(e.goToFirstRow,"primary+ArrowUp"),goToLastCell:K(e.goToLastCell,"primary+End"),goToLastColumn:K(e.goToLastColumn,"End|primary+ArrowRight"),goToLastRow:K(e.goToLastRow,"primary+ArrowDown"),goToNextPage:K(e.goToNextPage,"PageDown"),goToPreviousPage:K(e.goToPreviousPage,"PageUp"),paste:e.paste,rightFill:K(e.rightFill,"primary+_82"),search:K(e.search,"primary+f"),selectAll:K(e.selectAll,"primary+a"),selectColumn:K(e.selectColumn,"ctrl+ "),selectGrowDown:K(e.selectGrowDown,"shift+ArrowDown"),selectGrowLeft:K(e.selectGrowLeft,"shift+ArrowLeft"),selectGrowRight:K(e.selectGrowRight,"shift+ArrowRight"),selectGrowUp:K(e.selectGrowUp,"shift+ArrowUp"),selectRow:K(e.selectRow,"shift+ "),selectToFirstCell:K(e.selectToFirstCell,"primary+shift+Home"),selectToFirstColumn:K(e.selectToFirstColumn,"primary+shift+ArrowLeft"),selectToFirstRow:K(e.selectToFirstRow,"primary+shift+ArrowUp"),selectToLastCell:K(e.selectToLastCell,"primary+shift+End"),selectToLastColumn:K(e.selectToLastColumn,"primary+shift+ArrowRight"),selectToLastRow:K(e.selectToLastRow,"primary+shift+ArrowDown")}}function Cc(e){const o=Yl(e);return fe.useMemo(()=>{if(o===void 0)return fr(ft);const c={...o,goToNextPage:(o==null?void 0:o.goToNextPage)??(o==null?void 0:o.pageDown)??ft.goToNextPage,goToPreviousPage:(o==null?void 0:o.goToPreviousPage)??(o==null?void 0:o.pageUp)??ft.goToPreviousPage,goToFirstCell:(o==null?void 0:o.goToFirstCell)??(o==null?void 0:o.first)??ft.goToFirstCell,goToLastCell:(o==null?void 0:o.goToLastCell)??(o==null?void 0:o.last)??ft.goToLastCell,selectToFirstCell:(o==null?void 0:o.selectToFirstCell)??(o==null?void 0:o.first)??ft.selectToFirstCell,selectToLastCell:(o==null?void 0:o.selectToLastCell)??(o==null?void 0:o.last)??ft.selectToLastCell};return fr({...ft,...c})},[o])}function pc(e){function o(f,C,x){if(typeof f=="number")return{headerIndex:f,isCollapsed:!1,depth:C,path:x};const H={headerIndex:f.headerIndex,isCollapsed:f.isCollapsed,depth:C,path:x};return f.subGroups!==void 0&&(H.subGroups=f.subGroups.map((b,M)=>o(b,C+1,[...x,M])).sort((b,M)=>b.headerIndex-M.headerIndex)),H}return e.map((f,C)=>o(f,0,[C])).sort((f,C)=>f.headerIndex-C.headerIndex)}function pn(e,o){const c=[];function f(b,M,z=!1){let m=M!==null?M-b.headerIndex:o-b.headerIndex;if(b.subGroups!==void 0&&(m=b.subGroups[0].headerIndex-b.headerIndex),m--,c.push({rowIndex:-1,headerIndex:b.headerIndex,contentIndex:-1,skip:z,isCollapsed:b.isCollapsed,depth:b.depth,path:b.path,rows:m}),b.subGroups)for(let R=0;R<b.subGroups.length;R++){const T=R<b.subGroups.length-1?b.subGroups[R+1].headerIndex:M;f(b.subGroups[R],T,z||b.isCollapsed)}}const C=pc(e.groups);for(let b=0;b<C.length;b++){const M=b<C.length-1?C[b+1].headerIndex:null;f(C[b],M)}let x=0,H=0;for(const b of c)b.contentIndex=H,H+=b.rows,b.rowIndex=x,x+=b.isCollapsed?1:b.rows+1;return c.filter(b=>b.skip===!1).map(b=>{const{skip:M,...z}=b;return z})}function wn(e,o){if(o===void 0||pn.length===0)return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1};let c=e;for(const f of o){if(c===0)return{path:[...f.path,-1],originalIndex:f.headerIndex,isGroupHeader:!0,groupIndex:-1,contentIndex:-1,groupRows:f.rows};if(f.isCollapsed)c--;else{if(c<=f.rows)return{path:[...f.path,c-1],originalIndex:f.headerIndex+c,isGroupHeader:!1,groupIndex:c-1,contentIndex:f.contentIndex+c-1,groupRows:f.rows};c=c-f.rows-1}}return{path:[e],originalIndex:e,isGroupHeader:!1,groupIndex:e,contentIndex:e,groupRows:-1}}function bc(e,o,c,f){const C=fe.useMemo(()=>e===void 0?void 0:pn(e,o),[e,o]),x=fe.useMemo(()=>C==null?void 0:C.reduce((m,R)=>(m[R.rowIndex]=R,m),{}),[C]),H=fe.useMemo(()=>C===void 0?o:C.reduce((m,R)=>m+(R.isCollapsed?1:R.rows+1),0),[C,o]),b=fe.useMemo(()=>e===void 0||typeof c=="number"&&e.height===c?c:m=>x!=null&&x[m]?e.height:typeof c=="number"?c:c(m),[x,e,c]),M=fe.useCallback(m=>{if(C===void 0)return m;let R=m;for(const T of C){if(R===0)return;if(R--,!T.isCollapsed){if(R<T.rows)return T.contentIndex+R;R-=T.rows}}return m},[C]),z=ht(f??(e==null?void 0:e.themeOverride),fe.useCallback(m=>{if(e===void 0)return f==null?void 0:f(m,m,m);if(f===void 0&&(e==null?void 0:e.themeOverride)===void 0)return;const{isGroupHeader:R,contentIndex:T,groupIndex:N}=wn(m,C);return R?e.themeOverride:f==null?void 0:f(m,N,T)},[C,f,e]));return e===void 0?{rowHeight:b,rows:o,rowNumberMapper:M,getRowThemeOverride:z}:{rowHeight:b,rows:H,rowNumberMapper:M,getRowThemeOverride:z}}function yc(e,o){const c=fe.useMemo(()=>e===void 0?void 0:pn(e,o),[e,o]);return{getRowGroupingForPath:Cr,updateRowGroupingByPath:wr,mapper:fe.useCallback(f=>{if(typeof f=="number")return wn(f,c);const C=wn(f[1],c);return{...C,originalIndex:[f[0],C.originalIndex]}},[c])}}function wr(e,o,c){const[f,...C]=o;return C[0]===-1?e.map((x,H)=>H===f?{...x,...c}:x):e.map((x,H)=>H===f?{...x,subGroups:wr(x.subGroups??[],C,c)}:x)}function Cr(e,o){const[c,...f]=o;return f[0]===-1?e[c]:Cr(e[c].subGroups??[],f)}function xc(e,o){const[c]=l.useState(()=>({value:e,callback:o,facade:{get current(){return c.value},set current(f){const C=c.value;C!==f&&(c.value=f,c.callback(f,C))}}}));return c.callback=o,c.facade}function Rc(e,o,c,f,C){const[x,H]=l.useMemo(()=>[o!==void 0&&typeof c=="number"?Math.floor(o/c):0,o!==void 0&&typeof c=="number"?-(o%c):0],[o,c]),b=l.useMemo(()=>({x:f.current.x,y:x,width:f.current.width??1,height:f.current.height??1,ty:H}),[f,H,x]),[M,z,m]=ql(b),R=l.useRef(C);R.current=C;const T=xc(null,q=>{q!==null&&o!==void 0?q.scrollTop=o:q!==null&&e!==void 0&&(q.scrollLeft=e)}),N=(M.height??1)>1;l.useLayoutEffect(()=>{if(o!==void 0&&T.current!==null&&N){if(T.current.scrollTop===o)return;T.current.scrollTop=o,T.current.scrollTop!==o&&m(),R.current()}},[o,N,m,T]);const U=(M.width??1)>1;return l.useLayoutEffect(()=>{if(e!==void 0&&T.current!==null&&U){if(T.current.scrollLeft===e)return;T.current.scrollLeft=e,T.current.scrollLeft!==e&&m(),R.current()}},[e,U,m,T]),{visibleRegion:M,setVisibleRegion:z,scrollRef:T}}const Mc=l.lazy(async()=>await _l(()=>import("./data-grid-overlay-editor-C_BCg8zk.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url));let kc=0;function Sc(e){return mi(ur(ur(e).filter(o=>o.span!==void 0).map(o=>{var c,f;return Nt((((c=o.span)==null?void 0:c[0])??0)+1,(((f=o.span)==null?void 0:f[1])??0)+1)})))}function Po(e,o){return e===void 0||o===0||e.columns.length===0&&e.current===void 0?e:{current:e.current===void 0?void 0:{cell:[e.current.cell[0]+o,e.current.cell[1]],range:{...e.current.range,x:e.current.range.x+o},rangeStack:e.current.rangeStack.map(c=>({...c,x:c.x+o}))},rows:e.rows,columns:e.columns.offset(o)}}const Go={kind:te.Loading,allowOverlay:!1},vn={columns:_.empty(),rows:_.empty(),current:void 0},Tc=(e,o)=>{var er,tr,or;const[c,f]=l.useState(vn),[C,x]=l.useState(),H=l.useRef(null),b=l.useRef(null),[M,z]=l.useState(),m=l.useRef(void 0),R=typeof window>"u"?null:window,{imageEditorOverride:T,getRowThemeOverride:N,markdownDivCreateNode:U,width:q,height:me,columns:V,rows:D,getCellContent:O,onCellClicked:be,onCellActivated:Q,onFillPattern:he,onFinishedEditing:Y,coercePasteValue:oe,drawHeader:re,drawCell:Z,editorBloom:Ye,onHeaderClicked:Le,onColumnProposeMove:Me,rangeSelectionColumnSpanning:ro=!0,spanRangeBehavior:gt="default",onGroupHeaderClicked:He,onCellContextMenu:Pe,className:Ot,onHeaderContextMenu:Ge,getCellsForSelection:Oo,onGroupHeaderContextMenu:L,onGroupHeaderRenamed:ce,onCellEdited:de,onCellsEdited:De,onSearchResultsChanged:Ke,searchResults:vt,onSearchValueChange:lo,searchValue:Wo,onKeyDown:Wt,onKeyUp:mt,keybindings:io,editOnType:Uo=!0,onRowAppended:qe,onColumnAppended:ot,onColumnMoved:wt,validateCell:Ct,highlightRegions:nt,rangeSelect:je="rect",columnSelect:ye="multi",rowSelect:ke="multi",rangeSelectionBlending:Ze="exclusive",columnSelectionBlending:Je="exclusive",rowSelectionBlending:pr="exclusive",onDelete:Vo,onDragStart:co,onMouseMove:so,onPaste:pt,copyHeaders:bn=!1,freezeColumns:Qe=0,cellActivationBehavior:ao="second-click",rowSelectionMode:Bo="auto",columnSelectionMode:Ut="auto",onHeaderMenuClick:uo,onHeaderIndicatorClick:fo,getGroupDetails:ho,rowGrouping:rt,onSearchClose:Xo,onItemHovered:go,onSelectionCleared:lt,showSearch:br,onVisibleRegionChanged:vo,gridSelection:bt,onGridSelectionChange:Tt,minColumnWidth:yr=50,maxColumnWidth:xr=500,maxColumnAutoWidth:Rr,provideEditor:Mr,trailingRowOptions:B,freezeTrailingRows:et=0,allowedFillDirections:yn="orthogonal",scrollOffsetX:kr,scrollOffsetY:Sr,verticalBorder:Et,onDragOverCell:Tr,onDrop:Er,onColumnResize:Vt,onColumnResizeEnd:Bt,onColumnResizeStart:Xt,customRenderers:mo,fillHandle:zr,experimental:ae,fixedShadowX:Lr,fixedShadowY:Hr,headerIcons:Dr,imageWindowLoader:Ir,initialSize:Fr,isDraggable:$r,onDragLeave:Ar,onRowMoved:_t,overscrollX:Pr,overscrollY:Gr,preventDiagonalScrolling:Kr,rightElement:Nr,rightElementProps:Or,trapFocus:xn=!1,smoothScrollX:Wr,smoothScrollY:Ur,scaleToRem:Vr=!1,rowHeight:Br=34,headerHeight:Rn=36,groupHeaderHeight:Xr=Rn,theme:_r,isOutsideClick:Yr,renderers:_o,resizeIndicator:qr,scrollToActiveCell:Mn=!0,drawFocusRing:kn=!0,portalElementRef:jr,isActivationOnEnter:Zr}=e,Sn=kn==="no-editor"?C===void 0:kn,ne=typeof e.rowMarkers=="string"?void 0:e.rowMarkers,Ne=(ne==null?void 0:ne.kind)??e.rowMarkers??"none",Jr=(ne==null?void 0:ne.width)??e.rowMarkerWidth,Tn=(ne==null?void 0:ne.startIndex)??e.rowMarkerStartIndex??1,En=(ne==null?void 0:ne.theme)??e.rowMarkerTheme,zn=ne==null?void 0:ne.headerTheme,Ln=ne==null?void 0:ne.headerAlwaysVisible,wo=ke!=="multi"||(ne==null?void 0:ne.headerDisabled)===!0,Co=(ne==null?void 0:ne.checkboxStyle)??"square",zt=Math.max(yr,20),po=Math.max(xr,zt),Qr=Math.max(Rr??po,zt),Hn=l.useMemo(()=>typeof window>"u"?{fontSize:"16px"}:window.getComputedStyle(document.documentElement),[]),{rows:F,rowNumberMapper:Dn,rowHeight:el,getRowThemeOverride:tt}=bc(rt,D,Br,N),tl=l.useMemo(()=>Number.parseFloat(Hn.fontSize),[Hn]),{rowHeight:it,headerHeight:Yo,groupHeaderHeight:In,theme:Fn,overscrollX:ol,overscrollY:nl}=wc({groupHeaderHeight:Xr,headerHeight:Rn,overscrollX:Pr,overscrollY:Gr,remSize:tl,rowHeight:el,scaleToRem:Vr,theme:_r}),ct=Cc(io),Lt=Jr??(D>1e4?48:D>1e3?44:D>100?36:32),Ve=Ne!=="none",u=Ve?1:0,se=B!==void 0,Yt=(B==null?void 0:B.sticky)===!0,[rl,$n]=l.useState(!1),ll=br??rl,il=l.useCallback(()=>{Xo!==void 0?Xo():$n(!1)},[Xo]),g=l.useMemo(()=>bt===void 0?void 0:Po(bt,u),[bt,u])??c,Ie=l.useRef(new AbortController);l.useEffect(()=>()=>Ie==null?void 0:Ie.current.abort(),[]);const[ge,cl]=ac(Oo,O,u,Ie.current,F),sl=l.useCallback((t,n,r)=>{if(Ct===void 0)return!0;const i=[t[0]-u,t[1]];return Ct==null?void 0:Ct(i,n,r)},[u,Ct]),bo=l.useRef(bt),Fe=l.useCallback((t,n)=>{n&&(t=jl(t,ge,u,gt,Ie.current)),Tt!==void 0?(bo.current=Po(t,-u),Tt(bo.current)):f(t)},[Tt,ge,u,gt]),Ht=ht(Vt,l.useCallback((t,n,r,i)=>{Vt==null||Vt(V[r-u],n,r-u,i)},[Vt,u,V])),al=ht(Bt,l.useCallback((t,n,r,i)=>{Bt==null||Bt(V[r-u],n,r-u,i)},[Bt,u,V])),ul=ht(Xt,l.useCallback((t,n,r,i)=>{Xt==null||Xt(V[r-u],n,r-u,i)},[Xt,u,V])),dl=ht(re,l.useCallback((t,n)=>(re==null?void 0:re({...t,columnIndex:t.columnIndex-u},n))??!1,[re,u])),fl=ht(Z,l.useCallback((t,n)=>(Z==null?void 0:Z({...t,col:t.col-u},n))??!1,[Z,u])),st=l.useCallback(t=>{if(Vo!==void 0){const n=Vo(Po(t,-u));return typeof n=="boolean"?n:Po(n,u)}return!0},[Vo,u]),[ve,xe,ue]=sc(g,Fe,Ze,Je,pr,je,ro),we=l.useMemo(()=>hn(hr(),Fn),[Fn]),[qo,hl]=l.useState([0,0,0]),An=l.useMemo(()=>{if(_o===void 0)return{};const t={};for(const n of _o)t[n.kind]=n;return t},[_o]),Re=l.useCallback(t=>t.kind!==te.Custom?An[t.kind]:mo==null?void 0:mo.find(n=>n.isMatch(t)),[mo,An]);let{sizedColumns:Te,nonGrowWidth:Pn}=ic(V,F,cl,qo[0]-(u===0?0:Lt)-qo[2],zt,Qr,we,Re,Ie.current);Ne!=="none"&&(Pn+=Lt);const jo=l.useMemo(()=>Te.some(t=>t.group!==void 0),[Te]),qt=jo?Yo+In:Yo,Gn=g.rows.length,Kn=Ne==="none"?void 0:Gn===0?!1:Gn===F?!0:void 0,W=l.useMemo(()=>Ne==="none"?Te:[{title:"",width:Lt,icon:void 0,hasMenu:!1,style:"normal",themeOverride:En,rowMarker:Co,rowMarkerChecked:Kn,headerRowMarkerTheme:zn,headerRowMarkerAlwaysVisible:Ln,headerRowMarkerDisabled:wo},...Te],[Ne,Te,Lt,En,Co,Kn,zn,Ln,wo]),Ee=l.useRef({height:1,width:1,x:0,y:0}),yo=l.useRef(!1),{setVisibleRegion:Nn,visibleRegion:yt,scrollRef:X}=Rc(kr,Sr,it,Ee,()=>yo.current=!0);Ee.current=yt;const gl=yt.x+u,xo=yt.y,ie=l.useRef(null),Ce=l.useCallback(t=>{var n;t===!0?(n=ie.current)==null||n.focus():window.requestAnimationFrame(()=>{var r;(r=ie.current)==null||r.focus()})},[]),pe=se?F+1:F,$e=l.useCallback(t=>{const n=u===0?t:t.map(i=>({...i,location:[i.location[0]-u,i.location[1]]})),r=De==null?void 0:De(n);if(r!==!0)for(const i of n)de==null||de(i.location,i.value);return r},[de,De,u]),[xt,Zo]=l.useState(),Ro=g.current!==void 0&&g.current.range.width*g.current.range.height>1?g.current.range:void 0,Dt=Sn?(er=g.current)==null?void 0:er.cell:void 0,Mo=Dt==null?void 0:Dt[0],ko=Dt==null?void 0:Dt[1],vl=l.useMemo(()=>{if((nt===void 0||nt.length===0)&&(Ro??Mo??ko??xt)===void 0)return;const t=[];if(nt!==void 0)for(const n of nt){const r=W.length-n.range.x-u;r>0&&t.push({color:n.color,range:{...n.range,x:n.range.x+u,width:Math.min(r,n.range.width)},style:n.style})}return xt!==void 0&&t.push({color:rr(we.accentColor,0),range:xt,style:"dashed"}),Ro!==void 0&&t.push({color:rr(we.accentColor,.5),range:Ro,style:"solid-outline"}),Mo!==void 0&&ko!==void 0&&t.push({color:we.accentColor,range:{x:Mo,y:ko,width:1,height:1},style:"solid-outline"}),t.length>0?t:void 0},[xt,Ro,Mo,ko,nt,W.length,we.accentColor,u]),On=l.useRef(W);On.current=W;const ze=l.useCallback(([t,n],r=!1)=>{var v,a,s,h,w,y,k,p;const i=se&&n===pe-1;if(t===0&&Ve){if(i)return Go;const E=Dn(n);return E===void 0?Go:{kind:$o.Marker,allowOverlay:!1,checkboxStyle:Co,checked:(g==null?void 0:g.rows.hasIndex(n))===!0,markerKind:Ne==="clickable-number"?"number":Ne,row:Tn+E,drawHandle:_t!==void 0,cursor:Ne==="clickable-number"?"pointer":void 0,disabled:((v=e.disabledRows)==null?void 0:v.call(e,n))===!0}}else if(i){const I=t===u?(B==null?void 0:B.hint)??"":"",S=On.current[t];if(((a=S==null?void 0:S.trailingRowOptions)==null?void 0:a.disabled)===!0)return Go;{const $=((s=S==null?void 0:S.trailingRowOptions)==null?void 0:s.hint)??I,A=((h=S==null?void 0:S.trailingRowOptions)==null?void 0:h.addIcon)??(B==null?void 0:B.addIcon);return{kind:$o.NewRow,hint:$,allowOverlay:!1,icon:A}}}else{const E=t-u;if(r||(ae==null?void 0:ae.strict)===!0){const S=Ee.current,$=S.x>E||E>S.x+S.width||S.y>n||n>S.y+S.height||n>=tn.current,A=E===((y=(w=S.extras)==null?void 0:w.selected)==null?void 0:y[0])&&n===((k=S.extras)==null?void 0:k.selected[1]);let P=!1;if(((p=S.extras)==null?void 0:p.freezeRegions)!==void 0){for(const ee of S.extras.freezeRegions)if(Zl(ee,E,n)){P=!0;break}}if($&&!A&&!P)return Go}let I=O([E,n]);return u!==0&&I.span!==void 0&&(I={...I,span:[I.span[0]+u,I.span[1]+u]}),I}},[se,pe,Ve,Dn,Co,g==null?void 0:g.rows,Ne,Tn,_t,u,B==null?void 0:B.hint,B==null?void 0:B.addIcon,ae==null?void 0:ae.strict,O]),Jo=l.useCallback(t=>{let n=(ho==null?void 0:ho(t))??{name:t};return ce!==void 0&&t!==""&&(n={icon:n.icon,name:n.name,overrideTheme:n.overrideTheme,actions:[...n.actions??[],{title:"Rename",icon:"renameIcon",onClick:r=>nn({group:n.name,bounds:r.bounds})}]}),n},[ho,ce]),It=l.useCallback(t=>{var s;const[n,r]=t.cell,i=W[n],d=(i==null?void 0:i.group)!==void 0?(s=Jo(i.group))==null?void 0:s.overrideTheme:void 0,v=i==null?void 0:i.themeOverride,a=tt==null?void 0:tt(r);x({...t,theme:hn(we,d,v,a,t.content.themeOverride)})},[tt,W,Jo,we]),Ft=l.useCallback((t,n,r)=>{var a;if(g.current===void 0)return;const[i,d]=g.current.cell,v=ze([i,d]);if(v.kind!==te.Boolean&&v.allowOverlay){let s=v;if(r!==void 0)switch(s.kind){case te.Number:{const h=Jl(()=>r==="-"?-0:Number.parseFloat(r),0);s={...s,data:Number.isNaN(h)?0:h};break}case te.Text:case te.Markdown:case te.Uri:s={...s,data:r};break}It({target:t,content:s,initialValue:r,cell:[i,d],highlight:r===void 0,forceEditMode:r!==void 0,activation:n})}else v.kind===te.Boolean&&n.inputType==="keyboard"&&v.readonly!==!0&&($e([{location:g.current.cell,value:{...v,data:Ql(v.data)}}]),(a=ie.current)==null||a.damage([{cell:g.current.cell}]))},[ze,g,$e,It]),Wn=l.useCallback((t,n)=>{var d;const r=(d=ie.current)==null?void 0:d.getBounds(t,n);if(r===void 0||X.current===null)return;const i=ze([t,n]);i.allowOverlay&&It({target:r,content:i,initialValue:void 0,highlight:!0,cell:[t,n],forceEditMode:!0,activation:{inputType:"keyboard",key:"Enter"}})},[ze,X,It]),le=l.useCallback((t,n,r="both",i=0,d=0,v=void 0)=>{if(X.current!==null){const a=ie.current,s=b.current,h=typeof t!="number"?t.unit==="cell"?t.amount:void 0:t,w=typeof n!="number"?n.unit==="cell"?n.amount:void 0:n,y=typeof t!="number"&&t.unit==="px"?t.amount:void 0,k=typeof n!="number"&&n.unit==="px"?n.amount:void 0;if(a!==null&&s!==null){let p={x:0,y:0,width:0,height:0},E=0,I=0;if((h!==void 0||w!==void 0)&&(p=a.getBounds((h??0)+u,w??0)??p,p.width===0||p.height===0))return;const S=s.getBoundingClientRect(),$=S.width/s.offsetWidth;if(y!==void 0&&(p={...p,x:y-S.left-X.current.scrollLeft,width:1}),k!==void 0&&(p={...p,y:k+S.top-X.current.scrollTop,height:1}),p!==void 0){const A={x:p.x-i,y:p.y-d,width:p.width+2*i,height:p.height+2*d};let P=0;for(let dn=0;dn<Qe;dn++)P+=Te[dn].width;let ee=0;const j=et+(Yt?1:0);j>0&&(ee=ei(pe,j,it));let Se=P*$+S.left+u*Lt*$,Xe=S.right,Ue=S.top+qt*$,_e=S.bottom-ee*$;const Do=p.width+i*2;switch(v==null?void 0:v.hAlign){case"start":Xe=Se+Do;break;case"end":Se=Xe-Do;break;case"center":Se=Math.floor((Se+Xe)/2)-Do/2,Xe=Se+Do;break}const Io=p.height+d*2;switch(v==null?void 0:v.vAlign){case"start":_e=Ue+Io;break;case"end":Ue=_e-Io;break;case"center":Ue=Math.floor((Ue+_e)/2)-Io/2,_e=Ue+Io;break}Se>A.x?E=A.x-Se:Xe<A.x+A.width&&(E=A.x+A.width-Xe),Ue>A.y?I=A.y-Ue:_e<A.y+A.height&&(I=A.y+A.height-_e),r==="vertical"||typeof t=="number"&&t<Qe?E=0:(r==="horizontal"||typeof n=="number"&&n>=pe-j)&&(I=0),(E!==0||I!==0)&&($!==1&&(E/=$,I/=$),X.current.scrollTo({left:E+X.current.scrollLeft,top:I+X.current.scrollTop,behavior:(v==null?void 0:v.behavior)??"auto"}))}}}},[u,et,Lt,X,qt,Qe,Te,pe,Yt,it]),Qo=l.useRef(Wn),en=l.useRef(O);Qo.current=Wn,en.current=O;const tn=l.useRef(F);tn.current=F;const Un=l.useRef(W.length);Un.current=W.length;const at=l.useCallback(async(t,n=!0,r)=>{var w;const i=W[t];if(((w=i==null?void 0:i.trailingRowOptions)==null?void 0:w.disabled)===!0)return;const d=qe==null?void 0:qe();let v,a=!0;d!==void 0&&(v=await d,v==="top"&&(a=!1),typeof v=="number"&&(a=!1));let s=0;const h=()=>{if(tn.current<=F){s<500&&window.setTimeout(h,s),s=50+s*2;return}const y=typeof v=="number"?v:a?F:0;Ho.current(t-u,y,"both",0,0,r?{behavior:r}:void 0),ve({cell:[t,y],range:{x:t,y,width:1,height:1}},!1,!1,"edit");const k=en.current([t-u,y]);k.allowOverlay&&oo(k)&&k.readonly!==!0&&n&&window.setTimeout(()=>{Qo.current(t,y)},0)};h()},[W,qe,u,F,ve]),So=l.useCallback(async(t,n=!0)=>{const r=ot==null?void 0:ot();let i,d=!0;r!==void 0&&(i=await r,i==="left"&&(d=!1),typeof i=="number"&&(d=!1));let v=0;const a=()=>{if(Un.current<=W.length){v<500&&window.setTimeout(a,v),v=50+v*2;return}const s=typeof i=="number"?i:d?W.length:0;le(s-u,t),ve({cell:[s,t],range:{x:s,y:t,width:1,height:1}},!1,!1,"edit");const h=en.current([s-u,t]);h.allowOverlay&&oo(h)&&h.readonly!==!0&&n&&window.setTimeout(()=>{Qo.current(s,t)},0)};a()},[W,ot,u,le,ve]),$t=l.useCallback(t=>{var r,i;const n=((i=(r=Te[t])==null?void 0:r.trailingRowOptions)==null?void 0:i.targetColumn)??(B==null?void 0:B.targetColumn);if(typeof n=="number")return n+(Ve?1:0);if(typeof n=="object"){const d=V.indexOf(n);if(d>=0)return d+(Ve?1:0)}},[Te,V,Ve,B==null?void 0:B.targetColumn]),ut=l.useRef(void 0),At=l.useRef(void 0),jt=l.useCallback((t,n)=>{var d;const[r,i]=n;return hn(we,(d=W[r])==null?void 0:d.themeOverride,tt==null?void 0:tt(i),t.themeOverride)},[tt,W,we]),{mapper:Rt}=yc(rt,D),Oe=rt==null?void 0:rt.navigationBehavior,Zt=l.useCallback(t=>{var w,y,k;const n=No.value?t.metaKey:t.ctrlKey,r=n&&ke==="multi",[i,d]=t.location,v=g.columns,a=g.rows,[s,h]=((w=g.current)==null?void 0:w.cell)??[];if(t.kind==="cell"){if(At.current=void 0,Mt.current=[i,d],i===0&&Ve){if(se===!0&&d===F||Ne==="number"||ke==="none")return;const p=ze(t.location);if(p.kind!==$o.Marker||p.disabled===!0)return;if(_t!==void 0){const S=Re(p);Ko((S==null?void 0:S.kind)===$o.Marker);const $=(y=S==null?void 0:S.onClick)==null?void 0:y.call(S,{...t,cell:p,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,theme:jt(p,t.location),preventDefault:()=>{}});if($===void 0||$.checked===p.checked)return}x(void 0),Ce();const E=a.hasIndex(d),I=ut.current;if(ke==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&I!==void 0&&a.hasIndex(I)){const S=[Math.min(I,d),Math.max(I,d)+1];r||Bo==="multi"?xe(void 0,S,!0):xe(_.fromSingleSelection(S),void 0,r)}else ke==="multi"&&(r||t.isTouch||Bo==="multi")?E?xe(a.remove(d),void 0,!0):(xe(void 0,d,!0),ut.current=d):E&&a.length===1?xe(_.empty(),void 0,n):(xe(_.fromSingleSelection(d),void 0,n),ut.current=d)}else if(i>=u&&se&&d===F){const p=$t(i);at(p??i)}else if(s!==i||h!==d){const p=ze(t.location),E=Re(p);if((E==null?void 0:E.onSelect)!==void 0){let $=!1;if(E.onSelect({...t,cell:p,posX:t.localEventX,posY:t.localEventY,bounds:t.bounds,preventDefault:()=>$=!0,theme:jt(p,t.location)}),$)return}if(Oe==="block"&&Rt(d).isGroupHeader)return;const I=Yt&&d===F,S=Yt&&g!==void 0&&((k=g.current)==null?void 0:k.cell[1])===F;if((t.shiftKey||t.isLongTouch===!0)&&s!==void 0&&h!==void 0&&g.current!==void 0&&!S){if(I)return;const $=Math.min(i,s),A=Math.max(i,s),P=Math.min(d,h),ee=Math.max(d,h);ve({...g.current,range:{x:$,y:P,width:A-$+1,height:ee-P+1}},!0,n,"click"),ut.current=void 0,Ce()}else ve({cell:[i,d],range:{x:i,y:d,width:1,height:1}},!0,n,"click"),ut.current=void 0,x(void 0),Ce()}}else if(t.kind==="header")if(Mt.current=[i,d],x(void 0),Ve&&i===0)ut.current=void 0,At.current=void 0,!wo&&ke==="multi"&&(a.length!==F?xe(_.fromSingleSelection([0,F]),void 0,n):xe(_.empty(),void 0,n),Ce());else{const p=At.current;if(ye==="multi"&&(t.shiftKey||t.isLongTouch===!0)&&p!==void 0&&v.hasIndex(p)){const E=[Math.min(p,i),Math.max(p,i)+1];n||t.isTouch||Ut==="multi"?ue(void 0,E,n):ue(_.fromSingleSelection(E),void 0,n)}else ye==="multi"&&(n||t.isTouch||Ut==="multi")?(v.hasIndex(i)?ue(v.remove(i),void 0,n):ue(void 0,i,n),At.current=i):ye!=="none"&&(v.hasIndex(i)?ue(v.remove(i),void 0,n):ue(_.fromSingleSelection(i),void 0,n),At.current=i);ut.current=void 0,Ce()}else t.kind===Kt?Mt.current=[i,d]:t.kind===lr&&!t.isMaybeScrollbar&&(Fe(vn,!1),x(void 0),Ce(),lt==null||lt(),ut.current=void 0,At.current=void 0)},[ke,ye,g,Ve,u,se,F,Ne,ze,_t,Ce,Bo,Ut,Re,jt,xe,$t,at,Oe,Rt,Yt,ve,wo,ue,Fe,lt]),Jt=l.useRef(!1),Mt=l.useRef(void 0),Vn=l.useRef(yt),Ae=l.useRef(void 0),ml=l.useCallback(t=>{if(Pt.current=!1,Vn.current=Ee.current,t.button!==0&&t.button!==1){Ae.current=void 0;return}const n=performance.now();Ae.current={button:t.button,time:n,location:t.location},(t==null?void 0:t.kind)==="header"&&(Jt.current=!0);const r=t.kind==="cell"&&t.isFillHandle;!r&&t.kind!=="cell"&&t.isEdge||(z({previousSelection:g,fillHandle:r}),Mt.current=void 0,!t.isTouch&&t.button===0&&!r?Zt(t):!t.isTouch&&t.button===1&&(Mt.current=t.location))},[g,Zt]),[on,nn]=l.useState(),Bn=l.useCallback(t=>{if(t.kind!==Kt||ye!=="multi")return;const n=No.value?t.metaKey:t.ctrlKey,[r]=t.location,i=g.columns;if(r<u)return;const d=W[r];let v=r,a=r;for(let s=r-1;s>=u&&ir(d.group,W[s].group);s--)v--;for(let s=r+1;s<W.length&&ir(d.group,W[s].group);s++)a++;if(Ce(),n||t.isTouch||Ut==="multi")if(i.hasAll([v,a+1])){let s=i;for(let h=v;h<=a;h++)s=s.remove(h);ue(s,void 0,n)}else ue(void 0,[v,a+1],n);else ue(_.fromSingleSelection([v,a+1]),void 0,n)},[ye,Ce,g.columns,W,u,ue,Ut]),Pt=l.useRef(!1),To=l.useCallback(async t=>{if(ge!==void 0&&Ht!==void 0){const n=Ee.current.y,r=Ee.current.height;let i=ge({x:t,y:n,width:1,height:Math.min(r,F-n)},Ie.current.signal);typeof i!="object"&&(i=await i());const d=Te[t-u],a=document.createElement("canvas").getContext("2d",{alpha:!1});if(a!==null){a.font=we.baseFontFull;const s=vr(a,we,d,0,i,zt,po,!1,Re);Ht==null||Ht(d,s.width,t,s.width)}}},[Te,ge,po,we,zt,Ht,u,F,Re]),[wl,rn]=l.useState(),Gt=l.useCallback(async(t,n)=>{var s,h;const r=(s=t.current)==null?void 0:s.range;if(r===void 0||ge===void 0||n.current===void 0)return;const i=n.current.range;if(he!==void 0){let w=!1;if(he({fillDestination:{...i,x:i.x-u},patternSource:{...r,x:r.x-u},preventDefault:()=>w=!0}),w)return}let d=ge(r,Ie.current.signal);typeof d!="object"&&(d=await d());const v=d,a=[];for(let w=0;w<i.width;w++)for(let y=0;y<i.height;y++){const k=[i.x+w,i.y+y];if(ti(k,r))continue;const p=v[y%r.height][w%r.width];Ao(p)||!oo(p)||a.push({location:k,value:{...p}})}$e(a),(h=ie.current)==null||h.damage(a.map(w=>({cell:w.location})))},[ge,$e,he,u]),Xn=l.useCallback(()=>{if(g.current===void 0||g.current.range.width<=1)return;const t={...g,current:{...g.current,range:{...g.current.range,width:1}}};Gt(t,g)},[Gt,g]),_n=l.useCallback(()=>{if(g.current===void 0||g.current.range.height<=1)return;const t={...g,current:{...g.current,range:{...g.current.range,height:1}}};Gt(t,g)},[Gt,g]),Cl=l.useCallback((t,n)=>{var y,k;const r=M;if(z(void 0),Zo(void 0),rn(void 0),Jt.current=!1,n)return;if((r==null?void 0:r.fillHandle)===!0&&g.current!==void 0&&((y=r.previousSelection)==null?void 0:y.current)!==void 0){if(xt===void 0)return;const p={...g,current:{...g.current,range:oi(r.previousSelection.current.range,xt)}};Gt(r.previousSelection,p),Fe(p,!0);return}const[i,d]=t.location,[v,a]=Mt.current??[],s=()=>{Pt.current=!0},h=p=>{var I,S,$;const E=p.isTouch||v===i&&a===d;if(E&&(be==null||be([i-u,d],{...p,preventDefault:s})),p.button===1)return!Pt.current;if(!Pt.current){const A=ze(t.location),P=Re(A);if(P!==void 0&&P.onClick!==void 0&&E){const j=P.onClick({...p,cell:A,posX:p.localEventX,posY:p.localEventY,bounds:p.bounds,theme:jt(A,t.location),preventDefault:s});j!==void 0&&!Ao(j)&&no(j)&&($e([{location:p.location,value:j}]),(I=ie.current)==null||I.damage([{cell:p.location}]))}if(Pt.current||g.current===void 0)return!1;let ee=!1;switch(A.activationBehaviorOverride??ao){case"double-click":case"second-click":{if((($=(S=r==null?void 0:r.previousSelection)==null?void 0:S.current)==null?void 0:$.cell)===void 0)break;const[j,Se]=g.current.cell,[Xe,Ue]=r.previousSelection.current.cell;ee=i===j&&i===Xe&&d===Se&&d===Ue&&(p.isDoubleClick===!0||ao==="second-click");break}case"single-click":{ee=!0;break}}if(ee){const Se={inputType:"pointer",pointerActivation:p.isDoubleClick===!0?"double-click":A.activationBehaviorOverride??ao,pointerType:p.isTouch?"touch":"mouse"};return Q==null||Q([i-u,d],Se),Ft(p.bounds,Se),!0}}return!1},w=t.location[0]-u;if(t.isTouch){const p=Ee.current,E=Vn.current;if(p.x!==E.x||p.y!==E.y)return;if(t.isLongTouch===!0){if(t.kind==="cell"&&ni((k=g.current)==null?void 0:k.cell,t.location)){Pe==null||Pe([w,t.location[1]],{...t,preventDefault:s});return}else if(t.kind==="header"&&g.columns.hasIndex(i)){Ge==null||Ge(w,{...t,preventDefault:s});return}else if(t.kind===Kt){if(w<0)return;L==null||L(w,{...t,preventDefault:s});return}}t.kind==="cell"?h(t)||Zt(t):t.kind===Kt?He==null||He(w,{...t,preventDefault:s}):(t.kind===ri&&(Le==null||Le(w,{...t,preventDefault:s})),Zt(t));return}if(t.kind==="header"){if(w<0)return;t.isEdge?t.isDoubleClick===!0&&To(i):t.button===0&&i===v&&d===a&&(Le==null||Le(w,{...t,preventDefault:s}))}if(t.kind===Kt){if(w<0)return;t.button===0&&i===v&&d===a&&(He==null||He(w,{...t,preventDefault:s}),Pt.current||Bn(t))}t.kind==="cell"&&(t.button===0||t.button===1)&&h(t),Mt.current=void 0},[M,g,u,xt,Gt,Fe,be,ze,Re,ao,jt,$e,Q,Ft,Pe,Ge,L,Zt,He,Le,To,Bn]),pl=l.useCallback(t=>{const n={...t,location:[t.location[0]-u,t.location[1]]};so==null||so(n),M!==void 0&&t.buttons===0&&(z(void 0),Zo(void 0),rn(void 0),Jt.current=!1),rn(r=>{var i;return Jt.current?[t.scrollEdge[0],0]:t.scrollEdge[0]===(r==null?void 0:r[0])&&t.scrollEdge[1]===r[1]?r:M===void 0||(((i=Ae.current)==null?void 0:i.location[0])??0)<u?void 0:t.scrollEdge})},[M,so,u]),bl=l.useCallback((t,n)=>{uo==null||uo(t-u,n)},[uo,u]),yl=l.useCallback((t,n)=>{fo==null||fo(t-u,n)},[fo,u]);l.useEffect(()=>{if(C===void 0)return;const t=i=>{const d=[];let v=i.parentElement;for(;v&&v!==document.documentElement;){const a=window.getComputedStyle(v),s=a.overflow+a.overflowY+a.overflowX;(s.includes("scroll")||s.includes("auto"))&&d.push(v),v=v.parentElement}return d},n=i=>{const d=i.target;X.current&&!X.current.contains(d)&&x(void 0)},r=[];if(X.current){const i=t(X.current);r.push(...i)}return r.forEach(i=>{i.addEventListener("scroll",n)}),window.addEventListener("scroll",n),document.addEventListener("scroll",n,!0),()=>{r.forEach(i=>{i.removeEventListener("scroll",n)}),window.removeEventListener("scroll",n),document.removeEventListener("scroll",n,!0)}},[C,x,X]);const Be=(tr=g==null?void 0:g.current)==null?void 0:tr.cell,xl=l.useCallback((t,n,r,i,d,v)=>{if(yo.current=!1,C!==void 0){const y=Ee.current;(y.x!==t.x||y.y!==t.y)&&x(void 0)}let a=Be;a!==void 0&&(a=[a[0]-u,a[1]]);const s=Qe===0?void 0:{x:0,y:t.y,width:Qe,height:t.height},h=[];s!==void 0&&h.push(s),et>0&&(h.push({x:t.x-u,y:F-et,width:t.width,height:et}),Qe>0&&h.push({x:0,y:F-et,width:Qe,height:et}));const w={x:t.x-u,y:t.y,width:t.width,height:se&&t.y+t.height>=F?t.height-1:t.height,tx:d,ty:v,extras:{selected:a,freezeRegion:s,freezeRegions:h}};Ee.current=w,Nn(w),hl([n,r,i]),vo==null||vo(w,w.tx,w.ty,w.extras)},[Be,C,u,se,F,Qe,et,x,Nn,vo]),Rl=ht(Me,l.useCallback((t,n)=>(Me==null?void 0:Me(t-u,n-u))!==!1,[Me,u])),Ml=ht(wt,l.useCallback((t,n)=>{wt==null||wt(t-u,n-u),ye!=="none"&&ue(_.fromSingleSelection(n),void 0,!0)},[ye,wt,u,ue])),ln=l.useRef(!1),kl=l.useCallback(t=>{if(t.location[0]===0&&u>0){t.preventDefault();return}co==null||co({...t,location:[t.location[0]-u,t.location[1]]}),t.defaultPrevented()||(ln.current=!0),z(void 0)},[co,u]),Sl=l.useCallback(()=>{ln.current=!1},[]),Yn=rt==null?void 0:rt.selectionBehavior,Eo=l.useCallback(t=>{if(Yn!=="block-spanning")return;const{isGroupHeader:n,path:r,groupRows:i}=Rt(t);if(n)return[t,t];const d=r[r.length-1],v=t-d,a=t+i-d-1;return[v,a]},[Rt,Yn]),cn=l.useRef(void 0),sn=l.useCallback(t=>{var n,r,i;if(!li(t,cn.current)&&(cn.current=t,!(((n=Ae==null?void 0:Ae.current)==null?void 0:n.button)!==void 0&&Ae.current.button>=1))){if(t.buttons!==0&&M!==void 0&&((r=Ae.current)==null?void 0:r.location[0])===0&&u===1&&ke==="multi"&&M.previousSelection&&!M.previousSelection.rows.hasIndex(Ae.current.location[1])&&g.rows.hasIndex(Ae.current.location[1])){const d=Math.min(Ae.current.location[1],t.location[1]),v=Math.max(Ae.current.location[1],t.location[1])+1;xe(_.fromSingleSelection([d,v]),void 0,!1)}else if(t.buttons!==0&&M!==void 0&&g.current!==void 0&&!ln.current&&!Jt.current&&(je==="rect"||je==="multi-rect")){const[d,v]=g.current.cell;let[a,s]=t.location;if(s<0&&(s=Ee.current.y),M.fillHandle===!0&&((i=M.previousSelection)==null?void 0:i.current)!==void 0){const h=M.previousSelection.current.range;s=Math.min(s,se?F-1:F);const w=ii(h,a,s,yn);Zo(w)}else{if(se&&v===F)return;if(se&&s===F)if(t.kind===lr)s--;else return;a=Math.max(a,u);const y=Eo(v);s=y===void 0?s:St(s,y[0],y[1]);const k=a-d,p=s-v,E={x:k>=0?d:a,y:p>=0?v:s,width:Math.abs(k)+1,height:Math.abs(p)+1};ve({...g.current,range:E},!0,!1,"drag")}}go==null||go({...t,location:[t.location[0]-u,t.location[1]]})}},[M,u,ke,g,je,go,xe,se,F,yn,Eo,ve]),Tl=l.useCallback(()=>{var a,s;const t=cn.current;if(t===void 0)return;const[n,r]=t.scrollEdge;let[i,d]=t.location;const v=Ee.current;n===-1?i=((s=(a=v.extras)==null?void 0:a.freezeRegion)==null?void 0:s.x)??v.x:n===1&&(i=v.x+v.width),r===-1?d=Math.max(0,v.y):r===1&&(d=Math.min(F-1,v.y+v.height)),i=St(i,0,W.length-1),d=St(d,0,F-1),sn({...t,location:[i,d]})},[W.length,sn,F]);mc(wl,X,Tl);const We=l.useCallback(t=>{if(g.current===void 0)return;const[n,r]=t,[i,d]=g.current.cell,v=g.current.range;let a=v.x,s=v.x+v.width,h=v.y,w=v.y+v.height;const[y,k]=Eo(d)??[0,F-1],p=k+1;if(r!==0)switch(r){case 2:{w=p,h=d,le(0,w,"vertical");break}case-2:{h=y,w=d+1,le(0,h,"vertical");break}case 1:{h<d?(h++,le(0,h,"vertical")):(w=Math.min(p,w+1),le(0,w,"vertical"));break}case-1:{w>d+1?(w--,le(0,w,"vertical")):(h=Math.max(y,h-1),le(0,h,"vertical"));break}default:cr()}if(n!==0)if(n===2)s=W.length,a=i,le(s-1-u,0,"horizontal");else if(n===-2)a=u,s=i+1,le(a-u,0,"horizontal");else{let E=[];if(ge!==void 0){const I=ge({x:a,y:h,width:s-a-u,height:w-h},Ie.current.signal);typeof I=="object"&&(E=Sc(I))}if(n===1){let I=!1;if(a<i){if(E.length>0){const S=Nt(a+1,i+1).find($=>!E.includes($-u));S!==void 0&&(a=S,I=!0)}else a++,I=!0;I&&le(a,0,"horizontal")}I||(s=Math.min(W.length,s+1),le(s-1-u,0,"horizontal"))}else if(n===-1){let I=!1;if(s>i+1){if(E.length>0){const S=Nt(s-1,i,-1).find($=>!E.includes($-u));S!==void 0&&(s=S,I=!0)}else s--,I=!0;I&&le(s-u,0,"horizontal")}I||(a=Math.max(u,a-1),le(a-u,0,"horizontal"))}else cr()}ve({cell:g.current.cell,range:{x:a,y:h,width:s-a,height:w-h}},!0,!1,"keyboard-select")},[ge,Eo,g,W.length,u,F,le,ve]),an=l.useRef(Mn);an.current=Mn;const dt=l.useCallback((t,n,r,i)=>{const d=pe-(r?0:1);t=St(t,u,Te.length-1+u),n=St(n,0,d);const v=Be==null?void 0:Be[0],a=Be==null?void 0:Be[1];if(t===v&&n===a)return!1;if(i&&g.current!==void 0){const s=[...g.current.rangeStack];(g.current.range.width>1||g.current.range.height>1)&&s.push(g.current.range),Fe({...g,current:{cell:[t,n],range:{x:t,y:n,width:1,height:1},rangeStack:s}},!0)}else ve({cell:[t,n],range:{x:t,y:n,width:1,height:1}},!0,!1,"keyboard-nav");return m.current!==void 0&&m.current[0]===t&&m.current[1]===n&&(m.current=void 0),an.current&&le(t-u,n),!0},[pe,u,Te.length,Be,g,le,Fe,ve]),El=l.useCallback((t,n)=>{(C==null?void 0:C.cell)!==void 0&&t!==void 0&&no(t)&&($e([{location:C.cell,value:t}]),window.requestAnimationFrame(()=>{var d;(d=ie.current)==null||d.damage([{cell:C.cell}])})),Ce(!0),x(void 0);const[r,i]=n;if(g.current!==void 0&&(r!==0||i!==0)){const d=g.current.cell[1]===pe-1;if(d&&i===1){Y==null||Y(t,[0,0]);return}const v=g.current.cell[0]===W.length-1&&t!==void 0;let a=!0;if(d&&i===1&&qe!==void 0){a=!1;const s=g.current.cell[0]+r,h=$t(s);at(h??s,!1)}if(v&&r===1&&ot!==void 0){a=!1;const s=g.current.cell[1]+i;So(s,!1)}if(a){const s=St(g.current.cell[0]+r,0,W.length-1),h=St(g.current.cell[1]+i,0,pe-1);dt(s,h,d,!1),Zr&&(r===0&&i===1||r===1&&i===0)&&window.setTimeout(()=>{var y;const w=O([s-u,h]);if(oo(w)){const k=(y=ie.current)==null?void 0:y.getBounds(s,h);if(k&&w.allowOverlay){ie.current&&ie.current.focus();const p={current:{cell:[s,h],range:{x:s,y:h,width:1,height:1},rangeStack:[]},columns:_.empty(),rows:_.empty()};Tt==null||Tt(p);const E={inputType:"keyboard",key:"Enter"};Q==null||Q([s-u,h],E),It({target:k,content:w,initialValue:void 0,cell:[s,h],highlight:!0,forceEditMode:!0,activation:E})}}},50)}}Y==null||Y(t,n)},[C==null?void 0:C.cell,Ce,g,Y,$e,pe,dt,W.length,at,So,qe,ot,$t,ie,O,u,Q,Ft,It]),zl=l.useMemo(()=>`gdg-overlay-${kc++}`,[]),kt=l.useCallback(t=>{var r,i,d,v;Ce();const n=[];for(let a=t.x;a<t.x+t.width;a++)for(let s=t.y;s<t.y+t.height;s++){const h=O([a-u,s]);if(!h.allowOverlay&&h.kind!==te.Boolean)continue;let w;if(h.kind===te.Custom){const y=Re(h),k=(r=y==null?void 0:y.provideEditor)==null?void 0:r.call(y,{...h,location:[a-u,s]});(y==null?void 0:y.onDelete)!==void 0?w=y.onDelete(h):ci(k)&&(w=(i=k==null?void 0:k.deletedValue)==null?void 0:i.call(k,h))}else if(no(h)&&h.allowOverlay||h.kind===te.Boolean){const y=Re(h);w=(d=y==null?void 0:y.onDelete)==null?void 0:d.call(y,h)}w!==void 0&&!Ao(w)&&no(w)&&n.push({location:[a,s],value:w})}$e(n),(v=ie.current)==null||v.damage(n.map(a=>({cell:a.location})))},[Ce,O,Re,$e,u]),Qt=C!==void 0,qn=l.useCallback(t=>{var S,$,A;const n=()=>{t.stopPropagation(),t.preventDefault()},r={didMatch:!1},{bounds:i}=t,d=g.columns,v=g.rows,a=ct;if(!Qt&&G(a.clear,t,r)){const P=((S=g.current)==null?void 0:S.cell)??[u,0];Fe({columns:_.empty(),rows:_.empty(),current:{cell:P,range:{x:P[0],y:P[1],width:1,height:1},rangeStack:[]}},!1),lt==null||lt(),Ce()}else if(!Qt&&G(a.selectAll,t,r))Fe({columns:_.empty(),rows:_.empty(),current:{cell:(($=g.current)==null?void 0:$.cell)??[u,0],range:{x:u,y:0,width:V.length,height:F},rangeStack:[]}},!1);else if(G(a.search,t,r))(A=H==null?void 0:H.current)==null||A.focus({preventScroll:!0}),$n(!0);else if(G(a.delete,t,r)){const P=(st==null?void 0:st(g))??!0;if(P!==!1){const ee=P===!0?g:P;if(ee.current!==void 0){kt(ee.current.range);for(const j of ee.current.rangeStack)kt(j)}for(const j of ee.rows)kt({x:u,y:j,width:V.length,height:1});for(const j of ee.columns)kt({x:j,y:0,width:1,height:F})}}if(r.didMatch)return n(),!0;if(g.current===void 0)return!1;let[s,h]=g.current.cell;const[,w]=g.current.cell;let y=!1,k=!1;if(G(a.scrollToSelectedCell,t,r))Ho.current(s-u,h);else if(ye!=="none"&&G(a.selectColumn,t,r))d.hasIndex(s)?ue(d.remove(s),void 0,!0):ye==="single"?ue(_.fromSingleSelection(s),void 0,!0):ue(void 0,s,!0);else if(ke!=="none"&&G(a.selectRow,t,r))v.hasIndex(h)?xe(v.remove(h),void 0,!0):ke==="single"?xe(_.fromSingleSelection(h),void 0,!0):xe(void 0,h,!0);else if(!Qt&&i!==void 0&&G(a.activateCell,t,r))if(h===F&&se)window.setTimeout(()=>{const P=$t(s);at(P??s)},0);else{const P={inputType:"keyboard",key:t.key};Q==null||Q([s-u,h],P),Ft(i,P)}else g.current.range.height>1&&G(a.downFill,t,r)?_n():g.current.range.width>1&&G(a.rightFill,t,r)?Xn():G(a.goToNextPage,t,r)?h+=Math.max(1,Ee.current.height-4):G(a.goToPreviousPage,t,r)?h-=Math.max(1,Ee.current.height-4):G(a.goToFirstCell,t,r)?(x(void 0),h=0,s=0):G(a.goToLastCell,t,r)?(x(void 0),h=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER):G(a.selectToFirstCell,t,r)?(x(void 0),We([-2,-2])):G(a.selectToLastCell,t,r)?(x(void 0),We([2,2])):Qt?(G(a.closeOverlay,t,r)&&x(void 0),G(a.acceptOverlayDown,t,r)&&(x(void 0),h++),G(a.acceptOverlayUp,t,r)&&(x(void 0),h--),G(a.acceptOverlayLeft,t,r)&&(x(void 0),s--),G(a.acceptOverlayRight,t,r)&&(x(void 0),s++)):(G(a.goDownCell,t,r)?h+=1:G(a.goUpCell,t,r)?h-=1:G(a.goRightCell,t,r)?s+=1:G(a.goLeftCell,t,r)?s-=1:G(a.goDownCellRetainSelection,t,r)?(h+=1,y=!0):G(a.goUpCellRetainSelection,t,r)?(h-=1,y=!0):G(a.goRightCellRetainSelection,t,r)?(s+=1,y=!0):G(a.goLeftCellRetainSelection,t,r)?(s-=1,y=!0):G(a.goToLastRow,t,r)?h=F-1:G(a.goToFirstRow,t,r)?h=Number.MIN_SAFE_INTEGER:G(a.goToLastColumn,t,r)?s=Number.MAX_SAFE_INTEGER:G(a.goToFirstColumn,t,r)?s=Number.MIN_SAFE_INTEGER:(je==="rect"||je==="multi-rect")&&(G(a.selectGrowDown,t,r)?We([0,1]):G(a.selectGrowUp,t,r)?We([0,-1]):G(a.selectGrowRight,t,r)?We([1,0]):G(a.selectGrowLeft,t,r)?We([-1,0]):G(a.selectToLastRow,t,r)?We([0,2]):G(a.selectToFirstRow,t,r)?We([0,-2]):G(a.selectToLastColumn,t,r)?We([2,0]):G(a.selectToFirstColumn,t,r)&&We([-2,0])),k=r.didMatch);if(Oe!==void 0&&Oe!=="normal"&&h!==w){const P=Oe==="skip-up"||Oe==="skip"||Oe==="block",ee=Oe==="skip-down"||Oe==="skip"||Oe==="block",j=h<w;if(j&&P){for(;h>=0&&Rt(h).isGroupHeader;)h--;h<0&&(h=w)}else if(!j&&ee){for(;h<F&&Rt(h).isGroupHeader;)h++;h>=F&&(h=w)}}const E=dt(s,h,!1,y),I=r.didMatch;return I&&(E||!k||xn)&&n(),I},[Oe,Qt,g,ct,ye,ke,je,u,Rt,F,dt,Fe,lt,V.length,st,xn,kt,ue,xe,se,$t,at,Q,Ft,_n,Xn,We]),eo=l.useCallback(t=>{let n=!1;Wt!==void 0&&Wt({...t,...t.location&&{location:[t.location[0]-u,t.location[1]]},cancel:()=>{n=!0}}),!n&&(qn(t)||g.current)},[Uo,Wt,qn,g,O,u,F,se,Q,Ft]),Ll=l.useCallback((t,n)=>{const r=t.location[0]-u;if(t.kind==="header"&&(Ge==null||Ge(r,{...t,preventDefault:n})),t.kind===Kt){if(r<0)return;L==null||L(r,{...t,preventDefault:n})}if(t.kind==="cell"){const[i,d]=t.location;Pe==null||Pe([r,d],{...t,preventDefault:n}),si(g,t.location)||dt(i,d,!1,!1)}},[g,Pe,L,Ge,u,dt]),un=l.useCallback(async t=>{var a,s,h;if(!ct.paste)return;function n(w,y,k,p){var I,S;const E=typeof k=="object"?(k==null?void 0:k.join(`
`))??"":(k==null?void 0:k.toString())??"";if(!Ao(w)&&oo(w)&&w.readonly!==!0){const $=oe==null?void 0:oe(E,w);if($!==void 0&&no($))return{location:y,value:$};const A=Re(w);if(A===void 0)return;if(A.kind===te.Custom){Ko(w.kind===te.Custom);const P=(I=A.onPaste)==null?void 0:I.call(A,E,w.data);return P===void 0?void 0:{location:y,value:{...w,data:P}}}else{const P=(S=A.onPaste)==null?void 0:S.call(A,E,w,{formatted:p,formattedString:typeof p=="string"?p:p==null?void 0:p.join(`
`),rawValue:k});return P===void 0?void 0:(Ko(P.kind===w.kind),{location:y,value:P})}}}const r=g.columns,i=g.rows,d=((a=X.current)==null?void 0:a.contains(document.activeElement))===!0||((s=b.current)==null?void 0:s.contains(document.activeElement))===!0;let v;if(g.current!==void 0?v=[g.current.range.x,g.current.range.y]:r.length===1?v=[r.first()??0,0]:i.length===1&&(v=[u,i.first()??0]),d&&v!==void 0){let w,y;const k="text/plain",p="text/html";if(navigator.clipboard.read!==void 0){const $=await navigator.clipboard.read();for(const A of $){if(A.types.includes(p)){const ee=await(await A.getType(p)).text(),j=sr(ee);if(j!==void 0){w=j;break}}A.types.includes(k)&&(y=await(await A.getType(k)).text())}}else if(navigator.clipboard.readText!==void 0)y=await navigator.clipboard.readText();else if(t!==void 0&&(t==null?void 0:t.clipboardData)!==null){if(t.clipboardData.types.includes(p)){const $=t.clipboardData.getData(p);w=sr($)}w===void 0&&t.clipboardData.types.includes(k)&&(y=t.clipboardData.getData(k))}else return;const[E,I]=v,S=[];do{if(pt===void 0){const $=ze(v),A=y??(w==null?void 0:w.map(ee=>ee.map(j=>j.rawValue).join("	")).join("	"))??"",P=n($,v,A,void 0);P!==void 0&&S.push(P);break}if(w===void 0){if(y===void 0)return;w=ai(y)}if(pt===!1||typeof pt=="function"&&(pt==null?void 0:pt([v[0]-u,v[1]],w.map($=>$.map(A=>{var P;return((P=A.rawValue)==null?void 0:P.toString())??""}))))!==!0)return;for(const[$,A]of w.entries()){if($+I>=F)break;for(const[P,ee]of A.entries()){const j=[P+E,$+I],[Se,Xe]=j;if(Se>=W.length||Xe>=pe)continue;const Ue=ze(j),_e=n(Ue,j,ee.rawValue,ee.formatted);_e!==void 0&&S.push(_e)}}}while(!1);$e(S),(h=ie.current)==null||h.damage(S.map($=>({cell:$.location})))}},[oe,Re,ze,g,ct.paste,X,W.length,$e,pe,pt,u,F]);gn("paste",un,R,!1,!0);const to=l.useCallback(async(t,n)=>{var a,s;if(!ct.copy)return;const r=n===!0||((a=X.current)==null?void 0:a.contains(document.activeElement))===!0||((s=b.current)==null?void 0:s.contains(document.activeElement))===!0,i=g.columns,d=g.rows,v=(h,w)=>{if(!bn)ar(h,w,t);else{const y=w.map(k=>({kind:te.Text,data:V[k].title,displayData:V[k].title,allowOverlay:!1}));ar([y,...h],w,t)}};if(r&&ge!==void 0){if(g.current!==void 0){let h=ge(g.current.range,Ie.current.signal);typeof h!="object"&&(h=await h()),v(h,Nt(g.current.range.x-u,g.current.range.x+g.current.range.width-u))}else if(d!==void 0&&d.length>0){const w=[...d].map(y=>{const k=ge({x:u,y,width:V.length,height:1},Ie.current.signal);return typeof k=="object"?k[0]:k().then(p=>p[0])});if(w.some(y=>y instanceof Promise)){const y=await Promise.all(w);v(y,Nt(V.length))}else v(w,Nt(V.length))}else if(i.length>0){const h=[],w=[];for(const y of i){let k=ge({x:y,y:0,width:1,height:F},Ie.current.signal);typeof k!="object"&&(k=await k()),h.push(k),w.push(y-u)}if(h.length===1)v(h[0],w);else{const y=h.reduce((k,p)=>k.map((E,I)=>[...E,...p[I]]));v(y,w)}}}},[V,ge,g,ct.copy,u,X,F,bn]);gn("copy",to,R,!1,!1);const Hl=l.useCallback(async t=>{var r,i;if(!(!ct.cut||!(((r=X.current)==null?void 0:r.contains(document.activeElement))===!0||((i=b.current)==null?void 0:i.contains(document.activeElement))===!0))&&(await to(t),g.current!==void 0)){let d={current:{cell:g.current.cell,range:g.current.range,rangeStack:[]},rows:_.empty(),columns:_.empty()};const v=st==null?void 0:st(d);if(v===!1||(d=v===!0?d:v,d.current===void 0))return;kt(d.current.range)}},[kt,g,ct.cut,to,X,st]);gn("cut",Hl,R,!1,!1);const Dl=l.useCallback((t,n)=>{if(Ke!==void 0){u!==0&&(t=t.map(d=>[d[0]-u,d[1]])),Ke(t,n);return}if(t.length===0||n===-1)return;const[r,i]=t[n];m.current!==void 0&&m.current[0]===r&&m.current[1]===i||(m.current=[r,i],dt(r,i,!1,!1))},[Ke,u,dt]),[zo,Lo]=((or=bt==null?void 0:bt.current)==null?void 0:or.cell)??[],Ho=l.useRef(le);Ho.current=le,l.useLayoutEffect(()=>{var t,n,r,i;an.current&&!yo.current&&zo!==void 0&&Lo!==void 0&&(zo!==((n=(t=bo.current)==null?void 0:t.current)==null?void 0:n.cell[0])||Lo!==((i=(r=bo.current)==null?void 0:r.current)==null?void 0:i.cell[1]))&&Ho.current(zo,Lo),yo.current=!1},[zo,Lo]);const jn=g.current!==void 0&&(g.current.cell[0]>=W.length||g.current.cell[1]>=pe);l.useLayoutEffect(()=>{jn&&Fe(vn,!1)},[jn,Fe]);const Il=l.useMemo(()=>se===!0&&(B==null?void 0:B.tint)===!0?_.fromSingleSelection(pe-1):_.empty(),[pe,se,B==null?void 0:B.tint]),Fl=l.useCallback(t=>typeof Et=="boolean"?Et:(Et==null?void 0:Et(t-u))??!0,[u,Et]),$l=l.useMemo(()=>{if(on===void 0||b.current===null)return null;const{bounds:t,group:n}=on,r=b.current.getBoundingClientRect();return l.createElement(rc,{bounds:t,group:n,canvasBounds:r,onClose:()=>nn(void 0),onFinish:i=>{nn(void 0),ce==null||ce(n,i)}})},[ce,on]),Al=Math.min(W.length,Qe+(Ve?1:0));l.useImperativeHandle(o,()=>({appendRow:(t,n)=>at(t+u,n),appendColumn:(t,n)=>So(t,n),updateCells:t=>{var n;return u!==0&&(t=t.map(r=>({cell:[r.cell[0]+u,r.cell[1]]}))),(n=ie.current)==null?void 0:n.damage(t)},getBounds:(t,n)=>{var r;if(!((b==null?void 0:b.current)===null||(X==null?void 0:X.current)===null)){if(t===void 0&&n===void 0){const i=b.current.getBoundingClientRect(),d=i.width/X.current.clientWidth;return{x:i.x-X.current.scrollLeft*d,y:i.y-X.current.scrollTop*d,width:X.current.scrollWidth*d,height:X.current.scrollHeight*d}}return(r=ie.current)==null?void 0:r.getBounds((t??0)+u,n)}},focus:()=>{var t;return(t=ie.current)==null?void 0:t.focus()},emit:async t=>{switch(t){case"delete":eo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!1,key:"Delete",keyCode:46,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-right":eo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"r",keyCode:82,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"fill-down":eo({bounds:void 0,cancel:()=>{},stopPropagation:()=>{},preventDefault:()=>{},ctrlKey:!0,key:"d",keyCode:68,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:void 0});break;case"copy":await to(void 0,!0);break;case"paste":await un();break}},scrollTo:le,remeasureColumns:t=>{for(const n of t)To(n+u)},getMouseArgsForPosition:(t,n,r)=>{if((ie==null?void 0:ie.current)===null)return;const i=ie.current.getMouseArgsForPosition(t,n,r);if(i!==void 0)return{...i,location:[i.location[0]-u,i.location[1]]}}}),[at,So,To,X,to,eo,un,u,le]);const[Zn,Jn]=Be??[],Pl=l.useCallback(t=>{const[n,r]=t;if(r===-1){ye!=="none"&&(ue(_.fromSingleSelection(n),void 0,!1),Ce());return}Zn===n&&Jn===r||(ve({cell:t,range:{x:n,y:r,width:1,height:1}},!0,!1,"keyboard-nav"),le(n,r))},[ye,Ce,le,Zn,Jn,ve,ue]),[Gl,Kl]=l.useState(!1),Qn=l.useRef(vi(t=>{Kl(t)},5)),Nl=l.useCallback(()=>{Qn.current(!0),g.current===void 0&&g.columns.length===0&&g.rows.length===0&&M===void 0&&ve({cell:[u,xo],range:{x:u,y:xo,width:1,height:1}},!0,!1,"keyboard-select")},[xo,g,M,u,ve]),Ol=l.useCallback(()=>{Qn.current(!1)},[]),[Wl,Ul]=l.useMemo(()=>{let t;const n=(ae==null?void 0:ae.scrollbarWidthOverride)??ui(),r=F+(se?1:0);if(typeof it=="number")t=qt+r*it;else{let d=0;const v=Math.min(r,10);for(let a=0;a<v;a++)d+=it(a);d=Math.floor(d/v),t=qt+r*d}t+=n;const i=W.reduce((d,v)=>v.width+d,0)+n;return[`${Math.min(1e5,i)}px`,`${Math.min(1e5,t)}px`]},[W,ae==null?void 0:ae.scrollbarWidthOverride,it,F,se,qt]),Vl=l.useMemo(()=>di(we),[we]);return l.createElement(fi.Provider,{value:we},l.createElement(hc,{style:Vl,className:Ot,inWidth:q??Wl,inHeight:me??Ul},l.createElement(ec,{fillHandle:zr,drawFocusRing:Sn,experimental:ae,fixedShadowX:Lr,fixedShadowY:Hr,getRowThemeOverride:tt,headerIcons:Dr,imageWindowLoader:Ir,initialSize:Fr,isDraggable:$r,onDragLeave:Ar,onRowMoved:_t,overscrollX:ol,overscrollY:nl,preventDiagonalScrolling:Kr,rightElement:Nr,rightElementProps:Or,smoothScrollX:Wr,smoothScrollY:Ur,className:Ot,enableGroups:jo,onCanvasFocused:Nl,onCanvasBlur:Ol,canvasRef:b,onContextMenu:Ll,theme:we,cellXOffset:gl,cellYOffset:xo,accessibilityHeight:yt.height,onDragEnd:Sl,columns:W,nonGrowWidth:Pn,drawHeader:dl,onColumnProposeMove:Rl,drawCell:fl,disabledRows:Il,freezeColumns:Al,lockColumns:u,firstColAccessible:u===0,getCellContent:ze,minColumnWidth:zt,maxColumnWidth:po,searchInputRef:H,showSearch:ll,onSearchClose:il,highlightRegions:vl,getCellsForSelection:ge,getGroupDetails:Jo,headerHeight:Yo,isFocused:Gl,groupHeaderHeight:jo?In:0,freezeTrailingRows:et+(se&&(B==null?void 0:B.sticky)===!0?1:0),hasAppendRow:se,onColumnResize:Ht,onColumnResizeEnd:al,onColumnResizeStart:ul,onCellFocused:Pl,onColumnMoved:Ml,onDragStart:kl,onHeaderMenuClick:bl,onHeaderIndicatorClick:yl,onItemHovered:sn,isFilling:(M==null?void 0:M.fillHandle)===!0,onMouseMove:pl,onKeyDown:eo,onKeyUp:mt,onMouseDown:ml,onMouseUp:Cl,onDragOverCell:Tr,onDrop:Er,onSearchResultsChanged:Dl,onVisibleRegionChanged:xl,clientSize:qo,rowHeight:it,searchResults:vt,searchValue:Wo,onSearchValueChange:lo,rows:pe,scrollRef:X,selection:g,translateX:yt.tx,translateY:yt.ty,verticalBorder:Fl,gridRef:ie,getCellRenderer:Re,resizeIndicator:qr}),$l,C!==void 0&&l.createElement(l.Suspense,{fallback:null},l.createElement(Mc,{...C,validateCell:sl,bloom:Ye,id:zl,getCellRenderer:Re,className:(ae==null?void 0:ae.isSubGrid)===!0?"click-outside-ignore":void 0,provideEditor:Mr,imageEditorOverride:T,portalElementRef:jr,onFinishEditing:El,markdownDivCreateNode:U,isOutsideClick:Yr,customEventTarget:ae==null?void 0:ae.eventTarget}))))},Ec=l.forwardRef(Tc),zc=(e,o)=>{const c=l.useMemo(()=>({...Yi,...e.headerIcons}),[e.headerIcons]),f=l.useMemo(()=>e.renderers??hi,[e.renderers]),C=l.useMemo(()=>e.imageWindowLoader??new gi,[e.imageWindowLoader]);return l.createElement(Ec,{...e,renderers:f,headerIcons:c,ref:o,imageWindowLoader:C})},Kc=l.forwardRef(zc);export{tc as C,Kc as D,ft as k,yc as u};
