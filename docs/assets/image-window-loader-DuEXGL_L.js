const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./number-overlay-editor-CqaOLUq8.js","./iframe-DfFb5Ign.js","./preload-helper-C1FmrZbK.js","./marked.esm-CIUALPyN.js","./react-number-format.es-p7Wc_rWC.js","./throttle-ByAiyUNP.js","./index-KG-dsUoR.js","./number-overlay-editor-DjcVbkae.css"])))=>i.map(i=>d[i]);
var ji=Object.defineProperty;var Ki=(e,t,n)=>t in e?ji(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ee=(e,t,n)=>Ki(e,typeof t!="symbol"?t+"":t,n);import{r as m,R as dn}from"./iframe-DfFb5Ign.js";import{h as Ji,g as Qi,k as Zi,v as er,l as tr,m as In,r as nr,j as or,t as ir}from"./throttle-ByAiyUNP.js";import{s as ht,a as rr}from"./marked.esm-CIUALPyN.js";import{r as sr}from"./index-KG-dsUoR.js";import{_ as lr}from"./preload-helper-C1FmrZbK.js";function ti(e="This should not happen"){throw new Error(e)}function yt(e,t="Assertion failed"){if(!e)return ti(t)}function oo(e,t){return ti(t??"Hell froze over")}function Al(e,t){try{return e()}catch{return t}}const Bo=Object.prototype.hasOwnProperty;function Gt(e,t){let n,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((o=e.length)===t.length)for(;o--&&Gt(e[o],t[o]););return o===-1}if(!n||typeof e=="object"){o=0;for(n in e)if(Bo.call(e,n)&&++o&&!Bo.call(t,n)||!(n in t)||!Gt(e[n],t[n]))return!1;return Object.keys(t).length===o}}return e!==e&&t!==t}const Fn=null,io=void 0;var me=(e=>(e.Uri="uri",e.Text="text",e.Image="image",e.RowID="row-id",e.Number="number",e.Bubble="bubble",e.Boolean="boolean",e.Loading="loading",e.Markdown="markdown",e.Drilldown="drilldown",e.Protected="protected",e.Custom="custom",e))(me||{}),ar=(e=>(e.HeaderRowID="headerRowID",e.HeaderCode="headerCode",e.HeaderNumber="headerNumber",e.HeaderString="headerString",e.HeaderBoolean="headerBoolean",e.HeaderAudioUri="headerAudioUri",e.HeaderVideoUri="headerVideoUri",e.HeaderEmoji="headerEmoji",e.HeaderImage="headerImage",e.HeaderUri="headerUri",e.HeaderPhone="headerPhone",e.HeaderMarkdown="headerMarkdown",e.HeaderDate="headerDate",e.HeaderTime="headerTime",e.HeaderEmail="headerEmail",e.HeaderReference="headerReference",e.HeaderIfThenElse="headerIfThenElse",e.HeaderSingleValue="headerSingleValue",e.HeaderLookup="headerLookup",e.HeaderTextTemplate="headerTextTemplate",e.HeaderMath="headerMath",e.HeaderRollup="headerRollup",e.HeaderJoinStrings="headerJoinStrings",e.HeaderSplitString="headerSplitString",e.HeaderGeoDistance="headerGeoDistance",e.HeaderArray="headerArray",e.RowOwnerOverlay="rowOwnerOverlay",e.ProtectedColumnOverlay="protectedColumnOverlay",e.HeaderArrowDown="headerArrowDown",e.HeaderArrowUp="headerArrowUp",e))(ar||{}),jn=(e=>(e.Triangle="triangle",e.Dots="dots",e))(jn||{});function Dl(e){return"width"in e&&typeof e.width=="number"}async function Rl(e){return typeof e=="object"?e:await e()}function Cn(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown")}function Tl(e){return!(e.kind==="loading"||e.kind==="bubble"||e.kind==="row-id"||e.kind==="protected"||e.kind==="drilldown"||e.kind==="boolean"||e.kind==="image"||e.kind==="custom")}function ro(e){return e.kind==="marker"||e.kind==="new-row"||e.kind==="row-status"}function cr(e){if(!Cn(e)||e.kind==="image")return!1;switch(e.kind){case"text":case"number":case"markdown":case"uri":case"custom":case"boolean":return e.readonly!==!0;default:oo(e,"A cell was passed with an invalid kind")}}function dr(e){return Ji(e,"editor")}function so(e){return!(e.readonly??!1)}var Et=(e=>(e.NewRow="new-row",e.Marker="marker",e.RowStatus="row-status",e.RowId="row-id",e))(Et||{});const Hn={shape:"square",size:4,offsetX:-2,offsetY:-2,outline:0};function Xn(e){if(e.length===0)return[];const t=[...e],n=[];t.sort(function(o,i){return o[0]-i[0]}),n.push([...t[0]]);for(const o of t.slice(1)){const i=n[n.length-1];i[1]<o[0]?n.push([...o]):i[1]<o[1]&&(i[1]=o[1])}return n}let Ao;const qe=class qe{constructor(t){this.items=t}offset(t){if(t===0)return this;const n=this.items.map(o=>[o[0]+t,o[1]+t]);return new qe(n)}add(t){const n=typeof t=="number"?[t,t+1]:t,o=Xn([...this.items,n]);return new qe(o)}remove(t){const n=[...this.items],o=typeof t=="number"?t:t[0],i=typeof t=="number"?t+1:t[1];for(const[r,l]of n.entries()){const[s,a]=l;if(s<=i&&o<=a){const c=[];s<o&&c.push([s,o]),i<a&&c.push([i,a]),n.splice(r,1,...c)}}return new qe(n)}first(){if(this.items.length!==0)return this.items[0][0]}last(){if(this.items.length!==0)return this.items.slice(-1)[0][1]-1}hasIndex(t){for(let n=0;n<this.items.length;n++){const[o,i]=this.items[n];if(t>=o&&t<i)return!0}return!1}hasAll(t){for(let n=t[0];n<t[1];n++)if(!this.hasIndex(n))return!1;return!0}some(t){for(const n of this)if(t(n))return!0;return!1}equals(t){if(t===this)return!0;if(t.items.length!==this.items.length)return!1;for(let n=0;n<this.items.length;n++){const o=t.items[n],i=this.items[n];if(o[0]!==i[0]||o[1]!==i[1])return!1}return!0}toArray(){const t=[];for(const[n,o]of this.items)for(let i=n;i<o;i++)t.push(i);return t}get length(){let t=0;for(const[n,o]of this.items)t+=o-n;return t}*[Symbol.iterator](){for(const[t,n]of this.items)for(let o=t;o<n;o++)yield o}};ee(qe,"create",t=>new qe(Xn(t))),ee(qe,"empty",()=>Ao??(Ao=new qe([]))),ee(qe,"fromSingleSelection",t=>qe.empty().add(t)),ee(qe,"fromArray",t=>{if(t.length===0)return qe.empty();const n=t.map(i=>[i,i+1]),o=Xn(n);return new qe(o)});let Kn=qe;function ut(e,t,n,o,i=!1){const r=m.useRef();r.current=t,m.useEffect(()=>{if(n===null||n.addEventListener===void 0)return;const l=n,s=a=>{var c;(c=r.current)==null||c.call(l,a)};return l.addEventListener(e,s,{passive:o,capture:i}),()=>{l.removeEventListener(e,s,{capture:i})}},[e,n,o,i])}function Wl(e,t){return e===void 0?void 0:t}const ur=Math.PI;function Do(e){return e*ur/180}const ni=(e,t,n)=>({x1:e-n/2,y1:t-n/2,x2:e+n/2,y2:t+n/2}),oi=(e,t,n,o,i)=>{switch(e){case"left":return Math.floor(t)+o+i/2;case"center":return Math.floor(t+n/2);case"right":return Math.floor(t+n)-o-i/2}},ii=(e,t,n)=>Math.min(e,t-n*2),ri=(e,t,n)=>n.x1<=e&&e<=n.x2&&n.y1<=t&&t<=n.y2,lo=e=>{const t=e.fgColor??"currentColor";return m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"M12.7073 7.05029C7.87391 11.8837 10.4544 9.30322 6.03024 13.7273C5.77392 13.9836 5.58981 14.3071 5.50189 14.6587L4.52521 18.5655C4.38789 19.1148 4.88543 19.6123 5.43472 19.475L9.34146 18.4983C9.69313 18.4104 10.0143 18.2286 10.2706 17.9722L16.9499 11.2929",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}),m.createElement("path",{d:"M20.4854 4.92901L19.0712 3.5148C18.2901 2.73375 17.0238 2.73375 16.2428 3.5148L14.475 5.28257C15.5326 7.71912 16.4736 8.6278 18.7176 9.52521L20.4854 7.75744C21.2665 6.97639 21.2665 5.71006 20.4854 4.92901Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",vectorEffect:"non-scaling-stroke"}))},fr=e=>{const t=e.fgColor??"currentColor";return m.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m.createElement("path",{d:"M19 6L10.3802 17L5.34071 11.8758",vectorEffect:"non-scaling-stroke",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))};function hr(e,t,n){const[o,i]=m.useState(e),r=m.useRef(!0);m.useEffect(()=>()=>{r.current=!1},[]);const l=m.useRef(Qi(s=>{r.current&&i(s)},n));return m.useLayoutEffect(()=>{r.current&&l.current(()=>e())},t),o}const gr="֑-߿יִ-﷽ﹰ-ﻼ",mr="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",br=new RegExp("^[^"+mr+"]*["+gr+"]");function ao(e){return br.test(e)?"rtl":"not-rtl"}let xn;function Ro(){if(typeof document>"u")return 0;if(xn!==void 0)return xn;const e=document.createElement("p");e.style.width="100%",e.style.height="200px";const t=document.createElement("div");t.id="testScrollbar",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.append(e),document.body.append(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),t.remove(),xn=n-o,xn}const Tt=Symbol();function Ol(e){const t=m.useRef([Tt,e]);t.current[1]!==e&&(t.current[0]=e),t.current[1]=e;const[n,o]=m.useState(e),[,i]=m.useState(),r=m.useCallback(s=>{const a=t.current[0];a!==Tt&&(s=typeof s=="function"?s(a):s,s===a)||(a!==Tt&&i({}),o(c=>typeof s=="function"?s(a===Tt?c:a):s),t.current[0]=Tt)},[]),l=m.useCallback(()=>{t.current[0]=Tt,i({})},[]);return[t.current[0]===Tt?n:t.current[0],r,l]}function si(e){if(e.length===0)return"";let t=0,n=0;for(const o of e){if(n+=o.length,n>1e4)break;t++}return e.slice(0,t).join(", ")}function zl(e){const t=m.useRef(e);return Gt(e,t.current)||(t.current=e),t.current}function vr(e,t){return dn.useMemo(()=>e.map((n,o)=>({group:n.group,grow:n.grow,hasMenu:n.hasMenu,icon:n.icon,id:n.id,menuIcon:n.menuIcon,overlayIcon:n.overlayIcon,sourceIndex:o,sticky:o<t,indicatorIcon:n.indicatorIcon,style:n.style,themeOverride:n.themeOverride,title:n.title,trailingRowOptions:n.trailingRowOptions,width:n.width,growOffset:n.growOffset,rowMarker:n.rowMarker,rowMarkerChecked:n.rowMarkerChecked,headerRowMarkerTheme:n.headerRowMarkerTheme,headerRowMarkerAlwaysVisible:n.headerRowMarkerAlwaysVisible,headerRowMarkerDisabled:n.headerRowMarkerDisabled,rowGroupBorder:n.rowGroupBorder,required:n.required})),[e,t])}function Ll(e,t){const[n,o]=t;if(e.columns.hasIndex(n)||e.rows.hasIndex(o))return!0;if(e.current!==void 0){if(En(e.current.cell,t))return!0;const i=[e.current.range,...e.current.rangeStack];for(const r of i)if(n>=r.x&&n<r.x+r.width&&o>=r.y&&o<r.y+r.height)return!0}return!1}function zt(e,t){return e===void 0?"":typeof e=="string"?e:t!==void 0&&t>=0&&t<e.length?e[t]:e.length>0?e[e.length-1]:""}function Jn(e,t,n){if(e!==void 0)return typeof e=="string"?t===n-1?e:void 0:t<e.length?e[t]:void 0}function yr(e,t){const n=zt(e),o=zt(t);return n===o}function Qn(e,t,n,o){for(let i=0;i<=n;i++){const r=Jn(e,i,o)??"",l=Jn(t,i,o)??"";if(r!==l)return!1}return!0}function pr(e,t,n){return n.current===void 0||e[1]!==n.current.cell[1]?!1:t.span===void 0?n.current.cell[0]===e[0]:n.current.cell[0]>=t.span[0]&&n.current.cell[0]<=t.span[1]}function wr(e,t){const[n,o]=e;return n>=t.x&&n<t.x+t.width&&o>=t.y&&o<t.y+t.height}function En(e,t){return(e==null?void 0:e[0])===(t==null?void 0:t[0])&&(e==null?void 0:e[1])===(t==null?void 0:t[1])}function li(e){return[e.x+e.width-1,e.y+e.height-1]}function To(e,t,n){const o=n.x,i=n.x+n.width-1,r=n.y,l=n.y+n.height-1,[s,a]=e;if(a<r||a>l)return!1;if(t.span===void 0)return s>=o&&s<=i;const[c,u]=t.span;return c>=o&&c<=i||u>=o&&c<=i||c<o&&u>i}function kr(e,t,n,o){let i=0;if(n.current===void 0)return i;const r=n.current.range;(o||r.height*r.width>1)&&To(e,t,r)&&i++;for(const l of n.current.rangeStack)To(e,t,l)&&i++;return i}function ai(e,t){let n=e;if(t!==void 0){let o=[...e];const i=n[t.src];t.src>t.dest?(o.splice(t.src,1),o.splice(t.dest,0,i)):(o.splice(t.dest+1,0,i),o.splice(t.src,1)),o=o.map((r,l)=>({...r,sticky:e[l].sticky})),n=o}return n}function jt(e,t){let n=0;const o=ai(e,t);for(let i=0;i<o.length;i++){const r=o[i];if(r.sticky)n+=r.width;else break}return n}function Kt(e,t,n){if(typeof n=="number")return t*n;{let o=0;for(let i=e-t;i<e;i++)o+=n(i);return o}}function Zn(e,t,n,o,i){const r=ai(e,o),l=[];for(const c of r)if(c.sticky)l.push(c);else break;if(l.length>0)for(const c of l)n-=c.width;let s=t,a=i??0;for(;a<=n&&s<r.length;)a+=r[s].width,s++;for(let c=t;c<s;c++){const u=r[c];u.sticky||l.push(u)}return l}function xr(e,t,n){let o=0;for(const i of t){const r=i.sticky?o:o+(n??0);if(e<=r+i.width)return i.sourceIndex;o+=i.width}return-1}function Sr(e,t,n,o,i,r,l,s,a,c,u,b){const h=u??(n?1:0),f=b??(n?[i]:[]),d=f.reduce((x,C)=>x+C,0),g=o+d;if(n&&h>0){let x=0;for(let C=0;C<h;C++)if(x+=f[C]??0,e<=x)return-(C+2)}if(e<=g)return-1;let v=t;for(let x=0;x<c;x++){const C=r-1-x,B=typeof l=="number"?l:l(C);if(v-=B,e>=v)return C}const p=r-c,y=e-(a??0);if(typeof l=="number"){const x=Math.floor((y-g)/l)+s;return x>=p?void 0:x}else{let x=g;for(let C=s;C<p;C++){const B=l(C);if(y<=x+B)return C;x+=B}return}}let Mn=0,cn={};const Cr=typeof window>"u";async function Er(){var e;Cr||((e=document==null?void 0:document.fonts)==null?void 0:e.ready)===void 0||(await document.fonts.ready,Mn=0,cn={},er())}Er();function ci(e,t,n,o){return`${e}_${o??(t==null?void 0:t.font)}_${n}`}function Nt(e,t,n,o="middle"){const i=ci(e,t,o,n);let r=cn[i];return r===void 0&&(r=t.measureText(e),cn[i]=r,Mn++),Mn>1e4&&(cn={},Mn=0),r}function di(e,t){const n=ci(e,void 0,"middle",t);return cn[n]}function tt(e,t){return typeof t!="string"&&(t=t.baseFontFull),Mr(e,t)}function Wo(e,t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.save(),e.textBaseline=t;const o=e.measureText(n);return e.restore(),o}const Oo=[];function Mr(e,t){for(const r of Oo)if(r.key===t)return r.val;const n=Wo(e,"alphabetic"),i=-(Wo(e,"middle").actualBoundingBoxDescent-n.actualBoundingBoxDescent)+n.actualBoundingBoxAscent/2;return Oo.push({key:t,val:i}),i}function Ir(e,t,n,o,i,r){const{ctx:l,rect:s,theme:a}=e;let c=Number.MAX_SAFE_INTEGER;const u=500;if(t!==void 0&&(c=n-t,c<u)){const b=1-c/u;l.globalAlpha=b,l.fillStyle=a.bgSearchResult,l.fillRect(s.x+1,s.y+1,s.width-(i?2:1),s.height-(r?2:1)),l.globalAlpha=1,o!==void 0&&(o.fillStyle=a.bgSearchResult)}return c<u}function Bn(e,t,n){const{ctx:o,theme:i}=e,r=t??{},l=n??i.textDark;return l!==r.fillStyle&&(o.fillStyle=l,r.fillStyle=l),r}function ui(e,t,n,o,i,r,l,s,a){a==="right"?e.fillText(t,n+i-(s.cellHorizontalPadding+.5),o+r/2+l):a==="center"?e.fillText(t,n+i/2,o+r/2+l):e.fillText(t,n+s.cellHorizontalPadding+.5,o+r/2+l)}function fi(e,t){const n=Nt("ABCi09jgqpy",e,t);return n.actualBoundingBoxAscent+n.actualBoundingBoxDescent}function Fr(e,t){e=String(e),e.includes(`
`)&&(e=e.split(/\r?\n/,1)[0]);const n=t/4;return e.length>n&&(e=e.slice(0,n)),e}function Hr(e,t,n,o,i,r,l,s,a,c){const u=s.baseFontFull,b=Zi(e,t,u,i-s.cellHorizontalPadding*2,c??!1),h=fi(e,u),f=s.lineHeight*h,d=h+f*(b.length-1),g=d+s.cellVerticalPadding>r;g&&(e.save(),e.rect(n,o,i,r),e.clip());const v=o+r/2-d/2;let p=Math.max(o+s.cellVerticalPadding,v);for(const y of b)if(ui(e,y,n,p,i,h,l,s,a),p+=f,p>o+r)break;g&&e.restore()}function Ct(e,t,n,o,i){const{ctx:r,rect:l,theme:s}=e,{x:a,y:c,width:u,height:b}=l;o=o??!1,o||(t=Fr(t,u));const h=tt(r,s),f=ao(t)==="rtl";if(n===void 0&&f&&(n="right"),f&&(r.direction="rtl"),t.length>0){let d=!1;n==="right"?(r.textAlign="right",d=!0):n!==void 0&&n!=="left"&&(r.textAlign=n,d=!0),o?Hr(r,t,a,c,u,b,h,s,n,i):ui(r,t,a,c,u,b,h,s,n),d&&(r.textAlign="start"),f&&(r.direction="inherit")}}function ft(e,t,n,o,i,r){typeof r=="number"&&(r={tl:r,tr:r,br:r,bl:r}),r={tl:Math.max(0,Math.min(r.tl,i/2,o/2)),tr:Math.max(0,Math.min(r.tr,i/2,o/2)),bl:Math.max(0,Math.min(r.bl,i/2,o/2)),br:Math.max(0,Math.min(r.br,i/2,o/2))},e.moveTo(t+r.tl,n),e.arcTo(t+o,n,t+o,n+r.tr,r.tr),e.arcTo(t+o,n+i,t+o-r.br,n+i,r.br),e.arcTo(t,n+i,t,n+i-r.bl,r.bl),e.arcTo(t,n,t+r.tl,n,r.tl)}function Pr(e,t,n){e.arc(t,n-1.25*3.5,1.25,0,2*Math.PI,!1),e.arc(t,n,1.25,0,2*Math.PI,!1),e.arc(t,n+1.25*3.5,1.25,0,2*Math.PI,!1)}function Br(e,t,n){const o=function(s,a){const c=a.x-s.x,u=a.y-s.y,b=Math.sqrt(c*c+u*u),h=c/b,f=u/b;return{x:c,y:a.y-s.y,len:b,nx:h,ny:f,ang:Math.atan2(f,h)}};let i;const r=t.length;let l=t[r-1];for(let s=0;s<r;s++){let a=t[s%r];const c=t[(s+1)%r],u=o(a,l),b=o(a,c),h=u.nx*b.ny-u.ny*b.nx,f=u.nx*b.nx-u.ny*-b.ny;let d=Math.asin(h<-1?-1:h>1?1:h),g=1,v=!1;f<0?d<0?d=Math.PI+d:(d=Math.PI-d,g=-1,v=!0):d>0&&(g=-1,v=!0),i=a.radius!==void 0?a.radius:n;const p=d/2;let y=Math.abs(Math.cos(p)*i/Math.sin(p)),x;y>Math.min(u.len/2,b.len/2)?(y=Math.min(u.len/2,b.len/2),x=Math.abs(y*Math.sin(p)/Math.cos(p))):x=i;let C=a.x+b.nx*y,B=a.y+b.ny*y;C+=-b.ny*x*g,B+=b.nx*x*g,e.arc(C,B,x,u.ang+Math.PI/2*g,b.ang-Math.PI/2*g,v),l=a,a=c}e.closePath()}function eo(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g,v){const p={x:0,y:r+c,width:0,height:0},y=g??(i>0?1:0),x=-(y+1);if(e>=f.length||t>=u||t<x||e<0)return p;const C=v??(i>0?[i]:[]),B=C.reduce((F,H)=>F+H,0),P=r-B;if(e>=b){const F=l>e?-1:1,H=jt(f);p.x+=H+a;for(let k=l;k!==e;k+=F)p.x+=f[F===1?k:k-1].width*F}else for(let F=0;F<e;F++)p.x+=f[F].width;if(p.width=f[e].width+1,t===-1)p.y=B,p.height=P;else if(t<=-2){const F=-(t+2);let H=0;for(let M=0;M<F;M++)H+=C[M]??0;p.y=H,p.height=C[F]??i;let k=e;const R=f[e].group,I=f[e].sticky;for(;k>0&&Qn(f[k-1].group,R,F,y)&&f[k-1].sticky===I;){const M=f[k-1];p.x-=M.width,p.width+=M.width,k--}let S=e;for(;S+1<f.length&&Qn(f[S+1].group,R,F,y)&&f[S+1].sticky===I;){const M=f[S+1];p.width+=M.width,S++}if(!I){const M=jt(f),E=p.x-M;E<0&&(p.x-=E,p.width+=E),p.x+p.width>n&&(p.width=n-p.x)}}else if(t>=u-h){let F=u-t;for(p.y=o;F>0;){const H=t+F-1;p.height=typeof d=="number"?d:d(H),p.y-=p.height,F--}p.height+=1}else{const F=s>t?-1:1;if(typeof d=="number"){const H=t-s;p.y+=H*d}else for(let H=s;H!==t;H+=F)p.y+=d(H)*F;p.height=(typeof d=="number"?d:d(t))+1}return p}const co=1<<21;function lt(e,t){return(t+2)*co+e}function hi(e){return e%co}function uo(e){return Math.floor(e/co)-2}function fo(e){const t=hi(e),n=uo(e);return[t,n]}class gi{constructor(){ee(this,"visibleWindow",{x:0,y:0,width:0,height:0});ee(this,"freezeCols",0);ee(this,"freezeRows",[]);ee(this,"isInWindow",t=>{const n=hi(t),o=uo(t),i=this.visibleWindow,r=n>=i.x&&n<=i.x+i.width||n<this.freezeCols,l=o>=i.y&&o<=i.y+i.height||this.freezeRows.includes(o);return r&&l})}setWindow(t,n,o){this.visibleWindow.x===t.x&&this.visibleWindow.y===t.y&&this.visibleWindow.width===t.width&&this.visibleWindow.height===t.height&&this.freezeCols===n&&Gt(this.freezeRows,o)||(this.visibleWindow=t,this.freezeCols=n,this.freezeRows=o,this.clearOutOfWindow())}}class Ar extends gi{constructor(){super(...arguments);ee(this,"cache",new Map);ee(this,"setValue",(n,o)=>{this.cache.set(lt(n[0],n[1]),o)});ee(this,"getValue",n=>this.cache.get(lt(n[0],n[1])));ee(this,"clearOutOfWindow",()=>{for(const[n]of this.cache.entries())this.isInWindow(n)||this.cache.delete(n)})}}class Ut{constructor(t=[]){ee(this,"cells");this.cells=new Set(t.map(n=>lt(n[0],n[1])))}add(t){this.cells.add(lt(t[0],t[1]))}has(t){return t===void 0?!1:this.cells.has(lt(t[0],t[1]))}remove(t){this.cells.delete(lt(t[0],t[1]))}clear(){this.cells.clear()}get size(){return this.cells.size}hasHeader(){for(const t of this.cells)if(uo(t)<0)return!0;return!1}hasItemInRectangle(t){for(let n=t.y;n<t.y+t.height;n++)for(let o=t.x;o<t.x+t.width;o++)if(this.cells.has(lt(o,n)))return!0;return!1}hasItemInRegion(t){for(const n of t)if(this.hasItemInRectangle(n))return!0;return!1}*values(){for(const t of this.cells)yield fo(t)}}function Dr(e,t){return e==="normal"?[t.bgIconHeader,t.fgIconHeader]:e==="selected"?["white",t.accentColor]:[t.accentColor,t.bgHeader]}class Rr{constructor(t,n){ee(this,"spriteMap",new Map);ee(this,"headerIcons");ee(this,"inFlight",0);this.onSettled=n,this.headerIcons=t??{}}drawSprite(t,n,o,i,r,l,s,a=1){const[c,u]=Dr(n,s),b=l*Math.ceil(window.devicePixelRatio),h=`${c}_${u}_${b}_${t}`;let f=this.spriteMap.get(h);if(f===void 0){const d=this.headerIcons[t];if(d===void 0)return;f=document.createElement("canvas");const g=f.getContext("2d");if(g===null)return;const v=new Image;v.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(d({fgColor:u,bgColor:c}))}`,this.spriteMap.set(h,f);const p=v.decode();if(p===void 0)return;this.inFlight++,p.then(()=>{g.drawImage(v,0,0,b,b)}).finally(()=>{this.inFlight--,this.inFlight===0&&this.onSettled()})}else a<1&&(o.globalAlpha=a),o.drawImage(f,0,0,b,b,i,r,l,l),a<1&&(o.globalAlpha=1)}}const Yn={};let St=null;function Tr(){const e=document.createElement("div");return e.style.opacity="0",e.style.pointerEvents="none",e.style.position="fixed",document.body.append(e),e}function to(e){const t=e.toLowerCase().trim();if(Yn[t]!==void 0)return Yn[t];St=St||Tr(),St.style.color="#000",St.style.color=t;const n=getComputedStyle(St).color;St.style.color="#fff",St.style.color=t;const o=getComputedStyle(St).color;if(o!==n)return[0,0,0,1];let i=o.replace(/[^\d.,]/g,"").split(",").map(Number.parseFloat);return i.length<4&&i.push(1),i=i.map(r=>Number.isNaN(r)?0:r),Yn[t]=i,i}function Jt(e,t){const[n,o,i]=to(e);return`rgba(${n}, ${o}, ${i}, ${t})`}const zo=new Map;function Lo(e,t){const n=`${e}-${t}`,o=zo.get(n);if(o!==void 0)return o;const i=et(e,t);return zo.set(n,i),i}function et(e,t){if(t===void 0)return e;const[n,o,i,r]=to(e);if(r===1)return e;const[l,s,a,c]=to(t),u=r+c*(1-r),b=(r*n+c*l*(1-r))/u,h=(r*o+c*s*(1-r))/u,f=(r*i+c*a*(1-r))/u;return`rgba(${b}, ${h}, ${f}, ${u})`}function mi(e){if(e.length===0)return;let t;for(const n of e)t=Math.min(t??n.y,n.y);return t}function An(e,t,n,o,i,r,l,s,a){s=s??t;let c=t,u=e;const b=o-r;let h=!1;for(;c<n&&u<b;){const f=i(u);if(c+f>s&&a(c,u,f,!1,l&&u===o-1)===!0){h=!0;break}c+=f,u++}if(!h){c=n;for(let f=0;f<r;f++){u=o-1-f;const d=i(u);c-=d,a(c,u,d,!0,l&&u===o-1)}}}function Mt(e,t,n,o,i,r){let l=0,s=0;const a=i+o;for(const c of e){const u=c.sticky?s:l+n;if(r(c,u,a,c.sticky?0:s,t)===!0)break;l+=c.width,s+=c.sticky?c.width:0}}function Wr(e,t,n,o,i){let r=0,l=0;for(let s=0;s<e.length;s++){const a=e[s];let c=s+1,u=a.width;for(a.sticky&&(l+=u);c<e.length&&yr(e[c].group,a.group)&&e[c].sticky===e[s].sticky;){const g=e[c];u+=g.width,c++,s++,g.sticky&&(l+=g.width)}const b=a.sticky?0:n,h=r+b,f=a.sticky?0:Math.max(0,l-h),d=Math.min(u-f,t-(h+f));i([a.sourceIndex,e[c-1].sourceIndex],zt(a.group),h+f,0,d,o),r+=u}}function Or(e,t,n,o,i,r){if(i===0)return;const l=[];let s=0;for(let u=0;u<i;u++)l.push(s),s+=o[u]??0;const a=[];let c=0;for(const u of e)a.push(c),c+=u.width;for(let u=0;u<i;u++){const b=l[u],h=o[u]??0;let f=0,d=0;for(;d<e.length;){const g=e[d],v=Jn(g.group,u,i);if(v===void 0){g.sticky&&(f+=g.width),d++;continue}const p=a[d];let y=d+1,x=g.width;for(g.sticky&&(f+=g.width);y<e.length;){const H=e[y],k=Qn(H.group,g.group,u,i),R=H.sticky===g.sticky;if(!k||!R)break;x+=H.width,H.sticky&&(f+=H.width),y++}const C=g.sticky?0:n,B=p+C,P=g.sticky?0:Math.max(0,f-B),F=Math.min(x-P,t-(B+P));F>0&&r([g.sourceIndex,e[y-1].sourceIndex],v,B+P,b,F,h,u),d=y}}}function bi(e,t,n,o,i,r,l){var h;const[s,a]=e;let c,u;const b=((h=l.find(f=>!f.sticky))==null?void 0:h.sourceIndex)??0;if(a>b){const f=Math.max(s,b);let d=t,g=o;for(let v=r.sourceIndex-1;v>=f;v--)d-=l[v].width,g+=l[v].width;for(let v=r.sourceIndex+1;v<=a;v++)g+=l[v].width;u={x:d,y:n,width:g,height:i}}if(b>s){const f=Math.min(a,b-1);let d=t,g=o;for(let v=r.sourceIndex-1;v>=s;v--)d-=l[v].width,g+=l[v].width;for(let v=r.sourceIndex+1;v<=f;v++)g+=l[v].width;c={x:d,y:n,width:g,height:i}}return[c,u]}function zr(e){return{"--gdg-accent-color":e.accentColor,"--gdg-accent-fg":e.accentFg,"--gdg-accent-light":e.accentLight,"--gdg-text-dark":e.textDark,"--gdg-text-medium":e.textMedium,"--gdg-text-light":e.textLight,"--gdg-text-bubble":e.textBubble,"--gdg-bg-icon-header":e.bgIconHeader,"--gdg-fg-icon-header":e.fgIconHeader,"--gdg-text-header":e.textHeader,"--gdg-text-group-header":e.textGroupHeader??e.textHeader,"--gdg-bg-group-header":e.bgGroupHeader??e.bgHeader,"--gdg-bg-group-header-hovered":e.bgGroupHeaderHovered??e.bgHeaderHovered,"--gdg-text-header-selected":e.textHeaderSelected,"--gdg-bg-cell":e.bgCell,"--gdg-bg-cell-medium":e.bgCellMedium,"--gdg-bg-header":e.bgHeader,"--gdg-bg-header-has-focus":e.bgHeaderHasFocus,"--gdg-bg-header-hovered":e.bgHeaderHovered,"--gdg-bg-bubble":e.bgBubble,"--gdg-bg-bubble-selected":e.bgBubbleSelected,"--gdg-bubble-height":`${e.bubbleHeight}px`,"--gdg-bubble-padding":`${e.bubblePadding}px`,"--gdg-bubble-margin":`${e.bubbleMargin}px`,"--gdg-bg-search-result":e.bgSearchResult,"--gdg-border-color":e.borderColor,"--gdg-horizontal-border-color":e.horizontalBorderColor??e.borderColor,"--gdg-drilldown-border":e.drilldownBorder,"--gdg-link-color":e.linkColor,"--gdg-cell-horizontal-padding":`${e.cellHorizontalPadding}px`,"--gdg-cell-vertical-padding":`${e.cellVerticalPadding}px`,"--gdg-header-font-style":e.headerFontStyle,"--gdg-base-font-style":e.baseFontStyle,"--gdg-marker-font-style":e.markerFontStyle,"--gdg-font-family":e.fontFamily,"--gdg-editor-font-size":e.editorFontSize,"--gdg-checkbox-max-size":`${e.checkboxMaxSize}px`,...e.resizeIndicatorColor===void 0?{}:{"--gdg-resize-indicator-color":e.resizeIndicatorColor},...e.headerBottomBorderColor===void 0?{}:{"--gdg-header-bottom-border-color":e.headerBottomBorderColor},...e.roundingRadius===void 0?{}:{"--gdg-rounding-radius":`${e.roundingRadius}px`}}}const vi={accentColor:"#4F5DFF",accentFg:"#FFFFFF",accentLight:"rgba(62, 116, 253, 0.1)",textDark:"#313139",textMedium:"#737383",textLight:"#B2B2C0",textBubble:"#313139",bgIconHeader:"#737383",fgIconHeader:"#FFFFFF",textHeader:"#313139",textGroupHeader:"#313139BB",textHeaderSelected:"#FFFFFF",bgCell:"#FFFFFF",bgCellMedium:"#FAFAFB",bgHeader:"#F7F7F8",bgHeaderHasFocus:"#E9E9EB",bgHeaderHovered:"#EFEFF1",bgBubble:"#EDEDF3",bgBubbleSelected:"#FFFFFF",bubbleHeight:20,bubblePadding:6,bubbleMargin:4,bgSearchResult:"#fff9e3",borderColor:"rgba(115, 116, 131, 0.16)",drilldownBorder:"rgba(0, 0, 0, 0)",linkColor:"#353fb5",cellHorizontalPadding:8,cellVerticalPadding:3,headerIconSize:18,headerFontStyle:"600 13px",baseFontStyle:"13px",markerFontStyle:"9px",fontFamily:"Inter, Roboto, -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, noto, arial, sans-serif",editorFontSize:"13px",lineHeight:1.4,checkboxMaxSize:18};function Nl(){return vi}const yi=dn.createContext(vi);function Xl(){return dn.useContext(yi)}function Lt(e,...t){const n={...e};for(const o of t)if(o!==void 0)for(const i in o)o.hasOwnProperty(i)&&(i==="bgCell"?n[i]=et(o[i],n[i]):n[i]=o[i]);return(n.headerFontFull===void 0||e.fontFamily!==n.fontFamily||e.headerFontStyle!==n.headerFontStyle)&&(n.headerFontFull=`${n.headerFontStyle} ${n.fontFamily}`),(n.baseFontFull===void 0||e.fontFamily!==n.fontFamily||e.baseFontStyle!==n.baseFontStyle)&&(n.baseFontFull=`${n.baseFontStyle} ${n.fontFamily}`),(n.markerFontFull===void 0||e.fontFamily!==n.fontFamily||e.markerFontStyle!==n.markerFontStyle)&&(n.markerFontFull=`${n.markerFontStyle} ${n.fontFamily}`),n}function Yl(e,t,n,o){if(o==="any")return Lr(e,{x:t,y:n,width:1,height:1});if(o==="vertical"&&(t=e.x),o==="horizontal"&&(n=e.y),wr([t,n],e))return;const i=t-e.x,r=e.x+e.width-t,l=n-e.y+1,s=e.y+e.height-n,a=Math.min(o==="vertical"?Number.MAX_SAFE_INTEGER:i,o==="vertical"?Number.MAX_SAFE_INTEGER:r,o==="horizontal"?Number.MAX_SAFE_INTEGER:l,o==="horizontal"?Number.MAX_SAFE_INTEGER:s);return a===s?{x:e.x,y:e.y+e.height,width:e.width,height:n-e.y-e.height+1}:a===l?{x:e.x,y:n,width:e.width,height:e.y-n}:a===r?{x:e.x+e.width,y:e.y,width:t-e.x-e.width+1,height:e.height}:{x:t,y:e.y,width:e.x-t,height:e.height}}function un(e,t,n,o,i,r,l,s){return e<=i+l&&i<=e+n&&t<=r+s&&r<=t+o}function Ot(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Lr(e,t){const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y),i=Math.max(e.x+e.width,t.x+t.width)-n,r=Math.max(e.y+e.height,t.y+t.height)-o;return{x:n,y:o,width:i,height:r}}function Nr(e,t){return e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height}function Xr(e,t,n,o){if(e.x>t||e.y>n||e.x<0&&e.y<0&&e.x+e.width>t&&e.y+e.height>n)return;if(e.x>=0&&e.y>=0&&e.x+e.width<=t&&e.y+e.height<=n)return e;const i=-4,r=-4,l=t+4,s=n+4,a=i-e.x,c=e.x+e.width-l,u=r-e.y,b=e.y+e.height-s,h=a>0?e.x+Math.floor(a/o)*o:e.x,f=c>0?e.x+e.width-Math.floor(c/o)*o:e.x+e.width,d=u>0?e.y+Math.floor(u/o)*o:e.y,g=b>0?e.y+e.height-Math.floor(b/o)*o:e.y+e.height;return{x:h,y:d,width:f-h,height:g-d}}function Yr(e,t,n,o,i){const[r,l,s,a]=t,[c,u,b,h]=i,{x:f,y:d,width:g,height:v}=e,p=[];if(g<=0||v<=0)return p;const y=f+g,x=d+v,C=f<r,B=d<l,P=f+g>s,F=d+v>a,H=f>=r&&f<s||y>r&&y<=s||f<r&&y>s,k=d>=l&&d<a||x>l&&x<=a||d<l&&x>a;if(H&&k){const I=Math.max(f,r),S=Math.max(d,l),M=Math.min(y,s),E=Math.min(x,a);p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:c,y:u,width:b-c+1,height:h-u+1}})}if(C&&B){const I=f,S=d,M=Math.min(y,r),E=Math.min(x,l);p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:0,y:0,width:c+1,height:u+1}})}if(B&&H){const I=Math.max(f,r),S=d,M=Math.min(y,s),E=Math.min(x,l);p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:c,y:0,width:b-c+1,height:u+1}})}if(B&&P){const I=Math.max(f,s),S=d,M=y,E=Math.min(x,l);p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:b,y:0,width:n-b+1,height:u+1}})}if(C&&k){const I=f,S=Math.max(d,l),M=Math.min(y,r),E=Math.min(x,a);p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:0,y:u,width:c+1,height:h-u+1}})}if(P&&k){const I=Math.max(f,s),S=Math.max(d,l),M=y,E=Math.min(x,a);p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:b,y:u,width:n-b+1,height:h-u+1}})}if(C&&F){const I=f,S=Math.max(d,a),M=Math.min(y,r),E=x;p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:0,y:h,width:c+1,height:o-h+1}})}if(F&&H){const I=Math.max(f,r),S=Math.max(d,a),M=Math.min(y,s),E=x;p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:c,y:h,width:b-c+1,height:o-h+1}})}if(P&&F){const I=Math.max(f,s),S=Math.max(d,a),M=y,E=x;p.push({rect:{x:I,y:S,width:M-I,height:E-S},clip:{x:b,y:h,width:n-b+1,height:o-h+1}})}return p}const $r={kind:me.Loading,allowOverlay:!1};function No(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g,v,p,y,x,C,B,P,F,H,k,R,I,S,M,E,W,O,ne,Z){let G=(x==null?void 0:x.size)??Number.MAX_SAFE_INTEGER;const K=performance.now();let ce=M.baseFontFull;e.font=ce;const ye={ctx:e},de=[0,0],Te=v>0?Kt(a,v,c):0;let V,be;const pe=new Ut,z=new Set,le=mi(y);if(Mt(t,s,r,l,i,(j,ae,Be,q,se)=>{const Ye=Math.max(0,q-ae),Ve=ae+Ye,ve=i+1,pt=j.width-Ye,gt=o-i-1;if(y.length>0){let re=!1;for(let we=0;we<y.length;we++){const Se=y[we];if(un(Ve,ve,pt,gt,Se.x,Se.y,Se.width,Se.height)){re=!0;break}}if(!re)return}const Ue=()=>{e.save(),e.beginPath(),e.rect(Ve,ve,pt,gt),e.clip()},ue=C.columns.hasIndex(j.sourceIndex),Ge=b(zt(j.group)).overrideTheme,We=j.themeOverride===void 0&&Ge===void 0?M:Lt(M,Ge,j.themeOverride),_e=We.baseFontFull;_e!==ce&&(ce=_e,e.font=_e),Ue();let Fe;return An(se,Be,o,a,c,v,p,le,(re,we,Se,nt,D)=>{var rt,mt,Pt;if(we<0)return;if(de[0]=j.sourceIndex,de[1]=we,pe.has(de)){G--;return}if(x!==void 0&&!x.has(de))return;if(y.length>0){let U=!1;for(let fe=0;fe<y.length;fe++){const he=y[fe];if(un(ae,re,j.width,Se,he.x,he.y,he.width,he.height)){U=!0;break}}if(!U)return}const Ae=C.rows.hasIndex(we),Ee=f.hasIndex(we),N=we<a?u(de):$r;let De=ae,He=j.width,ie=re,oe=Se,Oe=!1,ot=!1;if(N.rowspan!==void 0){const[U,fe]=N.rowspan,he=`${j.sourceIndex}|${U}`;if(z.has(he)){G--;return}else{let Qe=re;for(let Q=U;Q<we;Q++)Qe-=c(Q);let Ze=0;for(let Q=U;Q<fe;Q++)Ze+=c(Q);if(Qe<ve+gt&&Qe+Ze>ve){ie=Qe,oe=Ze,z.add(he);for(let Q=U;Q<fe;Q++)Q!==we&&pe.add([j.sourceIndex,Q]);Oe=!0}else{z.add(he);for(let Q=U;Q<fe;Q++)pe.add([j.sourceIndex,Q]);G--;return}}}if(N.span!==void 0){const[U,fe]=N.span,he=`${we},${U},${fe},${j.sticky}`;if(be===void 0&&(be=new Set),be.has(he)){G--;return}else{const Qe=bi(N.span,ae,re,j.width,Se,j,n),Ze=j.sticky?Qe[0]:Qe[1];!j.sticky&&Qe[0]!==void 0&&(ot=!0),Ze!==void 0&&(De=Ze.x,He=Ze.width,be.add(he),Oe=!0)}}if(Oe){e.restore(),Fe=void 0,e.save(),e.beginPath();const U=Math.max(0,q-De);e.rect(De+U,ie,He-U,oe),V===void 0&&(V=[]),V.push({x:De+U,y:ie,width:He-U,height:oe}),e.clip()}const je=h==null?void 0:h(we),at=D&&((rt=j.trailingRowOptions)==null?void 0:rt.themeOverride)!==void 0?(mt=j.trailingRowOptions)==null?void 0:mt.themeOverride:void 0,$e=N.themeOverride===void 0&&je===void 0&&at===void 0?We:Lt(We,je,at,N.themeOverride);e.beginPath();const ct=pr(de,N,C);let Ke=kr(de,N,C,g);const It=N.span!==void 0&&C.columns.some(U=>N.span!==void 0&&U>=N.span[0]&&U<=N.span[1]);ct&&!d&&g?Ke=0:ct&&g&&(Ke=Math.max(Ke,1)),It&&Ke++,ct||(Ae&&Ke++,ue&&!D&&Ke++);const Ft=N.kind===me.Protected?$e.bgCellMedium:$e.bgCell;let Pe;if((nt||Ft!==M.bgCell)&&(Pe=et(Ft,Pe)),Ke>0||Ee){Ee&&(Pe=et($e.bgHeader,Pe));for(let U=0;U<Ke;U++)Pe=et($e.accentLight,Pe)}else if(B!==void 0){for(const U of B)if(U[0]===j.sourceIndex&&U[1]===we){Pe=et($e.bgSearchResult,Pe);break}}if(P!==void 0)for(let U=0;U<P.length;U++){const fe=P[U],he=fe.range;fe.style!=="solid-outline"&&he.x<=j.sourceIndex&&j.sourceIndex<he.x+he.width&&he.y<=we&&we<he.y+he.height&&(Pe=et(fe.color,Pe))}let Ht=!1;if(x!==void 0){const U=re+1,he=(nt?U+Se-1:Math.min(U+Se-1,o-Te))-U;(he!==Se-1||De+1<=q)&&(Ht=!0,e.save(),e.beginPath(),e.rect(De+1,U,He-1,he),e.clip()),Pe=Pe===void 0?$e.bgCell:et(Pe,$e.bgCell)}const ke=j.sourceIndex===n.length-1,Je=we===a-1;Pe!==void 0&&(e.fillStyle=Pe,Fe!==void 0&&(Fe.fillStyle=Pe),x!==void 0?e.fillRect(De+1,ie+1,He-(ke?2:1),oe-(Je?2:1)):e.fillRect(De,ie,He,oe)),N.style==="faded"&&(e.globalAlpha=.6);let it;for(let U=0;U<k.length;U++){const fe=k[U];if(fe.item[0]===j.sourceIndex&&fe.item[1]===we){it=fe;break}}if(He>Z&&!ot){const U=$e.baseFontFull;U!==ce&&(e.font=U,ce=U);let fe=0;if(N.rowspan!==void 0){const he=N.rowSpanPosition??"top";if(he==="top")fe=Se/2-oe/2;else if(he==="bottom"){const[Qe,Ze]=N.rowspan,Q=c(Ze-1);fe=oe/2-Q/2}}Fe=pi(e,N,j.sourceIndex,we,ke,Je,De,ie,He,oe,Ke>0,$e,Pe??$e.bgCell,F,H,(it==null?void 0:it.hoverAmount)??0,R,S,K,I,Fe,E,W,O,ne,fe)}return Ht&&e.restore(),N.style==="faded"&&(e.globalAlpha=1),G--,Oe&&(e.restore(),(Pt=Fe==null?void 0:Fe.deprep)==null||Pt.call(Fe,ye),Fe=void 0,Ue(),ce=_e,e.font=_e),G<=0}),e.restore(),G<=0}),V!==void 0)return V}const on=[0,0],rn={x:0,y:0,width:0,height:0},$n=[void 0,()=>{}];let no=!1;function _r(){no=!0}function pi(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g,v,p,y,x,C,B,P,F,H,k){var O,ne;let R,I;v!==void 0&&v[0][0]===n&&v[0][1]===o&&(R=v[1][0],I=v[1][1]);let S;on[0]=n,on[1]=o,rn.x=l,rn.y=s,rn.width=a,rn.height=c,$n[0]=P.getValue(on),$n[1]=Z=>P.setValue(on,Z),no=!1;const M={ctx:e,theme:b,col:n,row:o,cell:t,rect:rn,highlighted:u,cellFillColor:h,hoverAmount:g,frameTime:y,hoverX:R,drawState:$n,hoverY:I,imageLoader:f,spriteManager:d,hyperWrapping:p,overrideCursor:R!==void 0?H:void 0,requestAnimationFrame:_r},E=Ir(M,t.lastUpdated,y,C,i,r),W=F(t);if(W!==void 0){(C==null?void 0:C.renderer)!==W&&((O=C==null?void 0:C.deprep)==null||O.call(C,M),C=void 0);const Z=(ne=W.drawPrep)==null?void 0:ne.call(W,M,C);e.save(),e.translate(0,k),x!==void 0&&!ro(M.cell)?x(M,()=>W.draw(M,t)):W.draw(M,t),e.restore(),S=Z===void 0?void 0:{deprep:Z==null?void 0:Z.deprep,fillStyle:Z==null?void 0:Z.fillStyle,font:Z==null?void 0:Z.font,renderer:W}}return(E||no)&&(B==null||B(on)),S}function Pn(e,t,n,o,i,r,l,s,a=-20,c=-20,u=void 0,b="center",h="square",f=!1){const d=Math.floor(i+l/2),g=h==="circle"?1e4:t.roundingRadius??4;let v=ii(u??t.checkboxMaxSize,l,t.cellVerticalPadding),p=v/2;const y=oi(b,o,r,t.cellHorizontalPadding,v),x=ni(y,d,v),C=ri(o+a,i+c,x);switch(n){case!0:{e.beginPath(),ft(e,y-v/2,d-v/2,v,v,g),h==="circle"&&(p*=.8,v*=.8),e.fillStyle=f?t.bgCellMedium:s?t.accentColor:t.textMedium,e.fill(),e.beginPath(),e.moveTo(y-p+v/4.23,d-p+v/1.97),e.lineTo(y-p+v/2.42,d-p+v/1.44),e.lineTo(y-p+v/1.29,d-p+v/3.25),e.strokeStyle=f?t.textLight:t.bgCell,e.lineJoin="round",e.lineCap="round",e.lineWidth=1.9,e.stroke();break}case Fn:case!1:{e.beginPath(),ft(e,y-v/2+.5,d-v/2+.5,v-1,v-1,g),e.lineWidth=1,e.strokeStyle=f?t.textLight:C?t.textDark:t.textMedium,e.stroke();break}case io:{e.beginPath(),ft(e,y-v/2,d-v/2,v,v,g),e.fillStyle=f?t.bgCellMedium:C?t.textMedium:t.textLight,e.fill(),h==="circle"&&(p*=.8,v*=.8),e.beginPath(),e.moveTo(y-v/3,d),e.lineTo(y+v/3,d),e.strokeStyle=f?t.textLight:t.bgCell,e.lineCap="round",e.lineWidth=1.9,e.stroke();break}default:oo()}}function Vr(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g,v,p,y,x,C,B){var W,O,ne,Z;const P=C??(o?1:0),F=B??(o?[a]:[]),H=F.reduce((G,K)=>G+K,0),k=s+H;if(k<=0)return;e.fillStyle=h.bgHeader,p!==void 0&&o&&(C??1)>1?e.fillRect(0,H,r,s):e.fillRect(0,0,r,k);const R=(W=i==null?void 0:i[0])==null?void 0:W[0],I=(O=i==null?void 0:i[0])==null?void 0:O[1],S=(ne=i==null?void 0:i[1])==null?void 0:ne[0],M=(Z=i==null?void 0:i[1])==null?void 0:Z[1],E=h.headerFontFull;e.font=E,Mt(t,0,l,0,k,(G,K,ce,ye)=>{var se;if(p!==void 0&&!p.has([G.sourceIndex,-1]))return;const de=Math.max(0,ye-K);e.save(),e.beginPath(),e.rect(K+de,H,G.width-de,s),e.clip();const Te=v(zt(G.group)).overrideTheme,V=G.themeOverride===void 0&&Te===void 0?h:Lt(h,Te,G.themeOverride);V.bgHeader!==h.bgHeader&&(e.fillStyle=V.bgHeader,e.fill()),V!==h&&(e.font=V.headerFontFull);const be=b.columns.hasIndex(G.sourceIndex),pe=c!==void 0||u||G.headerRowMarkerDisabled===!0,z=!pe&&I===-1&&R===G.sourceIndex,le=pe?0:((se=d.find(Ye=>Ye.item[0]===G.sourceIndex&&Ye.item[1]===-1))==null?void 0:se.hoverAmount)??0,j=(b==null?void 0:b.current)!==void 0&&b.current.cell[0]===G.sourceIndex,ae=be?V.accentColor:j?V.bgHeaderHasFocus:V.bgHeader,Be=o?H:0,q=G.sourceIndex===0?0:1;be?(e.fillStyle=ae,e.fillRect(K+q,Be,G.width-q,s)):(j||le>0)&&(e.beginPath(),e.rect(K+q,Be,G.width-q,s),j&&(e.fillStyle=V.bgHeaderHasFocus,e.fill()),le>0&&(e.globalAlpha=le,e.fillStyle=V.bgHeaderHovered,e.fill(),e.globalAlpha=1)),ki(e,K,Be,G.width,s,G,be,V,z,z?S:void 0,z?M:void 0,j,le,f,y,x),e.restore()}),o&&(P>1?Ur(e,t,r,l,F,P,i,h,f,d,g,v,p):qr(e,t,r,l,a,i,h,f,d,g,v,p)),o&&(C??1)>1&&(e.beginPath(),e.moveTo(0,H+.5),e.lineTo(r,H+.5),e.strokeStyle=h.borderColor,e.lineWidth=1,e.stroke())}function qr(e,t,n,o,i,r,l,s,a,c,u,b){const[f,d]=(r==null?void 0:r[0])??[];let g=0;Wr(t,n,o,i,(v,p,y,x,C,B)=>{if(b!==void 0&&!b.hasItemInRectangle({x:v[0],y:-2,width:v[1]-v[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(y,x,C,B),e.clip();const P=u(p),F=(P==null?void 0:P.overrideTheme)===void 0?l:Lt(l,P.overrideTheme),H=d===-2&&f!==void 0&&f>=v[0]&&f<=v[1],k=H?F.bgGroupHeaderHovered??F.bgHeaderHovered:F.bgGroupHeader??F.bgHeader;if(k!==l.bgHeader&&(e.fillStyle=k,e.fill()),e.fillStyle=F.textGroupHeader??F.textHeader,P!==void 0){let R=y;if(P.icon!==void 0&&(s.drawSprite(P.icon,"normal",e,R+8,(i-20)/2,20,F),R+=26),e.fillText(P.name,R+8,i/2+tt(e,l.headerFontFull)),P.actions!==void 0&&H){const I=ho({x:y,y:x,width:C,height:B},P.actions);e.beginPath();const S=I[0].x-10,M=y+C-S;e.rect(S,0,M,i);const E=e.createLinearGradient(S,0,S+M,0),W=Jt(k,0);E.addColorStop(0,W),E.addColorStop(10/M,k),E.addColorStop(1,k),e.fillStyle=E,e.fill(),e.globalAlpha=.6;const[O,ne]=(r==null?void 0:r[1])??[-1,-1];for(let Z=0;Z<P.actions.length;Z++){const G=P.actions[Z],K=I[Z],ce=Ot(K,O+y,ne);ce&&(e.globalAlpha=1),s.drawSprite(G.icon,"normal",e,K.x+K.width/2-10,K.y+K.height/2-10,20,F),ce&&(e.globalAlpha=.6)}e.globalAlpha=1}}y!==0&&c(v[0])&&(e.beginPath(),e.moveTo(y+.5,0),e.lineTo(y+.5,i),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()),e.restore(),g=y+C}),e.beginPath(),e.moveTo(g+.5,0),e.lineTo(g+.5,i),e.moveTo(0,i+.5),e.lineTo(n,i+.5),e.strokeStyle=l.borderColor,e.lineWidth=1,e.stroke()}function Ur(e,t,n,o,i,r,l,s,a,c,u,b,h){const[f,d]=(l==null?void 0:l[0])??[];e.font=s.headerFontFull;const g=i.reduce((p,y)=>p+y,0);h===void 0&&(e.fillStyle=s.bgHeader,e.fillRect(0,0,n,g));let v=0;if(Or(t,n,o,i,r,(p,y,x,C,B,P,F)=>{const H=-(F+2);if(h!==void 0&&!h.hasItemInRectangle({x:p[0],y:H,width:p[1]-p[0]+1,height:1}))return;e.save(),e.beginPath(),e.rect(x,C,B,P),e.clip();const k=b(y),R=(k==null?void 0:k.overrideTheme)===void 0?s:Lt(s,k.overrideTheme),I=d===H&&f!==void 0&&f>=p[0]&&f<=p[1],S=I?R.bgGroupHeaderHovered??R.bgHeaderHovered:R.bgGroupHeader??R.bgHeader;e.fillStyle=S,e.fillRect(x,C,B,P),e.fillStyle=R.textGroupHeader??R.textHeader;const M=(k==null?void 0:k.name)??y,W=e.measureText(M).width,O=(k==null?void 0:k.icon)!==void 0?26:0,ne=O+W,Z=x+(B-ne)/2;if((k==null?void 0:k.icon)!==void 0&&a.drawSprite(k.icon,"normal",e,Z,C+(P-20)/2,20,R),e.fillText(M,Z+O,C+P/2+tt(e,s.headerFontFull)),k!==void 0&&k.actions!==void 0&&I){const G=ho({x,y:C,width:B,height:P},k.actions);e.beginPath();const K=G[0].x-10,ce=x+B-K;e.rect(K,C,ce,P);const ye=e.createLinearGradient(K,0,K+ce,0),de=Jt(S,0);ye.addColorStop(0,de),ye.addColorStop(10/ce,S),ye.addColorStop(1,S),e.fillStyle=ye,e.fill(),e.globalAlpha=.6;const[Te,V]=(l==null?void 0:l[1])??[-1,-1];for(let be=0;be<k.actions.length;be++){const pe=k.actions[be],z=G[be],le=Ot(z,Te+x,V);le&&(e.globalAlpha=1),a.drawSprite(pe.icon,"normal",e,z.x+z.width/2-10,z.y+z.height/2-10,20,R),le&&(e.globalAlpha=.6)}e.globalAlpha=1}e.strokeStyle=s.borderColor,e.lineWidth=1,x!==0&&u(p[0])&&(e.beginPath(),e.moveTo(x+.5,C),e.lineTo(x+.5,C+P),e.stroke()),(F<r-1||h===void 0)&&(e.beginPath(),e.moveTo(x,C+P+.5),e.lineTo(x+B,C+P+.5),e.stroke()),e.restore(),v=Math.max(v,x+B)}),h===void 0){e.beginPath(),e.moveTo(v+.5,0),e.lineTo(v+.5,g);let p=0;for(let y=0;y<r-1;y++)p+=i[y],e.moveTo(0,p+.5),e.lineTo(n,p+.5);e.strokeStyle=s.borderColor,e.lineWidth=1,e.stroke()}}const Sn=30;function Gr(e,t,n,o,i){return{x:e+n-Sn,y:Math.max(t,t+o/2-Sn/2),width:Sn,height:Math.min(Sn,o)}}function ho(e,t){const n=[];let o=e.x+e.width-26*t.length;const i=e.y+e.height/2-13,r=26,l=26;for(let s=0;s<t.length;s++)n.push({x:o,y:i,width:l,height:r}),o+=26;return n}function sn(e,t,n){return!n||e===void 0||(e.x=t-(e.x-t)-e.width),e}function wi(e,t,n,o,i,r,l,s){var F;const a=l.cellHorizontalPadding,c=l.headerIconSize,u=Gr(n,o,i,r);let b=n+a;const h=t.icon===void 0?void 0:{x:b,y:o+(r-c)/2,width:c,height:c},f=h===void 0||t.overlayIcon===void 0?void 0:{x:h.x+9,y:h.y+6,width:18,height:18};h!==void 0&&(b+=Math.ceil(c*1.3));const d=e===void 0?((F=di(t.title,l.headerFontFull))==null?void 0:F.width)??0:Nt(t.title,e,l.headerFontFull).width,g=t.hasMenu===!0?35:0,v=t.indicatorIcon!==void 0?c+a:0,p=d+v,y=i-(h!==void 0?Math.ceil(c*1.3)+a:a)-g-a,x=n+(h!==void 0?Math.ceil(c*1.3)+a:a)+(y-p)/2,C={x:Math.max(b,x),y:o,width:d,height:r};let B;t.indicatorIcon!==void 0&&(B={x:C.x+d+a,y:o+(r-c)/2,width:c,height:c});const P=n+i/2;return{menuBounds:sn(u,P,s),iconBounds:sn(h,P,s),iconOverlayBounds:sn(f,P,s),textBounds:sn(C,P,s),indicatorIconBounds:sn(B,P,s)}}function Xo(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g){if(r.rowMarker!==void 0&&r.headerRowMarkerDisabled!==!0){const y=r.rowMarkerChecked;y!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=b);const x=r.headerRowMarkerTheme!==void 0?Lt(s,r.headerRowMarkerTheme):s;Pn(e,x,y,t,n,o,i,!1,void 0,void 0,s.checkboxMaxSize,"center",r.rowMarker),y!==!0&&r.headerRowMarkerAlwaysVisible!==!0&&(e.globalAlpha=1);return}const v=l?s.textHeaderSelected:s.textHeader,p=r.hasMenu===!0&&(a||f&&l)&&g.menuBounds!==void 0;if(r.icon!==void 0&&g.iconBounds!==void 0){let y=l?"selected":"normal";r.style==="highlight"&&(y=l?"selected":"special"),h.drawSprite(r.icon,y,e,g.iconBounds.x,g.iconBounds.y,g.iconBounds.width,s),r.overlayIcon!==void 0&&g.iconOverlayBounds!==void 0&&h.drawSprite(r.overlayIcon,l?"selected":"special",e,g.iconOverlayBounds.x,g.iconOverlayBounds.y,g.iconOverlayBounds.width,s)}if(p&&o>35){const x=d?35:o-35,C=d?35*.7:o-35*.7,B=x/o,P=C/o,F=e.createLinearGradient(t,0,t+o,0),H=Jt(v,0);F.addColorStop(d?1:0,v),F.addColorStop(B,v),F.addColorStop(P,H),F.addColorStop(d?0:1,H),e.fillStyle=F}else e.fillStyle=v;if(d&&(e.textAlign="right"),g.textBounds!==void 0&&e.fillText(r.title,d?g.textBounds.x+g.textBounds.width:g.textBounds.x,n+i/2+tt(e,s.headerFontFull)),d&&(e.textAlign="left"),r.indicatorIcon!==void 0&&g.indicatorIconBounds!==void 0&&(!p||!un(g.menuBounds.x,g.menuBounds.y,g.menuBounds.width,g.menuBounds.height,g.indicatorIconBounds.x,g.indicatorIconBounds.y,g.indicatorIconBounds.width,g.indicatorIconBounds.height))){let y=l?"selected":"normal";r.style==="highlight"&&(y=l?"selected":"special"),h.drawSprite(r.indicatorIcon,y,e,g.indicatorIconBounds.x,g.indicatorIconBounds.y,g.indicatorIconBounds.width,s)}if(p&&g.menuBounds!==void 0){const y=g.menuBounds,x=c!==void 0&&u!==void 0&&Ot(y,c+t,u+n);if(x||(e.globalAlpha=.7),r.menuIcon===void 0||r.menuIcon===jn.Triangle){e.beginPath();const C=y.x+y.width/2-5.5,B=y.y+y.height/2-3;Br(e,[{x:C,y:B},{x:C+11,y:B},{x:C+5.5,y:B+6}],1),e.fillStyle=v,e.fill()}else if(r.menuIcon===jn.Dots){e.beginPath();const C=y.x+y.width/2,B=y.y+y.height/2;Pr(e,C,B),e.fillStyle=v,e.fill()}else{const C=y.x+(y.width-s.headerIconSize)/2,B=y.y+(y.height-s.headerIconSize)/2;h.drawSprite(r.menuIcon,"normal",e,C,B,s.headerIconSize,s)}x||(e.globalAlpha=1)}}function ki(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g){const v=ao(r.title)==="rtl",p=wi(e,r,t,n,o,i,s,v);d!==void 0?d({ctx:e,theme:s,rect:{x:t,y:n,width:o,height:i},column:r,columnIndex:r.sourceIndex,isSelected:l,hoverAmount:h,isHovered:a,hasSelectedCell:b,spriteManager:f,menuBounds:(p==null?void 0:p.menuBounds)??{x:0,y:0,height:0,width:0},hoverX:c,hoverY:u},()=>Xo(e,t,n,o,i,r,l,s,a,c,u,h,f,g,v,p)):Xo(e,t,n,o,i,r,l,s,a,c,u,h,f,g,v,p)}function jr(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g,v,p,y){if(p!==void 0||t[t.length-1]!==n[t.length-1])return;const x=mi(v);Mt(t,a,l,s,r,(C,B,P,F,H)=>{if(C!==t[t.length-1])return;B+=C.width;const k=Math.max(B,F);k>o||(e.save(),e.beginPath(),e.rect(k,r+1,1e4,i-r-1),e.clip(),An(H,P,i,c,u,d,g,x,(R,I,S,M)=>{if(!M&&v.length>0&&!v.some(Z=>un(B,R,1e4,S,Z.x,Z.y,Z.width,Z.height)))return;const E=h.hasIndex(I),W=f.hasIndex(I);e.beginPath();const O=b==null?void 0:b(I),ne=O===void 0?y:Lt(y,O);ne.bgCell!==y.bgCell&&(e.fillStyle=ne.bgCell,e.fillRect(B,R,1e4,S)),W&&(e.fillStyle=ne.bgHeader,e.fillRect(B,R,1e4,S)),E&&(e.fillStyle=ne.accentLight,e.fillRect(B,R,1e4,S))}),e.restore())})}function Kr(e,t,n,o,i,r,l,s,a){let c=!1;for(const d of t)if(!d.sticky){c=l(d.sourceIndex);break}const u=a.horizontalBorderColor??a.borderColor,b=a.borderColor,h=c?jt(t):0;let f;if(h!==0&&(f=Lo(b,a.bgCell),e.beginPath(),e.moveTo(h+.5,0),e.lineTo(h+.5,o),e.strokeStyle=f,e.stroke()),i>0){const d=b===u&&f!==void 0?f:Lo(u,a.bgCell),g=Kt(r,i,s);e.beginPath(),e.moveTo(0,o-g+.5),e.lineTo(n,o-g+.5),e.strokeStyle=d,e.stroke()}}const xi=(e,t,n)=>{let o=0,i=t,r=0,l=n;if(e!==void 0&&e.length>0){o=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(const s of e)o=Math.min(o,s.x-1),i=Math.max(i,s.x+s.width+1),r=Math.min(r,s.y-1),l=Math.max(l,s.y+s.height+1)}return{minX:o,maxX:i,minY:r,maxY:l}};function Jr(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d){var S;const g=d.bgCell,{minX:v,maxX:p,minY:y,maxY:x}=xi(s,r,l),C=[],B=l-Kt(f,h,c);let P=a,F=n,H=0;for(;P+i<B;){const M=P+i,E=c(F);if(M>=y&&M<=x-1){const W=u==null?void 0:u(F),O=W==null?void 0:W.bgCell;O!==void 0&&O!==g&&F>=f-h&&C.push({x:v,y:M,w:p-v,h:E,color:O})}P+=E,F<f-h&&(H=P),F++}let k=0;const R=Math.min(B,x)-H;if(R>0)for(let M=0;M<t.length;M++){const E=t[M];if(E.width===0)continue;const W=E.sticky?k:k+o,O=(S=E.themeOverride)==null?void 0:S.bgCell;O!==void 0&&O!==g&&W>=v&&W<=p&&b(M+1)&&C.push({x:W,y:H,w:E.width,h:R,color:O}),k+=E.width}if(C.length===0)return;let I;e.beginPath();for(let M=C.length-1;M>=0;M--){const E=C[M];I===void 0?I=E.color:E.color!==I&&(e.fillStyle=I,e.fill(),e.beginPath(),I=E.color),e.rect(E.x,E.y,E.w,E.h)}I!==void 0&&(e.fillStyle=I,e.fill()),e.beginPath()}function Yo(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g,v,p=!1){if(a!==void 0){e.beginPath(),e.save(),e.rect(0,0,r,l);for(const S of a)e.rect(S.x+1,S.y+1,S.width-1,S.height-1);e.clip("evenodd")}const y=v.horizontalBorderColor??v.borderColor,x=v.borderColor,{minX:C,maxX:B,minY:P,maxY:F}=xi(s,r,l),H=[];e.beginPath();let k=.5;for(let S=0;S<t.length;S++){const M=t[S];if(M.width===0)continue;k+=M.width;const E=M.sticky?k:k+o;E>=C&&E<=B&&f(S+1)&&H.push({x1:E,y1:Math.max(c,P),x2:E,y2:Math.min(l,F),color:x})}let R=l+.5;for(let S=g-d;S<g;S++){const M=b(S);R-=M,H.push({x1:C,y1:R,x2:B,y2:R,color:y})}if(p!==!0){let S=u+.5,M=n;const E=R;for(;S+i<E;){const W=S+i;if(W>=P&&W<=F-1){const O=h==null?void 0:h(M);H.push({x1:C,y1:W,x2:B,y2:W,color:(O==null?void 0:O.horizontalBorderColor)??(O==null?void 0:O.borderColor)??y})}S+=b(M),M++}}const I=tr(H,S=>S.color);for(const S of Object.keys(I)){e.strokeStyle=S;for(const M of I[S])e.moveTo(M.x1,M.y1),e.lineTo(M.x2,M.y2);e.stroke(),e.beginPath()}a!==void 0&&e.restore()}function Qr(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g,v,p,y){const x=[];e.imageSmoothingEnabled=!1;const C=Math.min(i.cellYOffset,l),B=Math.max(i.cellYOffset,l);let P=0;if(typeof p=="number")P+=(B-C)*p;else for(let E=C;E<B;E++)P+=p(E);l>i.cellYOffset&&(P=-P),P+=a-i.translateY;const F=Math.min(i.cellXOffset,r),H=Math.max(i.cellXOffset,r);let k=0;for(let E=F;E<H;E++)k+=g[E].width;r>i.cellXOffset&&(k=-k),k+=s-i.translateX;const R=jt(v);if(k!==0&&P!==0)return{regions:[]};const I=c>0?Kt(h,c,p):0,S=u-R-Math.abs(k),M=b-f-I-Math.abs(P)-1;if(S>150&&M>150){const E={sx:0,sy:0,sw:u*d,sh:b*d,dx:0,dy:0,dw:u*d,dh:b*d};if(P>0?(E.sy=(f+1)*d,E.sh=M*d,E.dy=(P+f+1)*d,E.dh=M*d,x.push({x:0,y:f,width:u,height:P+1})):P<0&&(E.sy=(-P+f+1)*d,E.sh=M*d,E.dy=(f+1)*d,E.dh=M*d,x.push({x:0,y:b+P-I,width:u,height:-P+I})),k>0?(E.sx=R*d,E.sw=S*d,E.dx=(k+R)*d,E.dw=S*d,x.push({x:R-1,y:0,width:k+2,height:b})):k<0&&(E.sx=(R-k)*d,E.sw=S*d,E.dx=R*d,E.dw=S*d,x.push({x:u+k,y:0,width:-k,height:b})),e.setTransform(1,0,0,1,0,0),y){if(R>0&&k!==0&&P===0&&(o===void 0||(n==null?void 0:n[1])!==!1)){const W=R*d,O=b*d;e.drawImage(t,0,0,W,O,0,0,W,O)}if(I>0&&k===0&&P!==0&&(o===void 0||(n==null?void 0:n[0])!==!1)){const W=(b-I)*d,O=u*d,ne=I*d;e.drawImage(t,0,W,O,ne,0,W,O,ne)}}e.drawImage(t,E.sx,E.sy,E.sw,E.sh,E.dx,E.dy,E.dw,E.dh),e.scale(d,d)}return e.imageSmoothingEnabled=!0,{regions:x}}function Zr(e,t,n,o,i,r,l,s,a,c){const u=[];return t!==e.cellXOffset||n!==e.cellYOffset||o!==e.translateX||i!==e.translateY||Mt(a,n,o,i,s,(b,h,f,d)=>{if(b.sourceIndex===c){const g=Math.max(h,d)+1;return u.push({x:g,y:0,width:r-g,height:l}),!0}}),u}function es(e,t){if(t===void 0||e.width!==t.width||e.height!==t.height||e.theme!==t.theme||e.headerHeight!==t.headerHeight||e.rowHeight!==t.rowHeight||e.rows!==t.rows||e.freezeColumns!==t.freezeColumns||e.getRowThemeOverride!==t.getRowThemeOverride||e.isFocused!==t.isFocused||e.isResizing!==t.isResizing||e.verticalBorder!==t.verticalBorder||e.getCellContent!==t.getCellContent||e.highlightRegions!==t.highlightRegions||e.selection!==t.selection||e.dragAndDropState!==t.dragAndDropState||e.prelightCells!==t.prelightCells||e.touchMode!==t.touchMode||e.maxScaleFactor!==t.maxScaleFactor)return!1;if(e.mappedColumns!==t.mappedColumns){if(e.mappedColumns.length>100||e.mappedColumns.length!==t.mappedColumns.length)return!1;let n;for(let o=0;o<e.mappedColumns.length;o++){const i=e.mappedColumns[o],r=t.mappedColumns[o];if(Gt(i,r))continue;if(n!==void 0||i.width===r.width)return!1;const{width:l,...s}=i,{width:a,...c}=r;if(!Gt(s,c))return!1;n=o}return n===void 0?!0:n}return!0}function $o(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g){const v=d==null?void 0:d.filter(F=>F.style!=="no-outline");if(v===void 0||v.length===0)return;const p=jt(s),y=Kt(f,h,b),x=[a,0,s.length,f-h],C=[p,0,t,n-y],B=v.map(F=>{const H=F.range,k=F.style??"dashed";return Yr(H,x,t,n,C).map(R=>{const I=R.rect,S=eo(I.x,I.y,t,n,u,c+u,o,i,r,l,f,a,h,s,b),M=I.width===1&&I.height===1?S:eo(I.x+I.width-1,I.y+I.height-1,t,n,u,c+u,o,i,r,l,f,a,h,s,b);return I.x+I.width>=s.length&&(M.width-=1),I.y+I.height>=f&&(M.height-=1),{color:F.color,style:k,clip:R.clip,rect:Xr({x:S.x,y:S.y,width:M.x+M.width-S.x,height:M.y+M.height-S.y},t,n,8)}})}),P=()=>{e.lineWidth=1;let F=!1;for(const H of B)for(const k of H)if((k==null?void 0:k.rect)!==void 0&&un(0,0,t,n,k.rect.x,k.rect.y,k.rect.width,k.rect.height)){const R=F,I=!Nr(k.clip,k.rect);e.beginPath(),I&&(e.save(),e.rect(k.clip.x,k.clip.y,k.clip.width,k.clip.height),e.clip()),k.style==="dashed"&&!F?(e.setLineDash([5,3]),F=!0):(k.style==="solid"||k.style==="solid-outline")&&F&&(e.setLineDash([]),F=!1),e.strokeStyle=k.style==="solid-outline"?et(et(k.color,g.borderColor),g.bgCell):Jt(k.color,1),e.closePath(),e.strokeRect(k.rect.x+.5,k.rect.y+.5,k.rect.width-1,k.rect.height-1),I&&(e.restore(),F=R)}F&&e.setLineDash([])};return P(),P}function _o(e,t,n,o,i){e.beginPath(),e.moveTo(t,n),e.lineTo(t,o),e.lineWidth=2,e.strokeStyle=i,e.stroke(),e.globalAlpha=1}function _n(e,t,n,o,i,r,l,s,a,c,u,b,h,f,d,g,v){if(u.current===void 0)return;const p=g!==!1&&g!==void 0;if(!p)return;const y=typeof g=="object"?{...Hn,...g}:Hn,x=u.current.range,C=u.current.cell,B=[x.x+x.width-1,x.y+x.height-1];if(C[1]>=v&&B[1]>=v||!l.some(O=>O.sourceIndex===C[0]||O.sourceIndex===B[0]))return;const[F,H]=u.current.cell,k=h(u.current.cell),R=k.span??[F,F],I=H>=v-f,S=f>0&&!I?Kt(v,f,b)-1:0,M=B[1];let E;if(Mt(l,o,i,r,c,(O,ne,Z,G,K)=>{if(O.sticky&&F>O.sourceIndex)return;const ce=O.sourceIndex<R[0],ye=O.sourceIndex>R[1],de=O.sourceIndex===B[0];if(!(!de&&(ce||ye)))return An(K,Z,n,v,b,f,d,void 0,(Te,V,be)=>{if(V!==H&&V!==M)return;let pe=ne,z=O.width;if(k.span!==void 0){const j=bi(k.span,ne,Te,O.width,be,O,s),ae=O.sticky?j[0]:j[1];ae!==void 0&&(pe=ae.x,z=ae.width)}return V===M&&de&&p&&(E=()=>{var se;G>pe&&!O.sticky&&(e.beginPath(),e.rect(G,0,t-G,n),e.clip());const j=y.size,ae=j/2,Be=pe+z+y.offsetX-ae+.5,q=Te+be+y.offsetY-ae+.5;e.beginPath(),y.shape==="circle"?e.arc(Be+ae,q+ae,ae,0,Math.PI*2):e.rect(Be,q,j,j),e.fillStyle=((se=O.themeOverride)==null?void 0:se.accentColor)??a.accentColor,e.fill(),y.outline>0&&(e.lineWidth=y.outline,e.strokeStyle=a.bgCell,y.shape==="circle"?(e.beginPath(),e.arc(Be+ae,q+ae,ae+y.outline/2,0,Math.PI*2),e.stroke()):e.strokeRect(Be-y.outline/2,q-y.outline/2,j+y.outline,j+y.outline))}),E!==void 0}),E!==void 0}),E===void 0)return;const W=()=>{e.save(),e.beginPath(),e.rect(0,c,t,n-c-S),e.clip(),E==null||E(),e.restore()};return W(),W}function ts(e,t,n,o,i,r,l,s,a){a===void 0||a.size===0||(e.beginPath(),Mt(t,s,r,l,i,(c,u,b,h)=>{const f=Math.max(0,h-u),d=u+f+1,g=c.width-f-1;a.has([c.sourceIndex,-1])&&e.rect(d,o,g,i-o)}),e.clip())}function ns(e,t,n,o,i,r,l,s,a,c){let u=0;return Mt(e,r,o,i,n,(b,h,f,d,g)=>(An(g,f,t,l,s,a,c,void 0,(v,p,y,x)=>{x||(u=Math.max(p,u))}),!0)),u}function Vo(e,t){var Ht;const{canvasCtx:n,headerCanvasCtx:o,width:i,height:r,cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mappedColumns:u,enableGroups:b,freezeColumns:h,dragAndDropState:f,theme:d,drawFocus:g,headerHeight:v,groupHeaderHeight:p,groupLevels:y,groupHeaderHeights:x,disabledRows:C,rowHeight:B,verticalBorder:P,overrideCursor:F,isResizing:H,selection:k,fillHandle:R,freezeTrailingRows:I,rows:S,getCellContent:M,getGroupDetails:E,getRowThemeOverride:W,isFocused:O,drawHeaderCallback:ne,prelightCells:Z,drawCellCallback:G,highlightRegions:K,resizeCol:ce,imageLoader:ye,lastBlitData:de,hoverValues:Te,hyperWrapping:V,hoverInfo:be,spriteManager:pe,maxScaleFactor:z,hasAppendRow:le,touchMode:j,enqueue:ae,renderStateProvider:Be,getCellRenderer:q,renderStrategy:se,bufferACtx:Ye,bufferBCtx:Ve,damage:ve,minimumCellWidth:pt,resizeIndicator:gt}=e;if(i===0||r===0)return;const Ue=se==="double-buffer",ue=Math.min(z,Math.ceil(window.devicePixelRatio??1)),Ge=se!=="direct"&&es(e,t),We=n.canvas;(We.width!==i*ue||We.height!==r*ue)&&(We.width=i*ue,We.height=r*ue,We.style.width=i+"px",We.style.height=r+"px");const _e=o.canvas,Fe=x.reduce((ke,Je)=>ke+Je,0),re=v+Fe,we=re+1;(_e.width!==i*ue||_e.height!==we*ue)&&(_e.width=i*ue,_e.height=we*ue,_e.style.width=i+"px",_e.style.height=we+"px");const Se=Ye.canvas,nt=Ve.canvas;Ue&&(Se.width!==i*ue||Se.height!==r*ue)&&(Se.width=i*ue,Se.height=r*ue,de.current!==void 0&&(de.current.aBufferScroll=void 0)),Ue&&(nt.width!==i*ue||nt.height!==r*ue)&&(nt.width=i*ue,nt.height=r*ue,de.current!==void 0&&(de.current.bBufferScroll=void 0));const D=de.current;if(Ge===!0&&l===(D==null?void 0:D.cellXOffset)&&s===(D==null?void 0:D.cellYOffset)&&a===(D==null?void 0:D.translateX)&&c===(D==null?void 0:D.translateY))return;let Ae=null;Ue&&(Ae=n);const Ee=o;let N;Ue?ve!==void 0?N=(D==null?void 0:D.lastBuffer)==="b"?Ve:Ye:N=(D==null?void 0:D.lastBuffer)==="b"?Ye:Ve:N=n;const De=N.canvas,He=Ue?De===Se?nt:Se:We,ie=typeof B=="number"?()=>B:B;Ee.save(),N.save(),Ee.beginPath(),N.beginPath(),Ee.textBaseline="middle",N.textBaseline="middle",ue!==1&&(Ee.scale(ue,ue),N.scale(ue,ue));const oe=Zn(u,l,i,f,a);let Oe=[];const ot=g&&((Ht=k.current)==null?void 0:Ht.cell[1])===s&&c===0;let je=!1;if(K!==void 0){for(const ke of K)if(ke.style!=="no-outline"&&ke.range.y===s&&c===0){je=!0;break}}const at=()=>{Ee.fillStyle=d.bgHeader,Ee.fillRect(0,0,i,re+1),Vr(Ee,oe,u,b,be,i,a,v,p,f,H,k,d,pe,Te,P,E,ve,ne,j,y,x),Yo(Ee,oe,s,a,c,i,r,void 0,void 0,Fe,re,ie,W,P,I,S,d,!0),Ee.beginPath(),Ee.moveTo(0,we-.5),Ee.lineTo(i,we-.5),Ee.strokeStyle=et(d.headerBottomBorderColor??d.horizontalBorderColor??d.borderColor,d.bgHeader),Ee.stroke(),je&&$o(Ee,i,r,l,s,a,c,u,h,v,Fe,B,I,S,K,d),ot&&_n(Ee,i,r,s,a,c,oe,u,d,re,k,ie,M,I,le,R,S)};if(ve!==void 0){const ke=oe[oe.length-1].sourceIndex+1,Je=ve.hasItemInRegion([{x:l,y:-2,width:ke,height:2},{x:l,y:s,width:ke,height:300},{x:0,y:s,width:h,height:300},{x:0,y:-2,width:h,height:2},{x:l,y:S-I,width:ke,height:I,when:I>0}]),it=rt=>{No(rt,oe,u,r,re,a,c,s,S,ie,M,E,W,C,O,g,I,le,Oe,ve,k,Z,K,ye,pe,Te,be,G,V,d,ae,Be,q,F,pt);const mt=k.current;R!==!1&&R!==void 0&&g&&mt!==void 0&&ve.has(li(mt.range))&&_n(rt,i,r,s,a,c,oe,u,d,re,k,ie,M,I,le,R,S)};Je&&(it(N),Ae!==null&&(Ae.save(),Ae.scale(ue,ue),Ae.textBaseline="middle",it(Ae),Ae.restore()),ve.hasHeader()&&(ts(Ee,oe,i,Fe,re,a,c,s,ve),at())),N.restore(),Ee.restore();return}if((Ge!==!0||l!==(D==null?void 0:D.cellXOffset)||s!==(D==null?void 0:D.cellYOffset)||a!==(D==null?void 0:D.translateX)||c!==(D==null?void 0:D.translateY)||ot!==(D==null?void 0:D.mustDrawFocusOnHeader)||je!==(D==null?void 0:D.mustDrawHighlightRingsOnHeader))&&at(),Ge===!0){yt(He!==void 0&&D!==void 0);const{regions:ke}=Qr(N,He,He===Se?D.aBufferScroll:D.bBufferScroll,He===Se?D.bBufferScroll:D.aBufferScroll,D,l,s,a,c,I,i,r,S,re,ue,u,oe,B,Ue);Oe=ke}else Ge!==!1&&(yt(D!==void 0),Oe=Zr(D,l,s,a,c,i,r,re,oe,Ge));Kr(N,oe,i,r,I,S,P,ie,d);const $e=$o(N,i,r,l,s,a,c,u,h,v,Fe,B,I,S,K,d),ct=g?_n(N,i,r,s,a,c,oe,u,d,re,k,ie,M,I,le,R,S):void 0;if(N.fillStyle=d.bgCell,Oe.length>0){N.beginPath();for(const ke of Oe)N.rect(ke.x,ke.y,ke.width,ke.height);N.clip(),N.fill(),N.beginPath()}else N.fillRect(0,0,i,r);const Ke=No(N,oe,u,r,re,a,c,s,S,ie,M,E,W,C,O,g,I,le,Oe,ve,k,Z,K,ye,pe,Te,be,G,V,d,ae,Be,q,F,pt);jr(N,oe,u,i,r,re,a,c,s,S,ie,W,k.rows,C,I,le,Oe,ve,d),Jr(N,oe,s,a,c,i,r,Oe,re,ie,W,P,I,S,d),Yo(N,oe,s,a,c,i,r,Oe,Ke,Fe,re,ie,W,P,I,S,d),$e==null||$e(),ct==null||ct(),H&&gt!=="none"&&Mt(oe,0,a,0,re,(ke,Je)=>ke.sourceIndex===ce?(_o(Ee,Je+ke.width,0,re+1,et(d.resizeIndicatorColor??d.accentLight,d.bgHeader)),gt==="full"&&_o(N,Je+ke.width,re,r,et(d.resizeIndicatorColor??d.accentLight,d.bgCell)),!0):!1),Ae!==null&&(Ae.fillStyle=d.bgCell,Ae.fillRect(0,0,i,r),Ae.drawImage(N.canvas,0,0));const It=ns(oe,r,re,a,c,s,S,ie,I,le);ye==null||ye.setWindow({x:l,y:s,width:oe.length,height:It-s},h,Array.from({length:I},(ke,Je)=>S-1-Je));const Ft=D!==void 0&&(l!==D.cellXOffset||a!==D.translateX),Pe=D!==void 0&&(s!==D.cellYOffset||c!==D.translateY);de.current={cellXOffset:l,cellYOffset:s,translateX:a,translateY:c,mustDrawFocusOnHeader:ot,mustDrawHighlightRingsOnHeader:je,lastBuffer:Ue?De===Se?"a":"b":void 0,aBufferScroll:De===Se?[Ft,Pe]:D==null?void 0:D.aBufferScroll,bBufferScroll:De===nt?[Ft,Pe]:D==null?void 0:D.bBufferScroll},N.restore(),Ee.restore()}const os=80;function is(e){const t=e-1;return t*t*t+1}class rs{constructor(t){ee(this,"currentHoveredItem");ee(this,"leavingItems",[]);ee(this,"lastAnimationTime");ee(this,"addToLeavingItems",t=>{this.leavingItems.some(o=>En(o.item,t.item))||this.leavingItems.push(t)});ee(this,"removeFromLeavingItems",t=>{const n=this.leavingItems.find(o=>En(o.item,t));return this.leavingItems=this.leavingItems.filter(o=>o!==n),(n==null?void 0:n.hoverAmount)??0});ee(this,"cleanUpLeavingElements",()=>{this.leavingItems=this.leavingItems.filter(t=>t.hoverAmount>0)});ee(this,"shouldStep",()=>{const t=this.leavingItems.length>0,n=this.currentHoveredItem!==void 0&&this.currentHoveredItem.hoverAmount<1;return t||n});ee(this,"getAnimatingItems",()=>this.currentHoveredItem!==void 0?[...this.leavingItems,this.currentHoveredItem]:this.leavingItems.map(t=>({...t,hoverAmount:is(t.hoverAmount)})));ee(this,"step",t=>{if(this.lastAnimationTime===void 0)this.lastAnimationTime=t;else{const o=(t-this.lastAnimationTime)/os;for(const r of this.leavingItems)r.hoverAmount=In(r.hoverAmount-o,0,1);this.currentHoveredItem!==void 0&&(this.currentHoveredItem.hoverAmount=In(this.currentHoveredItem.hoverAmount+o,0,1));const i=this.getAnimatingItems();this.callback(i),this.cleanUpLeavingElements()}this.shouldStep()?(this.lastAnimationTime=t,window.requestAnimationFrame(this.step)):this.lastAnimationTime=void 0});ee(this,"setHovered",t=>{var n;if(!En((n=this.currentHoveredItem)==null?void 0:n.item,t)){if(this.currentHoveredItem!==void 0&&this.addToLeavingItems(this.currentHoveredItem),t!==void 0){const o=this.removeFromLeavingItems(t);this.currentHoveredItem={item:t,hoverAmount:o}}else this.currentHoveredItem=void 0;this.lastAnimationTime===void 0&&window.requestAnimationFrame(this.step)}});this.callback=t}}class ss{constructor(t){ee(this,"fn");ee(this,"val");this.fn=t}get value(){return this.val??(this.val=this.fn())}}function go(e){return new ss(e)}const ls=go(()=>window.navigator.userAgent.includes("Firefox")),qo=go(()=>window.navigator.userAgent.includes("Mac OS")&&window.navigator.userAgent.includes("Safari")&&!window.navigator.userAgent.includes("Chrome")),$l=go(()=>window.navigator.platform.toLowerCase().startsWith("mac"));function as(e){const t=m.useRef([]),n=m.useRef(0),o=m.useRef(e);o.current=e;const i=m.useCallback(()=>{const r=()=>window.requestAnimationFrame(l),l=()=>{const s=t.current.map(fo);t.current=[],o.current(new Ut(s)),t.current.length>0?n.current++:n.current=0};window.requestAnimationFrame(n.current>600?r:l)},[]);return m.useCallback(r=>{t.current.length===0&&i();const l=lt(r[0],r[1]);t.current.includes(l)||t.current.push(l)},[i])}const Wt="header",ln="group-header",Uo="out-of-bounds";var an=(e=>(e[e.Start=-2]="Start",e[e.StartPadding=-1]="StartPadding",e[e.Center=0]="Center",e[e.EndPadding=1]="EndPadding",e[e.End=2]="End",e))(an||{});function cs(e,t){return e===t?!0:(e==null?void 0:e.kind)==="out-of-bounds"?(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])&&(e==null?void 0:e.region[0])===(t==null?void 0:t.region[0])&&(e==null?void 0:e.region[1])===(t==null?void 0:t.region[1]):(e==null?void 0:e.kind)===(t==null?void 0:t.kind)&&(e==null?void 0:e.location[0])===(t==null?void 0:t.location[0])&&(e==null?void 0:e.location[1])===(t==null?void 0:t.location[1])}const ds=(e,t)=>{if(e.kind===me.Custom)return e.copyData;const n=t==null?void 0:t(e);return(n==null?void 0:n.getAccessibilityString(e))??""},us=(e,t)=>{const{width:n,height:o,accessibilityHeight:i,columns:r,cellXOffset:l,cellYOffset:s,headerHeight:a,fillHandle:c=!1,groupHeaderHeight:u,groupLevels:b,groupHeaderHeights:h,rowHeight:f,rows:d,getCellContent:g,getRowThemeOverride:v,onHeaderMenuClick:p,onHeaderIndicatorClick:y,enableGroups:x,isFilling:C,onCanvasFocused:B,onCanvasBlur:P,isFocused:F,selection:H,freezeColumns:k,onContextMenu:R,freezeTrailingRows:I,fixedShadowX:S=!0,fixedShadowY:M=!0,drawFocusRing:E,onMouseDown:W,onMouseUp:O,onMouseMoveRaw:ne,onMouseMove:Z,onItemHovered:G,dragAndDropState:K,firstColAccessible:ce,onKeyDown:ye,onKeyUp:de,highlightRegions:Te,canvasRef:V,onDragStart:be,onDragEnd:pe,eventTargetRef:z,isResizing:le,resizeColumn:j,isDragging:ae,isDraggable:Be=!1,allowResize:q,disabledRows:se,hasAppendRow:Ye,getGroupDetails:Ve,theme:ve,prelightCells:pt,headerIcons:gt,verticalBorder:Ue,drawCell:ue,drawHeader:Ge,onCellFocused:We,onDragOverCell:_e,onDrop:Fe,onDragLeave:re,imageWindowLoader:we,smoothScrollX:Se=!1,smoothScrollY:nt=!1,experimental:D,getCellRenderer:Ae,resizeIndicator:Ee="full"}=e,N=e.translateX??0,De=e.translateY??0,He=Math.max(k,Math.min(r.length-1,l)),ie=m.useRef(null),oe=m.useRef((D==null?void 0:D.eventTarget)??window),Oe=oe.current,ot=we,je=m.useRef(),[at,$e]=m.useState(!1),ct=m.useRef([]),Ke=m.useRef(),[It,Ft]=m.useState(),[Pe,Ht]=m.useState(),ke=m.useRef(null),[Je,it]=m.useState(),[rt,mt]=m.useState(!1),Pt=m.useRef(rt);Pt.current=rt;const U=m.useMemo(()=>new Rr(gt,()=>{hn.current=void 0,Zt.current()}),[gt]),fe=x?u+a:a,he=m.useRef(-1),Qe=((D==null?void 0:D.enableFirefoxRescaling)??!1)&&ls.value,Ze=((D==null?void 0:D.enableSafariRescaling)??!1)&&qo.value;m.useLayoutEffect(()=>{window.devicePixelRatio===1||!Qe&&!Ze||(he.current!==-1&&$e(!0),window.clearTimeout(he.current),he.current=window.setTimeout(()=>{$e(!1),he.current=-1},200))},[s,He,N,De,Qe,Ze]);const Q=vr(r,k),Dn=m.useMemo(()=>S?jt(Q,K):0,[Q,K,S]),Le=m.useCallback((w,A,X)=>{const Y=w.getBoundingClientRect();if(A>=Q.length||X>=d)return;const T=Y.width/n,L=eo(A,X,n,o,u,fe,He,s,N,De,d,k,I,Q,f,b,h);return T!==1&&(L.x*=T,L.y*=T,L.width*=T,L.height*=T),L.x+=Y.x,L.y+=Y.y,L},[n,o,u,fe,He,s,N,De,d,k,I,Q,f,b,h]),Ne=m.useCallback((w,A,X,Y)=>{const T=w.getBoundingClientRect(),L=T.width/n,J=(A-T.left)/L,te=(X-T.top)/L,$=5,Xe=Zn(Q,He,n,void 0,N);let _=0,ge=0;const Me=typeof PointerEvent<"u"&&Y instanceof PointerEvent&&Y.pointerType==="mouse"||typeof MouseEvent<"u"&&Y instanceof MouseEvent,Ce=typeof PointerEvent<"u"&&Y instanceof PointerEvent&&Y.pointerType==="touch"||typeof TouchEvent<"u"&&Y instanceof TouchEvent;Me&&(_=Y.button,ge=Y.buttons);const Ie=xr(J,Xe,N),Re=Sr(te,o,x,a,u,d,f,s,De,I,b,h),ze=(Y==null?void 0:Y.shiftKey)===!0,bt=(Y==null?void 0:Y.ctrlKey)===!0,wt=(Y==null?void 0:Y.metaKey)===!0,dt=[J<0?-1:n<J?1:0,te<fe?-1:o<te?1:0];let kt;if(Ie===-1||te<0||J<0||Re===void 0||J>n||te>o){const xe=J>n?1:J<0?-1:0,xt=te>o?1:te<0?-1:0;let vt=xe*2,Vt=xt*2;xe===0&&(vt=Ie===-1?an.EndPadding:an.Center),xt===0&&(Vt=Re===void 0?an.EndPadding:an.Center);let st=!1;if(Ie===-1&&Re===-1){const qt=Le(w,Q.length-1,-1);yt(qt!==void 0),st=A<qt.x+qt.width+$}const tn=J>n&&J<n+Ro()||te>o&&te<o+Ro();kt={kind:Uo,location:[Ie!==-1?Ie:J<0?0:Q.length-1,Re??d-1],region:[vt,Vt],shiftKey:ze,ctrlKey:bt,metaKey:wt,isEdge:st,isTouch:Ce,button:_,buttons:ge,scrollEdge:dt,isMaybeScrollbar:tn}}else if(Re<=-1){let xe=Le(w,Ie,Re);yt(xe!==void 0);let xt=xe!==void 0&&xe.x+xe.width-A<=$;const vt=x&&Re<=-2,Vt=vt?-(Re+2):void 0,st=Ie-1;A-xe.x<=$&&st>=0?(xt=!0,xe=Le(w,st,Re),yt(xe!==void 0),kt={kind:vt?ln:Wt,location:[st,Re],bounds:xe,group:zt(Q[st].group,Vt),isEdge:xt,shiftKey:ze,ctrlKey:bt,metaKey:wt,isTouch:Ce,localEventX:A-xe.x,localEventY:X-xe.y,button:_,buttons:ge,scrollEdge:dt}):kt={kind:vt?ln:Wt,group:zt(Q[Ie].group,Vt),location:[Ie,Re],bounds:xe,isEdge:xt,shiftKey:ze,ctrlKey:bt,metaKey:wt,isTouch:Ce,localEventX:A-xe.x,localEventY:X-xe.y,button:_,buttons:ge,scrollEdge:dt}}else{const xe=Le(w,Ie,Re);yt(xe!==void 0);const xt=xe!==void 0&&xe.x+xe.width-A<$;let vt=!1;if(c!==!1&&c!==void 0&&H.current!==void 0){const st=typeof c=="object"?{...Hn,...c}:Hn,tn=st.size,qt=tn/2,Po=li(H.current.range),nn=Le(w,Po[0],Po[1]);if(nn!==void 0){const Ui=nn.x+nn.width+st.offsetX-qt+.5,Gi=nn.y+nn.height+st.offsetY-qt+.5;vt=Math.abs(Ui-A)<tn&&Math.abs(Gi-X)<tn}}kt={kind:"cell",location:[Ie,Re],bounds:xe,isEdge:xt,shiftKey:ze,ctrlKey:bt,isFillHandle:vt,metaKey:wt,isTouch:Ce,localEventX:A-xe.x,localEventY:X-xe.y,button:_,buttons:ge,scrollEdge:dt}}return kt},[n,Q,He,N,o,x,a,u,d,f,s,De,I,Le,c,H,fe]),[Bt]=It??[],bo=m.useRef(()=>{}),Xt=m.useRef(It);Xt.current=It;const[At,Dt]=m.useMemo(()=>{const w=document.createElement("canvas"),A=document.createElement("canvas");return w.style.display="none",w.style.opacity="0",w.style.position="fixed",A.style.display="none",A.style.opacity="0",A.style.position="fixed",[w.getContext("2d",{alpha:!1}),A.getContext("2d",{alpha:!1})]},[]);m.useLayoutEffect(()=>{if(!(At===null||Dt===null))return document.documentElement.append(At.canvas),document.documentElement.append(Dt.canvas),()=>{At.canvas.remove(),Dt.canvas.remove()}},[At,Dt]);const fn=m.useMemo(()=>new Ar,[]),vo=Qe&&at?1:Ze&&at?2:5,yo=(D==null?void 0:D.disableMinimumCellWidth)===!0?1:10,hn=m.useRef(),gn=m.useRef(null),mn=m.useRef(null),bn=m.useCallback(()=>{var J;const w=ie.current,A=ke.current;if(w===null||A===null||(gn.current===null&&(gn.current=w.getContext("2d",{alpha:!1}),w.width=0,w.height=0),mn.current===null&&(mn.current=A.getContext("2d",{alpha:!1}),A.width=0,A.height=0),gn.current===null||mn.current===null||At===null||Dt===null))return;let X=!1;const Y=te=>{X=!0,it(te)},T=hn.current,L={headerCanvasCtx:mn.current,canvasCtx:gn.current,bufferACtx:At,bufferBCtx:Dt,width:n,height:o,cellXOffset:He,cellYOffset:s,translateX:Math.round(N),translateY:Math.round(De),mappedColumns:Q,enableGroups:x,freezeColumns:k,dragAndDropState:K,theme:ve,headerHeight:a,groupHeaderHeight:u,groupLevels:b,groupHeaderHeights:h,disabledRows:se??Kn.empty(),rowHeight:f,verticalBorder:Ue,isResizing:le,resizeCol:j,isFocused:F,selection:H,fillHandle:c,drawCellCallback:ue,hasAppendRow:Ye,overrideCursor:Y,maxScaleFactor:vo,freezeTrailingRows:I,rows:d,drawFocus:E,getCellContent:g,getGroupDetails:Ve??(te=>({name:te})),getRowThemeOverride:v,drawHeaderCallback:Ge,prelightCells:pt,highlightRegions:Te,imageLoader:ot,lastBlitData:Ke,damage:je.current,hoverValues:ct.current,hoverInfo:Xt.current,spriteManager:U,scrolling:at,hyperWrapping:(D==null?void 0:D.hyperWrapping)??!1,touchMode:rt,enqueue:bo.current,renderStateProvider:fn,renderStrategy:(D==null?void 0:D.renderStrategy)??(qo.value?"double-buffer":"single-buffer"),getCellRenderer:Ae,minimumCellWidth:yo,resizeIndicator:Ee};L.damage===void 0?(hn.current=L,Vo(L,T)):Vo(L,void 0),!X&&(L.damage===void 0||L.damage.has((J=Xt==null?void 0:Xt.current)==null?void 0:J[0]))&&it(void 0)},[At,Dt,n,o,He,s,N,De,Q,x,k,K,ve,a,u,b,h,se,f,Ue,le,Ye,j,F,H,c,I,d,E,vo,g,Ve,v,ue,Ge,pt,Te,ot,U,at,D==null?void 0:D.hyperWrapping,D==null?void 0:D.renderStrategy,rt,fn,Ae,yo,Ee]),Zt=m.useRef(bn);m.useLayoutEffect(()=>{bn(),Zt.current=bn},[bn]),m.useLayoutEffect(()=>{(async()=>{var A;((A=document==null?void 0:document.fonts)==null?void 0:A.ready)!==void 0&&(await document.fonts.ready,hn.current=void 0,Zt.current())})()},[]);const Yt=m.useCallback(w=>{je.current=w,Zt.current(),je.current=void 0},[]),Ei=as(Yt);bo.current=Ei;const po=m.useCallback(w=>{Yt(new Ut(w.map(A=>A.cell)))},[Yt]);ot.setCallback(Yt);const[Mi,Ii]=m.useState(!1),[Rt,$t]=Bt??[],Fi=Rt!==void 0&&$t===-1&&Rt>=0&&Rt<Q.length&&Q[Rt].headerRowMarkerDisabled!==!0,Hi=Rt!==void 0&&$t===-2;let wo=!1,ko=!1,vn=Je;if(vn===void 0&&Rt!==void 0&&$t!==void 0&&$t>-1&&$t<d){const w=g([Rt,$t],!0);wo=w.kind===Et.NewRow||w.kind===Et.Marker&&w.markerKind!=="number",ko=w.kind===me.Boolean&&so(w),vn=w.cursor}const xo=ae?"grabbing":(Pe??!1)||le?"col-resize":Mi||C?"crosshair":vn!==void 0?vn:Fi||wo||ko||Hi?"pointer":"default",Rn=m.useMemo(()=>({contain:"strict",display:"block",cursor:xo}),[xo]),So=m.useRef("default"),Tn=z==null?void 0:z.current;Tn!=null&&So.current!==Rn.cursor&&(Tn.style.cursor=So.current=Rn.cursor);const yn=m.useCallback((w,A,X,Y)=>{if(Ve===void 0)return;const T=Ve(w);if(T.actions!==void 0){const L=ho(A,T.actions);for(const[J,te]of L.entries())if(Ot(te,X+A.x,Y+te.y))return T.actions[J]}},[Ve]),_t=m.useCallback((w,A,X,Y)=>{const T=Q[A];if(!ae&&!le&&!(Pe??!1)){const L=Le(w,A,-1);yt(L!==void 0);const J=wi(void 0,T,L.x,L.y,L.width,L.height,ve,ao(T.title)==="rtl");if(T.hasMenu===!0&&J.menuBounds!==void 0&&Ot(J.menuBounds,X,Y))return{area:"menu",bounds:J.menuBounds};if(T.indicatorIcon!==void 0&&J.indicatorIconBounds!==void 0&&Ot(J.indicatorIconBounds,X,Y))return{area:"indicator",bounds:J.indicatorIconBounds}}},[Q,Le,Pe,ae,le,ve]),Wn=m.useRef(0),en=m.useRef(),On=m.useRef(!1),Pi=m.useCallback(w=>{const A=ie.current,X=z==null?void 0:z.current;if(A===null||w.target!==A&&w.target!==X)return;On.current=!0;const Y=w.clientX,T=w.clientY;if(w.target===X&&X!==null){const J=X.getBoundingClientRect();if(Y>J.right||T>J.bottom)return}const L=Ne(A,Y,T,w);en.current=L.location,L.isTouch&&(Wn.current=Date.now()),Pt.current!==L.isTouch&&mt(L.isTouch),!(L.kind===Wt&&_t(A,L.location[0],Y,T)!==void 0)&&(L.kind===ln&&yn(L.group,L.bounds,L.localEventX,L.localEventY)!==void 0||(W==null||W(L),!L.isTouch&&Be!==!0&&Be!==L.kind&&L.button<3&&L.button!==1&&w.preventDefault()))},[z,Be,Ne,yn,_t,W]);ut("pointerdown",Pi,Oe,!1);const Co=m.useRef(0),Bi=m.useCallback(w=>{var ge,Me;const A=Co.current;Co.current=Date.now();const X=ie.current;if(On.current=!1,O===void 0||X===null)return;const Y=z==null?void 0:z.current,T=w.target!==X&&w.target!==Y,L=w.clientX,J=w.clientY,te=w.pointerType==="mouse"?w.button<3:!0;let $=Ne(X,L,J,w);$.isTouch&&Wn.current!==0&&Date.now()-Wn.current>500&&($={...$,isLongTouch:!0}),A!==0&&Date.now()-A<($.isTouch?1e3:500)&&($={...$,isDoubleClick:!0}),Pt.current!==$.isTouch&&mt($.isTouch),!T&&w.cancelable&&te&&w.preventDefault();const[Xe]=$.location,_=_t(X,Xe,L,J);if($.kind===Wt&&_!==void 0){($.button!==0||((ge=en.current)==null?void 0:ge[0])!==Xe||((Me=en.current)==null?void 0:Me[1])!==-1)&&O($,!0);return}else if($.kind===ln){const Ce=yn($.group,$.bounds,$.localEventX,$.localEventY);if(Ce!==void 0){$.button===0&&Ce.onClick($);return}}O($,T)},[O,z,Ne,_t,yn]);ut("pointerup",Bi,Oe,!1);const Ai=m.useCallback(w=>{var Xe,_;const A=ie.current;if(A===null)return;const X=z==null?void 0:z.current,Y=w.target!==A&&w.target!==X;let T,L,J=!0;w instanceof MouseEvent?(T=w.clientX,L=w.clientY,J=w.button<3):(T=w.changedTouches[0].clientX,L=w.changedTouches[0].clientY);const te=Ne(A,T,L,w);Pt.current!==te.isTouch&&mt(te.isTouch),!Y&&w.cancelable&&J&&w.preventDefault();const[$]=te.location;if(te.kind===Wt){const ge=_t(A,$,T,L);ge!==void 0&&te.button===0&&((Xe=en.current)==null?void 0:Xe[0])===$&&((_=en.current)==null?void 0:_[1])===-1&&(ge.area==="menu"?p==null||p($,ge.bounds):ge.area==="indicator"&&(y==null||y($,ge.bounds)))}},[z,Ne,_t,p,y]);ut("click",Ai,Oe,!1);const Di=m.useCallback(w=>{const A=ie.current,X=z==null?void 0:z.current;if(A===null||w.target!==A&&w.target!==X||R===void 0)return;const Y=Ne(A,w.clientX,w.clientY,w);R(Y,()=>{w.cancelable&&w.preventDefault()})},[z,Ne,R]);ut("contextmenu",Di,(z==null?void 0:z.current)??null,!1);const Eo=m.useCallback(w=>{je.current=new Ut(w.map(A=>A.item)),ct.current=w,Zt.current(),je.current=void 0},[]),Mo=m.useMemo(()=>new rs(Eo),[Eo]),Io=m.useRef(Mo);Io.current=Mo,m.useLayoutEffect(()=>{const w=Io.current;if(Bt===void 0||Bt[1]<0){w.setHovered(Bt);return}const A=g(Bt,!0),X=Ae(A),Y=X===void 0&&A.kind===me.Custom||(X==null?void 0:X.needsHover)!==void 0&&(typeof X.needsHover=="boolean"?X.needsHover:X.needsHover(A));w.setHovered(Y?Bt:void 0)},[g,Ae,Bt]);const Fo=m.useRef(),Ri=m.useCallback(w=>{var te;const A=ie.current;if(A===null)return;const X=z==null?void 0:z.current,Y=w.target!==A&&w.target!==X,T=Ne(A,w.clientX,w.clientY,w);if(T.kind!=="out-of-bounds"&&Y&&!On.current&&!T.isTouch)return;const L=($,Xe)=>{Ft(_=>_===$||(_==null?void 0:_[0][0])===($==null?void 0:$[0][0])&&(_==null?void 0:_[0][1])===($==null?void 0:$[0][1])&&((_==null?void 0:_[1][0])===($==null?void 0:$[1][0])&&(_==null?void 0:_[1][1])===($==null?void 0:$[1][1])||!Xe)?_:$)};if(!cs(T,Fo.current))it(void 0),G==null||G(T),L(T.kind===Uo?void 0:[T.location,[T.localEventX,T.localEventY]],!0),Fo.current=T;else if(T.kind==="cell"||T.kind===Wt||T.kind===ln){let $=!1,Xe=!0;if(T.kind==="cell"){const ge=g(T.location);Xe=((te=Ae(ge))==null?void 0:te.needsHoverPosition)??ge.kind===me.Custom,$=Xe}else $=!0;const _=[T.location,[T.localEventX,T.localEventY]];L(_,Xe),Xt.current=_,$&&Yt(new Ut([T.location]))}const J=T.location[0]>=(ce?0:1);Ht(T.kind===Wt&&T.isEdge&&J&&q===!0),Ii(T.kind==="cell"&&T.isFillHandle),ne==null||ne(w),Z(T)},[z,Ne,ce,q,ne,Z,G,g,Ae,Yt]);ut("pointermove",Ri,Oe,!0);const Ti=m.useCallback(w=>{const A=ie.current;if(A===null)return;let X,Y;H.current!==void 0&&(X=Le(A,H.current.cell[0],H.current.cell[1]),Y=H.current.cell),ye==null||ye({bounds:X,stopPropagation:()=>w.stopPropagation(),preventDefault:()=>w.preventDefault(),cancel:()=>{},ctrlKey:w.ctrlKey,metaKey:w.metaKey,shiftKey:w.shiftKey,altKey:w.altKey,key:w.key,keyCode:w.keyCode,rawEvent:w,location:Y})},[ye,H,Le]),Wi=m.useCallback(w=>{const A=ie.current;if(A===null)return;let X,Y;H.current!==void 0&&(X=Le(A,H.current.cell[0],H.current.cell[1]),Y=H.current.cell),de==null||de({bounds:X,stopPropagation:()=>w.stopPropagation(),preventDefault:()=>w.preventDefault(),cancel:()=>{},ctrlKey:w.ctrlKey,metaKey:w.metaKey,shiftKey:w.shiftKey,altKey:w.altKey,key:w.key,keyCode:w.keyCode,rawEvent:w,location:Y})},[de,H,Le]),Oi=m.useCallback(w=>{if(ie.current=w,V!==void 0&&(V.current=w),D!=null&&D.eventTarget)oe.current=D.eventTarget;else if(w===null)oe.current=window;else{const A=w.getRootNode();A===document&&(oe.current=window),oe.current=A}},[V,D==null?void 0:D.eventTarget]),zi=m.useCallback(w=>{const A=ie.current;if(A===null||Be===!1||le){w.preventDefault();return}let X,Y;const T=Ne(A,w.clientX,w.clientY);if(Be!==!0&&T.kind!==Be){w.preventDefault();return}const L=(ge,Me)=>{X=ge,Y=Me};let J,te,$;const Xe=(ge,Me,Ce)=>{J=ge,te=Me,$=Ce};let _=!1;if(be==null||be({...T,setData:L,setDragImage:Xe,preventDefault:()=>_=!0,defaultPrevented:()=>_}),!_&&X!==void 0&&Y!==void 0&&w.dataTransfer!==null)if(w.dataTransfer.setData(X,Y),w.dataTransfer.effectAllowed="copyLink",J!==void 0&&te!==void 0&&$!==void 0)w.dataTransfer.setDragImage(J,te,$);else{const[ge,Me]=T.location;if(Me!==void 0){const Ce=document.createElement("canvas"),Ie=Le(A,ge,Me);yt(Ie!==void 0);const Re=Math.ceil(window.devicePixelRatio??1);Ce.width=Ie.width*Re,Ce.height=Ie.height*Re;const ze=Ce.getContext("2d");ze!==null&&(ze.scale(Re,Re),ze.textBaseline="middle",Me===-1?(ze.font=ve.headerFontFull,ze.fillStyle=ve.bgHeader,ze.fillRect(0,0,Ce.width,Ce.height),ki(ze,0,0,Ie.width,Ie.height,Q[ge],!1,ve,!1,void 0,void 0,!1,0,U,Ge,!1)):(ze.font=ve.baseFontFull,ze.fillStyle=ve.bgCell,ze.fillRect(0,0,Ce.width,Ce.height),pi(ze,g([ge,Me]),0,Me,!1,!1,0,0,Ie.width,Ie.height,!1,ve,ve.bgCell,ot,U,1,void 0,!1,0,void 0,void 0,void 0,fn,Ae,()=>{},0))),Ce.style.left="-100%",Ce.style.position="absolute",Ce.style.width=`${Ie.width}px`,Ce.style.height=`${Ie.height}px`,document.body.append(Ce),w.dataTransfer.setDragImage(Ce,Ie.width/2,Ie.height/2),window.setTimeout(()=>{Ce.remove()},0)}}else w.preventDefault()},[Be,le,Ne,be,Le,ve,Q,U,Ge,g,ot,fn,Ae]);ut("dragstart",zi,(z==null?void 0:z.current)??null,!1,!1);const zn=m.useRef(),Li=m.useCallback(w=>{const A=ie.current;if(Fe!==void 0&&w.preventDefault(),A===null||_e===void 0)return;const X=Ne(A,w.clientX,w.clientY),[Y,T]=X.location,L=Y-(ce?0:1),[J,te]=zn.current??[];(J!==L||te!==T)&&(zn.current=[L,T],_e([L,T],w.dataTransfer))},[ce,Ne,_e,Fe]);ut("dragover",Li,(z==null?void 0:z.current)??null,!1,!1);const Ni=m.useCallback(()=>{zn.current=void 0,pe==null||pe()},[pe]);ut("dragend",Ni,(z==null?void 0:z.current)??null,!1,!1);const Xi=m.useCallback(w=>{const A=ie.current;if(A===null||Fe===void 0)return;w.preventDefault();const X=Ne(A,w.clientX,w.clientY),[Y,T]=X.location,L=Y-(ce?0:1);Fe([L,T],w.dataTransfer)},[ce,Ne,Fe]);ut("drop",Xi,(z==null?void 0:z.current)??null,!1,!1);const Yi=m.useCallback(()=>{re==null||re()},[re]);ut("dragleave",Yi,(z==null?void 0:z.current)??null,!1,!1);const Ho=m.useRef(H);Ho.current=H;const pn=m.useRef(null),Ln=m.useCallback(w=>{var A;ie.current===null||!ie.current.contains(document.activeElement)||(w===null&&Ho.current.current!==void 0?(A=V==null?void 0:V.current)==null||A.focus({preventScroll:!0}):w!==null&&w.focus({preventScroll:!0}),pn.current=w)},[V]);m.useImperativeHandle(t,()=>({focus:()=>{var A;const w=pn.current;w===null||!document.contains(w)?(A=V==null?void 0:V.current)==null||A.focus({preventScroll:!0}):w.focus({preventScroll:!0})},getBounds:(w,A)=>{if(!(V===void 0||V.current===null))return Le(V.current,w??0,A??-1)},damage:po,getMouseArgsForPosition:(w,A,X)=>{if(!(V===void 0||V.current===null))return Ne(V.current,w,A,X)}}),[V,po,Le,Ne]);const Nn=m.useRef(),$i=hr(()=>{var te,$,Xe;if(n<50||(D==null?void 0:D.disableAccessibilityTree)===!0)return null;let w=Zn(Q,He,n,K,N);const A=ce?0:-1;!ce&&((te=w[0])==null?void 0:te.sourceIndex)===0&&(w=w.slice(1));const[X,Y]=(($=H.current)==null?void 0:$.cell)??[],T=(Xe=H.current)==null?void 0:Xe.range,L=w.map(_=>_.sourceIndex),J=nr(s,Math.min(d,s+i));return X!==void 0&&Y!==void 0&&!(L.includes(X)&&J.includes(Y))&&Ln(null),m.createElement("table",{key:"access-tree",role:"grid","aria-rowcount":d+1,"aria-multiselectable":"true","aria-colcount":Q.length+A},m.createElement("thead",{role:"rowgroup"},m.createElement("tr",{role:"row","aria-rowindex":1},w.map(_=>m.createElement("th",{role:"columnheader","aria-selected":H.columns.hasIndex(_.sourceIndex),"aria-colindex":_.sourceIndex+1+A,tabIndex:-1,onFocus:ge=>{if(ge.target!==pn.current)return We==null?void 0:We([_.sourceIndex,-1])},key:_.sourceIndex},_.title)))),m.createElement("tbody",{role:"rowgroup"},J.map(_=>m.createElement("tr",{role:"row","aria-selected":H.rows.hasIndex(_),key:_,"aria-rowindex":_+2},w.map(ge=>{const Me=ge.sourceIndex,Ce=lt(Me,_),Ie=X===Me&&Y===_,Re=T!==void 0&&Me>=T.x&&Me<T.x+T.width&&_>=T.y&&_<T.y+T.height,ze=`glide-cell-${Me}-${_}`,bt=[Me,_],wt=g(bt,!0);return m.createElement("td",{key:Ce,role:"gridcell","aria-colindex":Me+1+A,"aria-selected":Re,"aria-readonly":ro(wt)||!cr(wt),id:ze,"data-testid":ze,onClick:()=>{const dt=V==null?void 0:V.current;if(dt!=null)return ye==null?void 0:ye({bounds:Le(dt,Me,_),cancel:()=>{},preventDefault:()=>{},stopPropagation:()=>{},ctrlKey:!1,key:"Enter",keyCode:13,metaKey:!1,shiftKey:!1,altKey:!1,rawEvent:void 0,location:bt})},onFocusCapture:dt=>{var kt,xe;if(!(dt.target===pn.current||((kt=Nn.current)==null?void 0:kt[0])===Me&&((xe=Nn.current)==null?void 0:xe[1])===_))return Nn.current=bt,We==null?void 0:We(bt)},ref:Ie?Ln:void 0,tabIndex:-1},ds(wt,Ae))})))))},[n,Q,He,K,N,d,s,i,H,Ln,g,V,ye,Le,We],200),wn=k===0||!S?0:He>k?1:In(-N/100,0,1),_i=-s*32+De,kn=M?In(-_i/100,0,1):0,Vi=m.useMemo(()=>{if(!wn&&!kn)return null;const w={position:"absolute",top:0,left:Dn,width:n-Dn,height:o,opacity:wn,pointerEvents:"none",transition:Se?void 0:"opacity 0.2s",boxShadow:"inset 13px 0 10px -13px rgba(0, 0, 0, 0.2)"},A={position:"absolute",top:fe,left:0,width:n,height:o,opacity:kn,pointerEvents:"none",transition:nt?void 0:"opacity 0.2s",boxShadow:"inset 0 13px 10px -13px rgba(0, 0, 0, 0.2)"};return m.createElement(m.Fragment,null,wn>0&&m.createElement("div",{id:"shadow-x",style:w}),kn>0&&m.createElement("div",{id:"shadow-y",style:A}))},[wn,kn,Dn,n,Se,fe,o,nt]),qi=m.useMemo(()=>({position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}),[]);return m.createElement(m.Fragment,null,m.createElement("canvas",{"data-testid":"data-grid-canvas",tabIndex:-1,onKeyDown:Ti,onKeyUp:Wi,onFocus:B,onBlur:P,ref:Oi,style:Rn},$i),m.createElement("canvas",{ref:ke,style:qi}),Vi)},_l=m.memo(m.forwardRef(us));class fs extends m.PureComponent{constructor(){super(...arguments);ee(this,"wrapperRef",m.createRef());ee(this,"clickOutside",n=>{if(!(this.props.isOutsideClick&&!this.props.isOutsideClick(n))&&this.wrapperRef.current!==null&&!this.wrapperRef.current.contains(n.target)){let o=n.target;for(;o!==null;){if(o.classList.contains("click-outside-ignore"))return;o=o.parentElement}this.props.onClickOutside()}})}componentDidMount(){const n=this.props.customEventTarget??document;n.addEventListener("pointerdown",this.clickOutside,!0),n.addEventListener("contextmenu",this.clickOutside,!0)}componentWillUnmount(){const n=this.props.customEventTarget??document;n.removeEventListener("pointerdown",this.clickOutside,!0),n.removeEventListener("contextmenu",this.clickOutside,!0)}render(){const{onClickOutside:n,isOutsideClick:o,customEventTarget:i,...r}=this.props;return m.createElement("div",{...r,ref:this.wrapperRef},this.props.children)}}function hs(e){if(e.copyData!==void 0)return{formatted:e.copyData,rawValue:e.copyData,format:"string",doNotEscape:!0};switch(e.kind){case me.Boolean:return{formatted:e.data===!0?"TRUE":e.data===!1?"FALSE":e.data===io?"INDETERMINATE":"",rawValue:e.data,format:"boolean"};case me.Custom:return{formatted:e.copyData,rawValue:e.copyData,format:"string"};case me.Image:case me.Bubble:return{formatted:e.data,rawValue:e.data,format:"string-array"};case me.Drilldown:return{formatted:e.data.map(t=>t.text),rawValue:e.data.map(t=>t.text),format:"string-array"};case me.Text:return{formatted:e.displayData??e.data,rawValue:e.data,format:"string"};case me.Uri:return{formatted:e.displayData??e.data,rawValue:e.data,format:"url"};case me.Markdown:case me.RowID:return{formatted:e.data,rawValue:e.data,format:"string"};case me.Number:return{formatted:e.displayData,rawValue:e.data,format:"number"};case me.Loading:return{formatted:"#LOADING",rawValue:"",format:"string"};case me.Protected:return{formatted:"************",rawValue:"",format:"string"};default:oo()}}function gs(e,t){return e.map((o,i)=>{const r=t[i];return o.map(l=>l.span!==void 0&&l.span[0]!==r?{formatted:"",rawValue:"",format:"string"}:hs(l))})}function Go(e,t){return(t?/[\t\n",]/:/[\t\n"]/).test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e}function ms(e){var n;const t=[];for(const o of e){const i=[];for(const r of o)r.format==="url"?i.push(((n=r.rawValue)==null?void 0:n.toString())??""):r.format==="string-array"?i.push(r.formatted.map(l=>Go(l,!0)).join(",")):i.push(r.doNotEscape===!0?r.formatted:Go(r.formatted,!1));t.push(i.join("	"))}return t.join(`
`)}function Vn(e){return e.replace(/\t/g,"    ").replace(/ {2,}/g,t=>"<span> </span>".repeat(t.length))}function jo(e){return'"'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'"'}function bs(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function vs(e){var n;const t=[];t.push('<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>',"<table><tbody>");for(const o of e){t.push("<tr>");for(const i of o){const r=`gdg-format="${i.format}"`;i.format==="url"?t.push(`<td ${r}><a href="${i.rawValue}">${Vn(i.formatted)}</a></td>`):i.format==="string-array"?t.push(`<td ${r}><ol>${i.formatted.map((l,s)=>`<li gdg-raw-value=${jo(i.rawValue[s])}>`+Vn(l)+"</li>").join("")}</ol></td>`):t.push(`<td gdg-raw-value=${jo(((n=i.rawValue)==null?void 0:n.toString())??"")} ${r}>${Vn(i.formatted)}</td>`)}t.push("</tr>")}return t.push("</tbody></table>"),t.join("")}function ys(e,t){const n=gs(e,t),o=ms(n),i=vs(n);return{textPlain:o,textHtml:i}}function Vl(e){var l;const t=document.createElement("html");t.innerHTML=e.replace(/&nbsp;/g," ");const n=t.querySelector("table");if(n===null)return;const o=[n],i=[];let r;for(;o.length>0;){const s=o.pop();if(s===void 0)break;if(s instanceof HTMLTableElement||s.nodeName==="TBODY")o.push(...[...s.children].reverse());else if(s instanceof HTMLTableRowElement)r!==void 0&&i.push(r),r=[],o.push(...[...s.children].reverse());else if(s instanceof HTMLTableCellElement){const a=s.cloneNode(!0),u=a.children.length===1&&a.children[0].nodeName==="P"?a.children[0]:null,b=(u==null?void 0:u.children.length)===1&&u.children[0].nodeName==="FONT",h=a.querySelectorAll("br");for(const g of h)g.replaceWith(`
`);const f=a.getAttribute("gdg-raw-value"),d=a.getAttribute("gdg-format")??"string";if(a.querySelector("a")!==null)r==null||r.push({rawValue:((l=a.querySelector("a"))==null?void 0:l.getAttribute("href"))??"",formatted:a.textContent??"",format:d});else if(a.querySelector("ol")!==null){const g=a.querySelectorAll("li");r==null||r.push({rawValue:[...g].map(v=>v.getAttribute("gdg-raw-value")??""),formatted:[...g].map(v=>v.textContent??""),format:"string-array"})}else if(f!==null)r==null||r.push({rawValue:bs(f),formatted:a.textContent??"",format:d});else{let g=a.textContent??"";b&&(g=g.replace(/\n(?!\n)/g,"")),r==null||r.push({rawValue:g??"",formatted:g??"",format:d})}}}return r!==void 0&&i.push(r),i}function ql(e,t,n,o,i){var s;const r=e;if(o==="allowPartial"||e.current===void 0||t===void 0)return e;let l=!1;do{if((e==null?void 0:e.current)===void 0)break;const a=(s=e.current)==null?void 0:s.range,c=[];if(a.width>2){const h=t({x:a.x,y:a.y,width:1,height:a.height},i.signal);if(typeof h=="function")return r;c.push(...h);const f=t({x:a.x+a.width-1,y:a.y,width:1,height:a.height},i.signal);if(typeof f=="function")return r;c.push(...f)}else{const h=t({x:a.x,y:a.y,width:a.width,height:a.height},i.signal);if(typeof h=="function")return r;c.push(...h)}let u=a.x-n,b=a.x+a.width-1-n;for(const h of c)for(const f of h)f.span!==void 0&&(u=Math.min(f.span[0],u),b=Math.max(f.span[1],b));u===a.x-n&&b===a.x+a.width-1-n?l=!0:e={current:{cell:e.current.cell??[0,0],range:{x:u+n,y:a.y,width:b-u+1,height:a.height},rangeStack:e.current.rangeStack},columns:e.columns,rows:e.rows}}while(!l);return e}function Ko(e){return e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1).replace(/""/g,'"')),e}function Ul(e){let t;(s=>{s[s.None=0]="None",s[s.inString=1]="inString",s[s.inStringPostQuote=2]="inStringPostQuote"})(t||(t={}));const n=[];let o=[],i=0,r=0;e=e.replace(/\r\n/g,`
`);let l=0;for(const s of e){switch(r){case 0:s==="	"||s===`
`?(o.push(e.slice(i,l)),i=l+1,s===`
`&&(n.push(o),o=[])):s==='"'&&(r=1);break;case 1:s==='"'&&(r=2);break;case 2:s==='"'?r=1:((s==="	"||s===`
`)&&(o.push(Ko(e.slice(i,l))),i=l+1,s===`
`&&(n.push(o),o=[])),r=0);break}l++}return i<e.length&&o.push(Ko(e.slice(i,e.length))),n.push(o),n.map(s=>s.map(a=>({rawValue:a,formatted:a,format:"string"})))}function Gl(e,t,n){var s;const o=ys(e,t),i=a=>{var c;(c=window.navigator.clipboard)==null||c.writeText(a)},r=(a,c)=>{var u;return((u=window.navigator.clipboard)==null?void 0:u.write)===void 0?!1:(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"}),"text/html":new Blob([c],{type:"text/html"})})]),!0)},l=(a,c)=>{var u,b;try{if(n===void 0||n.clipboardData===null)throw new Error("No clipboard data");(u=n==null?void 0:n.clipboardData)==null||u.setData("text/plain",a),(b=n==null?void 0:n.clipboardData)==null||b.setData("text/html",c)}catch{r(a,c)||i(a)}};((s=window.navigator.clipboard)==null?void 0:s.write)!==void 0||(n==null?void 0:n.clipboardData)!==void 0?l(o.textPlain,o.textHtml):i(o.textPlain),n==null||n.preventDefault()}function ps(e){return e!==!0}function Jo(e){const{cell:t,posX:n,posY:o,bounds:i,theme:r}=e,{width:l,height:s,x:a,y:c}=i,u=t.maxSize??r.checkboxMaxSize,b=Math.floor(i.y+s/2),h=ii(u,s,r.cellVerticalPadding),f=oi(t.contentAlign??"center",a,l,r.cellHorizontalPadding,h),d=ni(f,b,h),g=ri(a+n,c+o,d);return so(t)&&g}const ws={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??"false"},kind:me.Boolean,needsHover:!0,useLabel:!1,needsHoverPosition:!0,measure:()=>50,draw:e=>ks(e,e.cell.data,so(e.cell),e.cell.maxSize??e.theme.checkboxMaxSize,e.cell.hoverEffectIntensity??.35),onDelete:e=>({...e,data:!1}),onSelect:e=>{Jo(e)&&e.preventDefault()},onClick:e=>{if(Jo(e))return{...e.cell,data:ps(e.cell.data)}},onPaste:(e,t)=>{let n=Fn;return e.toLowerCase()==="true"?n=!0:e.toLowerCase()==="false"?n=!1:e.toLowerCase()==="indeterminate"&&(n=io),n===t.data?void 0:{...t,data:n}}};function ks(e,t,n,o,i){if(!n&&t===Fn)return;const{ctx:r,hoverAmount:l,theme:s,rect:a,highlighted:c,hoverX:u,hoverY:b,cell:{contentAlign:h}}=e,{x:f,y:d,width:g,height:v}=a;let p=!1;if(i>0){let y=n?1-i+i*l:.4;if(t===Fn&&(y*=l),y===0)return;y<1&&(p=!0,r.globalAlpha=y)}Pn(r,s,t,f,d,g,v,c,u,b,o,h),p&&(r.globalAlpha=1)}const xs=ht("div")({name:"BubblesOverlayEditorStyle",class:"bed7b9f",propsAsIs:!1}),Ss=()=>e=>e.targetX,Cs=()=>e=>e.targetY,Es=()=>e=>e.targetWidth,Ms=()=>e=>e.targetHeight,Is=()=>e=>e.targetY+10,Fs=()=>e=>Math.max(0,(e.targetHeight-28)/2),Hs=ht("div")({name:"DataGridOverlayEditorStyle",class:"d16c1ze1",propsAsIs:!1,vars:{"d16c1ze1-0":[Cs(),"px"],"d16c1ze1-1":[Ss(),"px"],"d16c1ze1-2":[Es(),"px"],"d16c1ze1-3":[Ms(),"px"],"d16c1ze1-4":[Is(),"px"],"d16c1ze1-5":[Fs(),"px"]}});function Ps(){const[e,t]=m.useState();return[e??void 0,t]}function Bs(){const[e,t]=Ps(),[n,o]=m.useState(0),[i,r]=m.useState(!0);m.useLayoutEffect(()=>{if(e===void 0||!("IntersectionObserver"in window))return;const s=new IntersectionObserver(a=>{a.length!==0&&r(a[0].isIntersecting)},{threshold:1});return s.observe(e),()=>s.disconnect()},[e]),m.useEffect(()=>{if(i||e===void 0)return;let s;const a=()=>{const{right:c}=e.getBoundingClientRect();o(u=>Math.min(u+window.innerWidth-c-10,0)),s=requestAnimationFrame(a)};return s=requestAnimationFrame(a),()=>{s!==void 0&&cancelAnimationFrame(s)}},[e,i]);const l=m.useMemo(()=>({transform:`translateX(${n}px)`}),[n]);return{ref:t,style:l}}const Qt=m.createContext({isGhostMode:!1,ghostValue:""}),As=e=>{const{target:t,content:n,onFinishEditing:o,forceEditMode:i,initialValue:r,imageEditorOverride:l,markdownDivCreateNode:s,highlight:a,className:c,theme:u,id:b,cell:h,bloom:f,portalElementRef:d,validateCell:g,getCellRenderer:v,provideEditor:p,isOutsideClick:y,customEventTarget:x,activation:C,ghostValue:B,isGhostMode:P}=e,[F,H]=m.useState(i?n:void 0),k=m.useRef(F??n);k.current=F??n;const[R,I]=m.useState(()=>g===void 0?!0:!(Cn(n)&&(g==null?void 0:g(h,n,k.current))===!1)),S=m.useCallback((q,se)=>{o(R?q:void 0,se)},[R,o]),M=m.useCallback(q=>{if(g!==void 0&&q!==void 0&&Cn(q)){const se=g(h,q,k.current);se===!1?I(!1):(typeof se=="object"&&(q=se),I(!0))}H(q)},[h,g]),E=m.useRef(!1),W=m.useRef(void 0),O=m.useCallback(()=>{S(F,[0,0]),E.current=!0},[F,S]),ne=m.useCallback((q,se)=>{console.log("[onEditorFinished] newValue:",q),console.log("[onEditorFinished] movement:",se),console.log("[onEditorFinished] calling onFinishEditing"),S(q,se??W.current??[0,0]),console.log("[onEditorFinished] onFinishEditing called"),E.current=!0},[S]),Z=m.useCallback(async q=>{if(q.nativeEvent.isComposing)return;let se=!1;q.key==="Escape"?(q.stopPropagation(),q.preventDefault(),W.current=[0,0]):q.key==="Enter"&&!q.shiftKey?(q.stopPropagation(),q.preventDefault(),W.current=[0,1],se=!0):q.key==="Tab"&&(q.stopPropagation(),q.preventDefault(),W.current=[q.shiftKey?-1:1,0],se=!0),window.setTimeout(()=>{!E.current&&W.current!==void 0&&(S(se?F:void 0,W.current),E.current=!0)},0)},[S,F]),G=F??n,[K,ce]=m.useMemo(()=>{var Ye,Ve;if(ro(n))return[];const q={...n,location:h,activation:C},se=p==null?void 0:p(q);return se!==void 0?[se,!1]:[(Ve=(Ye=v(n))==null?void 0:Ye.provideEditor)==null?void 0:Ve.call(Ye,q),!1]},[h,n,v,p,C]),{ref:ye,style:de}=Bs();let Te=!0,V,be=!0,pe;if(K!==void 0){Te=K.disablePadding!==!0,be=K.disableStyling!==!0;const q=dr(K);q&&(pe=K.styleOverride);const se=q?K.editor:K;V=m.createElement(se,{portalElementRef:d,isHighlighted:a,activation:C,onChange:M,value:G,initialValue:r,onFinishedEditing:ne,validatedSelection:Cn(G)?G.selectionRange:void 0,forceEditMode:i,target:t,imageEditorOverride:l,markdownDivCreateNode:s,isValid:R,theme:u})}pe={...pe,...de};const z=(d==null?void 0:d.current)??document.getElementById("portal");if(z===null)return console.error('Cannot open Data Grid overlay editor, because portal not found. Please, either provide a portalElementRef or add `<div id="portal" />` as the last child of your `<body>`.'),null;let le=be?"gdg-style":"gdg-unstyle";R||(le+=" gdg-invalid"),Te&&(le+=" gdg-pad");const j=(f==null?void 0:f[0])??1,ae=(f==null?void 0:f[1])??1,Be=m.useMemo(()=>({isGhostMode:P??!1,ghostValue:B??""}),[P,B]);return sr.createPortal(m.createElement(yi.Provider,{value:u},m.createElement(Qt.Provider,{value:Be},m.createElement(fs,{style:zr(u),className:c,onClickOutside:O,isOutsideClick:y,customEventTarget:x},m.createElement(Hs,{ref:ye,id:b,className:le,style:P?{...pe,visibility:"hidden"}:pe,as:ce===!0?"label":void 0,targetX:t.x-j,targetY:t.y-ae,targetWidth:t.width+j*2,targetHeight:t.height+ae*2},m.createElement("div",{className:"gdg-clip-region",onKeyDown:Z},V))))),z)},jl=Object.freeze(Object.defineProperty({__proto__:null,GhostModeContext:Qt,default:As},Symbol.toStringTag,{value:"Module"})),Ds=e=>{const{bubbles:t}=e,{isGhostMode:n}=m.useContext(Qt);return m.createElement(xs,null,t.map((o,i)=>m.createElement("div",{key:i,className:"boe-bubble"},o)),m.createElement("textarea",{className:"gdg-input",autoFocus:!n}))},Rs={getAccessibilityString:e=>si(e.data),kind:me.Bubble,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>{const o=t.data.reduce((i,r)=>e.measureText(r).width+i+n.bubblePadding*2+n.bubbleMargin,0);return t.data.length===0?n.cellHorizontalPadding*2:o+2*n.cellHorizontalPadding-n.bubbleMargin},draw:e=>Ts(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return m.createElement(Ds,{bubbles:t.data})},onPaste:()=>{}};function Ts(e,t){const{rect:n,theme:o,ctx:i,highlighted:r}=e,{x:l,y:s,width:a,height:c}=n;let u=l+o.cellHorizontalPadding;const b=[];for(const h of t){if(u>l+a)break;const f=Nt(h,i,o.baseFontFull).width;b.push({x:u,width:f}),u+=f+o.bubblePadding*2+o.bubbleMargin}i.beginPath();for(const h of b)ft(i,h.x,s+(c-o.bubbleHeight)/2,h.width+o.bubblePadding*2,o.bubbleHeight,o.roundingRadius??o.bubbleHeight/2);i.fillStyle=r?o.bgBubbleSelected:o.bgBubble,i.fill();for(const[h,f]of b.entries())i.beginPath(),i.fillStyle=o.textBubble,i.fillText(t[h],f.x+o.bubblePadding,s+c/2+tt(i,o))}const Ws=ht("div")({name:"DrilldownOverlayEditorStyle",class:"dy18k32",propsAsIs:!1}),Os=e=>{const{drilldowns:t}=e;return m.createElement(Ws,null,t.map((n,o)=>m.createElement("div",{key:o,className:"doe-bubble"},n.img!==void 0&&m.createElement("img",{src:n.img}),m.createElement("div",null,n.text))))},zs={getAccessibilityString:e=>si(e.data.map(t=>t.text)),kind:me.Drilldown,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:(e,t,n)=>t.data.reduce((o,i)=>e.measureText(i.text).width+o+n.bubblePadding*2+n.bubbleMargin+(i.img!==void 0?18:0),0)+2*n.cellHorizontalPadding-4,draw:e=>Ns(e,e.cell.data),provideEditor:()=>e=>{const{value:t}=e;return m.createElement(Os,{drilldowns:t.data})},onPaste:()=>{}},qn={};function Ls(e,t,n,o){const i=Math.ceil(window.devicePixelRatio),r=5,l=n-r*2,s=4,a=n*i,c=o+r,u=o*3,b=(u+r*2)*i,h=`${e},${t},${i},${n}`;if(qn[h]!==void 0)return{el:qn[h],height:a,width:b,middleWidth:s*i,sideWidth:c*i,padding:r*i,dpr:i};const f=document.createElement("canvas"),d=f.getContext("2d");return d===null?null:(f.width=b,f.height=a,d.scale(i,i),qn[h]=f,d.beginPath(),ft(d,r,r,u,l,o),d.shadowColor="rgba(24, 25, 34, 0.4)",d.shadowBlur=1,d.fillStyle=e,d.fill(),d.shadowColor="rgba(24, 25, 34, 0.3)",d.shadowOffsetY=1,d.shadowBlur=5,d.fillStyle=e,d.fill(),d.shadowOffsetY=0,d.shadowBlur=0,d.shadowBlur=0,d.beginPath(),ft(d,r+.5,r+.5,u,l,o),d.strokeStyle=t,d.lineWidth=1,d.stroke(),{el:f,height:a,width:b,sideWidth:c*i,middleWidth:o*i,padding:r*i,dpr:i})}function Ns(e,t){const{rect:n,theme:o,ctx:i,imageLoader:r,col:l,row:s}=e,{x:a,width:c}=n,u=o.baseFontFull,b=fi(i,u),h=Math.min(n.height,Math.max(16,Math.ceil(b*o.lineHeight)*2)),f=Math.floor(n.y+(n.height-h)/2),d=h-10,g=o.bubblePadding,v=o.bubbleMargin;let p=a+o.cellHorizontalPadding;const y=o.roundingRadius??6,x=Ls(o.bgCell,o.drilldownBorder,h,y),C=[];for(const B of t){if(p>a+c)break;const F=Nt(B.text,i,u).width;let H=0;B.img!==void 0&&r.loadOrGetImage(B.img,l,s)!==void 0&&(H=d-8+4);const k=F+H+g*2;C.push({x:p,width:k}),p+=k+v}if(x!==null){const{el:B,height:P,middleWidth:F,sideWidth:H,width:k,dpr:R,padding:I}=x,S=H/R,M=I/R;for(const E of C){const W=Math.floor(E.x),O=Math.floor(E.width),ne=O-(S-M)*2;i.imageSmoothingEnabled=!1,i.drawImage(B,0,0,H,P,W-M,f,S,h),ne>0&&i.drawImage(B,H,0,F,P,W+(S-M),f,ne,h),i.drawImage(B,k-H,0,H,P,W+O-(S-M),f,S,h),i.imageSmoothingEnabled=!0}}i.beginPath();for(const[B,P]of C.entries()){const F=t[B];let H=P.x+g;if(F.img!==void 0){const k=r.loadOrGetImage(F.img,l,s);if(k!==void 0){const R=d-8;let I=0,S=0,M=k.width,E=k.height;M>E?(I+=(M-E)/2,M=E):E>M&&(S+=(E-M)/2,E=M),i.beginPath(),ft(i,H,f+h/2-R/2,R,R,o.roundingRadius??3),i.save(),i.clip(),i.drawImage(k,I,S,M,E,H,f+h/2-R/2,R,R),i.restore(),H+=R+4}}i.beginPath(),i.fillStyle=o.textBubble,i.fillText(F.text,H,f+h/2+tt(i,o))}}const Xs=ht("div")({name:"ImageOverlayEditorStyle",class:"i1f2fhaz",propsAsIs:!1}),Ys=e=>{const{urls:t,canWrite:n,onEditClick:o,renderImage:i}=e,r=t.filter(s=>s!=="");if(r.length===0)return null;const l=r.length>1;return m.createElement(Xs,{"data-testid":"GDG-default-image-overlay-editor"},m.createElement(or.Carousel,{showArrows:l,showThumbs:!1,swipeable:l,emulateTouch:l,infiniteLoop:l},r.map(s=>{const a=(i==null?void 0:i(s))??m.createElement("img",{draggable:!1,src:s});return m.createElement("div",{className:"gdg-centering-container",key:s},a)})),n&&o&&m.createElement("button",{className:"gdg-edit-icon",onClick:o},m.createElement(lo,null)))},$s={getAccessibilityString:e=>e.data.join(", "),kind:me.Image,needsHover:!1,useLabel:!1,needsHoverPosition:!1,draw:e=>_s(e,e.cell.displayData??e.cell.data,e.cell.rounding??e.theme.roundingRadius??4,e.cell.contentAlign),measure:(e,t)=>t.data.length*50,onDelete:e=>({...e,data:[]}),provideEditor:()=>e=>{const{value:t,onFinishedEditing:n,imageEditorOverride:o}=e,i=o??Ys;return m.createElement(i,{urls:t.data,canWrite:t.readonly!==!0,onCancel:n,onChange:r=>{n({...t,data:[r]})}})},onPaste:(e,t)=>{e=e.trim();const o=e.split(",").map(i=>{try{return new URL(i),i}catch{return}}).filter(i=>i!==void 0);if(!(o.length===t.data.length&&o.every((i,r)=>i===t.data[r])))return{...t,data:o}}},Un=4;function _s(e,t,n,o){const{rect:i,col:r,row:l,theme:s,ctx:a,imageLoader:c}=e,{x:u,y:b,height:h,width:f}=i,d=h-s.cellVerticalPadding*2,g=[];let v=0;for(let y=0;y<t.length;y++){const x=t[y];if(x.length===0)continue;const C=c.loadOrGetImage(x,r,l);if(C!==void 0){g[y]=C;const B=C.width*(d/C.height);v+=B+Un}}if(v===0)return;v-=Un;let p=u+s.cellHorizontalPadding;o==="right"?p=Math.floor(u+f-s.cellHorizontalPadding-v):o==="center"&&(p=Math.floor(u+f/2-v/2));for(const y of g){if(y===void 0)continue;const x=y.width*(d/y.height);n>0&&(a.beginPath(),ft(a,p,b+s.cellVerticalPadding,x,d,n),a.save(),a.clip()),a.drawImage(y,p,b+s.cellVerticalPadding,x,d),n>0&&a.restore(),p+=x+Un}}function Vs(e,t){let n=e*49632+t*325176;return n^=n<<13,n^=n>>17,n^=n<<5,n/4294967295*2}const qs={getAccessibilityString:()=>"",kind:me.Loading,needsHover:!1,useLabel:!1,needsHoverPosition:!1,measure:()=>120,draw:e=>{const{cell:t,col:n,row:o,ctx:i,rect:r,theme:l}=e;if(t.skeletonWidth===void 0||t.skeletonWidth===0)return;let s=t.skeletonWidth;t.skeletonWidthVariability!==void 0&&t.skeletonWidthVariability>0&&(s+=Math.round(Vs(n,o)*t.skeletonWidthVariability));const a=l.cellHorizontalPadding;s+a*2>=r.width&&(s=r.width-a*2-1);const c=t.skeletonHeight??Math.min(18,r.height-2*l.cellVerticalPadding);ft(i,r.x+a,r.y+(r.height-c)/2,s,c,l.roundingRadius??3),i.fillStyle=Jt(l.textDark,.1),i.fill()},onPaste:()=>{}},Us=ht("div")({name:"MarkdownContainer",class:"m1ec5h7p",propsAsIs:!1});class Gs extends dn.PureComponent{constructor(){super(...arguments);ee(this,"targetElement",null);ee(this,"containerRefHook",n=>{this.targetElement=n,this.renderMarkdownIntoDiv()})}renderMarkdownIntoDiv(){const{targetElement:n,props:o}=this;if(n===null)return;const{contents:i,createNode:r}=o,l=rr(i),s=document.createRange();s.selectNodeContents(n),s.deleteContents();let a=r==null?void 0:r(l);if(a===void 0){const u=document.createElement("template");u.innerHTML=l,a=u.content}n.append(a);const c=n.getElementsByTagName("a");for(const u of c)u.target="_blank",u.rel="noreferrer noopener"}render(){return this.renderMarkdownIntoDiv(),dn.createElement(Us,{ref:this.containerRefHook})}}const js=ht("textarea")({name:"InputBox",class:"iotb8b8",propsAsIs:!1}),Ks=ht("div")({name:"ShadowBox",class:"s1xtsfdl",propsAsIs:!1}),Js=ht("div")({name:"GrowingEntryStyle",class:"g1d7u5bt",propsAsIs:!1});let Qo=0;const mo=e=>{const{placeholder:t,value:n,onKeyDown:o,highlight:i,altNewline:r,validatedSelection:l,autoFocus:s,...a}=e,{onChange:c,className:u}=a,b=m.useRef(null),{isGhostMode:h,ghostValue:f}=m.useContext(Qt),d=h&&f?f:n??"";yt(c!==void 0,"GrowingEntry must be a controlled input area");const[g]=m.useState(()=>"input-box-"+(Qo=(Qo+1)%1e7));m.useEffect(()=>{if(h)return;const y=b.current;if(y===null||y.disabled)return;const x=d.toString().length;y.focus(),y.setSelectionRange(i?0:x,x)},[h]),m.useLayoutEffect(()=>{var y;if(l!==void 0){const x=typeof l=="number"?[l,null]:l;(y=b.current)==null||y.setSelectionRange(x[0],x[1])}},[l]);const v=m.useCallback(y=>{y.key==="Enter"&&y.shiftKey&&r===!0||o==null||o(y)},[r,o]),p=h?{visibility:"hidden"}:void 0;return m.createElement(Js,{className:"gdg-growing-entry"},m.createElement(Ks,{className:u},d+`
`),m.createElement(js,{...a,className:(u??"")+" gdg-input",id:g,ref:b,onKeyDown:v,value:d,placeholder:t,dir:"auto",style:p}))},Qs=()=>e=>e.targetWidth,Zo=ht("div")({name:"MarkdownOverlayEditorStyle",class:"mmv7gx6",propsAsIs:!1,vars:{"mmv7gx6-0":[Qs(),"px"]}}),Zs=e=>{const{value:t,onChange:n,forceEditMode:o,createNode:i,targetRect:r,onFinish:l,validatedSelection:s}=e,{isGhostMode:a}=m.useContext(Qt),c=t.data,u=t.readonly===!0,[b,h]=m.useState(c===""||o),f=m.useCallback(()=>{h(g=>!g)},[]),d=c?"gdg-ml-6":"";return b?m.createElement(Zo,{targetWidth:r.width-20},m.createElement(mo,{autoFocus:!a,highlight:!1,validatedSelection:s,value:c,onKeyDown:g=>{g.key==="Enter"&&g.stopPropagation()},onChange:n}),m.createElement("div",{className:`gdg-edit-icon gdg-checkmark-hover ${d}`,onClick:()=>l(t)},m.createElement(fr,null))):m.createElement(Zo,{targetWidth:r.width},m.createElement(Gs,{contents:c,createNode:i}),!u&&m.createElement(m.Fragment,null,m.createElement("div",{className:"spacer"}),m.createElement("div",{className:`gdg-edit-icon gdg-edit-hover ${d}`,onClick:f},m.createElement(lo,null))),m.createElement("textarea",{className:"gdg-md-edit-textarea gdg-input",autoFocus:!a}))},el={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:me.Markdown,needsHover:!1,needsHoverPosition:!1,drawPrep:Bn,measure:(e,t,n)=>{const o=t.data.split(`
`)[0];return e.measureText(o).width+2*n.cellHorizontalPadding},draw:e=>Ct(e,e.cell.data,e.cell.contentAlign),onDelete:e=>({...e,data:""}),provideEditor:()=>e=>{const{onChange:t,value:n,target:o,onFinishedEditing:i,markdownDivCreateNode:r,forceEditMode:l,validatedSelection:s}=e;return m.createElement(Zs,{onFinish:i,targetRect:o,value:n,validatedSelection:s,onChange:a=>t({...n,data:a.target.value}),forceEditMode:l,createNode:r})},onPaste:(e,t)=>e===t.data?void 0:{...t,data:e}},tl={getAccessibilityString:e=>e.row.toString(),kind:Et.Marker,needsHover:!0,needsHoverPosition:!1,drawPrep:nl,measure:()=>44,draw:e=>il(e,e.cell.row,e.cell.checked,e.cell.markerKind,e.cell.drawHandle,e.cell.checkboxStyle,e.cell.disabled),onClick:e=>{const{bounds:t,cell:n,posX:o,posY:i}=e;if(n.disabled===!0)return;const{width:r,height:l}=t,s=n.drawHandle?7+(r-7)/2:r/2,a=l/2;if(Math.abs(o-s)<=10&&Math.abs(i-a)<=10)return{...n,checked:!n.checked}},onPaste:()=>{}};function nl(e,t){const{ctx:n,theme:o}=e,i=o.markerFontFull,r=t??{};return(r==null?void 0:r.font)!==i&&(n.font=i,r.font=i),r.deprep=ol,n.textAlign="center",r}function ol(e){const{ctx:t}=e;t.textAlign="start"}function il(e,t,n,o,i,r,l){if(l){const{ctx:v,rect:p,theme:y}=e,{x,y:C,width:B,height:P}=p,F=o==="checkbox"?"checkbox-visible":o;if(F!=="number"&&(v.globalAlpha=n?1:.4,Pn(v,y,n,i?x+7:x,C,i?B-7:B,P,!1,-20,-20,y.checkboxMaxSize,"center",r,!0),v.globalAlpha=1),F==="number"||F==="both"&&!n){const H=t.toString(),k=y.markerFontFull,R=x+B/2;v.fillStyle="#cccccc",v.font=k,v.fillText(H,R,C+P/2+tt(v,k))}if(i){v.globalAlpha=.4,v.beginPath();for(const H of[3,6])for(const k of[-5,-1,3])v.rect(x+H,C+P/2+k,2,2);v.fillStyle="#cccccc",v.fill(),v.beginPath(),v.globalAlpha=1}return}const{ctx:s,rect:a,hoverAmount:c,theme:u}=e,{x:b,y:h,width:f,height:d}=a,g=n?1:o==="checkbox-visible"?.6+.4*c:c;if(o!=="number"&&g>0){s.globalAlpha=g;const v=7*(n?c:1);if(Pn(s,u,n,i?b+v:b,h,i?f-v:f,d,!0,void 0,void 0,u.checkboxMaxSize,"center",r,l),i){s.globalAlpha=c,s.beginPath();for(const p of[3,6])for(const y of[-5,-1,3])s.rect(b+p,h+d/2+y,2,2);s.fillStyle=u.textLight,s.fill(),s.beginPath()}s.globalAlpha=1}if(o==="number"||o==="both"&&!n){const v=t.toString(),p=u.markerFontFull,y=b+f/2;o==="both"&&c!==0&&(s.globalAlpha=1-c),s.fillStyle=u.textLight,s.font=p,s.fillText(v,y,h+d/2+tt(s,p)),c!==0&&(s.globalAlpha=1)}}const rl={getAccessibilityString:()=>"",kind:Et.NewRow,needsHover:!0,needsHoverPosition:!1,measure:()=>200,draw:e=>sl(e,e.cell.hint,e.cell.icon),onPaste:()=>{}};function sl(e,t,n){const{ctx:o,rect:i,hoverAmount:r,theme:l,spriteManager:s}=e,{x:a,y:c,width:u,height:b}=i;o.beginPath(),o.globalAlpha=r,o.rect(a+1,c+1,u,b-2),o.fillStyle=l.bgHeaderHovered,o.fill(),o.globalAlpha=1,o.beginPath();const h=t!=="";let f=0;if(n!==void 0){const g=b-8,v=a+8/2,p=c+8/2;s.drawSprite(n,"normal",o,v,p,g,l,h?1:r),f=g}else{f=24;const d=12,g=h?d:r*d,v=h?0:(1-r)*d*.5,p=l.cellHorizontalPadding+4;g>0&&(o.moveTo(a+p+v,c+b/2),o.lineTo(a+p+v+g,c+b/2),o.moveTo(a+p+v+g*.5,c+b/2-g*.5),o.lineTo(a+p+v+g*.5,c+b/2+g*.5),o.lineWidth=2,o.strokeStyle=l.bgIconHeader,o.lineCap="round",o.stroke())}o.fillStyle=l.textMedium,o.fillText(t,f+a+l.cellHorizontalPadding+.5,c+b/2+tt(o,l)),o.beginPath()}function Si(e,t,n,o,i,r,l){e.textBaseline="alphabetic";const s=ll(e,i,o,t,(n==null?void 0:n.fullSize)??!1);e.beginPath(),ft(e,s.x,s.y,s.width,s.height,t.roundingRadius??4),e.globalAlpha=r,e.fillStyle=(n==null?void 0:n.bgColor)??Jt(t.textDark,.1),e.fill(),e.globalAlpha=1,e.fillStyle=t.textDark,e.textBaseline="middle",l==null||l("text")}function ll(e,t,n,o,i){const r=o.cellHorizontalPadding,l=o.cellVerticalPadding;if(i)return{x:t.x+r/2,y:t.y+l/2+1,width:t.width-r,height:t.height-l-1};const s=Nt(n,e,o.baseFontFull,"alphabetic"),a=t.height-l,c=Math.min(a,s.actualBoundingBoxAscent*2.5);return{x:t.x+r/2,y:t.y+(t.height-c)/2+1,width:s.width+r*3,height:c-1}}const al=m.lazy(async()=>await lr(()=>import("./number-overlay-editor-CqaOLUq8.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),cl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:me.Number,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,useLabel:!0,drawPrep:Bn,draw:e=>{const{hoverAmount:t,cell:n,ctx:o,theme:i,rect:r,overrideCursor:l}=e,{hoverEffect:s,displayData:a,hoverEffectTheme:c}=n;s===!0&&t>0&&Si(o,i,c,a,r,t,l),Ct(e,e.cell.displayData,e.cell.contentAlign)},measure:(e,t,n)=>e.measureText(t.displayData).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:void 0}),provideEditor:()=>e=>{const{isHighlighted:t,onChange:n,onFinishedEditing:o,value:i,validatedSelection:r}=e;return m.createElement(m.Suspense,{fallback:null},m.createElement(al,{highlight:t,disabled:i.readonly===!0,value:i.data,fixedDecimals:i.fixedDecimals,allowNegative:i.allowNegative,thousandSeparator:i.thousandSeparator,decimalSeparator:i.decimalSeparator,validatedSelection:r,onChange:l=>n({...i,data:Number.isNaN(l.floatValue??0)?0:l.floatValue}),onKeyDown:l=>{l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),o(i,[0,1])):l.key==="Tab"?(l.preventDefault(),o(i,[l.shiftKey?-1:1,0])):l.key==="Escape"&&(l.preventDefault(),o(void 0,[0,0]))}}))},onPaste:(e,t,n)=>{const o=typeof n.rawValue=="number"?n.rawValue:Number.parseFloat(typeof n.rawValue=="string"?n.rawValue:e);if(!(Number.isNaN(o)||t.data===o))return{...t,data:o,displayData:n.formattedString??t.displayData}}},dl={getAccessibilityString:()=>"",measure:()=>108,kind:me.Protected,needsHover:!1,needsHoverPosition:!1,draw:ul,onPaste:()=>{}};function ul(e){const{ctx:t,theme:n,rect:o}=e,{x:i,y:r,height:l}=o;t.beginPath();const s=2.5;let a=i+n.cellHorizontalPadding+s;const c=r+l/2,u=Math.cos(Do(30))*s,b=Math.sin(Do(30))*s;for(let h=0;h<12;h++)t.moveTo(a,c-s),t.lineTo(a,c+s),t.moveTo(a+u,c-b),t.lineTo(a-u,c+b),t.moveTo(a-u,c-b),t.lineTo(a+u,c+b),a+=8;t.lineWidth=1.1,t.lineCap="square",t.strokeStyle=n.textLight,t.stroke()}const fl={getAccessibilityString:e=>e.rowId??"",kind:Et.RowId,needsHover:!1,needsHoverPosition:!1,measure:(e,t,n)=>Nt(t.rowId??"",e,n.baseFontStyle).width+n.cellHorizontalPadding*2,draw:e=>{const{ctx:t,rect:n,cell:o,theme:i}=e,r=o.rowId;if(!r)return;t.fillStyle=i.textDark,t.font=i.baseFontStyle,t.textAlign="left";const l=n.x+i.cellHorizontalPadding,s=n.y+n.height/2;t.fillText(r,l,s+tt(t,i))},onClick:()=>{},onPaste:()=>{}},hl={getAccessibilityString:e=>e.rowId??"",kind:Et.RowId,needsHover:!1,needsHoverPosition:!1,drawPrep:gl,measure:()=>80,draw:e=>bl(e,e.cell.rowId),onClick:()=>{},onPaste:()=>{}};function gl(e,t){const{ctx:n}=e,o="12px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=ml,n.textAlign="left",i}function ml(e){const{ctx:t}=e;t.textAlign="start"}function bl(e,t){if(!t)return;const{ctx:n,rect:o,theme:i}=e,{x:r,y:l,height:s}=o;n.fillStyle=i.textDark,n.font="12px sans-serif";const a=r+8,c=l+s/2;n.fillText(t,a,c+tt(n,n.font))}const vl={getAccessibilityString:e=>e.status??"",kind:Et.RowStatus,needsHover:!1,needsHoverPosition:!1,drawPrep:yl,measure:()=>40,draw:e=>wl(e,e.cell.status),onClick:()=>{},onPaste:()=>{}};function yl(e,t){const{ctx:n}=e,o="bold 14px sans-serif",i=t??{};return(i==null?void 0:i.font)!==o&&(n.font=o,i.font=o),i.deprep=pl,n.textAlign="center",i}function pl(e){const{ctx:t}=e;t.textAlign="start"}function wl(e,t){if(!t)return;const{ctx:n,rect:o}=e,{x:i,y:r,width:l,height:s}=o,a={A:"#2e7d32",U:"#f9a825",D:"#c62828"};n.fillStyle=a[t],n.font="bold 14px sans-serif";const c=i+l/2,u=r+s/2;n.fillText(t,c,u+tt(n,n.font))}const kl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:me.Text,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!1,drawPrep:Bn,useLabel:!0,draw:e=>{const{cell:t,hoverAmount:n,hyperWrapping:o,ctx:i,rect:r,theme:l,overrideCursor:s}=e,{displayData:a,contentAlign:c,hoverEffect:u,allowWrapping:b,hoverEffectTheme:h}=t;u===!0&&n>0&&Si(i,l,h,a,r,n,s),Ct(e,a,c,b,o)},measure:(e,t,n)=>{const o=t.displayData.split(`
`,t.allowWrapping===!0?void 0:1);let i=0;for(const r of o)i=Math.max(i,e.measureText(r).width);return i+2*n.cellHorizontalPadding},onDelete:e=>({...e,data:""}),provideEditor:e=>({disablePadding:e.allowWrapping===!0,editor:t=>{const{isHighlighted:n,onChange:o,value:i,validatedSelection:r}=t;return m.createElement(mo,{style:e.allowWrapping===!0?{padding:"3px 8.5px"}:void 0,highlight:n,autoFocus:i.readonly!==!0,disabled:i.readonly===!0,altNewline:!0,value:i.data,validatedSelection:r,onChange:l=>o({...i,data:l.target.value})})}}),onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},xl=ht("div")({name:"UriOverlayEditorStyle",class:"uwr6ffw",propsAsIs:!1}),Sl=e=>{const{uri:t,onChange:n,forceEditMode:o,readonly:i,validatedSelection:r,preview:l}=e,{isGhostMode:s}=m.useContext(Qt),[a,c]=m.useState(!i&&(t===""||o)),u=m.useCallback(()=>{c(!0)},[]);return a?m.createElement(mo,{validatedSelection:r,highlight:!0,autoFocus:!s,value:t,onChange:n}):m.createElement(xl,null,m.createElement("a",{className:"gdg-link-area",href:t,target:"_blank",rel:"noopener noreferrer"},l),!i&&m.createElement("div",{className:"gdg-edit-icon",onClick:u},m.createElement(lo,null)),m.createElement("textarea",{className:"gdg-input",autoFocus:!s}))};function Ci(e,t,n,o){let i=n.cellHorizontalPadding;const r=t.height/2-e.actualBoundingBoxAscent/2,l=e.width,s=e.actualBoundingBoxAscent;return o==="right"?i=t.width-l-n.cellHorizontalPadding:o==="center"&&(i=t.width/2-l/2),{x:i,y:r,width:l,height:s}}function ei(e){const{cell:t,bounds:n,posX:o,posY:i,theme:r}=e,l=t.displayData??t.data;if(t.hoverEffect!==!0||t.onClickUri===void 0)return!1;const s=di(l,r.baseFontFull);if(s===void 0)return!1;const a=Ci(s,n,r,t.contentAlign);return Ot({x:a.x-4,y:a.y-4,width:a.width+8,height:a.height+8},o,i)}const Cl={getAccessibilityString:e=>{var t;return((t=e.data)==null?void 0:t.toString())??""},kind:me.Uri,needsHover:e=>e.hoverEffect===!0,needsHoverPosition:!0,useLabel:!0,drawPrep:Bn,draw:e=>{const{cell:t,theme:n,overrideCursor:o,hoverX:i,hoverY:r,rect:l,ctx:s}=e,a=t.displayData??t.data,c=t.hoverEffect===!0;if(o!==void 0&&c&&i!==void 0&&r!==void 0){const u=Nt(a,s,n.baseFontFull),b=Ci(u,l,n,t.contentAlign),{x:h,y:f,width:d,height:g}=b;if(i>=h-4&&i<=h-4+d+8&&r>=f-4&&r<=f-4+g+8){const v=tt(s,n.baseFontFull);o("pointer");const p=5,y=f-v;s.beginPath(),s.moveTo(l.x+h,Math.floor(l.y+y+g+p)+.5),s.lineTo(l.x+h+d,Math.floor(l.y+y+g+p)+.5),s.strokeStyle=n.linkColor,s.stroke(),s.save(),s.fillStyle=e.cellFillColor,Ct({...e,rect:{...l,x:l.x-1}},a,t.contentAlign),Ct({...e,rect:{...l,x:l.x-2}},a,t.contentAlign),Ct({...e,rect:{...l,x:l.x+1}},a,t.contentAlign),Ct({...e,rect:{...l,x:l.x+2}},a,t.contentAlign),s.restore()}}s.fillStyle=c?n.linkColor:n.textDark,Ct(e,a,t.contentAlign)},onSelect:e=>{ei(e)&&e.preventDefault()},onClick:e=>{var o;const{cell:t}=e;ei(e)&&((o=t.onClickUri)==null||o.call(t,e))},measure:(e,t,n)=>e.measureText(t.displayData??t.data).width+n.cellHorizontalPadding*2,onDelete:e=>({...e,data:""}),provideEditor:e=>t=>{const{onChange:n,value:o,forceEditMode:i,validatedSelection:r}=t;return m.createElement(Sl,{forceEditMode:o.readonly!==!0&&(i||e.hoverEffect===!0&&e.onClickUri!==void 0),uri:o.data,preview:o.displayData??o.data,validatedSelection:r,readonly:o.readonly===!0,onChange:l=>n({...o,data:l.target.value})})},onPaste:(e,t,n)=>e===t.data?void 0:{...t,data:e,displayData:n.formattedString??t.displayData}},Kl=[tl,rl,vl,hl,ws,Rs,zs,$s,qs,el,cl,dl,fl,kl,Cl],Gn=[];class Jl extends gi{constructor(){super(...arguments);ee(this,"imageLoaded",()=>{});ee(this,"loadedLocations",[]);ee(this,"cache",{});ee(this,"sendLoaded",ir(()=>{this.imageLoaded(new Ut(this.loadedLocations)),this.loadedLocations=[]},20));ee(this,"clearOutOfWindow",()=>{const n=Object.keys(this.cache);for(const o of n){const i=this.cache[o];let r=!1;for(let l=0;l<i.cells.length;l++){const s=i.cells[l];if(this.isInWindow(s)){r=!0;break}}r?i.cells=i.cells.filter(this.isInWindow):(i.cancel(),delete this.cache[o])}})}setCallback(n){this.imageLoaded=n}loadImage(n,o,i,r){let l=!1;const s=Gn.pop()??new Image;let a=!1;const c={img:void 0,cells:[lt(o,i)],url:n,cancel:()=>{a||(a=!0,Gn.length<12?Gn.unshift(s):l||(s.src=""))}},u=new Promise(b=>s.addEventListener("load",()=>b(null)));requestAnimationFrame(async()=>{try{s.src=n,await u,await s.decode();const b=this.cache[r];if(b!==void 0&&!a){b.img=s;for(const h of b.cells)this.loadedLocations.push(fo(h));l=!0,this.sendLoaded()}}catch{c.cancel()}}),this.cache[r]=c}loadOrGetImage(n,o,i){const r=n,l=this.cache[r];if(l!==void 0){const s=lt(o,i);return l.cells.includes(s)||l.cells.push(s),l.img}else this.loadImage(n,o,i,r)}}export{jl as $,yr as A,ql as B,Kn as C,Lt as D,Jt as E,Ot as F,me as G,Al as H,Et as I,Kt as J,Uo as K,cs as L,Yl as M,oo as N,dr as O,Ll as P,Ro as Q,zr as R,Kl as S,yi as T,Jl as U,_l as V,qo as W,ls as X,Tl as Y,tl as Z,Qt as _,ar as a,ut as b,zt as c,yt as d,fs as e,Dl as f,Nl as g,$l as h,Cn as i,cr as j,Vl as k,Ul as l,ro as m,Gl as n,zl as o,Ol as p,ln as q,Rl as r,wr as s,ps as t,Xl as u,Lr as v,Wl as w,En as x,Wt as y,Qn as z};
